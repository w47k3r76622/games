<!--ONLINE AT https://andyjadams.github.io/HoldOn.html-->
<DOCUMENT html>
<html><head><title>Hold On</title><style>body{margin:0;}#canvas{background-color: #d2dae2;}</style></head><body><canvas id='canvas'></canvas> <!--Where the magic happens! --><script>
var canvas=document.querySelector("canvas");function scaleCanvas(){canvas.width=window.innerWidth,canvas.height=window.innerHeight}scaleCanvas();var holdtime,starttime,ctx=canvas.getContext("2d");ctx.font="28px Verdana",ctx.fillStyle="#ffa801";var best=0;function Point(t,i){this.x=t,this.y=i,this.targetX=this.x,this.prevX=this.x,this.update=function(){this.x<this.targetX?this.x+=(this.targetX-this.x)/4:this.x>this.targetX&&(this.x-=(this.x-this.targetX)/4)}}function Obstacle(t,i,e){this.x=t,this.y=i,this.radius=e,this.draw=function(){ctx.fillStyle="#2c3e50",ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI),ctx.fill(),ctx.closePath(),getDistance(player.x,player.y+80,this.x,this.y)<player.radius+this.radius&&(fail=!0)},this.update=function(){this.y+=8+this.radius/10,this.draw()}}function Player(t,i,e){this.x=t,this.y=i,this.radius=e,this.nearestPoint=void 0,this.wave=0,this.flipped=!1,this.arms=!1,this.moveDelta=0,this.failTimer=new Date,this.draw=function(){ctx.lineCap="round",ctx.lineJoin="round",fail&&(this.y+=this.radius),this.wave>1?this.flipped=!0:this.wave<-1&&(this.flipped=!1),this.flipped?this.wave-=.5:this.wave+=.5,void 0!=this.nearestPoint&&(ctx.strokeStyle="#FF6C09",Math.abs(this.nearestPoint.x-this.x)<50&&!fail?(ctx.beginPath(),ctx.moveTo(this.nearestPoint.x,this.nearestPoint.y),ctx.lineTo(this.x-.7*this.radius,this.y+50),ctx.moveTo(this.x+.5*this.radius,this.y+50),ctx.lineTo(this.nearestPoint.x,this.nearestPoint.y),ctx.stroke(),this.arms=!1,this.failTimer=0,holdtime=Math.floor((new Date-starttime)/10)/100,ctx.fillStyle="#FF6C09",ctx.font="48pt Helvetica",ctx.fillText(holdtime+"s",20,70)):(ctx.beginPath(),ctx.moveTo(this.x-this.radius/2,this.y+50),ctx.lineTo(this.x-(this.radius+30),this.y+50+15*Math.sin(this.wave)),ctx.moveTo(this.x+this.radius/2,this.y+50),ctx.lineTo(this.x+(this.radius+30),this.y+50+15*Math.sin(this.wave)),ctx.stroke(),this.arms=!0,0==this.failTimer&&(this.failTimer=new Date)),ctx.beginPath(),this.nearestPoint.x<this.x-20&&!this.arms?ctx.arc(this.x-7,this.y-this.radius+50,.7*this.radius,0,2*Math.PI):this.nearestPoint.x>this.x+20&&!this.arms?ctx.arc(this.x+7,this.y-this.radius+50,.7*this.radius,0,2*Math.PI):ctx.arc(this.x,this.y-this.radius+50,.7*this.radius,0,2*Math.PI),ctx.fillStyle="#FF6C09",ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.moveTo(this.x+this.moveDelta-10,this.y+85),ctx.lineTo(this.x-10,this.y+55),ctx.lineTo(this.x+10,this.y+55),ctx.lineTo(this.x+this.moveDelta+10,this.y+85),ctx.stroke(),ctx.closePath(),this.moveDelta<0?this.moveDelta+=Math.abs(this.moveDelta)/4:this.moveDelta>0&&(this.moveDelta-=this.moveDelta/4),ctx.beginPath(),ctx.arc(this.x,this.y+55,this.radius,0,2*Math.PI),ctx.fillStyle="#FF6C09",ctx.strokeStyle="#FF6C09",ctx.fill(),ctx.stroke(),ctx.closePath()),this.failTimer>0&&!fail&&new Date-this.failTimer>1e3&&(fail=!0)}}for(var pointCount=30,dist=innerHeight/(pointCount-1),pointArray=[],interval=0,limit=60,steps=0,difficulty=innerWidth/6,i=0;i<pointCount;i++)pointArray.push(new Point(innerWidth/2,i*dist));var fail=!1,start=!1,player=new Player(innerWidth/2,innerHeight/2,15),obstacles=[],increase=!1;function animate(){window.requestAnimationFrame(animate),ctx.clearRect(0,0,innerWidth,innerHeight),interval++,ctx.lineWidth=6,ctx.beginPath();for(var t=0;t<pointArray.length;t++)0==t?(ctx.strokeStyle="#2c3e50",ctx.moveTo(pointArray[t].x,pointArray[t].y),fail?(ctx.font="48pt Helvetica",ctx.fillText(holdtime+"s",20,70),ctx.font="14pt Helvetica",ctx.fillText("Click to restart",20,95)):interval>=limit&&(pointArray[t].targetX=(Math.random()-.5)*difficulty+innerWidth/2,(difficulty+=10)>innerWidth/2&&(difficulty=innerWidth/2),interval=0,++steps>=30&&((limit-=5)<10&&(limit=10),steps=0))):(ctx.lineTo(pointArray[t].x,pointArray[t].y),fail||(pointArray[t].targetX=pointArray[t-1].x)),pointArray[t].update();if(ctx.stroke(),player.draw(),start=!0,holdtime>8){Math.floor(holdtime)%10!=0||increase||(obstacles.push(new Obstacle(player.x+(Math.random()-.5),-50,30*Math.random()+10)),increase=!0),Math.floor(holdtime)%10!=0&&(increase=!1);for(var i=0;i<obstacles.length;i++)obstacles[i].update(),obstacles[i].y>innerHeight+obstacles[i].radius+10&&!fail&&(obstacles[i]=new Obstacle(player.x+(Math.random()-.5),-50,30*Math.random()+10))}if(ctx.font="12pt Helvetica",ctx.fillStyle="#2c3e50",best>0){var e=best;holdtime>best&&(e=holdtime),ctx.fillText("best:"+e,20,20)}else ctx.fillText("Hold On",20,20)}player.nearestPoint=pointArray[Math.ceil(pointArray.length/2)-3];var prevMouseX=innerWidth/2;function getDistance(t,i,e,a){return Math.sqrt(Math.pow(Math.abs(t-e),2)+Math.pow(Math.abs(i-a),2))}function updateScore(t){void 0!=typeof Storage&&(localStorage.setItem("HoldOnGame_JS13K",""+t),best=localStorage.getItem("HoldOnGame_JS13K"))}window.addEventListener("mousemove",function(t){if(!fail){player.x=t.pageX,player.y=t.pageY;for(var i=void 0,e=1e4,a=0;a<pointArray.length;a++)Math.abs(pointArray[a].y-player.y)<e&&(e=Math.abs(pointArray[a].y-player.y),i=pointArray[a]);void 0!=i&&(player.nearestPoint=i),player.moveDelta-=player.x-prevMouseX,prevMouseX=player.x}}),window.addEventListener("mousedown",function(t){fail&&(holdtime>best&&updateScore(holdtime),player=new Player(t.pageX,t.pageY,15),this.failTimer=0,fail=!1,starttime=new Date,obstacles=[])}),starttime=new Date,animate();</script></body></html> 