"use strict";var $={};$.width=window.innerWidth,$.height=window.innerHeight,$.scale=48,$.subscribers=[],$.entities=[],$.inventory=[],$.current_status=0,$.last_status=-1,$.scroll_x=0,$.scroll_y=0,$.game_lives=0,$.game_score=0,$.game_time=0,$.stage_txy=0,$.stage=void 0,$.lastRender=new Date,$.delta=0,$.falling=!1,$.jumping=!1,$.story_seen=!1,$.controller_seen=!1,$.level=0,$.pause=!1,$.character=null,$.actions={right:0,left:1,top:2,bottom:3,jump:4},$.colors=["#33691e","#76ff03","#ccff90","#311b92","#b39ddb","#d1c4e9","#448aff","#1976d2","#90caf9","#eeff41","#c6ff00","#dce775","#bf360c","#ff3d00","#ff8a65","#1b5e20","#76ff0355","#ccff9055","#311b92","#b39ddb55","#d1c4e955","#448aff","#1976d255","#90caf955","#eeff41","#c6ff0055","#dce77555"],$.init=function(){$.canvas=document.getElementById("game"),$.canvas.width=$.width,$.canvas.height=$.height,$.ctx=$.canvas.getContext("2d"),$.canvas_builder=document.getElementById("builder"),$.canvas_builder.width=$.width,$.canvas_builder.height=$.height,$.ctx_builder=$.canvas_builder.getContext("2d"),$.Subscribe.mouseMovement(),$.Subscribe.mouseClick(),$.Subscribe.keyboard(),$.cubeset=new $.Cubeset,$.loop()},$.loop=function(e){switch($.delta=new Date-$.lastRender,$.current_status){case 0:$.current_status!=$.last_status&&($.Subscribe.removeSubscribeEvents(),$.last_status=$.current_status,$.SplashScreen.start()),$.SplashScreen.render();break;case 1:$.current_status!=$.last_status&&($.Subscribe.removeSubscribeEvents(),$.last_status=$.current_status,$.MenuScreen.start()),$.MenuScreen.render();break;case 2:$.current_status!=$.last_status&&($.Subscribe.removeSubscribeEvents(),$.last_status=$.current_status,$.PlayScreen.start()),$.PlayScreen.update(),$.PlayScreen.render();break;case 3:$.current_status!=$.last_status&&($.Subscribe.removeSubscribeEvents(),$.KilledScreen.start(),$.last_status=$.current_status),$.KilledScreen.render();break;case 4:$.current_status!=$.last_status&&($.Subscribe.removeSubscribeEvents(),$.WinScreen.start(),$.last_status=$.current_status),$.WinScreen.render()}$.lastRender=new Date,window.requestAnimFrame($.loop)},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),window.addEventListener("load",$.init,!1),window.addEventListener("visibilitychange",function(){"visible"===document.visibilityState&&($.delta=new Date,$.lastRender=new Date)},!1),$.Character=function(){this.sprites={0:{0:$.cubeset.getResource("character-0"),1:$.cubeset.getResource("character-0-1"),2:$.cubeset.getResource("character-0-2"),3:$.cubeset.getResource("character-0-3"),4:$.cubeset.getResource("character-0-4"),5:$.cubeset.getResource("character-0-5"),6:$.cubeset.getResource("character-0-6"),7:$.cubeset.getResource("character-0-7"),8:$.cubeset.getResource("character-0-8")},1:{0:$.cubeset.getResource("character-1")},2:{0:$.cubeset.getResource("character-2")},3:{0:$.cubeset.getResource("character-3"),1:$.cubeset.getResource("character-3-1"),2:$.cubeset.getResource("character-3-2"),3:$.cubeset.getResource("character-3-3"),4:$.cubeset.getResource("character-3-4"),5:$.cubeset.getResource("character-3-5"),6:$.cubeset.getResource("character-3-6"),7:$.cubeset.getResource("character-3-7"),8:$.cubeset.getResource("character-3-8")}},this.colision={},this.x=$.width/2,this.y=$.height/2,this.direction=0,this.velocity=0,this.velocity_y=0,this.save_y=0,this.z=1,this.jumpHeightSquared=8,this.jumpHeightSquaredTmp=0,this.gravityAccelerationY=.6,this.die=!1,this.animationKey=0,this.animationTicks=0},$.Character.prototype.half=function(e){var t=-1;t=0==e?0==this.direction?2:2==this.direction?1:1==this.direction?3:0:0==this.direction?3:3==this.direction?1:1==this.direction?2:0,this.changeDirection(t)},$.Character.prototype.jump=function(){0==$.jumping&&0==$.falling&&(this.jumpHeightSquaredTmp=-this.jumpHeightSquared,$.jumping=!0,this.save_y=this.y)},$.Character.prototype.changeDirection=function(e){return 1!=$.pause&&void(e>=0&&e<=3&&(this.direction!=e&&3!=e&&0!=e&&(this.animationKey=0),this.direction=e,this.velocity=.3+$.level/2*.1))},$.Character.prototype.stop=function(){this.velocity=0},$.Character.prototype.render=function(){$.ctx.save(),$.ctx.globalAlpha=this.die?.2:1,$.ctx.drawImage(this.sprites[this.direction][this.animationKey],this.x,this.y),$.ctx.restore(),this.z=this.x+$.scroll_x+this.y-$.scroll_y,this.animationTicks>150&&this.animationKey<Object.keys(this.sprites[this.direction]).length-1&&(this.animationKey++,this.animationTicks=0),this.animationKey>=Object.keys(this.sprites[this.direction]).length-1&&(this.animationKey=0,this.animationTicks=0),this.animationTicks+=$.delta},$.Character.prototype.update=function(){return 1!=$.pause&&void($.falling?(this.colision={x:0,y:0,sx:0,sy:0,width:0,height:0,c_x:0,c_y:0},this.y+=this.gravityAccelerationY*$.delta,0==this.die&&(this.die=!0,setTimeout(function(){$.current_status=3},100))):(1==$.jumping&&(this.jumpHeightSquaredTmp+=.05*$.delta,this.y+=this.jumpHeightSquaredTmp,this.jumpHeightSquaredTmp>this.jumpHeightSquared&&($.jumping=!1,this.jumpHeightSquaredTmp=0,this.y=this.save_y)),0==this.direction?($.scroll_x-=1*this.velocity*$.delta,$.scroll_y-=.5*this.velocity*$.delta):1==this.direction?($.scroll_x-=-1*this.velocity*$.delta,$.scroll_y+=.5*this.velocity*$.delta):2==this.direction?($.scroll_x+=-1*this.velocity*$.delta,$.scroll_y+=.5*this.velocity*$.delta):3==this.direction&&($.scroll_x+=1*this.velocity*$.delta,$.scroll_y-=.5*this.velocity*$.delta),this.colision={x:this.x,y:this.y+72,sx:this.x-$.scroll_x,sy:this.y-$.scroll_y+72,width:48,height:24,c_x:(this.x-$.scroll_x)/48,c_y:(this.y-$.scroll_y)/48*2}))},$.Character.prototype.collision=function(){return 1==$.jumping?{x:0,y:0,sx:0,sy:0,w:0,h:0,cx:0,cy:0}:this.colision},$.Enemy=function(e,t,i,s,r,c,a,n){this.sprite=i,this.x=e,this.y=t,this.d_x=256,this.d=0,this.parameters=s,this.colision={},this.name=r,this.showing=s.s||1,this.z=1,this.direction=n,this.inverseDirection=this.inverseDirection(n),this.velocity=.15},$.Enemy.prototype.swipeDirections=function(){this.tmp=this.direction,this.direction=this.inverseDirection,this.inverseDirection=this.tmp,this.d=0},$.Enemy.prototype.inverseDirection=function(e){return 0==e?1:1==e?0:2==e?3:3==e?2:void 0},$.Enemy.prototype.render=function(){0!=this.showing&&$.ctx.drawImage(this.sprite,this.x+$.scroll_x,this.y+$.scroll_y)},$.Enemy.prototype.update=function(){return 1!=$.pause&&(0!=this.showing&&(this.direction>=0&&this.moving(),void(this.colision={x:this.x+$.scroll_x,y:this.y+$.scroll_y+72,sx:this.x+$.scroll_x,sy:this.y+$.scroll_y+72,width:48,height:24})))},$.Enemy.prototype.moving=function(){0==this.direction?(this.d+=1*this.velocity*$.delta+.5*this.velocity*$.delta,this.x-=1*this.velocity*$.delta,this.y-=.5*this.velocity*$.delta,this.d>this.d_x&&this.swipeDirections()):1==this.direction?(this.d+=1*this.velocity*$.delta+.5*this.velocity*$.delta,this.x-=-1*this.velocity*$.delta,this.y+=.5*this.velocity*$.delta,this.d>this.d_x&&this.swipeDirections()):2==this.direction?(this.d+=1*this.velocity*$.delta+.5*this.velocity*$.delta,this.x+=-1*this.velocity*$.delta,this.y+=.5*this.velocity*$.delta,this.d>this.d_x&&this.swipeDirections()):3==this.direction&&(this.d+=1*this.velocity*$.delta+.5*this.velocity*$.delta,this.x+=1*this.velocity*$.delta,this.y-=.5*this.velocity*$.delta,this.d>this.d_x&&this.swipeDirections())},$.Enemy.prototype.collision=function(){return 0==this.showing?{x:0,y:0,sx:0,sy:0,w:0,h:0}:this.colision},$.Enemy.prototype.getParameters=function(){return this.parameters},$.Item=function(e,t,i,s,r){this.sprite=i,this.x=e,this.y=t,this.name=r,this.parameters=s,this.colision={},this.showing=s.s,this.z=1},$.Item.prototype.render=function(){0!=this.showing&&($.ctx.save(),$.ctx.drawImage(this.sprite,this.x+$.scroll_x,this.y+$.scroll_y),$.ctx.restore(),this.z=this.x+$.scroll_x+this.y+$.scroll_y+96,this.z<0&&(this.z=0))},$.Item.prototype.update=function(){return 0!=this.showing&&void(this.colision={x:this.x+$.scroll_x,y:this.y+$.scroll_y+72,sx:this.x+$.scroll_x,sy:this.y+$.scroll_y+72,width:48,height:24})},$.Item.prototype.collision=function(){return 0==this.showing?{x:0,y:0,sx:0,sy:0,w:0,h:0}:this.colision},$.Item.prototype.getParameters=function(){return this.parameters},$.Npc=function(e,t,i,s,r){this.sprite=i,this.x=e,this.y=t,this.parameters=s,this.colision={},this.name=r,this.showing=s.s||1,this.z=1},$.Npc.prototype.render=function(){return 0!=this.showing&&($.ctx.drawImage(this.sprite,this.x+$.scroll_x,this.y+$.scroll_y),this.z=this.x+$.scroll_x+this.y+$.scroll_y+96,void(this.z<0&&(this.z=0)))},$.Npc.prototype.update=function(){return 0!=this.showing&&void(this.colision={x:this.x+$.scroll_x,y:this.y+$.scroll_y+72,sx:this.x+$.scroll_x,sy:this.y+$.scroll_y+72,width:48,height:24})},$.Npc.prototype.collision=function(){return 0==this.showing?{x:0,y:0,sx:0,sy:0,w:0,h:0}:this.colision},$.Npc.prototype.getParameters=function(){return this.parameters},$.Tile=function(e,t,i,s,r){this.sprite=i,this.x=e,this.y=t,this.parameters=s,this.colision={},this.name="",this.t=0,this.showing=s.s||1,this.z=-r},$.Tile.prototype.render=function(){return 0!=this.showing&&void $.ctx.drawImage(this.sprite,this.x+$.scroll_x,this.y+$.scroll_y)},$.Tile.prototype.update=function(){return 0!=this.showing&&void(this.colision={x:this.x+$.scroll_x,y:this.y+$.scroll_y,sx:this.x+$.scroll_x,sy:this.y+$.scroll_y+72,width:48,height:48})},$.Tile.prototype.collision=function(){return 0==this.showing?{x:0,y:0,sx:0,sy:0,w:0,h:0}:this.colision},$.Tile.prototype.getParameters=function(){return this.parameters},$.dSpriteSheet=["character","block-green","block-red","block-purple","block-blue","block-yellow","item-key-green","item-key-purple","item-key-blue","item-key-yellow","npc-face1-green","npc-face1-purple","npc-face1-blue","npc-face1-yellow","npc-face1-red","enemy-face1-green"],$.stageMap={w:45,h:45,d:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,2,2,0,0,0,0,0,1,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,2,2,0,0,0,0,0,1,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,3,3,3,3,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,6,6,6,1,0,0,6,1,1,8,8,8,8,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,6,6,6,1,0,0,6,1,1,8,8,8,8,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,6,6,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,1,1,6,6,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,1,1,6,6,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,7,7,7,7,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,7,7,7,7,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,6,6,6,7,7,7,7,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,6,6,6,7,7,7,7,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,4,4,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,4,4,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,11,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,11,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,11,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11,11,11,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},$.stageMapEntities={1:{s:"1",c:"1",clr:"green",f:"block-green",m:"b"},2:{s:"0",c:"0",clr:"green",f:"block-green",m:"b"},11:{s:"1",c:"1",clr:"red",f:"block-red",m:"b"},12:{s:"0",c:"0",clr:"red",f:"block-red",m:"b"},3:{s:"1",c:"1",clr:"purple",f:"block-purple",m:"b"},4:{s:"0",c:"0",clr:"purple",f:"block-purple",m:"b"},5:{s:"1",c:"1",clr:"blue",f:"block-blue",m:"b"},6:{s:"0",c:"0",clr:"blue",f:"block-blue",m:"b"},7:{s:"1",c:"1",clr:"yellow",f:"block-yellow",m:"b"},8:{s:"0",c:"0",clr:"yellow",f:"block-yellow",m:"b"},key_1:{s:"0",c:"1",f:"item-key-green",x:"1210.9696969697",y:"403.09090909091",t:"item_key",cx:"9",cy:"3",m:"item",actions:{on:"green"}},key_2:{s:"0",c:"1",f:"item-key-purple",x:"3314.0606060606",y:"1511.6363636364",t:"item_key",cx:"25",cy:"11",m:"item",actions:{on:"purple"}},key_3:{s:"0",c:"1",f:"item-key-blue",x:"228",y:"1380",t:"item_key",cx:"1",cy:"10",m:"item",actions:{on:"blue"}},key_4:{s:"0",c:"1",f:"item-key-yellow",x:"2148",y:"1508",t:"item_key",cx:"16",cy:"11",m:"item",actions:{on:"yellow"}},npc_1:{s:"1",c:"1",f:"npc-face1-green",x:"500.12121212121",y:"482.42424242424",t:"npc_face1",cx:"3",cy:"3",m:"npc",actions:{message:"Hi, I'm Clippy, the office assistant. Would you like some assistance today?|Actually, I'd like to..|It looks like you are trying to write a letter. Here's a list of stuff you can do: Write in bold, set Comic Sans as font, use WordArt to..|Stop! I'm trying to find the way out of here and get to the Internet before this computer dies..|Are you sure you don't want to write in bold?|We are dying here! You will die too!|Haha..I've been dead for a while, buddy! Check with Flash, he knows about Internet stuff.. buy him a drink, he needs it.|Got it! Thanks!|Oh my Word, I finally helped somebody!",on:"key_1"}},npc_2:{s:"1",c:"1",f:"npc-face1-purple",x:"2758.4242424242",y:"993.93939393939",t:"npc_face1",cx:"21",cy:"7",m:"npc",actions:{message:"Is that a beer?|Are you Flash?|\"Are you Flash?\" Who's asking? Don't care! Give me the beer and leave me alone, I'm dying!|We all are! Look,I'm trying to get to the Internet..|What for?|To spread and destroy all communications.|Yay!That would kill smartphones! Talk to MrAffe, he was nice to me.. You'll need a disguise: this will be enough.|Great!",on:"key_2"}},npc_3:{s:"1",c:"1",f:"npc-face1-blue",x:"708",y:"4780",t:"npc_face1",cx:"4",cy:"36",m:"npc",actions:{message:"Quick scan running..No virus found, your PC is protected!|Good job, Mr.Afee!|Hey, who are you?|Just a regular bytestream walking around... I want to see the Internet, can you help me?|How can I know I can trust you?|I've got money, would you like some?|Sure, thanks! Find Explorer and give him this ActiveX control, he knows.|Cool!",on:"key_3"}},npc_4:{s:"1",c:"1",f:"npc-face1-yellow",x:"5486",y:"2938",t:"npc_face1",cx:"42",cy:"22",m:"npc",actions:{message:"..An error has occurred in the script on this page...|Hi! MrAfee told me you'd like this!|..An ActiveX control! .. Is it signed? .. What do I care? .. What do you want for it?|Show me the way to the outside world!|..Oh,that's easy! .. Give me that control, first .. Mmm.. Nice! .. Promise not to use me to download another browser, right?|I do.|..Ok .. it won't be fast .. but take that header .. and show it to the router.",on:"key_4"}},npc_5:{s:"1",c:"1",f:"npc-face1-red",x:"3096",y:"5552",t:"npc_face1",cx:"24",cy:"42",m:"npc",actions:{message:"Boarding pass, please?|You mean this?|Yup! Hey, it doesn't say where to go!|To the Internet, sir!|Duh! Could you be more specific?|I want to destroy all communications and take over the world, where should I start?|What do I know? Just say some random numbers.|91.. .. 22 .. 74 .. 12 .. 35|Got it! Sending you to 91.227.41.235! Good luck! Destroy them all!",on:"finnish_gam"}},enemy_1:{s:"1",c:"1",f:"enemy_0",x:"903.0303030303",y:"263.0303030303",t:"enemy_face1",cx:"6",cy:"1",cx_to:"6",cy_to:"5",m:"enemy",actions:{behaviour:"stop"}},enemy_2:{s:"1",c:"1",f:"enemy_1",x:"1671.0303030303",y:"239.0303030303",t:"enemy_face1",cx:"12",cy:"1",cx_to:"12",cy_to:"5",m:"enemy",actions:{behaviour:"stop"}},enemy_3:{s:"1",c:"1",f:"enemy_2",x:"115.0303030303",y:"2963.0303030303",t:"enemy_face1",cx:"0",cy:"22",cx_to:"0",cy_to:"22",m:"enemy",actions:{behaviour:"stop"}},enemy_4:{s:"1",c:"1",f:"enemy_3",x:"1791.0303030303",y:"2175.0303030303",t:"enemy_face1",cx:"13",cy:"16",cx_to:"13",cy_to:"16",m:"enemy",actions:{behaviour:"stop"}}},$.KilledScreen={start:function(){$.Draw.visible("hud","none"),$.Draw.visible("killed","block"),$.Subscribe.addSubscribeEvent("lost","click",function(e){$.falling=!1,$.Draw.visible("killed","none"),$.current_status=2}),$.Subscribe.addSubscribeEvent("game","keyboard",function(e){$.falling=!1,$.Draw.visible("killed","none"),$.current_status=2}),document.getElementById("killed_img").src=document.getElementById("character-0").src},render:function(){$.Draw.clear()}},$.MenuScreen={start:function(){$.Draw.visible("background-wrap","block"),$.Draw.visible("menu","block"),$.game_lives=0,$.game_score=0,$.game_time=0,$.last_status=$.current_status,$.s=this,$.Subscribe.addSubscribeEvent("start","click",function(e){$.s.change_screen()}),$.Subscribe.addSubscribeEvent("game","keyboard",function(e){$.s.change_screen()})},change_screen:function(){$.Draw.visible("menu","none"),$.Draw.visible("controller","none"),$.Draw.visible("story","none"),0==$.story_seen?($.Draw.visible("story","block"),$.story_seen=!0):0==$.controller_seen?($.Draw.visible("controller","block"),$.controller_seen=!0):1==$.story_seen&&1==$.controller_seen&&($.current_status=2)},render:function(){$.Draw.clear()}},$.PlayScreen={start:function(){$.character=new $.Character,$.entities=[],$.entities.splice(0,$.entities.length),$.stage=new $.Stage,$.stage.entities($.entities),this.orderLayers(),$.scroll_x=$.character.x+144,$.scroll_y=$.character.y,this.talk=0,this.talk_i=0,this.messages="",this.message_index=0,this.message_action_item="",this.win=!1,this.walking=!1,$.Draw.visible("hud","block"),$.character.stop(),$.s=this,$.Subscribe.addSubscribeEvent("game","keyboard",function(e){1==$.s.talk?$.s.nextLine():0==$.s.walking?($.character.changeDirection(0),$.s.walking=!0):e.k==$.actions.top||e.k==$.actions.jump?$.character.jump():e.k==$.actions.left?$.character.half(0):e.k==$.actions.right&&$.character.half(1)}),$.Subscribe.addSubscribeEvent("game","click",function(e){0==$.s.walking?($.character.changeDirection(0),$.s.walking=!0):($.character.half(e.h),$.s.nextLine())})},update:function(){if(1==$.pause)return!1;for(var e=0;e<$.entities.length;e++)$.entities[e].update();for(var t=!1,e=0;e<$.entities.length;e++)if($.character.collision().x<$.entities[e].collision().x+$.entities[e].collision().width&&$.character.collision().x+$.character.collision().width>$.entities[e].collision().x&&$.character.collision().y<$.entities[e].collision().y+$.entities[e].collision().height&&$.character.collision().height+$.character.collision().y>$.entities[e].collision().y){if(void 0==$.entities[e].parameters)continue;"item"==$.entities[e].parameters.m?"item_key"==$.entities[e].parameters.t&&(this.item_id_off(e),this.block_color_on($.entities[e].parameters.actions.on)):"enemy"==$.entities[e].parameters.m?$.current_status=3:"npc"==$.entities[e].parameters.m&&0==this.talk?($.Draw.visible("hud","none"),$.character.stop(),$.pause=!0,this.talk=1,this.talk_i=e,void 0!=$.entities[e].parameters.actions.on&&"finnish_gam"==$.entities[e].parameters.actions.on&&(this.win=!0),this.messages="",this.messages=$.entities[e].parameters.actions.message.split("|"),this.message_index=0,this.message_action_item=$.entities[e].parameters.actions.on||"",$.entities[e].parameters=void 0,this.showTalkLine(this.messages[this.message_index],""),$.Draw.visible("talk","block")):"b"==$.entities[e].parameters.m&&(t=!0)}0==t&&0==$.jumping&&($.falling=!0)},render:function(){this.orderLayers(),$.Draw.clear();for(var e=0;e<$.entities.length;e++)$.entities[e].render()},showTalkLine:function(e,t){document.getElementById("talk").innerHTML="<p class="+t+">"+e+"</p>"},nextLine:function(){1==this.talk&&(++this.message_index<this.messages.length?this.message_index%2==0?this.showTalkLine(this.messages[this.message_index],""):this.showTalkLine(this.messages[this.message_index],"other"):(1==this.win?($.Draw.visible("talk","none"),$.current_status=4):($.Draw.visible("talk","none"),$.Draw.visible("hud","block"),this.item_id_off(this.talk_i),this.talk=0,this.talk_i=0,this.item_on(this.message_action_item)),$.pause=!1))},item_on:function(e){this.getEntityByName(e).e.showing=1},item_off:function(e){this.getEntityByName(e).e.showing=0},item_id_on:function(e){$.entities[e].showing=1},item_id_off:function(e){$.entities[e].showing=0},block_color_on:function(e){for(var t=0;t<$.entities.length;t++)void 0!=$.entities[t].parameters&&void 0!=$.entities[t].parameters.clr&&"b"==$.entities[t].parameters.m&&0==$.entities[t].showing&&$.entities[t].parameters.clr==e&&($.entities[t].showing=1)},orderLayers:function(){$.entities.sort(function(e,t){return e.z<t.z?-1:e.z>t.z?1:0})},getEntityByName:function(e){for(var t=1;t<$.entities.length;t++)if($.entities[t].name==e)return{i:t,e:$.entities[t]};return null}},$.SplashScreen={start:function(){$.Draw.visible("splash","block"),setTimeout(function(){$.current_status=1,$.Draw.visible("splash","none")},3e3)},render:function(){$.Draw.clear()}},$.WinScreen={start:function(){$.Draw.visible("hud","none"),$.Draw.visible("talk","none"),$.Draw.visible("win","block"),$.level++,document.getElementById("hud_level").innerHTML=$.level+1,$.Subscribe.addSubscribeEvent("start","click",function(e){$.Draw.visible("win","none"),$.current_status=2}),$.Subscribe.addSubscribeEvent("game","keyboard",function(e){$.Draw.visible("win","none"),$.current_status=2})},render:function(){$.Draw.clear()}},$.Cubeset=function(){this.s_width=96,this.s_height=48,this.s_extra_height=120-this.s_height,this.spriteSheet=[];for(var e=0;e<$.dSpriteSheet.length;e++)for(var t=this.createResource($.dSpriteSheet[e]),i=0;i<t.length;i++)this.spriteSheet.push(t[i])},$.Cubeset.prototype.createResource=function(e){switch(this.resources=[],e){case"block-green":this.resources.push(this.createCube(e,0,""));break;case"block-purple":this.resources.push(this.createCube(e,1,"",""));break;case"block-blue":this.resources.push(this.createCube(e,3,"",""));break;case"block-yellow":this.resources.push(this.createCube(e,2,"",""));break;case"block-red":this.resources.push(this.createCube(e,4,"",""));break;case"item-key-green":this.resources.push(this.createCube(e,5,"🍺","#ffffffaa"));break;case"item-key-purple":this.resources.push(this.createCube(e,6,"👓","#ffffffaa"));break;case"item-key-blue":this.resources.push(this.createCube(e,8,"☢","#000000aa"));break;case"item-key-yellow":this.resources.push(this.createCube(e,7,"🔑","#ffff00"));break;case"item-key-red":this.resources.push(this.createCube(e,9,"",""));break;case"npc-face1-green":this.resources.push(this.createCharacter(e,"#1b5e20","#76ff0377","#ccff9077",!0,0,0,"0"));break;case"npc-face1-purple":this.resources.push(this.createCharacter(e,"#422771","#b39ddb77","#d1c4e977",!0,0,0,"0"));break;case"npc-face1-yellow":this.resources.push(this.createCharacter(e,"#448aff","#1976d277","#90caf977",!0,0,0,"0"));break;case"npc-face1-blue":this.resources.push(this.createCharacter(e,"#eeff41","#c6ff0077","#dce77775",!0,0,0,"0"));break;case"npc-face1-red":this.resources.push(this.createCharacter(e,"#bf360c","#ff3d0077","#ff8a6775",!0,0,0,"0"));break;case"enemy-face1-green":this.resources.push(this.createCharacter(e,"#d50000","#b71c1c","#e53935",!0,0,0,"0"));break;case"character":this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,0,0,"0")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,0,4,"0-1")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,0,8,"0-2")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,0,12,"0-3")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,0,16,"0-4")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,0,20,"0-5")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,0,24,"0-6")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,0,28,"0-7")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,0,32,"0-8")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,1,0,"1")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,2,0,"2")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,3,0,"3")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,3,4,"3-1")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,3,8,"3-2")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,3,12,"3-3")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,3,16,"3-4")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,3,20,"3-5")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,3,24,"3-6")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,3,28,"3-7")),this.resources.push(this.createCharacter(e,"#0d47a1","#1565c0","#1976d2",!0,3,32,"3-8"))}return this.resources},$.Cubeset.prototype.getResource=function(e){for(var t=0;t<this.spriteSheet.length;t++)if(this.spriteSheet[t].face==e)return this.spriteSheet[t].sprite},$.Cubeset.prototype.createCube=function(e,t,i,s){var r=$.colors[3*t],c=$.colors[3*t+1],a=$.colors[3*t+2];if($.canvas_builder.width=this.s_width,$.canvas_builder.height=this.s_extra_height+this.s_height,$.ctx_builder.clearRect(0,0,$.width,$.height),$.ctx_builder.fillStyle="#00000000",$.ctx_builder.clearRect(0,0,this.s_width,this.s_height),$.ctx_builder.fillRect(0,0,this.s_width,this.s_height),$.ctx_builder.fillStyle=r,$.ctx_builder.beginPath(),$.ctx_builder.moveTo(this.s_height,0),$.ctx_builder.lineTo(0,this.s_height/2),$.ctx_builder.lineTo(this.s_width,this.s_height/2),$.ctx_builder.closePath(),$.ctx_builder.fill(),$.ctx_builder.beginPath(),$.ctx_builder.moveTo(0,this.s_height/2),$.ctx_builder.lineTo(this.s_height,this.s_height),$.ctx_builder.lineTo(this.s_width,this.s_height/2),$.ctx_builder.closePath(),$.ctx_builder.fill(),""!=i){$.ctx_builder.font="bold 36px Arial",$.ctx_builder.fillStyle=s;var n=$.ctx_builder.createLinearGradient(0,0,this.s_width,0);n.addColorStop("0","#f3e5f5"),n.addColorStop("0.5","#8e24aa"),n.addColorStop("1.0","#aa00ff"),$.ctx_builder.fillText(i,this.s_width/2-18,this.s_height-16)}$.ctx_builder.fillStyle=c,$.ctx_builder.beginPath(),$.ctx_builder.moveTo(0,this.s_height/2),$.ctx_builder.lineTo(0,2*this.s_height),$.ctx_builder.lineTo(this.s_width/2,2*this.s_height+this.s_height/2),$.ctx_builder.lineTo(this.s_width/2,this.s_height),$.ctx_builder.closePath(),$.ctx_builder.fill(),$.ctx_builder.fillStyle=a,$.ctx_builder.beginPath(),$.ctx_builder.moveTo(this.s_width,this.s_height/2),$.ctx_builder.lineTo(this.s_width,2*this.s_height),$.ctx_builder.lineTo(this.s_width/2,2*this.s_height+this.s_height/2),$.ctx_builder.lineTo(this.s_width/2,this.s_height),$.ctx_builder.closePath(),$.ctx_builder.fill();var o=document.createElement("img");return o.src=$.canvas_builder.toDataURL(),o.id=e,o.style="display:none",document.body.appendChild(o),{face:e,sprite:document.getElementById(e)}},$.Cubeset.prototype.createCharacter=function(e,t,i,s,r,c,a,n){$.canvas_builder.width=this.s_width,$.canvas_builder.height=this.s_extra_height+this.s_height,$.ctx_builder.clearRect(0,0,$.width,$.height),$.ctx_builder.fillStyle="#00000000",$.ctx_builder.clearRect(0,0,this.s_width,this.s_height),$.ctx_builder.fillRect(0,0,this.s_width,this.s_height),$.ctx_builder.fillStyle=t,$.ctx_builder.beginPath(),$.ctx_builder.moveTo(this.s_height,0),$.ctx_builder.lineTo(0,this.s_height/2),$.ctx_builder.lineTo(this.s_width-16,this.s_height/2),$.ctx_builder.closePath(),$.ctx_builder.fill(),$.ctx_builder.beginPath(),$.ctx_builder.moveTo(10,this.s_height/2),$.ctx_builder.lineTo(this.s_height,this.s_height),$.ctx_builder.lineTo(this.s_width,this.s_height/2),$.ctx_builder.closePath(),$.ctx_builder.fill(),$.ctx_builder.beginPath(),$.ctx_builder.moveTo(0,this.s_height/2),$.ctx_builder.lineTo(this.s_height,this.s_height),$.ctx_builder.lineTo(this.s_width,this.s_height/2),$.ctx_builder.closePath(),$.ctx_builder.fill(),$.ctx_builder.fillStyle=i,$.ctx_builder.beginPath(),$.ctx_builder.moveTo(0,this.s_height/2),$.ctx_builder.lineTo(0,2*this.s_height),$.ctx_builder.lineTo(this.s_width/2,2*this.s_height+this.s_height/2),$.ctx_builder.lineTo(this.s_width/2,this.s_height),$.ctx_builder.closePath(),$.ctx_builder.fill(),$.ctx_builder.fillStyle=s,$.ctx_builder.beginPath(),$.ctx_builder.moveTo(this.s_width,this.s_height/2),$.ctx_builder.lineTo(this.s_width,2*this.s_height),$.ctx_builder.lineTo(this.s_width/2,2*this.s_height+this.s_height/2),$.ctx_builder.lineTo(this.s_width/2,this.s_height),$.ctx_builder.closePath(),$.ctx_builder.fill();var a=a||0;1==r&&(0==c&&(this.drawEye("white","black","cyan",64,54,24,36,0),this.drawMouth("white",58,100,32-a,4)),3==c&&(this.drawEye("white","black","cyan",12,48,24,36,c),this.drawMouth("white",6,88,32-a,4,c)));var o=document.createElement("img");return o.src=$.canvas_builder.toDataURL(),o.id=e+"-"+n,o.style="display:none",document.body.appendChild(o),{face:e+"-"+n,sprite:document.getElementById(o.id)}},$.Cubeset.prototype.drawEye=function(e,t,i,s,r,c,a,n){$.ctx_builder.fillStyle=e,$.ctx_builder.beginPath(),$.ctx_builder.moveTo(s,r);var o=r-.5*c,h=r+a-.5*c;if(3==n)var o=r+.5*c,h=r+a+.5*c;var l=r+a;$.ctx_builder.lineTo(s+c,o),$.ctx_builder.lineTo(s+c,h),$.ctx_builder.lineTo(s,l),$.ctx_builder.closePath(),$.ctx_builder.fill(),c-=8,a-=16;var u=4,d=6;o=r-.5*c,h=r+a-.5*c,3==n&&(o=r+.5*c,h=r+a+.5*c),$.ctx_builder.fillStyle=t,$.ctx_builder.beginPath(),$.ctx_builder.moveTo(s+u,r+d),
$.ctx_builder.lineTo(s+c+u,o+d),$.ctx_builder.lineTo(s+c+u,h+d),$.ctx_builder.lineTo(s+u,r+a+d),$.ctx_builder.closePath(),$.ctx_builder.fill(),c=8,a=8;var u=8,d=12;o=r-.5*c,h=r+a-.5*c,3==n&&(o=r+.5*c,h=r+a+.5*c),$.ctx_builder.fillStyle=i,$.ctx_builder.beginPath(),$.ctx_builder.moveTo(s+u,r+d),$.ctx_builder.lineTo(s+c+u,o+d),$.ctx_builder.lineTo(s+c+u,h+d),$.ctx_builder.lineTo(s+u,r+a+d),$.ctx_builder.closePath(),$.ctx_builder.fill()},$.Cubeset.prototype.drawMouth=function(e,t,i,s,r,c){var a=i-.5*s,n=i+r-.5*s;3==c&&(a=i+.5*s,n=i+r+.5*s),$.ctx_builder.fillStyle=e,$.ctx_builder.beginPath(),$.ctx_builder.moveTo(t,i),$.ctx_builder.lineTo(t+s,a),$.ctx_builder.lineTo(t+s,n),$.ctx_builder.lineTo(t,i+r),$.ctx_builder.closePath(),$.ctx_builder.fill()},$.Draw={clear:function(){$.ctx.clearRect(0,0,$.width,$.height)},visible:function(e,t){document.getElementById(e).style.display=t}},$.Stage=function(){this.stage="",this.stage_name="",this.stage_tiles=[],this.tile_height=48,this.tile_height_factor=72},$.Stage.prototype.entities=function(e){for(var t=0;t<$.stageMap.d.length;t++){var i=t%$.stageMap.w,s=Math.floor(t/$.stageMap.w),r=0,c=$.stageMap.d[t];if(c>0){var a=$.stageMapEntities[c],n=new $.Tile((i-s)*this.tile_height,(i+s)*this.tile_height/2-r*this.tile_height_factor,$.cubeset.getResource(a.f),a,$.stageMap.d.length-t);e.push(n)}}for(var o=Object.keys($.stageMapEntities),h=0;h<o.length;h++){var l=$.stageMapEntities[o[h]],a=$.stageMapEntities[c];switch(l.m){case"npc":e.push(new $.Npc((parseInt(l.cx)-parseInt(l.cy))*this.tile_height,(parseInt(l.cx)+parseInt(l.cy))*this.tile_height/2-1*this.tile_height_factor,$.cubeset.getResource(l.f+"-0"),l,o[h]));break;case"item":e.push(new $.Item((parseInt(l.cx)-parseInt(l.cy))*this.tile_height,(parseInt(l.cx)+parseInt(l.cy))*this.tile_height/2-1*this.tile_height_factor,$.cubeset.getResource(l.f),l,o[h]));break;case"enemy":var i=(parseInt(l.cx)-parseInt(l.cy))*this.tile_height,s=(parseInt(l.cx)+parseInt(l.cy))*this.tile_height/2-1*this.tile_height_factor,u=(parseInt(l.cx_to)-parseInt(l.cy_to))*this.tile_height,d=(parseInt(l.cx_to)+parseInt(l.cy_to))*this.tile_height/2-1*this.tile_height_factor,b=-1;i!=u&&s!=d&&(b=0,l.cx<l.cx_to&&l.cy==l.cy_to?b=1:l.cy>l.cy_to&&l.cx==l.cx_to?b=3:l.cy<l.cy_to&&l.cx==l.cx_to&&(b=2)),e.push(new $.Enemy(i,s,$.cubeset.getResource("enemy-face1-green-0"),l,o[h],u,d,b))}}e.push($.character)},$.Subscribe={addSubscribeEvent:function(e,t,i){for(var s=0;s<$.subscribers;s++)if($.subscribers[s].n==e&&$.subscribers[s].type==t)return!1;$.subscribers.push({n:e,t:t,c:i})},removeSubscribeEvents:function(e,t,i){$.subscribers=[]},mouseMovement:function(){$.canvas.addEventListener("mousemove",function(e){for(var t=0;t<$.subscribers.length;t++)"mousemove"==$.subscribers[t].t&&$.subscribers[t].c({x:e.clientX-$.canvas.getBoundingClientRect().left-$.scroll_x,y:e.clientY-$.canvas.getBoundingClientRect().top-$.scroll_y})})},mouseClick:function(){window.document.addEventListener("click",function(e){for(var t=0;t<$.subscribers.length;t++)if("click"==$.subscribers[t].t){var i=1;e.clientX-$.canvas.getBoundingClientRect().left<window.innerWidth/2&&(i=0),$.subscribers[t].c({h:i,x:e.clientX-$.canvas.getBoundingClientRect().left-$.scroll_x,y:e.clientY-$.canvas.getBoundingClientRect().top-$.scroll_y,tx:Math.floor(e.clientX-$.canvas.getBoundingClientRect().left/$.scale),ty:Math.floor(e.clientY-$.canvas.getBoundingClientRect().top/$.scale),c:Math.floor((e.clientX-$.canvas.getBoundingClientRect().left-$.scroll_x)/$.scale)+Math.floor((e.clientY-$.canvas.getBoundingClientRect().top-$.scroll_y)/$.scale)*$.stage_txy})}})},keyboard:function(){window.addEventListener("keydown",function(e){for(var t=0;t<$.subscribers.length;t++)if("keyboard"==$.subscribers[t].t){var i=null;38==e.keyCode?i=$.actions.top:37==e.keyCode?i=$.actions.left:39==e.keyCode?i=$.actions.right:40==e.keyCode?i=$.actions.bottom:32==e.keyCode&&(i=$.actions.jump),null!=i&&$.subscribers[t].c({k:i})}},!1)},controlDebug:function(e,t){document.getElementById("debug_up").addEventListener("click",function(){t(e,document.getElementById("debug_up"))})}};