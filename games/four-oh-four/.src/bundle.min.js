var t=function(t){"use strict";class s{constructor(t){Object.assign(this,{t:t,s:{}})}get(t,s=!1){const e=t.toString()+(s?"transpose":"");return this.s.hasOwnProperty(e)?this.s[e]:(this.s[e]=s?this.i(this.t(t)):this.t(t),this.s[e])}i(t){return Object.keys(t[0]).map((function(s){return t.map((function(t){return t[s]}))}))}}const e=new s(t=>[[1,0,0],[0,Math.cos(t),-Math.sin(t)],[0,Math.sin(t),Math.cos(t)]]),i=new s(t=>[[Math.cos(t),0,Math.sin(t)],[0,1,0],[-Math.sin(t),0,Math.cos(t)]]),n=new s(t=>[[Math.cos(t),-Math.sin(t),0],[Math.sin(t),Math.cos(t),0],[0,0,1]]),h=Math.PI,a=2*Math.PI,o=(t=1,s=-1,e=1,i=0,n=0)=>h=>s+(e-s)*(.5+Math.sin(Math.PI*h/(t/2)-i)/2)+n,r=(t,s,e,i,n)=>({x:Math.cos(n)*(t-e)-Math.sin(n)*(s-i)+e,y:Math.sin(n)*(t-e)+Math.cos(n)*(s-i)+i}),l=t=>t*Math.PI/180,c=(t,s,h,a)=>{let o,r,l,c;"x"===s?o=e.get(h,a):"y"===s?o=i.get(h,a):"z"===s&&(o=n.get(h,a)),o.forEach((s,e)=>{let i=0;i+=s[0]*t.x,i+=s[1]*t.y,i+=s[2]*t.z,0===e?r=i:1===e?l=i:c=i}),t.x=r,t.y=l,t.z=c},w=()=>Math.random(),u=t=>new Float32Array(t),y=t=>document.getElementById(t),d=(t,s)=>new Promise((function(e){setTimeout(e.bind(null,s),t)})),p=(t,s)=>{b.o.h=t,d(s),b.o.h=t};class m{constructor(){const t=new(window.AudioContext||window.webkitAudioContext),s={l:null,state:"stopped",u:t,sampleRate:t.sampleRate,p:65/60,m:196,g:[[0,3,5,7,10],[-4,-2,0,3,7],[-9,-7,-5,-2,2,3],[-7,-3,0,3,5,7]],M:[0,1,0,1,0,1,2,3],attack:.15,k:.03,v:.75,release:.08,S:2,F:o(65/60*32,350,6500,65/60*8),A:t.createGain(),T:t.createBiquadFilter(),C:t.createBiquadFilter(),O:90,B:900,square:t.createOscillator(),D:t.createGain(),I:t.createOscillator(),R:t.createGain(),j:t.createConvolver()};Object.assign(this,s),this.T.type="lowpass",this.T.Q.value=1,this.T.connect(t.destination),this.A.connect(this.T),this.A.gain.value=.5,this.L(t=>{this.j.buffer=t,this.j.connect(this.A)}),this.C.type="lowpass",this.C.Q.value=2.7,this.C.connect(this.j),this.square.type="square",this.D.gain.value=0,this.square.connect(this.D),this.D.connect(this.C),this.I.type="sine",this.R.gain.value=0,this.I.connect(this.R),this.R.connect(this.A)}G(t,s){t.setValueAtTime(s,this.u.currentTime)}start(){"suspended"===this.u.state&&this.u.resume();try{this.square.start(),this.I.start(),this.state="started"}catch{this.state="started"}}P(t,s,e,i){const n=t.createBiquadFilter();return n.frequency.value=e,n.type=s,i&&n.connect(i),n}q(){const t=this.S*this.u.sampleRate,s=u(t),e=u(t);for(let i=0;i<t;i++)s[i]=1-2*w(),e[i]=1-2*w();const i=this.u.createBuffer(2,t,this.u.sampleRate);return i.getChannelData(0).set(s),i.getChannelData(1).set(e),i}L(t){const s=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(2,this.sampleRate*this.S,this.sampleRate),e=s.createGain();e.connect(s.destination),e.gain.setValueAtTime(1,0),e.gain.linearRampToValueAtTime(0,this.S);const i=this.P(s,"lowpass",5e3,e),n=this.P(s,"highpass",500,i),h=s.createBufferSource();h.buffer=this.q(),h.connect(n),h.start(),s.startRendering(),s.oncomplete=s=>{t(s.renderedBuffer)}}N(t){let s;return s=t>0?2:.5,this.m*Math.pow(Math.pow(s,1/12),Math.abs(t))}H(t,s,e,i,n,h=1){let a=t;s[e].setValueAtTime(i,a),s[e].linearRampToValueAtTime(n,a+=this.attack),s[e].linearRampToValueAtTime(i+this.v*(n-i),a+=this.k*h),s[e].linearRampToValueAtTime(i,a+=this.release)}$(t,s,e){const i=this.N(t),n=this.u.currentTime;switch(s){case"square":this.G(this.square.frequency,i),this.H(n,this.D,"gain",0,.8,.25),this.H(n,this.C,"frequency",this.O,this.B);break;case"sine":this.G(this.I.frequency,i),this.H(n,this.R,"gain",0,e.U||1,32);break;case"noise":{const t=this.u.createBufferSource(),s=this.u.createGain(),i=this.u.createGain();t.buffer=this.j.buffer,t.connect(i),t.connect(s),i.connect(this.A),s.connect(this.j),this.G(s.gain,.2*e.U||1),this.G(i.gain,.6*e.U||1),this.G(t.playbackRate,e.speed||1),t.start(0,0,e.duration);break}}}update(t){if("started"===this.state){const s=t/1e3;null===this.l&&(this.l=s);const e=s-this.l;this.G(this.T.frequency,this.F(e));const i={e:~~(e*this.p*2),W:~~(e*this.p*3/2),V:~~(e*this.p),_:~~(e*this.p/2),measure:~~(e*this.p/4),K:~~(e*this.p/8)};if(this.Y!==i.V&&(i.V%2==1&&this.$(null,"noise",{speed:.5,U:.01}),this.Y=i.V),this.J!==i.W&&(this.$(null,"noise",{speed:3,U:.2,duration:.01}),this.J=i.W),this.X!==i._){const t=this.M[i.K%8],s=this.g[t];this.$(s[0]-24,"sine",{U:.3}),this.$(s[0]-12,"square",{U:.3}),this.X=i._}let n;if(i.measure!==this.Z&&(this.tt=w(),this.Z=i.measure),n=this.tt<.5?i.V:i.e,n&&this.st!==n){const t=this.M[i.K%8],s=this.g[t];this.$(s[Math.floor(w()*s.length)],"square"),this.st=n}}}}class f{constructor(t){this.et=t.width,this.it=t.height}nt(t){return this.et*((t+1)/2)}ht(t){return this.it*((t+1)/2)}width(t){return void 0!==t?this.et*t:this.et}height(t){return void 0!==t?this.it*t:this.it}}const b={at:0};class g{constructor(t,s,e){this.type="point",this.x=t,this.y=s,this.z=e}translate(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}set(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}clone(){return new g(this.x,this.y,this.z)}}class M{constructor(t,s){this.ot=s||b.at++,this.rt=t,Object.getOwnPropertyNames(t).forEach(s=>{this[s]=t[s]})}apply(t=b.lt){for(const[s,e]of Object.entries(this.rt))t[s]="function"==typeof e?e():e}}class k{constructor(t={}){const s={enabled:!0,position:new g(0,0,0),rotation:new g(0,0,0),scale:new g(1,1,1)};this.ot=b.at++,Object.assign(this,{...s,...t})}ct(){let t=[],s=this;for(;s;)s.style&&(Array.isArray(s.style)?t=[...s.style,...t]:t.unshift(s.style)),s=s.parent||null;return t}wt(t=b.lt){this.ct().forEach(s=>s.apply(t))}ut(){if(this.parent){return this.parent.ut().clone().translate(this.position)}return this.position}yt(){if(this.parent){return this.parent.yt().clone().translate(this.rotation)}return this.rotation}dt(){if(this.parent&&this.parent.scale){const t=this.parent.dt();return new g(t.x*this.scale.x,t.y*this.scale.y,t.z*this.scale.z)}return this.scale}}class v extends k{constructor(t,s={}){super(s);Object.assign(this,{type:"group",style:null,children:[],...s}),t&&this.add(t)}add(t){Array.isArray(t)?t.forEach(t=>{this.children.push(t),t.parent=this}):(this.children.push(t),t.parent=this)}remove(t){let s=null,e=0;for(;null===s&&e<this.children.length;)this.children[e].ot===t.ot?s=e:e++;null!==s&&this.children.splice(s,1)}pt(t,s){(this.enabled||this.ft)&&(s.save(),this.wt(s),this.children.forEach(e=>e.pt(t,s)),s.restore())}}const S=new M({lineWidth:()=>b.bt.width(.001),lineJoin:"round",lineCap:"round"}),F=new M({lineWidth:()=>b.bt.width(.003)}),x=new M({strokeStyle:"black"}),A=new M({strokeStyle:"white"}),E=new M({strokeStyle:"rgba(0,0,0,0)"}),T=new M({fillStyle:"rgba(0,0,0,.25)"}),C=new M({fillStyle:"rgba(255,255,255,.25)"}),O=new M({fillStyle:"#2E86AB",ot:"waterBlue"}),B=new M({fillStyle:"#5BBA6F"}),D=new M({fillStyle:"#137547"}),I=new M({fillStyle:"#272838"}),R=new M({fillStyle:"purple"}),j=new M({fillStyle:"#F7F0F5",ot:"magnolia"}),L=new M({fillStyle:"#8B5742"}),G=(new M({fillStyle:"#5C4033"}),new M({fillStyle:"#292421"})),P=(new M({fillStyle:"#E7C496"}),new M({fillStyle:"#E3DBDB"})),z=new M({fillStyle:"#F47749"}),q=new M({fillStyle:"#CD7F32"}),N=new M({fillStyle:"#B0C4DE"}),H=new M({fillStyle:"#87CEFA"}),$=(new M({fillStyle:"#F7F8F8"}),new M({fillStyle:"grey"})),U=(new M({fillStyle:"#52595F"}),new M({fillStyle:"#94C595"})),W=(new M({fillStyle:"#3ECAAC"}),new M({fillStyle:"#2D675F"}),new M({fillStyle:"#7C77B9"})),V=new M({fillStyle:"#8B5DCE"}),_=new v(null,{style:[S,E]});class K extends k{constructor(t,s={}){super(s);const e={type:"mesh",ot:b.at++,style:null,gt:!0,box:[]};this.Mt=this.ct().map(t=>t.ot).join("-"),Object.assign(this,{kt:t,...e,...s})}getKey(){const t=this.dt(),s=this.yt();return[this.kt.name,this.Mt,t.x,t.y,t.z,s.x,s.y,s.z].join("~")}vt(t){const s=this.ut().clone().translate(new g(1,1,0));return t.St(s),s}async s(t=b.Ft){if(!this.gt)return;const s=this.getKey(),e=t.St(this);let i=document.createElement("canvas"),n=i.getContext("2d",{alpha:!0});this.wt(n);const h=parseFloat(n.lineWidth||0);this.box[0]-=h/2,this.box[1]-=h/2,this.box[2]+=h/2,this.box[3]+=h/2,i.width=this.box[2]-this.box[0],i.height=this.box[3]-this.box[1],this.wt(n),t.xt(e,n,this.box);const a=await b.Ft.At(i);return t.Et(s,a),i=null,n=null,s}pt(t,s){if(this.enabled){if(s.save(),b.Tt&&this.gt){const e=t.Ct(this.getKey());if(e){const i=this.vt(t);s.drawImage(e,i.x-e.width/2,i.y-e.height)}else this.s(t).then(()=>this.pt(t,s))}else{this.wt(s);const e=t.St(this);t.xt(e,s,!1)}s.restore()}}}class Y extends class{constructor(t={}){this.type="geometry",this.name=t.name||b.at++,this.Ot=[]}}{constructor(t,s){super(s),Object.assign(this,t)}Bt(){const t=[];return this.Ot.forEach((s,e)=>{t[e]=[],s.forEach(s=>{t[e].push(new g(...this.Dt[s]))})}),t}It(){return this.Rt}}var J={Ot:[[0,4,6,2],[3,2,6,7],[7,6,4,5],[5,1,3,7],[1,0,2,3],[5,4,0,1]],Dt:[[.5,.5,.5],[.5,.5,-.5],[.5,-.5,.5],[.5,-.5,-.5],[-.5,.5,.5],[-.5,.5,-.5],[-.5,-.5,.5],[-.5,-.5,-.5]],Rt:[[0,0],[-1.57,1.57],[-3.14,1.57],[0,3.14],[-0,1.57],[1.57,1.57]]},X={Ot:[[2,0,1,3]],Dt:[[1,0,-0],[1,1,0],[0,0,-0],[0,1,0]],Rt:[[0,0]]},Q={Ot:[[4,2,6],[6,2,5],[3,2,4],[5,2,3]],Dt:[[.55,.45,1.02],[.55,.45,0],[.5,.5,3.07],[.88,.88,1.02],[.88,.12,1.02],[.12,.88,1.02],[.12,.12,1.02],[.25,.75,1.53],[.37,.63,2.04]],Rt:[[-1.57,1.39],[3.14,1.39],[0,1.39],[1.57,1.39]]},Z={Ot:[[2,6,8,4],[5,4,8,9],[9,8,6,7],[3,2,4,5],[7,6,2,3]],Dt:[[.55,.45,1.02],[.55,.45,0],[.79,.79,2.62],[.79,.79,1.02],[.79,.21,2.62],[.79,.21,1.02],[.21,.79,2.62],[.21,.79,1.02],[.21,.21,2.62],[.21,.21,1.02],[.25,.75,1.52],[.37,.63,2.03]],Rt:[[0,0],[-1.57,1.57],[-3.14,1.57],[-0,1.57],[1.57,1.57]]},tt={Ot:[[0,4,6,2],[3,2,6,7],[7,6,4,5],[1,0,2,3],[5,4,0,1]],Dt:[[.55,.55,1.02],[.55,.55,0],[.55,.45,1.02],[.55,.45,0],[.45,.55,1.02],[.45,.55,0],[.45,.45,1.02],[.45,.45,0],[.25,.75,1.52],[.37,.63,2.03]],Rt:[[0,0],[-1.57,1.57],[-3.14,1.57],[-0,1.57],[1.57,1.57]]},st={Ot:[[0,4,9],[1,0,5],[2,1,6],[3,2,7],[4,3,8],[0,9,5],[1,5,6],[2,6,7],[3,7,8],[4,8,9],[5,9,10],[6,5,10],[7,6,10],[8,7,10],[9,8,10]],Dt:[[.86,.24,0],[.36,.07,0],[.05,.5,0],[.36,.93,0],[.86,.76,0],[.64,.07,.45],[.14,.24,.45],[.14,.76,.45],[.64,.93,.45],[.95,.5,.45],[.5,.5,.72]],Rt:[[0,1.76],[-1.26,1.76],[-2.51,1.76],[2.51,1.76],[1.26,1.76],[-.63,1.38],[-1.88,1.38],[3.14,1.38],[1.88,1.38],[.63,1.38],[-.63,.65],[-1.88,.65],[3.14,.65],[1.88,.65],[.63,.65]]},et={Ot:[[11,13,22,32,20],[3,9,23,39,19],[2,3,1,0],[9,11,20,33,23],[5,7,21,30,17],[15,5,17,26,18],[6,7,5,4],[2,8,9,3],[1,3,19,27,16],[0,1,7,6],[10,11,9,8],[13,15,18,38,22],[7,1,16,36,21],[15,14,4,5],[14,15,13,12],[12,13,11,10],[25,35,24,31,37,28,34,29],[36,16,24,35,21],[18,29,34,22,38],[26,17,25,29,18],[20,28,37,23,33],[39,23,37,31,19],[30,21,35,25,17],[32,22,34,28,20],[27,19,31,24,16]],Dt:[[.64,.1,0],[.71,-.09,.43],[.89,.36,0],[1.08,.29,.43],[.1,.36,0],[-.09,.29,.43],[.36,.11,0],[.29,-.08,.43],[.9,.64,0],[1.09,.71,.43],[.64,.89,0],[.71,1.08,.43],[.36,.9,0],[.29,1.09,.43],[.11,.64,0],[-.08,.71,.43],[.71,-.09,.65],[-.09,.29,.65],[-.08,.71,.65],[1.08,.29,.65],[.71,1.08,.65],[.29,-.08,.65],[.29,1.09,.65],[1.09,.71,.65],[.58,.27,.95],[.27,.42,.95],[-.09,.5,.65],[.9,.1,.65],[.58,.73,.95],[.27,.58,.95],[.1,.1,.65],[.73,.42,.95],[.5,1.09,.65],[.9,.9,.65],[.42,.73,.95],[.42,.27,.95],[.5,-.09,.65],[.73,.58,.95],[.1,.9,.65],[1.09,.5,.65]],Rt:[[1.56,1.57],[-.01,1.57],[-.78,1.98],[.79,1.57],[-2.35,1.57],[3.13,1.57],[-2.35,1.98],[-.01,1.99],[-.78,1.57],[-1.58,1.99],[.79,1.98],[2.37,1.57],[-1.58,1.57],[3.13,1.99],[2.37,1.98],[1.56,1.99],[0,0],[-1.58,.7],[2.37,.71],[3.13,.7],[.79,.71],[-.01,.7],[-2.35,.71],[1.56,.7],[-.78,.71]]},it={Ot:[[0,1,3,2],[2,3,5,4],[3,1,8,5],[6,5,8,7],[7,8,1,0],[9,10,12,11],[11,12,5,13],[12,10,15,5],[4,5,15,14],[14,15,10,9],[16,17,19,18],[18,19,5,6],[19,17,22,5],[20,5,22,21],[21,22,17,16],[23,24,26,25],[25,26,5,20],[26,24,28,5],[13,5,28,27],[27,28,24,23]],Dt:[[.87,.13,0],[.87,.13,.11],[.64,.13,0],[.64,.13,.11],[.5,.36,0],[.5,.5,.11],[.64,.5,0],[.87,.37,0],[.87,.37,.11],[.13,.13,0],[.13,.13,.11],[.13,.36,0],[.13,.36,.11],[.36,.5,0],[.37,.13,0],[.37,.13,.11],[.87,.87,0],[.87,.87,.11],[.87,.64,0],[.87,.64,.11],[.5,.64,0],[.63,.87,0],[.63,.87,.11],[.13,.87,0],[.13,.87,.11],[.36,.87,0],[.36,.87,.11],[.13,.63,0],[.13,.63,.11]],Rt:[[-1.54,1.57],[-2.72,1.3],[0,0],[1.15,1.32],[-.01,1.57],[-3.11,1.57],[1.99,1.3],[0,0],[-.42,1.32],[-1.58,1.57],[.03,1.57],[-1.15,1.3],[0,0],[2.73,1.32],[1.56,1.57],[1.6,1.57],[.42,1.3],[0,0],[-1.99,1.32],[3.13,1.57]]},nt={Ot:[[0,1,2],[1,0,5],[0,2,3],[0,3,4],[0,4,5],[1,5,10],[2,1,6],[3,2,7],[4,3,8],[5,4,9],[1,10,6],[2,6,7],[3,7,8],[4,8,9],[5,9,10],[6,10,11],[7,6,11],[8,7,11],[9,8,11],[10,9,11],[12,14,13],[13,17,12],[12,15,14],[12,16,15],[12,17,16],[13,22,17],[14,18,13],[15,19,14],[16,20,15],[17,21,16],[13,18,22],[14,19,18],[15,20,19],[16,21,20],[17,22,21],[18,23,22],[19,23,18],[20,23,19],[21,23,20],[22,23,21]],Dt:[[1.02,-.02,.93],[1.17,0,1.03],[1.09,-.16,1.03],[.91,-.13,1.03],[.88,.05,1.03],[1.04,.13,1.03],[1.16,-.09,1.19],[1,-.17,1.19],[.87,-.04,1.19],[.95,.12,1.19],[1.13,.09,1.19],[1.02,-.02,1.28],[-.02,1.02,.93],[0,1.17,1.03],[-.16,1.09,1.03],[-.13,.91,1.03],[.05,.88,1.03],[.13,1.04,1.03],[-.09,1.16,1.19],[-.17,1,1.19],[-.04,.87,1.19],[.12,.95,1.19],[.09,1.13,1.19],[-.02,1.02,1.28]],Rt:[[-.47,2.49],[.79,2.49],[-1.73,2.49],[-2.98,2.49],[2.04,2.49],[.79,1.76],[-.47,1.76],[-1.73,1.76],[-2.98,1.76],[2.04,1.76],[.16,1.38],[-1.1,1.38],[-2.36,1.38],[2.67,1.38],[1.41,1.38],[.16,.65],[-1.1,.65],[-2.36,.65],[2.67,.65],[1.41,.65],[2.04,2.49],[.79,2.49],[-2.98,2.49],[-1.73,2.49],[-.47,2.49],[.79,1.76],[2.04,1.76],[-2.98,1.76],[-1.73,1.76],[-.47,1.76],[1.41,1.38],[2.67,1.38],[-2.36,1.38],[-1.1,1.38],[.16,1.38],[1.41,.65],[2.67,.65],[-2.36,.65],[-1.1,.65],[.16,.65]]},ht={Ot:[[0,4,1],[1,4,2],[2,4,3],[3,4,0],[5,9,6],[6,9,7],[7,9,8],[8,9,5]],Dt:[[.19,.81,.88],[.19,.19,.88],[.81,.19,.88],[.81,.81,.88],[.5,.5,0],[.19,.81,.88],[.81,.81,.88],[.81,.19,.88],[.19,.19,.88],[.5,.5,1.75]],Rt:[[-3.14,1.91],[-1.57,1.91],[0,1.91],[1.57,1.91],[1.57,1.23],[0,1.23],[-1.57,1.23],[-3.14,1.23]]},at={Ot:[[0,4,5,1],[1,5,6,2],[3,7,4,0],[8,0,1,9],[9,1,2,10],[11,3,0,8]],Dt:[[.89,.89,.88],[.85,.85,.97],[.77,.77,.97],[.85,.85,.78],[.11,.89,.88],[.15,.85,.97],[.23,.77,.97],[.15,.85,.78],[.89,.11,.88],[.85,.15,.97],[.77,.23,.97],[.85,.15,.78]],Rt:[[1.57,1.18],[0,0],[1.57,1.96],[0,1.18],[0,0],[0,1.96]]},ot={Ot:[[0,4,5,1],[1,5,6,2],[3,7,4,0],[4,8,9,5],[5,9,10,6],[7,11,8,4]],Dt:[[.11,.89,.88],[.15,.85,.97],[.23,.77,.97],[.15,.85,.78],[.11,.11,.88],[.15,.15,.97],[.23,.23,.97],[.15,.15,.78],[.89,.11,.88],[.85,.15,.97],[.77,.23,.97],[.85,.15,.78]],Rt:[[-3.14,1.18],[0,0],[-3.14,1.96],[-1.57,1.18],[0,0],[-1.57,1.96]]},rt={Ot:[[0,1,2]],Dt:[[.37,-.37,1.64],[0,0,1.12],[-.37,.37,1.64]],Rt:[[.79,1.57]]},lt={Ot:[[0,1,2]],Dt:[[-.37,.37,1.64],[0,0,1.5],[.37,-.37,1.64]],Rt:[[-2.36,1.57]]},ct={Ot:[[0,1,2,3]],Dt:[[-.37,.37,1.64],[0,0,1.12],[.37,-.37,1.64],[0,-0,1.5]],Rt:[[-2.36,1.57]]},wt={Ot:[[1,2,3,4,5,6,7,0]],Dt:[[.5,.94,0],[.19,.81,0],[.06,.5,0],[.19,.19,0],[.5,.06,0],[.81,.19,0],[.94,.5,0],[.81,.81,0]],Rt:[[0,0]]},ut={Ot:[[0,1,3,2],[2,3,7,6],[6,7,5,4],[4,5,1,0],[7,3,1,5],[8,9,11,10],[10,11,15,14],[14,15,13,12],[12,13,9,8],[16,17,18],[17,16,21],[16,18,19],[16,19,20],[16,20,21],[17,21,26],[18,17,22],[19,18,23],[20,19,24],[21,20,25],[17,26,22],[18,22,23],[19,23,24],[20,24,25],[21,25,26],[22,26,27],[23,22,27],[24,23,27],[25,24,27],[26,25,27]],Dt:[[-.05,-.05,0],[-.05,-.05,2],[-.05,.05,0],[-.05,.05,2],[.05,-.05,0],[.05,-.05,2],[.05,.05,0],[.05,.05,2],[.03,-.02,1.96],[.55,.49,1.25],[-.02,.03,1.96],[.49,.55,1.25],[-0,-.05,1.91],[.51,.45,1.19],[-.05,-0,1.91],[.45,.51,1.19],[.5,.5,.55],[.97,.57,.84],[.72,.08,.84],[.16,.16,.84],[.08,.72,.84],[.57,.97,.84],[.92,.28,1.32],[.43,.03,1.32],[.03,.43,1.32],[.28,.92,1.32],[.84,.84,1.32],[.5,.5,1.61]],Rt:[[-3.14,1.57],[1.57,1.57],[-0,1.57],[-1.57,1.57],[0,0],[.79,.78],[2.36,1.56],[-2.36,2.35],[-.79,1.56],[-.47,2.49],[.79,2.49],[-1.73,2.49],[-2.98,2.49],[2.04,2.49],[.79,1.76],[-.47,1.76],[-1.73,1.76],[-2.98,1.76],[2.04,1.76],[.16,1.38],[-1.1,1.38],[-2.36,1.38],[2.67,1.38],[1.41,1.38],[.16,.65],[-1.1,.65],[-2.36,.65],[2.67,.65],[1.41,.65]]},yt={Ot:[[1,2,4],[4,2,3],[3,0,1,4],[0,2,1],[3,2,0]],Dt:[[1,1,0],[1,0,0],[.5,.5,1],[0,1,0],[0,0,0]],Rt:[[-1.57,1.11],[3.14,1.11],[0,3.14],[0,1.11],[1.57,1.11]]},dt={Ot:[[6,1,7],[7,1,4,8],[8,4,9],[9,4,1,6],[0,2,14,15],[12,9,6,13],[11,8,9,12],[10,7,8,11],[13,6,7,10],[0,13,10,2],[2,10,11,5],[5,11,12,3],[3,12,13,0],[14,16,17,15],[3,0,15,17],[5,3,17,16],[2,5,16,14]],Dt:[[-.6,.48,.43],[-.99,.58,1.39],[-.54,.46,.47],[-.61,.45,.43],[-1,.55,1.39],[-.55,.44,.47],[-1,.58,1.21],[-.95,.57,1.32],[-.96,.54,1.32],[-1,.55,1.21],[-.55,.47,.5],[-.56,.44,.5],[-.63,.46,.46],[-.62,.49,.46],[-.46,.44,.31],[-.52,.46,.28],[-.47,.42,.31],[-.53,.43,.28]],Rt:[[1.32,1.57],[-.25,1.1],[-1.82,1.57],[2.89,1.52],[1.32,1.57],[2.89,2.05],[-1.82,1.57],[-.25,1.1],[1.32,1.57],[1.28,1.64],[-.25,1.3],[-1.79,1.64],[2.89,2.25],[-.25,2.67],[2.89,2.05],[-1.82,1.57],[-.25,1.1]]};const pt=new Y({Ot:[[3,4,5],[4,3,8],[3,5,6],[3,6,7],[3,7,8],[4,8,13],[5,4,9],[6,5,10],[7,6,11],[8,7,12],[4,13,9],[5,9,10],[6,10,11],[7,11,12],[8,12,13],[9,13,14],[10,9,14],[11,10,14],[12,11,14],[13,12,14]],Dt:[[.45,.45,1.02],[.45,.45,0],[.37,.63,2.03],[.5,.5,.87],[.99,.14,1.39],[.31,-.08,1.39],[-.11,.5,1.39],[.31,1.08,1.39],[.99,.86,1.39],[.69,-.08,2.24],[.01,.14,2.24],[.01,.86,2.24],[.69,1.08,2.24],[1.11,.5,2.24],[.5,.5,2.77]],Rt:[[-1.26,2.32],[0,2.32],[-2.51,2.32],[2.51,2.32],[1.26,2.32],[0,1.71],[-1.26,1.71],[-2.51,1.71],[2.51,1.71],[1.26,1.71],[-.63,1.43],[-1.88,1.43],[3.14,1.43],[1.88,1.43],[.63,1.43],[-.63,.82],[-1.88,.82],[3.14,.82],[1.88,.82],[.63,.82]]},{name:"tree1"}),mt=new Y(Q,{name:"tree2"}),ft=new Y(Z,{name:"tree3"}),bt=new Y(tt,{name:"trunk"}),gt=new Y(J,{name:"box"}),Mt=new Y(X,{name:"square"}),kt=new Y(st,{name:"rock"}),vt=new Y(et,{name:"bush"}),St=new Y(it,{name:"grass"}),Ft=(new Y(nt),new Y(at)),xt=new Y(ot),At=new Y(ht),Et=new Y(rt),Tt=(new Y(lt),new Y(ct),new Y(wt)),Ct=(new Y(ut),new Y(yt)),Ot=new Y(dt),Bt={pyramid:t=>new K(Ct,t),square:t=>new K(Mt,t),box:t=>new K(gt,t),jt:t=>new K(Mt,{...t,style:[I,A]}),tileGroup:()=>{const t=new v;for(let s=0,e=b.Ft.Lt();s<=e;s++)for(let i=0,n=b.Ft.Gt();i<=n;i++)t.add(Bt.jt({position:new g(s-e/2-.5,i-n/2-.5,0)}));return t},whiteTile:t=>new K(Mt,{...t,style:[C,A]}),Pt:()=>new K(bt,{style:L}),zt:()=>new K(Tt,{position:new g(0,0,0),style:G}),qt:()=>new K(pt,{style:B}),Nt:()=>new K(mt,{style:B}),Ht:()=>new K(ft,{style:B}),tree1:t=>new v([Bt.zt(),Bt.Pt(),Bt.qt()],t),tree2:t=>new v([Bt.zt(),Bt.Pt(),Bt.Nt()],t),tree3:t=>new v([Bt.zt(),Bt.Pt(),Bt.Ht()],t),grass:t=>new K(St,{...t,style:D}),grassOrange:t=>new K(St,{...t,style:z}),grassPurple:t=>new K(St,{...t,style:V}),bush:t=>new K(vt,{...t,style:D}),stream:t=>new K(Mt,{...t,style:O}),bridge:t=>new K(Mt,{...t,style:L}),rock:t=>new K(kt,{...t,style:$}),$t:()=>new K(Ot,{style:[j,E],gt:!1,position:new g(0,0,0),enabled:!1}),Ut:()=>new K(Ot,{style:[q,E],gt:!1,position:new g(0,0,0),enabled:!1}),Wt:()=>new K(Ot,{style:[N,E],gt:!1,position:new g(0,0,0),enabled:!1}),Vt:()=>new K(Ot,{style:[H,E],gt:!1,position:new g(0,0,0),enabled:!1}),_t:()=>new K(Ot,{style:[V,E],gt:!1,position:new g(0,0,0),enabled:!1}),Kt:()=>new K(Tt,{style:[T,E]}),Yt:()=>new K(At,{style:W}),Jt:()=>new K(Et,{style:[j,E],gt:!1,position:new g(.5,.5,0)}),Xt:()=>new K(Ft,{style:[U]}),Qt:()=>new K(xt,{style:[U]}),Zt:()=>new v([Bt.Kt(),Bt.Qt(),Bt.Yt(),Bt.Xt()]),ts:t=>new v([Bt.Zt(),Bt.Jt(),Bt.$t()],{...t}),building:(t={})=>new v([Bt.box({scale:new g(2,2,2),style:t.style||[]}),Bt.pyramid({scale:new g(2,2,1),position:new g(0,0,2+(t.scale?t.scale.z:0)),style:L})],{position:t.position,scale:t.scale,style:[S,F,x]})};let Dt=0;class It{constructor(t,s,e,i,n={},h=b.lt){const[a,o]=b.es.ss(e,i);switch(Object.assign(this,{start:t,type:s,ns:h,hs:e,as:i,x:a,y:o,...n}),this.id=Dt++,s){case"breaks":this.os=[,,,,,,,,,,].fill().map(()=>-.5+Math.random())}}pt(t){const s=b.Ft.St(new g(this.x+.5,this.y+.5,0));switch(this.ns.save(),this.type){case"breaks":this.rs(t,s.x,s.y);break;case"gold":this.ls(t,s.x,s.y)}this.ns.restore()}rs(t,s,e){this.ns.save();const i=(t-this.start)/1e3;i>1&&b.es.cs(this.id),this.ns.fillStyle=`rgba(255, 255, 255, ${1-i})`;for(let t=0;t<5;t++)this.ns.beginPath(),this.ns.arc(s+i*b.bt.width()*this.os[t]/10,e+i*b.bt.height()*this.os[t+1]/10,5,0,a),this.ns.closePath(),this.ns.fill();this.ns.restore()}ls(t,s,e){this.ns.save();const i=(t-this.start)/1e3;i>1&&b.es.cs(this.id),this.ns.fillStyle="gold",this.ns.beginPath(),this.ns.fillText("+"+this.ws,s+b.bt.width(.02),e-Math.min(1,2*i)*b.bt.height(.1)),this.ns.arc(s,e-Math.min(1,2*i)*b.bt.height(.1),b.bt.height(.02),0,a),this.ns.closePath(),this.ns.fill(),this.ns.restore()}}const Rt=[{name:"basic-machete",us:.05,ys:500,ds:.05,ps:Math.PI/4},{name:"bronze-machete",us:.075,ms:250,ys:450,ds:.07,ps:Math.PI/3.5},{name:"steel-machete",us:.15,ms:750,ys:400,ds:.08,ps:Math.PI/3},{name:"mythril-machete",us:.3,ms:2e3,ys:300,ds:.1,ps:Math.PI/2.5},{name:"magic-machete",us:.5,ms:5e3,ys:200,ds:.15,ps:Math.PI/2}];const jt=(t,s,e,i={x:16,y:9})=>{const{width:n,height:h}=s.getBoundingClientRect(),a=Math.min(n/i.x,h/i.y),o=i.x*a-2,r=i.y*a-2;t.forEach(t=>{const s=window.devicePixelRatio||1;t.style.width=o+"px",t.style.height=r+"px",e&&(t.width=o*s,t.height=r*s)})};(t=>{t.fs=8,t.Tt=!0,t.bs="function"==typeof OffscreenCanvasRenderingContext2D,t.gs="function"==typeof createImageBitmap,t.o={Ms:y("viz"),ks:y("post"),vs:y("blur"),Ss:y("root"),Fs:document.body,xs:document.documentElement,As:y("shop"),h:y("dialogue"),Es:y("landing"),Ts:[y("br-ma"),y("st-ma"),y("my-ma"),y("ma-ma")]},t.Cs=!0,t.Os=t.o.vs.getContext("2d"),t.Os.filter="blur(20px)",t.lt=t.o.Ms.getContext("2d",{alpha:!0}),t.Bs=t.o.ks.getContext("2d",{alpha:!0}),t.Ds=8,t.Is,t.Rs,t.js=new m})(b),(()=>{const t=[b.o.Ms,b.o.ks,b.o.vs];jt(t,b.o.Ss,!0),window.addEventListener("resize",()=>jt(t,b.o.Ss,!1))})(),(t=>{t.Ls=window.devicePixelRatio||1,t.bt=new f(t.o.Ms),t.Gs=t.lt.createRadialGradient(t.bt.nt(0),t.bt.ht(0),t.bt.height(.25),t.bt.nt(0),t.bt.ht(0),t.bt.height()),t.Gs.addColorStop(0,"rgba(255, 255, 255, 0)"),t.Gs.addColorStop(.5,"rgba(255, 255, 255, .5)"),t.Gs.addColorStop(1,"rgba(255, 255, 255, 1)"),t.Ps=t.bt.height(.05),t.zs=t.bt.height(.005),t.lt.textAlign="left",t.lt.textBaseline="middle",t.lt.font=`${t.bt.height(.025)}px "Papyrus", Fantasy`})(b),b.qs=new class{constructor(){this.position=new g(-15,-9,0),this.Ns=0,this.Hs="swing",this.$s=!1,this.Us=[],this.Ws=null,this.Vs=null,this._s=.003,this.Ks=.005,this.Ys=this._s/2,this.Js=.1,this.Xs=!1,this.Qs=!1,this.Zs=!1,this.te=[],this.se=10,this.ee=10,this.ie=o(2e3,-5,5),this.ne=0,this.he=0,this.ae=0,this.oe=100,this.re="None",this.le=0,this.ce=this.we(),this.ue=0}ye(t){let s;switch(this.Ws=t,this.de=Rt.find(s=>s.name===t),this.te.push(t),t){case"basic-machete":s=Bt.$t();break;case"bronze-machete":s=Bt.Ut();break;case"steel-machete":s=Bt.Wt();break;case"mythril-machete":s=Bt.Vt();break;case"magic-machete":s=Bt._t()}this.pe&&this.ce.remove(this.pe),this.ce.add(s),s.enabled=!0,this.pe=s}we(){const t=Bt.ts({position:this.position});return this.face=t.children[1],this.pe=t.children[2],this.face.rotation.z,t}me(t,s,e){let i=t-s;i>h?i=t-a-s:i<-h&&(i=t+a-s);const n=s+i*e;return this.ue=n<0?(n+a)/a%1:n/a%1,n}fe(t){return this.$s?(this.be(this.Hs,t),this.$s=!1,!0):this.Us.length>0}ge(t){if(this.Us.length){b.lt.save();for(let s=0;s<this.Us.length;s++)this.Me(t,this.Us[s]);return b.lt.restore(),!0}return!1}ke(t,s){if(!t&&!s)return[0,0];const e=Math.trunc(this.position.x+t-.5),i=Math.trunc(this.position.y+s-.5),[n,h]=b.es.ve(e,i),a=b.es.Se(n,h);if(a){if(a.type.includes("blocks")&&b.Cs)return[0,0];a.type.includes("home")&&this.ee!==this.se&&(this.Zs=!0,this.be("rest",b.Rs)),a.type.includes("shop")&&(this.Fe=!0,Gt()),a.xe&&(t*=1-a.xe,s*=1-a.xe)}else this.Fe&&(this.Fe=!1,Pt());return this.Ae=this.le,n>30?(this.le=1+n/500*9,this.le<3?this.re="Low":this.le<6?this.re="Harmful":this.le<9?this.re="Extreme":this.re="EXCRUCIATING"):(this.le=0,this.re="None"),this.Ae!==this.le&&(b.Bs.fillStyle=R.fillStyle,b.Bs.globalAlpha=this.le/20,b.Bs.clearRect(0,0,b.bt.width(),b.bt.height()),b.Bs.fillRect(0,0,b.bt.width(),b.bt.height())),[t,s]}Ee(){if(this.Zs||b.Te)return!1;const t=b.Ce*this._s,s=b.Ce*this.Ks;let e=0,i=0,n=0;this.Oe&&!this.Be?this.De?(e=-t,n=3*h/4):this.Ie?(i=t,n=h/4):(e=-t/2,i=t/2,n=h/2):this.Be&&!this.Oe?this.De?(i=-t,n=5*h/4):this.Ie?(e=t,n=7*h/4):(e=+t/2,i=-t/2,n=-h/2):this.De&&!this.Ie?(e=-t,i=-t,n=h):this.Ie&&!this.De&&(e=t,i=t,n=2*h),[e,i]=this.ke(e,i);const a=0!==e||0!==i;if(a){const t=this.me(n,this.face.rotation.z,s);this.face.rotation.z=t,this.pe.rotation.z=t,this.position.x+=e,this.position.y+=i,this.face.position.x=.5+this.Js*Math.cos(Math.PI/4+this.face.rotation.z),this.face.position.y=.5+this.Js*Math.sin(Math.PI/4+this.face.rotation.z)}return a}Re(t){switch(t.keyCode){case 32:this.$s=!0;break;case 38:case 87:this.De=!0;break;case 37:case 65:this.Oe=!0;break;case 40:case 83:this.Ie=!0;break;case 39:case 68:this.Be=!0}}je(t){switch(t.keyCode){case 38:case 87:this.De=!1;break;case 37:case 65:this.Oe=!1;break;case 40:case 83:this.Ie=!1;break;case 39:case 68:this.Be=!1}}be(t,s){if("swing"===t){if(this.Qs)return;this.Qs=!0}this.Us.push({id:this.Ns++,type:t,start:s})}Me(t,s){switch(s.type){case"swing":this.Le(t,s);break;case"rest":this.Ge(t,s)}}cs(t){this.Us=this.Us.filter(s=>s.id!==t)}Ge(t,s){const e=(t-s.start)/5;if(e>1e3)return this.cs(s.id),this.ee=this.se,void(this.Zs=!1);b.Ft.Pe=b.fs-this.ie(e)}Le(t,s,e=b.lt){if(this.Ws){e.save();const i=(t-s.start)/this.de.ys;if(i>1)this.cs(s.id),this.Qs=!1,this.pe.rotation.z=this.face.rotation.z,this.pe.rotation.y=0;else{e.fillStyle=`rgba(255, 255, 255, ${.55-.55*i*.8})`,e.setTransform(2,0,0,1,-b.bt.width(.5),0);const s=this.position.clone().translate(new g(.5,.5,0));b.Ft.St(s);const n=s.x,a=s.y,o=n+b.bt.width(this.de.ds),l=this.face.rotation.z+h/2+this.de.ps/2,c=l-i*this.de.ps,w=r(o,a,n,a,l),u=r(o,a,n,a,c);this.pe.rotation.z=Math.PI+c,this.pe.rotation.y=Math.PI/2*i;const y=b.bt.nt(0)-u.x,d=u.y-b.bt.ht(0);for(let s=0,e=5;s<=e;s++){const i=b.Ft.ze(new g(u.x-y*(s/e),u.y-d*(s/e),0)),[n,h]=b.es.ve(Math.round(i.x-.5),Math.round(i.y-.5)),a=b.es.Se(n,h);a&&!a.action&&a.type.includes("breaks")&&(b.es.qe(new It(t,"breaks",n,h)),a.Ne-=this.de.us,this.ee-=this.de.us,this.he+=100*this.de.us,this.he-this.ae>this.oe&&(this.ee+=1,this._s+=2e-4,this.se+=1,this.oe+=100,this.ae=this.he,p("Level Up! (+1 life)",2e3)),a.Ne<=0&&(b.es.He[n][h]={action:a.action,type:""},a.$e&&a.$e>=Math.random()&&(b.es.qe(new It(t,"gold",n,h,{ws:a.ws})),this.ne+=a.ws)))}e.beginPath(),e.moveTo(n,a),e.lineTo(w.x,w.y),e.lineTo(u.x,u.y),e.closePath(),e.fill(),e.restore()}}}},b.Ft=new class extends k{constructor(){super(),this.Pe=8,this.Ue={}}Ct(t){return this.Ue.hasOwnProperty(t)&&this.Ue[t]}Et(t,s){this.Ue[t]=s}Lt(){const t=this.St(new g(0,0,0)),s=this.St(new g(1,0,0));return Math.ceil(b.bt.width()/(s.x-t.x))}Gt(){const t=this.St(new g(0,0,0)),s=this.St(new g(0,1,0));return Math.ceil(b.bt.height()/(s.y-t.y))}We(t){const s=b.bt.height()/this.Pe;t.x=b.bt.nt(0)+t.x*s,t.y=b.bt.ht(0)+t.y*s}Ve(t){t.x-=this.position.x,t.y-=this.position.y,c(t,"z",l(45)),c(t,"x",l(60)),this.We(t)}_e(t,s,e){(!t[2]||e.x>t[2])&&(t[2]=e.x),(!t[3]||e.y>t[3])&&(t[3]=Math.max(e.y,s.y)),(e.x<t[0]||!t[0])&&(t[0]=e.x),(e.y<t[1]||!t[1])&&(t[1]=e.y)}St(t){if("mesh"===t.type){const s=t.dt(),e=t.yt(),i=t.ut(),n=[...t.kt.Bt()];for(let t=0;t<n.length;t++){const h=n[t];for(let t=0;t<h.length;t++){const n=h[t];n.x*=s.x,n.y*=s.y,n.z*=s.z,e.x&&c(n,"x",e.x),e.y&&c(n,"y",e.y),e.z&&c(n,"z",e.z),n.translate(i),h[t]=n}}const h=t.kt.It();let a,o,r=n.map((t,s)=>({face:t,Ke:h[s]}));r.sort((t,s)=>t.face.map(t=>t.x+t.y+t.z).reduce((t,s)=>t+s)/t.face.length<s.face.map(t=>t.x+t.y+t.z).reduce((t,s)=>t+s)/s.face.length?-1:1),r=r.filter(t=>t.Ke[0]>=-l(45)&&t.Ke[1]>=0),o=t.box,a=t.ut().clone().translate(new g(1,1,0)),this.Ve(a);for(let t=0;t<r.length;t++){const s=r[t].face;for(let t=0;t<s.length;t++){const e=s[t];this.Ve(e),this._e(o,a,e)}}return r}if("point"===t.type)return this.Ve(t),t}async At(t){return b.gs?createImageBitmap(t,0,0,t.width,t.height):new Promise(s=>{const e=new Image;e.addEventListener("load",()=>{s(e)},!1);const i=t.toDataURL();e.src=i})}Ye(t){const s=b.bt.height()/(this.Pe||1);t.x=(t.x-b.bt.nt(0))/s,t.y=(t.y-b.bt.ht(0))/(s/4),t.z=0}ze(t){return this.Ye(t),c(t,"x",l(60),!0),c(t,"z",l(45),!0),t.x+=1*this.position.x,t.y+=1*this.position.y,t}xt(t,s,e=!1,i={}){const n=i.fill||!0,h=i.stroke||!0,a=i.Je||!0,o=e?-1*e[0]:0,r=e?-1*e[1]:0;t.forEach(t=>{const e=t.Ke[0]/Math.PI,i=t.Ke[1]/Math.PI;s.beginPath(),t.face.forEach((t,e)=>{0===e?s.moveTo(t.x+o,t.y+r):s.lineTo(t.x+o,t.y+r)}),s.closePath(),n&&(s.save(),s.fill(),a&&(s.fillStyle=`rgba(0, 0, 0, ${.5*e+.5*i})`,s.fill()),s.restore()),h&&s.stroke()})}},b.Ft.position.set(b.qs.position),b.es=new class{constructor(){this.height=195,this.width=31,this.Xe=(this.width-1)/2,this.Qe=(this.height-1)/2,this.Ze=9,this.ti=3,this.He=[],this.si=[],this.Ns=0,this.ei=this.ve(Math.floor(-1*b.Ft.Lt()/4)-1,Math.floor(-1*b.Ft.Gt()/4)-1),this.ii={},this.ni()}qe(t){this.He[t.hs][t.as].action=t,this.si.push(t)}cs(t){this.si=this.si.filter(s=>{const e=s.id===t;return e&&(this.He[s.hs][s.as].action=null),!e})}Se(t,s){return t>=0&&t<b.es.height&&s>=0&&s<b.es.width&&this.He[t][s]}ss(t,s){const e=s-this.Xe,i=t/2;let n,h;return t%2==0?(n=-1*t/2,h=n):(n=-1*Math.ceil(i),h=-1*Math.floor(i)),[n+e,h-e]}ve(t,s){let e,i,n=-1*[t+s];if(n%2==0){i=t-n/2*-1}else{i=t- -1*(n+1)/2}return e=this.Xe+i,[n,e]}hi(t){return this.ii[t]}ai(){const t=[];return b.Tt&&Object.entries(Bt).forEach(s=>{const e=s[0],i=s[1]();_.add(i),this.ii[e]=i,"mesh"===i.type&&t.push(i.s())}),Promise.all(t)}ni(){for(let t=0;t<this.height;t++){this.He.push([]);for(let s=0;s<this.width;s++){const e=this.oi(t,s);this.He[t][s]=e}}}ri(t,s,e,i,n,h,a){return{li:Bt[t](s),action:!1,type:e||"",Ne:i,$e:n,ws:h,xe:a}}oi(t,s){const e=w(),i=t/500,[n,h]=this.ss(t,s),a=new g(n,h,0);return s<=1||s>=this.width-2||t<=2?this.ri("rock",{position:a},"blocks"):(-2===h||-1===h)&&-18!==n&&s>=6&&s<=8?this.ri("bridge",{position:a}):s>=6&&s<=8?this.ri("stream",{position:a},"blocks"):25===t&&11===s?this.ri("building",{position:a,style:U},!1):27===t&&12===s||24===t&&10===s?this.ri("tree1",{position:a},"blocks"):25===t&&12===s||24===t&&11===s?this.ri("whiteTile",{position:a},"home"):22===t&&19===s||23===t&&19===s?this.ri("whiteTile",{position:a},"shop"):27===t&&18===s||20===t&&21===s||21===t&&22===s?this.ri("tree1",{position:a},"blocks"):25===t&&19===s?this.ri("building",{position:a,style:P},!1):23===t&&20===s?this.ri("building",{position:a,style:P,scale:new g(1,1,2)},!1):21===t&&21===s?this.ri("building",{position:a,style:P},!1):t<=30&&t>27&&(s<14||s>16)?this.ri("rock",{position:a},"blocks"):t<=30&&t>27?this.ri("bush",{position:a},"blocks.breaks",.15):t<=22&&s>1&&s<this.width-2&&e<.1?this.ri("grass",{position:a},"breaks",.05,.2,5,.4):t>30?e<.04?this.ri("tree1",{position:a},"breaks.blocks",1,.75,100):e<.08?this.ri("tree2",{position:a},"breaks.blocks",1,.75,100):e<.12?this.ri("tree3",{position:a},"breaks.blocks",1,.75,100):e<.16?this.ri("rock",{position:a},"blocks"):e>1-i/4?this.ri("grassPurple",{position:a},"breaks",.1,.3,30,.4):t>90&&e>1-i/3.5?this.ri("grassOrange",{position:a},"breaks",.3,.5,100,.4):this.ri("grass",{position:a},"breaks",.05,.2,5,.4):null}};const Lt=()=>{const t=Math.floor(b.qs.position.x),s=Math.ceil(b.qs.position.y);null===t&&null===s||(b.es.hi("tileGroup").position.x=t,b.es.hi("tileGroup").position.y=s,b.es.hi("tileGroup").pt(b.Ft,b.lt))},Gt=()=>{const t=()=>{b.o.Ts.forEach((t,s)=>{const e=Rt[s+1];b.qs.te.includes(e.name)?t.style.color=B.fillStyle:e.ms<=b.qs.ne&&!b.qs.te.includes(e.name)?(t.style.color="white",s<=4&&(t.onclick=()=>{b.qs.ye(e.name)})):t.style.color="darkgrey"})};b.qs.Ws?(b.o.As.style.height=b.o.Ms.style.height,b.o.As.style.display="flex",t()):(async()=>(b.Te=!0,b.o.As.display="none",b.o.Es.display="none",b.Bs.save(),b.Bs.globalAlpha=1,b.Bs.fillStyle="rgba(0,0,0,.5)",b.Bs.fillRect(0,0,b.bt.width(),b.bt.height()),b.o.h.innerText="Glad to see you're feeling better.\n",await d(3e3),b.o.h.innerText="If you're planning to find your friend, you'll need to be prepared.\n",await d(5e3),b.o.h.innerText="The woods outside of town are a forbidden land.\n",await d(5e3),b.o.h.innerText+="The air is thick with a cursed haze that will consume you.\n",await d(5e3),b.o.h.innerText+="Every second you spend there will deplete your life force.\n",await d(5e3),b.o.h.innerText="If you don't come back to rest often, you will surely lose your way and perish.\n",await d(8e3),b.o.h.innerText="Your journey will also be slowed by the the thick, untamed growth.",await d(5e3),b.o.h.innerText="Here, take this machete. It's the only way you'll be able to make a path.",await d(5e3),b.o.h.innerText="Remember not to over-work yourself. \nWhen you are near exhaustion, come back and rest. \nThat way we won't have to rescue you again...",await d(8e3),b.o.h.innerText="Good luck! Come back if you need anything else.",await d(3e3),b.o.h.innerText="",b.qs.ye("basic-machete"),b.Bs.clearRect(0,0,b.bt.width(),b.bt.height()),b.Bs.restore(),zt(),b.o.As.display="block",b.Te=!1,!0))().then(()=>{b.o.As.style.height=b.o.Ms.style.height,b.o.As.style.display="flex",t()})},Pt=()=>{b.o.As.style.display="none"},zt=t=>{b.lt.clearRect(0,0,b.o.Ms.width,b.o.Ms.height),Lt(),b.qs.ge(t);let s=Math.ceil(b.qs.ce.position.x),e=Math.ceil(b.qs.ce.position.y);const[i,n]=b.es.ve(s,e),[h,a]=b.es.ei;for(let t=i+h+1,s=i-h-b.Ds;t>s;t--)for(let s=n-a,e=n+a;s<e;s++){const e=b.es.Se(t,s);if(e){const i=e.li,n=e.action;i&&i.pt(b.Ft,b.lt),n&&n.pt(b.Rs,t,s)}t===i&&s===n&&(b.qs.pe&&b.qs.ue>=.2&&b.qs.ue<=.7&&b.qs.pe.pt(b.Ft,b.lt),b.qs.ue>.3&&b.qs.ue<.7?(b.qs.face.pt(b.Ft,b.lt),b.qs.ce.children[0].pt(b.Ft,b.lt)):(b.qs.ce.children[0].pt(b.Ft,b.lt),b.qs.face.pt(b.Ft,b.lt)),b.qs.pe&&(b.qs.ue<.2||b.qs.ue>.7)&&b.qs.pe.pt(b.Ft,b.lt))}},qt=t=>{b.js.update(t),b.Rs=t,b.Ce=t-b.ci;const s=b.es.si.length>0,e=b.qs.fe(t),i=b.qs.Ee(t);(i||e||s||0===t)&&(i&&b.Ft.position.set(b.qs.position),zt(t)),b.qs.ee-=1e-4*b.qs.le*(b.Ce||0),b.qs.ee<=0&&(b.qs.ee=b.qs.se,b.qs.position.x=-15,b.qs.position.y=-9,b.Ft.position.set(b.qs.position)),(()=>{b.lt.save(),b.lt.fillStyle="black",b.lt.strokeStyle="green",b.lt.lineWidth=b.bt.height(.005),b.lt.fillRect(b.bt.nt(-1),b.bt.ht(1)-b.Ps,b.bt.width(),b.Ps),b.lt.strokeRect(b.bt.nt(-.5)-b.lt.lineWidth,b.bt.ht(1)-b.Ps+b.lt.lineWidth/2,b.bt.width(.25),b.Ps-b.lt.lineWidth);const t=b.qs.ee/b.qs.se;b.lt.fillStyle=t<.3?"red":"green",b.lt.fillRect(b.bt.nt(-.5)-b.lt.lineWidth+3*b.lt.lineWidth/2,b.bt.ht(1)-b.Ps+2*b.lt.lineWidth,(b.bt.width(.25)-6*b.lt.lineWidth/2)*t,b.Ps-4*b.lt.lineWidth),b.lt.fillStyle="white",b.lt.fillText(Math.round(b.qs.ee),b.bt.nt(-.5)-b.lt.lineWidth/2+3*b.lt.lineWidth,b.bt.ht(1)-b.Ps/2),b.lt.strokeStyle=R.fillStyle,b.lt.strokeRect(b.bt.nt(0)+b.lt.lineWidth,b.bt.ht(1)-b.Ps+b.lt.lineWidth/2,b.bt.width(.25),b.Ps-b.lt.lineWidth),b.lt.fillStyle=R.fillStyle,b.lt.fillRect(b.bt.nt(0)+b.lt.lineWidth+3*b.lt.lineWidth/2,b.bt.ht(1)-b.Ps+2*b.lt.lineWidth,(b.bt.width(.25)-6*b.lt.lineWidth/2)*(b.qs.le/10),b.Ps-4*b.lt.lineWidth),b.lt.fillStyle="white",b.lt.fillText(`Haze: ${b.qs.re}`,b.bt.nt(0)+b.lt.lineWidth+3*b.lt.lineWidth,b.bt.ht(1)-b.Ps/2),b.lt.fillText(`${b.qs.ne}g`,b.bt.nt(-.75),b.bt.ht(1)-b.Ps/2),b.lt.fillText(`${b.qs.he} exp`,b.bt.nt(.75),b.bt.ht(1)-b.Ps/2),b.lt.restore()})(),b.ci=t,b.Is=window.requestAnimationFrame(qt)};b.o.Ms.addEventListener("contextmenu",t=>t.preventDefault()),window.addEventListener("keydown",t=>{b.qs.Re(t)}),window.addEventListener("keyup",t=>{b.qs.je(t)});return b.es.ai().then(()=>{(t=>{b.lt.fillStyle="rgba(0,0,0,.5)";const s=o(1e4,1,8,15e3),e=t=>{b.js.update(t),b.lt.clearRect(0,0,b.bt.width(),b.bt.height()),b.Ft.Pe=s(t),Lt(),b.lt.fillRect(0,0,b.bt.width(),b.bt.height()),b.Is=window.requestAnimationFrame(e)};b.Is=window.requestAnimationFrame(e)})(),document.getElementById("start").onclick=()=>{b.js.start(),(async()=>(b.o.Es.style.opacity=0,await d(2e3),b.o.Es.style.display="none",b.o.h.style.display="inline",b.o.h.innerText="Hello?",await d(3e3),b.o.h.style.fontSize="4rem",b.o.h.innerText="HELLO???",b.o.h.style.fontSize="2rem",await d(3e3),b.o.h.innerText="Finally! You're awake...",await d(3e3),b.o.h.innerText="We found you passed out in the woods,\n nearly thought you were dead.",await d(5e3),b.o.h.innerText="All you had was this note on you:",await d(5e3),b.o.h.innerText="Four, oh Four...\n",await d(2e3),b.o.h.innerText+="how I adore,\n",await d(2e3),b.o.h.innerText+="the sweetness of\n",await d(2e3),b.o.h.innerText+="your heady lore.\n\n",await d(2e3),b.o.h.innerText+="I lived my life\n",await d(2e3),b.o.h.innerText+="at your front door,\n",await d(2e3),b.o.h.innerText+="so now your call\n",await d(2e3),b.o.h.innerText+="I can't ignore.\n",await d(5e3),b.o.h.innerText="So you're looking for somebody named 'Four', huh?\n Strange name...\n",await d(5e3),b.o.h.innerText="Come down to the shop when you're feeling better. \nI have something you might be interested in.",await d(5e3),b.o.h.innerText="",b.Ft.Pe=8,!0))().then(()=>{window.cancelAnimationFrame(b.Is),qt(0)})}}),t.wi=Pt,t.ui=Gt,t}({});
