<!DOCTYPE html>
<html lang="en"><head>
<meta charset="utf-8">
<title>Sir Brunoâ€™s Minnelied</title>
<meta name="viewport" content="width=device-width">
<link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAAXNSR0IArs4c6QAAABVQTFRFAAAAFxRVRT44cGVbxsgA18qU3d3dPiTurwAAAGVJREFUCFs1xrEJwzAQhtG/OfcGoQEU0AAR3AQmtZpzbfvCt/8IaZRXPQGQju6yV8ZYeb/Q9zg+2ZrrLnv9h6e1LkpdWQTdL2kTPI6ZBKPbnFPkwCKmGI5ZSOlgYVICFnEK4JK2Hz4RIIh2szZIAAAAAElFTkSuQmCC">
<style>
*{margin:0;padding:0}html{font-size:20px;font-family:sans-serif;background:#000;color:#000}#info{position:absolute;top:0;left:0;right:0;background-color:rgba(255,255,255,0.85);cursor:pointer;padding:0.5em 2em;text-align:center}#canvas{display:block;margin:auto;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges;image-rendering:pixelated}@keyframes fadein{0%{opacity:0}100%{opacity:1}}#intro{overflow:auto;position:fixed;top:0;bottom:0;left:0;right:0;text-align:center}#intro div,#intro button{margin:0.5em;padding:0.5em;background:rgba(255,255,255,0.85);animation:1s fadein both}#intro .d2{animation-delay:1.5s}#intro .d3{animation-delay:4.5s}#intro span{display:inline-block;max-width:50em}#intro button{font:inherit;border:solid medium transparent;padding:1em;cursor:pointer}#intro button:hover{border-color:#000}</style>
</head><body>
<canvas id="canvas" moz-opaque></canvas>
<div id="info"></div>
<div id="intro">
<div class="d1"><span>A.D. 1207. The knight Sir Bruno sets out to see Lady Sylvie to sing his Minnelied to her, a traditional 13th century love song.</span></div>
<div class="d2"><span>But when he arrives at the castle he is not well received. Instead of being allowed to see Lady Sylvie, his sword, shield, helmet, as well as the scroll with his Minnelied are taken away, and Sir Bruno is thrown into the dungeon.</span></div>
<div class="d3"><span>Can Sir Bruno recover his possesions and find Lady Sylvie? It is up to you to help him.</span></div>
<button class="d3" id="start">Play</button>
</div>
<script>
(function(){var r,w,f,F,t,I;r=function(){function b(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.webkitIsFullScreen}return{is:b,enter:function(){var c;if(!b())c=document.documentElement,c.requestFullscreen?c.requestFullscreen():c.webkitRequestFullscreen?c.webkitRequestFullscreen():c.mozRequestFullScreen?c.mozRequestFullScreen():c.msRequestFullscreen&&c.msRequestFullscreen()},exit:function(){b()&&(document.exitFullscreen?
document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}}}();w=function(){function b(){var a,d;k||(k=new h);for(a=0;a<g.length;a++){if(g[a].time===-1)d||(d=k.currentTime+0.1),g[a].time=d;for(var c=g[a],b=void 0;c.time-k.currentTime<1;){b=c.notes[c.pos];if(b[0][0]==="z")c.time+=b[1]*c.baseDur;else{for(var f=c,t=b[0],B=c.time,n=c.key,C=c.volume,x=void 0,
b=B+b[1]*c.baseDur,x=0;x<t.length;x++){var y=B,z=b,r=n[t[x]],A=C,i=void 0;a:{for(var l=i=void 0,u=l=void 0,i=i||"sine",l=0;l<e.length;l++)if(e[l].osc.type===i&&e[l].t<y){i=l;break a}l=k.createOscillator();u=k.createGain();l.type=i;u.gain.value=0;l.connect(u);u.connect(k.destination);l.start();e.push({osc:l,gain:u});i=e.length-1}e[i].osc.frequency.setValueAtTime(r,y);e[i].gain.gain.setValueAtTime(0.0010,y);e[i].gain.gain.exponentialRampToValueAtTime(A,y+0.05);e[i].gain.gain.linearRampToValueAtTime(A,
z-0.05);e[i].gain.gain.exponentialRampToValueAtTime(0.0010,z);e[i].gain.gain.setValueAtTime(0,z+0.01);e[i].t=z+0.01}f.time=b}c.pos=(c.pos+1)%c.notes.length}}}function c(){var a,d;if(k){d=k.currentTime+0.1;for(a=0;a<e.length;a++)e[a].osc.frequency.cancelScheduledValues(d),e[a].gain.gain.cancelScheduledValues(d),e[a].gain.gain.setValueAtTime(0,d),e[a].t=d;for(a=0;a<g.length;a++)g[a].time=-1,g[a].pos=0}}function a(a){return a.split(" ").map(function(a){var d,a=a.split(/([\^_=]*[a-zA-Z][',]*)/);d=Number(a.pop()||
1);return[a.filter(function(a){return a}),d]})}function d(d,c){var e;g=[];for(e=0;e<d.length;e++){var h=a(d[e][0]);g.push({time:-1,pos:0,notes:h,key:d[e][1],volume:d[e][2],baseDur:c})}}var h,k,e=[],g;h=window.AudioContext||window.webkitAudioContext;return{setMelody:function(a){var e={"C,":Math.pow(2,-1.75)*220,"D,":Math.pow(2,-19/12)*220,"E,":Math.pow(2,-17/12)*220,"F,":Math.pow(2,-16/12)*220,"G,":Math.pow(2,-14/12)*220,"A,":110,"B,":Math.pow(2,-10/12)*220,C:Math.pow(2,-0.75)*220,D:Math.pow(2,-7/
12)*220,E:Math.pow(2,-5/12)*220,F:Math.pow(2,-4/12)*220,G:Math.pow(2,-2/12)*220,A:220,B:Math.pow(2,2/12)*220,c:Math.pow(2,0.25)*220,d:Math.pow(2,5/12)*220},h={F:Math.pow(2,-4/12)*110,G:Math.pow(2,-2/12)*110,A:Math.pow(2,1/12)*110,B:Math.pow(2,2/12)*110,c:Math.pow(2,4/12)*110,d:Math.pow(2,0.5)*110,e:Math.pow(2,7/12)*110,f:Math.pow(2,0.75)*110,g:Math.pow(2,11/12)*110},b={C:Math.pow(2,-10/12)*220,D:Math.pow(2,-8/12)*220,E:Math.pow(2,-5/12)*220,F:Math.pow(2,-0.25)*220,G:Math.pow(2,-1/12)*220,A:220,B:Math.pow(2,
2/12)*220,c:Math.pow(2,4/12)*220,d:Math.pow(2,5/12)*220},g={"^^F":Math.pow(2,-2/12)*220,G:Math.pow(2,-1/12)*220,A:220,"^A":Math.pow(2,1/12)*220,B:Math.pow(2,2/12)*220,"^B":Math.pow(2,0.25)*220,c:Math.pow(2,4/12)*220,d:Math.pow(2,0.5)*220,e:Math.pow(2,7/12)*220,"^e":Math.pow(2,8/12)*220,f:Math.pow(2,0.75)*220,g:Math.pow(2,11/12)*220,a:440},k={"B,":Math.pow(2,-10/12)*220,C:Math.pow(2,-0.75)*220,D:Math.pow(2,-7/12)*220,F:Math.pow(2,-0.25)*220,G:Math.pow(2,-2/12)*220,A:220,_B:Math.pow(2,1/12)*220,B:Math.pow(2,
2/12)*220,c:Math.pow(2,0.25)*220,"^c":Math.pow(2,4/12)*220,d:Math.pow(2,5/12)*220};c();switch(a){case 1:d([["C C0.5 E0.5 E E E D D0.5 C0.5 C C D D C z0.5 E0.5 E E0.5 E E E D D0.5 C0.5 C C A, C C0.5 A,0.5 B,0.5 G,0.5 A, A, C C C D D G,0.5 F,0.5 F, G, A, A, C A, F, A, B,0.5 A,0.5 G,0.5 G,0.5 F,0.5 F,",e,0.15]],0.6);break;case 2:d([["A c c c d0.5 B0.5 c c0.5 B0.5 A0.5 G0.5 G G A B A G G A0.5 G0.5 c0.5 G0.5 B0.5 G0.5 c c d0.5 c0.5 c c0.5 B0.5 A0.5 G0.5 G c G F E0.5 D0.5 C0.5 E0.5 A,",e,0.15]],0.6);break;
case 3:d([["A, B, C D C0.5 B,0.5 C0.5 D0.5 C G,0.5 B,0.5 C C A, A, F,0.5 G,0.5 A, G, C,0.5 E,0.5 C, D, F, F, F,0.5 G,0.5 A, G, A, B, C D C0.5 B,0.5 C0.5 D0.5 C G,0.5 B,0.5 C C A, A, F,0.5 G,0.5 G,",e,0.15]],0.6);break;case 4:d([["A, C D E E0.5 D0.5 E E0.5 A,0.5 C C D C B,0.5 A,0.5 A, C D E E B, C D C0.5 B,0.5 C B,0.5 A,0.5 B, C A, G,0.5 A,0.5 C A,0.5 G,0.5 C D E E B, C A,",e,0.15]],0.6);break;case 5:d([["f2 d1.75 B0.25 B c0.25 B0.25 A0.25 c0.25 f e d1.5 B0.5 d0.75 c0.25 B0.75 A0.25 B2 F z g2 e1.75 c0.25 c d0.25 c0.25 B0.25 c0.25 g f d1.5 B0.5 f0.5 e0.5 G0.75 c0.25 B2 A z d2 B1.5 F0.5 F3 F f2 d1.5 B0.5 B2 B2 g2 e1.5 c0.5 g f e d f e d c B2 z2",
h,0.15]],0.5);break;case 6:d([["A d3 c B A G1.5 F0.5 A2 G z G2 F E B3 A D2 F2 A2 z A D3 C B A G1.5 F0.5 A2 G z2 E F G F3 B d2 c2 B2 z3",b,0.15]],0.5);break;case 7:d([["e2 ^^F0.5 G0.5 B0.5 e0.5 g2 f2 d B e e f1.5 d0.5 B0.5 z0.5 B0.5 B2 e0.5 d0.5 e0.5 ^e0.5 f3 f0.5 g0.5 a d0.5 e0.5 f A G2 z2 e2 ^^F0.5 G0.5 B0.5 e0.5 g2 f2 d B e e f1.5 d0.5 B0.5 z0.5 B B1.5 ^B0.5 c0.5 d0.5 e0.5 f0.5 g2 f d B c0.5 d0.5 e1.5 ^A0.5 B2 z2",g,0.15]],0.5);break;case 8:d([["G1.5 d ^c0.5 c1.75 B0.5 _B1.5 B A0.5 G3 G1.5 F G0.5 B1.5 B G0.5 D2.5 C0.5 B,3 z",
k,0.15]],0.75)}},stop:c,tick:h?b:function(){}}}();f=function(){function b(c,a,d,h){this.width=c;this.height=a;this.interactionMode=d;h=h||{};Object.keys(h).forEach(function(a){this[a]=h[a]}.bind(this))}b.prototype.interact=function(c,a){switch(this.interactionMode){case "text":return this.text;case "take":return c.removeThing(this),a.addThing(this),"Taken: "+this.text;default:return this.interactionMode(c,a)}};b.prototype.draw=function(c,a,d,h,b){var e;if(this.sprite&&(e=this.animate?this.sprite+
Math.floor(h/500)%this.animate:this.sprite,c.drawImage(b[e],a,d+this.height-b[e].height),!this.pattern))return;c.translate(a,d);c.fillStyle=b[this.pattern];c.fillRect(0,0,this.width,this.sprite?this.height-b[e].height:this.height);c.translate(-a,-d)};b.prototype.drawInventory=function(c,a){c.drawImage(a[this.sprite+"Inv"],3,3)};b.prototype.drawPlayer=function(c,a,d,h,b){switch(this.sprite){case "helmet":c.drawImage(b.helmetPlayer,a+9,d);break;case "sword":h||c.drawImage(b.swordPlayer,a+5,d+49)}};
return b}();F=function(){function b(){this.inventory=[]}b.prototype.addThing=function(c){this.inventory.push(c)};b.prototype.hasThing=function(c){return this.inventory.indexOf(c)>-1};b.prototype.removeThing=function(c){var a;for(a=0;a<this.inventory.length;a++)if(this.inventory[a]===c){this.inventory.splice(a,1);break}};b.prototype.hasLight=function(){var c;for(c=0;c<this.inventory.length;c++)if(this.inventory[c].light)return!0};b.prototype.moveTo=function(c,a,d,h){this.dest=c;this.interactThing=
a;if(c<this.x)this.dir=!0;else if(c>this.x)this.dir=!1;if(d)this.x=c,this.dir=h};b.prototype.walk=function(c,a){var d=c*0.08;if(Math.abs(this.x-this.dest)<=d){if(this.x=this.dest,this.interactThing)return d=this.interactThing.interact(a,this),this.interactThing=null,d}else this.x<this.dest?this.x+=d:this.x-=d};b.prototype.draw=function(c,a,d,h){var b,e;this.dir&&(c.save(),c.translate(Math.round(this.x),0),c.scale(-1,1),c.translate(-Math.round(this.x),0));b=Math.round(this.x-15);a=a-90-4;this.x!==
this.dest?(e=Math.floor(d*0.08/30*2)%2?h.person0:h.person1,Math.floor(d*0.08/30*2)%2===0&&(a-=1)):e=h.person0;c.drawImage(e,b,a);for(d=0;d<this.inventory.length;d++)this.inventory[d].drawPlayer(c,b,a,this.dir,h);this.dir&&c.restore()};b.prototype.drawInventory=function(c,a,d){var h=this.inventory.length-a,b=[];h<0&&(h=0);for(a=h;a<this.inventory.length;a++)c.save(),c.translate((a-h)*30,0),this.inventory[a].drawInventory(c,d),b.push(this.inventory[a].text),c.restore();return b};return b}();t=function(){function b(c,
a){this.width=c;this.melody=a;this.things=[];this.locations=[]}b.prototype.addLocation=function(c,a){this.locations.push([c,a])};b.prototype.getLocation=function(c){return this.locations[c]};b.prototype.addThing=function(c,a,d){this.things.push({t:c,x:a,y:d})};b.prototype.removeThing=function(c){var a;for(a=0;a<this.things.length;a++)if(this.things[a].t===c){this.things.splice(a,1);break}};b.prototype.findThing=function(c,a){var d,b;for(d=this.things.length-1;d>=0;d--)if(b=this.things[d],b.t.interactionMode&&
b.x<=c&&c<=b.x+b.t.width&&a<=b.y&&b.y-b.t.height<=a)return b;return null};b.prototype.getLimit=function(c,a,d){var b;a<d?a=d:a>this.width-d&&(a=this.width-d);for(b=0;b<this.things.length;b++)this.things[b].t.blocksPath&&(a=c<this.things[b].x?Math.min(a,this.things[b].x-d):Math.max(a,this.things[b].x+this.things[b].t.width+d));return a};b.prototype.draw=function(b,a,d,h,f){var e;this.isOutside?(b.fillStyle="#aaf",b.fillRect(0,0,this.width,d-50),b.fillStyle="#afa",b.fillRect(0,d-50,this.width,50)):
(b.fillStyle=f.bg,e=(d-10)%24,e!==0&&(e=24-e),b.translate(0,-e),b.fillRect(0,0,this.width,d-10+e),b.translate(0,e),b.fillStyle=f.floor,b.fillRect(0,d-10,this.width,10));for(e=0;e<this.things.length;e++)this.things[e].t.draw(b,this.things[e].x,d-this.things[e].y,h,f);a.draw(b,d,h,f);if(this.light)a=a.hasLight()?[a.x,Math.round(72)]:this.light,b.translate(a[0],d-a[1]),b.fillStyle=f.shadow,b.fillRect(-a[0],a[1]-d,this.width,d)};return b}();I=function(){function b(a,d){this.canvas=a;this.info=d;this.soundOn=
!0;this.hideInfo();this.ctx=a.getContext("2d",{alpha:!1});this.calcSize();this.initEvents()}var c=window.requestAnimationFrame||window.mozRequestAnimationFrame;b.prototype.setPlayer=function(a){this.player=a};b.prototype.loadSprites=function(a,d){var b=new Image,c;c=this.ctx.createRadialGradient(0,0,0,0,0,135);c.addColorStop(0,"transparent");c.addColorStop(1,"#000");this.sprites={shadow:c};b.onload=function(){Object.keys(a).forEach(function(d){var c=a[d],f=document.createElement("canvas"),k=f.getContext("2d");
f.width=c[2];f.height=c[3];c[5]&&(k.scale(-1,1),k.translate(-c[2],0));k.drawImage(b,c[0],c[1],c[2],c[3],0,0,c[2],c[3]);this.sprites[d]=c[4]?this.ctx.createPattern(f,c[4]):f}.bind(this));d()}.bind(this);b.src="data:image/png;base64,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"};
b.prototype.calcSize=function(){var a,d,b;a=Math.floor(Math.min(window.innerWidth/400,window.innerHeight/200,5));a<1&&(a=1);d=Math.floor(window.innerWidth/a);b=Math.min(Math.max(Math.floor(window.innerHeight/a),200),270);this.canvas.width=d;this.canvas.height=b;this.canvas.style.width=d*a+"px";this.canvas.style.height=b*a+"px";this.factor=a;this.buttonsX=d-52;this.inventoryY=this.inventoryX=this.buttonsY=10;this.inventoryCount=Math.floor((d-20-52)/30);this.inventoryDescs=[];this.roomX=10;this.roomY=
60;this.roomW=d-20;this.roomH=b-40-30;b=this.roomY/2*a-20;b+="px";this.info.style.paddingTop=b;this.info.style.paddingBottom=b};b.prototype.getCoordinates=function(a){return[(a.clientX-this.canvas.offsetLeft)/this.factor,(a.clientY-this.canvas.offsetTop)/this.factor]};b.prototype.getArea=function(a,d){if(a>=this.buttonsX&&d>=this.buttonsY&&d<=this.buttonsY+16)return(a-this.buttonsX)%26<=16?["buttons",Math.floor((a-this.buttonsX)/26)]:null;if(this.isOutro)return null;if(a>=this.inventoryX&&a<=this.inventoryX+
30*this.inventoryCount&&d>=this.inventoryY&&d<=this.inventoryY+30)return["inventory",Math.floor((a-this.inventoryX)/30)];if(a>=this.roomX&&a<=this.roomX+this.roomW&&d>=this.roomY&&d<=this.roomY+this.roomH)return["room"]};b.prototype.initEvents=function(){this.canvas.addEventListener("mousemove",function(a){a=this.getCoordinates(a);a=this.getArea(a[0],a[1]);switch(a&&a[0]){case "buttons":a=a[1]===0?this.soundOn?"Turn sound off":"Turn sound on":r.is()?"Exit fullscreen":"Enter fullscreen";this.setCursorTitle("pointer",
a);break;case "inventory":a=this.inventoryDescs[a[1]];this.setCursorTitle("",a?"You have: "+a:"");break;case "room":this.setCursorTitle("crosshair","");break;default:this.setCursorTitle("","")}}.bind(this));this.canvas.addEventListener("click",function(a){var d=this.getCoordinates(a),a=d[0],d=d[1],b=this.getArea(a,d);this.hideInfo();switch(b[0]){case "buttons":if(b[1]===0)(this.soundOn=!this.soundOn)||w.stop();else r[r.is()?"exit":"enter"]();break;case "room":this.onRoomClick(a-this.roomX+this.roomStart,
this.roomH+this.roomY-d)}}.bind(this));this.info.addEventListener("click",function(){this.hideInfo()}.bind(this));window.addEventListener("resize",function(){this.calcSize()}.bind(this))};b.prototype.showInfo=function(a){this.info.textContent=a;this.info.style.display=""};b.prototype.hideInfo=function(){this.info.style.display="none"};b.prototype.setCursorTitle=function(a,b){this.canvas.style.cursor=a;this.canvas.title=b};b.prototype.setRoom=function(a,b){b=a.getLocation(b||0);a.melody&&w.setMelody(a.melody);
this.room=a;this.player.moveTo(b[0],null,!0,b[1]);this.calcRoomStart(!0)};b.prototype.calcRoomStart=function(a){var b;this.room.width<=this.roomW?b=-Math.floor((this.roomW-this.room.width)/2):(b=Math.floor(this.player.x/(this.roomW/2))*(this.roomW/2)-this.roomW/4,b<0?b=0:b+this.roomW>this.room.width&&(b=this.room.width-this.roomW));b=Math.round(b);a||Math.abs(this.roomStart-b)<=10?this.roomStart=b:this.roomStart+=b>this.roomStart?10:-10};b.prototype.startDraw=function(){c(function(a){this.prevTime=
this.startTime=a;this.onAnimationFrame(a)}.bind(this))};b.prototype.onAnimationFrame=function(a){var b;!this.isIntro&&this.soundOn&&w.tick();this.draw(a);(b=this.player.walk(a-this.prevTime,this.room))&&this.showInfo(b);this.calcRoomStart();this.prevTime=a;c(this.onAnimationFrame.bind(this))};b.prototype.fadeIn=function(a){this.isFading=!0;this.fadeStart=-1;this.fadeDir=1;this.fadeCallback=a};b.prototype.fadeOut=function(a){this.isFading=!0;this.fadeDir=this.fadeStart=-1;this.fadeCallback=a};b.prototype.draw=
function(a){this.ctx.fillStyle="#000";this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);if(this.isIntro)this.drawRoom(a);else if(this.drawButtons(),this.isOutro||this.drawInventory(),this.drawRoom(a),this.isFading){if(this.fadeStart===-1)this.fadeStart=a;a-this.fadeStart>=200?(this.isFading=!1,this.fadeCallback()):(a=(a-this.fadeStart)/200,this.fadeDir===1&&(a=1-a),this.ctx.fillStyle="rgba(0,0,0,"+a+")",this.ctx.fillRect(this.roomX,this.roomY,this.roomW,this.roomH))}};b.prototype.drawButtons=
function(){this.ctx.drawImage(this.sprites[this.soundOn?"soundOn":"soundOff"],this.buttonsX,this.buttonsY);this.ctx.drawImage(this.sprites[r.is()?"exitFullscreen":"enterFullscreen"],this.buttonsX+26,this.buttonsY)};b.prototype.drawInventory=function(){this.ctx.save();this.ctx.translate(this.inventoryX,this.inventoryY);this.ctx.fillStyle="#ddd";this.ctx.fillRect(0,0,30*this.inventoryCount,30);this.inventoryDescs=this.player.drawInventory(this.ctx,this.inventoryCount,this.sprites);this.ctx.restore()};
b.prototype.drawRoom=function(a){this.ctx.save();this.ctx.beginPath();this.room.width<=this.roomW?this.ctx.rect(this.roomX+Math.floor((this.roomW-this.room.width)/2),this.roomY,this.room.width,this.roomH):this.ctx.rect(this.roomX,this.roomY,this.roomW,this.roomH);this.ctx.clip();this.ctx.translate(this.roomX-this.roomStart,this.roomY);this.room.draw(this.ctx,this.player,this.roomH,a,this.sprites);this.ctx.restore()};b.prototype.onRoomClick=function(a,b){var c,f;this.isFading||((c=this.room.findThing(a,
b))&&this.player.x+22.5>=c.x&&this.player.x-22.5<=c.x+c.t.width?((f=c.t.interact(this.room,this.player))&&this.showInfo(f),c.t.alwaysWalk&&this.player.moveTo(this.room.getLimit(this.player.x,a,15))):(a=this.room.getLimit(this.player.x,a,15),this.player.moveTo(a,c&&a+22.5>=c.x&&a-22.5<=c.x+c.t.width&&c.t)))};return b}();(function(){function b(a,b){d.fadeOut(function(){d.setRoom(a,b);d.fadeIn(function(){})})}var c=document.getElementById("intro"),a=document.getElementById("start"),d=new I(document.getElementById("canvas"),
document.getElementById("info")),h,k,e,g,m,r,s,p,w,G,B,n,C,x,y,z,H,A,i,l,u,q,j,D,E,v,J,o,K;G=new f(16,12,"take",{text:"A key",sprite:"key"});B=new f(16,12,"take",{text:"A second key",sprite:"key"});n=new f(12,40,"take",{text:"A torch",sprite:"torch",animate:2,light:!0});C=new f(16,16,"take",{text:"Your helmet",sprite:"helmet"});x=new f(24,24,"take",{text:"Your sword",sprite:"sword"});y=new f(24,24,"take",{text:"Your shield",sprite:"shield"});z=new f(24,7,"take",{text:"The scroll with your Minnelied",
sprite:"scroll"});H=new f(16,9,"take",{text:"A herring",sprite:"herring"});A=new f(16,10,"take",{text:"A bone with some meat",sprite:"bone"});i=new f(30,5,"",{pattern:"wood"});l=new f(25,50,"",{sprite:"window"});u=new f(4,4,"",{sprite:"doorKnob"});q=new f(8,17,"",{sprite:"holder"});j=new f(24,195,function(){b(e,2);return"You climb up the ladder."},{pattern:"ladder"});D=new f(22,195,function(a,b){if(this.state)return"The door is open.";return b.hasThing(G)?(this.state=!0,this.blocksPath=!1,this.pattern=
"door1",this.width=52,"You unlock the door with the key."):"The door is locked."},{pattern:"door0",alwaysWalk:!0,blocksPath:!0});h=new t(680,3);h.light=[200,95];h.addLocation(150);h.addLocation(512,!0);h.addThing(G,5,20);h.addThing(n,200,115);h.addThing(q,202,92);h.addThing(D,300,200);h.addThing(j,500,200);h.addThing(y,650,34);n=new f(22,204,function(){b(e);return"You go upstairs."},{sprite:"stairsUpLeftBottom",pattern:"stairsUpLeft"});k=new t(500,1);k.light=[9,200];k.addLocation(37);k.addThing(n,
0,204);k.addThing(i,50,75);k.addThing(i,150,75);k.addThing(i,250,75);k.addThing(i,350,75);k.addThing(i,450,75);k.addThing(H,57,84);k.addThing(x,253,97);k.addThing(A,457,85);n=new f(34,200,function(){b(k);return"You go downstairs."},{sprite:"stairsDownLeftBottom",pattern:"stairsDownLeft"});j=new f(48,120,function(a,c){return c.hasThing(B)?(b(g),"You unlock the door with the second key and enter the room."):"The door is locked and your key does not fit."},{pattern:"wood",alwaysWalk:!0});D=new f(24,
21,function(){b(h,1);return"You climb down the ladder."},{sprite:"ladderTop"});E=new f(22,204,function(){b(m,1);return"You go upstairs."},{sprite:"stairsUpRightBottom",pattern:"stairsUpRight"});v=new f(12,40,"",{sprite:"torch",animate:2});J=new f(80,5,"",{pattern:"wood"});o=new f(12,14,"",{sprite:"flame",animate:2});K=new f(100,60,"",{pattern:"stone"});e=new t(680,5);e.addLocation(45);e.addLocation(270);e.addLocation(512);e.addLocation(643,!0);e.addThing(n,-4,200);e.addThing(v,50,115);e.addThing(q,
52,92);e.addThing(K,90,70);e.addThing(J,100,19);e.addThing(o,100,30);e.addThing(o,105,35);e.addThing(o,110,32);e.addThing(o,116,38);e.addThing(o,121,29);e.addThing(o,124,45);e.addThing(o,127,36);e.addThing(o,130,31);e.addThing(o,135,38);e.addThing(o,137,44);e.addThing(o,140,30);e.addThing(o,146,36);e.addThing(o,149,45);e.addThing(o,150,32);e.addThing(o,155,39);e.addThing(o,161,29);e.addThing(o,167,35);e.addThing(o,170,31);e.addThing(j,246,130);e.addThing(u,285,75);e.addThing(v,330,115);e.addThing(q,
332,92);e.addThing(v,400,115);e.addThing(q,402,92);e.addThing(v,470,115);e.addThing(q,472,92);e.addThing(D,499,21);e.addThing(v,540,115);e.addThing(q,542,92);e.addThing(v,610,115);e.addThing(q,612,92);e.addThing(E,658,204);q=new f(48,120,function(){b(e,1);return"You leave the armory."},{pattern:"wood"});j=new f(16,16,"text",{text:"This is not your helmet, so you leave it there.",sprite:"helmet"});n=new f(24,24,"text",{text:"This is not your sword, so you leave it there.",sprite:"sword"});g=new t(440,
6);g.light=[220,200];g.addLocation(220);g.addThing(i,20,65);g.addThing(j,20,81);g.addThing(z,25,72);g.addThing(i,20,100);g.addThing(j,35,116);g.addThing(n,20,122);g.addThing(i,70,65);g.addThing(n,70,87);g.addThing(j,85,81);g.addThing(i,70,100);g.addThing(j,70,116);g.addThing(j,85,116);g.addThing(i,120,65);g.addThing(j,120,81);g.addThing(j,135,81);g.addThing(i,120,100);g.addThing(n,120,122);g.addThing(j,135,116);g.addThing(q,196,130);g.addThing(u,235,75);g.addThing(i,290,65);g.addThing(j,290,81);g.addThing(j,
305,81);g.addThing(i,290,100);g.addThing(j,305,116);g.addThing(n,290,122);g.addThing(i,340,65);g.addThing(n,340,87);g.addThing(j,355,81);g.addThing(i,340,100);g.addThing(j,340,116);g.addThing(j,355,116);g.addThing(i,390,65);g.addThing(j,390,81);g.addThing(j,405,81);g.addThing(i,390,100);g.addThing(n,390,122);g.addThing(j,405,116);i=new f(22,204,function(){b(s,1);return"You go upstairs."},{sprite:"stairsUpLeftBottom",pattern:"stairsUpLeft"});q=new f(34,200,function(){b(e,3);return"You go downstairs."},
{sprite:"stairsDownRightBottom",pattern:"stairsDownRight"});n=new f(45,45,function(){if(this.state)return this.state=!1,this.width=45,"You put the tapestry back.";this.state=!0;this.width=5;return"You find a hiding place behind the tapestry!"},{pattern:"tapestry"});j=new f(45,45,"text",{pattern:"tapestry",text:"This is a nice tapestry, but there is nothing special about this one.",alwaysWalk:!0});E=new f(41,4,"",{pattern:"stone"});v=new f(4,41,"",{pattern:"stone"});D=new f(33,33,"",{pattern:"wood"});
m=new t(700,4);m.addLocation(37);m.addLocation(655,!0);m.addThing(i,0,204);m.addThing(l,50,130);m.addThing(j,118,130);m.addThing(l,205,130);m.addThing(j,273,130);m.addThing(l,350,130);m.addThing(D,424,124);m.addThing(C,428,106);m.addThing(E,420,128);m.addThing(E,420,91);m.addThing(v,420,128);m.addThing(v,457,128);m.addThing(n,418,130);m.addThing(l,495,130);m.addThing(j,563,130);m.addThing(l,640,130);m.addThing(q,670,200);i=new f(24,195,function(){b(s);return"You climb up the ladder."},{pattern:"ladder"});
r=new t(200,2);r.addLocation(32);r.addThing(i,20,200);r.addThing(l,120,130);r.addThing(B,170,20);q=new f(24,21,function(){b(r);return"You climb down the ladder."},{sprite:"ladderTop"});n=new f(34,200,function(){b(m);return"You go downstairs."},{sprite:"stairsDownRightBottom",pattern:"stairsDownRight"});j=new f(30,16,function(a,b){var c="The dog looks small but vicious and won\u2019t let you pass.";if(this.state)return"The dog is eating and ignores you.";if(b.hasThing(A))return this.state=!0,this.blocksPath=
!1,this.sprite="dog1",b.removeThing(A),"You throw the bone to the dog, and it starts eating.";b.hasThing(H)&&(c+=" (The dog doesn\u2019t like fish.)");return c},{sprite:"dog0",blocksPath:!0,alwaysWalk:!0});i=new f(24,90,function(a,c){if(!c.hasThing(x))return"Lady Sylvie: \u201cI don\u2019t believe you are a knight if you don\u2019t carry a sword!\u201d";if(!c.hasThing(y))return"Lady Sylvie: \u201cI don\u2019t believe you are a knight if you don\u2019t carry a shield!\u201d";if(!c.hasThing(C))return"Lady Sylvie: \u201cI don\u2019t believe you are a knight if you don\u2019t wear a helmet!\u201d";
if(!c.hasThing(z))return"Lady Sylvie: \u201cYou look to nervous to sing your Minnelied without the scroll with your notes to remember it!\u201d";b(w);d.isOutro=!0;return"You successfully helped Sir Bruno on his mission! Well done and thank you for playing!"},{sprite:"lady",blocksPath:!0});s=new t(560,8);s.addLocation(32);s.addLocation(335,!0);s.addThing(q,19,21);s.addThing(l,50,130);s.addThing(j,150,21);s.addThing(l,170,130);s.addThing(n,350,200);s.addThing(l,290,130);s.addThing(i,510,95);s.addThing(l,
410,130);s.addThing(l,530,130);l=new f(45,132,"",{pattern:"bg"});q=new f(90,84,"",{pattern:"bg"});n=new f(60,75,"",{pattern:"wood"});j=new f(15,8,"",{pattern:"stone"});p=new t(250);p.isOutside=!0;p.addLocation(-30);p.addThing(l,35,172);p.addThing(j,35,180);p.addThing(j,65,180);p.addThing(q,80,124);p.addThing(n,95,115);p.addThing(u,97,113);p.addThing(u,149,113);p.addThing(j,80,132);p.addThing(j,117,132);p.addThing(j,155,132);p.addThing(l,170,172);p.addThing(j,170,180);p.addThing(j,200,180);w=new t(90,
7);w.addLocation(25);w.addThing(i,53,95);d.loadSprites({bg:[0,0,24,24,"repeat"],floor:[71,33,7,3,"repeat"],wood:[48,12,7,3,"repeat"],stone:[55,12,7,3,"repeat"],person0:[0,24,30,90],person1:[0,114,30,90],keyInv:[24,0,24,24],key:[48,0,16,12],window:[30,24,25,50],torch0:[30,74,12,40],torch1:[42,74,12,40],torchInv:[54,142,24,24],flame0:[30,74,12,14],flame1:[42,74,12,14],helmetInv:[64,0,24,24],helmetPlayer:[48,15,12,9],helmet:[55,24,16,16],swordInv:[64,40,24,24],swordPlayer:[55,40,10,22],sword:[64,40,
24,24],shieldInv:[64,64,24,24],shield:[64,64,24,24],tapestry:[71,24,9,9,"repeat"],ladder:[64,88,24,16,"repeat"],ladderTop:[63,88,26,26],enterFullscreen:[88,0,16,16],exitFullscreen:[88,16,16,16],soundOn:[88,32,16,16],soundOff:[88,48,16,16],lady:[30,114,24,90],dog0:[54,114,30,16],dog1:[54,130,30,12],scroll:[54,190,24,7],scrollInv:[54,166,24,24],herring:[88,64,16,9],herringInv:[78,142,24,24],bone:[88,73,16,10],boneInv:[78,161,24,24],stairsUpRightBottom:[90,114,22,28],stairsUpRight:[90,92,22,22,"repeat"],
stairsUpLeftBottom:[90,114,22,28,"",!0],stairsUpLeft:[90,92,22,22,"repeat",!0],stairsDownRightBottom:[78,194,34,10],stairsDownRight:[78,185,34,9,"repeat"],stairsDownLeftBottom:[78,194,34,10,"",!0],stairsDownLeft:[78,185,34,9,"repeat",!0],door0:[54,197,10,5,"repeat"],door1:[64,197,10,5,"repeat"],doorKnob:[88,83,4,4],holder:[104,73,8,17]},function(){var b=new F;b.addThing(x);b.addThing(C);d.setPlayer(b);d.setRoom(p);d.isIntro=!0;d.startDraw();b.moveTo(125);a.addEventListener("click",function(){c.style.display=
"none";d.isIntro=!1;d.setPlayer(new F);d.setRoom(h)})})})()})();
</script>
</body></html>