(()=>{"use strict";var t,r={769:function(t,r,e){var n=this&&this.__generator||function(t,r){var e,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;s;)try{if(e=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=r.call(t,s)}catch(t){i=[6,t],n=0}finally{e=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}};r.__esModule=!0,r.Game=r.Card=r.WIN_VAL=r.ALL_DIRECTIONS=void 0;var a=e(350);r.ALL_DIRECTIONS=[[0,-1],[1,0],[0,1],[-1,0]],r.WIN_VAL=9;var i=function(){function t(){this.since=Date.now()}return t.prototype.copy=function(){var r=new t;return r.x=this.x,r.y=this.y,r.val=this.val,r.since=this.since,r},t.prototype.valid=function(){return this.val>0&&this.val<r.WIN_VAL},t}();r.Card=i;var s=function(){function t(t,r){void 0===r&&(r=3),this.cards=new Array,this.doneCards=new Array,this.score=0,this.kills=0,this.garbageIn=new Array,this.garbageOut=0,this.alive=!0,this.cardHistory=new WeakMap,this.size=r;var e=new a.RC4(t);for(this.iterator=this.newIterator(e);this.cards.length<r;){var n=e.inRange(0,r),s=e.inRange(0,r);if(!this.cardAt(n,s)){var o=new i;o.x=n,o.y=s,o.val=this.iterator.next().value,this.cards.push(o)}}this.next=this.iterator.next().value}return t.prototype.update=function(t){var e=this,n=this.existingCardsAfterMove(t),a=n.newCards;if(n.areChanged){this.cards=a;for(var i=0,s=this.cards;i<s.length;i++){var o=s[i];o.val===r.WIN_VAL&&(this.score+=o.val,this.garbageOut++)}this.doneCards=this.cards.filter((function(t){return!t.valid()})),this.cards=this.cards.filter((function(t){return t.valid()}));var h=this.newCardAfterMove(t);this.cards.push(h)}var l=r.ALL_DIRECTIONS.map((function(t){return e.existingCardsAfterMove(t)})).filter((function(t){return t.areChanged}));0===l.length&&(this.alive=!1)},t.prototype.addSourceToCard=function(t,r){this.cardHistory.has(t)||this.cardHistory.set(t,new Array),this.cardHistory.get(t).push(r)},t.prototype.existingCardsAfterMove=function(t){for(var r=this.cards.concat(),e=new Array,n=!1,a=!1;;){for(var s=Array(),o=function(r){var o=r.x+t[0],l=r.y+t[1];if((o<0||o>=h.size)&&(o=r.x),(l<0||l>=h.size)&&(l=r.y),o===r.x&&l===r.y)e.push(r.copy());else{var c=e.find((function(t){return t.x===o&&t.y===l}));if(c)h.canMerge(r.val,c.val)?(c.val+=r.val,h.addSourceToCard(c,r),c.since=Date.now(),n=!0):e.push(r.copy());else if(a){var u=new i;u.x=o,u.y=l,u.val=r.val,e.push(u),h.addSourceToCard(u,r),n=!0}else s.push(r)}},h=this,l=0,c=r;l<c.length;l++)o(c[l]);if(0===s.length)break;s.length===r.length?a=!0:r=s}return{newCards:e,areChanged:n}},t.prototype.newIterator=function(t){var r,e,a;return n(this,(function(n){switch(n.label){case 0:r=new Array,n.label=1;case 1:if(0===r.length)for(e=[1,2];e.length;)a=e.splice(t.inRange(0,e.length),1)[0],r.push(a);return[4,r.pop()];case 2:return n.sent(),[3,1];case 3:return[2]}}))},t.prototype.cardAt=function(t,r){return this.cards.find((function(e){return e.x===t&&e.y===r}))},t.prototype.newCardAfterMove=function(t){var r=[-1,-1];do{for(var e=0;e<2;++e)switch(t[e]){case-1:r[e]=this.size-1;break;case 0:r[e]=Math.floor(Math.random()*this.size);break;case 1:r[e]=0}}while(this.cardAt(r[0],r[1]));var n=new i;return n.x=r[0],n.y=r[1],this.garbageIn.length?n.val=this.garbageIn.shift():(n.val=this.next,this.next=this.iterator.next().value),n},t.prototype.canMerge=function(t,r){return t===2*r||t===3*r||r===2*t||r===3*t},t}();r.Game=s},279:(t,r,e)=>{r.__esModule=!0,r.SpinnerView=r.ArenaView=void 0;var n=e(769);function a(t,r){return Math.floor(t/r)}function i(t,r,e){return t+(r-t)*e}var s=250,o=function(){function t(){}return t.prototype.renderBackground=function(t){if(!this.canvas){var r=document.getElementById("game");if(null===r)return;this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=1===t?Math.round(window.innerWidth/4):Math.round(3*window.innerWidth/8),r.appendChild(this.canvas)}var e=this.canvas.getContext("2d");e.fillStyle="rgba(0, 0, 0, 0.1)",e.fillRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.renderCards=function(t,r,e){if(this.canvas){var n=r===e?0:0===r?e:r,o=t.size,h=0===n?this.canvas.width/12:this.canvas.width/16,c=this.canvas.getContext("2d");c.save();var u=0===n?3*this.canvas.width/8:this.canvas.width*(3*a(n-1,2)/16+a(n-1,4)/4),v=0===n||n%2==1?0:this.canvas.height/2;c.translate(u,v),c.fillStyle="rgb(173,255,47)",c.strokeStyle="rgb(173,255,47)",c.shadowColor="rgba(173,255,47,0.5)",t.alive||(c.strokeStyle="rgba(255,47,47,0.25)",c.shadowColor="rgba(255,47,47,0.5)"),c.shadowBlur=3,c.strokeRect(h/12,h/12,h*o-h/6,h*o-h/6),c.shadowBlur=0,c.strokeStyle="rgba(173,255,47,0.25)";for(var d=function(r){for(var e=function(e){var n=t.cards.find((function(t){return t.x===r&&t.y===e})),a=(1-t.size)/2;if(n)l(n,t.cardHistory.get(n),h,a,c);else if(n=t.doneCards.find((function(t){return t.x===r&&t.y===e}))){var o=Date.now();if(o<n.since+s)l(n,t.cardHistory.get(n),h,a,c);else if(o<n.since+500){var u=i(1,9,(o-n.since-s)/s);l(n,t.cardHistory.get(n),h,a,c,u)}}},n=0;n<t.size;++n)e(n)},f=0;f<t.size;++f)d(f);c.restore()}},t.prototype.renderHud=function(t,r){document.getElementById("kills").innerText=t.toString(),document.getElementById("score").innerText=r.toString()},t}();r.ArenaView=o;var h=function(){function t(){}return t.prototype.render=function(t){if(!this.canvas){var r=document.getElementById("spinner");if(null===r)return;this.canvas=document.createElement("canvas"),this.canvas.width=Math.floor(window.innerWidth/8),this.canvas.height=this.canvas.width,r.appendChild(this.canvas)}this.card||(this.card=new n.Card,this.card.val=0,this.card.x=0,this.card.y=0),this.card.val=t;var e=this.canvas.getContext("2d");e.fillStyle="rgba(0, 0, 0, 0.1)",e.fillRect(0,0,this.canvas.width,this.canvas.height),e.fillStyle="rgb(173,255,47)",e.strokeStyle="rgba(173,255,47,0.25)",l(this.card,null,this.canvas.width,0,e)},t}();function l(t,r,e,n,a,o){void 0===o&&(o=1);var h=Date.now()-t.since,l=new Array;if(h<s&&(null==r?void 0:r.length))for(var u=0,v=0,d=r;v<d.length;v++)for(var f=d[v],p=0;p<f.val;++p){var y=c(h,u,t.val,e);y.x+=e*(f.x-t.x),y.y+=e*(f.y-t.y),l.push(y),u+=1}a.save(),8===t.val||t.val>9?(a.fillStyle="rgb(255,47,47)",a.strokeStyle="rgba(255,47,47,0.25)"):9===t.val&&(a.fillStyle="rgb(255,173,47)",a.strokeStyle="rgba(255,173,47,0.25)"),a.translate(e*(t.x+.5-(t.x+n)/6),e*(t.y+.5-(t.y+n)/6));var g=t.val>1&&1===o?new Path2D:null;for(u=0;u<t.val;++u){var w=c(h,u,t.val,e,o),x=w.x,b=w.y;g&&l.length<t.val&&(0===u?g.moveTo(x,b):g.lineTo(x,b)),l.length>u&&(x=i(l[u].x,x,h/s),b=i(l[u].y,b,h/s)),g&&l.length===t.val&&(0===u?g.moveTo(x,b):g.lineTo(x,b));var m=e/32;a.fillRect(x-m/2,b-m/2,m,m)}g&&(g.closePath(),a.stroke(g)),a.restore()}function c(t,r,e,n,a){void 0===a&&(a=1);var i=2*Math.PI*(t/2e3+r/e),s=a*n/3;return{x:Math.sin(-i)*s,y:Math.cos(-i)*s}}r.SpinnerView=h},350:(t,r)=>{function e(){for(var t=new Array,r=0;r<16;++r)t.push(Math.floor(256*Math.random()));return t}r.__esModule=!0,r.RC4=r.seedFromSystemRandom=void 0,r.seedFromSystemRandom=e;var n=function(){function t(t){this.s=new Array(256),this.i=0,this.j=0;for(var r=0;r<256;r++)this.s[r]=r;t||(t=e()),this.mix(t)}return t.prototype._swap=function(t,r){var e=this.s[t];this.s[t]=this.s[r],this.s[r]=e},t.prototype.mix=function(t){for(var r=0,e=0;e<this.s.length;e++)r+=this.s[e]+t[e%t.length],r%=256,this._swap(e,r)},t.prototype.nextByte=function(){return this.i=(this.i+1)%256,this.j=(this.j+this.s[this.i])%256,this._swap(this.i,this.j),this.s[(this.s[this.i]+this.s[this.j])%256]},t.prototype.uniform=function(){for(var t=0,r=0;r<7;r++)t*=256,t+=this.nextByte();return t/(Math.pow(2,56)-1)},t.prototype.inRange=function(t,r){return t+Math.floor(this.uniform()*(r-t))},t}();r.RC4=n}},e={};function n(t){var a=e[t];if(void 0!==a)return a.exports;var i=e[t]={exports:{}};return r[t].call(i.exports,i,i.exports,n),i.exports}n.m=r,t=[],n.O=(r,e,a,i)=>{if(!e){var s=1/0;for(c=0;c<t.length;c++){for(var[e,a,i]=t[c],o=!0,h=0;h<e.length;h++)(!1&i||s>=i)&&Object.keys(n.O).every((t=>n.O[t](e[h])))?e.splice(h--,1):(o=!1,i<s&&(s=i));if(o){t.splice(c--,1);var l=a();void 0!==l&&(r=l)}}return r}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[e,a,i]},n.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),(()=>{var t={92:0};n.O.j=r=>0===t[r];var r=(r,e)=>{var a,i,[s,o,h]=e,l=0;if(s.some((r=>0!==t[r]))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(h)var c=h(n)}for(r&&r(e);l<s.length;l++)i=s[l],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(c)},e=self.webpackChunkjs13k_kill_9=self.webpackChunkjs13k_kill_9||[];e.forEach(r.bind(null,0)),e.push=r.bind(null,e.push.bind(e))})();var a=n(279);a=n.O(a)})();