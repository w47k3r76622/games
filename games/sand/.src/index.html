<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>body,html{width:100%;height:100%;margin:0;padding:0;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;background-color:hsla(210,63%,6%,1)}body{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr auto 1fr;grid-template-areas:". . ." ". main ." ". . ."}canvas{background:#fbe58c;outline:1px solid #000;margin:0 auto;grid-area:main;background-color:#fff}.text-overlay{grid-area:main;align-self:center;justify-self:center;z-index:1;width:auto;max-width:80%;height:auto;padding:30px;background-color:#fbd649;color:#323251}.text-overlay.hidden{display:none}.text-overlay h2{font-size:34px;margin-top:0}.text-overlay p{line-height:1.4em}.text-overlay .right{text-align:right}.text-overlay .center{text-align:center}.text-overlay button{background-color:#e57388;border:0 none;width:44px;height:22px;padding:0;line-height:22px}.text-overlay :last-child{margin-bottom:0}</style>
</head>
<body>
<script type="text/javascript">'use strict';(function(){function g(a){return a*e.size.wc}function n(a){return a*e.size.$a}function y(a,b,c){a=Math.random()*(b-a+1)+a;c&&(a=Math.floor(a));return a}function z(a){a||(a=class{});class b extends a{set(a){return Object.assign(this,a)}}return b}function C(a){a||(a=class{});class b extends a{constructor(){super();this.M={}}N(a,b){a in this.M||(this.M[a]=[]);this.M[a].push(b)}W(a,b){a in this.M&&(b?(b=this.M[a].indexOf(b),0>b||this.M[a].splice(b,1)):this.M[a].splice(0,this.M[a].length))}uc(){for(let a in this.M)this.M[a].splice(0,
this.M[a].length)}la(a,b){a in this.M&&this.M[a].map((a)=>a(b))}}return b}function N(a){a||(a=class{});class b extends a{constructor(){super();this.direction={x:"",y:""};this.speed=0}move(a){a=this.speed*a*(this.direction.x&&this.direction.y?O:1);"left"==this.direction.x?this.x-=a:"right"==this.direction.x&&(this.x+=a);"up"==this.direction.y?this.y-=a:"down"==this.direction.y&&(this.y+=a)}Wb(a){const b={x:0,y:0};a=a.ma();"left"===this.direction.x?b.x=a.right-this.x:"right"===this.direction.x&&(b.x=
-1*(this.x+this.width-a.left));"up"===this.direction.y?b.y=a.bottom-this.y:"down"===this.direction.y&&(b.y=-1*(this.y+this.height-a.top));0!==b.x&&0!==b.y&&(Math.abs(b.x)>Math.abs(b.y)?b.x=0:b.y=0);return b}}return b}function D(a){a||(a=class{});class b extends a{constructor(){super();this.Vb=!0}}return b}const e={size:{wc:3,$a:90},speed:{Rc:21,max:300,acceleration:1650},A:{ia:{0:"#fbe58c",1:"#876701"},Za:{0:"rgba(0,0,0,0)",1:"#060f19",2:"#183c66",3:"#04b7e9"},F:{0:"rgba(0,0,0,0)",1:"#000",2:"rgba(0,0,0,0)"},
Z:{0:"rgba(0,0,0,0)",1:"#000",2:"#00b1e3"},aa:{0:"rgba(0,0,0,0)",1:"#000",2:"#0c923d"},ba:{0:"rgba(0,0,0,0)",1:"#000",2:"#bc2a01"},L:{0:"#876701",1:"#fbd649",2:"#fff"},oa:{0:"rgba(0,0,0,0)",1:"rgba(229,115,136,255)",2:"rgba(0,177,227,255)",3:"rgba(0,134,201,255)"},zb:{0:"rgba(0,0,0,0)",1:"rgba(0,134,201,255)",2:"rgba(0,177,227,255)",3:"rgba(2,136,209,255)",4:"rgba(249,168,37,255)",5:"rgba(251,192,45,255)",6:"rgba(48,63,159,255)",7:"rgba(255,255,255,255)",8:"rgba(255,202,40,255)",9:"rgba(3,169,244,255)",
a:"rgba(2,119,189,255)",b:"rgba(63,81,181,255)",c:"rgba(255,183,77,255)",d:"rgba(255,204,128,255)",e:"rgba(245,127,23,255)",f:"rgba(77,208,225,255)",g:"rgba(128,222,234,255)",h:"rgba(0,172,193,255)"}}};class P extends z(){constructor(){super();this.color="#999";this.opacity=1}}class A{constructor(){this.height=this.width=1;this.Rb=!0;this.Ca=null;this.node=this.Mb();this.G=this.node.getContext("2d")}Ra(a,b,c=!0){this.node.width=this.node.style.width=this.width=a;this.node.height=this.node.style.height=
this.height=b;c&&this.fc();return this}fc(){var a=window.devicePixelRatio||1,b=this.G.Vc||this.G.Sc||this.G.Tc||this.G.Uc||this.G.Pc||1;if(a!==b){a/=b;b=this.node.width;var c=this.node.height;this.node.width=b*a;this.node.height=c*a;this.node.style.width=b+"px";this.node.style.height=c+"px";this.G.scale(a,a)}}Qb(){document.body.appendChild(this.node)}Qa(a){this.Ca=a}C(){this.Rb&&this.clear();this.G.save();this.Ca.C(this.G);this.G.restore()}clear(){this.G.clearRect(0,0,this.G.canvas.width,this.G.canvas.height);
return this}ic(){return this.G.getImageData(0,0,this.width,this.height).data}Mb(){let a=document.createElement("canvas");a.width=this.width;a.height=this.height;return a}}class J{static cache(a){const b=new J(a);b.ec();const c=b.padding;a.C=function(a){a.drawImage(b.canvas.node,this.x-c.left,this.y-c.top)};return a}constructor(a){this.H=a;this.Eb={x:0,y:0};this.canvas=new A;this.padding={top:0,bottom:0,left:0,right:0};this.Ba=Math.round(Math.min(50,1+Math.max(this.H.width,this.H.height)/10));this.ga=
{top:!1,bottom:!1,left:!1,right:!1}}ec(){this.Cc();let a=0;this.xb({top:this.Ba,bottom:this.Ba,left:this.Ba,right:this.Ba});do{const {vc:a,Kc:c}=this.dc();this.Jc(c);if(this.Pb())break;this.xb(a)}while(20>=++a);this.Bc()}dc(){const a=this.hc(),b={},c={};Object.keys(a).forEach((d)=>{this.ga[d]||(0<a[d]?(b[d]=a[d],this.ga[d]=!0):c[d]=this.Ba)});return{vc:c,Kc:b}}Pb(){return Object.values(this.ga).every((a)=>a)}hc(){const a=this.gc(),b={top:0,bottom:0,left:0,right:0},c=this.canvas.height,d=this.canvas.width;
if(!this.ga.top)a:for(var e=0;e<c;e++){for(var f=0;f<d;f++)if(a[f+e*d])break a;b.top++}if(!this.ga.bottom)a:for(e=c-1;0<=e;e--){for(f=0;f<d;f++)if(a[f+e*d])break a;b.bottom++}if(!this.ga.left)a:for(e=0;e<d;e++){for(f=0;f<c;f++)if(a[e+f*d])break a;b.left++}if(!this.ga.right)a:for(e=d-1;0<=e;e--){for(f=0;f<c;f++)if(a[e+f*d])break a;b.right++}return b}gc(){const a=this.canvas.ic(),b=[];for(let c=3;c<a.length;c+=4)b.push(0!==a[c]);return b}xb(a){"number"===typeof a&&(a={top:a,bottom:a,left:a,right:a});
a=Object.assign({top:0,bottom:0,left:0,right:0},a);this.padding.top+=a.top;this.padding.bottom+=a.bottom;this.padding.left+=a.left;this.padding.right+=a.right;this.Db()}Jc(a){"number"===typeof a&&(a={top:a,bottom:a,left:a,right:a});a=Object.assign({top:0,bottom:0,left:0,right:0},a);this.padding.top=Math.max(0,this.padding.top-a.top);this.padding.bottom=Math.max(0,this.padding.bottom-a.bottom);this.padding.left=Math.max(0,this.padding.left-a.left);this.padding.right=Math.max(0,this.padding.right-a.right);
this.Db()}Db(){this.H.set({x:this.padding.left,y:this.padding.top});this.canvas.clear().Ra(this.H.width+this.padding.left+this.padding.right,this.H.height+this.padding.top+this.padding.bottom,!1);this.H.C(this.canvas.G)}Cc(){this.Eb={x:this.H.x,y:this.H.y}}Bc(){this.H.set(this.Eb)}}class Q{constructor(a,b){this.ja=a;this.target=b}pb(){this.target.y=this.ja.y+this.ja.height-this.target.height}Ub(){this.target.y=Math.round(this.ja.y+this.ja.height/2-this.target.height/2)}Tb(){this.target.x=Math.round(this.ja.x+
this.ja.width/2-this.target.width/2)}U(){this.Ub();this.Tb();return this.target}}class p extends z(){constructor(){super();this.y=this.x=0;this.height=this.width=1;this.style=new P;this.parent=null}C(){}ma(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}oc(a){const b=this.ma();a=a.ma();return b.left<a.right&&b.right>a.left&&b.top<a.bottom&&b.bottom>a.top?!0:!1}D(a){a.J(this);return this}da(a){this.style.set(a);return this}cache(){J.cache(this);return this}zc(a){let b=
this.parent,c={x:this.x,y:this.y};for(;null!==b&&a!==b;)c.x+=b.x,c.y+=b.y,b=b.parent;return c}qb(a){let b=this.U;a=a.U;return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))}fa(a){return new Q(a,this)}get U(){return{x:this.x+this.width/2,y:this.y+this.height/2}}}const K={a:9938118,b:7642407,c:6587686,d:7644455,e:7375911,f:1084455,g:14988334,h:9747753,i:1082401,j:2265223,k:5409957,l:7373857,m:18405233,n:9745769,o:6595878,p:1088807,q:12789030,r:9739559,s:7608366,t:2164807,u:6595881,v:2270505,w:10835633,
x:5408933,y:2164901,z:15763599,0:2266274,1:2164834,2:7380099,3:7478407,4:4332705,5:3284007,6:7511079,7:2164871,8:7511207,9:7478439,"!":1049633,"?":2099331,".":1048576,"+":72768,"-":7168,"/":1083524,"*":5189,"%":26808627,$:7674030,":":32800,"#":11512810,"(":2130978,")":1116225," ":0,"\x3c":4260932,"\x3e":1118273,"[":3179555,"]":3213379,"@":31123020,"'":1};class r extends p{constructor(){super();this.fontSize=Math.round(g(.66));this.text="a";this.style.color="#000"}Da(a){this.fontSize=Math.max(1,a);
this.width=this.sb();this.height=5*this.fontSize;return this}T(a){this.text=a;this.width=this.sb();this.height=5*this.fontSize;return this}C(a){a.fillStyle=this.style.color;a.globalAlpha=this.style.opacity;const b=this.fontSize,c=this.fontSize;let d=Math.ceil(this.x);for(let f=0;f<this.text.length;f++){const g=K[this.text.charAt(f).toLowerCase()];if(void 0!=g){for(var e=0;5>e;e++)for(let f=0;5>f;f++)g&1<<5*e+f&&a.fillRect(d+f*b,this.y+e*c,b,c);d+=6*b;for(e=17318416;(~g&e)==e&&1082401<e;)d-=b,e>>>=
1}}return this}sb(){const a=this.fontSize;let b=0;for(let c=0;c<this.text.length;c++){const d=K[this.text.charAt(c).toLowerCase()];if(void 0==d)continue;b+=6*a;let e=17318416;for(;(~d&e)==e&&1082401<e;)b-=a,e>>>=1}return b-this.fontSize}}const B={};class L{constructor(a){this.Ma=a;this.Na=987654321-a;this.fb=4294967295;this.next()}next(){this.Na=36969*(this.Na&65535)+(this.Na>>16)&this.fb;this.Ma=18E3*(this.Ma&65535)+(this.Ma>>16)&this.fb;return((this.Na<<16)+this.Ma&this.fb)/4294967296+.5}Cb(a){a=
this.next()*(a-0+1);return a=Math.floor(a)}static set(a,b){B.hasOwnProperty(a)&&delete B[a];B[a]=new L(b)}static get(a){return B[a]}}class R{constructor(){this.ka=0;this.play=!1;this.cb=this.timestamp();this.Jb=()=>{}}start(a){this.play=!0;this.Jb=a;this.cb=this.timestamp();return this.Bb()}stop(){this.play=!1}lb(a){this.Jb(a);this.play&&this.Bb()}timestamp(){return window.performance.now()}Bb(){return window.requestAnimationFrame(()=>{if(this.play){var a=this.timestamp(),b=a-this.cb;this.ka=b=999<
b?1/60:b/1E3;this.cb=a;this.lb(b)}})}}class l extends p{constructor(){super();this.children=[]}J(a){if(Array.isArray(a))a.forEach((a)=>this.J(a));else if(!this.children.includes(a))return a.parent=this,this.children.push(a),this}removeChild(a){if(!this.children.includes(a))return!1;this.children.splice(this.children.indexOf(a),1);return!0}C(a){this.Xa(a)}Xa(a){a.save();a.translate(this.x,this.y);this.children.forEach((b)=>{a.save();b.C(a);a.restore()});a.restore()}get nc(){return{x:0,y:0,width:this.width,
height:this.height}}}class t extends p{C(a){a.fillStyle=this.style.color;a.globalAlpha=this.style.opacity;a.fillRect(this.x,this.y,this.width,this.height);return this}}class h extends z(){constructor(){super();this.height=this.width=0;this.map=[]}jc(){return{width:this.ha(this.width),height:this.ha(this.height)}}B(){let {width:a,height:b}=this.jc(),c=(new p).set({width:a,height:b});c.C=(a)=>{this.map.forEach((b,d)=>{a.fillStyle=b;a.fillRect(c.x+this.ha(Math.floor(d%this.width)),c.y+this.ha(Math.floor(d/
this.width)),this.ha(1),this.ha(1))})};return c}Mc(){const a=this.B(),b=new A;b.Ra(a.width,a.height,!1);a.C(b.G);return b}Nc(a){const b=this.Mc(),c=new p;c.set({width:b.width,height:b.height});a.width&&c.set({width:a.width});a.height&&c.set({height:a.height});const d=(new A).Ra(c.width,c.height,!1);a=d.G.createPattern(b.node,"repeat");d.G.fillStyle=a;d.G.fillRect(0,0,c.width,c.height);c.C=function(a){a.drawImage(d.node,this.x,this.y)};return c}ha(a){return a}static load(a,b,c=0){const d=[];a=a.trim();
0===c&&(c=a.indexOf("\n"),c=0<c?c:a.length);for(let c of a)"\n"!==c&&d.push(b[c]);return(new this).set({map:d,width:c,height:Math.ceil(d.length/c)})}}class f extends h{ha(a){return g(a)}}class S{constructor(){this.right=this.left=this.ua=this.Fa=!1;this.na=[];this.ob={Fa:[38,90,87],ua:[40,83],left:[37,65,81],right:[39,68]};this.Ua()}N(a,b){this.na.unshift({keys:a,sa:b})}W(a,b=null){this.na=this.na.filter((c)=>c.keys.sort().toString()!=a.sort().toString()||b&&c.sa!==b?!0:!1)}Fb(a,b){for(let c in this.ob)if(this.ob[c].includes(a)){this[c]=
b;break}b&&this.Oc(a)}Oc(a){if(this.na.length){var b=[];this.na=this.na.filter((c)=>{if(!c.keys.includes(a))return!0;b.push(c.sa);return!1});b.forEach((a)=>a.call())}}Ua(){window.addEventListener("keydown",(a)=>this.Fb(a.keyCode,!0));window.addEventListener("keyup",(a)=>this.Fb(a.keyCode,!1));window.addEventListener("blur",()=>this.Fa=this.ua=this.left=this.right=!1)}}const k=new S;k.Kb=32;h={0:"\n000000000\n000000000\n000000000\n000222000\n000212000\n000222000\n000000000\n000000000\n000000000",t:"\n022222220\n021111120\n022212220\n021111120\n022212220\n000212000\n000212000\n000212000\n000222000",
l:"\n002220000\n002120000\n222122000\n211112200\n222121220\n002122122\n002122212\n002120212\n002220222",i:"\n000002220\n000222120\n000211120\n022222120\n021221220\n021212220\n021122120\n021222120\n022202220",y:"\n000022220\n000221120\n002212120\n002122120\n002221120\n002212120\n022122120\n021222120\n022202220",a:"\n000222000\n002212200\n222111222\n211212112\n221212122\n022212220\n002121200\n002212200\n000222000",p:"\n022222200\n021111220\n022122120\n021111220\n022122200\n002120000\n002120000\n002120000\n002220000",
n:"\n000002220\n000222120\n000211120\n022222120\n021222220\n021122220\n021212120\n021221120\n022222220"};const E={normal:{0:f.load(h["0"],e.A.F).B().cache(),t:f.load(h.t,e.A.F).B().cache(),l:f.load(h.l,e.A.F).B().cache(),i:f.load(h.i,e.A.F).B().cache(),y:f.load(h.y,e.A.F).B().cache(),a:f.load(h.a,e.A.F).B().cache(),p:f.load(h.p,e.A.F).B().cache(),n:f.load(h.n,e.A.F).B().cache()},glowing:{0:f.load(h["0"],e.A.Z).B().cache(),t:f.load(h.t,e.A.Z).B().cache(),l:f.load(h.l,e.A.Z).B().cache(),i:f.load(h.i,
e.A.Z).B().cache(),y:f.load(h.y,e.A.Z).B().cache(),a:f.load(h.a,e.A.Z).B().cache(),p:f.load(h.p,e.A.Z).B().cache(),n:f.load(h.n,e.A.Z).B().cache()},correct:{0:f.load(h["0"],e.A.aa).B().cache(),t:f.load(h.t,e.A.aa).B().cache(),l:f.load(h.l,e.A.aa).B().cache(),i:f.load(h.i,e.A.aa).B().cache(),y:f.load(h.y,e.A.aa).B().cache(),a:f.load(h.a,e.A.aa).B().cache(),p:f.load(h.p,e.A.aa).B().cache(),n:f.load(h.n,e.A.aa).B().cache()},incorrect:{0:f.load(h["0"],e.A.ba).B().cache(),t:f.load(h.t,e.A.ba).B().cache(),
l:f.load(h.l,e.A.ba).B().cache(),i:f.load(h.i,e.A.ba).B().cache(),y:f.load(h.y,e.A.ba).B().cache(),a:f.load(h.a,e.A.ba).B().cache(),p:f.load(h.p,e.A.ba).B().cache(),n:f.load(h.n,e.A.ba).B().cache()}};class M extends p{constructor(){super();this.R="0";this.format="normal";this.width=E[this.format][this.R].width;this.height=E[this.format][this.R].height}C(a){const b=E[this.format][this.R];b.x=this.x;b.y=this.y;a.globalAlpha=this.style.opacity;b.C(a)}}class T extends C(){}const d={V:new T,za:!1,ra:"",
X:"",va:!1,Ja:!1,tb:!1};let u=[];class m extends C(l){constructor(){super();this.padding={wa:g(5),vertical:g(3)};this.margin={wa:g(7),vertical:g(15)};this.background=(new t).set({x:-1*this.padding.wa,y:-1*this.padding.vertical}).da({color:"#fff"});this.J(this.background);this.text=new r;this.J(this.text);this.Ha=(new r).Da(g(.56)).T("[space] to continue").da({color:"#999"});this.J(this.Ha);this.F=!1;this.wb=[k.Kb];this.nb=!1}Dc(a){this.Sb=a;return this}T(a){this.text.T(a);return this}Gb(a){if(!a)return this.F&&
(this.F.forEach((a)=>this.removeChild(a)),this.F=!1),this;this.F=[];a.forEach((a)=>{const b=new M;b.R=a;this.F.push(b);this.J(b)});return this}Ob(){var a=Math.max(this.text.width,this.Ha.width),b=this.text.height+this.padding.vertical+this.Ha.height+(this.F?this.F[0].height+this.padding.vertical:0);this.set({x:Math.round(d.canvas.width-this.margin.wa-this.padding.wa-a),y:Math.round(d.canvas.height-this.margin.vertical-this.padding.vertical-b)});this.background.set({width:a+2*this.padding.wa,height:b+
2*this.padding.vertical});a=this.text.height+this.padding.vertical;if(this.F){for(b=0;b<this.F.length;b++)this.F[b].set({y:a}),this.F[b].x+=g(1)*b+this.F[b].width*b;a+=this.F[0].height+this.padding.vertical}this.Ha.set({y:a})}show(){this.Ob();d.level.P.J(this);this.Lb();let a=Math.round(d.canvas.height-this.margin.vertical-this.background.height);u.forEach((b)=>{b.y=Math.round(a-b.background.height);a-=b.background.height+this.padding.vertical});u.unshift(this);return this}ab(){d.level.P.removeChild(this);
u.splice(u.indexOf(this),1);this.la("hide.instant",this);setTimeout(()=>{this.la("hide",this)},250)}Lb(){let a=()=>{k.W(this.wb,a);clearTimeout(this.nb);this.ab()};k.N(this.wb,a);this.Sb&&(this.nb=setTimeout(a,5E3))}static display(a,b=!1){return(new m).T(a).Dc(b).show()}static Va(){u.forEach((a)=>a.ab())}}class U{constructor(a,b){this.x=a;this.y=b;this.size=g(1);this.speed=y(120,240)}update(a){this.y+=a*this.speed}}class F extends p{constructor(){super();this.level=this.height=this.width=0;this.Sa=
!1;this.vb=10;this.sc=2E3;this.Aa=this.vb;this.Oa=[];this.Lc=360}xa(){let a=this.Aa;for(;a--;)this.mb();return this}jb(a){this.level=a;a=this.vb;this.Aa=a+this.level*(this.sc-a)}ub(){this.Sa=1}C(a){if(!1!==this.Sa){var b=this.level+.005;b>=this.Sa&&(this.Sa=!1,setTimeout(()=>d.V.la("storm.target.reached"),250));this.jb(b)}for(;this.Oa.length<this.Aa;)this.mb();a.fillStyle="#fad170";a.globalAlpha=this.level;a.globalCompositeOperation="color";a.fillRect(0,0,this.width,this.height);a.globalCompositeOperation=
"source-over";a.fillRect(0,0,this.width,this.height);a.fillStyle="#876701";a.globalAlpha=1;a.globalCompositeOperation="source-over";for(b=this.Oa.length;b--;){const c=this.Oa[b];c.y>=this.height?(c.y=-c.size+c.y%this.height,c.x=y(0,this.width,!0)):c.y<-2*c.size&&(c.y=this.height+c.y%this.height);c.x<-1*c.size?c.x+=this.width+c.size:c.x>this.width&&(c.x-=this.width+c.size);a.fillRect(c.x,c.y,c.size,c.size);c.update(d.loop.ka);c.x+=d.level.view.I.x+d.loop.ka*this.Lc;c.y+=d.level.view.I.y}}mb(){this.Oa.push(new U(y(0,
this.width,!0),y(0,this.height,!0)))}}class q extends p{constructor(){super();this.height=this.width=0;this.direction="in";this.sa=()=>{};this.speed=1.5}setDirection(a){this.direction=a;this.style.opacity="out"==this.direction?0:1;return this}done(){setTimeout(()=>this.sa(this),1)}remove(){this.parent.removeChild(this);return this}C(a){"out"==this.direction?1>this.style.opacity&&(this.style.opacity=Math.min(1,this.style.opacity+d.loop.ka*this.speed),1<=this.style.opacity&&this.done()):0<this.style.opacity&&
(this.style.opacity=Math.max(0,this.style.opacity-d.loop.ka*this.speed),0>=this.style.opacity&&this.done());a.fillStyle=e.A.ia["0"];a.globalAlpha=this.style.opacity;a.fillRect(0,0,d.canvas.width,d.canvas.height)}then(a){this.sa=a;return this}Hb(){this.speed=.5;return this}static gb(){return(new q).setDirection("out")}static bb(){return(new q).setDirection("in")}}class V extends l{constructor(){super();this.target=null;this.K={left:0,right:1,top:0,bottom:1};this.I={x:0,y:0}}J(a){super.J(a)}C(a){this.tc();
return super.C(a)}tc(){const a=this.target.zc(this),b=this.children[0];this.I.x=this.I.y=0;this.target.width<this.K.right-this.K.left?a.x<this.K.left?(this.I.x=this.K.left-a.x,b.x+=this.I.x):a.x+this.target.width>this.K.right&&(this.I.x=-1*(a.x+this.target.width-this.K.right),b.x+=this.I.x):(this.I.x=this.K.left-a.x,b.x+=this.I.x);this.target.height<this.K.bottom-this.K.top?a.y<this.K.top?(this.I.y=this.K.top-a.y,b.y+=this.I.y):a.y+this.target.height>this.K.bottom&&(this.I.y=-1*(a.y+this.target.height-
this.K.bottom),b.y+=this.I.y):(this.I.y=this.K.top-a.y,b.y+=this.I.y)}}const O=1/Math.sqrt(2),G={front:f.load("\n000000000000200000002200000000\n000000000000222222222200000000\n000000000000222ccccc2200000000\n00000000000022ccdddcc200000000\n0000000000002c5555555200000000\n000000000000ee5fg55g5e00000000\n00000000000eee4fh44h5e00000000\n0000000000022c4444444200000000\n00000000000221ccdddc1220000000\n000000000022221cccc11220000000\n000000000022221111111220000000\n000000000022222222222222000000\n000000000222222222222222000000\n000000000222222222222222000000\n000000022222222222222222000000\n000000022222222222222222200000\n000005522222222222222222250000\n000000555522222222222222555000\n000000055555222222222225550000\n000000022255555555555555200000\n000000222222222222222222200000\n000000222222222222222222200000\n000002222222222222222222200000\n000002222222222222222222200000\n000002222222222222222222220000\n000022222222222222222222220000\n000022222222222212212222210000\n000222212221222112112221211000\n000222112211122112111221211000\n000222112211121112555555555000\n005555112211125555225221122000\n005222555555551111255521552000\n005221152111155155555555555000\n005255555555225112551255112500\n055225112511155512151251112500\n052251515551151512555555555550\n052255515151255555555555555555\n055555555555555555222222222225\n055555555552222222222222555550\n555555555555500000120000000000\n000000000021200000110000000000\n000000000011100000210000000000\n000000000011000000100000000000\n000000000001000000000000000000\n",
e.A.zb).B().cache()};class W extends p{constructor(){super();this.width=G.front.width;this.height=G.front.height;this.La=this.eb=0;this.direction={x:"left",y:"down"}}setDirection(a){a.x&&(this.direction.x=a.x);a.y&&(this.direction.y=a.y);return this}C(a){this.eb=(this.eb+d.loop.ka/2)%2;this.La=Math.round(.1*Math.abs(this.eb-1)*this.height);let b=this.x,c=this.y-this.La;"left"==this.direction.x&&(a.scale(-1,1),b=-1*this.x-this.width);let e=G.front;e.x=b;e.y=c;e.C(a)}}class X extends N(l){constructor(){super();
this.element=new W;this.J(this.element);this.width=this.element.width;this.height=g(3);this.element.fa(this.nc).pb();this.element.y-=g(1)}C(a){this.element.setDirection(this.direction);a.fillStyle="rgba(0, 0, 0, 0.05)";const b=9<this.element.La?3:this.element.La/3,c=g(1);a.fillRect(this.x+c+3*b,this.y-2*c+b,this.width-2*c-6*b,this.height+4*c-2*b);a.fillRect(this.x+3*b,this.y-c+b,this.width-6*b,this.height+2*c-2*b);a.fillRect(this.x-c+3*b,this.y+b,this.width+2*c-6*b,this.height-2*b);super.C(a)}move(a){if(!d.za){k.left||
k.right||k.Fa||k.ua?(this.speed+=e.speed.acceleration*a,this.speed=Math.min(this.speed,e.speed.max)):(this.speed*=Math.pow(.6,60*a),this.speed=.1>this.speed?0:this.speed);if(k.left)this.direction.x="left";else if(k.right)this.direction.x="right";else if(k.Fa||k.ua)this.direction.x="";if(k.Fa)this.direction.y="up";else if(k.ua)this.direction.y="down";else if(k.left||k.right)this.direction.y="";super.move(a)}}}class Y extends l{C(a){this.Xa(a)}Xa(a){a.save();a.translate(this.x,this.y);this.children.sort((a,
c)=>a.y-c.y).forEach((b)=>{a.save();b.C(a);a.restore()});a.restore()}}const Z=f.load("\n00000000000000000000000000\n00100000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000001000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000001000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000010000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000",
e.A.ia);class aa extends p{C(a){Z.Nc({height:this.height,width:this.width}).set({x:this.x,y:this.y}).C(a)}}const H={1:f.load("\n0000100\n0101200\n0210210\n2202122\n0303023\n0032032\n0002220\n0003300\n",e.A.oa).B().cache(),2:f.load("\n00300\n00230\n03220\n02220\n02220\n03223\n02322\n32232\n22222\n",e.A.oa).B().cache(),3:f.load("\n0001000000\n0002000000\n0002010000\n0002020001\n1000200012\n0200300020\n0300300030\n",e.A.oa).B().cache(),4:f.load("\n000030000\n003030003\n302020002\n200020302\n200020202\n003020200\n002000000\n",
e.A.oa).B().cache(),5:f.load("\n000010000\n000120000\n100002010\n020202021\n020030020\n002300300\n000023000\n",e.A.oa).B().cache(),6:f.load("\n021\n120\n020\n021\n130\n030\n",e.A.oa).B().cache()};class ba extends p{constructor(){super();this.kind="1";this.width=H[this.kind].width;this.height=H[this.kind].height}C(a){const b=H[this.kind];b.x=this.x;b.y=this.y;a.globalAlpha=this.style.opacity;b.C(a)}Ec(a){this.kind=a;return this}}var v=f.load("\n0111111111111111110\n1122222222222222222\n1233333333333333332\n1233333333333333332\n1233333333333333332\n1233333333333333322\n0222222222222222220\n",
{0:"rgba(0,0,0,0)",1:"rgba(182,178,179,255)",2:"rgba(210,208,209,255)",3:"rgba(255,255,255,255)"}).B().cache();class ca extends t{constructor(){super();this.width=v.width;this.height=v.height}C(a){v.x=this.x;v.y=this.y;v.C(a)}}class da extends D(t){constructor(){super();this.width=n(1);this.height=n(1)}C(a){a.fillStyle=e.A.ia["1"];a.globalAlpha=1;a.fillRect(this.x,this.y,this.width,this.height)}ma(){return{left:this.x-g(2),right:this.x+this.width+g(2),top:this.y-g(2),bottom:this.y+this.height+g(2)}}}
var w=f.load("\n0000000111110000000\n0000011122222200000\n0000112333333330000\n0001123333333333000\n0011233333333333300\n0112333333333333330\n0123333333333333330\n1133333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233434333333333333\n1235333433333333333\n1233453333343334333\n1233355004330354333\n6230350000500053303\n",{0:"rgba(0,0,0,0)",1:"rgba(182,178,179,255)",
2:"rgba(210,208,209,255)",3:"rgba(255,255,255,255)",4:"rgba(0,177,227,255)",5:"rgba(0,134,201,255)",6:"rgba(255,213,79,255)"}).B().cache();class ea extends l{constructor(){super();this.width=w.width;this.height=w.height;this.S=new M;this.S.y=g(5);this.S.R="a";this.S.format="normal";this.S.fa(this).U();this.J(this.S)}C(a){w.x=this.x;w.y=this.y;w.C(a);super.C(a)}}class fa extends D(l){constructor(){super();this.element=(new ea).D(this);this.width=this.element.width;this.height=g(5);this.element.fa(this).pb();
this.status=this.Ia=!1}Fc(a){this.element.S.R=a;return this}Nb(){this.Ia||(this.Ia=!0,this.element.S.format="glowing",d.V.la("fusebox.activated",{R:this.element.S.R,Za:this}))}Ib(a){this.status=a;this.element.S.format=a}$b(){this.Ia&&(this.state=this.Ia=!1,this.element.S.format="normal")}}const x=f.load("\n000000000000000000000001100000000000000000000000\n000000000000000000000012210000000000000000000000\n000000000000000000000012210000000000000000000000\n000000000000000000000012210000000000000000000000\n000000000000000000000322223000000000000000000000\n000000000000000000000322223000000000000000000000\n000000000000000000000322223000000000000000000000\n000000000000000000003222222300000000000000000000\n000000000000000000003222222300000000000000000000\n000000000000000000003232232300000000000000000000\n000000000000000000032232232230000000000000000000\n000000000000000000032232232230000000000000000000\n000000000000000000322232232223000000000000000000\n000000000000000000322322223223000000000000000000\n000000000000000003222322223222300000000000000000\n000000000000000003222322223222300000000000000000\n000000000000000032222322223222230000000000000000\n000000000000000322223222222322223000000000000000\n000000000000000322223222222322223000000000000000\n000000000000003222223222222322222300000000000000\n000000000000004222232222222232222400000000000000\n000000000000045522232222222232225540000000000000\n000000000000035552232222222232255530000000000000\n000000000000322555422222222224555223000000000000\n000000000003222225455555555554522222300000000000\n000000000003222222355555555553222222300000000000\n000000000032222223222223322222322222230000000000\n000000000032222223222223322222322222230000000000\n000000000322222223222236632222322222223000000000\n000000000422222232222236632222232222224000000000\n000000004522222233222366663222332222225400000000\n000000032252222232322366663223232222252230000000\n000000035225222322233666666332223222522530000000\n000000322525522322223666666322223225525223000000\n000000355252252322236666666632223252252553000000\n000004525225224555446666666644555422522525400000\n000045552222521225466666666664522125222255540000\n700045555255248555466666666664555842552555540007\n070313555595212522a66bbbbbb66a225212595555313070\n07331135555223555236bbbbbbbb63255532255553113370\n000031135555325253bbbbbbbbbbbb352523555531130000\n000003113555455554bbbbbbbbbbbb455554555311300000\n000000111355455554bbb000000bbb455554553111000000\n00000003113455554bb0000000000bb45555431130000000\n000000003114555540000000000000045555411300000000\n000000000713555400000000000000004555317000000000\n000000000073333000000000000000000333370000000000\n000000000070000000000000000000000000070000000000\n",
e.A.zb).B().cache();class ha extends D(l){constructor(){super();this.set({width:x.width,height:Math.round(x.height/2)});x.y=-1*x.height;this.J(x)}ma(){return{left:this.x,right:this.x+this.width,top:this.y-this.height,bottom:this.y+g(1)}}get U(){return{x:this.x+this.width/2,y:this.y}}}let I=!1;class ia{constructor(){this.width=n(30);this.height=n(30);this.H=(new Y).set({width:n(this.width),height:n(this.height)});I||(I=this.Xb());I.D(this.H);this.H.J(this.Zb());this.H.J(this.Yb())}xc(a){const b=this.ca.ma();
a.x=b.right+n(1);a.y=b.bottom+n(1);this.H.J(a)}Xb(){var a=n(7),b=n(2),c=n(2);a=(new l).set({x:-1*c,y:-1*a,width:this.width+2*c,height:this.height+a+b});(new aa).set({x:0,y:0,width:a.width,height:a.height}).D(a);for(b=Math.floor(Math.floor(this.width/e.size.$a)*Math.floor(this.height/e.size.$a)/2);b--;)c=1+b%6,(new ba).Ec(c).set({x:d.Pa.Cb(a.width),y:d.Pa.Cb(a.height)}).D(a);a.cache();return a}Zb(){const a=g(1);return[[0,0,this.width,a],[0,this.height-a,this.width,a],[0,0,a,this.height],[this.width-
a,0,a,this.height]].map((a)=>(new da).set({pc:!0,x:a[0],y:a[1],width:a[2],height:a[3]}))}Yb(){this.ca=new ha;this.ca.set({x:(this.width-this.ca.width)/2,y:this.height/2-this.ca.height});return d.ca=this.ca}yc(a){this.Y=[];this.Ga=[];for(let b in a){const c=a[b];this.Y.push((new fa).Fc(b).set({x:n(c.x),y:n(c.y)}).D(this.H))}this.Y.forEach((a)=>{this.Ga.push((new ca).set({x:a.x,y:a.y+a.height+g(1)}).D(this.H))});d.Y=this.Y;d.Ga=this.Ga}}class ja extends l{constructor(){super();this.width=g(100);this.height=
g(5);this.padding=g(1);this.ya=this.Ka=!1;this.Ta=this.Ea=0}C(a){if(this.Ka){var b=this.yb();a.fillStyle=e.A.L["0"];a.fillRect(this.x,this.y,this.width,this.height);a.fillStyle=e.A.L["1"];a.fillRect(this.x+this.padding,this.y+this.padding,this.width-2*this.padding,this.height-2*this.padding);a.fillStyle=e.A.L["2"];a.fillRect(this.x+this.padding,this.y+this.padding,Math.floor((this.width-2*this.padding)*Math.round(100*b)/100/g(1))*g(1),this.height-2*this.padding);super.C(a)}}start(){this.ya=this.Ka=
!0;return this}pause(){this.ya=!1;return this}stop(){this.ya=this.Ka=!1;this.Ea=0;return this}lb(a){this.ya&&(this.Ea+=a,this.Ea>=this.Ta&&(this.pause(),d.V.la("timer.timeout")))}yb(){return 0===this.Ta?0:this.Ea/this.Ta}Gc(a){this.Ta=a}}f={t:{x:9,y:28},l:{x:26,y:24},i:{x:16,y:29},y:{x:4,y:2},a:{x:25,y:6},p:{x:2,y:20},n:{x:11,y:8}};const ka={1:{X:"til",timeout:60,ea:0,qa:.3,kb:f},2:{X:"napy",timeout:60,ea:.3,qa:.6,kb:f},3:{X:"linyt",timeout:60,ea:.6,qa:.9,kb:f}};class la extends C(z()){constructor(a){super();
this.level=a;this.ta=new ia;this.O=new X;d.L=this.L=new ja;d.pa=this.pa=new F;this.ib=new l;this.view=new V;this.Ya=new l;this.P=new l;this.ea=0;this.qa=1;this.Wa=!1}qc(){const a=ka[this.level];this.ea=a.ea;this.qa=a.qa;this.pa.jb(this.ea);this.L.Gc(a.timeout);this.ta.yc(a.kb);d.za=!0;d.va=!1;d.ra="";d.Ja=!1;d.X=a.X}start(){this.Ac();this.qc();this.Wa=d.loop;d.canvas.Qa(this.ib);this.Wa.start((a)=>this.rc(a));q.bb().D(this.P).then((a)=>a.remove());this.Ua();const a={1:["the signal is down. We need it back asap.",
"Be quick. a storm is coming your way."],2:["The storm is interfering with our signal!","the storm is getting worse. so be quick."],3:["The signal is failing.","Be careful."]}[this.level];m.display(a[0]).N("hide",(b)=>{b.W("hide");b.T("activate these "+d.X.length+" stones in the right order:").Gb(d.X.split("")).show().N("hide",(b)=>{b.W("hide");b.T(a[1]).Gb(!1).show().N("hide.instant",(a)=>{a.W("hide");d.za=!1;this.L.start();"1"==this.level&&m.display("(Move with arrow keys or wasd)",!0)})})});return this}stop(){this.stopped=
!0;this.Wa.stop();this.la("stop")}Ua(){d.V.N("fusebox.deactivateAll",()=>{this.ta.Y.forEach((a)=>a.Qc())});d.V.N("fusebox.activated",(a)=>{const b=d.X[d.ra.length];if("undefined"!=typeof b){d.Ja=!0;var c=m.display("Activating...");setTimeout(()=>{c.ab();setTimeout(()=>{d.Ja=!1;a.R!=b?(m.display("This does not seem right.",!0),a.Za.Ib("incorrect")):(d.ra+=a.R,a.Za.Ib("correct"),d.ra.length===d.X.length?(d.va=!0,m.display("signal is back online. head back to safety.",!0)):m.display("Stone activated.",
!0))},1)},2E3)}});d.V.N("timer.timeout",()=>{d.za=!0;d.L.Ka=!1;d.V.N("storm.target.reached",()=>{d.V.W("storm.target.reached");m.Va();m.display("The sand came so quickly ...").N("hide",(a)=>{a.W("hide");q.gb().D(this.P).then(()=>{this.stop();setTimeout(()=>d.rb.hb(this.level),10)})})});d.pa.ub()})}rc(a){this.stopped||(this.L.ya&&(this.L.lb(a),this.pa.jb(this.ea+this.L.yb()*(this.qa-this.ea))),this.O.move(a),this.cc(),this.ac(),this.bc(),d.canvas.C())}Ac(){this.view.set({width:d.canvas.width,height:d.canvas.height,
target:this.O}).D(this.ib);this.Ya.set({x:Math.round(d.canvas.width/2-this.Ya.width/2),y:Math.round(d.canvas.height/2-this.Ya.height/2),width:d.canvas.width,height:d.canvas.height}).J(this.ta.H).D(this.view);this.P.set({x:0,y:0,width:d.canvas.width,height:d.canvas.height}).D(this.ib);this.pa.set({width:d.canvas.width,height:d.canvas.height}).xa().D(this.P);this.L.set({x:Math.round(d.canvas.width-this.L.width-g(7)),y:d.canvas.height-this.L.height-g(7)}).D(this.P);Object.assign(this.view.K,{left:Math.round(.2*
this.view.width),right:Math.round(.8*this.view.width),top:Math.round(.5*this.view.height),bottom:Math.round(.8*this.view.height)});this.ta.xc(this.O)}cc(){this.ta.H.children.forEach((a)=>{a.Vb&&this.O.oc(a)&&(a.pc&&!d.tb&&(d.tb=!0,m.display("Do not go too far.",!0)),a=this.O.Wb(a),this.O.x+=a.x,this.O.y+=a.y)})}ac(){if(!d.va&&!d.Ja){var a=g(25);d.Ga.forEach((b,c)=>{this.O.qb(b)<a?d.Y[c].Nb():"incorrect"===d.Y[c].status&&d.Y[c].$b()})}}bc(){d.va&&this.O.qb(d.ca)<g(25)&&(d.va=!1,d.za=!0,d.L.stop(),
d.pa.ub(),m.Va(),m.display("Good job! await further instructions.").N("hide",(a)=>{a.W("hide");q.gb().D(this.P).then(()=>{this.stop();setTimeout(()=>d.rb.hb(this.level+1),10)})}))}}class ma{constructor(){this.Ab={};this.level=this.Ca=this.canvas=null;d.rb=this}xa(){this.mc();this.kc();this.lc();return this}start(){this.Hc().then(()=>this.hb(1))}Hc(){const a=new l,b=(new t).set({width:this.canvas.width,height:this.canvas.height}).da({color:"#fff"}).D(a);d.level={P:a,view:{I:{x:0,y:0}}};(new F).set({width:this.canvas.width,
height:this.canvas.height,Aa:100}).xa().D(a);const c=(new r).Da(g(6)).T("SAND").da({color:e.A.ia["0"]}).D(a).fa(b).U();(new r).Da(g(1)).T("a js13kGames entry by @hellosiyan").da({color:e.A.ia["0"]}).D(a).fa(b).U().set({y:c.y+c.height+g(10)});this.canvas.Qa(a);this.loop.start(()=>{this.canvas.C()});return new Promise((b)=>{m.display("Press [space] to start").N("hide",(c)=>{c.W("hide");a.J(q.gb().then(()=>{this.loop.stop();setTimeout(()=>b(),10)}))});q.bb().Hb().D(a).then((a)=>a.remove())})}Ic(){const a=
new l,b=(new t).set({width:this.canvas.width,height:this.canvas.height}).da({color:"#fff"}).D(a);d.level={P:a,view:{I:{x:0,y:0}}};(new F).set({width:this.canvas.width,height:this.canvas.height,Aa:100}).xa().D(a);const c=(new r).Da(g(6)).T("SAND").da({color:e.A.ia["0"]}).D(a).fa(b).U();c.y=Math.round(c.y+g(20));[[1,"a js13kGames entry by @hellosiyan",c.height+g(10)],[1,"signal is back",g(-50)],[2,"The storm has passed",g(-40)],[1,"Thanks for playing",g(-11)]].forEach((d)=>{(new r).Da(g(d[0])).T(d[1]).da({color:e.A.ia["0"]}).D(a).fa(b).U().set({y:c.y+
d[2]})});this.canvas.Qa(a);q.bb().Hb().D(a).then((a)=>a.remove());this.loop.start(()=>{this.canvas.C()})}hb(a){this.level&&this.level.stop();m.Va();d.V.uc();4<=a?this.Ic():setTimeout(()=>{this.level=new la(a);d.level=this.level;setTimeout(()=>this.level.start(),10)},10)}kc(){this.canvas=new A;this.canvas.Ra(800,600);this.Ca=(new l).set({width:this.canvas.width,height:this.canvas.height});this.canvas.Qa(this.Ca);this.canvas.Qb();d.canvas=this.canvas}lc(){this.loop=new R;d.loop=this.loop}mc(){this.Ab.Pa=
new L(822505);d.Pa=this.Ab.Pa}}(new ma).xa().start()})();</script>
</body>
</html>
