<!DOCTYPE html><html lang=en><meta charset=UTF-8><meta content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"name=viewport><title>Back to the BatttleShip</title><link href=favicon.png rel=icon type=image/png><meta content=#eee name=theme-color><link href=m.json rel=manifest><style>*{margin:0;padding:0}body,html{align-items:center;background-color:#eee;display:flex;font-family:Arial;height:100%;justify-content:center;overflow:hidden;text-rendering:optimizeLegibility;user-select:none}#a{background:#fff;height:660px;overflow:hidden;position:relative;width:370px}#s1,#s2{display:flex;height:100%}#s1{align-content:center;flex-direction:column;justify-content:center}#s2{align-items:center;position:absolute;width:750px}h1,h2{font-style:italic;text-align:center}h2{color:#339;cursor:pointer;font-weight:500;padding-bottom:10px;padding-top:10px;position:relative;text-transform:uppercase}#nm::before{content:"‚úé";position:absolute;color:#339;left:25px}#base{width:350px;height:350px;margin:0 auto;position:relative;margin-bottom:10px}button{background:0 0;padding:.5rem;margin:0 .5rem;font-size:1rem;cursor:pointer;border-top-left-radius:255px 15px;border-top-right-radius:15px 225px;border-bottom-right-radius:225px 15px;border-bottom-left-radius:15px 255px;border:solid 2px #339;margin-bottom:5px;color:#339;text-transform:uppercase;font-style:oblique;margin-left:30px;margin-right:30px;outline:0}.st{background-image:-webkit-repeating-linear-gradient(60deg,#fff,#fff 2px,#339 2px,#339 4px);-webkit-background-clip:text;-webkit-text-fill-color:transparent;position:relative;text-transform:uppercase}.st:after{background:0 0;content:attr(data-text);left:-.1em;position:absolute;text-shadow:1px 1px 0 #339;top:-.05em;text-transform:uppercase}.srn{opacity:0;position:absolute;transition:all .5s;transition-timing-function:ease-in;visibility:hidden;left:0}.srn.slide{left:-370px}.stage{width:100%}.brs{width:100%;display:flex;align-items:center;justify-content:center}.bts{display:flex;justify-content:center;margin-bottom:10px}.bt{width:15px;height:60px;margin-right:10px;position:relative}.bt::after{content:"";border:2px solid #339;position:absolute;width:100%;bottom:0}.bt.b1::after{height:15px}.bt.b2::after{height:30px}.bt.b3::after{height:45px}.bt.b4::after{height:60px}.gm{height:50px;display:flex;align-items:center;justify-content:center;flex-direction:column;width:80%;margin:0 auto}.prg{margin-top:5px;position:relative;width:100%;height:5px}.prg::after{content:"";width:100%;height:100%;position:absolute}.sc::after{background-image:linear-gradient(137deg,#ede 15%,#53c 15%,#53c 50%,#ede 50%,#ede 65%,#53c 65%,#53c 100%);background-size:14.66px 13.67px}canvas{cursor:pointer;outline:0;outline-color:transparent;outline-style:none;-webkit-tap-highlight-color:transparent}#f{display:flex;justify-content:space-between;opacity:0;position:absolute;top:30px;transition-timing-function:ease-in;transition:all .5s;visibility:hidden;width:100%;z-index:1}#a.shake{animation:shake .5s;animation-iteration-count:1}.mo{background:#fff;margin:0 auto;position:absolute;width:300px;padding:20px;border:solid 2px #339;display:flex;align-items:center;flex-direction:column;justify-content:center}#tm{padding:0 30px}#em{font-size:50px}.ov{display:none;position:fixed;height:100vh;background-color:#0000009e;width:100%}.ov.sh{align-content:center;align-items:center;display:flex;justify-content:center;flex-direction:column;z-index:1}.mbtns{padding-top:10px;width:100%;display:flex;justify-content:center}#mok{display:block}#mok.h{display:none}#tt{text-align:center;color:#339}#dev,#sha,#so{position:absolute;right:-11px;top:23px;border:0;font-size:30px;font-style:normal;z-index:1}#dev,#so{right:initial;left:-11px}#dev{top:65px}#bm{position:absolute;width:100%;height:50px;bottom:10px;display:flex;justify-content:center;align-content:center;transition-timing-function:ease-in;transition:all .5s;visibility:hidden}#chat{font-size:30px;font-style:normal;border:0}#ejs{display:none;position:absolute;width:80%;height:80px;border:1px solid #339;top:-80px;background:#fff;border-radius:20px;box-sizing:border-box;justify-content:space-between;padding:0 10px;overflow-y:auto}#ejs.sh{display:flex}#ejs button{border:0;font-size:30px;font-style:normal;padding:0;margin:auto 5px;width:40px;height:40px}.sh-ani{opacity:1!important;visibility:visible!important}#md{position:absolute;width:100%;height:80px;top:15%;display:flex;align-items:center;pointer-events:none}#md>div{font-size:50px;position:absolute;border:1px solid #000;border-radius:10px;width:60px;height:60px;display:flex;justify-content:center;background:#fff;transition:all .2s;transition-timing-function:cubic-bezier(.39,.58,.57,1)}#em-left{left:-70px}#em-left.sh{left:20px}#em-right{right:-70px}#em-right.sh{right:20px}#g1,#g2{font-size:30px}.ri{background-position:center;transition:background .5s}.ri:hover{background:#339 radial-gradient(circle,transparent 1%,#fff 1%) center/15000%;color:#fff}.ri:active{background-color:#339;background-size:100%;transition:background 0}</style><div class=ov><div class="s mo"></div></div><div id=a class=s><div id=f><button id=bck class=ri>Back</button></div><div id=s1 class=srn><button id=so></button> <button id=dev>üë®‚Äçüíª</button> <button id=sha>üîó</button><h1 class=st>Back to the BatttleShip</h1><h2 id=nm></h2><div class=brs><canvas id=b></canvas></div><button id=rand class=ri>Random Board</button> <button id=vs class=ri>Practice game</button> <button id=ol class=ri>Play Online</button></div><div id=s2 class=srn></div><div id=md><div id=em-left></div><div id=em-right></div></div><div id=bm><div id=ejs></div><button id=chat>üí¨</button></div></div><script src=/socket.io/socket.io.js></script><script src=/shared.js></script><script>function t(){this.sS=function(t){for(var e=0;e<24;e++)this[String.fromCharCode(97+e)]=t[e]||0;this.c<.01&&(this.c=.01);var o=this.b+this.c+this.e;if(o<.18){var n=.18/o;this.b*=n,this.c*=n,this.e*=n}}}var e=new function(){var e,o,n,s,r,a,i,l,c,d,h,f;this._p=new t,this.r=function(){var t=this._p;s=100/(t.f*t.f+.001),r=100/(t.g*t.g+.001),a=1-t.h*t.h*t.h*.01,i=-t.i*t.i*t.i*1e-6,t.a||(h=.5-t.n/2,f=5e-5*-t.o),l=1+t.l*t.l*(t.l>0?-.9:10),c=0,d=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.t=function(){this.r();var t=this._p;return e=t.b*t.b*1e5,o=t.c*t.c*1e5,n=t.e*t.e*1e5+12,3*((e+o+n)/3|0)},this.W=function(t,m){var u=this._p,b=1!=u.s||u.v,v=u.v*u.v*.1,p=1+3e-4*u.w,g=u.s*u.s*u.s*.1,k=1+1e-4*u.t,y=1!=u.s,x=u.x*u.x,w=u.g,I=u.q||u.r,N=u.r*u.r*u.r*.2,O=u.q*u.q*(u.q<0?-1020:1020),$=u.p?32+((1-u.p)*(1-u.p)*2e4|0):0,D=u.d,A=u.j/2,S=u.k*u.k*.01,L=u.a,E=e,B=1/e,M=1/o,R=1/n,T=5/(1+u.u*u.u*20)*(.01+g);T>.8&&(T=.8),T=1-T;for(var j,C,_,P,q,W,U=!1,J=0,z=0,Y=0,F=0,H=0,G=0,V=0,X=0,K=0,Q=0,Z=new Array(1024),tt=new Array(32),et=Z.length;et--;)Z[et]=0;for(et=tt.length;et--;)tt[et]=2*Math.random()-1;for(et=0;et<m;et++){if(U)return et;if($&&++K>=$&&(K=0,this.r()),d&&++c>=d&&(d=0,s*=l),(s*=a+=i)>r&&(s=r,w>0&&(U=!0)),C=s,A>0&&(Q+=S,C*=1+Math.sin(Q)*A),(C|=0)<8&&(C=8),L||((h+=f)<0?h=0:h>.5&&(h=.5)),++z>E)switch(z=0,++J){case 1:E=o;break;case 2:E=n}switch(J){case 0:Y=z*B;break;case 1:Y=1+2*(1-z*M)*D;break;case 2:Y=1-z*R;break;case 3:Y=0,U=!0}I&&((_=0|(O+=N))<0?_=-_:_>1023&&(_=1023)),b&&p&&((v*=p)<1e-5?v=1e-5:v>.1&&(v=.1)),W=0;for(var ot=8;ot--;){if(++V>=C&&(V%=C,3==L))for(var nt=tt.length;nt--;)tt[nt]=2*Math.random()-1;switch(L){case 0:q=V/C<h?.5:-.5;break;case 1:q=1-V/C*2;break;case 2:q=.225*(((q=1.27323954*(P=6.28318531*((P=V/C)>.5?P-1:P))+.405284735*P*P*(P<0?1:-1))<0?-1:1)*q*q-q)+q;break;case 3:q=tt[Math.abs(32*V/C|0)]}b&&(j=G,(g*=k)<0?g=0:g>.1&&(g=.1),y?(H+=(q-G)*g,H*=T):(G=q,H=0),F+=(G+=H)-j,q=F*=1-v),I&&(Z[X%1024]=q,q+=Z[(X-_+1024)%1024],X++),W+=q}W*=.125*Y*x,t[et]=W>=1?32767:W<=-1?-32768:32767*W|0}return m}};window.jsfxr=function(t){e._p.sS(t);var o=e.t(),n=new Uint8Array(4*((o+1)/2|0)+44),s=2*e.W(new Uint16Array(n.buffer,44),o),r=new Uint32Array(n.buffer,0,44);r[0]=1179011410,r[1]=s+36,r[2]=1163280727,r[3]=544501094,r[4]=16,r[5]=65537,r[6]=44100,r[7]=88200,r[8]=1048578,r[9]=1635017060,r[10]=s,s+=44;for(var a=0,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l="data:audio/wav;base64,";a<s;a+=3){var c=n[a]<<16|n[a+1]<<8|n[a+2];l+=i[c>>18]+i[c>>12&63]+i[c>>6&63]+i[63&c]}return l},function(){const t=(t,e,o,n={})=>{t.addEventListener(e,o,n)},e=(t,e)=>{t.innerHTML=e},o=document.querySelector.bind(document),n=document.querySelectorAll.bind(document),s=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=25,a=25,i=["üòÅ","üôÑ","üòù","üò¥","ü§´","üòÆ","ü§¨","ü•∫","üò≠","üò©","üò°","ü§ï"],l=[],c=guid(),d=[0,0],h="share"in navigator,f={btn:[2,.0853,.01,.3919,.478,.5858,,-.0461,-.0022,-.3519,.7718,.7069,.6211,-.9396,.0392,,-.7729,-.0683,.924,.0077,-.4924,.0162,-.1627,1],exp:[3,,.5008,.3815,.9492,.065,,.0249,.1806,,.7648,-.6633,,,.6718,,.1516,-.1139,.9911,-.2403,.4343,,-.1719,1],snk:[3,.0042,.2846,.0452,.9705,.846,,,-.5873,.1207,.6831,-.2024,.8887,.5369,-.0036,,-.0019,.1565,.1598,.0135,,.1834,-.4218,1],wat:[2,,.0762,7e-4,.4949,.5714,,-.0704,-.9289,,.3492,-.6533,.5622,,,.2871,.5904,-.0797,.9646,,-.0066,2e-4,-.0794,1],sad:[0,,.3972,.0475,.3859,.5226,,.0795,,.1297,.2918,.0228,.0057,.218,-.0016,,,-.0165,1,.0216,.0284,,,1],sno:[2,.0012,.0473,.1883,.9943,.9259,,,.0207,-1e-4,,-.963,.1687,,.3194,.07,-.0707,-.5072,.8623,-.2341,.4199,.0194,,1],won:[0,.566,.4164,.0784,.8831,.5906,,-.0074,-.379,,-.7858,-.6032,,.4907,-.5917,.5149,.6158,-.0026,.7473,-.0226,.0241,,-.4209,1]};let m,u,b,v,p,g,k=0,y=!0,x=[],w=!1,I=!1,N=!1,O=!1,$=0,D="",A=[],S=!0;const L=(t,e)=>{const o=B();let n=!1;const s={...o};t.forEach((t,r)=>{null!==o[t]&&(n=!0,s[t]=e[r])}),n&&E(s)},E=t=>{localStorage.setItem("bck-ship",JSON.stringify(t))},B=()=>{const t=localStorage.getItem("bck-ship")||"";return""!==t?JSON.parse(t):{}},M=(t,e,o,n)=>{const s=DIMENSION_BOARD-1,r=[n?t+(o-1):t,n?e:e+(o-1),0,0,!1];return r[0]<=s&&r[1]<=s&&(r[4]=!0,r[2]=[t-1,e-1],r[3]=[(n?r[0]:t)+1,(n?e:r[1])+1]),r},R=(t,e)=>{const o=DIMENSION_BOARD-1;let n=[];for(;;){let s=!1;const r=randomNumber(0,1),a=randomNumber(0,o),i=randomNumber(0,o),[l,c,d,h,f]=M(a,i,t,r);if(f){let t=!1;for(let n=d[0];n<=h[0];n++){for(let s=d[1];s<=h[1];s++)if(n>=0&&n<=o&&s>=0&&s<=o&&0!==e[n][s]){t=!0;break}if(t)break}t||(s=!0)}if(s){n=[randomNumber(r?3:1,r?4:2),a,i,l,c];break}}return n},T=(t=1)=>{const e=[...new Array(DIMENSION_BOARD)].map(()=>new Array(DIMENSION_BOARD).fill(0)),o=[];for(let n=1,s=4;n<=4;n++,s--)for(let r=1;r<=n;r++){const n=R(s,e);for(let t=n[1];t<=n[3];t++)for(let o=n[2];o<=n[4];o++)e[t][o]=1;o.push([t,s,...n])}return{board:e,figures:o}},j=()=>{rt[0][1].clearRect(0,0,350,350),_(rt[0][1]),P(l[0],rt[0][1])},C=(t,e)=>{e.clearRect(0,0,350,350),_(e),P(l[t],e),q(l[t],e)},_=t=>{t.lineWidth=1,t.strokeStyle="#b5e5ee";for(let e=0;e<DIMENSION_BOARD;e++)for(let o=0;o<DIMENSION_BOARD;o++)0===e&&(t.font="bold 15px Verdana, sans-serif",t.fillStyle="#339",t.fillText(String.fromCharCode(65+o),r+30*o+10,12),t.font="bold 13px Verdana, sans-serif",t.fillText(o+1,0,a+30*o+20)),t.rect(r+30*e,a+30*o,30,30);t.stroke()},P=(t,e)=>{const o=t[1];e.lineWidth=5;for(let t=0;t<o.length;t++){const[n,s,...i]=o[t],[l,c,d]=i;if(n){e.strokeStyle="#572ecc",e.beginPath();const t=[[[30*d,30*c+15],[30*d+15,30*c],[30*(d+1),30*c],[30*(d+s),30*c],[30*(d+s),30*(c+1)],[30*(d+1),30*(c+1)],[30*d+15,30*(c+1)]],[[30*d,30*c],[30*(d+(s-1)),30*c],[30*(d+(s-1))+15,30*c],[30*(d+s),30*c+15],[30*(d+(s-1))+15,30*(c+1)],[30*(d+(s-1)),30*(c+1)],[30*d,30*(c+1)]],[[30*d+15,30*c],[30*d,30*c+15],[30*d,30*(c+1)],[30*d,30*(c+s)],[30*(d+1),30*(c+s)],[30*(d+1),30*(c+1)],[30*(d+1),30*c+15]],[[30*d,30*c],[30*d,30*(c+(s-1))],[30*d,30*(c+(s-1))+15],[30*d+15,30*(c+s)],[30*(d+1),30*(c+(s-1))+15],[30*(d+1),30*(c+(s-1))],[30*(d+1),30*c]]];e.beginPath(),e.lineJoin="round";for(let o=0;o<t[l-1].length;o++)e[0===o?"moveTo":"lineTo"](r+t[l-1][o][0],a+t[l-1][o][1]);e.closePath(),e.stroke()}}},q=(t,e)=>{const o=t[0];e.lineWidth=5;for(let t=0;t<o.length;t++)for(let n=0;n<o[t].length;n++)2!==o[t][n]&&3!==o[t][n]||(e.strokeStyle=2===o[t][n]?"#f44336":"#9e9e9e",e.beginPath(),e.moveTo(r+30*n+5,a+30*t+5),e.lineTo(r+30*n+25,a+30*t+25),e.stroke(),e.beginPath(),e.moveTo(r+30*n+25,a+30*t+5),e.lineTo(r+30*n+5,a+30*t+25),e.stroke())},W=t=>{if(d[t]++,d[0]===DIMENSION_BOARD||d[1]===DIMENSION_BOARD){const t=d[0]===DIMENSION_BOARD;b&&clearInterval(b),p&&clearInterval(p),g&&clearInterval(g),I&&(ot("gO",{room:D}),nt()),O=!0,Q(f[t?"won":"sad"]),X({em:t?"üèÜ":"üíî",txt:t?"You won!!":"You lose!",catxt:"Home",shok:!1},()=>{Z(1)})}},U=(t,e,n=!0)=>{const s=l[t][0];o(`#pr${e}`).style.width="100%",b&&clearInterval(b);let r=0;b=setInterval(()=>{if(o(`#pr${e}`).style.width=100-10*r+"%",r>=10&&(clearInterval(b),z(s)&&n)){const[e,o]=Y(s);I&&tt(t,e,o),J(t,e,o)}r+=.1},100)},J=(t,e,n)=>{let s=!1;if(0===l[t][0][e][n]||1===l[t][0][e][n]){if(b&&clearInterval(b),y=!1,l[t][0][e][n]){"vibrate"in navigator&&navigator.vibrate(500),o("#a").classList.add("shake"),setTimeout(()=>{o("#a").classList.remove("shake")},500);const[r,a]=((t,e,o)=>{const[n,s]=l[o];let r=-1,a=!1;for(let o=0;o<s.length&&!((r=s[o][2]<=2?t===s[o][3]&&t===s[o][5]&&e>=s[o][4]&&e<=s[o][6]?o:-1:t>=s[o][3]&&t<=s[o][5]&&e===s[o][4]&&e===s[o][6]?o:-1)>=0);o++);if(r>=0){let o=0;for(let a=0;a<s[r][1];a++){const i=!(s[r][2]<=2),l=s[r][3]+(i?a:0),c=s[r][4]+(i?0:a);o+=+(t===l&&e===c||2===n[l][c])}a=o===s[r][1]}return[a,r]})(e,n,t);r?(((t,e,n)=>{const s=DIMENSION_BOARD-1;o(`#b${n}${e+1}`).classList.add("sc"),l[t][1][e][0]=1,Q(f.snk),W(t?0:1);const r=M(l[t][1][e][3],l[t][1][e][4],l[t][1][e][1],!(l[t][1][e][2]<=2));for(let e=r[2][0];e<=r[3][0];e++)for(let o=r[2][1];o<=r[3][1];o++)e>=0&&e<=s&&o>=0&&o<=s&&0===l[t][0][e][o]&&(l[t][0][e][o]=3)})(t,a,1===t?1:2),w&&(x=[])):(Q(f.exp),2===k&&w&&(s=!0))}else Q(f.wat),k=1===k?2:1,o("#s2").classList[2===k?"add":"remove"]("slide");l[t][0][e][n]=1===l[t][0][e][n]?2:3,O||(1===k?(y=!0,U(1,1)):w?p=setTimeout(()=>{s?((t,e)=>{0===x.length?x=[t,e]:(x[0]=t,x[1]=e)})(e,n):0!==x.length&&(x[3]?x[3].push(x[2]):x[3]=[x[2]],x[2]=void 0),F(0)},500):U(0,2,!1))}},z=t=>{let e=!1;for(let o=0;o<t.length;o++){for(let n=0;n<t[o].length;n++)if(0===t[o][n]||1===t[o][n]){e=!0;break}if(e)break}return e},Y=t=>{const e=[0,0];for(;e[0]=randomNumber(0,9),e[1]=randomNumber(0,9),0!==t[e[0]][e[1]]&&1!==t[e[0]][e[1]];);return e},F=t=>{g=setTimeout(()=>{const e=l[t][0];if(z(e)){if(!w||0===x.length){const[t,o]=Y(e);J(0,t,o)}if(w&&0!==x.length){let[t,o,n]=(t=>{const e=DIMENSION_BOARD-1;let o=0,n=0,s=!1,r=0;for(;!(r>=100);){const a=x[2]||[1,2,3,4].filter(t=>{if(x[3])for(let e=0;e<x[3].length;e++)if(t===x[3][e])return!1;return!0}),i=randomNumber(0,a.length-1),l=1===a[i]?-1:3===a[i]?1:0,c=2===a[i]?-1:4===a[i]?1:0;if(o=x[0]+c,n=x[1]+l,o>=0&&o<=e&&n>=0&&n<=e)if(2===t[o][n])x[0]=o,x[1]=n;else if(0===t[o][n]||1===t[o][n]){x[2]=[a[i]],s=!0;break}s||1===a.length&&(x[3]?x[3].push(a[i]):x[3]=[a[i]],x[2]=void 0),r++}return[o,n,s]})(e);n||(x=[],[t,o]=Y(e)),J(0,t,o)}}},1e3)},H=(t=1)=>{S=t,e(o("#so"),S?"üîä":"üîá")},G=()=>{C(1,rt[1][1]),C(0,rt[2][1]),m=requestAnimationFrame(G)},V=(t,n)=>{const s="left"===n?0:1,r=o(`#em-${n}`);A[s]&&clearInterval(A[s]),e(r,i[t]),r.classList.add("sh"),A[s]=setTimeout(()=>{r.classList.remove("sh")},2e3)},X=({em:n="",txt:s,cont:r="",oktxt:a="OK",catxt:i="CANCEL",shok:l=!0},c)=>{e(o(".mo"),`<div id='em'>${n}</div><div id='tm'><h1 class='st'>${s}</h1></div><div id='tt'>${r}</div><div class='mbtns'><button id='mok' class='ri'>${a}</button><button id='mca' class='ri'>${i}</button></div>`),["mca","mok"].forEach(e=>{t(o(`#${e}`),"click",t=>{Q(f.btn),K(!1),c&&c("mok"===t.target.id)})}),o("#mok").classList[l?"remove":"add"]("h"),K()},K=(t=!0)=>{t||e(o(".mo"),""),o(".ov").classList[t?"add":"remove"]("sh")},Q=e=>{if(S){const o=window.URL||window.webkitURL;try{const n=jsfxr(e),s=new Audio;t(s,"error",()=>{console.log("Error: "+s.error.code)},!1),s.src=n,s.play(),t(s,"ended",()=>{o.revokeObjectURL(n)},!1)}catch(t){console.log(t.message)}}},Z=(t=1)=>{(()=>{for(let t=1;t<=DIMENSION_BOARD;t++)o(`#b1${t}`).classList.remove("sc"),o(`#b2${t}`).classList.remove("sc");o("#f").classList.remove("sh-ani"),o("#bm").classList.remove("sh-ani");const t=B();l[0][0]=t.b,l[0][1]=t.f,d[0]=d[1]=0,O=!1,y=!0,o("#pr1").style.width=o("#pr2").style.width="100%",o("#pr1").style.display=o("#pr2").style.display="block",o("#sha").style.display=h?"block":"none",m&&cancelAnimationFrame(m),b&&clearInterval(b),p&&clearInterval(p),g&&clearInterval(g)})(),[...n(".srn")].map(e=>e.classList[e.id.includes(t)?"add":"remove"]("sh-ani")),1===t?(I=w=!1,$=0,D="",j()):(o("#f").classList.add("sh-ani"),requestAnimationFrame(G),w&&(o("#pr2").style.display="none"),I&&o("#bm").classList.add("sh-ani"),o("#s2").classList[2===k?"add":"remove"]("slide"),2===k?(y=!1,w?F(0):U(0,2,!1)):U(1,1))};t(o("#rand"),"click",()=>{Q(f.btn);const{board:t,figures:e}=T();l[0][0]=t,l[0][1]=e,L(["b","f"],[t,e]),j()}),t(o("#vs"),"click",()=>{Q(f.btn);const{board:t,figures:e}=T(0);l[1]=[t,e,0],o("#g2").textContent="Captain Bot",k=randomNumber(1,2),w=!0,Z(2)}),t(o("#bck"),"click",()=>{Q(f.btn),I?X({em:"‚ö†Ô∏è",txt:"Attention",cont:"Are you sure you want to exit?",catxt:"No",oktxt:"Yes"},t=>{t&&(nt(),Z(1))}):Z(1)}),h&&t(o("#sha"),"click",t=>{t.preventDefault(),Q(f.btn),navigator.share({title:"Back to the BatttleShip",text:"Play Back to the BatttleShip #js13k by Jorge Rubiano @ostjh",url:location.href}).then(()=>{X({em:"üëç",txt:"Thanks for sharing",shok:!1,catxt:"ok"})}).catch(t=>{X({em:"üëé",txt:"Error",cont:t,shok:!1,catxt:"ok"})})}),t(o("#so"),"click",t=>{t.preventDefault();const e=!S;L(["s"],[e]),H(e)}),t(o("#nm"),"click",()=>{const t=sanizateTags(prompt("Write your name (MAX 10)",o("#nm").textContent));if(t){const e=t.length>10?t.substring(0,10)+"...":t;L(["n"],[e]),o("#g1").textContent=o("#nm").textContent=l[0][2]=e}}),t(o("#chat"),"click",()=>{o("#ejs").classList[o("#ejs").classList.contains("sh")?"remove":"add"]("sh")}),t(o("#ol"),"click",()=>{navigator.onLine&&!N&&(Q(f.sno),v=setInterval(()=>{Q(f.sno)},2e3),X({em:"üì°",txt:"Looking for an opponent...",cont:"We are looking for your opponent, this may take a few seconds",shok:!1},t=>{clearInterval(v),t||nt()}),et())}),t(o("#dev"),"click",()=>{X({em:"üë®‚Äçüíª",txt:"Back to the BatttleShip",cont:"Game developed by Jorge Rubiano for the #js13k - @ostjh",oktxt:"Twitter",catxt:"Close"},t=>{t&&window.open("https://twitter.com/ostjh","_blank")})});const tt=(t,e,o)=>{0!==l[t][0][e][o]&&1!==l[t][0][e][o]||(b&&clearInterval(b),ot("sA",{actualPlayer:$,room:D,row:e,col:o,token:l[$-1][3],name:l[$-1][2]}))},et=()=>{u=io(),N=!0,u.on("connect",()=>{ot("nU",{player:l[0],tokenByBrowser:c})}),u.on("sG",t=>{v&&clearInterval(v),K(!1),$=t.p1.data[3]===l[0][3]?1:2;const e=t.p1.data[3]===l[0][3]?"p2":"p1";for(let o=0;o<t[e].data[1].length;o++)t[e].data[1][o][0]=0;l[1]=t[e].data,k=1===$?t.turn:1===t.turn?2:1,D=t.room,o("#g1").textContent=sanizateTags(l[0][2]),o("#g2").textContent=sanizateTags(l[1][2]),I=!0,Z(2)}),u.on("sP",t=>{clearInterval(v),Q(f.sad),t.browser===c&&(nt(),X({em:"ü§¶‚ÄçÔ∏è",txt:"Same player",cont:"Open another browser or private browsing",catxt:"ok",shok:!1},()=>{K(!1)}))}),u.on("gD",()=>{Q(f.sad),nt(),Z(1),X({em:"üò≠",txt:"Sorry",cont:"Your opponent has disconnected",shok:!1,catxt:"ok"})}),u.on("rA",t=>{t.actualPlayer!==$&&(b&&clearInterval(b),J(1===$?1===t.actualPlayer?1:0:1===t.actualPlayer?0:1,t.row,t.col))}),u.on("rE",t=>{t.token!==l[0][3]&&V(t.emoji,"right")})},ot=(t,e)=>{u.emit(t,e)},nt=()=>{N&&(N=!1,u.disconnect())};let st="";for(let t=1;t<=2;t++){st+="<div class='stage'><div class='bts'>";let e=1;for(let o=1,n=4;o<=4;o++,n--)for(let s=1;s<=o;s++)st+=`<div class='bt b${n}' id='b${t}${e}'></div>`,e++;st+=`</div><div class='brs'><canvas id='p${t}'></canvas></div><div class='gm'><h1 class='st' id='g${t}'></h1><div class='prg sc' id='pr${t}'></div></div></div>`}e(o("#s2"),st);const rt=["b","p1","p2"].map(t=>[o(`#${t}`),o(`#${t}`).getContext("2d")]);for(let t=0;t<rt.length;t++)rt[t][0].width=350,rt[t][0].height=350,rt[t][0].style.width="350px",rt[t][0].style.height="350px";((e,o,...n)=>{for(let s=0;s<n.length;s++)t(e,n[s],o,!1)})(rt[1][0],t=>{t.stopPropagation(),t.preventDefault();let e=t;"touchstart"===t.type&&(e=t.touches[0]||t.changedTouches[0]);const o=Math.floor(e.pageX)-(window.innerWidth-350)/2-2,n=Math.floor(e.pageY)-(window.innerHeight-350)/2-10;y&&!O&&((t,e)=>{let o=!1,n={};for(let s=0;s<DIMENSION_BOARD;s++){for(let i=0;i<DIMENSION_BOARD;i++){const l={x:{start:r+30*s,end:r+(30*s+30)},y:{start:a+30*i,end:a+(30*i+30)}},c={x:t>l.x.start&&t<l.x.end,y:e>l.y.start&&e<l.y.end};c.x&&c.y&&(n={c:i,i:s},o=!0)}if(o)break}o&&(I&&tt(1,n.c,n.i),J(1,n.c,n.i))})(o,n)},"mousedown","touchstart");const at=document.createElement("style");at.type="text/css";const it=[["5-100","2,0",5],["98,100","5-100",5],["95-5","98,100",-5],["0,2","100-5",-5]];let lt="";for(let t=0;t<it.length;t++){const e=it[t][0].includes("-")?0:1,o=it[t][e].split("-"),n=it[t][0===e?1:0].split(",");for(let s=0;s<20;s++){const r=n[s%2==0?0:1],a=+o[0]+s*it[t][2];if(!!(it[t][2]>0?a>+o[1]:a<+o[1]))break;""!==lt&&(lt+=","),lt+=0===e?`${a}% ${r}%`:`${r}% ${a}%`}}const ct="@keyframes shake {"+["1,1,0","-1,-2,-1","-3,0,1","3,2,0","1,-1,1","-1,2,-1","-3,1,0","3,1,-1","-1,-1,1","1,2,0","1,-2,-1"].map((t,e)=>{const o=t.split(",");return`${10*e}% {transform: translate(${o[0]}px, ${o[1]}px) rotate(${o[2]}deg);}`}).join("")+"}";e(at,`.s {${s?"-webkit-":""}clip-path: polygon(0% 0%,${lt})} ${ct}`),o("head").appendChild(at),e(o("#ejs"),i.map((t,e)=>`<button id='e-${e}'>${t}</button>`).join("")),i.forEach((e,n)=>{t(o(`#e-${n}`),"click",t=>{const e=+t.target.id.split("-")[1];o("#ejs").classList.remove("sh"),V(e,"left"),ot("sE",{room:D,emoji:e,token:l[0][3]})})});const dt=B();let ht=[];if(0!==Object.keys(dt).length)ht=[dt.b,dt.f,dt.n,dt.t,dt.s];else{const{board:t,figures:e}=T();ht=[t,e,`Captain: ${randomNumber(1,1e4)}`,guid(),1],E({b:ht[0],f:ht[1],n:ht[2],t:ht[3],s:ht[4]})}H(ht[4]),l[0]=ht,o("#g1").textContent=o("#nm").textContent=sanizateTags(ht[2]),t(document,"contextmenu",t=>t.preventDefault()),console.log("%c%s","color: black; font-size: 24px;","Developed by Jorge Rubiano https://twitter.com/ostjh"),Z(1)}()</script><script>"serviceWorker"in navigator&&(navigator.serviceWorker.register("/sw.js").then(function(){console.log("SW Registered")}),navigator.serviceWorker.ready.then(function(){console.log("SW Ready")}))</script>