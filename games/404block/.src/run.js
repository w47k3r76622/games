var GA=GA||{};GA.VERSION="0.0.1";GA.plugins=void 0;GA.custom=void 0;
GA.create=function(h,e,n,r,m){function u(){requestAnimationFrame(u,c.canvas);if(void 0===c._fps)y(),c.render(c.canvas,0);else{var a=Date.now(),b=a-c._startTime;1E3<b&&(b=c._frameDuration);c._startTime=a;for(c._lag+=b;c._lag>=c._frameDuration;)t(),y(),c._lag-=c._frameDuration;c.render(c.canvas,c._lag/c._frameDuration)}}function t(){function a(b){b._previousX=b.x;b._previousY=b.y;b.children&&0<b.children.length&&b.children.forEach(function(d){a(d)})}c.stage.children.forEach(function(b){a(b)})}function y(){if(0<
c.buttons.length){c.canvas.style.cursor="auto";for(var a=c.buttons.length-1;0<=a;a--){var b=c.buttons[a];b.update(c.pointer,c.canvas);"over"!==b.state&&"down"!==b.state||b.stage||(c.canvas.style.cursor="pointer")}}c.dragAndDrop&&c.pointer.updateDragAndDrop();c.state&&!c.paused&&c.state();if(0!==c.updateFunctions.length)for(a=0;a<c.updateFunctions.length;a++)(0,c.updateFunctions[a])()}function x(a){a.x=0;a.y=0;a.vx=0;a.vy=0;a.width=0;a.height=0;a.scaleX=1;a.scaleY=1;a.pivotX=.5;a.pivotY=.5;a.rotation=
0;a.visible=!0;a.parent=void 0;a.stage=!1;a.shadow=!1;a.shadowColor="rgba(100, 100, 100, 0.5)";a.shadowOffsetX=3;a.shadowOffsetY=3;a.shadowBlur=3;a.blendMode=void 0;a._alpha=1;a._draggable=void 0;a._layer=0;a._circular=!1;a._interactive=!1;a._previousX=void 0;a._previousY=void 0;a.children=[];a.addChild=function(b){b.parent&&b.parent.removeChild(b);b.parent=a;a.children.push(b)};a.removeChild=function(b){if(b.parent===a)a.children.splice(a.children.indexOf(b),1);else throw Error(b+"is not a child of "+
a);};a.swapChildren=function(b,d){var k=a.children.indexOf(b),q=a.children.indexOf(d);if(-1!==k&&-1!==q)b.childIndex=q,d.childIndex=k,a.children[k]=d,a.children[q]=b;else throw Error(child+" Both objects must be a child of the caller "+a);};a.add=function(b){var d=Array.prototype.slice.call(arguments);1<d.length?d.forEach(function(k){a.addChild(k)}):a.addChild(d[0])};a.remove=function(b){var d=Array.prototype.slice.call(arguments);1<d.length?d.forEach(function(k){a.removeChild(k)}):a.removeChild(d[0])};
a.setPosition=function(b,d){a.x=b;a.y=d};a.putCenter=function(b,d,k){b.x=a.x+a.halfWidth-b.halfWidth+(d||0);b.y=a.y+a.halfHeight-b.halfHeight+(k||0);a.compensateForParentPosition(a,b)};a.putTop=function(b,d,k){b.x=a.x+a.halfWidth-b.halfWidth+(d||0);b.y=a.y-b.height+(k||0);a.compensateForParentPosition(a,b)};a.putRight=function(b,d,k){b.x=a.x+a.width+(d||0);b.y=a.y+a.halfHeight-b.halfHeight+(k||0);a.compensateForParentPosition(a,b)};a.putBottom=function(b,d,k){b.x=a.x+a.halfWidth-b.halfWidth+(d||0);
b.y=a.y+a.height+(k||0);a.compensateForParentPosition(a,b)};a.putLeft=function(b,d,k){b.x=a.x-b.width+(d||0);b.y=a.y+a.halfHeight-b.halfHeight+(k||0);a.compensateForParentPosition(a,b)};a.compensateForParentPosition=function(b,d){if(0!==d.parent.gx||0!==d.parent.gy)d.x-=b.gx,d.y-=b.gy};Object.defineProperties(a,{gx:{get:function(){return this.parent?this.x+this.parent.gx:this.x},enumerable:!0,configurable:!0},gy:{get:function(){return this.parent?this.y+this.parent.gy:this.y},enumerable:!0,configurable:!0},
position:{get:function(){return{x:a.x,y:a.y}},enumerable:!0,configurable:!0},alpha:{get:function(){return a.parent._alpha*a._alpha},set:function(b){a._alpha=b},enumerable:!0,configurable:!0},halfWidth:{get:function(){return a.width/2},enumerable:!0,configurable:!0},halfHeight:{get:function(){return a.height/2},enumerable:!0,configurable:!0},centerX:{get:function(){return a.x+a.halfWidth},enumerable:!0,configurable:!0},centerY:{get:function(){return a.y+a.halfHeight},enumerable:!0,configurable:!0},
layer:{get:function(){return a._layer},set:function(b){a._layer=b;a.parent.children.sort(A)},enumerable:!0,configurable:!0},circular:{get:function(){return a._circular},set:function(b){!0===b&&!1===a._circular&&(B(a),a._circular=!0);!1===b&&!0===a._circular&&(delete a.diameter,delete a.radius,a._circular=!1)},enumerable:!0,configurable:!0},draggable:{get:function(){return a._draggable},set:function(b){!0===b&&(c.draggableSprites.push(a),a._draggable=!0,!1===c.dragAndDrop&&(c.dragAndDrop=!0));!1===
b&&c.draggableSprites.splice(c.draggableSprites.indexOf(a),1)},enumerable:!0,configurable:!0},interactive:{get:function(){return a._interactive},set:function(b){!0===b&&(v(a),a._interactive=!0);!1===b&&(c.buttons.splice(c.buttons.indexOf(a),1),a._interactive=!1)},enumerable:!0,configurable:!0},localBounds:{get:function(){return{x:0,y:0,width:a.width,height:a.height}},enumerable:!0,configurable:!0},globalBounds:{get:function(){return rectangle={x:a.gx,y:a.gy,width:a.gx+a.width,height:a.gy+a.height}},
enumerable:!0,configurable:!0},empty:{get:function(){return 0===a.children.length?!0:!1},enumerable:!0,configurable:!0}})}function B(a){Object.defineProperties(a,{diameter:{get:function(){return a.width},set:function(b){a.width=b;a.height=b},enumerable:!0,configurable:!0},radius:{get:function(){return a.width/2},set:function(b){a.width=2*b;a.height=2*b},enumerable:!0,configurable:!0}})}function v(a){a.press=a.press||void 0;a.release=a.release||void 0;a.over=a.over||void 0;a.out=a.out||void 0;a.tap=
a.tap||void 0;a.state="up";a.action="";a.pressed=!1;a.enabled=!0;a.hoverOver=!1;c.buttons.push(a);a.update=function(b,d){if(a.enabled){var k=c.pointer.hitTestSprite(a);b.isUp&&(a.state="up","button"===a.subtype&&a.show(0));k&&(a.state="over",a.frames&&3===a.frames.length&&"button"===a.subtype&&a.show(1),b.isDown&&(a.state="down","button"===a.subtype&&(3===a.frames.length?a.show(2):a.show(1))));"down"!==a.state||a.pressed||(a.press&&a.press(),a.pressed=!0,a.action="pressed");"over"===a.state&&(a.pressed&&
(a.release&&a.release(),a.pressed=!1,a.action="released",c.pointer.tapped&&a.tap&&a.tap()),a.hoverOver||(a.over&&a.over(),a.hoverOver=!0));"up"===a.state&&(a.pressed&&(a.release&&a.release(),a.pressed=!1,a.action="released"),a.hoverOver&&(a.out&&a.out(),a.hoverOver=!1))}}}function w(a){var b={};b.code=a;b.isDown=!1;b.isUp=!0;b.press=void 0;b.release=void 0;b.downHandler=function(d){d.keyCode===b.code&&(b.isUp&&b.press&&b.press(),b.isDown=!0,b.isUp=!1);d.preventDefault()};b.upHandler=function(d){d.keyCode===
b.code&&(b.isDown&&b.release&&b.release(),b.isDown=!1,b.isUp=!0);d.preventDefault()};window.addEventListener("keydown",b.downHandler.bind(b),!1);window.addEventListener("keyup",b.upHandler.bind(b),!1);return b}function A(a,b){return a.layer<b.layer?-1:1}var c={};c.canvas=document.createElement("canvas");c.canvas.setAttribute("width",1*h);c.canvas.setAttribute("height",1*e);c.canvas.style.backgroundColor="black";document.body.appendChild(c.canvas);c.canvas.ctx=c.canvas.getContext("2d");c.stage=function(){var a=
{};x(a);a.stage=!0;a.width=c.canvas.width;a.height=c.canvas.height;a.x=0;a.y=0;a.parent=void 0;return a}();c.pointer=function(){var a={_x:0,_y:0};Object.defineProperties(a,{x:{get:function(){return a._x/c.scale},enumerable:!0,configurable:!0},y:{get:function(){return a._y/c.scale},enumerable:!0,configurable:!0},centerX:{get:function(){return a.x},enumerable:!0,configurable:!0},centerY:{get:function(){return a.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:a.x,y:a.y}},enumerable:!0,
configurable:!0}});a.isDown=!1;a.isUp=!0;a.tapped=!1;a.downTime=0;a.elapsedTime=0;a.press=void 0;a.release=void 0;a.tap=void 0;a.dragSprite=null;a.dragOffsetX=0;a.dragOffsetY=0;a.moveHandler=function(b){a._x=b.pageX-b.target.offsetLeft;a._y=b.pageY-b.target.offsetTop;b.preventDefault()};a.touchmoveHandler=function(b){a._x=b.targetTouches[0].pageX-c.canvas.offsetLeft;a._y=b.targetTouches[0].pageY-c.canvas.offsetTop;b.preventDefault()};a.downHandler=function(b){a._x=b.pageX-b.target.offsetLeft;a._y=
b.pageY-b.target.offsetTop;a.isDown=!0;a.isUp=!1;a.tapped=!1;a.downTime=Date.now();a.press&&a.press();b.preventDefault()};a.touchstartHandler=function(b){a._x=b.targetTouches[0].pageX-c.canvas.offsetLeft;a._y=b.targetTouches[0].pageY-c.canvas.offsetTop;a.isDown=!0;a.isUp=!1;a.tapped=!1;a.downTime=Date.now();a.press&&a.press();b.preventDefault()};a.upHandler=function(b){a.elapsedTime=Math.abs(a.downTime-Date.now());200>=a.elapsedTime&&(a.tapped=!0,a.tap&&a.tap());a.isUp=!0;a.isDown=!1;a.release&&a.release();
b.preventDefault()};c.canvas.addEventListener("mousemove",a.moveHandler.bind(a),!1);c.canvas.addEventListener("mousedown",a.downHandler.bind(a),!1);window.addEventListener("mouseup",a.upHandler.bind(a),!1);c.canvas.addEventListener("touchmove",a.touchmoveHandler.bind(a),!1);c.canvas.addEventListener("touchstart",a.touchstartHandler.bind(a),!1);window.addEventListener("touchend",a.upHandler.bind(a),!1);c.canvas.style.touchAction="none";a.hitTestSprite=function(b){if(b.circular){var d=a.x-(b.gx+b.halfWidth),
k=a.y-(b.gy+b.halfHeight);b=Math.sqrt(d*d+k*k)<b.radius}else{d=b.gx+b.width;k=b.gy;var q=b.gy+b.height;b=a.x>b.gx&&a.x<d&&a.y>k&&a.y<q}return b};a.updateDragAndDrop=function(){if(a.isDown)if(null===a.dragSprite)for(var b=c.draggableSprites.length-1;-1<b;b--){var d=c.draggableSprites[b];if(d.draggable&&a.hitTestSprite(d)){a.dragOffsetX=a.x-d.gx;a.dragOffsetY=a.y-d.gy;a.dragSprite=d;b=d.parent.children;b.splice(b.indexOf(d),1);b.push(d);c.draggableSprites.splice(c.draggableSprites.indexOf(d),1);c.draggableSprites.push(d);
break}}else a.dragSprite.x=a.x-a.dragOffsetX,a.dragSprite.y=a.y-a.dragOffsetY;a.isUp&&(a.dragSprite=null);c.draggableSprites.some(function(k){if(k.draggable&&a.hitTestSprite(k))return c.canvas.style.cursor="pointer",!0;c.canvas.style.cursor="auto";return!1})};return a}();c.key=function(){var a={};a.leftArrow=w(37);a.upArrow=w(38);a.rightArrow=w(39);a.downArrow=w(40);a.space=w(32);return a}();c.buttons=[];c.dragAndDrop=!1;c.draggableSprites=[];c.tweens=[];c.state=void 0;c.load=m||void 0;c.setup=n||
void 0;if(void 0===c.setup)throw Error("Please supply the setup function in the constructor");c.assetFilePaths=r||void 0;c.paused=!1;c._fps=60;c._startTime=Date.now();c._frameDuration=1E3/c._fps;c._lag=0;c.interpolate=!0;c.updateFunctions=[];c.scale=1;c.start=function(){c.assetFilePaths?(c.assets.whenLoaded=function(){c.state=void 0;c.setup()},c.assets.load(c.assetFilePaths),c.load&&(c.state=c.load)):c.setup();u()};c.pause=function(){c.paused=!0};c.resume=function(){c.paused=!1};c.hidePointer=function(){c.canvas.style.cursor=
"none"};c.showPointer=function(){c.canvas.style.cursor="auto"};Object.defineProperties(c,{fps:{get:function(){return c._fps},set:function(a){c._fps=a;c._startTime=Date.now();c._frameDuration=1E3/c._fps},enumerable:!0,configurable:!0},backgroundColor:{set:function(a){c.canvas.style.backgroundColor=a},enumerable:!0,configurable:!0}});c.remove=function(a){var b=Array.prototype.slice.call(arguments);if(b[0]instanceof Array){if(b=b[0],0<b.length)for(var d=b.length-1;0<=d;d--){var k=b[d];k.parent.removeChild(k);
b.splice(b.indexOf(k),1)}}else 1<b.length?b.forEach(function(q){q.parent.removeChild(q)}):b[0].parent.removeChild(b[0])};c.group=function(a){var b={};x(b);b.addChild=function(d){d.parent&&d.parent.removeChild(d);d.parent=b;b.children.push(d);b.calculateSize()};b.removeChild=function(d){if(d.parent===b)b.children.splice(b.children.indexOf(d),1);else throw Error(d+"is not a child of "+b);b.calculateSize()};b.calculateSize=function(){0<b.children.length&&(b._newWidth=0,b._newHeight=0,b.children.forEach(function(d){d.x+
d.width>b._newWidth&&(b._newWidth=d.x+d.width);d.y+d.height>b._newHeight&&(b._newHeight=d.y+d.height)}),b.width=b._newWidth,b.height=b._newHeight)};c.stage.addChild(b);a&&Array.prototype.slice.call(arguments).forEach(function(d){b.addChild(d)});return b};c.rectangle=function(a,b,d,k,q,f,l){var p={};x(p);p.mask=!1;p.width=a||32;p.height=b||32;p.fillStyle=d||"red";p.strokeStyle=k||"none";p.lineWidth=q||0;p.x=f||0;p.y=l||0;c.stage.addChild(p);p.render=function(z){z.strokeStyle=p.strokeStyle;z.lineWidth=
p.lineWidth;z.fillStyle=p.fillStyle;z.beginPath();z.rect(-p.width*p.pivotX,-p.height*p.pivotY,p.width,p.height);!0===p.mask?z.clip():("none"!==p.strokeStyle&&z.stroke(),"none"!==p.fillStyle&&z.fill())};return p};c.circle=function(a,b,d,k,q,f){var l={};x(l);l.mask=!1;l.width=a||32;l.height=a||32;l.fillStyle=b||"red";l.strokeStyle=d||"none";l.lineWidth=k||"none";l.x=q||0;l.y=f||0;c.stage.addChild(l);B(l);l.render=function(p){p.strokeStyle=l.strokeStyle;p.lineWidth=l.lineWidth;p.fillStyle=l.fillStyle;
p.beginPath();p.arc(l.radius+-l.diameter*l.pivotX,l.radius+-l.diameter*l.pivotY,l.radius,0,2*Math.PI,!1);!0===l.mask?p.clip():("none"!==l.strokeStyle&&p.stroke(),"none"!==l.fillStyle&&p.fill())};return l};c.line=function(a,b,d,k,q,f){var l={};x(l);d||0===d||(d=0);k||0===k||(k=0);q||0===q||(q=32);f||0===f||(f=32);l.ax=d;l.ay=k;l.bx=q;l.by=f;l.strokeStyle=a||"red";l.lineWidth=b||1;l.lineJoin="round";c.stage.addChild(l);l.render=function(p){p.strokeStyle=l.strokeStyle;p.lineWidth=l.lineWidth;p.lineJoin=
l.lineJoin;p.beginPath();p.moveTo(l.ax,l.ay);p.lineTo(l.bx,l.by);"none"!==l.strokeStyle&&p.stroke();"none"!==l.fillStyle&&p.fill()};return l};c.text=function(a,b,d,k,q){var f={};x(f);f.content=a||"Hello!";f.font=b||"12px sans-serif";f.fillStyle=d||"red";f.textBaseline="top";Object.defineProperties(f,{width:{get:function(){return c.canvas.ctx.measureText(f.content).width},enumerable:!0,configurable:!0},height:{get:function(){return c.canvas.ctx.measureText("M").width},enumerable:!0,configurable:!0}});
c.stage.addChild(f);f.x=k||0;f.y=q||0;f.render=function(l){l.strokeStyle=f.strokeStyle;l.lineWidth=f.lineWidth;l.fillStyle=f.fillStyle;0===f.width&&(f.width=l.measureText(f.content).width);0===f.height&&(f.height=l.measureText("M").width);l.translate(-f.width*f.pivotX,-f.height*f.pivotY);l.font=f.font;l.textBaseline=f.textBaseline;l.fillText(f.content,0,0)};return f};c.frame=function(a,b,d,k,q){var f={};f.image=a;f.x=b;f.y=d;f.width=k;f.height=q;return f};c.frames=function(a,b,d,k){var q={};q.image=
a;q.data=b;q.width=d;q.height=k;return q};c.filmstrip=function(a,b,d,k){var q=c.assets[a].source,f=[],l=q.width/b;q=q.height/d*l;for(var p=0;p<q;p++){var z=p%l*b;var C=Math.floor(p/l)*d;k&&0<k&&(z+=k+k*p%l,C+=k+k*Math.floor(p/l));f.push([z,C])}return c.frames(a,f,b,d)};c.sprite=function(a){var b={};if(void 0===a)throw Error("Sprites require a source");x(b);b.frames=[];b.loop=!0;b._currentFrame=0;b.setTexture=function(d){if(d.image)if(d.image&&!d.data){if(!(c.assets[d.image].source instanceof Image))throw Error(d.image+
" is not an image file");b.source=c.assets[d.image].source;b.sourceX=d.x;b.sourceY=d.y;b.width=d.width;b.height=d.height;b.sourceWidth=d.width;b.sourceHeight=d.height}else d.image&&d.data&&(b.source=c.assets[d.image].source,b.frames=d.data,b.sourceX=b.frames[0][0],b.sourceY=b.frames[0][1],b.width=d.width,b.height=d.height,b.sourceWidth=d.width,b.sourceHeight=d.height);else d instanceof Array?(b.frames=d,b.source=c.assets[d[0]].source,b.sourceX=c.assets[d[0]].frame.x,b.sourceY=c.assets[d[0]].frame.y,
b.width=c.assets[d[0]].frame.w,b.height=c.assets[d[0]].frame.h,b.sourceWidth=c.assets[d[0]].frame.w,b.sourceHeight=c.assets[d[0]].frame.h):(b.tilesetFrame=c.assets[d],b.source=b.tilesetFrame.source,b.sourceX=b.tilesetFrame.frame.x,b.sourceY=b.tilesetFrame.frame.y,b.width=b.tilesetFrame.frame.w,b.height=b.tilesetFrame.frame.h,b.sourceWidth=b.tilesetFrame.frame.w,b.sourceHeight=b.tilesetFrame.frame.h)};b.setTexture(a);b.gotoAndStop=function(d){if(0<b.frames.length)b.frames[0]instanceof Array?(b.sourceX=
b.frames[d][0],b.sourceY=b.frames[d][1]):c.assets[b.frames[d]].frame&&(b.source=c.assets[b.frames[d]].source,b.sourceX=c.assets[b.frames[d]].frame.x,b.sourceY=c.assets[b.frames[d]].frame.y,b.sourceWidth=c.assets[b.frames[d]].frame.w,b.sourceHeight=c.assets[b.frames[d]].frame.h,b.width=c.assets[b.frames[d]].frame.w,b.height=c.assets[b.frames[d]].frame.h),b._currentFrame=d;else throw Error("Frame number "+d+"doesn't exist");};b.x=0;b.y=0;0<b.frames.length&&(c.addStatePlayer(b),Object.defineProperty(b,
"currentFrame",{get:function(){return b._currentFrame},enumerable:!1,configurable:!1}));c.stage.addChild(b);b.render=function(d){d.drawImage(b.source,b.sourceX,b.sourceY,b.sourceWidth,b.sourceHeight,-b.width*b.pivotX,-b.height*b.pivotY,b.width,b.height)};return b};c.button=function(a){a=c.sprite(a);a.subtype="button";v(a);return a};c.image=function(a){return c.assets[a]};c.json=function(a){return c.assets[a]};c.addStatePlayer=function(a){function b(D){k();l=D[0];p=D[1];f=p-l;0===l&&(f+=1,q+=1);1===
f&&(f=2,q+=1);a.fps||(a.fps=12);D=1E3/a.fps;a.gotoAndStop(l);C||(z=setInterval(d.bind(this),D),C=!0)}function d(){q<f?(a.gotoAndStop(a.currentFrame+1),q+=1):a.loop&&(a.gotoAndStop(l),q=1)}function k(){void 0!==z&&!0===C&&(C=!1,f=p=l=q=0,clearInterval(z))}var q=0,f=0,l=0,p=0,z=void 0,C=!1;a.show=function(D){k();"string"!==typeof D?a.gotoAndStop(D):a.gotoAndStop(a.frames.indexOf(D))};a.play=function(){b([0,a.frames.length-1])};a.stop=function(){k();a.gotoAndStop(a.currentFrame)};a.playing=C;a.playSequence=
b};c.render=function(a,b){function d(f){if(f.visible&&f.gx<a.width+f.width&&f.gx+f.width>=-f.width&&f.gy<a.height+f.height&&f.gy+f.height>=-f.height){k.save();c.interpolate?(f.renderX=void 0!==f._previousX?(f.x-f._previousX)*b+f._previousX:f.x,f.renderY=void 0!==f._previousY?(f.y-f._previousY)*b+f._previousY:f.y):(f.renderX=f.x,f.renderY=f.y);k.translate(f.renderX+f.width*f.pivotX,f.renderY+f.height*f.pivotY);k.globalAlpha=f.alpha;k.rotate(f.rotation);k.scale(f.scaleX,f.scaleY);f.shadow&&(k.shadowColor=
f.shadowColor,k.shadowOffsetX=f.shadowOffsetX,k.shadowOffsetY=f.shadowOffsetY,k.shadowBlur=f.shadowBlur);f.blendMode&&(k.globalCompositeOperation=f.blendMode);f.render&&f.render(k);if(f.children&&0<f.children.length){k.translate(-f.width*f.pivotX,-f.height*f.pivotY);for(var l=0;l<f.children.length;l++)d(f.children[l])}k.restore()}}var k=a.ctx;k.clearRect(0,0,a.width,a.height);for(var q=0;q<c.stage.children.length;q++)d(c.stage.children[q])};c.assets={toLoad:0,loaded:0,imageExtensions:["png","jpg",
"gif","webp"],fontExtensions:["ttf","otf","ttc","woff"],audioExtensions:["mp3","ogg","wav","webm"],jsonExtensions:["json"],whenLoaded:void 0,load:function(a){console.log("Loading assets...");var b=this;b.toLoad=a.length;a.forEach(function(d){var k=d.split(".").pop();if(-1!==b.imageExtensions.indexOf(k)){var q=new Image;q.addEventListener("load",function(){q.name=d;b[q.name]={source:q,frame:{x:0,y:0,w:q.width,h:q.height}};b.loadHandler()},!1);q.src=d}else if(-1!==b.fontExtensions.indexOf(k)){k=d.split("/").pop().split(".")[0];
var f=document.createElement("style");f.appendChild(document.createTextNode("@font-face {font-family: '"+k+"'; src: url('"+d+"');}"));document.head.appendChild(f);b.loadHandler()}else if(-1!==b.audioExtensions.indexOf(k))k=c.makeSound(d,b.loadHandler.bind(b)),k.name=d,b[k.name]=k;else if(-1!==b.jsonExtensions.indexOf(k)){var l=new XMLHttpRequest,p={};l.open("GET",d,!0);l.addEventListener("readystatechange",function(){200===l.status&&4===l.readyState&&(p=JSON.parse(l.responseText),p.name=d,b[p.name]=
p,p.frames?b.createTilesetFrames(p,d):b.loadHandler())});l.send()}else console.log("File type not recognized: "+d)})},createTilesetFrames:function(a,b){var d=this,k=b.replace(/[^\/]*$/,""),q=new Image;q.addEventListener("load",function(){d[k+a.meta.image]={source:q,frame:{x:0,y:0,w:q.width,h:q.height}};Object.keys(a.frames).forEach(function(f){d[f]=a.frames[f];d[f].source=q});d.loadHandler()},!1);q.src=k+a.meta.image},loadHandler:function(){this.loaded+=1;console.log(this.loaded);this.toLoad===this.loaded&&
(this.loaded=this.toLoad=0,this.whenLoaded())}};c.keyboard=w;c.makeDisplayObject=x;void 0!==GA.plugins&&GA.plugins(c);void 0!==GA.custom&&GA.custom(c);return c};window.ga=GA.create;
(function(h,e,n){function r(m){m&&!m.setTargetAtTime&&(m.setTargetAtTime=m.setTargetValueAtTime)}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||
(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var m=this.internal_createGain();r(m.gain);return m},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(m){m=m?this.internal_createDelay(m):this.internal_createDelay();r(m.delayTime);return m},AudioContext.prototype.internal_createBufferSource=
AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var m=this.internal_createBufferSource();m.start||(m.start=function(u,t,y){t||y?this.noteGrainOn(u,t,y):this.noteOn(u)});m.stop||(m.stop=m.noteOff);r(m.playbackRate);return m},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var m=this.internal_createDynamicsCompressor();r(m.threshold);r(m.knee);
r(m.ratio);r(m.reduction);r(m.attack);r(m.release);return m},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var m=this.internal_createBiquadFilter();r(m.frequency);r(m.detune);r(m.Q);r(m.gain);return m},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var m=
this.internal_createOscillator();m.start||(m.start=m.noteOn);m.stop||(m.stop=m.noteOff);r(m.frequency);r(m.detune);return m}))})(window);
(function(h){function e(x,B){var v=h.createEvent("Event");v.initEvent(x,!0,!1);B.dispatchEvent(v)}function n(x){h[t.enabled]=h[y.enabled];h[t.element]=h[y.element];e(t.events.change,x.target)}function r(x){e(t.events.error,x.target)}var m,u={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitIsFullScreen",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen",
exit:"webkitCancelFullScreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreen",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},t=u.w3;for(m in u)if(u[m].enabled in
h){var y=u[m];break}t.enabled in h||!y||(h.addEventListener(y.events.change,n,!1),h.addEventListener(y.events.error,r,!1),h[t.enabled]=h[y.enabled],h[t.element]=h[y.element],h[t.exit]=h[y.exit],Element.prototype[t.request]=function(){return this[y.request].apply(this,arguments)});return y})(document);GA=GA||{};
GA.plugins=function(h){h.move=function(e){if(!1===e instanceof Array)e.x+=e.vx|0,e.y+=e.vy|0;else for(var n=0;n<e.length;n++){var r=e[n];r.x+=r.vx|0;r.y+=r.vy|0}};h.angle=function(e,n){return Math.atan2(n.centerY-e.centerY,n.centerX-e.centerX)};h.wait=function(e,n){return setTimeout(n,e)};h.scaleToWindow=function(e){var n=Math.min(window.innerWidth/h.canvas.width,window.innerHeight/h.canvas.height);h.canvas.style.transformOrigin="0 0";h.canvas.style.transform="scale("+n+")";var r=h.canvas.width>h.canvas.height?
h.canvas.width*n<window.innerWidth?"horizontally":"vertically":h.canvas.height*n<window.innerHeight?"vertically":"horizontally";if("horizontally"===r){var m=(window.innerWidth-h.canvas.width*n)/2;h.canvas.style.marginLeft=m+"px";h.canvas.style.marginRight=m+"px"}"vertically"===r&&(m=(window.innerHeight-h.canvas.height*n)/2,h.canvas.style.marginTop=m+"px",h.canvas.style.marginBottom=m+"px");h.canvas.style.paddingLeft=0;h.canvas.style.paddingRight=0;h.canvas.style.paddingTop=0;h.canvas.style.paddingBottom=
0;h.canvas.style.display="block";document.body.style.backgroundColor=e||"#2C3539";h.pointer.scale=n;h.scale=n;h.canvas.scaled=!0;e=navigator.userAgent.toLowerCase();-1==e.indexOf("safari")||-1<e.indexOf("chrome")||(h.canvas.style.maxHeight="100%",h.canvas.style.minHeight="100%")};h.shoot=function(e,n,r,m,u,t){t=t();t.x=e.centerX-t.halfWidth+r*Math.cos(n);t.y=e.centerY-t.halfHeight+r*Math.sin(n);t.vx=Math.cos(n)*m;t.vy=Math.sin(n)*m;u.push(t);return t};h.contain=function(e,n,r,m){var u=n.x,t=n.y,y=
n.width;n=n.height;r=r||!1;if(e.x<u){r&&(e.vx*=-1);e.mass&&(e.vx/=e.mass);e.x=u;var x="left"}e.y<t&&(r&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=t,x="top");e.x+e.width>y&&(r&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=y-e.width,x="right");e.y+e.height>n&&(r&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=n-e.height,x="bottom");x&&m&&m(x);return x};h.hitTestRectangle=function(e,n,r){void 0===r&&(r=!1);if(r){var m=e.gx+e.halfWidth-(n.gx+n.halfWidth);var u=e.gy+e.halfHeight-(n.gy+n.halfHeight)}else m=e.centerX-n.centerX,
u=e.centerY-n.centerY;r=e.halfWidth+n.halfWidth;e=e.halfHeight+n.halfHeight;return Math.abs(m)<r?Math.abs(u)<e?!0:!1:!1};h.hit=function(e,n,r,m,u,t){function y(v,w){var A=void 0!==w.parent;if(void 0!==v.parent&&A){if(v.diameter&&w.diameter)return A=r?0!==v.vx+v.vy&&0!==w.vx+w.vy?h.movingCircleCollision(v,w,u):h.circleCollision(v,w,m,u):h.hitTestCircle(v,w,u),A;if(v.diameter&&!w.diameter)return A=r?h.circleRectangleCollision(v,w,m,u):h.hitTestCircleRectangle(v,w,u),A;A=r?m?h.rectangleCollision(v,w,
!0,u):h.rectangleCollision(v,w,!1,u):h.hitTestRectangle(v,w,u);return A}if(A&&void 0!==v.x&&void 0!==v.y)return h.hitTestPoint(v,w);throw Error("I'm sorry, "+v+" and "+w+" cannot be use together in a collision test.");}function x(){if(e instanceof Array){var v=e;n=e;e=v}for(v=n.length-1;0<=v;v--){var w=n[v];(B=y(e,w))&&t&&t(B,w)}}var B;r=r||!1;m=m||!1;u=u||!1;n instanceof Array||e instanceof Array?x():(B=y(e,n))&&t&&t(B);return B};h.fourKeyController=function(e,n,r,m,u,t){e.direction="";leftArrow=
h.keyboard(t);upArrow=h.keyboard(r);rightArrow=h.keyboard(m);downArrow=h.keyboard(u);leftArrow.press=function(){e.vx=-n;e.vy=0;e.direction="left"};leftArrow.release=function(){rightArrow.isDown||0!==e.vy||(e.vx=0)};upArrow.press=function(){e.vy=-n;e.vx=0;e.direction="up"};upArrow.release=function(){downArrow.isDown||0!==e.vx||(e.vy=0)};rightArrow.press=function(){e.vx=n;e.vy=0;e.direction="right"};rightArrow.release=function(){leftArrow.isDown||0!==e.vy||(e.vx=0)};downArrow.press=function(){e.vy=
n;e.vx=0;e.direction="down"};downArrow.release=function(){upArrow.isDown||0!==e.vx||(e.vy=0)}};h.fullscreenScale=1;h.scaleFullscreen=function(){document.fullscreenEnabled?(h.scale=h.fullscreenScale,h.pointer.scale=h.fullscreenScale):h.canvas.scaled||(h.scale=1,h.pointer.scale=1)};h.updateFunctions.push(h.scaleFullscreen)};var g=ga(1200,900,setup,["button.png","bullet.png"]);g.scaleToWindow();g.start();
var mainScene,dieMessage,dieScene,scores,waitScene,timer,timerStep,timerIntervalId,timerCount,timerStart,timerStop,player,enemyCounts,enemyArr,enemySpeed,enemyFreq=80,enemyTimer,outerBar,innerBar,healthBar,startButton,restartButton,bullet,outerBar1,innerBar1,ammoBar,ifReload=!1,randomNumber=function(h){parseInt(Math.random()*(h+1),10);return Math.floor(Math.random()*(h+1))};
function setup(){g.canvas.style.border="1px black dashed";g.backgroundColor="Grey";var h=g.frames("button.png",[[0,0],[0,96],[0,192]],192,96);startButton=g.button(h);waitScene=g.group(startButton);waitScene.addChild(startButton);g.stage.putCenter(startButton,0,0);mainScene=g.group();mainScene.visible=!1;timer=g.text("0 s","30px sans-serif","#ffffff",4,4);mainScene.addChild(timer);timerStep=0;timerIntervalId=null;timerCount=function(){timer.content=timerStep.toFixed(2)+" s";timerStep+=.1};timerStart=
function(){timerIntervalId||(timerCount(),timerIntervalId=setInterval(timerCount,100))};timerStop=function(){clearInterval(timerIntervalId);timerIntervalId=null};restartButton=g.button(h);g.stage.putCenter(restartButton,50,150);dieMessage=g.text("You Died!","64px Futura","black");g.stage.putCenter(dieMessage,0,0);scores=g.text("scores: "+timerStep.toFixed(2)+"s","40px Futura","black");g.stage.putCenter(scores,0,60);dieScene=g.group(dieMessage,scores,restartButton);dieScene.addChild(restartButton);
dieScene.visible=!1;player=g.rectangle(32,32,"red");g.stage.putCenter(player,0,0);mainScene.addChild(player);bullet=[];outerBar1=g.rectangle(200,20,"white");innerBar1=g.rectangle(200,20,"blue");ammoBar=g.group(outerBar1,innerBar1);ammoBar.inner=innerBar1;ammoBar.x=g.canvas.width/2;ammoBar.y=18;mainScene.addChild(ammoBar);g.key.upArrow.press=function(){0<ammoBar.inner.width&&!ifReload&&(g.shoot(player,4.71,16,20,bullet,function(){return g.sprite("bullet.png")}),ammoBar.inner.width-=15)};g.key.downArrow.press=
function(){0<ammoBar.inner.width&&!ifReload&&(g.shoot(player,-4.71,16,20,bullet,function(){return g.sprite("bullet.png")}),ammoBar.inner.width-=15)};g.key.leftArrow.press=function(){0<ammoBar.inner.width&&!ifReload&&(g.shoot(player,3.14,16,20,bullet,function(){return g.sprite("bullet.png")}),ammoBar.inner.width-=15)};g.key.rightArrow.press=function(){0<ammoBar.inner.width&&!ifReload&&(g.shoot(player,0,16,20,bullet,function(){return g.sprite("bullet.png")}),ammoBar.inner.width-=15)};g.key.space.press=
function(){ammoBar.inner.width=0;ifReload=!0};enemyCounts=5;enemyTimer=0;enemyArr=[];for(h=0;h<enemyCounts;h++){var e=g.text("404","50px sans-serif","#808A87",randomNumber(g.canvas.width-100),randomNumber(g.canvas.height-100));mainScene.addChild(e);enemyArr.push(e)}outerBar=g.rectangle(200,20,"black");innerBar=g.rectangle(200,20,"yellowGreen");healthBar=g.group(outerBar,innerBar);healthBar.inner=innerBar;healthBar.x=g.canvas.width-250;healthBar.y=18;mainScene.addChild(healthBar);g.fourKeyController(player,
12,87,68,83,65);g.state=wait}function wait(){startButton.press=function(){waitScene.visible=!1;mainScene.visible=!0;timerStart();g.state=play}}
function die(){g.pause();timerStop();scores.content="scores: "+timerStep.toFixed(2)+"s";mainScene.visible=!1;dieScene.visible=!0;restartButton.press=function(){timerStep=0;healthBar.inner.width=200;ammoBar.inner.width=200;g.remove(bullet);g.remove(enemyArr);g.state=play;mainScene.visible=!0;dieScene.visible=!1;for(var h=0;h<enemyCounts;h++){var e=g.text("404","50px sans-serif","#808A87",randomNumber(g.canvas.width-100),randomNumber(g.canvas.height-100));mainScene.addChild(e);enemyArr.push(e)}g.stage.putCenter(player,
0,0);timerStart();g.resume()}}function updateEnemySpeed(h){enemySpeed=randomNumber(10);var e=player.y>h.y?1:-1;h.vx=(player.x>h.x?1:-1)*enemySpeed;h.vy=e*enemySpeed}
function play(){g.move(player);g.move(bullet);g.contain(player,g.stage.localBounds);var h=!1;enemyArr.forEach(function(n){updateEnemySpeed(n);g.move(n);g.hitTestRectangle(player,n)&&(h=!0)});ifReload&&(200<=ammoBar.inner.width?ifReload=!1:ammoBar.inner.width+=2);h?(player.alpha=.5,healthBar.inner.width-=10):player.alpha=1;0>=healthBar.inner.width&&(g.state=die);enemyTimer++;if(enemyTimer===enemyFreq){enemyTimer=0;var e=g.text("404","50px sans-serif","#808A87",randomNumber(g.canvas.width-100),randomNumber(g.canvas.height-
100));mainScene.addChild(e);enemyArr.push(e)}enemyArr=enemyArr.filter(function(n){var r=!0;bullet=bullet.filter(function(m){return g.hitTestRectangle(n,m)?(g.remove(m),r=!1,n.fillStyle="white",g.wait(500,function(){g.remove(n)}),!1):!0});return r})};