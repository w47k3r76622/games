!function(t){var e={};function s(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(i,o,function(e){return t[e]}.bind(null,o));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=7)}([function(t,e){t.exports=class t{constructor(){this.assets={image:[],audio:[],data:[]}}static getExtension(t){return t.split(".").pop()}loadMultiple(t){const e=t.map(t=>this.load(t));return Promise.all(e)}load(){const e=2===arguments.length?arguments[1]:arguments[0],s=arguments[0],i=t.getExtension(e),o=t=>new Promise(e=>{e(t)});return i.match(/(jpeg|jpg|gif|png)$/)?this.assets.image[s]?o(this.assets.image[s]):this.loadImage.apply(this,arguments):i.match(/(wav|mp3|ogg|aac)$/)?this.assets.audio[s]?o(this.assets.audio[s]):this.loadAudio.apply(this,arguments):i.match(/(json)$/)?this.assets.data[s]?o(this.assets.data[s]):this.loadData.apply(this,arguments):i.match(/(level)$/)?this.assets.data[s]?o(this.assets.data[s]):this.loadLevel.apply(this,arguments):this.assets.data[s]?o(this.assets.data[s]):this.loadData.apply(this,arguments)}loadImage(){const t=2===arguments.length?arguments[1]:arguments[0],e=arguments[0],s=new Image;return s.src=t,new Promise((t,i)=>{s.onload=(()=>{this.assets.image[e]=s,t(s)}),s.onerror=(()=>{i(`Could not load image ${s.src}`)})})}loadAudio(){2===arguments.length?arguments[1]:arguments[0],arguments[0];return console.warn("Audio loader is not supported yet!"),new Promise((t,e)=>{this.assets.audio[assetname]=null})}loadData(){const t=2===arguments.length?arguments[1]:arguments[0],e=arguments[0];return fetch(t).then(t=>t.json()).then(t=>(this.assets.data[e]=t,t))}loadLevel(){const t=2===arguments.length?arguments[1]:arguments[0],e=arguments[0];return fetch(t).then(t=>t.text()).then(t=>(this.assets.data[e]=t,t))}}},function(t,e){t.exports=class t{constructor(t,e,s){this.x=t,this.y=e,this.z=s}add(e){if(!(e instanceof t))throw new Error("You should pass a Vector to add!");return new t(this.x+e.x,this.y+e.y,this.z+e.z)}subtract(e){if(!e instanceof t)throw new Error("You should pass a Vector to add!");return new t(this.x-e.x,this.y-e.y,this.z-e.z)}sub(t){return this.subtract(t)}scale(e){return new t(this.x*e,this.y*e,this.z*e)}clone(){return new t(this.x,this.y)}toString(){console.log(`${this.x} : ${this.y} : ${this.z}`)}}},function(t,e){t.exports=class{constructor(t){["image","x","y","width","height"].forEach(e=>{if(void 0===t[e])throw console.log(t[e]),new Error(`props[${e}] is missing!`)}),Object.assign(this,t),this.loop=null,this.tick=t.tick||0,this.frames=t.frames||1,this.speed=t.speed||200}play(){const t=()=>{this.tick<this.frames-1?this.tick+=1:this.tick=0,this.x=this.tick*this.width,this.loop=setTimeout(t,this.speed)};t()}pause(){clearTimeout(this.loop)}}},function(t,e,s){const i=s(1),o=s(4),n=s(2),{BodyType:r}=s(5);s(0);t.exports=class{constructor(t){if(this.position=new i(10,10),this.velocity=new i(0,0),this.acceleration=new i(0,0),this.mass=1,this.width=20,this.height=20,this.body=r.DYNAMIC,this.tick=0,this.animationIndex=0,this.sprite=null,this.collisions=[],Object.assign(this,t),!this.sprite instanceof n)throw new Error("Sprite must be an instance of Sprite class!");if(!this.scene)throw new Error("props.scene is undefined!");if(!this.scene instanceof o)throw new Error("props.scene is not a Scene object!");this.scene.add(this)}update(){this.body!==r.STATIC&&(this.position=this.position.add(this.velocity),this.velocity=this.velocity.add(this.acceleration)),this.collisions=this.calculateCollisions(),this.collisions.length>0&&this.onCollide(this.collisions)}removeForces(){this.acceleration=new i(0,0,0)}removeVelocity(){this.velocity=new i(0,0)}applyForce(t){if(!(t instanceof i))throw new Error("Force should be a Vector!");const e=t.scale(1/this.mass);this.acceleration=this.acceleration.add(e)}midX(){return this.position.x+this.width/2}midY(){return this.position.y+this.height/2}top(){return this.position.y}bottom(){return this.position.y+this.height}left(){return this.position.x}right(){return this.position.x+this.width}onCollide(){}calculateCollisions(){const t=[];for(let e=0;e<this.scene.actors.length;e++){const s=this.scene.actors[e],i=Math.abs(this.midX()-s.midX()),o=Math.abs(this.midY()-s.midY()),n=this.width/2+s.width/2,r=this.height/2+s.height/2;if(i<n&&o<r&&this!==s){r-o<n-i?(this.velocity.y>0?t.push({actor:s,direction:"top"}):this.velocity.y<0&&t.push({actor:s,direction:"bottom"}),this.position.y-=this.velocity.y):(this.velocity.x>0?t.push({actor:s,direction:"left"}):this.velocity.x<0&&t.push({actor:s,direction:"right"}),this.position.x-=this.velocity.x)}}return t}onKeydown(t,e){document.addEventListener("keydown",s=>{const i=s.code.toLowerCase();t===i?e.apply(this):"any"===t&&e.apply(this)})}onKeyup(t,e){document.addEventListener("keyup",s=>{const i=s.code.toLowerCase();t===i?e.apply(this):1===arguments.length&&arguments[0].apply(this)})}onKeypress(t,e){document.addEventListener("keypress",s=>{const i=s.code.toLowerCase();t===i&&e.apply(this)})}draw(){this.sprite&&this.scene.context.drawImage(this.sprite.image,this.sprite.x,this.sprite.y,this.sprite.width,this.sprite.height,this.position.x,this.position.y,this.width,this.height)}}},function(t,e,s){const i=s(0),{GRAVITY:o,BodyType:n}=s(5);t.exports=class{constructor(t={}){this.actors=[],this.canvas=document.getElementById(t.canvas)||t.canvas||document.createElement("canvas"),this.canvas.height=t.height||480,this.canvas.width=t.width||640,Object.assign(this,t),this.AssetManager=i,this.context=this.canvas.getContext("2d"),this.keys=[],document.addEventListener("keydown",t=>{const e=t.code.toLowerCase();this.keys[e]=!0}),document.addEventListener("keyup",t=>{const e=t.code.toLowerCase();this.keys[e]=!1})}add(t){this.actors.push(t)}draw(){for(let t=0;t<this.actors.length;t++){const e=this.actors[t];e.update(),e.draw()}}addToBody(){document.body.appendChild(this.canvas)}clear(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}}},function(t,e,s){const i=new(s(1))(0,.98);t.exports={BodyType:{DYNAMIC:"DYNAMIC",STATIC:"STATIC",KINEMATIC:"KINEMATIC"},GRAVITY:i}},function(t,e,s){const i=s(3),o=s(2),n=s(0),r=s(1),a="\nx000x00000\n0000000000\n000000x000\n0000000000\n000x00000x\n0000000000\n0000000x00\n0000000000\nxx000000x0\n0000000000\n000000x000\n";t.exports={floorPlan:a,init:t=>(new n).load("assets/desk.png").then(e=>{const s=[],n=a.split("\n");for(let t=0;t<n.length;t++){const e=n[t].split("");for(let i=0;i<e.length;i++)"x"===e[i]&&s.push({x:54*i,y:25*t})}s.forEach(s=>{new i({name:"desk",scene:t,width:54,height:25,position:new r(s.x,s.y),sprite:new o({image:e,x:0,y:0,width:54,height:25,frames:1})})})})}},function(t,e,s){const i=s(4),o=s(8),n=new i({width:580,height:300});n.addToBody(),n.canvas.classList.add("hide");const r=s(9),a=[];document.addEventListener("keydown",t=>{const e=t.code.toLowerCase();a[e]=!0}),document.addEventListener("keyup",t=>{const e=t.code.toLowerCase();a[e]=!1});const h=()=>{let t=0;let e=60;const i=()=>{document.querySelector("#score").innerHTML=`Score:${t} Remaining: ${e}`};i(),r.hide();setInterval(()=>{i(),e>1?e-=1:(e=0,r.show())},1e3);s(6).init(n),s(10).init(n);o.init(n).then(e=>{const s=e.update;e.update=function(){a.arrowright&&(e.sprite.y=25,e.velocity.x=4,e.sprite.speed=100,e.sprite.frames=4,e.right()>e.scene.canvas.width&&(e.velocity.x=0)),a.arrowleft&&(e.sprite.y=50,e.velocity.x=-4,e.sprite.speed=100,e.sprite.frames=4,e.left()<0&&(e.velocity.x=0)),a.arrowup&&(e.sprite.y=25,e.velocity.y=-4,e.sprite.speed=100,e.top()<0&&(e.velocity.y=0)),a.arrowdown&&(e.sprite.y=50,e.velocity.y=4,e.sprite.speed=100,e.bottom()>e.scene.canvas.height&&(e.velocity.y=0));const o=!a.arrowright&&!a.arrowleft,n=!a.arrowup&&!a.arrowdown;n&&(e.velocity.y=0),o&&(e.velocity.x=0),o&&n&&(e.sprite.y=0,e.sprite.speed=300),e.onCollide=(e=>{const s=e[0].actor;"phone"===s.name&&s.ringing&&(s.pickup(),t+=1,i())}),s.apply(this,[])},e.onCollide=(t=>{}),e.sprite.play()})},c=()=>{n.clear(),n.draw(),requestAnimationFrame(c)};c(),document.querySelector("#start-screen button").addEventListener("click",()=>{h()})},function(t,e,s){const i=s(3),o=s(2),n=s(0),r=s(1);t.exports={init:t=>(new n).load("assets/Officer.png").then(e=>{return new i({scene:t,width:40,height:40,position:new r(100,150),sprite:new o({image:e,x:0,y:0,width:25,height:25,frames:6,speed:200})})})}},function(t,e){const s=document.getElementById("start-screen"),i=document.querySelector("canvas"),o=document.getElementById("finish-screen");t.exports={show:()=>{o.classList.remove("hide"),i.classList.add("hide")},hide:()=>{s.classList.add("hide"),i.classList.remove("hide")}}},function(t,e,s){const i=s(3),o=s(1),n=s(2),r=s(0),{floorPlan:a}=s(6);t.exports={init:t=>(new r).load("assets/phone.png").then(e=>{const s=[],r=a.split("\n");for(let t=0;t<r.length;t++){const e=r[t].split("");for(let i=0;i<e.length;i++)"x"===e[i]&&s.push({x:54*i+20,y:25*t-25})}s.forEach(s=>{const r=new i({name:"phone",scene:t,width:40,height:40,position:new o(s.x,s.y),sprite:new n({image:e,x:0,y:0,width:32,height:32,frames:4})});r.onCollide(t=>{console.log("Collided"),console.log(t)}),r.pickup=(()=>{r.sprite.pause(),r.sprite.x=0,r.ringing=!1});const a=()=>{r.ringing=!0;const t=15*Math.random()*1e3;setTimeout(()=>{r.sprite.play(),setTimeout(()=>{r.pickup()},5e3),a()},t)};a()})})}}]);
//# sourceMappingURL=game.bundle.js.map