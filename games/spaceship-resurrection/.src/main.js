/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";class t{constructor(t,e){this.x=t,this.y=e}draw(t){}update(){}}const e=1280,s=720,i=50,h=["rgb(255,0,0)","rgb(245,158,66)","rgb(250,241,75)","rgb(84,84,84)"],r=50,a=new Path2D("M202.403,95.22c0,46.312-33.237,85.002-77.109,93.484v25.663l-69.76-40l69.76-40v23.494\nc27.176-7.87,47.109-32.964,47.109-62.642c0-35.962-29.258-65.22-65.22-65.22s-65.22,29.258-65.22,65.22\nc0,9.686,2.068,19.001,6.148,27.688l-27.154,12.754c-5.968-12.707-8.994-26.313-8.994-40.441C11.964,42.716,54.68,0,107.184,0\nS202.403,42.716,202.403,95.22z");class n extends t{constructor(t,e,s){super(),this.xOff=t,this.yOff=e,this.comp=s,this.collide=!0,this.w=48,this.h=48}draw(t){t.save(),t.lineWidth=1,t.translate(this.x+13,this.y+13),t.lineWidth=3,t.fillStyle="white",t.scale(.1,.1),t.fill(a),t.restore()}update(){this.x=this.comp.x+this.xOff,this.y=this.comp.y+this.yOff}}class o extends t{constructor(t,e){super(t,e),this.collide=!0,this.w=3,this.h=3}draw(t){t.save(),t.fillStyle="red",t.fillRect(this.x,this.y,this.w,this.h,10),t.restore()}update(t,e,s){if(this.dragged){if(!this.click)return this.dragged.onRelease&&this.dragged.onRelease(),void(this.dragged=void 0);s.sort(function(t,e){return t==this.dragged?1:e==this.dragged?-1:0}.bind(this)),this.dragged.x=this.x-this.dragged.w/2,this.dragged.y=this.y-this.dragged.h/2}}}class l extends t{constructor(t,e,s,i,h,r,a){super(),this.x=t,this.y=e,this.w=50,this.h=50,this.angle=s,this.collide=!0,this.mouse=i,this.grid=h,this.rot=new n(50,0,this),this.onRelease=function(){let t=this.grid.getClosestValidLocation(this.x,this.y);if(void 0===t)return;let e=t.split(","),s=parseInt(e[0]),i=parseInt(e[1]);this.grid.addComponent(this,s,i)},this.rotToggle=!0,this.key=r,this.keyboard=a}updateGrid(t){this.grid=t}draw(t){if(t.save(),t.fillStyle="Black",t.strokeStyle="white",t.lineWidth=3,t.save(),t.translate(this.x+this.w/2,this.y+this.h/2),t.rotate(k(this.angle)),t.strokeStyle=this.color,t.roundRect(-this.w/2,-this.h/2,this.w,this.h,5).fill(),t.roundRect(-this.w/2,-this.h/2,this.w,this.h,5).stroke(),t.translate(-this.w/2,-this.h/2),t.fillStyle="Gold",t.fill(this.getSprite()),t.restore(),t.fillStyle="white",t.font=E(16),this.grid.getKey(this)||(t.fillText(this.getName(),this.x,this.y-10),this.rot.draw(t),x(this.mouse,this.rot)&&this.mouse.click&&void 0===this.mouse.dragged?this.rotToggle&&(this.angle=(this.angle+90)%360,this.rotToggle=!1):this.rotToggle=!0),this.key){t.fillStyle="black",t.fillRect(this.x+18,this.y+15,15,17),t.fillStyle="white",t.font=E(15);let e=this.key;"Shift"===this.key?e=C("21E7"):"ArrowLeft"===this.key?e=C("2190"):"ArrowRight"===this.key?e=C("2192"):"ArrowUp"===this.key?e=C("2191"):"ArrowDown"===this.key&&(e=C("2193"));let s=t.measureText(e).width/2;t.fillText(e,this.x+this.w/2-s,this.y+this.h/1.7)}t.restore()}update(t,e){if(g(o,t)&&this.mouse.click&&!this.mouse.dragged){this.mouse.dragged=this;let t=this.grid.getKey(this);t&&delete this.grid.components[t]}this.rot.update()}getThrust(){return 0}}class d extends l{constructor(t,e,s,i,h,r,a){super(t,e,s,i,h,r,a)}getName(){return"Cargo Container"}getSprite(){return new Path2D("m 0 0 v20h20v10h-20v20h20v-20h10v20h20v-20h-20v-10h20v-20h-20v20h-10v-20h-20")}getAttachments(){return[1,1,1,1]}draw(t){super.draw(t)}update(t,e){super.update(t,e)}}class c extends t{constructor(t){super(),this.x=Number.MIN_SAFE_INTEGER/2,this.y=639,this.w=Number.MAX_SAFE_INTEGER,this.h=Number.MAX_SAFE_INTEGER,this.level=t,this.collide=!0}draw(t){t.fillStyle=this.level.pc,t.fillRect(this.x,this.y,this.w,this.h)}update(){}}const u=100;class p extends t{constructor(t,e,s,h,r,a){super(),this.parts=[],this.keyboard=h,this.yAdj=0,this.xAdj=0,this.collide=!0,this.freeze=!1,this.keyboardFreeze=!0,this.onCrash=a,this.level=r;for(let t of Object.keys(s.components)){let e=s.components[t],h=t.split(","),r=parseInt(h[0]),a=parseInt(h[1]);e.x=r*i,e.y=a*i,this.parts.push(e)}this.mass=this.parts.length*u;let n=this.parts.reduce((function(t,e){return t.x<e.x?t:e})).x,o=this.parts.reduce((function(t,e){return t.x>e.x?t:e})).x,l=this.parts.reduce((function(t,e){return t.y<e.y?t:e})).y,d=this.parts.reduce((function(t,e){return t.y>e.y?t:e})).y;this.w=o-n+i,this.h=d-l+i;for(let t of this.parts)t.x=t.x-n,t.y=t.y-l;this.COM=this._getCenterOfMass(this.parts),this.I=this._getMomentOfInertia(this.parts,this.COM),this.x=t,this.y=e,this.theta=0,this.vx=0,this.vy=0,this.vTheta=0}_getCenterOfMass(t){let e=0,s=0;for(let i of t)e+=i.x+i.w/2,s+=i.y+i.h/2;return{x:e/t.length,y:s/t.length}}_getMomentOfInertia(t,e){let s=e.x,h=e.y,r=0;for(let e of t){let t=e.x+e.w/2,a=e.y+e.h/2,n=Math.sqrt(Math.pow(t-s,2)+Math.pow(a-h,2));if(n<i){r+=50*Math.pow(i,2)+u*Math.pow(n,2)}else r+=u*n*n}return r}_toShipCoord(t,e){}_toSceneCoord(t,e){let s=t-1*this.COM.x,i=e-1*this.COM.y,h=S(s,i);i>0&&(h=-h);let r=-M(Math.atan(s/i));return{x:this.x+this.COM.x+h*Math.sin(k(this.theta+r)),y:this.y+this.COM.y-h*Math.cos(k(this.theta+r))}}getSceneCoordsOfParts(){let t={};for(let e of this.parts)for(let s=0;s<4;s++){let h=0,r=0;0===s||(1===s?h=i:2===s?(h=i,r=i):3===s&&(r=i));let a=this._toSceneCoord(e.x+h,e.y+r);t[a.x+"|"+a.y]=a}let e=[];for(let s in t)e.push(t[s]);return e}getCargoCount(){let t=0;for(let e of this.parts)e instanceof d&&t++;return t}draw(t){t.save(),t.translate(this.x+this.COM.x,this.y+this.COM.y),t.rotate(k(this.theta)),t.translate(-this.COM.x,-this.COM.y);for(let e of this.parts)e.draw(t);t.fillStyle="white",t.strokeStyle="green",t.beginPath(),t.arc(this.COM.x,this.COM.y,2,0,2*Math.PI),t.stroke(),t.fill(),t.restore()}update(t,e){for(let s of this.parts)s.update(t,e);if(this.keyboardFreeze&&this.keyboard.length()>0&&(this.keyboardFreeze=!1),this.timeout)return!0;if(this.freeze||this.keyboardFreeze)return;if(g(c,t))return this.onCrash(this,e,"crash",this.chron),!0;for(let t of this.parts){let e=t.getThrust(),s=e*Math.sin(k(t.angle+this.theta))/this.mass,i=-e*Math.cos(k(t.angle+this.theta))/this.mass,h=this.COM.x-(t.x+t.w/2),r=this.COM.y-(t.y+t.h/2),a=h*e*Math.cos(k(t.angle)),n=r*e*Math.sin(k(t.angle));this.vTheta+=M(a+n)/this.I,this.vx+=s,this.vy+=i}this.vy+=.01*this.level.pg,this.vx=.999*this.vx*this.level.pa,this.vy=.999*this.vy*this.level.pa,this.x+=this.vx,this.y+=this.vy,this.theta+=this.vTheta;let s=999999,h=999999,r=-999999,a=-999999;for(let t of this.parts)for(let e=0;e<4;e++){let n=0,o=0;0===e||(1===e?n=i:2===e?(n=i,o=i):3===e&&(o=i));let l=this._toSceneCoord(t.x+n,t.y+o);l.x>r&&(r=l.x),l.x<s&&(s=l.x),l.y>a&&(a=l.y),l.y<h&&(h=l.y)}this.w=r-s,this.h=a-h,this.yAdj=h-this.y,this.xAdj=s-this.x}}class f extends t{constructor(t,e,s,i,h,r,a,n,o,l,d,c,u){super(t,e),this.text=h,this.buttonColor=r,this.originalButtonColor=r,this.textColor=a,this.originalTextColor=a,this.w=s,this.h=i,this.collide=!0,this.onClick=d,this.mouse=l,this.font=n,this.yOffset=o,this.centered=c,this.buffer=void 0===u?20:u}draw(t){t.save(),t.fillStyle=this.buttonColor,t.strokeStyle=this.textColor,t.font=this.font;let e=0;this.centered&&(e=t.measureText(this.text).width/2,this.xAdj=-e),t.roundRect(this.x-e,this.y,this.w+5,this.h,10).fill(),t.roundRect(this.x-e,this.y,this.w+5,this.h,10).stroke(),t.fillStyle=this.textColor,t.fillText(this.text,this.x+this.buffer-e,this.y+this.yOffset),t.restore()}update(t){let e=!1;if(g(o,t)&&(this.buttonColor=this.originalTextColor,this.textColor=this.originalButtonColor,e=!0,this.mouse.click))return this.mouse.click=!1,this.onClick(),!0;e||(this.buttonColor=this.originalButtonColor,this.textColor=this.originalTextColor)}}function y(t,e){if(t<=0)return e[0];if(t>=1)return e[e.length-1];let s,i,h,r=[];for(let t of e)r.push(t.substring(4,t.length-1).replace(/ /g,"").split(","));let a=1/(e.length-1);for(let n=1;n<e.length;n++)if(t<=n*a){s=r[n-1],i=r[n],h=n-1;break}let n=(t-h*a)/a;return`rgb(${parseInt(s[0])+(parseInt(i[0])-parseInt(s[0]))*n},${parseInt(s[1])+(parseInt(i[1])-parseInt(s[1]))*n},${parseInt(s[2])+(parseInt(i[2])-parseInt(s[2]))*n})`}function w(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function x(t,e){if(!t.collide||!e.collide)return!1;let s=t.x+(t.xAdj?t.xAdj:0),i=t.y+(t.yAdj?t.yAdj:0),h=e.x+(e.xAdj?e.xAdj:0),r=e.y+(e.yAdj?e.yAdj:0);return s<h+e.w&&s+t.w>h&&i<r+e.h&&t.h+i>r}function g(t,e){for(let s of e)if(s instanceof t)return!0;return!1}function m(){let t="",e="abcdefghijklmnopqrstuvwxyz0123456789",s=e.length;for(let i=0;i<1;i++)t+=e.charAt(Math.floor(Math.random()*s));return t}function v(t,e,s){return`m 0 ${t} l ${t/2-e/2} ${-e} l ${s} ${s} l ${-s} ${e-s} h ${e} l ${-s} ${-(e-s)} l ${s} ${-s} l ${t/2-e/2} ${e} v ${-t} h ${-t} v ${t}`}function k(t){return t*(Math.PI/180)}function M(t){return t*(180/Math.PI)}function S(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))}function b(t,e,s){let i=s.x,h=s.y,r=s.x+s.w,a=s.y+s.h;return!((Math.abs(i-t)*s.h+Math.abs(h-e)*s.w+Math.abs(a-e)*s.w+Math.abs(r-t)*s.h)/2>s.w*s.h+.001)}function z(t,e){return Math.random()*(e-t)+t}function C(t){return String.fromCharCode(parseInt(t,16))}function T(t){"t"!=localStorage.getItem("MT")&&zzfx(...t)}function I(t,e){T([t,.3,444,,.29,.23,2,3.6,,,,,.15,1,-15,e,,.3])}let R,O,A;function P(){clearInterval(R),R=void 0}function $(){clearInterval(O),O=void 0}function D(){if("t"==localStorage.getItem("MO"))return;let t=zzfxM([[,0,400,,.06,.13,,.21,.5,,,.05,.19,,.7,,.16,,.03,.38]],[[[,,5,5,10,5,12,,10,5,,10,10,5,12,12,10,8,3,3,8,3,10,,8,3,,3,8,3,10,10,8,6]]],[0],50,{title:"",instruments:["I"],patterns:["P"]});A=zzfxP(...t),A.loop=!0}function L(){A&&A.stop()}function j(t){A&&(A.playbackRate.value=t)}function E(t){return`${t}px Helvetica`}class V extends l{constructor(t,e,s,i,h,r,a){super(t,e,s,i,h,r,a)}getName(){return"Command Module"}getSprite(){return new Path2D("m 0 50h50v-50h-50v50")}getAttachments(){return[1,1,1,1]}draw(t){super.draw(t)}update(t,e){}}class F extends t{constructor(t,e,s,i,h,r,a,n){super(t,e),this.speed=n||15,this.angle=s,this.length=i,this.size=h,this.initialColor=r,this.color=r[0],this.counter=0,this.spread=a}draw(t){t.save(),t.fillStyle=this.color,t.beginPath(),t.arc(this.x,this.y,this.size,0,2*Math.PI),t.fill(),t.restore()}update(){if(this.x-=this.speed*Math.sin(-this.angle/360*2*Math.PI)+w(-this.spread,this.spread),this.y-=this.speed*Math.cos(-this.angle/360*2*Math.PI)+w(-this.spread,this.spread),this.size=Math.max(this.size+w(0,3),0),this.color=y(this.counter/this.length,this.initialColor),this.counter++,this.counter>this.length)return!0}}class N extends t{constructor(t,e,s,i,h,r,a,n,o,l){super(t,e),this.angle=s,this.length=r,this.size=a,this.color=n,this.particles=[],this.count=i,this.frequency=h,this.speed=0,this.spread=o,this.velocity=l}draw(t){for(let e of this.particles)e.draw(t)}update(){let t=[];this.x+=this.speed,this.y+=this.speed;for(let e of this.particles)e.update()&&t.push(e);if(this.particles=this.particles.filter((function(e){return t.indexOf(e)<0})),Math.random()<this.frequency)for(let t=0;t<this.count;t++)this.particles.push(new F(this.x,this.y,this.angle,this.length,this.size,this.color,this.spread,this.velocity))}}const _=[V,class extends l{constructor(t,e,s,i,r,a,n){super(t,e,s,i,r,a,n),this.particles=new N(this.x,this.y,0,4,5,2,1,h,5)}getName(){return"Small Thruster"}getSprite(){return new Path2D(v(50,10,1))}getAttachments(){return[1,1,0,1]}draw(t){this.keyboard.has(this.key)&&this.particles.draw(t),super.draw(t)}update(t,e){super.update(t,e),this.particles.x=this.x+this.w/2,this.particles.y=this.y+this.h/2,this.particles.angle=this.angle+180,this.particles.update(t,e),this.keyboard.has(this.key)&&I(.3,.8)}getThrust(){return this.keyboard.has(this.key)?5:0}},class extends l{constructor(t,e,s,i,r,a,n){super(t,e,s,i,r,a,n),this.particles=new N(this.x,this.y,0,4,5,5,1,h,7)}getName(){return"Medium Thruster"}getSprite(){return new Path2D(v(50,16,3))}getAttachments(){return[1,1,0,1]}draw(t){this.keyboard.has(this.key)&&this.particles.draw(t),super.draw(t)}update(t,e){super.update(t,e),this.particles.x=this.x+this.w/2,this.particles.y=this.y+this.h/2,this.particles.angle=this.angle+180,this.particles.update(t,e),this.keyboard.has(this.key)&&I(.9,.6)}getThrust(){return this.keyboard.has(this.key)?10:0}},class extends l{constructor(t,e,s,i,r,a,n){super(t,e,s,i,r,a,n),this.particles=new N(this.x,this.y,0,4,5,15,1,h,5)}getName(){return"Large Thruster"}getSprite(){return new Path2D(v(50,30,5))}getAttachments(){return[1,1,0,1]}draw(t){this.keyboard.has(this.key)&&this.particles.draw(t),super.draw(t)}update(t,e){super.update(t,e),this.particles.x=this.x+this.w/2,this.particles.y=this.y+this.h/2,this.particles.angle=this.angle+180,this.particles.update(t,e),this.keyboard.has(this.key)&&I(1,1)}getThrust(){return this.keyboard.has(this.key)?50:0}},d];function q(t,e,s,i,h,r,a,n){return new(0,_[a])(t,e,s,i,h,r,n)}function G(t){return _[t]}class H extends t{constructor(t,e,s,i){super(),this.counter=t,this.onCounter=i,this.diff=e,this.keyboard=s,this.executed=!1}update(t,e){if(e>=this.counter+this.diff||e>this.counter+10&&this.keyboard&&this.keyboard.keys.size>0)return this.onCounter(),!0}}class B extends t{constructor(t,e,s){super(t,e),this.num=11,this.mouse=s,this.components={}}getClosestValidLocation(t,e){let s,h=this.getValidLocations(),r=999999;for(let a of h){let h=a.split(","),n=parseInt(h[0]),o=parseInt(h[1]),l=Math.sqrt(Math.pow(t-(this.x+n*i),2)+Math.pow(e-(this.y+o*i),2));l<r&&l<100&&(r=l,s=a)}return s}getValidLocations(){if(0===Object.keys(this.components).length){let t=[];for(let e=0;e<this.num;e++)for(let s=0;s<this.num;s++)t.push(`${e},${s}`);return t}let t=[Object.keys(this.components)[0]],e=new Set,s=[];for(;t.length>0;){let i=t.shift().split(","),h=parseInt(i[0]),r=parseInt(i[1]),a=[[h-1,r].join(","),[h+1,r].join(","),[h,r-1].join(","),[h,r+1].join(",")];for(let i of a)e.has(i)||(this.components[i]?(t.push(i),e.add(i)):s.push(i))}return s}addComponent(t,e,s){t.x=this.x+i*e,t.y=this.y+i*s;let h=`${e},${s}`;this.components[h]=t}getKey(t){for(let e=0;e<Object.keys(this.components).length;e++)if(this.components[Object.keys(this.components)[e]]===t)return Object.keys(this.components)[e]}draw(t){if(t.save(),t.strokeStyle="white",this.mouse.dragged){let e=this.getValidLocations(),s=this.getClosestValidLocation(this.mouse.dragged.x,this.mouse.dragged.y);for(let h of e){let e=h.split(","),r=parseInt(e[0]),a=parseInt(e[1]);t.strokeStyle=h===s?"red":"grey",t.lineWidth=3;const n=6;t.roundRect(this.x+i*r+n/2,this.y+i*a+n/2,i-n,i-n,5).stroke()}}t.restore()}update(t,e){}}class U extends t{constructor(t,e,s,i,h,r){super(t,e),this.w=s,this.h=i,this.color=h,this.fill=r}draw(t){t.save();let e=t.roundRect(this.x,this.y,this.w,this.h,10);this.fill?(t.fillStyle=this.color,e.fill()):(t.strokeStyle=this.color,e.stroke()),t.restore()}}const X=new Path2D("M73,188l-37,5c-2,0-5-0-7-3L14,167c-0-1-1-2-1-4\n  c-0-0-0-0-0-0v-48c0-4,3-7,7-7s7,3,7,7v19L58,81l15,25\n    V188z M196,107c-4,0-7,3-7,7v19l-29-53l-15,25v80l37,5\n    c2,0,5-0,7-3l13-22c0-1,1-2,1-4c0-0,0-0,0-0\n    v-48C204,111,201,107,196,107z M129,188l-12,9v12c0,4-3,7-7,7\n    c-4,0-7-3-7-7v-12l-12-9v-83c0-1-0-2-1-3l-20-35l35-62\n    C103,1,106,0,109,0c2,0,5,1,6,3l35,62l-20,35\n    c-0,1-1,2-1,3V188z M129,68c3-2,3-7,1-10\n    c-0-1-8-10-21-10c-12,0-20,9-21,10c-2,3-2,7,0,10\n    c1,1,3,1,5,1c2,0,4-0,5-2c1-1,5-5,10-5\n    c5,0,9,4,9,4C121,70,126,71,129,68z");class W extends t{constructor(t,e,s){super(),this.x=t,this.y=e,this.angle=s,this.xShake=0,this.yShake=0,this.speed=0}draw(t){t.save(),t.translate(640,360),t.rotate(k(this.angle)),t.translate(this.x+this.xShake,this.y+this.yShake),t.lineWidth=3,t.fillStyle="gold",t.strokeStyle="white",t.fill(X),t.restore()}update(){this.xShake=w(-2,2),this.yShake=w(-2,2),this.y+=this.speed}}class K extends t{constructor(t,e,s){super(t,e),this.length=s}draw(t){t.save(),t.lineWidth=3,t.strokeStyle="white",t.beginPath(),t.moveTo(this.x,this.y),t.lineTo(this.x+this.length,this.y+this.length),t.stroke(),t.restore()}update(){this.x-=15,this.y-=15,this.x<0&&(this.x=e),this.y<0&&(this.y=s)}}class Y extends t{constructor(t,e,s,i,h,r){super(),this.x=t,this.y=e,this.value=s,this.font=i,this.centered=h,this.color=r}draw(t){t.save(),t.fillStyle=this.color?this.color:"white",t.font=this.font;let e=0;this.centered&&(e=t.measureText(this.value).width/2),t.fillText(this.value,this.x-e,this.y),t.restore()}}class J extends t{constructor(t){super();const e=999999;this.x=-999999,this.y=-640,this.w=Number.MAX_SAFE_INTEGER,this.h=e,this.line=t}draw(t){t.fillStyle="black",t.scale(1,-1),t.fillRect(this.x,this.y,this.w,this.h);var e=t.createLinearGradient(this.x,this.y,this.x,this.y-this.line);e.addColorStop(0,"rgb(135,206,235)"),e.addColorStop(1,"rgb(0,0,0)"),t.fillStyle=e,t.fillRect(this.x,this.y,this.w,-this.line)}update(){}}const Q=[{front:"red",back:"darkred"},{front:"green",back:"darkgreen"},{front:"blue",back:"darkblue"},{front:"yellow",back:"darkyellow"},{front:"orange",back:"darkorange"},{front:"pink",back:"darkpink"},{front:"purple",back:"darkpurple"},{front:"turquoise",back:"darkturquoise"}];class Z extends t{constructor(){super(),this.confetti=[];for(let t=0;t<300;t++)this.confetti.push({color:Q[Math.floor(z(0,Q.length))],dimensions:{x:z(10,20),y:z(10,30)},position:{x:z(0,canvas.width),y:canvas.height-1},rotation:z(0,2*Math.PI),scale:{x:1,y:1},velocity:{x:z(-25,25),y:z(0,-50)}})}draw(t){this.confetti.forEach(((e,s)=>{let i=e.dimensions.x*e.scale.x,h=e.dimensions.y*e.scale.y;t.translate(e.position.x,e.position.y),t.rotate(e.rotation),e.velocity.x-=.075*e.velocity.x,e.velocity.y=Math.min(e.velocity.y+.5,5),e.velocity.x+=Math.random()>.5?Math.random():-Math.random(),e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.position.y>=canvas.height&&(e.position.y=-720*z(1,5)),e.position.x>canvas.width&&(e.position.x=0),e.position.x<0&&(e.position.x=canvas.width),e.scale.y=Math.cos(.1*e.position.y),t.fillStyle=e.scale.y>0?e.color.front:e.color.back,t.fillRect(-i/2,-h/2,i,h),t.setTransform(1,0,0,1,0,0)}))}update(){}}const tt=new Path2D("M502,7h-153c-5,0-8,3-8,8v25H305C301,17,280-1,255-1\n  c-25,0-46,18-50,42h-34v-25c0-5-3-8-8-8H7C2,7-1,10-1,16\n  v68c0,5,3,8,8,8h153c5,0,8-3,8-8v-25h34\n  c3,21,20,38,41,41v10c-14,3-25,17-25,33v8\n  c-18,1-33,17-33,36v57h-17v-25c0-5-3-8-8-8H7\n  c-5,0-8,3-8,8v68c0,5,3,8,8,8h153c5,0,8-3,8-8v-25h17\n  v57c0,19,14,34,33,36v8c0,15,10,29,25,33v10\n  c-21,3-38,20-41,41h-34v-25c0-5-3-8-8-8H7\n  c-5,0-8,3-8,8v68c0,5,3,8,8,8h153c5,0,8-3,8-8v-25h34\n  C208,492,229,511,255,511c25,0,46-18,50-42h34v25c0,5,3,8,8,8h153\n  c5,0,8-3,8-8v-68c0-5-3-8-8-8h-153c-5,0-8,3-8,8v25H305\n  c-3-21-20-38-41-41v-10c14-3,25-17,25-33v-8\n  c19-1,34-17,34-37v-56h17v25c0,5,3,8,8,8h153\n  c5,0,8-3,8-8v-68c0-5-3-8-8-8h-153c-5,0-8,3-8,8v25h-17\n  v-57c0-19-14-35-34-36v-8c0-15-10-29-25-33V100\n  c21-3,38-20,41-41h34v25c0,5,3,8,8,8h153c5,0,8-3,8-8\n  V16C511,10,507,7,502,7z,459c0,18-15,34-34,34c-18,0-34-15-34-34\n  c0-18,15-34,34-34C273,425,289,441,289,459z M272,365\n  c0,9-7,17-17,17s-17-7-17-17V357h34V365z M305,189v130\n  c0,11-8,19-19,19h-62c-11,0-19-8-19-19v-130\n  c0-11,8-19,19-19h5h51h5C296,169,305,178,305,189z M272,144v8\n  h-34v-8c0-9,7-17,17-17S272,134,272,144z M255,84\n  c-18,0-34-15-34-34S236,16,255,16c18,0,34,15,34,34\n  S273,84,255,84z M357,58h34V75H357V58z M459,75V58h34V75H459z");class et extends t{constructor(t,e,s){super(t.sx,t.sy),this.sm=t.sm,this.dockTime=t.st,this.sh=126,this.sw=126,this.w=this.sh,this.h=this.sw,this.ship=e,this.collide=!0,this.docking=!1,this.textColor="white",this.dockingText="Docking...",this.initVictory=!0,this.onVictory=s}stopBeep(){clearInterval(this.beep)}draw(t){let e=20;t.fillStyle="rgba(0, 0, 200, 0.5)",t.strokeStyle="rgba(0, 0, 139, 0.5)",t.roundRect(this.x+this.sw/2-this.ship.w/2-this.sm/2,this.y+this.sh+e-this.sm/2,this.ship.w+this.sm,this.ship.h+this.sm,10).fill(),t.roundRect(this.x+this.sw/2-this.ship.w/2-this.sm/2,this.y+this.sh+e-this.sm/2,this.ship.w+this.sm,this.ship.h+this.sm,10).stroke(),t.roundRect(this.x+this.sw/2-this.ship.w/2,this.y+this.sh+e,this.ship.w,this.ship.h,10).fill(),t.roundRect(this.x+this.sw/2-this.ship.w/2,this.y+this.sh+e,this.ship.w,this.ship.h,10).stroke();let s="Docking Area";t.fillStyle=this.textColor,t.font=E(15);let i=t.measureText(s).width/2;if(t.fillText(s,this.x-i+this.sw/2,this.y+this.sh+e+this.ship.h/2),t.save(),t.translate(this.x,this.y),t.scale(.25,.25),t.fillStyle="white",t.fill(tt),t.restore(),this.docking){t.fillStyle=this.textColor,t.font=E(15);let s=t.measureText(this.dockingText).width/2,i=this.x+this.sw/2,h=this.y+this.sh+e+this.ship.h+this.sm/2+20;t.fillText(this.dockingText,i-s,h);const r=40;t.moveTo(i,h+r),t.beginPath(),t.arc(i,h+r,30,-Math.PI/2,(this.dockingTime-this.dockingStart)/this.dockTime*(2*Math.PI)-Math.PI/2,!1),t.lineTo(i,h+r),t.fill(),t.closePath()}}update(t,e,s){if(this.w=this.sw+20+1*this.sm+this.ship.w,this.h=this.sh+20+1*this.sm+this.ship.h,g(p,t)){let t=20;const s={x:this.x+this.sw/2-this.ship.w/2-this.sm/2,y:this.y+this.sh+t-this.sm/2,w:this.ship.w+this.sm,h:this.ship.h+this.sm};let i=0,h=this.ship.getSceneCoordsOfParts();const r=h.length;for(let t of h)b(t.x,t.y,s)&&i++;i===r?!0===this.docking?(this.dockingTime-this.dockingStart>=this.dockTime&&this.initVictory&&(P(),L(),this.initVictory=!1,this.textColor="mediumturquoise",this.ship.freeze=!0,this.dockingText="Docking COMPLETE!",T([1.03,,221,.09,.24,.22,,.91,,,-2,.19,.11,,,.2,,.88,.17,.26]),this.onVictory(e)),this.dockingTime=e):(this.docking=!0,this.dockingStart=e,void 0===R&&(R=setInterval((()=>{T([1.27,0,440,.01,.01,.01,,2.58,,.3,,.05,.04,,.1,-.1,,.6,.01])}),200))):(P(),this.docking=!1)}else P()}}class st extends t{constructor(t,e,s,i){var h,r,a;super(t,e),this.ship=s,this.ground=i,this.times=(h=50,r=0,a=[],{get:function(t){return a[t]},push:function(t){a[r]=t,r=(h+r+1)%h},avg:function(){let t=0,e=0;for(let s=0;s<a.length;s++)t+=void 0===a[s]?0:a[s],e+=void 0===a[s]?0:1;return t/e}})}draw(t){if(void 0===this.lastUpdateTime)return void(this.lastUpdateTime=new Date);t.fillStyle="white",t.font=E(23);let e=Math.sqrt(Math.pow(this.ship.vx,2)+Math.pow(this.ship.vy,2)),s=(new Date-this.lastUpdateTime)/1e3;this.times.push(s),t.fillText(`Velocity: ${(e/this.times.avg()/r).toFixed(2)} m/s`,this.x+30,this.y-30),this.lastUpdateTime=new Date,t.fillText(`Altitude: ${(-(this.ship.y+this.ship.COM.y-this.ground.y)/r).toFixed(2)} m`,this.x+30,this.y-60)}update(t,e){}}class it extends t{constructor(t,e,s){super(),this.ship=t,this.station=e,this.mouse=s}draw(t){let e=this.ship.x+this.ship.COM.x,s=this.ship.y+this.ship.COM.y,i=this.station.x+this.station.sw/2,h=this.station.y+this.station.sh/2,a=e-i,n=s-h,o=S(a,n),l=620/a,d=340/n;if(Math.abs(l)<1||Math.abs(d)<1){let c=Math.atan(640/360),u=90-c,p=360*Math.sin(c),f=2*p*Math.cos(u),y=2*p*Math.sin(u),w=[{x:e-640+f,y:s+y},{x:e+640-f,y:s+y},{x:e+640,y:s},{x:e+640-f,y:s-y},{x:e-640+f,y:s-y},{x:e-640,y:s}],x=0,g=Number.MAX_SAFE_INTEGER,m=[];for(let t in w){let e=w[t],s=S(e.x-i,e.y-h);m.push(s.toFixed(2)),s<g&&(x=t,g=s)}let v=`${(o/r).toFixed(2)}m         `,M=t.measureText(v).width/2,b=0,z=0,C=0,T=0,I=0;0==x||1==x?(b=640+d*a,z=715,T=-5,I=-25):2==x?(b=1275,z=360+l*n,C=270,T=-5,I=-25):3==x||4==x?(b=640-d*a,z=5,T=20,I=40):5==x&&(b=5,z=360-l*n,C=90,T=-5,I=-25),t.fillStyle="green",t.strokeStyle="green",t.beginPath(),t.arc(b-1,z-1,2,0,2*Math.PI),t.stroke(),t.fill(),t.translate(b,z),t.rotate(k(C)),t.fillStyle="white",t.font=E(20);let R="Space Station",O=t.measureText(R).width/2;t.fillText(R,-O,I),t.fillText(v,-M,T)}}update(t,e){}}class ht extends t{constructor(t){super(),this.startCounter=t,this.progress=0}draw(t){t.save(),t.fillStyle="rgba(0,0,0,.93)",t.strokeStyle="white",t.lineWidth=4,t.roundRect(100-2560*(1-this.progress),100,1080,520,10).fill(),t.roundRect(100-2560*(1-this.progress),100,1080,520,10).stroke(),t.restore()}update(t,e){this.progress=Math.min((e-this.startCounter)/120,1)}}const rt=new Path2D("M587 139h-16a8 8 0 0 0-8 8h33a8 8 0 0 0-8-8zm-42 25v93h67v-93zm-138 205l74-74-23-23-74 74a8 8 0 0 1-12 0l-75-75-23 23 75 75a8 8 0 0 1 0 12l-75 75 23 23 75-75a8 8 0 0 1 12 0l74 74 23-23-74-74c-3-3-3-8 0-12zm54-117l1 1h.1v.1l29 29 4 4 30-30v-71zm-238-66v71l30 30 35-35v-.1h.1l.5-.5zm-42-46h-16c-4.6.01-8 3-8 8h33a8 8 0 0 0-8-8zm-42 25v93h67v-93zm16 109v202h33v-202zm0 329c.01 4 3 8 8 8h16a8 8 0 0 0 8-8zm-16-109v93h67.6v-93zm150.3 4h-.1v-.1l-35-35-30 30v71l66-66zm208-35l-4 4-29 29l-1 1 66 66v-71zm64 140a8 8 0 0 0 8 8h16a8 8 0 0 0 8-8zm-16-109v93h67v-93zm16-219v202h33v-202z");class at extends t{constructor(t,e){super(t,e),this.h=i,this.w=i}draw(t){t.save(),t.translate(this.x,this.y),t.translate(-16,-11),t.scale(.11,.098),t.fillStyle="white",t.fill(rt),t.restore()}}class nt extends t{constructor(t,e,s,i,h,r){super(t,e),this.hud=s,this.lockedTime=void 0,this.level=i,this.onExpire=r,this.ship=h}draw(t){t.font=E(23);let e=new Date,s=Math.abs(e-this.hud.startTime)/1e3,i=void 0!==this.lockedTime?(this.level.t-this.lockedTime).toFixed(1):(this.level.t-s).toFixed(1);t.fillStyle=i<10?"red":"white",i<10&&void 0===this.lockedTime?(this.hud.s=10-Math.floor(i),function(){if(void 0===O){let t=[,0,261.6256,,.58,.07,3,1.52,,,,,,.1,,,,.26,.09];T(t),O=setInterval((()=>{T(t)}),1e3)}}()):this.hud.s=0,void 0===this.lockedTime&&j(1+s/this.level.t*1),t.fillText(`Remaining Time: ${i}s`,this.x+30,this.y-30)}freeze(t){if($(),void 0===t){let t=new Date,e=Math.abs(t-this.hud.startTime)/1e3;this.lockedTime=e}else this.lockedTime=this.level.t}update(t,e){let s=new Date,i=Math.abs(s-this.hud.startTime)/1e3;this.level.t-i<=0&&void 0===this.lockedTime&&(this.ship.timeout=!0,this.onExpire(this.ship,e,"timeout",this)),void 0!==this.lockedTime&&(this.hud.s=0,j(1),L())}}class ot extends t{constructor(t,e,s){super(t,e),this.level=s}draw(t){t.fillStyle="white",t.font=E(23),t.fillText(`Planet: ${this.level.pn}`,this.x,this.y)}update(t,e){}}window.zzfxP=(...t)=>{let e=zzfxX.createBufferSource(),s=zzfxX.createBuffer(t.length,t[0].length,zzfxR);return t.map(((t,e)=>s.getChannelData(e).set(t))),e.buffer=s,e.connect(zzfxX.destination),e.start(),e},window.zzfxG=(t=1,e=.05,s=220,i=0,h=0,r=.1,a=0,n=1,o=0,l=0,d=0,c=0,u=0,p=0,f=0,y=0,w=0,x=1,g=0,m=0)=>{let v,k,M=2*Math.PI,S=o*=500*M/zzfxR**2,b=(0<f?1:-1)*M/4,z=s*=(1+2*e*Math.random()-e)*M/zzfxR,C=[],T=0,I=0,R=0,O=1,A=0,P=0,$=0;for(i=99+zzfxR*i,g*=zzfxR,h*=zzfxR,r*=zzfxR,w*=zzfxR,l*=500*M/zzfxR**3,f*=M/zzfxR,d*=M/zzfxR,c*=zzfxR,u=zzfxR*u|0,k=i+g+h+r+w|0;R<k;C[R++]=$)++P%(100*y|0)||($=a?1<a?2<a?3<a?Math.sin((T%M)**3):Math.max(Math.min(Math.tan(T),1),-1):1-(2*T/M%2+2)%2:1-4*Math.abs(Math.round(T/M)-T/M):Math.sin(T),$=(u?1-m+m*Math.sin(2*Math.PI*R/u):1)*(0<$?1:-1)*Math.abs($)**n*t*zzfxV*(R<i?R/i:R<i+g?1-(R-i)/g*(1-x):R<i+g+h?x:R<k-w?(k-R-w)/r*x:0),$=w?$/2+(w>R?0:(R<k-w?1:(k-R)/w)*C[R-w|0]/2):$),v=(s+=o+=l)*Math.sin(I*f-b),T+=v-v*p*(1-1e9*(Math.sin(R)+1)%2),I+=v-v*p*(1-1e9*(Math.sin(R)**2+1)%2),O&&++O>c&&(s+=d,z+=d,O=0),!u||++A%u||(s=z,o=S,O=O||1);return C},window.zzfxV=.3,window.zzfxR=44100,window.zzfxX=new(window.AudioContext||webkitAudioContext),window.zzfx=(...t)=>zzfxP(zzfxG(...t)),window.zzfxM=(t,e,s,i=125)=>{let h,r,a,n,o,l,d,c,u,p,f,y,w,x,g,m=0,v=[],k=[],M=[],S=0,b=0,z=1,C={},T=zzfxR/i*60>>2;for(;z;S++)v=[z=c=f=w=0],s.map(((i,f)=>{for(d=e[i][S]||[0,0,0],z|=!!e[i][S],g=w+(e[i][0].length-2-!c)*T,x=f==s.length-1,r=2,n=w;r<d.length+x;c=++r){for(o=d[r],u=r==d.length+x-1&&x||p!=(d[0]||0)|o|0,a=0;a<T&&c;a++>T-99&&u?y+=(y<1)/99:0)l=(1-y)*v[m++]/2||0,k[n]=(k[n]||0)-l*b+l,M[n]=(M[n++]||0)+l*b+l;o&&(y=o%1,b=d[1]||0,(o|=0)&&(v=C[[p=d[m=0]||0,o]]=C[[p,o]]||(h=[...t[p]],h[2]*=2**((o-12)/12),o>0?zzfxG(...h):[])))}w=g}));return[k,M]};const lt=[{n:0,pn:"Recta",pc:"green",pg:1,pa:1,parts:[{id:1,a:"a"}],cparts:[{id:2,a:"s"}],sx:600,sy:-1500,sm:100,st:100,t:45,atmh:-2e3},{n:1,pn:"Vi",pg:1,pa:1,pc:"red",parts:[{id:2,a:"h"},{id:2,a:"j"},{id:2,a:"k"},{id:2,a:"l"},{id:4},{id:4},{id:4}],cparts:[{id:2,a:"ArrowLeft"},{id:2,a:"ArrowRight"},{id:2,a:"ArrowUp"},{id:2,a:"ArrowDown"},{id:4}],sx:-500,sy:-1500,sm:75,st:200,t:45,atmh:-2e3},{n:2,pn:"Stickious Kezious",pg:2,pa:1,pc:"darkgreen",parts:[{id:3,a:"Shift"},{id:2,a:"g"},{id:4}],cparts:[{id:4}],sx:1500,sy:-2e3,sm:300,st:100,t:25,atmh:-2e3},{n:3,pn:"Libra",pg:1,pa:1,pc:"grey",parts:[{id:2,a:"s"},{id:2,a:"S"},{id:4},{id:4},{id:4}],cparts:[{id:2,a:"s"},{id:2,a:"S"}],sx:300,sy:-600,sm:300,st:300,t:30,atmh:-2e3},{n:4,pn:"Gemini",pg:.1,pa:1,pc:"royalblue",parts:[{id:1,a:"a"},{id:3,a:"b"},{id:2,a:"b"},{id:2,a:"a"},{id:4}],cparts:[{id:3,a:"b"},{id:1,a:"a"},{id:4}],sx:1500,sy:-2e3,sm:300,st:100,t:25,atmh:-2e3},{n:5,pn:"Sumo",pg:30,pa:1,pc:"yellowgreen",parts:[{id:3,a:"q"},{id:3,a:"p"},{id:3,a:"n"},{id:3,a:"m"},{id:3,a:"q"},{id:3,a:"ArrowUp"},{id:4},{id:4},{id:4},{id:4},{id:4}],cparts:[{id:3,a:"m"},{id:3,a:"q"},{id:4},{id:4},{id:4}],sx:3e3,sy:-2e3,sm:300,st:100,t:45,atmh:-2e3},{n:6,pn:"Idelia",pg:3,pa:1,pc:"olive",parts:[{id:3,a:"ArrowUp"},{id:3,a:"ArrowDown"},{id:3,a:"ArrowLeft"},{id:3,a:"ArrowRight"},{id:2,a:"w"},{id:2,a:"s"},{id:2,a:"a"},{id:2,a:"d"},{id:4},{id:4},{id:4},{id:4},{id:4},{id:4},{id:4},{id:4},{id:4},{id:4},{id:4},{id:4}],cparts:[{id:1,a:"h"},{id:1,a:"j"},{id:1,a:"k"},{id:1,a:"l"},{id:4}],sx:-1500,sy:-2e3,sm:25,st:500,t:200,atmh:-2e3},{n:7,pn:"Omega",pg:1,pa:1,pc:"tan",parts:[{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:4},{id:4},{id:4},{id:4},{id:4},{id:4},{id:4}],cparts:[{id:w(1,3),a:m()},{id:w(1,3),a:m()},{id:4},{id:4},{id:4}],sx:1500,sy:-2e3,sm:50,st:500,t:200,atmh:-2e3}];window.cheat=function(){localStorage.setItem("ML",lt.length-1)};const dt=document.querySelector("canvas"),ct=dt.getContext("2d"),ut=new o(0,0),pt=new class extends t{constructor(){super(),this.fadeStart=void 0,this.color="black"}draw(t){t.save(),t.fillStyle=this.color,t.fillRect(0,0,e,s),t.restore()}update(t,e){if(this.fadeStart&&this.fadeStart<=e){let t=(e-this.fadeStart)/150;t>=1?this.color="rgb(135,206,235)":(this.color=y(t,["rgb(0,0,0)","rgb(135,206,235)"]),this.x+=this.speed)}}},ft=new class extends t{constructor(){super(),this.keys=new Set}has(t){return this.keys.has(t)}add(t){this.keys.add(t)}remove(t){this.keys.delete(t)}length(){return this.keys.size}clear(){this.keys=new Set}draw(t){}update(){}},yt=new class extends t{constructor(){super(),this.elements=[],this.startTime=new Date,this.s=0}clear(){this.elements=[]}add(t){this.elements.push(t)}draw(t){for(let e of this.elements)t.save(),t.translate(w(-this.s,this.s),w(-this.s,this.s)),e.draw(t),t.restore()}resetTimer(){this.startTime=new Date}update(t,e){let s=[];for(let t of this.elements){let i=[];for(let e of this.elements)t!==e&&x(t,e)&&i.push(e);t.update(i,e,this.elements)&&s.push(t)}this.elements=this.elements.filter((function(t){return s.indexOf(t)<0}))}};let wt,xt=[],gt=vt(),mt=0;function vt(){yt.clear(),wt=void 0,P(),L();let t=[];t.push(pt);for(let i=0;i<100;i++)t.push(new K(w(0,e),w(0,s),w(10,70)));t.push(new Y(20,100,"Spaceship Resurrection",E(100)));let i=new N(540,380,-45,2,1,20,5,h,4);t.push(i);let r=new W(-100,-100,135);t.push(r);let a=()=>{pt.fadeStart=mt,r.speed=-10,i.speed=7,gt.push(new H(mt,120,ft,(()=>{gt.push(new N(e,s,-65,1,1,60,500,h,50)),gt.push(new H(mt,100,ft,(()=>{gt.push(new N(e,s,-65,1,1,70,500,["rgb(0,0,0)","rgb(0,0,0)"],50)),gt.push(new H(mt,90,ft,(()=>{gt=gt.filter((function(t){return"Future"===t.constructor.name})),gt.push(new U(0,0,e,s,"black",!0)),gt.push(new Y(20,270,"You've crashed on a empty planet, but you've escaped death for now...",E(39))),gt.push(new H(mt,180,ft,(()=>{gt.push(new Y(20,320,"However, the same can't be said for your spaceship.",E(39))),gt.push(new H(mt,180,ft,(()=>{gt.push(new Y(20,400,"Rebuild your ship and escape to the space station to survive.",E(39))),gt.push(new Y(20,490,"[Press any key]",E(39))),gt.push(new H(mt,void 0,ft,(()=>{gt=kt(lt[0])})))})))})))})))})))})))},n=localStorage.getItem("ML");if(void 0!==n){n=Math.min(localStorage.getItem("ML"),lt.length-1);for(let e=0;e<n;e++)t.push(new f(965-100*n+100*e,600,90,100,`${e+1}`,"black","white",E(70),75,ut,(()=>{0===e?a():gt=kt(lt[e])}),!0,28))}return t.push(new f(945,600,350,100,"Play Now","black","white",E(70),75,ut,(()=>{void 0===n||0===n?a():gt=kt(lt[n])}))),t.push(ut),t}function kt(t,e){let a=[];yt.clear(),P(),L(),$(),wt=void 0,pt.fadeStart=void 0,pt.color="black",a.push(pt),a.push(new Y(20,40,'Click and drag the components to rebuild your ship! Then click "Launch!"',E(30))),a.push(new U(650,70,550,550,"white"));let n=new B(650,70,ut);a.push(n);let o=t.parts.slice(),l=t.cparts.slice();if(e){let t=0,s=0;for(let i of e.parts)if(i instanceof V){t=i.x/r,s=i.y/r;break}for(let t of e.parts){t.updateGrid(n);let e=!1;for(let s=0;s<o.length;s++){let i=o[s];if(i.a===t.key&&t instanceof G(i.id)){o.splice(s,1),e=!0;break}}if(!e)for(let e=0;e<l.length;e++){let s=l[e];if(s.a===t.key&&t instanceof G(s.id)){l.splice(e,1);break}}}for(let i of e.parts){let e=5-t+i.x/r,h=5-s+i.y/r;a.push(i),n.addComponent(i,e,h)}}else{let t=q(500,500,0,ut,n,null,0);a.push(t),n.addComponent(t,5,5)}if(document.monetization&&"started"===document.monetization.state){let t=C("2015");a.push(new Y(60,460,`${t.repeat(12)} Bonus Coil Components ${t.repeat(12)}`,E(15),!1,"red"));for(let t=0;t<l.length;t++)a.push(q(60+t%5*102,490+t%5*2+t/5*100,0,ut,n,l[t].a,l[t].id,ft));a.push(new U(50,70,550,570,"white"))}else a.push(new U(50,70,550,550,"white"));for(let t=0;t<o.length;t++)a.push(q(60+t%5*102,100+t%5*2+t/5*100,0,ut,n,o[t].a,o[t].id,ft));return a.push(new f(950,640,200,50,"Main Menu","black","white",E(35),38,ut,(()=>{gt=vt()}),!0,15)),a.push(new f(1100,640,200,50,"Launch!","black","white",E(35),38,ut,(()=>{gt=function(t,e){yt.clear(),yt.resetTimer(),yt.s=0,ft.clear(),D();let r=(t,s,i,r)=>{T([1.02,,605,.04,.02,.49,4,4.41,.6,.4,,,,.1,,.8,,.43,.16]);const a="timeout";r.freeze(i===a?0:void 0);let n=0;for(let t=0;t<gt.length;t++)gt[t]instanceof c&&(n=t);let o=t.getSceneCoordsOfParts();for(let e=0;e<o.length;e++)xt.push({at:n,value:new N(i===a?t.x+t.COM.x:o[e].x,i===a?t.y+t.COM.y:639,0,2,2,50,10,h,10,3)});yt.add(new H(mt,100,null,(()=>{yt.add(new ht(s))}))),yt.add(new H(mt,130,null,(()=>{yt.add(new Y(640,180,`You did not survive (${i===a?"you ran out of time":"you crashed"})`,E(40),!0))}))),yt.add(new H(mt,150,null,(()=>{yt.add(new f(610,324,200,50,"Try Again","black","white",E(35),38,ut,(()=>{gt=kt(lt[e.n],t)}),!0,30))}))),yt.add(new H(mt,150,null,(()=>{yt.add(new f(560,468,200,50,"No","black","white",E(35),38,ut,(()=>{gt=vt()}),!0,80))})))},a=new c(e),n=[],o=new p(640,480,t,ft,e,r);o.y=a.y-(o.h+i);let l=new nt(980,700,yt,e,o,r);o.chron=l,yt.add(l);let d=new et(e,o,(function(t){let i=new Date,h=Math.abs(i-yt.startTime)/1e3;l.freeze(),localStorage.setItem("ML",Math.max(e.n+1,localStorage.getItem("ML"))),P();let r,a,n=e.t-h,d=n+5*o.getCargoCount(),c=localStorage.getItem("HS");if(c){a=JSON.parse(c);let t=a[e.pn];void 0===t?a[e.pn]=d:(r=a[e.pn],d>t&&(a[e.pn]=d))}else a={},a[e.pn]=d;localStorage.setItem("HS",JSON.stringify(a)),yt.add(new Z),yt.add(new H(mt,100,null,(()=>{yt.add(new ht(t))}))),yt.add(new H(mt,130,null,(()=>{yt.add(new Y(640,180,"You survived!",E(40),!0))}))),yt.add(new H(mt,135,null,(()=>{yt.add(new Y(640,.35*s,`Remaining time: ${n.toFixed(3)} s`,E(20),!0))}))),yt.add(new H(mt,140,null,(()=>{yt.add(new Y(640,324,`Cargo saved: ${o.getCargoCount()} (+5 pts each)`,E(20),!0))}))),yt.add(new H(mt,145,null,(()=>{yt.add(new Y(640,.55*s,`Total score: ${d.toFixed(3)}`,E(25),!0))}))),yt.add(new H(mt,145,null,(()=>{yt.add(new Y(640,468,void 0===r||d>r?`New record (${void 0===r?"no previous record":`beat ${r.toFixed(3)}`})`:`Record is ${r.toFixed(3)}`,E(25),!0,void 0===r||d>r?"yellow":"lightgrey"))}))),e.n>=lt.length-1?yt.add(new H(mt,150,null,(()=>{yt.add(new f(620,540,200,50,"Main Menu","black","white",E(35),38,ut,(()=>{gt=vt()}),!0,15))}))):yt.add(new H(mt,150,null,(()=>{yt.add(new f(620,525.6,200,50,"Next Level","black","white",E(35),38,ut,(()=>{gt=kt(lt[e.n+1])}),!0))})))}));yt.add(new ot(50,70,e)),yt.add(new st(20,700,o,a)),yt.add(new it(o,d,ut)),yt.add(new f(1040,70,48,48,C("27F3"),"black","white",E(48),36,ut,(function(){gt=kt(e,o)}),!0,13));let u=function(){yt.add(new f(1120,70,48,48,"t"==localStorage.getItem("MO")?"\u{1f507}":"\u{1f508}","black","white",E(35),36,ut,(function(){"t"==localStorage.getItem("MO")?(localStorage.setItem("MO","f"),D()):(localStorage.setItem("MO","t"),L()),u()}),!0,12))};u();let y=function(){yt.add(new f(1180,70,48,48,"t"==localStorage.getItem("MT")?"\u{1f515}":"\u{1f514}","black","white",E(35),36,ut,(function(){localStorage.setItem("MT","t"==localStorage.getItem("MT")?"f":"t"),y()}),!0,8))};y(),n.push(new J(e.atmh)),n.push(a),n.push(d);for(let t of o.parts)n.push(new at(o.x+t.x,a.y-i));return n.push(o),ut.coll=d,yt.add(ut),wt=o,n}(n,t)}))),a.push(ut),a}window.requestAnimationFrame((function t(){if(mt++,ct.fillStyle="grey",ct.fillRect(0,0,e,s),ct.save(),wt){let t=wt.x+wt.COM.x,e=wt.y+wt.COM.y;ct.translate(640,360),ct.scale(1,1),ct.translate(-t,-e)}for(let t of gt)ct.save(),t.draw(ct),ct.restore();ct.restore(),yt.draw(ct),yt.update(null,mt);let i=[];for(let t of gt){let e=[];for(let s of gt)t!==s&&x(t,s)&&e.push(s);t.update(e,mt,gt)&&i.push(t)}gt=gt.filter((function(t){return i.indexOf(t)<0}));for(let t of xt)gt.splice(t.at?t.at:0,0,t.value);xt=[],window.requestAnimationFrame(t)})),CanvasRenderingContext2D.prototype.roundRect=function(t,e,s,i,h){return s<2*h&&(h=s/2),i<2*h&&(h=i/2),this.beginPath(),this.moveTo(t+h,e),this.arcTo(t+s,e,t+s,e+i,h),this.arcTo(t+s,e+i,t,e+i,h),this.arcTo(t,e+i,t,e,h),this.arcTo(t,e,t+s,e,h),this.closePath(),this},dt.addEventListener("mousedown",(function(t){t.preventDefault(),ut.click=!0})),dt.addEventListener("mouseup",(function(t){t.preventDefault(),ut.click=!1})),dt.addEventListener("mousemove",(function(t){t.preventDefault();var e=canvas.getBoundingClientRect();ut.x=t.x-e.left,ut.y=t.y-e.top})),document.addEventListener("keydown",(t=>{ft.add(t.key)}),!1),document.addEventListener("keyup",(t=>{ft.remove(t.key)}),!1)})();