function InputManager(){this.events={},this.listenToButtons(),this.listenToKeyboard(),this.listenToScreen()}InputManager.prototype.on=function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)},InputManager.prototype.emit=function(t,e){var n=this.events[t];n&&n.forEach(function(t){t(e)})},InputManager.prototype.listenToButtons=function(){this.bindButtonPress(".pause-or-continue-btn",this.pauseOrContinue),this.bindButtonPress(".deform-btn",this.deform),this.bindButtonPress(".clockwise-btn",this.rotate),this.bindButtonPress(".anticlockwise-btn",this.rotate),this.bindButtonPress(".replay-btn",this.replay)},InputManager.prototype.listenToKeyboard=function(){var t=this,e={65:2*Math.PI/3,68:-2*Math.PI/3},n={38:"deform",37:"left",39:"right",40:"down"};document.addEventListener("keydown",function(e){var o=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey,i=n[e.which];o||i&&(e.preventDefault(),"deform"===i?t.emit("deform"):t.emit("move",i))}),document.addEventListener("keyup",function(n){var o=n.altKey||n.ctrlKey||n.metaKey||n.shiftKey,i=e[n.which];o||i&&(n.preventDefault(),t.emit("rotate",i))})},InputManager.prototype.listenToScreen=function(){var t,e,n,o,i=this,a=document.querySelector(".game-canvas");a.addEventListener("touchstart",function(n){n.touches.length>1||n.targetTouches.length>1||(n.preventDefault(),t=n.touches[0].clientX,e=n.touches[0].clientY)}),a.addEventListener("touchmove",function(a){if(!(a.touches.length>1||a.targetTouches.length>1)){a.preventDefault(),n=a.touches[0].clientX,o=a.touches[0].clientY;var r=n-t,s=o-e,u=Math.abs(r),h=Math.abs(s);Math.max(u,h)>10&&(0>s&&h>u?i.emit("deform"):i.emit("move",u>h?r>0?"right":"left":s>0?"down":""),t=n,e=o)}})},InputManager.prototype.deform=function(t){t.preventDefault(),this.emit("deform")},InputManager.prototype.rotate=function(t){t.preventDefault(),"clockwise-btn"===t.target.className?this.emit("rotate",2*Math.PI/3):"anticlockwise-btn"===t.target.className&&this.emit("rotate",-2*Math.PI/3)},InputManager.prototype.pauseOrContinue=function(t){t.preventDefault(),"Pause"===t.target.innerText?this.emit("pause"):this.emit("continue")},InputManager.prototype.replay=function(t){t.preventDefault(),this.emit("replay")},InputManager.prototype.bindButtonPress=function(t,e){var n=document.querySelector(t);n.addEventListener("click",e.bind(this)),n.addEventListener("touchend",e.bind(this))};