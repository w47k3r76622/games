function grid(a){var d,b=lr.w,c=lr.h;c<b?(d=Math.round(c/a),lr.ry=Math.round(c/d),lr.rx=Math.round(b/d)):(d=Math.round(b/a),lr.rx=Math.round(b/d),lr.ry=Math.round(c/d)),lr.o=d,lr.fb=new Array;for(var f=lr.rx,g=lr.ry,h=0;h<f;h++){lr.fb[h]=new Array;for(var i=0;i<g;i++)lr.fb[h][i]=["00","00","00"]}}function drawLetter(a,b,c,d){var e=chars[c];if(!e)return 0;for(var f=0;f<e[0].length;f++)for(var g=0;g<e.length;g++)"1"===e[g].charAt(f)&&(lr.fb[a+f][b+g]=[d[0],d[1],d[2]]);return e[0].length}function drawText(a){for(var b=0,c=Math.round(lr.ry/2),d=0;d<a.length;d++)b+=drawLetter(b,c,a.charAt(d),rgb.blue)+1}function clear(a){var b=lr.rx,c=lr.ry;if(""===a){for(var d=lr.index_background%2,e=0;e<b;e++)for(var f=0;f<c;f++){var g=lr.background[lr.size][d];lr.fb[e][f]=[g,g,g]}lr.index_background=d+1}else drawText(a)}function draw(){for(var a=document.getElementById("gameScreen"),b=a.getContext("2d"),c=lr.rx,d=lr.ry,e=lr.o,f=0,g=0,h=0;h<c;h++){for(var i=0;i<d;i++)b.fillStyle="#"+lr.fb[h][i][0]+lr.fb[h][i][1]+lr.fb[h][i][2],b.fillRect(f,g,e,e),g+=e;f+=e,g=0}}function rand(a){return Math.floor(Math.random()*a)}function update(){if(lr.time+=1,lr.fortune=rand(5),lr.time>lr.framerate){var a=lr.fallingitem.lenght?lr.fallingitem.lenght:0;if(lr.fortune===a){var b=new armature(rand(lr.rx));lr.fallingitem.push(b)}else{var c=new glitch(rand(lr.rx));lr.fallingitem.push(c)}spawn_sound.play(),lr.time=0}for(var d=lr.fallingitem.length?lr.fallingitem.length:0,e=0;e<d;e++)lr.fallingitem[e]&&lr.fallingitem[e].drawSprite(e)}function go_left(){lr.heroposx<=0==!1&&(lr.heroposx-=1)}function go_right(){lr.heroposx+1>lr.rx-h.size==!1&&(lr.heroposx+=1)}function move_hero(a){switch(a.keyCode){case 37:go_left();break;case 39:go_right();break;default:console.log(a.keyCode)}}function start_hero(a){switch(a.keyCode){case 83:clearInterval(cicle),setCanvas();break;default:console.log(a.keyCode)}}function audio(){}function mouse_hero(a){a.x<lr.w/2?go_left():go_right()}function splash(){lr.w=document.documentElement.clientWidth,lr.h=document.documentElement.clientHeight,lr.resolution=48,lr.size=0,lr.fortune=10,lr.time=0,lr.textsize=5,lr.index_background=0,lr.splashrate=500,lr.indexsplash=0,lr.splashonscreen=["LOW RES","","PARTY!","","PRESS S","","TO START","",""],lr.text_end=["END...","","PRESS S","","TO RESTART","",""],grid(lr.resolution),document.getElementById("gameScreen").width=document.documentElement.clientWidth,document.getElementById("gameScreen").height=document.documentElement.clientHeight,document.addEventListener("keydown",start_hero,!1),lr.background=[["00","00"],["00","11"],["00","22"],["00","33"],["00","44"],["00","55"],["00","66"],["00","77"],["00","88"],["00","99"],["00","AA"],["00","BB"],["00","CC"],["00","DD"],["00","EE"],["00","FF"]],splashloop()}function setCanvas(){lr.w=document.documentElement.clientWidth,lr.h=document.documentElement.clientHeight,lr.resolution=48,lr.framerate=30,lr.fallingitem=[],lr.size=0,lr.fortune=10,lr.time=0,lr.res_sprites=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],lr.textsize=5,lr.textonscreen="",lr.end=!1,lr.index_background=0,document.getElementById("gameScreen").width=document.documentElement.clientWidth,document.getElementById("gameScreen").height=document.documentElement.clientHeight,document.removeEventListener("keydown",start_hero),document.addEventListener("keydown",move_hero,!1),document.addEventListener("mousedown",mouse_hero,!1),grid(lr.resolution),audio(),h=new hero,h.create(),loop()}function endloop(){var a=lr.text_end.length-1;lr.indexend=0,cicle=setInterval(function(){var b=lr.indexend%a;clear(lr.text_end[b]),lr.indexend=b+1,draw(),console.log("loop")},lr.splashrate)}function splashloop(){var a=lr.splashonscreen.length-1;cicle=setInterval(function(){var b=lr.indexsplash%a;clear(lr.splashonscreen[b]),lr.indexsplash=b+1,draw(),console.log("loop")},lr.splashrate)}function loop(){cicle=setInterval(function(){clear(lr.textonscreen),update(),h.draw(),draw()},lr.framerate)}function end(){clearInterval(cicle),document.removeEventListener("keydown",move_hero),document.addEventListener("keydown",start_hero,!1);for(var a=lr.fallingitem.length?lr.fallingitem.length:0,b=0;b<a;b++)lr.fallingitem.splice(b,1);clear(lr.textonscreen),endloop()}function die(a){lr.fallingitem.splice(a,1)}function grow(){clearInterval(cicle),lr.textonscreen="GROW!!!";for(var a=lr.fallingitem.length?lr.fallingitem.length:0,b=0;b<a;b++)lr.fallingitem.splice(b,1);clear(lr.textonscreen),draw(),lr.textonscreen="",setTimeout(loop,1e3)}function become_smaller(){clearInterval(cicle),lr.textonscreen="SMALL!";for(var a=lr.fallingitem.length?lr.fallingitem.length:0,b=0;b<a;b++)lr.fallingitem.splice(b,1);clear(lr.textonscreen),draw(),lr.textonscreen="",setTimeout(loop,1e3)}function hero(){this.velocity=5,this.drawSprite=function(a,b,c){this.size=lr.res_sprites[lr.size];for(var d=b,e=b+lr.res_sprites[lr.size],f=0;d<e;d++,f++)for(var g=c,h=c+lr.res_sprites[lr.size],i=0;g<h;g++,i++)"1"===sprites[a][f].charAt(i)&&(lr.fb[g][d]=["FF","FF","FF"])},this.draw=function(){this.drawSprite("hero"+lr.res_sprites[lr.size],lr.ry-lr.res_sprites[lr.size],lr.heroposx)},this.create=function(){lr.main_sprite="hero"+lr.res_sprites[lr.size],lr.heroposx=0,lr.heroposy=lr.ry-lr.res_sprites[lr.size]}}function armature(a){this.velocity=5,this.posx=a,this.posy=0,this.numberOfFlicker=30,this.drawSprite=function(a){if(this.size=lr.res_sprites[lr.size+1],this.posy+this.size<=lr.ry){for(var b=!1,c=this.posx,d=this.posx+this.size,e=0;c<d&&!b;c++,e++)for(var f=this.posy,g=this.posy+this.size,h=0;f<g&&!b;f++,h++)lr.fb[c]&&lr.fb[c][f]&&"1"===sprites["hero"+this.size][h].charAt(e)&&(lr.fb[c][f]=["FF","00","00"]),(this.posx<=lr.heroposx&&lr.heroposx<=this.posx+this.size||this.posx<=lr.heroposx+this.size&&lr.heroposx+this.size<=this.posx+this.size)&&this.posy+this.size>=lr.heroposy?(armature_sound.play(),hit("a"),b=!0):this.posy+this.size>=lr.ry&&(lr.fallingitem.splice(a,1),b=!0);this.posy+=1}else die(a)}}function glitch(a){this.velocity=5,this.posx=a,this.posy=0,this.numberOfFlicker=30,this.flick=0,this.white=!1,this.drawSprite=function(a){if(this.size=lr.res_sprites[lr.size],this.posy+this.size<=lr.ry){for(var b=!1,c=this.posx,d=this.posx+this.size,e=0;c<d&&!b;c++,e++)for(var f=this.posy,g=this.posy+this.size,h=0;f<g&&!b;f++,h++)lr.fb[c]&&lr.fb[c][f]&&(rand(2)%2===0?lr.fb[c][f]=["FF","FF","FF"]:lr.fb[c][f]=["00","00","00"]),(this.posx<=lr.heroposx&&lr.heroposx<=this.posx+this.size||this.posx<=lr.heroposx+this.size&&lr.heroposx+this.size<=this.posx+this.size)&&this.posy+this.size>=lr.heroposy?(glitch_sound.play(),hit("g"),die(a),b=!0):this.posy+this.size>=lr.ry?(lr.fallingitem.splice(a,1),b=!0):this.flick+=1;this.posy+=1}else die(a)}}function hit(a){switch(a){case"g":if(lr.size--,lr.size<0){lr.size=0,end();break}become_smaller();break;case"a":if(lr.size++,lr.size>=lr.res_sprites.length-1){end();break}grow()}}var lr={},cicle={},h={},armature_sound=new Audio("sounds/hit_armature.mp3"),glitch_sound=new Audio("sounds/hit_glitch.mp3"),spawn_sound=new Audio("sounds/spawn.mp3"),sprites={hero:["0011111111111100","0111000110001110","1111101111011111","1111111111111111","1111111111111111","1111111111111111","1111011111111111","1111100000011111","1011111111111101","1001111111111001","1000111111110001","0000111111110000","0000111111110000","0000111111110000","0000100000010000","0000100000010000"],hero1:["1"],hero2:["1X","X1"],hero3:["1XX","X1X","1X1"],hero4:["X11X","1XX1","1111","1111"],hero5:["11111","1X1X1","11111","X111X","11X11"],hero6:["111111","1X11X1","111111","111111","1XXXX1","111111"],hero7:["1111111","1XX1XX1","1111111","1111111","1XX1XX1","1XXXXX1","1111111"],hero8:["00111100","01011010","11100111","11111111","01100110","00111100","11100111","10000001"],hero9:["111111111","100111001","110111011","111111111","000111000","111111111","100111001","000111000","111101111"],hero10:["1000000001","1111111111","1000110001","1111111111","1001111001","0001111000","1111001111","0001111000","1111111111","1010000101"],hero11:["11111011111","10101010101","11111011111","10001010001","11111011111","01110001110","11111111111","10100000101","10100000101","00100000100","11111011111"],hero12:["000001100000","100011110001","110111111011","111111111111","100011110001","111110011111","001100001100","001101101100","111111111111","111111111111","101011110101","000010010000"],hero13:["1111100011111","1000100010001","1010110110101","1000111110001","1111111111111","1011111111101","1000000000001","1111111111111","0111111111110","0011111111100","0010111110100","0010110110100","0000100010000"],hero14:["11101111110111","10110111101101","10011011011001","10001100110001","11111111111111","10111011011101","10010011001001","10000000000001","11111111111111","11111111111111","11101011010111","10101100110101","10101111110101","10101011010101"],hero15:["101010101010101","111111111111111","100000000000001","100111111111001","100100111001001","111111111111111","000111111111000","000001111100000","111111111111111","111001111100111","111001111100111","111001111100111","111101111101111","111101111101111","111001000100111"],hero16:["0000111111110000","0011111111111100","0111011111101110","0111101111011110","1111110110111111","1111111111111111","1111111111111111","1111111111111111","1111000000001111","1111011111101111","1111111111111111","1110111111110111","1010111111110101","0000111001110000","0011111001111100","1111110000111111"],white:["1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111","1111111111111111"],black:["0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000","0000000000000000"]},chars={A:["00100","01010","10001","11111","10001"],B:["11110","10001","11110","10001","11111"],C:["01111","10000","10000","10000","01111"],D:["11110","10001","10001","10001","11111"],E:["11111","10000","11100","10000","11111"],F:["11111","10000","11100","10000","10000"],G:["01111","10000","10011","10001","01110"],H:["10001","10000","11111","10001","10001"],I:["00100","00100","00100","00100","00100"],J:["00001","00001","00001","10001","01110"],K:["10001","10010","11100","10010","10001"],L:["10000","10000","10000","10000","11111"],M:["10001","11011","10101","10001","10001"],N:["10001","11001","10101","10011","10001"],O:["01110","10001","10001","10001","01110"],P:["11110","10001","11110","10000","10000"],Q:["01110","10001","10101","10011","01110"],R:["11110","10001","11110","10001","10001"],S:["01111","10000","01110","00001","11110"],T:["11111","00100","00100","00100","00100"],U:["10001","10001","10001","10001","01110"],V:["10001","10001","10001","01010","00100"],W:["10001","10101","10101","10101","01010"],X:["10001","01010","00100","01010","10001"],Y:["10001","01010","00100","00100","00100"],Z:["11111","00010","00100","01000","11111"],"!":["00100","00100","00100","00000","00100"],".":["00000","00000","00000","00000","00100"]," ":["00000","00000","00000","00000","00000"],1:["00010","00110","01010","00010","00010"],2:["01110","10001","00010","01100","11111"],3:["11110","00001","00110","00001","11110"],4:["00010","00110","01010","11111","00010"],5:["11111","10000","11110","10001","11110"],6:["01111","10001","11110","10001","01110"],7:["11111","00001","00010","00100","01000"],8:["01110","10001","01110","10001","01110"],9:["01110","10001","01111","00001","01110"],0:["01110","11001","10100","10011","01110"]},rgb={blue:["00","00","FF"]};