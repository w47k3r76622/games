<!DOCTYPE html><html><head> <meta charset="UTF-8"> <title>Omega Glitch</title> <style type="text/css"> body{color:white; overflow: hidden; background: rgb(10,10,10);}ul{list-style-type: none;}button:focus{outline:0;}button:hover{opacity:0.8;}#background{background: rgb(10,10,10); position: absolute; width: 100%; height: 100%;}.centered{text-align: center; margin: 0 auto;}#game_canvas, #grid, #grid_bg, #intro{background-color: rgba(0,0,0,0);text-align: center;position: absolute;margin: auto;display: inline-block;left: 30%;top: 30%;width: 640px; height: 480px;}#play_tips{position: absolute; left: 35%; top: 30%; width: 640px; height: 480px; cursor: default;}.play_tip{position: absolute; font-family: Helvetica Neu, sans-serif; color: rgba( 230, 255, 255, 0.8); font-weight: 300; width: 200px; text-align: center; border: 1px solid; box-shadow: 0 0 50px 5px rgba( 0, 150, 254, .4 ); border-radius: 5px; padding: 5px; background-color: rgba(0,0,0,0.45); font-size: 13px;}#tip_lv1a{top: 140px; left: 20px;}#start_screen, #select_level, #game_complete, #custom_level, #level_editor{position: absolute; left: 0; top: 0; background-color: rgb(0,0,0); width: 100%; height: 100%;}#level_editor{background-color: rgba(0,0,0,0);}.hidden{display: none;}.level_btn{position: absolute; width: 75px; height: 30px; border: 3px solid rgba( 0, 150, 254, .5 ); border-radius: 15px; border-color: rgba( 0, 150, 254, 1 ); text-align: center; cursor: pointer; background: transparent; color: white; font-size: 16px;}.level_btn:disabled{border: 3px solid gray; border-color: gray; color: gray; opacity: 0.3;}.left_0{left: 5%;}.left_1{left: 25%;}.left_2{left: 45%;}.left_3{left: 65%;}.left_4{left: 85%;}.top_0{top: 20%;}.top_1{top: 40%}#restart_level, #quit_level{position: absolute; top: 80%; left: 43%;}#quit_level{left: 55%;}.grid_square{position: absolute; border: rgba(13, 45, 51,0.5) 1px dotted;}.grid_button{position: absolute;}.grid_button.selected{border: #3bbdd6 1px solid;}.title{border: 3px solid rgba( 0, 150, 254, .5 ); border-radius: 15px; border-color: rgba( 0, 150, 254, 1 ); box-shadow: 0 0 50px 5px rgba( 0, 150, 254, .4 ); height: 40px; width: 150px; text-align: center; cursor: pointer; background: transparent;}.title span{line-height: 30px; color: rgba( 230, 255, 255, 0.8); font-family: Helvetice Neue, sans-serif; font-size: 14px; font-weight: 400;}h1{font-family: Helvetica Neue, sans-serif; font-size: 80px; text-align: center; font-weight: 300; letter-spacing: 3px; margin:0px;}.blue{color: transparent; text-shadow: 0 0 1px #FBFBFB, 0 0 4px #B6E5EF, 0 0 8px #268398, 0 0 8px #268398, 0 0 10px #268398; -webkit-filter: url("#glitch"); filter: url("#glitch"); margin-bottom: 100px;}#level_editor_back, #select_level_back, #custom_level_back{position: absolute; top: 20px; left: 20px;}.controls{position: absolute; top: 26%; left: 20px;}.export{position: absolute; top: 15px; left: 67%; width: 300px;}.direction_button{width: 40px; height: 25px; border: 3px solid rgba( 0, 150, 254, .5 ); border-radius: 15px; border-color: rgba( 0, 150, 254, 1 ); text-align: center; cursor: pointer; background: transparent; color: white; font-size: 12px; margin: 5px 8px 0px 0px;}.direction_button:disabled{border: 3px solid gray; border-color: gray; color: gray; opacity: 0.3; cursor: not-allowed;}#level_editor_context_config{position: absolute; top: 220px; left: 10px; font-family: Helvetica Neue, sans-serif; color: #E6FFFF;}#level_editor_patrol_config{position: absolute; top: 205px; left: 10px;}.editor_button{width: 130px; height: 25px; border: 3px solid rgba( 0, 150, 254, .5 ); border-radius: 15px; border-color: rgba( 0, 150, 254, 1 ); text-align: center; cursor: pointer; background: transparent; color: white; font-size: 12px; margin: 10px 2px 2px 2px;}.editor_button:disabled{border: 3px solid gray; border-color: gray; color: gray; opacity: 0.3; cursor: not-allowed;}.charges{position: absolute; top: 16%; left: 32.5%; font-family: Arial, Helvetica, sans-serif; color: #E6FFFF; height: 111px;}#charges{font-family: serif; font-size: 100px; color: #DF740C; text-shadow: 0 0 1px #FBFBFB, 0 0 4px #B6E5EF, 0 0 8px #268398, 0 0 8px #268398, 0 0 10px #268398;}.startingCharges{font-family: Helvetica Neue, sans-serif;}</style></head></body><div id="background"> <canvas id="game_background" class="hidden"></canvas> <div class="charges"><span style="bottom:0px;">Charges:</span> <span id="charges"></span></div><canvas id="game_canvas" width="640" height="480"></canvas> <div id="play_tips"></div><div id="play_game" class="hidden"> <button id="restart_level" class="title"><span>Restart Level</span></button> <button id="quit_level" class="title"><span>Quit Level</span></button> </div><div id="select_level" class="hidden"> <h1 class="blue">Select Level</h1> <button id="select_level_back" class="level_btn">Back</button> </div><div id="game_complete" class="hidden"> <h1>You Beat The Game!!</h1> <button id="back_to_start">I'm Awesome!</button> </div><div id="start_screen"> <div id="intro"> <h1 class="blue">Omega Glitch <svg xmlns="http://www.w3.org/2000/svg" version="1.1"> <defs> <filter id="glitch" x="0" y="0"> <feColorMatrix in="SourceGraphic" mode="matrix" values="1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0" result="r"/> <feOffset in="r" result="r" dx="-5"> <animate attributeName="dx" attributeType="XML" values="0; -5; 0; -18; -2; -4; 0 ;-3; 0" dur="0.2s" repeatCount="indefinite"/> </feOffset> <feColorMatrix in="SourceGraphic" mode="matrix" values="0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0" result="g"/> <feOffset in="g" result="g" dx="-5" dy="1"> <animate attributeName="dx" attributeType="XML" values="0; 0; 0; -3; 0; 8; 0 ;-1; 0" dur="0.15s" repeatCount="indefinite"/> </feOffset> <feColorMatrix in="SourceGraphic" mode="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 0" result="b"/> <feOffset in="b" result="b" dx="5" dy="2"> <animate attributeName="dx" attributeType="XML" values="0; 3; -1; 4; 0; 2; 0 ;18; 0" dur="0.35s" repeatCount="indefinite"/> </feOffset> <feBlend in="r" in2="g" mode="screen" result="blend"/> <feBlend in="blend" in2="b" mode="screen" result="blend"/> </filter> </defs></svg></h1> <div class="centered"> <button id="campaign" class="title"><span>Play Campaign</span></button> <button id="custom" class="title"><span>Play Custom Level</span></button> <button id="build" class="title"><span>Build Custom Level</span></button> </div></div></div><div id="custom_level" class="hidden"> <h1 class="blue">Custom Level</h1> <button id="custom_level_back" class="level_btn">Back</button> <p>Place level code snippet here:</p><textarea id="custom_level_textarea"> </textarea> <button id="play_custom">Play</button> </div><div id="level_editor" class="hidden"> <h1 class="blue">Level Editor</h1> <div id="grid_bg"></div><div id="grid"> </div><button id="level_editor_back" class="level_btn">Back</button> <div class="controls"> <span class="startingCharges">Starting charges:</span><input style="margin-left: 20px;" id="charge_setter" type="text"> <br><button class="editor_button" id="add_spot">Spot</button> <button class="editor_button" id="add_objective">Processor</button> <button class="editor_button" id="add_charge">Add Charge</button><br><button class="editor_button" id="add_gate_generator">Firewall Generator</button> <button class="editor_button" id="add_gate">Firewall</button> <button class="editor_button" id="add_patrol_generator">Security Hub</button><br><button class="editor_button" id="add_patrol">Security Packet</button> <br><button class="direction_button" id="path_n">N</button> <button class="direction_button" id="path_ne">NE</button> <button class="direction_button" id="path_e">E</button> <button class="direction_button" id="path_se">SE</button> <button class="direction_button" id="path_s">S</button> <button class="direction_button" id="path_sw">SW</button> <button class="direction_button" id="path_w">W</button> <button class="direction_button" id="path_nw">NW</button> <br><button class="direction_button" id="gpath_n">N</button> <button class="direction_button" id="gpath_ne">NE</button> <button class="direction_button" id="gpath_e">E</button> <button class="direction_button" id="gpath_se">SE</button> <button class="direction_button" id="gpath_s">S</button> <button class="direction_button" id="gpath_sw">SW</button> <button class="direction_button" id="gpath_w">W</button> <button class="direction_button" id="gpath_nw">NW</button> <div id="level_editor_context_config"> <p></p><ul></ul> </div><div id="level_editor_patrol_config"> </div></div><div class="export"> <button class="title" id="export"><span>Export</span></button> <div id="export_text"> </div><button class="title" id="test_level"><span>Test Level</span></button> </div></div><script type="text/javascript">!function(){var AvatarManager=function(){function e(){x.charges&&(x.charges--,x.charge_active=!0,u.detonate_charge(m))}function t(){var e=utils.normalize(x.pos_x,x.pos_y,v[f].x,v[f].y);x.vol_x=e[0]*x.speed,x.vol_y=e[1]*x.speed}function s(e){function s(){x.pos_x=v[f].x,x.pos_y=v[f].y,f++,f>=v.length?n(next_spot):t()}if(b)return x.pos_x+=x.vol_x*e,x.pos_y+=x.vol_y*e,x.vol_x>0&&x.pos_x>v[f].x?void s():x.vol_x<0&&x.pos_x<v[f].x?void s():void(v[f]&&x.vol_y>0&&x.pos_y>v[f].y?s():x.vol_y<0&&x.pos_y<v[f].y&&s())}function a(e){x.charge_active&&(x.charge_explosion.current_radious+=x.charge_explosion.speed*e,x.charge_explosion.current_radious>x.charge_explosion.max_radious&&(x.charge_explosion.current_radious=0,x.charge_active=!1))}function n(e){m=e,b=!1,x.pos_x=e.pos_x,x.pos_y=e.pos_y,e.charge&&(x.charges++,e.charge=!1),x.collision=8,w=!1,u.avatar_on_spot(e)}function o(){n(u.starting_spot)}function r(e){s(e),a(e)}function i(){return x}function l(){return w}function _(e){d=e,d.add_subscriber(this)}function h(s){if(!b&&level_ready){if(" "===s)return void e();var a=u.move_leads_to(m,y[s]);a&&(v=a.path.checkpoints.slice(0),v[0].x===x.pos_x&&v[0].y===x.pos_y||v.reverse(),f=1,next_spot=a.spot,t(),b=!0,w=!1,x.collision=4,u.avatar_leaving_spot())}}function c(e){u=e}function g(e){x.charges=e}function p(){w=!0,v.reverse(),f=v.length-1-f,t(),next_spot=m}var d,u,v,f,m,y={a:"west",s:"south",d:"east",w:"north"},x={pos_x:0,pos_y:0,vol_x:0,vol_y:0,speed:500,charges:0,collision:10,radius:10,graphic:{lineWidth:0,fillStyle:"rgba(12,20,31,0.7)",strokeStyle:"#29c8df",shadowColor:"#39b5a6",shadowBlur:5,shadowOffsetX:0,shadowOffsetY:0},charge_active:!1,charge_explosion:{current_radious:0,speed:250,max_radious:80}},b=!1,w=!1;this.update=r,this.get_avatar=i,this.start_level=o,this.inject_input=_,this.key_pressed=h,this.button_pressed=function(){},this.inject_level_manager=c,this.set_avatar_charges=g,this.get_gate_hit=l,this.hit_gate=p},CONFIG={canvas_id:"game_canvas",fps:60,grid_width:40,grid_height:30,grid_size:15,direction_to_grid_difference:{1:{x:0,y:-1},2:{x:1,y:-1},3:{x:1,y:0},4:{x:1,y:1},5:{x:0,y:1},6:{x:-1,y:1},7:{x:-1,y:0},8:{x:-1,y:-1}},level_button_width:5},DomManager=function(){function e(e){f[e].classList.add("hidden")}function t(e){f[e].classList.remove("hidden")}function s(e){for(var t=1;t<=e;t++){var s=document.getElementById("level_"+t);s.disabled=!1}}function a(e){m.innerHTML="";for(var t=0;t<e.length;t++){var s=document.createElement("div");s.classList.add("play_tip"),s.style.left=e[t].pos_x+"px",s.style.top=e[t].pos_y+"px",s.textContent=e[t].tip_text,m.appendChild(s)}}function n(){return y.value}function o(){for(var e=0;e<=CONFIG.grid_width;e++)for(var t=0;t<=CONFIG.grid_height;t++){var s=document.createElement("div");if(s.classList.add("grid_square"),s.style.top=t*CONFIG.grid_size+"px",s.style.left=e*CONFIG.grid_size+"px",s.style.width=CONFIG.grid_size+"px",s.style.height=CONFIG.grid_size+"px",x.appendChild(s),e<CONFIG.grid_width&&t<CONFIG.grid_height){var a=document.createElement("div"),n="grid_"+(e+1)+"_"+(t+1);a.id=n,a.classList.add("grid_button"),a.style.top=t*CONFIG.grid_size+CONFIG.grid_size/2+"px",a.style.left=e*CONFIG.grid_size+CONFIG.grid_size/2+"px",a.style.width=CONFIG.grid_size+"px",a.style.height=CONFIG.grid_size+"px",b.appendChild(a),input.add_button(n)}}}function r(e,t){v&&v.classList.remove("selected"),v=document.getElementById("grid_"+e+"_"+t),v.classList.add("selected")}function i(){return document.getElementById("charge_setter").value}function l(e){for(var t=0;t<w.length;t++)document.getElementById("path_"+w[t]).disabled=e.indexOf(w[t])==-1}function _(e){for(var t=0;t<w.length;t++)document.getElementById("gpath_"+w[t]).disabled=e.indexOf(w[t])==-1}function h(e){for(var t=0;t<C.length;t++)document.getElementById("add_"+C[t]).disabled=e.indexOf(C[t])==-1}function c(e,t){var s=document.getElementById("level_editor_context_config");s.classList.remove("hidden"),s.getElementsByTagName("p")[0].innerHTML="Processor",list=s.getElementsByTagName("ul")[0],list.innerHTML="";for(var a=0;a<t.length;a++){var n=document.createElement("input");n.type="checkbox",n.checked=e[1].indexOf(a)!=-1,n.value=a,n.addEventListener("change",function(){level_editor.path_checkbox_changed(this)});var o=document.createElement("li");o.appendChild(n),o.appendChild(document.createTextNode("path_"+a)),list.appendChild(o)}}function g(e,t){O.innerHTML="",O.classList.remove("hidden");for(var s,a=t[e[e.length-1]],n=["n","e","s","w"],o=0;o<n.length;o++)if(s=a[n[o]]){if(1==e.length){var r=document.createElement("button");r.classList.add("editor_button"),r.id="move_to_"+s[0],r.innerHTML="Move to "+n[o],r.addEventListener("click",function(){level_editor.move_patrol_to(this)}),O.appendChild(r)}var r=document.createElement("button");r.classList.add("editor_button"),r.id="route_to_"+s[0],r.innerHTML="Route to "+n[o],r.addEventListener("click",function(){level_editor.add_route_to(this)}),O.appendChild(r)}if(e.length>1)for(o=0;o<n.length;o++)if(t[e[e.length-1]][n[o]]&&t[e[e.length-1]][n[o]][0]==e[0]){var i=document.createElement("button");i.classList.add("editor_button"),i.innerHTML="Complete Route",i.addEventListener("click",function(){document.getElementById("level_editor_patrol_config").classList.add("hidden"),level_editor.route_complete()}),O.appendChild(i)}}function p(){document.getElementById("level_editor_context_config").classList.add("hidden")}function d(e){export_text.innerHTML=utils.stringify_level(e)}function u(e){for(var t=(document.getElementById("charges")," "),s=0;s<e;s++)t+=".";charges.innerHTML=t}for(var v,f={start_screen:document.getElementById("start_screen"),select_level:document.getElementById("select_level"),play_game:document.getElementById("play_game"),game_complete:document.getElementById("game_complete"),custom_level:document.getElementById("custom_level"),level_editor:document.getElementById("level_editor"),export_text:document.getElementById("export_text"),game_background:document.getElementById("game_background")},m=document.getElementById("play_tips"),y=document.getElementById("custom_level_textarea"),x=document.getElementById("grid_bg"),b=document.getElementById("grid"),w=["n","ne","e","se","s","sw","w","nw"],C=["spot","objective","charge","gate_generator","gate","patrol_generator","patrol"],O=document.getElementById("level_editor_patrol_config"),N=0,k=0,j=1;j<=Object.keys(CONTENT.levels).length;j++){var T=document.createElement("button");T.textContent="lv "+j,T.id="level_"+j,T.classList.add("level_btn"),T.classList.add("left_"+N),T.classList.add("top_"+k),T.disabled=!0,N++,N==CONFIG.level_button_width&&(N=0,k++),f.select_level.appendChild(T),input.add_button("level_"+j)}o(),this.close_screen=e,this.open_screen=t,this.unlock_levels=s,this.place_game_tips=a,this.get_custom_level_input=n,this.select_grid_square=r,this.get_charge_count=i,this.enable_paths=l,this.enable_gpaths=_,this.enable_buttons=h,this.build_objective_config=c,this.build_patrol_config=g,this.export_level=d,this.hide_context=p,this.display_charges=u},game;window.onload=function(e){game=new Game};var Game=function(){function e(e){level_ready&&t.update(e)}var t=new GameMaster;level_editor=new LevelEditor,graphics=new Graphics,input=new Input,dom_manager=new DomManager,input.set_up_button_events(),t.inject_graphics(graphics),t.inject_input(input),t.inject_dom_manager(dom_manager),t.inject_level_editor(level_editor),level_editor.inject_game_master(t),level_editor.inject_input(input),level_editor.inject_dom_manager(dom_manager);var s=function(){var t=1e3/CONFIG.fps;next_tick=last_tick=(new Date).getTime();return num_frames=0,function(){for(current_tick=(new Date).getTime();current_tick>next_tick;)delta=(current_tick-last_tick)/1e3,e(delta),next_tick+=t,last_tick=(new Date).getTime();graphics.draw(),num_frames++}}();window.requestAnimationFrame?window.each_frame=function(e){var t=function(){e(),requestAnimationFrame(t)};t()}:window.mozRequestAnimationFrame?window.each_frame=function(e){var t=function(){e(),mozRequestAnimationFrame(t)};t()}:window.each_frame=function(e){setInterval(e,1e3/CONFIG.fps)},window.each_frame(s)},level_ready=!1,game_paused=!1,level_editor_mode=!0,GameMaster=function(){function update(e){game_paused||(avatar_manager.update(e),level_manager.update(e),dom_manager.display_charges(avatar_manager.get_avatar().charges))}function inject_graphics(e){graphics=e,graphics.inject_avatar(avatar_manager.get_avatar()),level_manager.inject_graphics(e)}function inject_input(e){input=e,avatar_manager.inject_input(e),input.add_subscriber(this)}function inject_dom_manager(e){dom_manager=e}function inject_level_editor(e){level_editor=e}function start_game(){current_level=6,start_level()}function start_level(){level_manager.clear_level(),graphics.clear_level(),level_manager.setup_level(current_level),dom_manager.place_game_tips(level_manager.get_play_tips()),avatar_manager.start_level(),level_ready=!0}function level_complete(){setTimeout(function(){level_ready=!1,current_level++,current_level>highest_level&&(highest_level=current_level,dom_manager.unlock_levels(highest_level),document.cookie="omega_glitch_level="+highest_level),start_level()},1e3)}function game_complete(){dom_manager.open_screen("game_complete")}function reset_level(){level_ready=!1,start_level()}function button_pressed(button){"campaign"==button?(dom_manager.close_screen("start_screen"),dom_manager.open_screen("select_level"),dom_manager.unlock_levels(highest_level)):"level_editor_back"==button?(dom_manager.close_screen("level_editor"),level_editor_mode=!1,dom_manager.open_screen("start_screen")):"select_level_back"==button?(dom_manager.close_screen("select_level"),dom_manager.open_screen("start_screen")):"custom_level_back"==button?(dom_manager.close_screen("custom_level"),dom_manager.open_screen("start_screen")):"level_"==button.substring(0,6)?(current_level=parseInt(button.substring(6)),start_level(),dom_manager.close_screen("select_level"),dom_manager.open_screen("game_background"),dom_manager.open_screen("play_game")):"restart_level"==button?(level_ready=!1,start_level()):"quit_level"==button?(testing_level?(dom_manager.open_screen("level_editor"),level_editor_mode=!0):dom_manager.open_screen("select_level"),dom_manager.close_screen("game_background"),dom_manager.close_screen("play_game")):"back_to_start"==button?(dom_manager.close_screen("game_complete"),dom_manager.open_screen("start_screen")):"custom"==button?(dom_manager.close_screen("start_screen"),dom_manager.open_screen("custom_level")):"play_custom"==button?(set_up_custom_level(eval(dom_manager.get_custom_level_input())),dom_manager.close_screen("custom_level")):"build"==button&&(dom_manager.close_screen("start_screen"),dom_manager.open_screen("level_editor"),level_editor_mode=!0)}function read_in_cookie(){var e=document.cookie;e=e.split(";");for(var t=0;t<e.length;t++)if("omega_glitch_level="==e[t].trim().substring(0,19))return parseInt(e[t].substring(20))}function set_up_custom_level(e,t){CONTENT.levels[0]=e,current_level=0,testing_level=!!t,start_level()}var graphics,input,dom_manager,level_editor,current_level,testing_level,highest_level=read_in_cookie()||1,avatar_manager=new AvatarManager;level_manager=new LevelManager,avatar_manager.inject_level_manager(level_manager),level_manager.inject_avatar_manager(avatar_manager),level_manager.inject_game_master(this),this.update=update,this.inject_graphics=inject_graphics,this.inject_input=inject_input,this.inject_dom_manager=inject_dom_manager,this.inject_level_editor=inject_level_editor,this.key_pressed=function(){},this.button_pressed=button_pressed,this.start_game=start_game,this.level_complete=level_complete,this.reset_level=reset_level,this.game_complete=game_complete,this.set_up_custom_level=set_up_custom_level},GAME_TEXT={lv1a:'This is you: a malicious little Glitch. Use "A", "S", "W", "D" to move.',lv1b:'This is your objective: A system Processor. Use "Space Bar" to detonate your malware charge to disable it.',lv2a:"Some paths are one way. Restart the level if you get stuck.",lv2b:"Sometimes you may happen across a malware package from a fallen comrade. Carry on his work!",lv3a:"Security Routines will stop you in your path. Be careful.",lv4a:"Firewalls will prevent you from proceeding, though otherwise harmless.",lv4b:"Firewalls are powered from these Generators. Detonate your malware on them to disable the generator along with their Firewalls.",lv5a:"Security Routines are also powered by their own Generators. You know what to do...",lv6a:"Some systems take a bit more payload to take down.",lv6b:"You are on your own from here on."},Gate=function(e){function t(){active=!1}function s(){return active}this.pos_x=e.x*CONFIG.grid_size,this.pos_y=e.y*CONFIG.grid_size,this.size=8,this.collision=6,active=!0,this.blow_up=t,this.is_active=s,this.graphic={lineWidth:1,fillStyle:"rgba(204, 51, 51, 0.6)",shadowColor:"#6FC3DF",shadowBlur:5,shadowOffsetX:0,shadowOffsetY:0}},GateGenerator=function(e,t){function s(e){n=e,n.add_to_manifest(this,"gate_generators");for(var t=0;t<o.length;t++)o[t].inject_graphics(n),o[t].set_starting_spot(this.spot)}function a(){for(var e=0;e<o.length;e++)o[e].blow_up()}var n;this.spot=t[e.s],this.gates=e.g;var o=e.gp.slice(0);this.pos_x=this.spot.pos_x,this.pos_y=this.spot.pos_y,this.size=10;for(var r=0;r<o.length;r++)o[r]=new GateGeneratorPath(o[r]);this.blow_up=a,this.inject_graphics=s,this.graphic={lineWidth:1,fillStyle:"rgba(204, 104, 51, 0.6)",shadowColor:"#6FC3DF",shadowBlur:5,shadowOffsetX:0,shadowOffsetY:0}},GateGeneratorPath=function(e){function t(e){o=e,this.checkpoints=a(),graphics.add_to_manifest(this,"gate_generator_paths")}function s(e){graphics=e}function a(){r=[],r.push({x:o.pos_x,y:o.pos_y});for(var e,t,s=0;s<i.length;s+=2)e=i[s],t=i[s+1],r.push({x:CONFIG.direction_to_grid_difference[e].x*CONFIG.grid_size*t+r[r.length-1].x,y:CONFIG.direction_to_grid_difference[e].y*CONFIG.grid_size*t+r[r.length-1].y});return r}function n(){graphics.remove_from_manifest(this,"gate_generator_paths"),this.blown_up=!0}var o,r,i=e;this.checkpoints=[],this.graphic={setLineDash:[5,3],lineWidth:2,strokeStyle:"#ff5c33",shadowColor:"#6FC3DF",shadowBlur:5,shadowOffsetX:0,shadowOffsetY:0},this.set_starting_spot=t,this.inject_graphics=s,this.checkpoints=r,this.blow_up=n},Graphics=function(){function e(){d.clearRect(0,0,u,v);for(var e=0;e<f.length;e++)o(f[e]);h()}function t(e){c=e}function s(){for(var e in g)g[e]=[];g.avatar=[c]}function a(e,t){var s=g[t];s.indexOf(e)==-1&&s.push(e)}function n(e,t){var s=g[t];s.indexOf(e)!=-1&&s.splice(s.indexOf(e),1)}function o(e){for(var t=g[e],s=0;s<t.length;s++){d.save();var a=t[s].graphic;for(var n in a)"setLineDash"!=n?d[n]=a[n]:d.setLineDash(a[n]);m[e](t[s]),d.restore()}}function r(e){d.beginPath(),d.arc(e.pos_x,e.pos_y,e.collision,0,2*Math.PI,!0),d.fill(),d.stroke(),e.charge&&_(e)}function i(e){var t=e.pos_x,s=e.pos_y,a=e.size;d.beginPath(),d.moveTo(t-a,s-a),d.lineTo(t+a,s-a),d.lineTo(t+a,s+a),d.lineTo(t-a,s+a),d.lineTo(t-a,s-a),d.fill(),d.stroke()}function l(e){d.beginPath();var t=e.checkpoints;d.moveTo(t[0].x,t[0].y);for(var s=1;s<t.length;s++)d.lineTo(t[s].x,t[s].y);d.stroke()}function _(e){d.fillStyle="rgba(212, 17, 27, 0.6)",d.shadowColor="#d0161e",d.shadowBlur=10,d.shadowOffsetX=0,d.shadowOffsetY=0,d.beginPath(),d.arc(e.pos_x,e.pos_y,4,0,2*Math.PI,!0),d.fill()}function h(){c.charge_active&&(d.save(),d.lineWidth=10,d.fillStyle="rgba(212, 17, 27, 0.6)",d.shadowColor="#d0161e",d.shadowBlur=10,d.shadowOffsetX=0,d.shadowOffsetY=0,d.beginPath(),d.arc(c.pos_x,c.pos_y,c.charge_explosion.current_radious,0,2*Math.PI,!0),d.stroke(),d.restore())}var c,g={spots:[],paths:[],objectives:[],patrols:[],patrol_generators:[],gates:[],gate_generators:[],gate_generator_paths:[],avatar:[]},p=document.getElementById(CONFIG.canvas_id),d=p.getContext("2d"),u=p.width,v=p.height,f=["paths","spots","objectives","patrols","patrol_generators","gates","gate_generators","gate_generator_paths","avatar"],m={paths:l,spots:r,objectives:i,patrols:r,patrol_generators:i,gates:i,gate_generators:i,gate_generator_paths:l,avatar:r};this.draw=e,this.clear_level=s,this.inject_avatar=t,this.add_to_manifest=a,this.remove_from_manifest=n};!function(){function e(e,t,s,a){d.beginPath(),d.moveTo(e,t),d.lineTo(s,a),d.closePath(),d.stroke()}function t(){this.points=[{y:Math.floor(Math.random()*u+1)*l,x:Math.floor(Math.random()*v+1)*l}],this.draw=a,this.move=s,this.dir=Math.floor(8*Math.random()+1)}function s(){var e=Math.floor(3*Math.random()-1),t=this.dir+e;t<0&&(t=7),7<t&&(t=0);var s=this.points[this.points.length-1];s.x<10&&(t=2),s.y<10&&(t=4),r.width-10<s.x&&(t=6),r.height-10<s.y&&(t=0),this.dir=t;var a={x:s.x+x[t].x*l,y:s.y+x[t].y*l};this.points.push(a),10<this.points.length&&this.points.shift()}function a(){var e=this.points;for(m=1;m<e.length;m++)i.beginPath(),i.moveTo(e[m-1].x,e[m-1].y),i.lineTo(e[m].x,e[m].y),i.closePath(),i.lineWidth=1,i.strokeStyle=c,i.stroke(),i.lineWidth=10,i.strokeStyle=g,i.stroke()}function n(e){this.snakeys=[];for(var s=0;s<e;s++)this.snakeys.push(new t);this.go=o}function o(){for(var e=0;e<this.snakeys.length;e++)this.snakeys[e].move(),this.snakeys[e].draw()}var r=document.getElementById("game_background");r.width=window.innerWidth,r.height=window.innerHeight;var i=r.getContext("2d");i.translate(.5,.5);var l=12,_="rgba(240,240,240)",h="rgba(0,20,40,0.9)",c="rgba(0,255,255,0.1)",g="rgba(0,100,100,0.1)",p=document.createElement("canvas");p.width=window.innerWidth,p.height=window.innerHeight;var d=p.getContext("2d");d.translate(.5,.5),d.fillStyle=_,d.fillRect(0,0,p.width,p.height);var u=Math.ceil(p.height/l),v=Math.ceil(p.width/l);d.strokeStyle=h;for(var f=1;f<=v;f++)e(f*l,0,f*l,p.height);for(var y=0;y<=u;y++)e(0,y*l,p.width,y*l);for(var y=0;y<=u+v;y++)e(0,y*l-p.width,p.width,y*l),e(0,y*l,p.width,y*l-p.width);var x=[{name:"up",x:0,y:-1},{name:"upright",x:1,y:-1},{name:"right",x:1,y:0},{name:"downright",x:1,y:1},{name:"down",x:0,y:1},{name:"downleft",x:-1,y:1},{name:"left",x:-1,y:0},{name:"upleft",x:-1,y:-1}],b=new n(10);i.drawImage(p,0,0),setInterval(function(){i.globalAlpha=.2,i.drawImage(p,0,0),i.globalAlpha=1,b.go()},1e3/30)}();var Input=function(){function e(e){o.push(e)}function t(){for(var e=0;e<o.length;e++){var t=document.getElementById(o[e]);!function(e){t.addEventListener("mouseup",function(){for(var t=0;t<n.length;t++)n[t].button_pressed(o[e])})}(e)}}function s(e){n.indexOf(e)===-1&&n.push(e)}function a(e){n.indexOf(e)!==-1&&e.splice(n.indexOf(e),1)}var n=[],o=["campaign","select_level_back","level_editor_back","custom_level_back","custom","build","restart_level","quit_level","back_to_start","play_custom","add_spot","add_objective","add_charge","add_gate_generator","add_gate","add_patrol_generator","add_patrol","export","test_level","path_n","path_ne","path_e","path_se","path_s","path_sw","path_w","path_nw","gpath_n","gpath_ne","gpath_e","gpath_se","gpath_s","gpath_sw","gpath_w","gpath_nw"];window.addEventListener("keydown",function(e){for(var t=0;t<n.length;t++)n[t].key_pressed(e.key)}),this.add_subscriber=s,this.remove_subscriber=a,this.set_up_button_events=t,this.add_button=e},LevelEditor=function(){function e(e){C=e}function t(e){O=e,O.add_subscriber(this)}function a(e){N=e,N.enable_paths([]),N.enable_gpaths([]),N.enable_buttons(["spot"])}function n(e){if("grid_"==e.substring(0,5)){if(z||P||D)return;B=parseInt(e.split("_")[1]),L=parseInt(e.split("_")[2]),N.select_grid_square(B,L)}else if("add_spot"==e)l();else if("add_objective"==e)_();else if("add_charge"==e)h();else if("add_gate_generator"==e)c();else if("add_gate"==e)g();else if("add_patrol_generator"==e)p();else if("add_patrol"==e)d();else if("path_"==e.substring(0,5))u(E[e.split("_")[1]]);else if("gpath_"==e.substring(0,6))v(E[e.split("_")[1]]);else if("export"==e)N.export_level(G);else{if("test_level"!=e)return;N.close_screen("level_editor"),N.open_screen("game_background"),N.open_screen("play_game"),C.set_up_custom_level(G,!0)}o()}function o(){k=r(),i(),w()}function r(){N.hide_context(),response={};for(var e in G.spots)if(G.spots[e].x==B&&G.spots[e].y==L){response.spot=G.spots[e],response.spot_name=e,z&&(f(response.spot),M=[]);for(var t=0;t<G.objectives.length;t++)G.objectives[t][0]==e&&(response.objective=G.objectives[t],N.build_objective_config(response.objective,G.paths));for(var s=0;s<G.gate_generators.length;s++)G.gate_generators[s].s==e&&(response.gate_generator=G.gate_generators[s],j=G.gate_generators[s]);for(var a=0;a<G.patrol_generators.length;a++)G.patrol_generators[a].s==e&&(response.patrol_generator=G.patrol_generators[a],T=G.patrol_generators[a])}for(var n=0;n<G.gates.length;n++)G.gates[n].x==B&&G.gates[n].y==L&&(response.gate=G.gates[n]);return response}function i(){if(!k.spot||P||D)if(z){var e=["n","ne","e","se","s","sw","w","nw"],t=M[M.length-2]-1;t=(t+4)%8,e.splice(t,1),N.enable_paths(e),k.gate?N.enable_buttons([]):N.enable_buttons(["spot"]),N.enable_gpaths([])}else if(P){var e=["n","ne","e","se","s","sw","w","nw"],t=S[S.length-2]-1;t=(t+4)%8,e.splice(t,1),N.enable_gpaths(e),N.enable_paths([]),k.spot?N.enable_buttons([]):N.enable_buttons(["gate"])}else k.spot?(N.enable_paths([]),N.enable_gpaths([]),N.enable_buttons([])):(N.enable_paths([]),N.enable_gpaths([]),N.enable_buttons(["spot"]));else{for(var e=["n","e","s","w"],s=e.length-1;s>=0;s--)"undefined"!=typeof k.spot[e[s]]&&e.splice(s,1);N.enable_paths(e),k.objective||k.spot.charge||k.gate_generator||k.patrol_generator?(N.enable_buttons([]),k.gate_generator?N.enable_gpaths(["n","ne","e","se","s","sw","w","nw"]):k.patrol_generator&&N.enable_buttons("patrol")):N.enable_buttons(["objective","charge","gate_generator","patrol_generator"])}for(a=0;a<G.paths.length;a++)"threat"==G.paths[a].slice(0).pop()&&G.paths[a].pop();if(k.objective)for(var a=0;a<k.objective[1].length;a++)"threat"!=G.paths[k.objective[1][a]].slice(0).pop()&&G.paths[k.objective[1][a]].push("threat")}function l(){W++;var e={x:B,y:L};G.spots["s"+W]=e,G.start||(G.start="s"+W),M.length&&f(e),z=!1}function _(){var e=[k.spot_name,[]];G.objectives.push(e)}function h(){k.spot.charge=!0}function c(){var e={s:k.spot_name,g:[],gp:[]};G.gate_generators.push(e)}function g(){var e={x:B,y:L};G.gates.push(e),j.g.push(G.gates.length-1),S=[],P=!1}function p(){var e={s:k.spot_name,p:[]};G.patrol_generators.push(e)}function d(){var e=[T.s];I=e,G.patrols.push(e),T.p.push(G.patrols.length-1),D=!0,N.build_patrol_config(e,G.spots)}function u(e){M.length?M[M.length-2]==e?M[M.length-1]++:M.push(e,1):(M.push(k.spot_name,e,1),G.paths.push(M),k.spot[F[e-1]]=G.paths.length-1),B+=CONFIG.direction_to_grid_difference[e].x,L+=CONFIG.direction_to_grid_difference[e].y,N.select_grid_square(B,L),z=!0}function v(e){S.length||j.gp.push(S),S[S.length-2]==e?S[S.length-1]++:S.push(e,1),B+=CONFIG.direction_to_grid_difference[e].x,L+=CONFIG.direction_to_grid_difference[e].y,N.select_grid_square(B,L),P=!0}function f(e){var t=[1,3,5,7],a=t.indexOf(M[M.length-2]),n=G.spots[M[0]],o=F[M[1]-1];for(s in G.spots)if(G.spots[s]==e){n[o]=[s,G.paths.length-1];break}a>-1&&(a=(a+2)%4,e[F[t[a]-1]]=[M[0],G.paths.length-1]),M=[],z=!1}function m(e){var t=parseInt(e.value),s=k.objective[1];e.checked?(s.push(t),G.paths[t].push("threat")):(s.splice(s.indexOf(t),1),G.paths[t].pop()),o()}function y(e){var t=e.id.split("_")[2];I[0]=t,o(),N.build_patrol_config(I,G.spots)}function x(e){var t=e.id.split("_")[2];I.push(t),o(),N.build_patrol_config(I,G.spots)}function b(){T=!1,I=!1,D=!1,o()}function w(){Object.keys(G.spots).length&&(G.charges=parseInt(N.get_charge_count())||0,C.set_up_custom_level(G))}var C,O,N,k,j,T,I,E={n:1,ne:2,e:3,se:4,s:5,sw:6,w:7,nw:8},F=["n","ne","e","se","s","sw","w","nw"],G={charges:0,spots:{},paths:[],patrols:[],patrol_generators:[],start:!1,objectives:[],gates:[],gate_generators:[],end_of_game:!0},B=0,L=0,M=[],S=[],z=!1,P=!1,D=!1,W=0;this.inject_game_master=e,this.inject_input=t,this.inject_dom_manager=a,this.key_pressed=function(){},this.button_pressed=n,this.path_checkbox_changed=m,this.move_patrol_to=y,this.add_route_to=x,this.route_complete=b,this.get_level=function(){return G}},LevelManager=function(){function e(e){g=CONTENT.levels[String(e)],d.set_avatar_charges(g.charges);for(var t in g.spots){var s=new Spot(g.spots[t]);v[t]=s,p.add_to_manifest(s,"spots")}for(this.starting_spot=v[g.start],i=0;i<g.paths.length;i++){var a=new Path(g.paths[i]);a.inject_graphics(p),a.set_starting_spot(v[g.paths[i][0]]),f.push(a)}for(i=0;i<g.objectives.length;i++){var n=new Objective(g.objectives[i],v);p.add_to_manifest(n,"objectives"),m.push(n)}for(i=0;i<g.patrols.length;i++){var o=new Patrol(g.patrols[i]);o.make_path_list(f,v),o.inject_graphics(p),y.push(o)}for(i=0;i<g.patrol_generators.length;i++){var r=new PatrolGenerator(g.patrol_generators[i],v);p.add_to_manifest(r,"patrol_generators"),x.push(r)}for(i=0;i<g.gates.length;i++){var l=new Gate(g.gates[i]);p.add_to_manifest(l,"gates"),b.push(l)}for(i=0;i<g.gate_generators.length;i++){var _=new GateGenerator(g.gate_generators[i],v);_.inject_graphics(p),w.push(_)}if(g.tips)for(i=0;i<g.tips.length;i++)C.push(new PlayTip(g.tips[i]))}function t(e,t){if(!e[t])return!1;var s={spot:v[e[t][0]],path:f[e[t][1]]};return!s.path.blocked&&s}function s(e){p=e}function a(e){d=e}function n(e){u=e}function o(e){for(var t=0;t<m.length;t++)if(m[t].pos_x==e.pos_x&&m[t].pos_y==e.pos_y)for(var s=0;s<m[t].paths.length;s++)f[m[t].paths[s]].threaten()}function r(){for(var e=0;e<f.length;e++)f[e].unthreaten()}function l(e){for(var t=0;t<m.length;t++)if(m[t].spot==e){m[t].blow_up(),p.remove_from_manifest(m[t],"objectives");for(var s=m[t].paths.length-1;s>-1;s--){f[m[t].paths[s]].blow_up();for(var a=0;a<y.length;a++)y[a].get_current_path()===f[m[t].paths[s]]&&y[a].blow_up()}m.splice(t,1),m.length||(g.end_of_game?u.game_complete():u.level_complete())}for(t=0;t<x.length;t++)if(x[t].spot==e){x[t].blow_up();for(var a=x[t].patrols.length-1;a>-1;a--)y[x[t].patrols[a]].blow_up();p.remove_from_manifest(x[t],"patrol_generators")}for(t=0;t<w.length;t++)if(w[t].spot==e){w[t].blow_up();for(var n=w[t].gates.length-1;n>-1;n--)b[w[t].gates[n]].blow_up(),p.remove_from_manifest(b[w[t].gates[n]],"gates"),p.remove_from_manifest(w[t],"gate_generators")}}function _(){return C}function h(){v={},f=[],m=[],y=[],x=[],b=[],w=[],C=[]}function c(e){for(var t=0;t<y.length;t++)y[t].update(e),y[t].is_active()&&utils.check_collision(y[t].get_unit(),d.get_avatar())&&u.reset_level();for(t=0;t<b.length;t++)b[t].is_active()&&!d.get_gate_hit()&&utils.check_collision(b[t],d.get_avatar())&&d.hit_gate()}var g,p,d,u,v,f,m,y,x,b,w,C;this.starting_spot,this.setup_level=e,this.inject_graphics=s,this.inject_avatar_manager=a,this.inject_game_master=n,this.get_play_tips=_,this.move_leads_to=t,this.avatar_on_spot=o,this.avatar_leaving_spot=r,this.detonate_charge=l,this.clear_level=h,this.update=c},Objective=function(e,t){function s(){}this.spot=t[e[0]],this.paths=e[1],this.size=15,this.pos_x=this.spot.pos_x,this.pos_y=this.spot.pos_y,this.graphic={lineWidth:1,fillStyle:"rgba(250,247,91,0.2)",shadowColor:"#6FC3DF",shadowBlur:5,shadowOffsetX:0,shadowOffsetY:0},this.blow_up=s},Path=function(e){function t(e){l=e,this.checkpoints=a(),i.add_to_manifest(this,"paths")}function s(e){i=e}function a(){_=[],_.push({x:l.pos_x,y:l.pos_y});for(var e,t,s=1;s<h.length;s+=2)e=h[s],t=h[s+1],_.push({x:CONFIG.direction_to_grid_difference[e].x*CONFIG.grid_size*t+_[_.length-1].x,y:CONFIG.direction_to_grid_difference[e].y*CONFIG.grid_size*t+_[_.length-1].y});return _}function n(){this.blocked=!0,this.blown_up=!0,this.graphic.strokeStyle="rgba(209, 243, 248, 0.25)",this.graphic.shadowBlur=0}function o(){c.shadowColor="#cc0000"}function r(){c.shadowColor="#6FC3DF"}var i,l,_,h=e.slice(0),c={lineWidth:2,strokeStyle:"rgba(209, 243, 248, 1)",shadowColor:"#6FC3DF",shadowBlur:5,shadowOffsetX:0,shadowOffsetY:0};this.graphic=c,"threat"==h[h.length-1]&&(h.pop(),o()),this.set_starting_spot=t,this.inject_graphics=s,this.checkpoints=_,this.blow_up=n,this.threaten=o,this.unthreaten=r},Patrol=function(e){function t(e){p=e,p.add_to_manifest(w,"patrols")}function s(e,t){d=[];for(var s=0;s<b.length;s++)d.push(e[a(t[b[s]],b[(s+1)%b.length])]);w.pos_x=t[b[0]].pos_x,w.pos_y=t[b[0]].pos_y,y=w.pos_x,x=w.pos_y,v=-1,f=1,i()}function a(e,t){for(var s=0;s<O.length;s++)if(e[O[s]]&&e[O[s]][0]==t)return e[O[s]][1]}function n(e){C&&o(e)}function o(e){w.pos_x+=w.vol_x*e,w.pos_y+=w.vol_y*e,w.vol_x>0&&w.pos_x>u[m].x?r():w.vol_x<0&&w.pos_x<u[m].x&&r(),w.vol_y>0&&w.pos_y>u[m].y?r():w.vol_y<0&&w.pos_y<u[m].y&&r()}function r(){w.pos_x=u[m].x,w.pos_y=u[m].y,m++,m>=u.length?i():l()}function i(){if(!(b.length<2)){if(v=(v+f+b.length)%b.length,u=d[v],!u&&level_editor_mode)return v=-1,w.pos_x=y,w.pos_y=x,void i();u.blown_up&&(f=-f,v=(v+2*f+b.length)%b.length,u=d[v]),u=u.checkpoints.slice(0),u[0].x===w.pos_x&&u[0].y===w.pos_y||u.reverse(),m=1,l()}}function l(){var e=utils.normalize(w.pos_x,w.pos_y,u[m].x,u[m].y);w.vol_x=e[0]*w.speed,w.vol_y=e[1]*w.speed}function _(){return w}function h(){return C}function c(){C=!1,w.graphic.fillStyle="rgba(28, 19 207, 0.8)",w.collision=8}function g(){return d[v]}var p,d,u,v,f,m,y,x,b=e,w={pos_x:0,pos_y:0,vol_x:0,vol_y:0,speed:75,collision:10,graphic:{lineWidth:0,fillStyle:"rgba(207, 19, 28, 0.8)",shadowColor:"#6FC3DF",shadowBlur:20,shadowOffsetX:0,shadowOffsetY:0}},C=!0,O=["north","east","west","south"];this.make_path_list=s,this.update=n,this.inject_graphics=t,this.get_unit=_,this.get_current_path=g,this.blow_up=c,this.is_active=h},PatrolGenerator=function(e,t){function s(){}this.spot=t[e.s],this.patrols=e.p,this.pos_x=this.spot.pos_x,this.pos_y=this.spot.pos_y,this.size=10,this.blow_up=s,this.graphic={lineWidth:1,fillStyle:"rgba(84, 84, 51, 0.6)",shadowColor:"#6FC3DF",shadowBlur:5,shadowOffsetX:0,shadowOffsetY:0}},PlayTip=function(e){this.tip_text=GAME_TEXT[e.t],this.pos_x=e.x,this.pos_y=e.y},Spot=function(e){this.pos_x=e.x*CONFIG.grid_size,this.pos_y=e.y*CONFIG.grid_size,this.north=e.n,this.east=e.e,this.south=e.s,this.west=e.w,this.charge=e.charge||!1,this.collision=CONFIG.grid_size/2,this.graphic={fillStyle:"rgba(254, 254, 254, 0.8)",lineWidth:2,strokeStyle:"#29c8df",shadowColor:"#5ad4e6",shadowBlur:10,shadowOffsetX:0,shadowOffsetY:0}},Utils=function(){function e(e,t,s,a){x_dif=s-e,y_dif=a-t;var n=x_dif*x_dif+y_dif*y_dif;return n=Math.sqrt(n),[x_dif/n,y_dif/n]}function t(e,t){return s(e,t)<e.collision+t.collision}function s(e,t){var s=e.pos_x-t.pos_x,a=e.pos_y-t.pos_y;return Math.sqrt(s*s+a*a)}function a(e){var t=["n","e","s","w"],s="({charges:";s+=e.charges+",",s+="spots:{";for(var a in e.spots){var n=e.spots[a];s+=a+":{x:"+n.x+",y:"+n.y;for(var o=0;o<t.length;o++)"undefined"!=typeof n[t[o]]&&(s+=","+t[o]+":['"+n[t[o]][0]+"',"+n[t[o]][1]+"]");n.charge&&(s+=",charge:true"),s+="},"}s=s.substr(0,s.length-1),s+="},paths:[";for(var r=0;r<e.paths.length;r++)s+="['"+e.paths[r][0]+"',"+e.paths[r].slice(0).splice(1).toString()+"],";s=s.substr(0,s.length-1),s+="],patrols:[";for(var r=0;r<e.patrols.length;r++){s+="[";for(var i=0;i<e.patrols[r].length;i++)s+="'"+e.patrols[r][i]+"',";s=s.substr(0,s.length-1),s+="],"}","==s[s.length-1]&&(s=s.substr(0,s.length-1)),s+="],patrol_generators:[";for(var l=0;l<e.patrol_generators.length;l++)s+="{s:'"+e.patrol_generators[l].s+"',p:["+e.patrol_generators[l].p.slice(0).toString()+"]},";","==s[s.length-1]&&(s=s.substr(0,s.length-1)),s+="],start:'"+e.start+"',",s+="objectives:[";for(var _=0;_<e.objectives.length;_++)s+="['"+e.objectives[_][0]+"',["+e.objectives[_][1].toString()+"]],";","==s[s.length-1]&&(s=s.substr(0,s.length-1)),s+="],gates:[";for(var h=0;h<e.gates.length;h++)s+="{x:"+e.gates[h].x+",y:"+e.gates[h].y+"},";","==s[s.length-1]&&(s=s.substr(0,s.length-1)),s+="],gate_generators:[";for(var c=0;c<e.gate_generators.length;c++){s+="{s:'"+e.gate_generators[c].s+"',g:["+e.gate_generators[c].g.toString()+"],gp:[";for(var g=0;g<e.gate_generators[c].gp.length;g++)s+="["+e.gate_generators[c].gp[g].toString()+"],";","==s[s.length-1]&&(s=s.substr(0,s.length-1)),s+="]},"}return","==s[s.length-1]&&(s=s.substr(0,s.length-1)),s+="],end_of_game:true});"}this.normalize=e,this.check_collision=t,this.stringify_level=a};utils=new Utils;var CONTENT=CONTENT||{levels:{}};CONTENT.levels[1]={charges:1,spots:{s1:{x:8,y:15,e:["s2",0]},s2:{x:20,y:15,w:["s1",0],e:["s3",1]},s3:{x:35,y:15,w:["s2",1]}},paths:[["s1",3,12],["s2",3,15]],patrols:[],patrol_generators:[],start:"s1",objectives:[["s3",[0,1]]],gates:[],gate_generators:[],tips:[{x:20,y:140,t:"lv1a"},{x:420,y:110,t:"lv1b"}]};var CONTENT=CONTENT||{levels:{}};CONTENT.levels[2]={charges:0,spots:{s1:{x:8,y:15,e:["s2",0]},s2:{x:20,y:15,w:["s1",0],e:["s3",1],n:["s4",2]},s3:{x:35,y:15,w:["s2",1],charge:!0},s4:{x:18,y:10}},paths:[["s1",3,12],["s2",3,15],["s2",1,3,8,2]],patrols:[],patrol_generators:[],start:"s1",objectives:[["s4",[0,1,2]]],gates:[],gate_generators:[],tips:[{x:140,y:60,t:"lv2a"},{x:420,y:120,t:"lv2b"}]};var CONTENT=CONTENT||{levels:{}};CONTENT.levels[3]={charges:1,spots:{s1:{x:8,y:15,e:["s2",0]},s2:{x:12,y:15,w:["s1",0],e:["s4",1],n:["s3",2]},s3:{x:12,y:10,s:["s2",2]},s4:{x:16,y:15,w:["s2",1],e:["s5",3]},s5:{x:20,y:15,w:["s4",3],e:["s6",4]},s6:{x:24,y:15,w:["s5",4],e:["s7",5],s:["s8",6]},s7:{x:30,y:11,s:["s6",5]},s8:{x:30,y:19,w:["s6",6]}},paths:[["s1",3,4],["s2",3,4],["s2",1,5],["s4",3,4],["s5",3,4],["s6",3,3,2,3,1,1],["s6",5,2,4,2,3,4]],start:"s1",objectives:[["s7",[0,1,2,3,4,5,6]]],patrols:[["s3","s2","s4","s5","s6","s8","s6","s5","s4","s2"]],patrol_generators:[{s:"s8",p:[0]}],gates:[],gate_generators:[],tips:[{x:130,y:260,t:"lv3a"}]};var CONTENT=CONTENT||{levels:{}};CONTENT.levels[4]={charges:2,spots:{s1:{x:9,y:7,s:["s2",0]},s2:{x:10,y:12,n:["s1",0],e:["s3",1]},s3:{x:14,y:12,w:["s2",1],e:["s4",2],n:["s7",5]},s4:{x:22,y:14,w:["s3",2],e:["s5",3],s:["s6",4]},s5:{x:25,y:11,s:["s4",3]},s6:{x:20,y:17,e:["s4",4]},s7:{x:20,y:8,w:["s3",5]}},paths:[["s1",5,2,4,1,5,2],["s2",3,4],["s3",3,2,4,2,3,4],["s4",3,2,2,1,1,2],["s4",5,2,6,1,7,1],["s3",1,2,2,2,3,4]],start:"s1",objectives:[["s5",[0,1,2,3,4,5]]],patrols:[["s6","s4","s3","s4"]],patrol_generators:[{s:"s6",p:[0]}],gates:[{x:20,y:14,p:2}],gate_generators:[{s:"s7",g:[0],gp:[[5,6]]}],tips:[{x:50,y:230,t:"lv4a"},{x:330,y:40,t:"lv4b"}]};var CONTENT=CONTENT||{levels:{}};CONTENT.levels[5]={charges:1,spots:{s1:{x:8,y:20,n:["s2",0]},s2:{x:9,y:13,s:["s1",0],n:["s3",1],e:["s4",2]},s3:{x:6,y:12,n:["s2",1],charge:!0},s4:{x:16,y:15,w:["s2",2],s:["s5",3],e:["s7",6]},s5:{x:15,y:20,n:["s4",3],s:["s6",4]},s6:{x:22,y:20,w:["s5",4],n:["s7",5]},s7:{x:19,y:15,w:["s4",6],s:["s6",5],e:["s8",7]},s8:{x:23,y:10,s:["s7",7],w:["s9",8]},s9:{x:19,y:11,e:["s8",8]}},paths:[["s1",1,3,2,1,1,3],["s2",1,2,2,1,1,3,8,1,7,3,6,1,5,2,4,1,5,2],["s2",3,2,4,2,3,3],["s4",5,2,6,1,5,2],["s5",5,1,6,9,3,1,2,10,3,1,6,10,3,1,2,10,3,1,6,10,3,1,2,10,3,1],["s6",1,1,8,3,1,1],["s4",3,3],["s7",3,2,2,2,1,3],["s8",7,2,6,1,7,1]],start:"s1",objectives:[["s8",[0,1,2,3,4,5,6,7,8]]],patrols:[["s5","s4","s7","s6"]],patrol_generators:[{s:"s5",p:[0]}],gates:[{x:18,y:15,p:6}],gate_generators:[{s:"s9",g:[0],gp:[[5,1,6,1,5,2]]}],tips:[{x:280,y:360,t:"lv5a"}]};var CONTENT=CONTENT||{levels:{}};CONTENT.levels[6]={charges:4,spots:{s1:{x:28,y:18,n:["s2",0]},s2:{x:20,y:14,e:["s1",0],s:["s3",1]},s3:{x:8,y:18,n:["s2",1],w:["s4",2]},s4:{x:4,y:10,s:["s3",2],n:["s5",3],e:["s9",8]},s5:{x:9,y:4,w:["s4",3],e:["s6",4],n:["s10",9]},s6:{x:15,y:4,w:["s5",4],n:["s7",5]},s7:{x:22,y:1,w:["s6",5],s:["s8",6]},s8:{x:19,y:8,e:["s7",6],w:["s9",7]},s9:{x:14,y:9,e:["s8",7],w:["s4",8]},s10:{x:6,y:1,e:["s5",9]}},paths:[["s1",1,2,8,2,7,6],["s2",5,3,6,2,8,2,1,3,7,6,6,2,5,2],["s3",7,2,8,2,1,6],["s4",1,3,2,3,3,2],["s5",3,6],["s6",1,2,2,1,3,6],["s7",5,6,6,1,7,2],["s8",7,2,6,1,7,2],["s9",7,6,6,1,7,3],["s5",1,2,8,1,7,2]],start:"s1",objectives:[["s4",[0,1,2,3,8,7,6]],["s7",[5,4,9,3]]],patrols:[["s10","s5","s6","s7","s8","s9","s4","s5"],["s8","s9","s4","s5","s10","s5","s6","s7"]],patrol_generators:[{s:"s10",p:[0,1]}],gates:[{x:11,y:9,p:8}],gate_generators:[{s:"s9",g:[0],gp:[[6,1,7,1,8,1]]}],tips:[{x:120,y:-70,t:"lv6a"},{x:320,y:300,t:"lv6b"}]};var CONTENT=CONTENT||{levels:{}};CONTENT.levels[7]={charges:0,spots:{s1:{x:12,y:14,e:["s2",0]},s2:{x:19,y:14,n:["s5",3],e:["s3",1],w:["s1",0]},s3:{x:26,y:14,n:["s6",5],e:["s4",2],w:["s2",1]},s4:{x:32,y:14,n:["s7",6],w:["s3",2]},s5:{x:19,y:8,e:["s6",4],s:["s2",3]},s6:{x:25,y:8,s:["s3",5],w:["s5",4]},s7:{x:33,y:9,s:["s4",6],charge:!0}},paths:[["s1",3,7],["s2",3,7],["s3",3,6],["s2",1,6],["s5",3,6],["s6",5,2,4,1,5,3],["s4",1,2,2,1,1,2]],patrols:[["s4","s3","s2","s3"],["s6","s3","s2","s5"]],patrol_generators:[{s:"s4",p:[0,1]}],start:"s1",objectives:[["s6",[0,1,2,3,4,5]]],gates:[],gate_generators:[]},CONTENT.levels[8]={charges:0,spots:{s1:{x:5,y:22,n:["s2",0],w:["s4",2]},s2:{x:6,y:14,e:["s3",1],s:["s1",0],w:["s9",7]},s3:{x:14,y:16,e:["s10",8],w:["s2",1]},s4:{x:3,y:28,n:["s1",2],e:["s6",4]},s5:{x:14,y:24,e:["s10",10],w:["s1",3]},s6:{x:6,y:28,w:["s4",4],charge:!0},s7:{x:9,y:10,e:["s8",5],w:["s2",6],charge:!0},s8:{x:19,y:11,e:["s10",9],w:["s7",5]},s9:{x:2,y:10,s:["s2",7]},s10:{x:21,y:15,n:["s8",9],s:["s5",10],w:["s3",8]}},paths:[["s1",1,4,2,1,1,3],["s2",3,3,4,2,3,3],["s1",7,1,6,1,5,5],["s5",7,3,8,1,7,4,8,1],["s4",3,3],["s7",3,5,4,1,3,4],["s7",7,1,6,1,5,2,6,1],["s2",7,2,8,2,1,2],["s3",3,3,2,1,3,3],["s10",1,4,7,2],["s10",5,6,6,1,5,2,7,6]],patrols:[["s2","s3","s10","s8","s7"],["s10","s8","s7","s2","s3"]],patrol_generators:[{s:"s9",p:[0,1]}],start:"s1",objectives:[["s4",[0,1,2,3,4,5,6,7,8,9,10]]],gates:[{x:3,y:26}],gate_generators:[{s:"s5",g:[0],gp:[[6,2,7,9]]}],end_of_game:!0}}(); </script></div></body></html>