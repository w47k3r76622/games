!function(){"use strict";let g=()=>{};let i={};function r(t,e){i[t]=i[t]||[],i[t].push(e)}function t(t,e){i[t]=(i[t]||[]).filter(t=>t!=e)}function w(t,...e){(i[t]||[]).map(t=>t(...e))}let n,y,h={get(t,e){return"_proxy"==e||g}};class o{constructor({spriteSheet:t,frames:e,frameRate:i,loop:s=!0}){this.spriteSheet=t,this.frames=e,this.frameRate=i,this.loop=s;var{width:e,height:i,margin:s=0}=t.frame;this.width=e,this.height=i,this.margin=s,this._f=0,this._a=0}clone(){return new o(this)}reset(){this._f=0,this._a=0}update(t=1/60){if(this.loop||this._f!=this.frames.length-1)for(this._a+=t;1<=this._a*this.frameRate;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render({x:t,y:e,width:i=this.width,height:s=this.height,context:r=y}){var n=this.frames[this._f]/this.spriteSheet._f|0,h=this.frames[this._f]%this.spriteSheet._f|0;r.drawImage(this.spriteSheet.image,h*this.width+(2*h+1)*this.margin,n*this.height+(2*n+1)*this.margin,this.width,this.height,t,e,i,s)}}function a(t){let{x:e=0,y:i=0,width:s,height:r}=t.world||t;return t.mapwidth&&(s=t.mapwidth,r=t.mapheight),{x:e,y:i,width:s,height:r}}class e{constructor(t=0,e=0,i){this.x=t,this.y=e}add(t){return new e(this.x+t.x,this.y+t.y,this)}}function s(){return new e(...arguments)}class H extends class extends class{constructor(t){return this.init(t)}init(t={}){this.position=s(),this.velocity=s(),Object.assign(this,t)}update(t){this.advance(t)}advance(t){var e=this.velocity;this.position=this.position.add(e),this._pc()}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}_pc(){}}{init({width:t=0,height:e=0,context:i=y,render:s=this.draw,update:r=this.advance,...n}={}){super.init({width:t,height:e,context:i,...n}),this._di=!0,this._uw(),this._rf=s,this._uf=r}update(t){this._uf(t)}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this._rf(),t.restore()}draw(){}_pc(){this._uw()}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){this._di&&(this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height)}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh}}}{init({image:t,width:e=t?t.width:void 0,height:i=t?t.height:void 0,...s}={}){super.init({image:t,width:e,height:i,...s})}get animations(){return this._a}set animations(t){let e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=this.width||i.width,this.height=this.height||i.height}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){super.advance(t),this.currentAnimation&&this.currentAnimation.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}function l(){return new H(...arguments)}let c=new WeakMap,d={},u={},m={0:"left",1:"middle",2:"right"};function p(i){var s=i._lf.length?i._lf:i._cf;for(let e=s.length-1;0<=e;e--){let t=s[e];if(t.collidesWithPointer?t.collidesWithPointer(i):function(t,e){let{x:i,y:s,width:r,height:n}=a(t);for(;i-=t.sx||0,s-=t.sy||0,t=t.parent;);var h=e.x-Math.max(i,Math.min(e.x,i+r)),o=e.y-Math.max(s,Math.min(e.y,s+n));return h*h+o*o<e.radius*e.radius}(t,i))return t}}function D(t,e){return parseFloat(t.getPropertyValue(e))||0}function f(t){var e=null!=t.button?m[t.button]:"left";u[e]=!0,E(t,"onDown")}function v(t){var e=null!=t.button?m[t.button]:"left";u[e]=!1,E(t,"onUp")}function C(t){E(t,"onOver")}function G(t){let e=c.get(t.target);e._oo=null,u={}}function x(t,e,i){let s=p(t);s&&s[e]&&s[e](i),d[e]&&d[e](i,s),"onOver"==e&&(s!=t._oo&&t._oo&&t._oo.onOut&&t._oo.onOut(i),t._oo=s)}function E(r,n){r.preventDefault();var t=r.target;let h=c.get(t),{scaleX:o,scaleY:a,offsetX:l,offsetY:d}=function(t){let{canvas:e,_s:i}=t;var t=e.getBoundingClientRect(),s="none"!=i.transform?i.transform.replace("matrix(","").split(","):[1,1,1,1],r=parseFloat(s[0]),s=parseFloat(s[3]),n=(D(i,"border-left-width")+D(i,"border-right-width"))*r,h=(D(i,"border-top-width")+D(i,"border-bottom-width"))*s,o=(D(i,"padding-left")+D(i,"padding-right"))*r,a=(D(i,"padding-top")+D(i,"padding-bottom"))*s;return{scaleX:(t.width-n-o)/e.width,scaleY:(t.height-h-a)/e.height,offsetX:t.left+(D(i,"border-left-width")+D(i,"padding-left"))*r,offsetY:t.top+(D(i,"border-top-width")+D(i,"padding-top"))*s}}(h);r.type.includes("touch")?(Array.from(r.touches).map(({clientX:t,clientY:e,identifier:i})=>{let s=h.touches[i];s||(s=h.touches[i]={start:{x:(t-l)/o,y:(e-d)/a}},h.touches.length++),s.changed=!1}),Array.from(r.changedTouches).map(({clientX:t,clientY:e,identifier:i})=>{let s=h.touches[i];s.changed=!0,s.x=h.x=(t-l)/o,s.y=h.y=(e-d)/a,x(h,n,r),w("touchChanged",r,h.touches),"onUp"==n&&(delete h.touches[i],h.touches.length--,h.touches.length||w("touchEnd"))})):(h.x=(r.clientX-l)/o,h.y=(r.clientY-d)/a,x(h,n,r))}function b(t){var e=t.context?t.context.canvas:n;let i=c.get(e);if(i)return i._o.includes(t)&&p(i)===t;throw new ReferenceError("Pointer events not initialized for the objects canvas")}function B(t){var e=t.canvas;t.clearRect(0,0,e.width,e.height)}let S={},k={},F={},P={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function R(t=g,e){t._pd&&e.preventDefault(),t(e)}function j(t){var e=P[t.code],i=S[e];F[e]=!0,R(i,t)}function z(t){var e=P[t.code],i=k[e];F[e]=!1,R(i,t)}function Y(){F={}}function J(t,e,{handler:i="keydown",preventDefault:s=!0}={}){let r="keydown"==i?S:k;e._pd=s,[].concat(t).map(t=>r[t]=e)}class q{constructor({image:t,frameWidth:e,frameHeight:i,frameMargin:s,animations:r}={}){if(!t)throw Error("You must provide an Image for the SpriteSheet");this.animations={},this.image=t,this.frame={width:e,height:i,margin:s},this._f=t.width/e|0,this.createAnimations(r)}createAnimations(t){let e,i;for(i in t){var{frames:s,frameRate:r,loop:n}=t[i];if(e=[],null==s)throw Error("Animation "+i+" must provide a frames property");[].concat(s).map(t=>{e=e.concat(function(t){if(+t==t)return t;let e=[];var i=+(t=t.split(".."))[0],s=+t[1];let r=i;if(i<s)for(;r<=s;r++)e.push(r);else for(;r>=s;r--)e.push(r);return e}(t))}),this.animations[i]=function(){return new o(...arguments)}({spriteSheet:this,frames:e,frameRate:r,loop:n})}}}var L=(t=>(t[t.Play=0]="Play",t[t.Pause=1]="Pause",t[t.Stop=2]="Stop",t[t.Complete=3]="Complete",t[t.GameOver=4]="GameOver",t))({}),_=(t=>(t[t.Python=0]="Python",t[t.Javascript=1]="Javascript",t[t.Ruby=2]="Ruby",t[t.PHP=3]="PHP",t[t.Pascal=4]="Pascal",t[t.Julia=5]="Julia",t[t.Java=6]="Java",t[t.Go=7]="Go",t[t.Typescript=8]="Typescript",t[t.Dart=9]="Dart",t[t.Kotlin=10]="Kotlin",t[t.Swift=11]="Swift",t[t.C=12]="C",t[t.Malbolge=13]="Malbolge",t[t.HolyC=14]="HolyC",t[t.Assembly=15]="Assembly",t[t.COBOL=16]="COBOL",t))({}),I=(t=>(t[t.Direct=1]="Direct",t[t.Inverse=-1]="Inverse",t))({});const N={[L.Stop]:function(){return`
    ${M}
    <p>You are Dante, a developer who died and went to <b>the Developer's Hell</b>.</p>
    <p>Yeah, how could you imagine those <u>silly jokes</u> about javascript would bring you there?</p>
    <p>With the help of your mentor Virgilius Torvalds, <i>seek your redemption</i> by sailing the Acheron river through the deeps of the Programming Hell!</p>
    <p><u>Tap or press any key to start</u></p>
  `},[L.Complete]:function(){return`
    ${M}
    <p>Congratulations! You crossed the <b>deeps of the Programming Hell</b> with resilience and perseverance.</p>
    <p>You got <i>your redemption</i> and may now live your life with kindness and respect to all the languages.</p>
    <p><u>Tap or press any key to play again</u></p>
  `},[L.GameOver]:function(){return`
    ${M}
    <p>No good! Your soul was consumed by the hatred against languages you don't even know.</p>
    <p>You shall live in Hell refactoring the code you wrote 10 years ago... <b>FOREVER</b>!
    <p><u>Tap or press any key to try again</u></p>
  `},[L.Play]:null,[L.Pause]:null};class W{constructor(){this.infoLayer=document.getElementById("info")}render(t){this.currentGameStatus!==t&&(this.currentGameStatus=t,this.toggleInfoVisibility(),this.renderInfo())}toggleInfoVisibility(){var t=this.currentGameStatus!==L.Play&&this.currentGameStatus!==L.Pause;this.infoLayer.style.visibility=t?"visible":"hidden"}renderInfo(){const t=N[this.currentGameStatus];null!==t&&(this.infoLayer.innerHTML=t())}}const M="<h1>Dante's Dev Hell</h1>";function A(t){return Array(t).fill(null).map((t,e)=>e)}const $=[[_.Python,_.Javascript,_.Ruby,_.PHP,_.Pascal,_.Julia],[_.Java,_.Go,_.Typescript,_.Dart,_.Kotlin,_.Swift],[_.C,_.Malbolge,_.HolyC,_.Assembly,_.COBOL]];function*K(t=function(t){return[...t].sort(()=>.5<Math.random()?1:-1)}){for(const s of A(3)){var e=t($[s]);for(const r of A(3)){var i=80-20*r-20*s;yield{language:e[r],speed:2+.5*s,frequency:1-.25*r,monsterCount:4+3*s,monsterLevelDistribution:[i,100-i]}}}}const V={[_.Python]:"#4B8BBE",[_.Javascript]:"#323330",[_.Ruby]:"#820C02",[_.PHP]:"#6c7eb7",[_.Pascal]:"#f7931e",[_.Julia]:"#4d64ae",[_.Java]:"#ec2024",[_.Go]:"#00acd7",[_.Typescript]:"#3178c6",[_.Dart]:"#00d2b8",[_.Kotlin]:"#c757bc",[_.Swift]:"#f05138",[_.C]:"#6a7582",[_.Malbolge]:"#b50500",[_.HolyC]:"#c37c2e",[_.Assembly]:"#721481",[_.COBOL]:"#01325a"};class X{constructor(t){this.background=l({x:0,y:0,width:window.gameCanvas.width,height:window.gameCanvas.height,color:V[t]}),this.shadow=l({x:0,y:-1*window.gameCanvas.height,width:window.gameCanvas.width,height:2*window.gameCanvas.height,render:function(){var t,e,i;t=this.context,e=window.gameCanvas.width/80,i=window.gameCanvas.height/300,t.scale(e,i),e=new Path2D("m 0,2.3e-4 v 300 h 22.456648 c 54.700501,-159.09789 -53.017428,-147.98695 0,-300 z"),t.fillStyle="rgba(0,0,0,0.2)",t.fill(e),t.beginPath(),t.ellipse(100,100,50,75,Math.PI/4,0,2*Math.PI),t.fill(),t.translate(0,300),t.fill(e),t.beginPath(),t.ellipse(100,100,50,75,Math.PI/4,0,2*Math.PI),t.fill()},dy:1})}render(){this.background.render(),this.shadow.render()}update(){this.shadow.update(),0<=this.shadow.y&&(this.shadow.y=-1*window.gameCanvas.height)}}var Z=Object.defineProperty,U=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,t2=Object.getOwnPropertySymbols,e2=Object.prototype.hasOwnProperty,i2=Object.prototype.propertyIsEnumerable,s2=(t,e,i)=>e in t?Z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;class T{constructor({speed:t,frequency:e}){this.width=49,this.height=70,this.nextMonsterCalled=!1,this.monsterLeftScreen=!1,this.defaultEyeRotation=I.Direct,this.eyesLeft=15,this.eyesTop=15,this.eyesGap=13,this.verticalSpeed=t,this.limitToCallNextMonster=window.gameCanvas.height*e,this.sprite=this.getSprite()}getSprite(){const t=this.renderImage.bind(this);return l((e=((t,e)=>{for(var i in e=e||{})e2.call(e,i)&&s2(t,i,e[i]);if(t2)for(var i of t2(e))i2.call(e,i)&&s2(t,i,e[i]);return t})({},this.getInitialPosition()),i={width:this.width,height:this.height,render:function(){t(this.context)}},U(e,Q(i))));var e,i}getInitialPosition(){var t=window.gameCanvas.width-this.width;return{x:Math.trunc(Math.random()*t),y:-1*this.height}}renderImage(t){this.setScale(t),this.placeImage(t),this.placeEyes(t,15,15),this.placeShadow(t)}setScale(t){t.scale(1.4,1.4)}placeImage(t){var e=new Path2D(this.getImagePath());t.filter="drop-shadow(3px 3px 3px rgba(0,0,0,0.3)",t.fillStyle="#000",t.fill(e),t.filter="none",t.fillStyle="#fff",t.fill(e),t.strokeStyle="#333",t.stroke(e)}placeEyes(t,e,i){this.placeEye(t,this.eyesLeft,this.eyesTop,I.Inverse*this.defaultEyeRotation),this.placeEye(t,this.eyesLeft+this.eyesGap,this.eyesTop,I.Direct*this.defaultEyeRotation)}placeEye(i,s,r,n){[["blur(2px)","#000"],["none","#333"]].forEach(([t,e])=>{i.beginPath(),i.fillStyle=e,i.filter=t;e=n*Math.PI/4;i.ellipse(s,r,3.5,2.5,e,0,2*Math.PI),i.fill()})}placeShadow(t){var e=new Path2D(this.getShadowPath());t.fillStyle="rgba(0,0,0,0.3)",t.fill(e)}getImagePath(){throw new Error("Not Implemented")}getShadowPath(){throw new Error("Not Implemented")}render(){this.sprite.render()}fall(t){this.sprite.update(),this.sprite.y+=2*this.verticalSpeed,this.restartWhenOutCanvas()}restartWhenOutCanvas(){!this.nextMonsterCalled&&this.sprite.y>this.limitToCallNextMonster&&(this.nextMonsterCalled=!0,w("callNextMonster")),!this.monsterLeftScreen&&this.sprite.y>window.gameCanvas.height&&(this.monsterLeftScreen=!0,w("destroyMonster"))}}const r2=[[class extends T{getImagePath(){return"m 35,20 c 0,7 -1,23 -3.3,30 L 28,41 22,50 18,40 10,49 7,40 0,48 C 0,39 2,36 3,23 4,12 6,0 16,0 25,0 34,3 35,21 Z"}getShadowPath(){return"M 4,42 0,48 C 0,39 2,35 3,23 3.5,12 6,0 15,0 20,0 23,0 26,2 3.3,3 10,20 5,42 Z"}},class extends T{constructor(...t){super(...t),this.defaultEyeRotation=I.Inverse,this.eyesLeft=13,this.eyesGap=9,this.reverseDirection=!1}fall(t){this.slideHorizontally(),super.fall(t)}getImagePath(){return"m 0.6,18.88 c -3.2,6.7 7.3,11 8,28 2.2,5.5 3.5,-3.9 6.1,-2.9 2.3,0.84 2.3,2 4.6,3.3 3.1,1.8 5.3,-1.1 7.3,-1.4 2.4,-0.42 5.6,6.9 5.4,-1.1 -0.45,-19 6.9,-25 -0.079,-28 -3.3,-1.4 -1.9,6.4 -3,4.1 -4.5,-9.3 -1.3,-21 -8.2,-21 -8.7,-0.43 -13,2.9 -15,19 -0.7,5.5 -2,-5.6 -5.12,0 z"}getShadowPath(){return"m 0.6,18.88 c -3.2,6.7 7.3,11 8,28 2.2,5.5 3.5,-3.9 6.1,-2.9 C 9.3054086,37.60645 8.9555519,29.035045 6.2200132,25.194241 16.046146,27.812577 4.1743762,1.7533605 25.292022,4.0615333 23.66163,1.5392037 22.055474,-0.03250161 20.721,-0.12 c -8.7,-0.43 -13,2.9 -15,19 -0.7,5.5 -2,-5.6 -5.12,0 z"}slideHorizontally(){var t=this.sprite.x+this.verticalSpeed*(this.reverseDirection?-1:1);t<0||t+this.sprite.width>window.gameCanvas.width?this.reverseDirection=!this.reverseDirection:this.sprite.x=t}}],[class extends T{constructor(...t){super(...t),this.defaultEyeRotation=I.Inverse,this.eyesLeft=11,this.eyesGap=12,this.slideSpeed=Math.sqrt(this.verticalSpeed)}fall(t){this.moveTowardHero(t),super.fall(t)}getImagePath(){return"m35 46c-2.8 0.085-9.8 1.2-12-4.1-1.5 2.4-1.4 4.2-1 6.6-5.7-0.97-8.6-2.7-11-7-0.91 2.4-1.4 4.5-0.87 7.7-10-7.6-9.2-13-8.6-27 0.23-5.5 2-11 4.9-15l-3.9-3.5 4.6 1.1-0.31-5.1 3 4.3c1.4-0.94 3-1.5 4.7-1.5 7.6-3e-5 17 2.2 15 18-0.78 7.3 3.4 21 5.5 26z"}getShadowPath(){return"m 11,41.5 c -0.91,2.4 -1.4,4.5 -0.87,7.7 -10,-7.6 -9.2,-13 -8.6,-27 0.23,-5.5 2,-11 4.9,-15 l -3.9,-3.5 4.6,1.1 -0.31,-5.1 3,4.3 c 1.4,-0.94 3,-1.5 4.7,-1.5 5.082539,-2.01e-5 10.970099,0.9839003 13.714695,6.3613568 C 17.092777,5.8487082 12.78185,7.0442861 9.401666,11.909225 3.6797857,20.144459 5.0268758,37.560233 11,41.5 Z"}moveTowardHero(t){var t=t.sprite.x+t.sprite.width/2,e=this.sprite.x+this.sprite.width/2;let i=0;e<t?i=this.slideSpeed:t<e&&(i=-1*this.slideSpeed),this.sprite.x+=i}},class extends T{constructor(...t){super(...t),this.teleported=!1,this.eyesTop=21,this.eyesLeft=11,this.eyesGap=10,this.smokeLeft=0,this.smokeTransition=[],this.smokeTransitionSteps=30;t=Math.min(300,window.gameCanvas.height/2);this.threshold=t*(1+.2*(this.verticalSpeed-2));const e=this.createSmokeSprite.bind(this);this.smoke=l({x:100,y:100,width:this.width,height:this.height,render:function(){e(this.context)}})}render(){this.teleported&&0<this.smokeTransition.length&&this.renderSmoke(),super.render()}fall(t){window.gameCanvas.height-this.sprite.y<this.threshold&&!this.teleported&&this.teleport(t),super.fall(t)}getImagePath(){return"m 5.1,22 c -3.2,4.86 -5.7,11 -4.2,13 1.6,1.6 3.1,-4.2 4.4,-3.4 1.5,0.94 -0.97,12 3.4,16 6.2,5.3 4.5,-5.4 7,-1.4 5.5,8.9 4.2,-0.54 6.3,-0.81 2.5,-0.33 2.8,8.3 5.5,-1.9 1.9,-6.9 -3.4,-16 2.4,-11 1.1,0.93 5.4,2.7 4.5,-0.038 -1.5,-4.3 -7,-5.7 -8.3,-9.1 -1.7,-4.5 -1.4,-8.2 -4.4,-10 -3.7,-2.8 -11,-1.3 -7.8,-7.1 0.92,-1.6 2.9,-2.7 4.8,-1.8 2,0.93 1.7,3.8 -2.8,2.8 1.1,3.3 4.8,3.2 6.8,0.25 3.3,-4.7 -3.5,-8.5 -9.4,-5.4 -4.7,2.5 -6,5.6 -6.7,8.7 C 6.2,14 6.3,20 5.1,22 Z"}getShadowPath(){return"m 5.1,22 c -3.2,4.86 -5.7,11 -4.2,13 1.6,1.6 3.1,-4.2 4.4,-3.4 1.5,0.94 -0.97,12 3.4,16 2,1.7 3,1.7 4,1.2 C 7,5 9,34 8.5,28 8,17 10,9 13.3,2.1 c -4.7,2.5 -6,5.6 -6.7,8.7 C 6.2,14 6.3,20 5.1,22 Z"}teleport(t){var t=t.sprite.x+t.sprite.width/2-this.sprite.width/2,e=window.gameCanvas.width-this.sprite.width;this.createSmokeTransition(),this.sprite.x=Math.min(Math.max(0,t),e),this.teleported=!0}createSmokeSprite(t){this.setScale(t);var e=new Path2D(this.getImagePath());t.filter=this.smokeBlur,t.fillStyle=this.smokeColor,t.fill(e)}createSmokeTransition(){this.smokeLeft=this.sprite.x,this.smokeTransition=A(this.smokeTransitionSteps)}renderSmoke(){this.smoke.x=this.smokeLeft,this.smoke.y=this.sprite.y;var t=this.smokeTransition.splice(0,1)[0],t=(this.smokeTransitionSteps-t)/this.smokeTransitionSteps,e=6/t;this.smokeColor=`rgba(0, 0, 0, ${t/2})`,this.smokeBlur=`blur(${e}px)`,this.smoke.render()}}]];function*n2({count:e,levelDistribution:t,monstersByLevel:i=r2,getRandomNumber:s=Math.random}){var r=function(e,i){const s=[];let r=0;for(let t=0;t<i.length;t++)for(const h of i[t]){var n=e[t]/i[t].length;r=n+r,s.push([h,r])}return s}(t,i);for(let t=0;t<e;t++)yield function(t,e){var i=100*e();for(const n of t){var[s,r]=n;if(i<=r)return s}throw new Error("Unexpected distribution")}(r,s)}class h2{constructor({language:t,speed:e,frequency:i,monsterCount:s,monsterLevelDistribution:r}){this.bindedSpawnMonster=this.spawnMonster.bind(this),this.bindedDestroyMonster=this.destroyMonster.bind(this),this.language=t,this.speed=e,this.frequency=i,this.monsterCount=s,this.monsterLevelDistribution=r,this.isAccomplished=!1,this.background=new X(this.language),this.monsters=[],window.instructionsLib.toggle({onDone:()=>{window.flashLib.write({text:_[this.language]+" Hell",timeInSeconds:2,onDone:()=>this.initializeMonsterGenerator()})}}),this.attachEventListeners()}render(){this.background.render(),this.monsters.forEach(t=>t.render())}update(e){this.background.update(),this.monsters.forEach(t=>{t.fall(e),e.killOnCollide(t)})}destroy(){this.removeEventListeners()}attachEventListeners(){r("callNextMonster",this.bindedSpawnMonster),r("destroyMonster",this.bindedDestroyMonster)}removeEventListeners(){t("callNextMonster",this.bindedSpawnMonster),t("destroyMonster",this.bindedDestroyMonster)}initializeMonsterGenerator(){this.monsterTypeGenerator=n2({count:this.monsterCount,levelDistribution:this.monsterLevelDistribution}),this.monsters=[],this.spawnMonster()}spawnMonster(){const{value:t,done:e}=this.monsterTypeGenerator.next();!1===e?this.monsters.unshift(new t({speed:this.speed,frequency:this.frequency})):this.isAccomplished=!0}destroyMonster(){this.monsters.pop(),this.isAccomplished&&w("levelAccomplished")}}class o2{constructor(){this.bindedFinishLevel=this.finishLevel.bind(this),this.levelParamsGenerator=K(),this.addEventListeners(),this.advanceLevel()}render(){this.level.render()}update(t){this.level.update(t)}destroy(){this.level.destroy(),this.removeEventListeners()}addEventListeners(){r("levelAccomplished",this.bindedFinishLevel)}removeEventListeners(){t("levelAccomplished",this.bindedFinishLevel)}finishLevel(){this.level.destroy(),this.advanceLevel()}advanceLevel(){var{value:t,done:e}=this.levelParamsGenerator.next();!1===e?this.level=new h2(t):w("gameComplete")}}class a2{constructor(){var t=window.gameCanvas.width/2,e=window.gameCanvas.height;this.leftArea=l({x:0,y:0,width:t,height:e}),this.rightArea=l({x:t,y:0,width:t,height:e}),[this.leftArea,this.rightArea].flat().map(t=>{var e=t.context?t.context.canvas:n;let i=c.get(e);if(!i)throw new ReferenceError("Pointer events not initialized for the objects canvas");t._r||(t._r=t.render,t.render=function(){i._cf.push(this),this._r()},i._o.push(t))})}render(){this.leftArea.render(),this.rightArea.render()}update(){u.left&&(b(this.leftArea)?w("heroMoved",-1):b(this.rightArea)&&w("heroMoved",1)),F.arrowleft&&w("heroMoved",-1),F.arrowright&&w("heroMoved",1)}}let O=!1;function l2(){if(!O){O=!0;{const s=new window.AudioContext,r=s.createGain();r.connect(s.destination),r.gain.value=1,[22,25,22].forEach((t,e)=>{const i=s.createOscillator();i.type="sawtooth",i.start(.1*e),i.frequency.setValueAtTime(440*1.06**(13-t),.1*e),r.gain.setValueAtTime(1,.1*e),r.gain.setTargetAtTime(1e-4,.1*e+.08,.005),i.stop(.1*e+.09),i.connect(r)})}setTimeout(()=>{O=!1},[500])}}class d2{constructor(){this.width=50,this.height=100,this.speed=3,this.isColliding=!1,this.collisionAnimationTimeout=null,this.bindedHandleHeroMoved=this.handleHeroMoved.bind(this),this.createSprites(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){r("heroMoved",this.bindedHandleHeroMoved)}removeEventListeners(){t("heroMoved",this.bindedHandleHeroMoved)}createSprites(){this.spriteSheet=function(){return new q(...arguments)}({image:this.image(),frameWidth:this.width,frameHeight:this.height,animations:{default:{frames:[0]},flash:{frames:[0,1],frameRate:10}}}),this.sprite=l({x:(window.gameCanvas.width-this.width)/2,y:window.gameCanvas.height-this.height-30,width:this.width,height:this.height,anchor:{x:0,y:0},spriteSheet:this.spriteSheet,animations:this.spriteSheet.animations})}image(){const t=new Image(this.height,this.width);return t.src="data:image/svg+xml,%3Csvg%20width%3D%22100%22%20height%3D%22100%22%20version%3D%221.1%22%20viewBox%3D%220%200%2026.5%2026.5%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cdefs%3E%3CclipPath%20id%3D%22clipPath74204%22%3E%3Cpath%20d%3D%22m59.4%2061.1c-3.74%205.19-4.93%205.37-3.27%2021.6h6.55c1.66-16.2%200.462-16.4-3.27-21.6z%22%20fill%3D%22%23f0f%22%2F%3E%3C%2FclipPath%3E%3CclipPath%20id%3D%22clipPath52457-2%22%3E%3Crect%20x%3D%2227.2%22%20y%3D%2295.9%22%20width%3D%225.29%22%20height%3D%22.974%22%20fill%3D%22%23f0f%22%2F%3E%3C%2FclipPath%3E%3C%2Fdefs%3E%3Cg%20transform%3D%22translate%28-33.9%20-66.5%29%22%3E%3Cg%20transform%3D%22matrix%281.67%200%200%201.67%20-22.6%20-44.4%29%22%3E%3Cpath%20d%3D%22m37.9%2066.5c-3.7%203.82-4.89%203.96-3.24%2015.9h6.49c1.64-11.9%200.458-12.1-3.24-15.9z%22%20fill%3D%22%23d88f48%22%2F%3E%3Cpath%20d%3D%22m37.9%2067.4c-3.11%203.42-4.1%203.54-2.72%2014.2h5.44c1.38-10.7%200.385-10.8-2.72-14.2z%22%20fill%3D%22%239d480f%22%2F%3E%3Cg%20transform%3D%22matrix%28.832%200%200%20.66%20-11.6%2027.1%29%22%20clip-path%3D%22url%28%23clipPath74204%29%22%20stroke-width%3D%221.35%22%3E%3Cg%20fill%3D%22%237e3208%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22bevel%22%20stroke-width%3D%22.493%22%3E%3Crect%20x%3D%2256.1%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2257.1%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2258.2%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2259.2%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2260.3%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2261.3%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2262.4%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3C%2Fg%3E%3Crect%20x%3D%2255.2%22%20y%3D%2269.5%22%20width%3D%228.47%22%20height%3D%221.88%22%20fill%3D%22%23d88f48%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3Cg%20transform%3D%22matrix%281.67%200%200%201.67%20-9.37%20-44.4%29%22%3E%3Cpath%20d%3D%22m37.9%2066.5c-3.7%203.82-4.89%203.96-3.24%2015.9h6.49c1.64-11.9%200.458-12.1-3.24-15.9z%22%20fill%3D%22%23ccc%22%2F%3E%3Cpath%20d%3D%22m37.9%2067.4c-3.11%203.42-4.1%203.54-2.72%2014.2h5.44c1.38-10.7%200.385-10.8-2.72-14.2z%22%20fill%3D%22%23999%22%2F%3E%3Cg%20transform%3D%22matrix%28.832%200%200%20.66%20-11.6%2027.1%29%22%20clip-path%3D%22url%28%23clipPath74204%29%22%20stroke-width%3D%221.35%22%3E%3Cg%20fill%3D%22%23808080%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22bevel%22%20stroke-width%3D%22.493%22%3E%3Crect%20x%3D%2256.1%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2257.1%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2258.2%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2259.2%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2260.3%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2261.3%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3Crect%20x%3D%2262.4%22%20y%3D%2260.9%22%20width%3D%22.319%22%20height%3D%2222.6%22%2F%3E%3C%2Fg%3E%3Crect%20x%3D%2255.2%22%20y%3D%2269.5%22%20width%3D%228.47%22%20height%3D%221.88%22%20fill%3D%22%23ccc%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3Cg%20transform%3D%22matrix%281.43%200%200%201.43%20-14.5%20-28.6%29%22%3E%3Cg%20transform%3D%22matrix%28.888%200%200%20.879%2010.6%20-12.1%29%22%3E%3Cg%20fill%3D%22%237a99ec%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%22.3%22%3E%3Cellipse%20cx%3D%2229.8%22%20cy%3D%2298.4%22%20rx%3D%223.13%22%20ry%3D%223.1%22%2F%3E%3Cpath%20d%3D%22m32.3%20100-1.74%202.26-1.3-2.12%22%2F%3E%3Cpath%20d%3D%22m30.4%20100-1.59%203.5-1.71-3.71%22%2F%3E%3C%2Fg%3E%3Crect%20x%3D%2226.8%22%20y%3D%2297.2%22%20width%3D%221.02%22%20height%3D%222.47%22%20fill%3D%22%23292935%22%2F%3E%3Crect%20x%3D%2231.8%22%20y%3D%2297.2%22%20width%3D%221.02%22%20height%3D%222.47%22%20fill%3D%22%23292935%22%2F%3E%3Cpath%20d%3D%22m28.3%2095.7c-0.208-0.643-0.102-0.871%200.481-0.852l0.97-1.61%200.941%201.61c0.578-0.0454%200.642%200.523%200.484%200.869%22%20fill%3D%22%23585858%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%22.3%22%2F%3E%3Cg%20transform%3D%22matrix%281%200%200%201.1%200%20-9.82%29%22%20clip-path%3D%22url%28%23clipPath52457-2%29%22%20fill%3D%22%23f5fbef%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%22.0953%22%3E%3Cellipse%20cx%3D%2228.8%22%20cy%3D%2296.6%22%20rx%3D%221.01%22%20ry%3D%22.529%22%2F%3E%3Cellipse%20cx%3D%2230.8%22%20cy%3D%2296.6%22%20rx%3D%221.01%22%20ry%3D%22.529%22%2F%3E%3C%2Fg%3E%3Cpath%20d%3D%22m27.8%2097.1h3.97%22%20fill%3D%22none%22%20stroke%3D%22%23292935%22%20stroke-width%3D%22.1%22%2F%3E%3Cellipse%20cx%3D%2228.9%22%20cy%3D%2296.5%22%20rx%3D%22.151%22%20ry%3D%22.11%22%20fill%3D%22%23292935%22%2F%3E%3Cellipse%20cx%3D%2230.7%22%20cy%3D%2296.5%22%20rx%3D%22.151%22%20ry%3D%22.11%22%20fill%3D%22%23292935%22%2F%3E%3C%2Fg%3E%3Cg%20transform%3D%22matrix%281.34%200%200%201.34%2014.3%20-40.5%29%22%3E%3Cellipse%20cx%3D%2219.1%22%20cy%3D%2290.6%22%20rx%3D%222.07%22%20ry%3D%222.05%22%20fill%3D%22%238f764d%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%22.198%22%2F%3E%3Cg%20transform%3D%22matrix%28.661%200%200%20.728%20-.582%2019.1%29%22%20stroke-width%3D%22.953%22%3E%3Cg%20transform%3D%22translate%28-1.98%29%22%20fill%3D%22%23f5fbef%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%22.164%22%3E%3Cellipse%20cx%3D%2232.7%22%20cy%3D%2296.6%22%20rx%3D%22.898%22%20ry%3D%22.533%22%2F%3E%3Cellipse%20cx%3D%2230.8%22%20cy%3D%2296.6%22%20rx%3D%22.898%22%20ry%3D%22.533%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3Cellipse%20cx%3D%2218.4%22%20cy%3D%2289.4%22%20rx%3D%22.0996%22%20ry%3D%22.0723%22%20fill%3D%22%23292935%22%2F%3E%3Cellipse%20cx%3D%2219.7%22%20cy%3D%2289.4%22%20rx%3D%22.0996%22%20ry%3D%22.0723%22%20fill%3D%22%23292935%22%2F%3E%3Cpath%20d%3D%22m18.1%2088.9c-0.14-0.588%200.589-0.879%201.12-1.33%200.459%200.509%201.03%200.594%200.965%201.33%22%20fill%3D%22%238f764d%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%22.183%22%2F%3E%3Cellipse%20cx%3D%2219.1%22%20cy%3D%2287.9%22%20rx%3D%22.589%22%20ry%3D%22.544%22%20fill%3D%22%23292935%22%2F%3E%3Cpath%20d%3D%22m18.9%2091.1s-0.62-0.143-0.674%200.584c-0.0281%200.385%200.984%200.28%201.65%200.238%200.525-0.0335%201.33-0.0058%201.09%200.939-0.138%200.56-0.82%200.292-1.32%200.0865-0.363-0.149-1.96-0.209-2.48-0.91-0.375-0.511%200.491-1.45%201.41-1.46%22%20fill%3D%22%238f764d%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%22.15%22%2F%3E%3Cg%20fill%3D%22%23292935%22%3E%3Crect%20transform%3D%22rotate%284.61%29%22%20x%3D%2226.4%22%20y%3D%2290.1%22%20width%3D%22.485%22%20height%3D%22.939%22%2F%3E%3Crect%20transform%3D%22matrix%28.91%20.415%20-.325%20.946%200%200%29%22%20x%3D%2247.3%22%20y%3D%2276.2%22%20width%3D%22.414%22%20height%3D%22.89%22%2F%3E%3Crect%20transform%3D%22matrix%28.967%20.257%20-.111%20.994%200%200%29%22%20x%3D%2230.4%22%20y%3D%2284.6%22%20width%3D%22.498%22%20height%3D%221.22%22%2F%3E%3C%2Fg%3E%3Cpath%20d%3D%22m20.6%2090.4s-0.12%200.63-0.347%200.679c-0.227%200.0488-0.262-0.406-0.422-0.409-0.16-0.0032-0.189%200.662-0.41%200.594-0.221-0.0681-0.286-0.834-0.286-0.834%22%20fill%3D%22%238f764d%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%22.15%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3Cg%20transform%3D%22matrix%281.43%200%200%201.43%20-1.25%20-28.6%29%22%3E%3Cg%20transform%3D%22matrix%28.888%200%200%20.879%2010.6%20-12.1%29%22%3E%3Cg%20fill%3D%22%237a99ec%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%22.3%22%3E%3Cellipse%20cx%3D%2229.8%22%20cy%3D%2298.4%22%20rx%3D%223.13%22%20ry%3D%223.1%22%2F%3E%3Cpath%20d%3D%22m32.3%20100-1.74%202.26-1.3-2.12%22%2F%3E%3Cpath%20d%3D%22m30.4%20100-1.59%203.5-1.71-3.71%22%2F%3E%3C%2Fg%3E%3Crect%20x%3D%2226.8%22%20y%3D%2297.2%22%20width%3D%221.02%22%20height%3D%222.47%22%20fill%3D%22%23292935%22%2F%3E%3Crect%20x%3D%2231.8%22%20y%3D%2297.2%22%20width%3D%221.02%22%20height%3D%222.47%22%20fill%3D%22%23292935%22%2F%3E%3Cpath%20d%3D%22m28.3%2095.7c-0.208-0.643-0.102-0.871%200.481-0.852l0.97-1.61%200.941%201.61c0.578-0.0454%200.642%200.523%200.484%200.869%22%20fill%3D%22%23585858%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%22.3%22%2F%3E%3Cg%20transform%3D%22matrix%281%200%200%201.1%200%20-9.82%29%22%20clip-path%3D%22url%28%23clipPath52457-2%29%22%20fill%3D%22%23f5fbef%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%22.0953%22%3E%3Cellipse%20cx%3D%2228.8%22%20cy%3D%2296.6%22%20rx%3D%221.01%22%20ry%3D%22.529%22%2F%3E%3Cellipse%20cx%3D%2230.8%22%20cy%3D%2296.6%22%20rx%3D%221.01%22%20ry%3D%22.529%22%2F%3E%3C%2Fg%3E%3Cpath%20d%3D%22m27.8%2097.1h3.97%22%20fill%3D%22none%22%20stroke%3D%22%23292935%22%20stroke-width%3D%22.1%22%2F%3E%3Cellipse%20cx%3D%2228.9%22%20cy%3D%2296.5%22%20rx%3D%22.151%22%20ry%3D%22.11%22%20fill%3D%22%23292935%22%2F%3E%3Cellipse%20cx%3D%2230.7%22%20cy%3D%2296.5%22%20rx%3D%22.151%22%20ry%3D%22.11%22%20fill%3D%22%23292935%22%2F%3E%3C%2Fg%3E%3Cg%20transform%3D%22matrix%281.34%200%200%201.34%2014.3%20-40.5%29%22%3E%3Cellipse%20cx%3D%2219.1%22%20cy%3D%2290.6%22%20rx%3D%222.07%22%20ry%3D%222.05%22%20fill%3D%22%238f764d%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%22.198%22%2F%3E%3Cg%20transform%3D%22matrix%28.661%200%200%20.728%20-.582%2019.1%29%22%20stroke-width%3D%22.953%22%3E%3Cg%20transform%3D%22translate%28-1.98%29%22%20fill%3D%22%23f5fbef%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-width%3D%22.164%22%3E%3Cellipse%20cx%3D%2232.7%22%20cy%3D%2296.6%22%20rx%3D%22.898%22%20ry%3D%22.533%22%2F%3E%3Cellipse%20cx%3D%2230.8%22%20cy%3D%2296.6%22%20rx%3D%22.898%22%20ry%3D%22.533%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3Cellipse%20cx%3D%2218.4%22%20cy%3D%2289.4%22%20rx%3D%22.0996%22%20ry%3D%22.0723%22%20fill%3D%22%23292935%22%2F%3E%3Cellipse%20cx%3D%2219.7%22%20cy%3D%2289.4%22%20rx%3D%22.0996%22%20ry%3D%22.0723%22%20fill%3D%22%23292935%22%2F%3E%3Cpath%20d%3D%22m18.1%2088.9c-0.14-0.588%200.589-0.879%201.12-1.33%200.459%200.509%201.03%200.594%200.965%201.33%22%20fill%3D%22%238f764d%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%22.183%22%2F%3E%3Cellipse%20cx%3D%2219.1%22%20cy%3D%2287.9%22%20rx%3D%22.589%22%20ry%3D%22.544%22%20fill%3D%22%23292935%22%2F%3E%3Cpath%20d%3D%22m18.9%2091.1s-0.62-0.143-0.674%200.584c-0.0281%200.385%200.984%200.28%201.65%200.238%200.525-0.0335%201.33-0.0058%201.09%200.939-0.138%200.56-0.82%200.292-1.32%200.0865-0.363-0.149-1.96-0.209-2.48-0.91-0.375-0.511%200.491-1.45%201.41-1.46%22%20fill%3D%22%238f764d%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%22.15%22%2F%3E%3Cg%20fill%3D%22%23292935%22%3E%3Crect%20transform%3D%22rotate%284.61%29%22%20x%3D%2226.4%22%20y%3D%2290.1%22%20width%3D%22.485%22%20height%3D%22.939%22%2F%3E%3Crect%20transform%3D%22matrix%28.91%20.415%20-.325%20.946%200%200%29%22%20x%3D%2247.3%22%20y%3D%2276.2%22%20width%3D%22.414%22%20height%3D%22.89%22%2F%3E%3Crect%20transform%3D%22matrix%28.967%20.257%20-.111%20.994%200%200%29%22%20x%3D%2230.4%22%20y%3D%2284.6%22%20width%3D%22.498%22%20height%3D%221.22%22%2F%3E%3C%2Fg%3E%3Cpath%20d%3D%22m20.6%2090.4s-0.12%200.63-0.347%200.679c-0.227%200.0488-0.262-0.406-0.422-0.409-0.16-0.0032-0.189%200.662-0.41%200.594-0.221-0.0681-0.286-0.834-0.286-0.834%22%20fill%3D%22%238f764d%22%20stroke%3D%22%23292935%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20stroke-width%3D%22.15%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E",t}render(){this.sprite.render()}update(){this.sprite.update(),null!=this.collisionAnimationTimeout&&0!==this.collisionAnimationTimeout?this.collisionAnimationTimeout--:0===this.collisionAnimationTimeout&&(this.collisionAnimationTimeout=null,this.sprite.playAnimation("default"),w("killed",this))}killOnCollide(t){var e;e=this.sprite,t=t.sprite,[e,t]=[e,t].map(t=>a(t)),e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y?this.isColliding||(this.isColliding=!0,this.collisionAnimationTimeout=30,this.sprite.playAnimation("flash"),l2()):this.isColliding=!1}handleHeroMoved(t){1===t?this.moveRight():this.moveLeft()}moveLeft(){var t=this.sprite.x-this.speed;0<=t&&(this.sprite.x=t)}moveRight(){var t=this.sprite.x+this.speed;t<=window.gameCanvas.width-this.sprite.width&&(this.sprite.x=t)}}class c2{constructor(){this.lifesCount=3,this.bindedDiscountLife=this.discountLife.bind(this),this.attachEventListeners(),this.createSprites()}render(){this.sprites.map(t=>t.render())}update(){this.sprites.forEach((t,e)=>{e<this.lifesCount?t.fillColor="rgba(255, 0, 0, 1)":t.fillColor="rgba(255, 0, 0, 0.3)"})}destroy(){this.removeEventListeners()}attachEventListeners(){r("killed",this.bindedDiscountLife)}removeEventListeners(){t("killed",this.bindedDiscountLife)}createSprites(){this.sprites=Array(3).fill(null).map((t,e)=>l({x:5*(e+1)+16*e,y:window.gameCanvas.height-16-5,width:16,height:16,render:function(){var t=new Path2D(u2);this.context.fillStyle=this.fillColor,this.context.filter="drop-shadow(2px 2px 3px rgba(0, 0, 0, 1))",this.context.fill(t)}}))}discountLife(){this.lifesCount--,0===this.lifesCount&&w("gameOver")}}const u2=`
  M 2.57,0.10 C -0.12,0.65 -0.16,3.80 0.118,5.86 0.66,10.10 4.04,13.51
  8.00,16 11.97,13.501 15.34,10.10 15.89,5.86 16.16,3.79 16.12,0.65
  13.43,0.10 11.06,-0.38 9.37,0.96 8.00,3.32 6.38,0.89 5.00,-0.38 2.57,0.10 Z
`;window.gameCanvas=function(){var t,e=function(){const t=document.getElementById("game");document.documentElement.clientHeight>document.documentElement.clientWidth&&t.parentNode.classList.add("full");const e=document.createElement("canvas");return e.setAttribute("width",String(t.offsetWidth)),e.setAttribute("height",String(t.offsetHeight)),t.appendChild(e),e}(),[i,{contextless:s=!1}={}]=[e];if(n=document.getElementById(i)||i||document.querySelector("canvas"),!(n=s?n||new Proxy({},h):n))throw Error("You must provide a canvas element for the game");(y=n.getContext("2d")||new Proxy({},h)).imageSmoothingEnabled=!1,w("init"),n,y;{let t;for(t=0;t<26;t++)P["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)P["Digit"+t]=P["Numpad"+t]=""+t;window.addEventListener("keydown",j),window.addEventListener("keyup",z),window.addEventListener("blur",Y)}{var[{radius:i=5,canvas:s=n}={}]=[];let e=c.get(s);e||(t=window.getComputedStyle(s),e={x:0,y:0,radius:i,touches:{length:0},canvas:s,_cf:[],_lf:[],_o:[],_oo:null,_s:t},c.set(s,e)),s.addEventListener("mousedown",f),s.addEventListener("touchstart",f),s.addEventListener("mouseup",v),s.addEventListener("touchend",v),s.addEventListener("touchcancel",v),s.addEventListener("blur",G),s.addEventListener("mousemove",C),s.addEventListener("touchmove",C),e._t||(e._t=!0,r("tick",()=>{e._lf.length=0,e._cf.map(t=>{e._lf.push(t)}),e._cf.length=0})),e}return e}(),window.flashLib=new class{constructor(){this.container=document.getElementById("flash")}write({text:t,timeInSeconds:e,onDone:i}){this.container.style.transition=`opacity ${e}s`,this.container.innerText=t,this.container.style.opacity="1",setTimeout(()=>{this.container.style.opacity="0"},e/2*1e3),setTimeout(()=>{i()},1e3*e)}},window.instructionsLib=new class{constructor(){this.timeoutInSeconds=650,this.staleTimeInSeconds=2e3,this.timeoutIds=[],this.hasBeenShown=!1,this.hasBeenShownKey="DanteDevHell-Instructions",this.container=document.getElementById("instructions"),this.container.style.transition=`opacity ${this.timeoutInSeconds}ms`,this.hasBeenShown=this.getHasBeenShownFromStorage()}getHasBeenShownFromStorage(){return Boolean(window.localStorage.getItem(this.hasBeenShownKey))}toggle({onDone:t}){this.hasBeenShown?t():this.toggleAnimation(t)}reset(){this.timeoutIds.forEach(t=>clearTimeout(t)),this.removeInstructions()}toggleAnimation(t){this.addInstructions("left"),this.timeoutIds.push(setTimeout(()=>{this.addInstructions("right")},this.timeoutInSeconds+this.staleTimeInSeconds)),this.timeoutIds.push(setTimeout(()=>{this.hasBeenShown=!0,this.storeHasBeenShown(),t()},2*this.timeoutInSeconds+2*this.staleTimeInSeconds))}storeHasBeenShown(){window.localStorage.setItem(this.hasBeenShownKey,"true")}addInstructions(t){this.container.appendChild(this.getContent(t)),this.container.style.opacity="1",this.timeoutIds.push(setTimeout(()=>{this.container.style.opacity="0"},this.staleTimeInSeconds)),this.timeoutIds.push(setTimeout(()=>{this.container.innerHTML=""},this.staleTimeInSeconds+this.timeoutInSeconds))}removeInstructions(){this.container.style.opacity="0",this.container.innerHTML=""}getContent(t){const e=document.createElement("div");return e.innerText=`Click/Tap anywhere ${t} or use ${t} arrow to move `+t,e.style.gridArea=t,e}};const m2=new class{constructor(){this.gameStatus=L.Stop}init(){this.screen=new W;const t=function({fps:t=60,clearCanvas:e=!0,update:i=g,render:s,context:r=y,blur:n=!1}){if(!s)throw Error("You must provide a render() function");let h=0,o=1e3/t,a=1/t,l=e?B:g,d,c,u,m,p,D=!0;function f(){if(c=requestAnimationFrame(f),D&&(u=performance.now(),m=u-d,d=u,!(1e3<m))){for(w("tick"),h+=m;h>=o;)p.update(a),h-=o;l(r),p.render()}}return n||(window.addEventListener("focus",()=>{D=!0}),window.addEventListener("blur",()=>{D=!1})),p={update:i,render:s,isStopped:!0,start(){d=performance.now(),this.isStopped=!1,requestAnimationFrame(f)},stop(){this.isStopped=!0,cancelAnimationFrame(c)},_frame:f,set _last(t){d=t}}}({update:this.update.bind(this),render:this.render.bind(this)});t.start(),this.attachEventListeners()}render(){this.screen.render(this.gameStatus),this.gameStatus!==L.Play&&this.gameStatus!==L.Pause||this.renderGameObjects()}renderGameObjects(){this.levels.render(),this.movementDetector.render(),this.hero.render(),this.lifes.render()}update(){this.gameStatus===L.Play&&this.updateGameObjects()}updateGameObjects(){this.movementDetector.update(),this.hero.update(),this.levels.update(this.hero),this.lifes.update()}attachEventListeners(){var t,e;t="down",e=this.begin.bind(this),t=t[0].toUpperCase()+t.substr(1),d["on"+t]=e,J("space",this.playPauseGame.bind(this)),J("esc",this.stopGame.bind(this)),r("gameOver",this.gameOver.bind(this)),r("gameComplete",this.completeGame.bind(this))}begin(){this.gameStatus!==L.Play&&this.gameStatus!==L.Pause&&this.playPauseGame()}playPauseGame(){this.gameStatus===L.Play?this.gameStatus=L.Pause:(this.gameStatus!==L.Pause&&this.reinitializeObjects(),this.gameStatus=L.Play)}reinitializeObjects(){this.levels&&this.levels.destroy(),this.hero&&this.hero.destroy(),this.lifes&&this.lifes.destroy(),this.movementDetector=new a2,this.levels=new o2,this.hero=new d2,this.lifes=new c2}stopGame(){this.gameStatus=L.Stop,window.instructionsLib.reset()}gameOver(){this.gameStatus=L.GameOver}completeGame(){this.gameStatus=L.Complete}};m2.init()}();
