!function(e){function t(e){if(c){if(s+l>e)return void (n=d(t));for(i+=e-s,s=e,e>u+1e3&&(o=.25*a+.75*o,u=e,a=0),a++,f=0;i>=r;)if(g(r),i-=r,++f>=240){p=!0;break}y(i/r),p=!1,n=d(t)}}var n,r=1e3/60,i=0,s=0,o=60,u=0,a=0,f=0,l=0,c=!1,h=!1,p=!1,d=e.requestAnimationFrame||function(){var e,t,n=Date.now();return function(i){return e=Date.now(),t=Math.max(0,r-(e-n)),n=e+t,setTimeout(function(){i(e+t)},t)}}(),v=e.cancelAnimationFrame||clearTimeout,m=function(){},g=m,y=m;e.MainLoop={resetFrameDelta:function(){var e=i;return i=0,e},setUpdate:function(e){return g=e||g,this},setDraw:function(e){return y=e||y,this},start:function(){return h||(h=!0,n=d(function(e){y(1),c=!0,s=e,u=e,a=0,n=d(t)})),this},stop:function(){return c=!1,h=!1,v(n),this}},"function"==typeof define&&define.amd?define(e.MainLoop):"object"==typeof exports&&(module.exports=e.MainLoop)}(this);