!function(){function t(l){c||(c=l),dt=Math.min(100,l-c),c=l,S++,requestAnimationFrame(t),e(l,dt,S)}function e(t,e,c){var S=o;M.clearRect(0,0,u,E),M.fillStyle="#333",l(0,0,u,E,5),M.fillStyle="#6c977f",M.fillRect(14,44,612,422),M.fillStyle="#92bfa0";for(g=44;g<466;g+=3)M.fillRect(14,g,612,1);M.font="12px 'Courier New', Courier, monospace";for(var h,A=448,d=s.length-1;d>=0&&!(A<=45);d--)switch((h=s[d])[0]){case MESSAGE_THEM:case MESSAGE_US:var I=n(h[1]),_=h[1].length;M.fillStyle="#25372c",l(h[0]===MESSAGE_US?594-I:24,A-20*_,I+20,10+20*_,5),M.fillStyle="#a1d2af";for(g=0;g<_;g++)M.fillText(h[1][_-g-1],h[0]===MESSAGE_US?603-I:34,A-20*g-1);A-=20+20*_;break;case MESSAGE_TYPING:M.fillStyle="#25372c",l(24,A-20,60,30,5),M.fillStyle="rgba(146,191,160,"+Math.sin(t%1200/1200*Math.PI)+")",i(40,A-5,4),M.fillStyle="rgba(146,191,160,"+Math.sin((t-100)%1200/1200*Math.PI)+")",i(53,A-5,4),M.fillStyle="rgba(146,191,160,"+Math.sin((t-200)%1200/1200*Math.PI)+")",i(66,A-5,4),A-=40;break;case MESSAGE_SYSTEM:var N=(640-(I=n([h[1]])+28))/2;M.fillStyle="#25372c",l(N+1,A-11,I,18,5),M.fillStyle="#92bfa0",l(N,A-12,I,18,5),M.fillStyle="#25372c",M.fillText(h[1],N+14,A-0),A-=36;break;case MESSAGE_OPTION:for(var _=h[1].length,g=0;g<_;g++){var I=n([h[1][_-g-1][0]]),p=MX>=594-I&&MX<=613&&MY>=A-32*g-20&&MY<=A-32*g+10;p&&(ES===a&&EX>=594-I&&EX<=613&&EY>=A-32*g-20&&EY<=A-32*g+10&&(ES=f,EX=0,EY=0,s.pop(),O[ACTION_GROUP](T[h[1][_-g-1][1]])),S=r),M.fillStyle=p?"#ff0000":"#D4A497",l(594-I,A-32*g-20,I+20,30,5),M.fillStyle="#25372c",M.fillText(h[1][_-g-1][0],603-I,A-32*g-1)}A-=9+32*_}M.fillStyle="#333",M.fillRect(14,0,612,44),M.fillStyle="#223",M.fillRect(14,41,615,3),M.fillRect(11,41,3,428),M.fillStyle="#445",M.fillRect(14,466,615,3),M.fillRect(626,44,3,422);var P=M.createLinearGradient(0,40,0,300);P.addColorStop(0,"rgba(30,41,33,0.48)"),P.addColorStop(.27,"rgba(60,81,67,0.37)"),P.addColorStop(1,"rgba(60,81,67,0.0)"),M.fillStyle=P,M.fillRect(14,44,612,251),M.fillStyle="#ffce45",i(18,24,4),i(33,24,4),i(48,24,4),M.font="14px 'Courier New', Courier, monospace",M.fillStyle="#000",M.fillText("P.A.L",301,28),M.fillStyle="#ddd",M.fillText("P.A.L",299,27),M.font="10px 'Courier New', Courier, monospace",M.fillStyle="#000",M.fillText("v0.27 alpha",557,27),M.fillStyle="#bbb",M.fillText("v0.27 alpha",556,26),C.style.cursor=S}function l(t,e,l,i,n){M.beginPath(),M.moveTo(t+n,e),M.lineTo(t+l-n,e),M.quadraticCurveTo(t+l,e,t+l,e+n),M.lineTo(t+l,e+i-n),M.quadraticCurveTo(t+l,e+i,t+l-n,e+i),M.lineTo(t+n,e+i),M.quadraticCurveTo(t,e+i,t,e+i-n),M.lineTo(t,e+n),M.quadraticCurveTo(t,e,t+n,e),M.closePath(),M.fill()}function i(t,e,l){M.beginPath(),M.arc(t,e,l,0,PI2),M.fill()}function n(t){for(var e,l=0,i=t.length,n=0;l<i;l++)(e=M.measureText(t[l])).width>n&&(n=e.width);return n}var o="default",r="pointer",f="n",a="c";MESSAGE_THEM=0,MESSAGE_US=1,MESSAGE_TYPING=2,MESSAGE_OPTION=3,MESSAGE_SYSTEM=4,ACTION_ACTION=0,ACTION_GROUP=1,ACTION_TEXT=2,ACTION_TEXTFN=3,ACTION_PAUSE=4,ACTION_GOTO=5,ACTION_EXEC=6,ACTION_PROMPT=7,ACTION_SYSTEM=8,ACTION_TYPING=9,ACTION_SPEAK=10,ACTION_SETVAR=11,ACTION_IFVAR=12;var c,S=-1,u=640,E=480,T=theScript(),h={},s=[],A=window,M=C.getContext("2d"),d="ontouchstart"in document,I=C.getBoundingClientRect();MX=0,MY=0,EX=0,EY=0,ES=f,PI2=2*Math.PI,C.width=M.width=u,C.height=M.height=E,D.style.webkitTransformOrigin=D.style.transformOrigin="0 0",C.onmousemove=function(t){MX=t.clientX-I.left,MY=t.clientY-I.top},d?C.addEventListener("touchstart",function(t){ES=a,EX=MX=t.changedTouches[0].pageX-I.left,EY=MY=t.changedTouches[0].pageY-I.top}):C.onclick=function(t){ES=a,EX=MX,EY=MY};var O=[function(t){var e=t.shift(),l=O[e].apply(null,t);return Promise.resolve(l)},function(t){return new Promise(function(e,l){function i(){if(0===t.length)return e();var l=t.shift();return O[ACTION_ACTION](l).then(i)}i()})},function(t){s.push([MESSAGE_THEM,t])},function(t){s.push([MESSAGE_THEM,t()])},function(t){return new Promise(function(e,l){setTimeout(function(){e()},t)})},function(t){return O[ACTION_GROUP](T[t])},function(t){t()},function(t){s.push([MESSAGE_OPTION,t])},function(t){s.push([MESSAGE_SYSTEM,t])},function(t,e){return new Promise(function(l,i){setTimeout(function(){s.push([MESSAGE_TYPING]),setTimeout(function(){s.pop(),l()},e)},t)})},function(t){s.push([MESSAGE_US,t])},function(t,e){h[t]=e},function(t,e){var l=t in h?h[t]:null;if(l in e)return O[ACTION_ACTION](e[l])}];!function(){var t=document.createElement("canvas");t.width=t.height=16;var e=t.getContext("2d");e.fillStyle="#6c977f",e.fillRect(0,0,16,16),e.fillStyle="#ffce45",e.beginPath(),e.arc(8,8,3,0,PI2),e.fill();var l=document.createElement("link");l.type="image/x-icon",l.rel="shortcut icon",l.href=t.toDataURL("image/x-icon"),document.getElementsByTagName("head")[0].appendChild(l)}(),t();var _=A.location.hash,N=_.length>1?_.substr(1):"main";N in T||(N="main"),O[ACTION_GROUP](T[N])}();