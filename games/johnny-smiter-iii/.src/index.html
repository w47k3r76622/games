<!DOCTYPE html><html><head><meta charset="utf-8"><title>Johnny Smiter - Episode III</title><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="monetization" content="$ilp.uphold.com/NApepay8XzAK"><script>
!function(t){var e={};function s(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(i,r,function(e){return t[e]}.bind(null,r));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);const i=new Path2D("m0.93-46.505c-1.83-0.06-1.87 6.94-6.03 10.15-4.15 3.20-4.98 17.37-1.83 27.26 0.63 11.69 1.73 13.15 6.95 12.90 5.45-0.25 7.22-1.69 8.07-12.90 3.59-10.15 2.38-24.01-1.68-27.49-4.05-3.48-3.64-9.85-5.48-9.91z"),r=new Path2D("M0 3.207c9.875-.197 6.24 8.552 5.078 18.175C3.917 31.004 3.034 36.732 0 36.616c-3.034-.115-3.717-9.021-5.345-15.769C-6.973 14.099-9.875 3.404 0 3.207z"),a=new Path2D("M0-4.00c5.59-.46 3.53 2.53 3.06 10.08-.47 7.55-.75 4.88.92 11.16C5.19 19.57 1.72 28.36 0 28.33c-1.72-.037-5.69-7.92-3.97-11.29 1.81-5.63 1.11-4.87.62-11.4C-3.83-.89-5.40-3.56 0-4.01z"),h=new Path2D("M0-4.009c6.935-.197 7.041 17.64 4.009 26.727C.977 31.806 3.034 36.73 0 36.616c-3.034-.115-2.114-6.348-4.276-13.63C-6.44 15.702-6.935-3.813 0-4.01z"),o=new Path2D("M0-4.009c5.598-.464 6.24 6.147 4.544 13.363C.71 20.848 6.604 34.666 0 34.745c-6.366.076-1.045-14.634-4.009-25.658C-5.637 3.141-5.405-3.56 0-4.009z"),n=new Path2D("M.005-3.401c4.124 4.962 11.991 9.827 6.534 9.233-5.457-.595-7.246-.401-12.233.096C-10.68 6.426-2.136.803.005-3.4z"),l=new Path2D("m -0.08,-3.60 c 6.35,6.49 9.49,22.69 9.35,16.91 -0.33,-14.30 4.37,5.61 0.81,10.43 -6.54,9.39 -17.36,6.54 -21.53,-1.45-2.08,-3.99 1.92,-20.95 2.19,-9.49 0.13,5.67 2,-9.69 9.16,-16.40 z"),c=[[0,0,0,-3,.13,-.04,0],[.33,.75,-.17,5,.58,.05,.05],[-.27,.66,-.09,-3,.02,-.33,0],[-.85,1.06,-.35,5,-.45,-.31,.05]],d=[[.3,-.1,-.2,0,.5,-.1,-.01],[.32,-.18,-.12,1,.47,-.15,.01]];function f(t,e,s){return e*s+t*(1-s)}class m{constructor(){this.x=0,this.y=0,this.state={},this.frame=0,this.walking=0,this.mode="idle",this.floorAngle=0,this.mag=1,this.last=performance.now()}idle(){var t=this.lerpanim(d,.3*this.frame,0,1),e=this.lerpanim(d,.3*this.frame,.2,1);return{lleg1:[-5,0,t[0]],lleg2:[0,30,t[1]],lfoot:[0,30,t[2]],rleg1:[5,0,-e[0]],rleg2:[0,30,-e[1]],rfoot:[0,30,-e[2]],hip:[0,t[3],0],head:[0,-70,e[6]],larm1:[-5,-40,e[4]],larm2:[0,30,e[5]],rarm1:[5,-40,-t[4]],rarm2:[0,30,-t[5]]}}lerpanim(t,e,s,i){var r=t.length,a=(e+s*r)%r,h=Math.floor(a),o=Math.ceil(a)%r,n=a%1,l=[];for(let e=0;e<t[0].length;e++)l.push(f(t[h][e],t[o][e],n)*i);return l}walk(t){var e=Math.sin(.25*this.frame),s=this.lerpanim(c,this.frame,1==t?0:.5,1*this.mag),i=this.lerpanim(c,this.frame,1==t?.5:0,1*this.mag),r=this.lerpanim(c,.75*this.frame+.25*e,1==t?.2:.7,1.2*this.mag),a=this.lerpanim(c,.75*this.frame+.25*e,1==t?.7:.2,1.2*this.mag);return{lleg1:[-5*t,0,s[0]*t],lleg2:[0,30,s[1]*t],lfoot:[5*t,30,s[2]*t],rleg1:[5*t,0,i[0]*t],rleg2:[0,30,i[1]*t],rfoot:[5*t,30,i[2]*t],hip:[0,s[3],0],head:[0,-70,r[6]*t],larm1:[-5*t,-40,r[4]*t],larm2:[0,30,r[5]*t],rarm1:[5*t,-40,a[4]*t],rarm2:[0,30,a[5]*t]}}walkLeft(){return this.walk(-1)}walkRight(){return this.walk(1)}transform(t,e){t.translate(e[0],e[1]),t.rotate(e[2])}drawLegs(t){var e=this.state;t.save(),this.transform(t,e.lleg1),t.fill(h),this.transform(t,e.lleg2),t.fill(o),this.transform(t,e.lfoot),t.fill(n),t.restore(),t.save(),this.transform(t,e.rleg1),t.fill(h),this.transform(t,e.rleg2),t.fill(o),this.transform(t,e.rfoot),t.fill(n),t.restore()}drawArms(t){var e=this.state;t.save(),this.transform(t,e.larm1),t.fill(r),this.transform(t,e.larm2),t.fill(a),t.restore(),t.save(),this.transform(t,e.rarm1),t.fill(r),this.transform(t,e.rarm2),t.fill(a),t.restore()}drawHead(t){var e=this.state;t.save(),this.transform(t,e.head),t.fill(l),t.restore()}mix(t,e,s){var i,r={};for(i in t){var a=[];for(let r=0;r<t[i].length;r++)a.push(t[i][r]*s+e[i][r]*(1-s));r[i]=a}return r}setMode(t){this.mode!=t&&(this.frame=0,this.mode=t,this.oldState=this.state,this.modeChanged=performance.now())}animate(){if(this.state=this[this.mode](),this.oldState){var t=Math.min(1,(performance.now()-this.modeChanged)/100);this.cross=t,this.state=this.mix(this.state,this.oldState,t)}}draw(t){var e=performance.now();this.frame+=.01*(e-this.last),this.last=e,this.animate(),t.save(),t.fillStyle="#000",t.translate(this.x,this.y),this.transform(t,this.state.hip),t.rotate(this.floorAngle),this.drawLegs(t),t.rotate(.25*-this.floorAngle),t.fill(i),this.drawArms(t),t.rotate(.1*this.floorAngle),this.drawHead(t),t.restore()}}class u{constructor(){this.width=2e3,this.height=2e3,this.particles=[];for(let t=0;t<300;t++)this.particles.push([1.2*Math.random(),1.2*Math.random(),.5*Math.random()+.6])}tick(t){t*=1;var e=performance.now(),s=this.particles;for(let i=0;i<s.length;i++)this.particles[i][1]-=.1*(s[i][2]+.2)*t*(Math.sin(.001*e)+.75),this.particles[i][0]=.5*(Math.sin(this.particles[i][1]*this.particles[i][2]+50*this.particles[i][2])+1),this.particles[i][1]<-.2&&(this.particles[i][1]=1.2)}draw(t,e,s){t.save(),t.fillStyle="rgba(0,0,0,0.2)",t.shadowBlur=20,t.shadowColor="#000";var i=this.particles;t.beginPath();var r=performance.now();for(let n=0;n<i.length;n++){var a=i[n][0]*this.width,h=i[n][1]*this.height;if(!(a<e[0]||h<e[1])&&!(a>e[0]+s[0]||h>e[1]+s[1])){t.save(),t.translate(a,h);var o=(r+5e3*i[n][2])%5e3/5e3;t.rotate(o*Math.PI*2);s=(i[n][2]*i[n][2]*i[n][2]+.2)*t.canvas.width*.007*Math.sin(o*Math.PI*2);t.rect(-s,-s,2*s,2*s),t.rotate(.57+o*Math.PI*2),t.rect(-s,-s,2*s,2*s),t.restore()}}t.fill(),t.restore()}}var p=function(){var t,e,s,i,r,a=function(t){return Math.sin(6.283184*t)},h=function(t){return.003959503758*Math.pow(2,(t-128)/12)},o=function(t,e,s){var i,r,a,o,l,c,d,f=n[t.i[0]],m=t.i[1],u=t.i[3],p=n[t.i[4]],w=t.i[5],y=t.i[8],v=t.i[9],g=t.i[10]*t.i[10]*4,b=t.i[11]*t.i[11]*4,x=t.i[12]*t.i[12]*4,M=1/x,S=t.i[13],k=s*Math.pow(2,2-t.i[14]),C=new Int32Array(g+b+x),P=0,L=0;for(i=0,r=0;i<g+b+x;i++,r++)r>=0&&(r-=k,c=h(e+(15&(S=S>>8|(255&S)<<4))+t.i[2]-128),d=h(e+(15&S)+t.i[6]-128)*(1+8e-4*t.i[7])),a=1,i<g?a=i/g:i>=g+b&&(a-=(i-g-b)*M),o=c,u&&(o*=a*a),l=f(P+=o)*m,o=d,y&&(o*=a*a),l+=p(L+=o)*w,v&&(l+=(2*Math.random()-1)*v),C[i]=80*l*a|0;return C},n=[a,function(t){return t%1<.5?1:-1},function(t){return t%1*2-1},function(t){var e=t%1*4;return e<2?e-1:3-e}];this.init=function(a){t=a,e=a.endPattern,s=0,i=a.rowLen*a.patternLen*(e+1)*2,r=new Int32Array(i)},this.generate=function(){var h,l,c,d,f,m,u,p,w,y,v,g,b,x,M=new Int32Array(i),S=t.songData[s],k=t.rowLen,C=t.patternLen,P=0,L=0,T=!1,O=[];for(c=0;c<=e;++c)for(u=S.p[c],d=0;d<C;++d){var I=u?S.c[u-1].f[d]:0;I&&(S.i[I-1]=S.c[u-1].f[d+C]||0,I<16&&(O=[]));var A=n[S.i[15]],D=S.i[16]/512,z=Math.pow(2,S.i[17]-9)/k,R=S.i[18],q=S.i[19],E=43.23529*S.i[20]*3.141592/44100,N=1-S.i[21]/255,j=1e-5*S.i[22],B=S.i[23]/32,F=S.i[24]/512,W=6.283184*Math.pow(2,S.i[25]-9)/k,X=S.i[26]/255,H=S.i[27]*k&-2;for(v=(c*C+d)*k,f=0;f<4;++f)if(m=u?S.c[u-1].n[d+f*C]:0){O[m]||(O[m]=o(S,m,k));var Y=O[m];for(l=0,h=2*v;l<Y.length;l++,h+=2)M[h]+=Y[l]}for(l=0;l<k;l++)(y=M[p=2*(v+l)])||T?(g=E,R&&(g*=A(z*p)*D+.5),L+=(g=1.5*Math.sin(g))*(b=N*(y-L)-(P+=g*L)),y=3==q?L:1==q?b:P,j&&(y=(y*=j)<1?y>-1?a(.25*y):-1:1,y/=j),T=(y*=B)*y>1e-5,x=y*(1-(w=Math.sin(W*p)*F+.5)),y*=w):x=0,p>=H&&(x+=M[p-H+1]*X,y+=M[p-H]*X),M[p]=0|x,M[p+1]=0|y,r[p]+=0|x,r[p+1]+=0|y}return++s/t.numChannels},this.createWave=function(){var t=44+2*i-8,e=t-36,s=new Uint8Array(44+2*i);s.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var a=0,h=44;a<i;++a){var o=r[a];o=o<-32767?-32767:o>32767?32767:o,s[h++]=255&o,s[h++]=o>>8&255}return s},this.getData=function(t,e){for(var s=2*Math.floor(44100*t),i=new Array(e),a=0;a<2*e;a+=1){var h=s+a;i[a]=t>0&&h<r.length?r[h]/32768:0}return i}},w=function(t,e,s){var i=new p;for(i.init(t);1!=i.generate(););var r=new Blob([i.createWave()],{type:"audio/wav"}),a=URL.createObjectURL(r);return function(){var t=new Audio;t.volume=e,t.src=a,s&&(t.loop=!0),t.play()}},y={songData:[{i:[2,138,116,0,2,138,128,4,0,0,47,48,107,124,3,0,139,4,1,3,64,160,3,32,147,4,121,5],p:[1],c:[{n:[170,173],f:[]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1},v={songData:[{i:[3,146,140,0,2,224,128,3,0,0,92,84,37,0,0,3,179,16,1,2,124,135,11,32,150,3,157,6],p:[1],c:[{n:[170,168,166],f:[]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1},g={songData:[{i:[2,91,128,0,0,95,100,12,0,0,0,0,72,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[1],c:[{n:[154,156,158],f:[]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1},b=w({songData:[{i:[3,0,128,0,3,68,128,0,1,218,4,4,40,0,0,1,55,4,1,2,67,115,124,190,67,6,39,1],p:[1,1,2,1],c:[{n:[135,,139,,135,,139,,137,,140,,135,,139,,135,,139,,137,,140,,135,,139,,135,,139],f:[]},{n:[135,,139,,135,,139,,137,140,140,,135,,139,,135,,139,,137,,140,,135,139,139,,135,139],f:[]}]},{i:[0,255,116,1,0,255,116,0,1,0,4,6,35,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[1,1,1,1],c:[{n:[141,,,,142,,137,,141,,,,142,,137,,141,,,,141,,,,142,,137,,141],f:[]}]},{i:[2,192,164,0,2,191,128,3,0,0,0,52,125,0,0,0,69,3,1,1,23,167,1,32,222,3,91,6],p:[1,1,2,1],c:[{n:[139,141,144,,,,,,144,141,137,,,,,,137,144,,,142,140,139,,136,,,,144],f:[]},{n:[139,141,,,139,137,,,144,141,139,,136,,,,139,141,,,144,141,139,,144,141,139,,136],f:[]}]},{i:[2,91,128,0,2,95,92,12,0,0,12,0,72,0,0,0,0,0,0,2,255,0,0,32,243,3,130,4],p:[1,1,2,1],c:[{n:[139,141,,,,,,,139,141,,,,,,,,,,,,,,,,,,,156,,,,151,153,153,,,,,,151,153,153,,,,,,149,,,,154,,,,148,,,159],f:[]},{n:[151,149,,,151,149,,,144,,,,148,,,,151,149,,,151,149,,,144,,,,148,,,,,,,,,,,,156,,,,,,,,,,,,,149,,,156,,,,148],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,255,158,158,158,0,0,0,51,2,1,2,58,239,0,243,88,1,157,2],p:[3,3,3,3],c:[{n:[151,,,,,,,,153,,,,,,,,,,,,151,,,,153],f:[]},{n:[139,141,144,,,,,,144,141,137,,,,,,137,144,,,142,140,139,,136,,,,144],f:[]},{n:[144],f:[]}]}],rowLen:12700,patternLen:32,endPattern:3,numChannels:5},.35,!0),x=(y=w(y,.25),v=w(v,.5),g=w(g,1),performance.now()),M=!1;document.addEventListener("mousedown",()=>{M||(M=!0,setTimeout(b,1500))});var S=new Path2D("M-.053-6.943c-1.832-.094-4.984 4.357-4.905 6.507.08 2.15 2.168 2.613 3.482 3.219-.837 2.38.343 2.767-.122 4.709C.087 5.706.636 5.686 1.829 7.432c-.15-2.098 1.005-3.082-.364-4.72 0 0 4.125-.07 4.06-3.266C5.46-3.751 1.78-6.85-.053-6.944z"),k=new Path2D("m-0.84,-0.10c0,0 47.81,14.12 12.68,37.08C32.34,16.02 -0.19,6.72 -0.19,6.7 Z"),C=new Path2D("M64.7 64.08L56.93 83.69c-19.27 8.70-22.52 31.14.52 42.55 0 0 2.07 4.18-9.01 10.27-8.58 19.22-7.75 45.28-6.292 75.33l10.77-61.04L50.27 263.26l24.38.37s17.57-8.19-4.34-9.07c-14.17-.56-16.7-6.63-5.67-49.70 9.375 4.82-16.55 43.07-1.18 48.36 0 0 13.46-46.01 18.50-52.07 24.08-28.98-9.663-52.13-9.663-52.13l21.26 16.34 22.68-6.80 15.12-1.7-18.14-1.32-19.75 3.02-21.73-28.45s-8.99-7.79-.09-3.3 26.40-10.39-.8-40.25c-7.56-3.59-6.11-22.47-6.11-22.47z"),P=new Path2D("M-0.75,-29.86 C-20.13,-18.72 -16.25,30.61 -16.25,30.61 l33.63,0.37 c0,0 3.50,-45.53 -18.14,-60.85 z"),L=!0,T=function(t,e){var s=document.createElement("canvas"),i=s.getContext("2d"),r=80*t,a=2*t,h=40*t;s.height=s.width=5.3*r,i.save(),i.fillStyle="#111",i.fillRect(0,0,500,500),i.fillStyle="#222";var o=0;for(let t=0;t<70;t++){var n=-t%2*r*.5;for(let t=0;t<70;t++)i.shadowBlur=5,i.shadowColor="#000",i.fillRect(n,o,r,h),i.shadowBlur=2,i.shadowColor="#555",i.fillRect(n+3,o+3,r-6,h-6),n+=r*(.75+.25*(Math.random()+.5))+a;o+=h+a}return i.restore(),e=Math.floor(255*e),i.fillStyle="rgb("+e+","+e+","+e+")",i.globalCompositeOperation="multiply",i.fillRect(0,0,500,500),s};class O{constructor(t,e){this.x=t,this.y=e,this.targetX=t,this.targetY=e}tick(t){this.x+=(this.targetX-this.x)*t*.05,this.y+=(this.targetY-this.y)*t*.05}setTarget(t,e){this.targetX=t,this.targetY=e}draw(t){t.save();var e=x,s=10*Math.sin(.01*e),i=10*Math.sin(.015*e);t.translate(this.x+s,this.y+i);var r=t.createRadialGradient(0,0,0,0,0,15);r.addColorStop(.4,"#fff"),r.addColorStop(.5,"rgba(255,255,255,0.5)"),r.addColorStop(1,"rgba(255,255,255,0)"),t.fillStyle=r,t.beginPath(),t.arc(0,0,15,0,2*Math.PI),t.fill(),t.restore()}drawGlow(t){t.save();var e=x,s=50*Math.sin(.01*e);t.globalCompositeOperation="hard-light";var i=t.createRadialGradient(this.x,this.y,0,this.x,this.y,800+s);i.addColorStop(0,"#eef"),i.addColorStop(.5,"#222"),t.fillStyle=i,t.fillRect(-1e4,-1e4,2e4,2e4),t.restore()}}class I{constructor(t,e,s){this.x=t,this.y=e,this.radius=s}segmentIntersect(t,e,s,i){var r=s-t,a=i-e,h=Math.sqrt(r*r+a*a);r/=h,a/=h;var o=(this.x-t)*a-(this.y-e)*r;if(o>this.radius||o<0)return!1;var n=(this.x-a*o)*r+(this.y+r*o)*a;if(n>t*r+e*a&&n<s*r+i*a)return{normal:[a,-r],depth:this.radius-o};var l=this.x-t,c=this.y-e,d=Math.sqrt(l*l+c*c);return d<this.radius&&{normal:[l/d,c/d],depth:this.radius-d}}}class A{constructor(t,e,s,i){this.x=t,this.y=e,this.width=s,this.height=i,this.points=[[this.x,this.y],[this.x+s,this.y],[this.x+s,this.y+i],[this.x,this.y+i]],this.projectPoints=[[0,0],[0,0],[0,0],[0,0]],this.paths=[]}calcShadowAreas(t){this.projectPoints=this.points.map((e,s)=>{var i=e[0]-t.x,r=e[1]-t.y,a=Math.sqrt(i*i+r*r);return[i/a*1e4+.1*e[0]+.9*this.projectPoints[s][0],r/a*1e4+.1*e[1]+.9*this.projectPoints[s][1]]})}drawShadows(t){t.save();var e=this.points,s=this.projectPoints,i=e.length;this.paths=[];for(let o=0;o<i;o++){var r=o,a=(o+1)%i,h=new Path2D;h.moveTo(s[r][0],s[r][1]),h.lineTo(s[a][0],s[a][1]),h.lineTo(e[a][0],e[a][1]),h.lineTo(e[r][0],e[r][1]),h.closePath(),t.fill(h),t.stroke(h),this.paths.push(h)}t.restore()}drawPlatform(t,e,s){this.x+this.width<e[0]||this.y+this.height<e[1]||this.x>e[0]+s[0]||this.y>e[1]+s[1]||(t.save(),t.fillRect(this.x,this.y,this.width,this.height),t.translate(this.x,this.y),L&&(t.shadowColor="#000",t.shadowBlur=.03*V.height,t.shadowOffsetY=5),t.fillStyle=U,t.fillRect(-5,0,this.width+10,10),t.restore())}collisionBox(t,e){var s=[],i=this.points.length;for(let t=0;t<i;t++){var r=t,a=(t+1)%i;e?(s.push([this.projectPoints[r][0],this.projectPoints[r][1],this.points[r][0],this.points[r][1]]),s.push([this.points[r][0],this.points[r][1],this.projectPoints[r][0],this.projectPoints[r][1]])):s.push([this.points[r][0],this.points[r][1],this.points[a][0],this.points[a][1]])}var h=[];for(let e=0;e<s.length;e++){var o=s[e],n=t.segmentIntersect(o[0],o[1],o[2],o[3]);n&&h.push(n)}return h}}class D extends A{constructor(t,e,s,i){super(t,e,s,i)}draw(t,e,s){if(!(this.x+this.width<e[0]||this.y+this.height<e[1]||this.x>e[0]+s[0]||this.y>e[1]+s[1])){var i=Math.floor(this.width/5),r=this.width/i;t.save(),t.beginPath(),t.lineWidth=5,t.translate(this.x,this.y+this.height),t.moveTo(0,0);for(let e=1;e<i;e++)t.lineTo(e*r+10*Math.random(),-e%2*this.height*r*Math.random()*.2);t.lineTo(this.width,0),t.stroke(),t.fill(),t.restore()}}}class z{constructor(t,e,s){this.map=s,this.bound=new I(t,e,50),this.velocity=[0,0],this.inShadow=!1,this.man=new m,this.floorNormal=[0,-1],this.onfloor=!0,this.numbersCollected=0,this.start=x}tick(t,e){if(x-this.start>5e3&&(this.inShadow=this.map.pointInShadow(this.bound.x,this.bound.y)),this.inShadow)return void(this.velocity=[0,0]);this.velocity[0]-=this.velocity[0]*t*.5,this.velocity[1]-=this.velocity[1]*t*.5,this.velocity[1]+=10*t,this.bound.x+=this.velocity[0]*t,this.bound.y+=this.velocity[1]*t;var s=[0,0];for(let t=0;t<5;t++){var i=0,r=!1,a=t<1;for(let t=0;t<e.length;t++){var h=e[t].collisionBox(this.bound,a);for(let t=0;t<h.length;t++)h[t].depth>i&&(i=h[t].depth,r=h[t])}if(r){s[1]>r.normal[1]&&(s=r.normal);var o=r;this.bound.x+=o.normal[0]*o.depth,this.bound.y+=o.normal[1]*o.depth;var n=this.velocity[0]*o.normal[0]+this.velocity[1]*o.normal[1];this.velocity[1]-=o.normal[1]*n}}0!=s[1]?(this.floorNormal=s,this.onfloor=!0):(this.onfloor=!1,this.floorNormal=[0,-1])}isDead(){var t=this.map.spikes;for(let e=0;e<t.length;e++){if(t[e].collisionBox(this.bound,!1).length>0)return!0}var e=this.map.spiders;for(let t=0;t<e.length;t++){if(e[t].checkCollition(this.bound.x,this.bound.y))return!0}return!1}draw(t){this.inShadow||(t.save(),t.translate(this.bound.x,this.bound.y-4),t.scale(.85,.85),this.man.draw(t),this.velocity[0]>.5?this.man.setMode("walkRight"):this.velocity[0]<-.5?this.man.setMode("walkLeft"):this.man.setMode("idle"),t.restore())}}class R{constructor(){this.states={},document.addEventListener("keydown",this.keydown.bind(this)),document.addEventListener("keyup",this.keyup.bind(this)),[...document.querySelectorAll(".key")].map(t=>{var e;t.addEventListener("touchstart",s=>{s.stopPropagation(),s.preventDefault(),this.states[t.dataset.key]=!0,clearTimeout(e)}),document.addEventListener("touchend",s=>{e=setTimeout(()=>{this.states[t.dataset.key]=!1},100)})})}keydown(t){this.states[t.keyCode]=!0}keyup(t){this.states[t.keyCode]=!1}}class q{constructor(t){this.ctx=t,this.light=!1,this.targetOffset=[0,0],this.windows=H,this.offset=[0,0],this.size=[2e3,2e3],this.viewport=[t.canvas.width/tt,t.canvas.height/tt],this.boxes=[];for(let t=0;t<B.length;t+=4)this.boxes.push(new A(20*B[t],20*B[t+1],20*B[t+2],20*B[t+3]));this.spikes=[];for(let t=0;t<F.length;t+=4)this.spikes.push(new D(20*F[t],20*F[t+1],20*F[t+2],20*F[t+3]));this.spiders=[];for(let t=0;t<W.length;t+=3)this.spiders.push(new E(20*W[t],20*W[t+1],20*W[t+2]));this.numbers=[];for(let t=0;t<X.length;t+=3)this.numbers.push(new N(20*X[t+1],20*X[t+2],X[t]))}checkCollitions(t,e){var s=t.bound.x,i=t.bound.y;if(this.numbers=this.numbers.filter(e=>{var r=e.x-s,a=e.y-i;if(Math.sqrt(r*r+a*a)>t.bound.radius)return!0;g(),t.numbersCollected+=e.number+1;var h=t.numbersCollected;return Z.innerHTML=(h>2?"2 ":"X ")+(4==h||5==h||1==h?" 0":" X")+(5==h||2==h?" 0":" X"),!1}),5==t.numbersCollected&&!e.told1){e.told1=!0;var r=[e.x-this.targetOffset[0],e.y-this.targetOffset[1]-50];new j("Your (re)quest was successful, now you must find the exit",r[0],r[1],7500,!0).show()}}pointInShadow(t,e){var s=this.boxes.length;for(let i=0;i<s;i++){let s=this.boxes[i];for(let i=0;i<s.paths.length;i++)if(this.ctx.isPointInPath(s.paths[i],t*tt,e*tt))return!0}return!1}drawSpiders(){$.fillStyle="#000",this.spiders.forEach(t=>{t.draw(this.ctx)})}draw(t){$.fillStyle="#faa",$.strokeStyle="#440",this.spikes.forEach(t=>{t.draw(this.ctx,this.offset,this.size)}),L&&($.save(),$.shadowBlur=30,$.shadowColor="#000",$.fillStyle=_,this.boxes.forEach(t=>{t.drawPlatform(this.ctx,this.offset,this.size)}),$.restore());var e=this.windows.length;$.save(),$.fillStyle=t?"#030303":"#333",$.scale(1.5,1.2);var s=0,i=0;for(let t=0;t<e;t+=2){let e=20*this.windows[t]/1.5,r=20*this.windows[t+1]/1.2+20/1.2;$.translate(e-s,r-i),$.fill(P),s=e,i=r}$.fillStyle=t?"#333":"#030303";for(let t=0;t<e;t+=2){let e=20*this.windows[t]/1.5+3,r=20*this.windows[t+1]/1.2+20/1.2-3;$.translate(e-s,r-i),$.fill(P),s=e,i=r}$.restore(),(document.monetization&&"started"===document.monetization.state||!t)&&this.numbers.forEach(t=>{t.draw(this.ctx)})}drawWithShadows(t,e,s){t.save(),t.fillStyle=J,t.fillRect(-1e4,-1e4,2e4,2e4),this.draw(),e.drawGlow(t),this.drawSpiders(),t.globalCompositeOperation="destination-out",this.boxes.forEach(t=>{t.calcShadowAreas(e),t.drawShadows(this.ctx)}),s.draw(t),t.globalCompositeOperation="destination-over",t.fillStyle="rgba(0,0,0,0.8)",t.fillRect(-1e4,-1e4,2e4,2e4),this.draw(!0),this.drawSpiders(),t.fillStyle=J,t.fillRect(-1e4,-1e4,2e4,2e4),t.restore(),t.save(),t.fillStyle="#000",t.translate(80,1760),t.scale(.85,.85),t.fill(C),t.restore(),5==s.numbersCollected&&(t.save(),t.translate(1800,130),t.scale(3,3),L&&(t.shadowBlur=50,t.shadowColor="#fff"),t.globalAlpha=Math.sin(.005*x)+1.5,t.translate(-3,-3),t.fillStyle="#fff",t.fill(P),t.restore()),t.fillStyle=_,this.boxes.forEach(t=>{t.drawPlatform(this.ctx,this.offset,this.size)}),this.light&&(t.save(),t.globalCompositeOperation="overlay",t.fillStyle="#f00",t.fillRect(-1e4,-1e4,2e4,2e4),t.restore())}setTranslation(t,e){this.offset[0]+=(this.targetOffset[0]-this.offset[0])*e*.1,this.offset[1]+=(this.targetOffset[1]-this.offset[1])*e*.1,t.translate(-this.offset[0],-this.offset[1])}setCenter(t){this.viewport=[this.ctx.canvas.width/tt,this.ctx.canvas.height/tt];var e=t.x-.5*this.viewport[0],s=t.y-.5*this.viewport[1];this.targetOffset[0]=Math.max(0,Math.min(this.size[0]-this.viewport[0],e)),this.targetOffset[1]=Math.max(0,Math.min(this.size[1]-this.viewport[1],s))}}class E{constructor(t,e,s){this.offset=5e3*Math.random(),this.x=t,this.y=e,this.height=s,this.lastpos=[0,0]}drawlegs(t,e){e.save(),e.scale(.2,.2),e.translate(20,0),e.rotate(.25*Math.sin(t+2)),e.fill(k),e.translate(0,-7),e.rotate(.15*Math.sin(t)-.5),e.fill(k),e.translate(0,-7),e.rotate(.25*Math.sin(t)-.5),e.fill(k),e.restore(),e.translate(0,6),e.scale(.15,.08),e.rotate(.2+.25*Math.sin(1.5*t)),e.fill(k)}draw(t){t.save();var e=5e3*this.height/300;(s=((x+this.offset)%e-.5*e)/(.5*e))<1&&(s*=s),s=Math.min(1,Math.max(0,s+.2*Math.sin(5e-4*x+this.offset))),t.fillRect(this.x,this.y,3,this.height*s),t.translate(this.x+1.5,this.y+this.height*s),this.lastpos=[this.x+1.5,this.y+this.height*s],t.scale(3.5,3.5);var s=.01*x;t.fill(S),t.save(),this.drawlegs(s,t),t.restore(),t.scale(-1,1),this.drawlegs(s,t),t.restore()}checkCollition(t,e){var s=t-this.lastpos[0],i=e-this.lastpos[1];return Math.sqrt(s*s+i*i)<65}}class N{constructor(t,e,s){this.x=t,this.y=e,this.number=s}draw(t){t.save();var e=x;t.translate(this.x,this.y+20*Math.sin(e/1e3)),t.fillStyle="#977207",t.shadowBlur=.03*V.height,t.shadowColor="#fff",t.fillText(this.number,0,0),t.restore()}}class j{constructor(t,e,s,i,r){this.nokey=r,this.time=i;var a=document.createElement("div");a.className="bubble",a.style.left=e*tt/et+"px",a.style.top=s*tt/et+"px",a.innerHTML=t,this.speech=a}show(){return document.body.appendChild(this.speech),new Promise(t=>{var e=()=>{clearTimeout(s),document.removeEventListener("keydown",e),document.removeEventListener("click",e),document.body.removeChild(this.speech),t()};this.nokey||document.addEventListener("keydown",e),this.nokey||document.addEventListener("click",e);var s=setTimeout(e,this.time)})}}const B=[99,0,1,100,0,99,100,1,0,0,1.1,100,0,0,100,1,35,89,64,1,35,97,40,2,35,78,5,11,50,75,5,14,65,78,5,11,80,75,19,14,.6,83.35,19,2,6.6,75.35,4,8,18.5,92,6.5,7,0,68,32,2.1,30,50,2,19,39.7,60.85,9.25,1.3,56.9,63.5,5.3,1.3,72.75,63.5,5.3,1.3,1,40.2,82,2.15,84.65,63.5,4,1.3,84.65,54.25,4,1.3,84.65,45,4,1.3,84.65,35.7,4,1.3,52,42,31,13,10.6,50,19.4,2,35,10,64,2,55,25,5,15.2,46.85,28.45,8.7,2,35,33.05,5,7.15,20.1,25,4.9,15.2,6.6,30.45,6.6,9.8,10,18,4.55,2,21.15,13.85,7,2,16.45,59.55,14,2,.95,61.5,7,7.3,60,28,18,5.05,31.75,51.6,5.3,10.6],F=[40,87,10,2,55,87,10,2,70,87,10,2,40,38,5,2.2,25,38,10,2.2,1.05,81.35,5.5,2,13.25,38.35,6.9,1.85,1.05,38.35,5.55,1.85],W=[66,55,20.4,52,55,15,64,12,13.15,41.35,42.35,31.75,92.95,11.9,54.25,37.05,11.9,18.5,29.1,70.1,25.15],X=[0,26.45,55.55,0,51.6,37.05,2,62.2,37.05],H=[91.3,92.6,66.15,92.6,48.95,92.6,17.2,78.05,26.45,78.05,43.65,70.1,58.2,70.1,74.1,70.1,92.6,70.1,92.6,54.25,92.6,37.05,72.75,21.15,56.9,21.15,43.65,21.15,9.25,25.15,47.6,5.3,60.85,5.3,74.1,5.3,13.25,92.6];class Y{constructor(t){this.ctx=t,this.map=new q(this.ctx),this.player=new z(1800,1800,this.map),this.light=new O(1600,1900),this.keyStates=new R,this.particles=new u,this.lastTime=x,this.badFrame=0,this.started=!1,this.numbersCollected=0,document.addEventListener("mousedown",t=>{1===t.buttons&&this.started&&(y(),this.light.setTarget(t.clientX*et/tt+this.map.offset[0],t.clientY*et/tt+this.map.offset[1]))}),setTimeout(()=>{var t=[this.player.bound.x-this.map.targetOffset[0],this.player.bound.y-this.map.targetOffset[1]-100],e=[this.light.x-this.map.targetOffset[0],this.light.y-this.map.targetOffset[1]-50],s=[[e,"Greetings strange soul, I am Ellysias, a Ferry God. You seem out of place in this realm - may I ask your business?"],[t,"I'm Johnny. I was battling an ancient witch in my home realm of Jar when she cast some kind of spell and I found myself here."],[e,"I may be able to help. It would seem you have fallen foul of the lost page of the Necronomicon - Page 404 - containing the curse of the Shadow Walker."],[e,"To break the curse and be restored to your former self and realm, you must find the three sacred numbers and read them aloud."],[e,"I will help guide you with my fairy light. Just point where you wish me to go and I will light your path [mouse]"],[e,"You can navigate this place with your legs [keyboard A, D]"],[t,"um..I did already know how to walk, but thank your for your kind assistance."]],i=()=>{if(s.length>0){var t=s.shift();new j(t[1],t[0][0],t[0][1],7500).show().then(i)}else this.started=!0};i()},1e3),this.loop()}reset(){v(),this.map.light=!0,setTimeout(()=>{K.className="show",this.player.bound.x=1e4},500),setTimeout(()=>{this.map=new q(this.ctx),this.player=new z(1800,1800,this.map),this.light=new O(1600,1900),K.className="show"},1e3),setTimeout(()=>{K.className="",this.started=!0,Z.innerHTML="X X X"},2e3)}loop(){x=performance.now();var t=this.ctx;t.save(),t.scale(tt,tt);var e=this.player,s=Math.atan2(e.floorNormal[0],-e.floorNormal[1]);e.man.floorAngle+=.3*(s-e.man.floorAngle),this.started&&((this.keyStates.states[39]||this.keyStates.states[68])&&(e.velocity[0]=10*-e.floorNormal[1],e.velocity[1]=10*e.floorNormal[0]*2),(this.keyStates.states[37]||this.keyStates.states[65])&&(e.velocity[0]=10*e.floorNormal[1],e.velocity[1]=10*-e.floorNormal[0]*2));var i=Math.sqrt(e.velocity[0]*e.velocity[0]+e.velocity[1]*e.velocity[1]);this.player.man.mag=Math.min(.85,Math.abs(i)/10*.5+.5),this.map.checkCollitions(this.player,this.light);var r=x;r-this.lastTime>15?(this.badFrame++,this.badFrame>20&&(L=!1)):this.badFrame=Math.max(this.badFrame-1,0);var a=Math.max(.5,Math.min(1,(r-this.lastTime)/15));this.lastTime=r,this.light.tick(.55*a),this.particles.tick(.015*a),this.player.tick(.55*a,this.map.boxes),this.map.setCenter(this.player.bound),t.save(),this.map.setTranslation(t,.55*a),this.map.drawWithShadows(t,this.light,this.player),this.light.draw(t),this.player.isDead()&&this.reset(),t.restore(),t.save(),this.map.setTranslation(t,0),this.particles.draw(t,this.map.offset,this.map.viewport),t.restore();var h=this.player.bound,o=h.x-50,n=h.y-1850,l=Math.sqrt(o*o+n*n);if(!this.coiled&&l<200){this.coiled=!0;var c=[200-this.map.targetOffset[0],1800-this.map.targetOffset[1]],d=document.monetization&&"started"==document.monetization.state?"I'm the great mage Coil. I will grant you the ability to see your desire within the shadows":'I\'m the great mage <a href="https://coil.com/" target="_blank">Coil</a>, cross my hands with silver and I will let you see your desire within the shadows.';new j(d,c[0],c[1],7500,!0).show()}o=h.x-1850,n=h.y-100;var f=!1;(l=Math.sqrt(o*o+n*n))<100&&5==this.player.numbersCollected&&(K.className="show",Q.className="show",f=!0),t.restore(),f||requestAnimationFrame(this.loop.bind(this))}}var _,G,J,U,Z,K,Q,V,$,tt=1,et=1,st=()=>{et=512/Math.min(innerWidth,innerHeight),V.width=Math.max(innerWidth,innerHeight)*et,V.height=Math.min(innerWidth,innerHeight)*et,$.font="bold "+60*et+"px Arial"};window.onload=()=>{window.onresize=st,Z=document.querySelector("#hud"),K=document.querySelector("#overlay"),Q=document.querySelector("#endMessage"),V=document.querySelector("canvas"),$=V.getContext("2d"),_=$.createPattern(T(.7,.5),"repeat"),G=$.createPattern(T(.5,.4),"repeat"),J=$.createPattern(T(.5,.7),"repeat"),U=$.createPattern(T(1,.4),"repeat"),st();var t=new u;t.width=innerWidth,t.height=innerHeight;var e=!0,s=new E(0,0,0),i=new E(0,0,0),r=[t.width,t.height],a=[0,0],h=()=>{if(e){x=performance.now();var o=.1*V.width;s.height=V.height/tt*.8/1.5,i.height=V.height/tt*.8/1.5,i.x=(V.width/tt-o)/1.5,s.x=o/1.5,$.save(),$.scale(tt,tt),$.fillStyle=G,$.fillRect(0,0,V.width/tt,V.height/tt),$.fillStyle=_,t.tick(.01),t.draw($,a,r),$.fillRect(0,V.height/tt*.9,V.width/tt,V.height/tt),$.fillStyle=U,L&&($.shadowBlur=.03*V.height,$.shadowColor="#000"),$.save(),$.translate(0,V.height/tt*.9),$.fillRect(0,0,V.width/tt,.03*V.height),$.restore(),$.scale(1.5,1.5),$.fillStyle="#000",s.draw($),i.draw($),$.restore(),requestAnimationFrame(h)}};h(),document.querySelector("b").onclick=()=>{K.className="show",setTimeout(()=>{K.className="",document.querySelector("main").style.display="none",document.querySelector("#hud").style.display="block",e=!1;new Y($);document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen()},1500)}}}]);
</script></head><body><style>*{margin:0}
    html{
      width: 100vw;
      height: 100vh;
    }
    body{
        margin: 0;
        background-color: #111;
        overflow: hidden;
    }
main{
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%,-50%);
    text-align: center;
    font-size: 2vw;
    background-color: rgba(0,0,0,0.5);
    box-shadow: 0 0 30px rgba(255,255,255,0.5);
    padding: 30px;
    border-radius: 30px;
}
h1{
    color: #000;
    text-shadow: 0px 0px 2px #fff;
    font-size: 7vh;
}
h2{
    color: #888;
    text-shadow: 0px 0px 2px #fff;
    font-size: 4vh;
    line-height: 1em;
    font-weight: normal;
    transform: scale(1,2);
}
b{
    margin-top: 5vw;
    margin-bottom: 1vw;
    font-size: 30px;
    display: block;
    color: #fff;
    text-shadow: 0 0 5px #fff;
    cursor: pointer;
}
#hud{
  font-size: 5vw;
  text-align: center;
  position: absolute;
  left: 0;
  bottom: 0;
  width: 100%;
  color: #fff;
  text-shadow: rgba(255,255,255,0.5);
  display: none;
  pointer-events: none;
  user-select: none;
}
canvas{
  width: 100%;
  height: 100%;
  image-rendering: optimizeSpeed;
  image-rendering: crisp-edges;
  image-rendering: -moz-crisp-edges;
  image-rendering: -o-crisp-edges;
  image-rendering: -webkit-optimize-contrast;
  -ms-interpolation-mode: nearest-neighbor;
  image-rendering: pixelated;
}
.bubble{
  position: absolute; background-color: #000;padding: 10px;width: 300px;transform:translate(-50%,-100%);color:#fff;
  box-shadow: 0px 2px 3px rgba(255,255,255,0.5);
  border-radius: 5px;
  font-size: 3vh;

}
.bubble a{
  color: #fff;
}
.bubble:before{
  content:'\A';
  position: absolute;
  left: 50%;
  bottom: -28px;
  border: 10px solid transparent;
  border-top: 20px solid #000;
}
#overlay{
  width: 100vw;
  height: 100vh;
  position: absolute;
  top: 0;
  left: 0;
  background-color: #000;
  pointer-events: none;
}
#overlay{
  width: 100vw;
  height: 100vh;
  position: absolute;
  top: 0;
  left: 0;
  background-color:rgba(255,255,255,0);
  transition: all 1.5s ease;
}
#overlay.show{
  background-color: #000;
}
#endMessage{
  position: absolute;
  color: #fff;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  max-width: 600px;
  text-align: center;
  pointer-events: none;
  opacity: 0;
  transition: all 3s ease;
}
#endMessage.show{
  opacity: 1;
}
#endMessage h2{
  font-size: 3vh;
  padding-bottom: 30px;
}
#endMessage h1{
  font-size: 5vh;
}
#endMessage p{
  padding-bottom: 20px;
}
.b{
  display: none;
  color: #fff;
  position :absolute;
  size: 30px;
  left: 50%;
  top: 50%;
  transform: translate(-50%,-50%);
  text-align: center;
}
.key{ display: none; }
@media (pointer: coarse) {
  .key{
    position: absolute;
    left: 20px;
    bottom: 20px;
    font-size: 20px;
    background-color: #fff;
    color: #000;
    padding: 30px;
    border-radius: 10px;
    display: block;
    user-select: none;
    -webkit-touch-callout: none;
  }
}
.right{
  right: 20px;
  left: auto;
}
@media screen and (orientation:portrait) {
  .c{display: none;}
  .b{display: block;}
}</style><div class="c"><canvas></canvas><main><i></i><h1>Johnny Smiter III:</h1><h2>The Curse of the Shadow Walker</h2><b>Begin Quest</b></main><div id="hud">X X X</div><div class="key" data-key="37">A</div><div class="key right" data-key="39">D</div><div id="overlay"></div><div id="endMessage"><h1>404 level not found</h1><h2>We cannot find the level you requested.</h2><p>Johnny completes his (re)quest and returns to the land of Jar, defeating the evil witch, and saving the realm once more.</p><p>Thank you for playing, and remember to join Johnny in his next exciting adventure</p></div></div><b class="b">Please rotate your device&nbsp;to&nbsp;play</b></body></html>