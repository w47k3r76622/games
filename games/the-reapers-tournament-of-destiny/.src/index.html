<!DOCTYPE html><html><head><meta charset="UTF-8"><title>The Reapers: Tournament of Destiny</title><style>*{margin:0;padding:0}body,html{width:100%;height:100%;overflow:hidden;background-color:#000;touch-action:none}canvas{position:absolute;top:0;left:0;right:0;bottom:0;margin:auto;display:block;image-rendering:pixelated;background-color:#000;width:480px;height:456px;border:2px solid #fff}</style><script type="module" crossorigin>
var le=Object.defineProperty;var de=(e,t,i)=>t in e?le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var c=(e,t,i)=>(de(e,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function i(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=i(s);fetch(s.href,a)}})();let st=()=>{},ue="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0);";function qt(e,t){let i=t.parentNode;if(e.setAttribute("data-kontra",""),i){let n=i.querySelector("[data-kontra]:last-of-type")||t;i.insertBefore(e,n.nextSibling)}else document.body.appendChild(e)}function Xt(e,t){let i=e.indexOf(t);if(i!=-1)return e.splice(i,1),!0}let fe={};function Rt(e,...t){(fe[e]||[]).map(i=>i(...t))}let tt,lt,Ht={get(e,t){return t=="_proxy"?!0:st}};function A(){return lt}function me(e,{contextless:t=!1}={}){return tt=document.getElementById(e)||e||document.querySelector("canvas"),t&&(tt=tt||new Proxy({},Ht)),lt=tt.getContext("2d")||new Proxy({},Ht),lt.imageSmoothingEnabled=!1,Rt("init"),{canvas:tt,context:lt}}class Et{constructor({spriteSheet:t,frames:i,frameRate:n,loop:s=!0}){this.spriteSheet=t,this.frames=i,this.frameRate=n,this.loop=s;let{width:a,height:h,margin:m=0}=t.frame;this.width=a,this.height=h,this.margin=m,this._f=0,this._a=0}clone(){return new Et(this)}reset(){this._f=0,this._a=0}update(t=1/60){if(!(!this.loop&&this._f==this.frames.length-1))for(this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render({x:t,y:i,width:n=this.width,height:s=this.height,context:a=A()}){let h=this.frames[this._f]/this.spriteSheet._f|0,m=this.frames[this._f]%this.spriteSheet._f|0;a.drawImage(this.spriteSheet.image,m*this.width+(m*2+1)*this.margin,h*this.height+(h*2+1)*this.margin,this.width,this.height,t,i,n,s)}}function pe(){return new Et(...arguments)}let Gt=/^\//,xe=/\/$/,ye=new WeakMap,ge="";function Dt(e,t){return new URL(e,t).href}function we(e,t){return[e.replace(xe,""),e?t.replace(Gt,""):t].filter(i=>i).join("/")}function Ae(e){return e.split(".").pop()}function be(e){let t=e.replace("."+Ae(e),"");return t.split("/").length==2?t.replace(Gt,""):t}let D={},Se={};function ve(){window.__k||(window.__k={dm:ye,u:Dt,d:Se,i:D})}function Pt(e){return ve(),new Promise((t,i)=>{let n,s,a;if(n=we(ge,e),D[n])return t(D[n]);s=new Image,s.onload=function(){a=Dt(n,window.location.href),D[be(e)]=D[n]=D[a]=this,Rt("assetLoaded",this,e),t(this)},s.onerror=function(){i(n)},s.src=n})}function Y(e,t){return[e,t]=[e,t].map(i=>ke(i)),e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function ke(e){let{x:t=0,y:i=0,width:n,height:s}=e.world||e;return e.mapwidth&&(n=e.mapwidth,s=e.mapheight),e.anchor&&(t-=n*e.anchor.x,i-=s*e.anchor.y),{x:t,y:i,width:n,height:s}}class ut{constructor(t=0,i=0,n={}){this.x=t,this.y=i}add(t){return new ut(this.x+t.x,this.y+t.y,this)}scale(t){return new ut(this.x*t,this.y*t)}length(){return Math.hypot(this.x,this.y)}}function Kt(){return new ut(...arguments)}class Fe{constructor(t){return this.init(t)}init(t={}){this.position=Kt(),this.velocity=Kt(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let i=this.velocity;t&&(i=i.scale(t)),this.position=this.position.add(i),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}isAlive(){return this.ttl>0}_pc(){}}class Lt extends Fe{init({width:t=0,height:i=0,context:n=A(),render:s=this.draw,update:a=this.advance,children:h=[],anchor:m={x:0,y:0},opacity:b=1,...x}={}){this._c=[],super.init({width:t,height:i,context:n,anchor:m,opacity:b,...x}),this._di=!0,this._uw(),this.addChild(h),this._rf=s,this._uf=a}update(t){this._uf(t),this.children.map(i=>i.update&&i.update(t))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y);let i=-this.width*this.anchor.x,n=-this.height*this.anchor.y;(i||n)&&t.translate(i,n),this.context.globalAlpha=this.opacity,this._rf(),(i||n)&&t.translate(-i,-n),this.children.map(a=>a.render&&a.render()),t.restore()}draw(){}_pc(){this._uw(),this.children.map(t=>t._pc())}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:i=0,_wo:n=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=n*this.opacity,this._wx+=t,this._wy+=i}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...t){t.flat().map(i=>{this.children.push(i),i.parent=this,i._pc=i._pc||st,i._pc()})}removeChild(...t){t.flat().map(i=>{Xt(this.children,i)&&(i.parent=null,i._pc())})}get opacity(){return this._opa}set opacity(t){this._opa=t,this._pc()}}function u(){return new Lt(...arguments)}class Te extends Lt{init({image:t,width:i=t?t.width:void 0,height:n=t?t.height:void 0,...s}={}){super.init({image:t,width:i,height:n,...s})}get animations(){return this._a}set animations(t){let i,n;this._a={};for(i in t)this._a[i]=t[i].clone(),n=n||this._a[i];this.currentAnimation=n,this.width=this.width||n.width,this.height=this.height||n.height}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){super.advance(t),this.currentAnimation&&this.currentAnimation.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}function ft(){return new Te(...arguments)}let Re=/(\d+)(\w+)/;function Ee(e){let t=e.match(Re),i=+t[1],n=t[2];return{size:i,unit:n,computed:i}}class Le extends Lt{init({text:t="",textAlign:i="",lineHeight:n=1,font:s=A().font,...a}={}){t=""+t,super.init({text:t,textAlign:i,lineHeight:n,font:s,...a}),this._p()}get width(){return this._w}set width(t){this._d=!0,this._w=t,this._fw=t}get text(){return this._t}set text(t){this._d=!0,this._t=""+t}get font(){return this._f}set font(t){this._d=!0,this._f=t,this._fs=Ee(t).computed}get lineHeight(){return this._lh}set lineHeight(t){this._d=!0,this._lh=t}render(){this._d&&this._p(),super.render()}_p(){this._s=[],this._d=!1;let t=this.context;t.font=this.font,this._s.length||(this._s.push(this.text),this._w=this._fw||t.measureText(this.text).width),this.height=this._fs+(this._s.length-1)*this._fs*this.lineHeight,this._uw()}draw(){let t=0,i=this.textAlign,n=this.context;this._s.map((s,a)=>{n.textBaseline="top",n.textAlign=i,n.fillStyle=this.color,n.font=this.font,n.fillText(s,t,this._fs*this.lineHeight*a)})}}function Yt(){return new Le(...arguments)}function Ce(e){let t=e.canvas;e.clearRect(0,0,t.width,t.height)}function _e({fps:e=60,clearCanvas:t=!0,update:i=st,render:n,context:s=A(),blur:a=!1}={}){let h=0,m=1e3/e,b=1/e,x=t?Ce:st,d,R,y,E,v,_=!0;a||(window.addEventListener("focus",()=>{_=!0}),window.addEventListener("blur",()=>{_=!1}));function g(){if(R=requestAnimationFrame(g),!!_&&(y=performance.now(),E=y-d,d=y,!(E>1e3))){for(Rt("tick"),h+=E;h>=m;)v.update(b),h-=m;x(s),v.render()}}return v={update:i,render:n,isStopped:!0,start(){d=performance.now(),this.isStopped=!1,requestAnimationFrame(g)},stop(){this.isStopped=!0,cancelAnimationFrame(R)}},v}let Ct={},_t={},yt={},it={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function Bt(e=st,t){e._pd&&t.preventDefault(),e(t)}function Me(e){let t=it[e.code],i=Ct[t];yt[t]=!0,Bt(i,e)}function Ve(e){let t=it[e.code],i=_t[t];yt[t]=!1,Bt(i,e)}function Ie(){yt={}}function We(){let e;for(e=0;e<26;e++)it["Key"+String.fromCharCode(e+65)]=String.fromCharCode(e+97);for(e=0;e<10;e++)it["Digit"+e]=it["Numpad"+e]=""+e;window.addEventListener("keydown",Me),window.addEventListener("keyup",Ve),window.addEventListener("blur",Ie)}function H(e,t,{handler:i="keydown",preventDefault:n=!0}={}){let s=i=="keydown"?Ct:_t;t._pd=n,[].concat(e).map(a=>s[a]=t)}function qe(e,{handler:t="keydown"}={}){let i=t=="keydown"?Ct:_t;[].concat(e).map(n=>delete i[n])}function ct(e){return!!yt[e]}function kt(e){let t=[];return e._dn?t.push(e._dn):e.children&&e.children.map(i=>{t=t.concat(kt(i))}),t}class He{constructor({id:t,name:i=t,objects:n=[],context:s=A(),cullObjects:a=!0,cullFunction:h=Y,sortFunction:m,...b}){this._o=[];let x=s.canvas,d=this._dn=document.createElement("section");d.tabIndex=-1,d.style=ue,d.id=t,d.setAttribute("aria-label",i),qt(d,x),Object.assign(this,{id:t,name:i,context:s,cullObjects:a,cullFunction:h,sortFunction:m,...b});let{width:R,height:y}=x,E=R/2,v=y/2;this.camera=u({x:E,y:v,width:R,height:y,context:s,centerX:E,centerY:v,anchor:{x:.5,y:.5},render:this._rf.bind(this)}),this.add(n)}set objects(t){this.remove(this._o),this.add(t)}get objects(){return this._o}add(...t){t.flat().map(i=>{this._o.push(i),kt(i).map(n=>{this._dn.appendChild(n)})})}remove(...t){t.flat().map(i=>{Xt(this._o,i),kt(i).map(n=>{qt(n,this.context)})})}show(){this.hidden=this._dn.hidden=!1;let t=this._o.find(i=>i.focus);t?t.focus():this._dn.focus(),this.onShow()}hide(){this.hidden=this._dn.hidden=!0,this.onHide()}destroy(){this._dn.remove(),this._o.map(t=>t.destroy&&t.destroy())}lookAt(t){let{x:i,y:n}=t.world||t;this.camera.x=i,this.camera.y=n}update(t){this.hidden||this._o.map(i=>i.update&&i.update(t))}_rf(){let{_o:t,context:i,_sx:n,_sy:s,camera:a,sortFunction:h,cullObjects:m,cullFunction:b}=this;i.translate(n,s);let x=t;m&&(x=x.filter(d=>b(a,d))),h&&x.sort(h),x.map(d=>d.render&&d.render())}render(){if(!this.hidden){let{context:t,camera:i}=this,{x:n,y:s,centerX:a,centerY:h}=i;t.save(),this._sx=a-n,this._sy=h-s,t.translate(this._sx,this._sy),i.render(),t.restore()}}onShow(){}onHide(){}}function Mt(){return new He(...arguments)}function Pe(e){if(+e==e)return e;let t=[],i=e.split(".."),n=+i[0],s=+i[1],a=n;if(n<s)for(;a<=s;a++)t.push(a);else for(;a>=s;a--)t.push(a);return t}class Ke{constructor({image:t,frameWidth:i,frameHeight:n,frameMargin:s,animations:a}={}){this.animations={},this.image=t,this.frame={width:i,height:n,margin:s},this._f=t.width/i|0,this.createAnimations(a)}createAnimations(t){let i,n;for(n in t){let{frames:s,frameRate:a,loop:h}=t[n];i=[],[].concat(s).map(m=>{i=i.concat(Pe(m))}),this.animations[n]=pe({spriteSheet:this,frames:i,frameRate:a,loop:h})}}}function Qt(){return new Ke(...arguments)}var S=(e=>(e[e.Fight=0]="Fight",e[e.Rematch=1]="Rematch",e[e.Title=2]="Title",e))(S||{});const Ne={showTrainingData:!1,fightersCanAct:!1,readyTimer:0,roundWinTimer:0,koLabelFlashTimer:0,winScreenOpacity:0,matchWon:!1,whoWon:null,currentScene:S.Title},r=Ne,Oe=(...e)=>Ue(ze(...e)),Ue=(...e)=>{let t=wt.createBufferSource(),i=wt.createBuffer(e.length,e[0].length,k);return e.map((n,s)=>i.getChannelData(s).set(n)),t.buffer=i,t.connect(wt.destination),t.start(),t},ze=(e=1,t=.05,i=220,n=0,s=0,a=.1,h=0,m=1,b=0,x=0,d=0,R=0,y=0,E=0,v=0,_=0,g=0,Z=1,N=0,Vt=0)=>{let M=2*Math.PI,ae=b*=500*M/k**2,he=(0<v?1:-1)*M/4,It=i*=(1+2*t*Math.random()-t)*M/k,gt=[],O=0,Wt=0,w=0,j=1,oe=0,ce=0,P=0,$,X;for(n=99+k*n,N*=k,s*=k,a*=k,g*=k,x*=500*M/k**3,v*=M/k,d*=M/k,R*=k,y=k*y|0,X=n+N+s+a+g|0;w<X;gt[w++]=P)++ce%(100*_|0)||(P=h?1<h?2<h?3<h?Math.sin((O%M)**3):Math.max(Math.min(Math.tan(O),1),-1):1-(2*O/M%2+2)%2:1-4*Math.abs(Math.round(O/M)-O/M):Math.sin(O),P=(y?1-Vt+Vt*Math.sin(2*Math.PI*w/y):1)*(0<P?1:-1)*Math.abs(P)**m*e*Xe*(w<n?w/n:w<n+N?1-(w-n)/N*(1-Z):w<n+N+s?Z:w<X-g?(X-w-g)/a*Z:0),P=g?P/2+(g>w?0:(w<X-g?1:(X-w)/g)*gt[w-g|0]/2):P),$=(i+=b+=x)*Math.sin(Wt*v-he),O+=$-$*E*(1-1e9*(Math.sin(w)+1)%2),Wt+=$-$*E*(1-1e9*(Math.sin(w)**2+1)%2),j&&++j>R&&(i+=d,It+=d,j=0),!y||++oe%y||(i=It,b=ae,j=j||1);return gt},Xe=.3,k=44100,wt=new(window.AudioContext||webkitAudioContext);function Q(e){Oe(...e)}const Ge=[2.23,,247,,.05,.07,4,1.66,,.2,50,,.1,.3,1,.3,.17,.57,.09,.46],De=[,,1725,,.07,.17,,.24,,,-208,.1,,,,.1,,.95,.04],Ye=[1.02,,262,.01,.24,.6,4,.37,,,,,,1.2,-72,.8,,.44,.2,.01],Jt=[2.01,0,64.41,.01,.12,.4,1,1.91,,,-100,,.01,,1,.1,.09,.43,.07],Be=[1.02,,413,.08,.23,.47,2,.01,-5.2,-.6,50,,.07,.1,27,.2,,.46,.2,.39],Qe=({height:e=5,...t}={},i)=>{if(t&&i)return(n,s=0,a=0,h=24,m="#000")=>{[...n].reduce((b,x)=>{const d=h/e,R=t[x.charCodeAt()]||"",y=(((_=>_>0)(R)?R:R.codePointAt())||0).toString(2),E=Math.ceil(y.length/e),v=b+d;return((_,g)=>_.match(new RegExp(`.{${g}}`,"g")))(y.padStart(E*e,0),e).map((_,g)=>[..._].map((Z,N)=>{i.fillStyle=+Z?m:"transparent",i.fillRect(s+v+g*d,a+N*d,d,d)})),b+(E+1)*d},0)}};var Je=Qe;const Ze=[...Array(33),29,,,,,,12,,,,"\u11C4",3,"\u1084",1,1118480,"\u7E3F",31,"\u5EBD","\u56BF","\u709F","\u76B7","\u7EB7","\u421F","\u7EBF","\u76BF",17,,,"\u294A",,"\u42BC",,"\u3E4F","\u7EAE","\u7E31","\u7E2E","\u7EB5","\u7E90","\u{746A6}","\u7C9F","\u47F1","\u4E3F",1020241,"\u7C21",33059359,1024159,"\u7E3F","\u7E9C","\u{7C66F}","\u7E4D","\u76B7","\u43F0","\u7C3F",25363672,32541759,18157905,"\u60F8",18470705,,,,,"\u0421"];var je=Ze;const At=24,mt=40,K=1,pt=100,$e=20,ti=60,ei=120,Zt=30,jt=106,ii=100,ni=130,$t=ii-mt,si=2,ri=1,ai=1.5,Nt=3,bt=1,te={idle:{frames:[0,1],frameRate:1},jabStartup:{frames:2},jabActive:{frames:3},jabRecovery:{frames:2},guard:{frames:4},hit:{frames:5},ko:{frames:6}},St={damage:34,startup:15,active:12,recovery:12,width:18,height:10,y:10,advantage:-10},hi=()=>{H("t",()=>{r.showTrainingData=!r.showTrainingData})},Ot=()=>!!r.showTrainingData;var I=(e=>(e[e.Left=0]="Left",e[e.Right=1]="Right",e))(I||{});class ee{constructor(t){c(this,"doingAttack",null);c(this,"attackAlreadyHit",!1);c(this,"attackingFrames",0);c(this,"startupFrames",0);c(this,"activeFrames",0);c(this,"recoveryFrames",0);c(this,"parryFrames",0);c(this,"isParrying",!1);c(this,"stun",0);c(this,"recoil",0);c(this,"health",pt);c(this,"roundsWon",0);c(this,"roundEndBounces",0);c(this,"movingLeft",!1);c(this,"movingRight",!1);c(this,"canMove",!0);c(this,"position");c(this,"hitboxColor","yellow");c(this,"sprite");c(this,"hurtbox");c(this,"hitbox");c(this,"shadow");this.position=t,this.sprite=ft({x:this.position===0?-12:-24}),this.hurtbox=u({}),this.shadow=ft({x:0,y:0,render:()=>{const i=A();i.scale(1,.2),i.beginPath(),i.fillStyle="#202020",i.arc(12,320,10,0,2*Math.PI),i.fill()}}),this.hitbox=u({width:At,height:mt,x:t===0?Zt:jt,y:$t,children:[this.sprite,this.shadow],properties:{type:"fighterHitbox"},render:()=>{if(Ot()){const i=A();i.strokeStyle=this.hitboxColor,i.lineWidth=2,i.strokeRect(0,0,At,mt)}}})}addSpriteSheet(t){const i=Qt({image:t,frameWidth:60,frameHeight:37,animations:te});this.sprite.animations=i.animations}handleMovement(){this.position===0&&(this.canMove?(this.movingRight=["d"].some(ct),this.movingLeft=["s"].some(ct)):(this.movingRight=!1,this.movingLeft=!1),this.movingLeft?this.move(0):this.movingRight?this.move(1):this.canMove&&this.stop()),this.position===1&&(this.canMove?(this.movingRight=["j"].some(ct),this.movingLeft=["h"].some(ct)):(this.movingLeft=!1,this.movingRight=!1),this.movingLeft?this.move(0):this.movingRight?this.move(1):this.canMove&&this.stop())}handleParry(){r.fightersCanAct&&this.doingAttack===null&&this.stun===0&&this.recoil===0&&this.parryFrames===0&&(this.position===0&&H("c",()=>{this.stop(),this.parry()}),this.position===1&&H("n",()=>{this.stop(),this.parry()})),this.parryFrames>0&&this.parryFrames--,this.isParrying&&this.parryFrames===0&&(this.isParrying=!1,this.canMove=!0,this.hitboxColor="yellow",this.sprite.playAnimation("idle"))}handleAttack(){r.fightersCanAct&&this.doingAttack===null&&this.stun===0&&this.recoil===0&&this.parryFrames===0&&(this.position===0&&H("x",()=>{this.stop(),this.attack(St)}),this.position===1&&H("b",()=>{this.stop(),this.attack(St)})),this.attackingFrames>0&&(this.attackingFrames--,this.startupFrames>0&&this.startupFrames--,this.doingAttack&&this.startupFrames===0&&this.activeFrames>0&&this.activeFrames===this.doingAttack.active&&(this.hurtbox=u({width:this.doingAttack.width,height:this.doingAttack.height,y:this.doingAttack.y,ttl:this.doingAttack.active,x:this.position===0?this.hitbox.width:-this.doingAttack.width,render:function(){if(Ot()){const t=A();t.strokeStyle="red",t.lineWidth=2,t.strokeRect(0,0,this.width,this.height)}}}),this.doingAttack===St&&this.sprite.playAnimation("jabActive"),this.hitbox.addChild(this.hurtbox),this.activeFrames--),this.doingAttack&&this.activeFrames>0&&this.activeFrames<this.doingAttack.active&&this.activeFrames--,this.recoveryFrames>0&&this.activeFrames===0&&(this.hitboxColor="lightgrey",this.sprite.playAnimation("jabRecovery"),this.recoveryFrames--)),this.attackingFrames===0&&!this.isParrying&&!this.canMove&&r.fightersCanAct==!0&&(this.canMove=!0,this.hitboxColor="yellow",this.attackAlreadyHit=!1,this.sprite.playAnimation("idle")),this.hurtbox.ttl===0&&(this.hitbox.removeChild(this.hurtbox),this.hurtbox=u({}),this.doingAttack=null)}handleStun(){this.recoil>0&&(this.sprite.playAnimation("hit"),this.recoil--,this.position==0?(this.hitbox.x-=1,this.hitbox.x<0&&(this.hitbox.x=0)):(this.hitbox.x+=1,this.hitbox.x+this.hitbox.width>f.width&&(this.hitbox.x=f.width-this.hitbox.width))),this.stun>0&&(this.hitboxColor="red",this.canMove=!1,this.stop(),this.stun--,this.stun===0&&this.health>0&&(this.canMove=!0,this.hitboxColor="yellow",this.sprite.playAnimation("idle"))),this.stun>0&&this.isParrying&&(this.hitboxColor="purple")}move(t){this.canMove&&(t===0?this.hitbox.dx=-K:this.hitbox.dx=K,this.hitbox.x<=0&&t===0&&(this.hitbox.dx=0),this.hitbox.x>=f.width-At&&t===1&&(this.hitbox.dx=0))}stop(){this.hitbox.dx=0}parry(){this.parryFrames===0&&this.canMove&&(this.stun=ti,this.parryFrames=$e,this.canMove=!1,this.isParrying=!0,this.sprite.playAnimation("guard"))}attack(t){if(this.attackingFrames===0&&this.canMove){Q(Ge);const i=t.startup+t.active+t.recovery;this.doingAttack=t,this.startupFrames=t.startup,this.activeFrames=t.active,this.recoveryFrames=t.recovery,this.attackingFrames=i,this.hitboxColor="blue",this.canMove=!1,this.sprite.playAnimation("jabStartup")}}update(){this.handleMovement(),this.handleAttack(),this.handleStun(),this.handleParry(),this.hitbox.update()}render(){this.hitbox.render()}}const{canvas:f}=me("game");We();const p=Je(je,A()),o=new ee(I.Left),l=new ee(I.Right),oi=u({x:0,y:0,width:160,height:132,render:function(){const e=A(),t=e.createLinearGradient(0,0,0,132);t.addColorStop(0,"dimgray"),t.addColorStop(1,"darkgray"),e.fillStyle=t,e.fillRect(this.x,this.y,this.width,this.height)}}),V=Mt({id:"fightScene"}),J=Mt({id:"rematchScene"}),q=Mt({id:"titleScene",onShow:function(){this.objects.forEach(e=>{e.opacity=0})}}),ci="data:image/webp;base64,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",li="data:image/webp;base64,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";async function Ft(){const e=await Pt(ci),t=await Pt(li);return{player1Image:e,player2Image:t}}const vt=1;let L=0,W=0,z=!0,B=null,rt=0;const F=ft({width:60,height:37}),T=ft({width:60,height:37});let at="",ht="";const di=u({x:24,y:130,render:function(){p("REMATCH",0,0,5,"black")}}),ui=u({x:84,y:130,render:function(){p("EXIT TO MENU",0,0,5,"black")}}),C=Yt({x:12,y:128,text:"\u{1F525}",color:"black",font:"8px monospace"}),fi=u({x:24,y:20,render:function(){p(`${r.whoWon} WINS!`,1,1,10,"grey"),p(`${r.whoWon} WINS!`,0,0,10,"black")}}),mi=u({x:3,y:40,render:function(){p(at,7,0,5,"black"),p(ht,7,8,5,"black")}});function Ut(){C.x===12?C.x=72:C.x=12}function pi(e){C.x===12&&L===0?(z=!1,L+=e,B=S.Fight):C.x===72&&L===0&&(z=!1,L+=e,B=S.Title)}function xi(e){L>0&&L<vt&&(W===0&&(W++,C.text==="\u{1F525}"?C.text="":C.text="\u{1F525}"),W>0&&W<8&&W++,W===8&&(W=0),L+=e),B===S.Fight&&L>=vt&&(L=0,W=0,z=!0,C.text="\u{1F525}",xt(!0),r.currentScene=S.Fight,V.show(),rt=0,at="",ht="",B=null,ot.removeChild(F,T)),B===S.Title&&L>=vt&&(L=0,W=0,z=!0,C.text="\u{1F525}",xt(!0),r.currentScene=S.Title,q.show(),rt=0,at="",ht="",B=null,ot.removeChild(F,T))}function zt(e){return Qt({image:e,frameWidth:60,frameHeight:37,animations:te})}async function yi(e){e==="PLAYER 1"?(at="NOMIQUIEL CARRIES ON GIVING THEIR",ht="BREATH TO THE LIVING WORLDS..."):(at="OMIQUIEL BEGINS THEIR DEADLY FEAST",ht="OF THE LIVING REALMS..."),F.x=e==="PLAYER 1"?-60:f.width,F.y=70,await Ft().then(t=>{const i=zt(e==="PLAYER 1"?t.player1Image:t.player2Image);F.animations=i.animations}),T.x=e==="PLAYER 1"?0:f.width,T.y=70,await Ft().then(t=>{const i=zt(e==="PLAYER 1"?t.player2Image:t.player1Image);T.animations=i.animations}),T.playAnimation("ko"),T.dx=e==="PLAYER 1"?200:-200,ot.addChild(F,T),C.x=12,rt++}function gi(e){e==="PLAYER 1"?(T.x>=f.width-T.width&&(T.dx=0,F.dx=40),F.x>=10&&(F.dx=0)):(T.x<=0&&(T.dx=0,F.dx=-40),F.x<=f.width-F.width-10&&(F.dx=0)),rt++}const ot=u({x:0,y:0,width:f.width,height:f.height,children:[fi,mi,di,ui,C],render:async function(){const e=A();e.fillStyle="white",e.fillRect(0,0,f.width,f.height),rt<=1&&await yi(r.whoWon)},update:e=>{H("d",()=>{z&&Ut()}),H("s",()=>{z&&Ut()}),H("x",()=>{z&&e!==void 0&&(Q(Jt),pi(e))}),L>0&&e!==void 0&&xi(e),gi(r.whoWon)}});function xt(e=!1){[o,l].forEach(i=>{i.doingAttack=null,i.attackAlreadyHit=!1,i.attackingFrames=0,i.startupFrames=0,i.activeFrames=0,i.recoveryFrames=0,i.stun=0,i.recoil=0,i.health=pt,i.movingLeft=!1,i.movingRight=!1,i.canMove=!0,i.hitboxColor="yellow",i.roundEndBounces=0,i.position===I.Left?i.hitbox.x=Zt:i.hitbox.x=jt,i.hitbox.y=$t,i.shadow.y=0,i.sprite.playAnimation("idle"),i.hitbox.removeChild(i.hurtbox),i.hurtbox=u({}),e&&(i.roundsWon=0)}),r.readyTimer=0,e&&(J.destroy(),J.remove([ot]),r.matchWon=!1,r.winScreenOpacity=0,r.koLabelFlashTimer=0)}let U=0,et="",G=0;async function wi(){const e=u({x:18,y:84,render:function(){p("TOURNAMENT OF",0,0,10,"white"),p("DESTINY",11,13,20,"grey"),p("DESTINY",10,12,20,"white")}}),t=u({x:14,y:33,render:function(){p("THE REAPERS",0,0,15,"darkred"),p("THE REAPERS",1,1,15,"red")}}),i=u({x:50,y:132,render:function(){p(et,0,0,5,"orangered")}});q.add([e,t,i]),q.update=function(){q.objects.forEach(n=>{n.opacity<1&&(n.opacity+=.01),n.update()}),U<=60?(et="",U++):U>=61&&U<=120?(et="PRESS X TO START",U++):U=0,G<=120&&G>=1&&(G++,et=""),G===121&&(q.destroy(),r.currentScene=S.Fight,xt(!0),V.show(),U=0,et="",G=0),H("x",()=>{qe("x"),Q(Jt),G++})},q.render=function(){this.objects.forEach(n=>{n.render()})}}class ie{constructor(t){c(this,"owner");c(this,"healthBar");c(this,"currentHealthBar");this.owner=t;function i(n){return(pt-n)/pt*64}this.currentHealthBar=u({x:this.owner.position===I.Left?0:64,y:0,width:0,height:4,render:function(){const n=A();n.fillStyle="red",n.fillRect(0,0,this.width,this.height)},update:()=>{this.owner.position===I.Left?this.currentHealthBar.width=i(this.owner.health):this.currentHealthBar.width=-i(this.owner.health)}}),this.healthBar=u({x:this.owner.position===I.Left?8:90,y:18,width:64,height:4,children:[this.currentHealthBar],render:function(){const n=A();n.fillStyle="yellow",n.fillRect(0,0,this.width,this.height)}})}}class ne{constructor(t){c(this,"owner");c(this,"roundCounter");this.owner=t,this.roundCounter=Yt({x:t.position===I.Left?8:142,y:24,text:this.drawRoundCircles(),font:"4px monospace",update:()=>{this.updateRoundCounter()}})}drawRoundCircles(){return this.owner.roundsWon===0?"\u26AA\uFE0F \u26AA\uFE0F":this.owner.roundsWon===1?"\u{1F7E2} \u26AA\uFE0F":"\u{1F7E2} \u{1F7E2}"}updateRoundCounter(){this.roundCounter.text=this.drawRoundCircles()}}const Ai=new ie(o),bi=new ie(l),Si=new ne(o),vi=new ne(l);let dt="white";const ki=u({x:0,y:0,render:function(){p("NOMIQUIEL",7,12,5,"white")}}),Fi=u({x:0,y:0,render:function(){p("OMIQUIEL",119,12,5,"white")}}),Ti=u({x:0,y:0,render:function(){p("KO",71,15,10,dt)}});function Ri(){dt==="white"?dt="red":dt="white"}const Ei=u({x:0,y:0,width:f.width,height:32,children:[Ai.healthBar,bi.healthBar,Si.roundCounter,vi.roundCounter,ki,Fi,Ti],render:function(){const e=A();e.fillStyle="black",e.fillRect(0,0,f.width,32)}});let Tt="";const se=u({x:0,y:71,render:function(){p(Tt,1,1,10,"black"),p(Tt,0,0,10,"orangered")}});function nt(e){Tt=e;const t=e.length*8,i=Math.round(f.width/2-t/2);se.x=i}const Li=u({x:0,y:0,width:f.width,height:f.height,render:function(){const e=A();e.fillStyle=`rgba(255, 255, 255, ${r.winScreenOpacity})`,e.fillRect(0,0,f.width,f.height)}});function re(e){const t=e.roundEndBounces===0?1.6:0;e.hitbox.y<ni-mt?(e.hitbox.dy=2,e.hitbox.x+=e.position===I.Left?-1:1,e.shadow.y-=t):e.roundEndBounces<3?(e.hitbox.dy-=10,e.roundEndBounces++):e.hitbox.dy=0}function Ci(e){e.hitbox.dx+=e.position===I.Left?-5:5}function _i(e){e.roundsWon!==si?(nt(e===o?"PLAYER 1 WINS!":"PLAYER 2 WINS!"),re(e===o?l:o)):(Ci(e===o?l:o),r.matchWon=!0)}function Mi(){V.hide(),r.currentScene=S.Rematch,J.add([ot]),J.show()}function Vi(e){e&&(o.health>0&&l.health>0?(r.fightersCanAct===!1&&r.readyTimer>ai&&(nt(""),r.fightersCanAct=!0,r.roundWinTimer=0),r.fightersCanAct===!1&&r.readyTimer>ri&&nt("FIGHT!"),r.fightersCanAct===!1&&r.readyTimer===0&&nt("GET READY"),r.readyTimer+=e):(r.roundWinTimer===0&&(o.canMove=!1,l.canMove=!1,r.fightersCanAct=!1,r.roundWinTimer+=e,_i(o.health>0?o:l)),r.roundWinTimer>0&&r.roundWinTimer<Nt&&r.matchWon===!1&&(re(o.health>0?l:o),r.koLabelFlashTimer===0?(r.koLabelFlashTimer++,Ri()):r.koLabelFlashTimer<8?r.koLabelFlashTimer++:r.koLabelFlashTimer=0,r.roundWinTimer+=e),r.roundWinTimer>=Nt&&r.matchWon===!1&&(r.roundWinTimer=0,xt()),r.roundWinTimer>0&&r.roundWinTimer<bt&&r.matchWon===!0&&(r.winScreenOpacity=1/bt*r.roundWinTimer,r.roundWinTimer+=e),r.roundWinTimer>=bt&&r.matchWon===!0&&(r.whoWon=o.health>0?"PLAYER 1":"PLAYER 2",Mi())))}function Ii(){if(Y(o.hitbox,l.hitbox)&&(o.hitbox.dx!=0&&l.hitbox.dx===0?(l.hitbox.x+l.hitbox.width<f.width&&(l.hitbox.x+=K),l.hitbox.x+l.hitbox.width===f.width&&(o.hitbox.x-=K)):l.hitbox.dx!=0&&o.hitbox.dx===0?(o.hitbox.x>0&&(o.hitbox.x-=K),o.hitbox.x===0&&(l.hitbox.x+=K)):o.hitbox.dx>0&&l.hitbox.dx<0&&(o.hitbox.x+=-K,l.hitbox.x+=K)),Y(o.hurtbox,l.hitbox)||Y(l.hurtbox,o.hitbox)){const e=Y(o.hurtbox,l.hitbox)?l:o,t=Y(o.hurtbox,l.hitbox)?o:l;t.doingAttack&&(!t.attackAlreadyHit&&!e.isParrying?(e.hitboxColor="red",t.doingAttack.damage>=e.health?(e.sprite.playAnimation("ko"),Q(Ye),t.attackAlreadyHit=!0,r.fightersCanAct=!1,e.health=0,t.roundsWon+=1):(e.sprite.playAnimation("hit"),Q(Be),e.recoil=10,e.health-=t.doingAttack.damage,e.canMove=!1,e.stun=t.attackingFrames+t.doingAttack.advantage,t.attackAlreadyHit=!0)):!t.attackAlreadyHit&&e.isParrying&&(Q(De),e.sprite.playAnimation("idle"),e.hitboxColor="yellow",e.canMove=!0,e.parryFrames=0,e.isParrying=!1,t.recoil=10,t.stun=ei,t.startupFrames=0,t.activeFrames=0,t.recoveryFrames=0,t.doingAttack=null,t.attackAlreadyHit=!1,t.sprite.playAnimation("hit")))}}function Wi(){V.add([oi,o,l,Ei,se,Li]),V.update=function(e){hi(),Ii(),r.fightersCanAct===!1&&Vi(e),V.objects.forEach(t=>{t.update()})},V.render=function(){V.objects.forEach(e=>{e.render()})}}window.addEventListener("DOMContentLoaded",async()=>{const{player1Image:e,player2Image:t}=await Ft();o.addSpriteSheet(e),l.addSpriteSheet(t),await wi(),Wi(),q.show(),_e({update:function(n){r.currentScene===S.Fight?V.update(n):r.currentScene===S.Rematch?J.update(n):q.update(n)},render:function(){r.currentScene===S.Fight?V.render():r.currentScene===S.Rematch?J.render():q.render()}}).start()});

</script></head><body><canvas id="game" width="160" height="152"></canvas></body></html>