<!DOCTYPE html><!DOCTYPE html><html><head> <meta charset="utf-8"/> <title>js13k 2020 - 850x500</title><style>*{padding:0;margin:0}canvas{background:#000000;display:block;margin:0 auto}</style></head><body><canvas id="myCanvas" width="850" height="500"></canvas><script>var canvas=document.getElementById("myCanvas");var ctx=canvas.getContext("2d");var skip=0;var preSetupCarregado=false;var loadingInicial=0;var textosFrame=0;var textosFrameT1=45;var textosFrameT2=15;var bonus=0;var bonus2=0;var dialogoPagina=1;var dialogoMargem=100;var randomQdpassante=canvas.width*(Math.floor((Math.random()*10)+1)/10);var dialogoLinha1=".";var dialogoLinha2=".";var dialogoLinha3=".";var dialogoLinha4=".";var dialogoLinha5=".";var dialogoLinha6=".";var dialogoLinha7=".";var dialogoLinha8=".";var dialogoLinha9=".";var dialogoLinha10=".";var dialogoLinha11=".";var dialogoLinha12=".";var cenaCarregada=false;var jogadorLado=20;var jogadorFrame=0;var rightPressed=false;var leftPressed=false;var upPressed=false;var downPressed=false;var enterPressed=false;var enterSolto=true;var xPressed=false;var somParedeUp=true;var somParedeDown=true;var somParedeLeft=true;var somParedeRight=true;var notas={'Do0':16.35,'Do#0':17.32,'Reb0':17.32,'Re0':18.35,'Re#0':19.45,'Mib0':19.45,'Mi0':20.60,'Fa0':21.83,'Fa#0':23.12,'Solb0':23.12,'Sol0':24.50,'Sol#0':25.96,'Lab0':25.96,'La0':27.50,'La#0':29.14,'Sib0':29.14,'Si0':30.87,'Do1':32.70,'Do#1':34.65,'Reb1':34.65,'Re1':36.71,'Re#1':38.89,'Mib1':38.89,'Mi1':41.20,'Fa1':43.65,'Fa#1':46.25,'Solb1':46.25,'Sol1':49.00,'Sol#1':51.91,'Lab1':51.91,'La1':55.00,'La#1':58.27,'Sib1':58.27,'Si1':61.74,'Do2':65.41,'Do#2':69.30,'Reb2':69.30,'Re2':73.42,'Re#2':77.78,'Mib2':77.78,'Mi2':82.41,'Fa2':87.31,'Fa#2':92.50,'Solb2':92.50,'Sol2':98.00,'Sol#2':103.83,'Lab2':103.83,'La2':110.00,'La#2':116.54,'Sib2':116.54,'Si2':123.47,'Do3':130.81,'Do#3':138.59,'Reb3':138.59,'Re3':146.83,'Re#3':155.56,'Mib3':155.56,'Mi3':164.81,'Fa3':174.61,'Fa#3':185.00,'Solb3':185.00,'Sol3':196.00,'Sol#3':207.65,'Lab3':207.65,'La3':220.00,'La#3':233.08,'Sib3':233.08,'Si3':246.94,'Do4':261.63,'Do#4':277.18,'Reb4':277.18,'Re4':293.66,'Re#4':311.13,'Mib4':311.13,'Mi4':329.63,'Fa4':349.23,'Fa#4':369.99,'Solb4':369.99,'Sol4':392.00,'Sol#4':415.30,'Lab4':415.30,'La4':440.00,'La#4':466.16,'Sib4':466.16,'Si4':493.88,'Do5':523.25,'Do#5':554.37,'Reb5':554.37,'Re5':587.33,'Re#5':622.25,'Mib5':622.25,'Mi5':659.26,'Fa5':698.46,'Fa#5':739.99,'Solb5':739.99,'Sol5':783.99,'Sol#5':830.61,'Lab5':830.61,'La5':880.00,'La#5':932.33,'Sib5':932.33,'Si5':987.77,'Do6':1046.50,'Do#6':1108.73,'Reb6':1108.73,'Re6':1174.66,'Re#6':1244.51,'Mib6':1244.51,'Mi6':1318.51,'Fa6':1396.91,'Fa#6':1479.98,'Solb6':1479.98,'Sol6':1567.98,'Sol#6':1661.22,'Lab6':1661.22,'La6':1760.00,'La#6':1864.66,'Sib6':1864.66,'Si6':1975.53,'Do7':2093.00,'Do#7':2217.46,'Reb7':2217.46,'Re7':2349.32,'Re#7':2489.02,'Mib7':2489.02,'Mi7':2637.02,'Fa7':2793.83,'Fa#7':2959.96,'Solb7':2959.96,'Sol7':3135.96,'Sol#7':3322.44,'Lab7':3322.44,'La7':3520.00,'La#7':3729.31,'Sib7':3729.31,'Si7':3951.07,'Do8':4186.01};class Jogador{constructor(x,y,lado,cor){this.x=x;this.y=y;this.lado=lado;this.cor=cor;this.xOriginal=this.x;this.yOriginal=this.y;this.corOriginal=this.cor;this.velocidade=3;this.distancia=0;this.loopPego=true;this.pego=false;this.podeSomPortal=true;this.tipo=0}desenha(){ctx.beginPath();ctx.rect(this.x,this.y,this.lado,this.lado);ctx.fillStyle=this.cor;ctx.fill();ctx.closePath()}moeda(){for(let moeda=0;moeda<moedas.length;moeda+=1){if(moedas[moeda].pega==false&&moedas[moeda].x-moedas[moeda].raio*2.5<this.x+this.lado/2&&moedas[moeda].x+moedas[moeda].raio*2.5>this.x+this.lado/2&&moedas[moeda].y-moedas[moeda].raio*2.5<this.y+this.lado/2&&moedas[moeda].y+moedas[moeda].raio*2.5>this.y+this.lado/2){somMoeda();moedas[moeda].pega=true;ui.contaMoedas+=1;ui.bitsT=10}}}portal(){if(portal1.x-portal1.raio*2.5<this.x+this.lado/2&&portal1.x+portal1.raio*2.5>this.x+this.lado/2&&portal1.y-portal1.raio*2.5<this.y+this.lado/2&&portal1.y+portal1.raio*2.5>this.y+this.lado/2){if(this.podeSomPortal==true){this.podeSomPortal=false;somPortal()}palco.cena=portal1.destino;cenaCarregada=false}}inimigoPegou(){for(let inimigo=0;inimigo<inimigos.length;inimigo+=1){this.pego=(this.x+this.lado/2>inimigos[inimigo].viMin1x&&this.y+this.lado/2>inimigos[inimigo].viMin1y&&this.x+this.lado/2<inimigos[inimigo].viMax1x&&this.y+this.lado/2<inimigos[inimigo].viMax1y||this.x+this.lado/2>inimigos[inimigo].viMin2x&&this.y+this.lado/2>inimigos[inimigo].viMin2y&&this.x+this.lado/2<inimigos[inimigo].viMax2x&&this.y+this.lado/2<inimigos[inimigo].viMax2y);if(this.pego==true){this.tipo=inimigos[inimigo].tipo;break}}if(this.pego==false){this.loopPego=true}if(this.pego){if(this.loopPego==true){this.cor="red";somPego();if(this.tipo=="pusher"){this.x=this.xOriginal;this.y=this.yOriginal;somPortal()}else{ui.contaMoedas=0}if(this.tipo!="pusher"){for(var i=0;i<moedas.length;i+=1){moedas[i].pega=false}}this.loopPego=false}}else{this.cor=this.corOriginal}}move(){if(rightPressed){somParedeLeft=true;var livre=true;for(var parede=0;parede<paredes.length;parede+=1){livre=(paredes[parede].yMin-this.lado>this.y||this.y>paredes[parede].yMax)||(paredes[parede].xMin-this.lado-this.velocidade>this.x||this.x>paredes[parede].xMax);if(livre==false){this.tipo=paredes[parede].tipo;if(this.tipo=="pusher"){this.xOriginal=parseInt(paredes[parede].x+paredes[parede].largura/2-this.lado/2);this.yOriginal=parseInt(paredes[parede].y+paredes[parede].altura/2-this.lado/2)}break}}if(((this.x<canvas.width-this.lado-7)&&livre)||(this.x<canvas.width-this.lado-7)&&this.tipo=="pusher"){this.tipo=0;this.x+=this.velocidade}else{if(somParedeRight==true){this.tipo=0;somParedeRight=false;somParede()}}}if(leftPressed){somParedeRight=true;var livre=true;for(var parede=0;parede<paredes.length;parede+=1){livre=(paredes[parede].yMin-this.lado>this.y||this.y>paredes[parede].yMax)||(paredes[parede].xMin>this.x||this.x>paredes[parede].xMax+this.velocidade);if(livre==false){this.tipo=paredes[parede].tipo;if(this.tipo=="pusher"){this.xOriginal=paredes[parede].x+paredes[parede].largura/2-this.lado/2;this.yOriginal=paredes[parede].y+paredes[parede].altura/2-this.lado/2}break}}if(((this.x>0+7)&&livre)||(this.x>0+7)&&this.tipo=="pusher"){this.tipo=0;this.x-=this.velocidade}else{if(somParedeLeft==true){this.tipo=0;somParedeLeft=false;somParede()}}}if(upPressed){somParedeDown=true;var livre=true;for(var parede=0;parede<paredes.length;parede+=1){livre=(paredes[parede].yMin>this.y||this.y>paredes[parede].yMax+this.velocidade)||(paredes[parede].xMin-this.lado>this.x||this.x>paredes[parede].xMax);if(livre==false){this.tipo=paredes[parede].tipo;if(this.tipo=="pusher"){this.xOriginal=paredes[parede].x+paredes[parede].largura/2-this.lado/2;this.yOriginal=paredes[parede].y+paredes[parede].altura/2-this.lado/2}break}}if(((this.y>0+7)&&livre)||(this.y>0+7)&&this.tipo=="pusher"){this.tipo=0;this.y-=this.velocidade}else{if(somParedeUp==true){this.tipo=0;somParedeUp=false;somParede()}}}if(downPressed){somParedeUp=true;var livre=true;for(var parede=0;parede<paredes.length;parede+=1){livre=(paredes[parede].yMin-this.lado-this.velocidade>this.y||this.y>paredes[parede].yMax)||(paredes[parede].xMin-this.lado>this.x||this.x>paredes[parede].xMax);if(livre==false){this.tipo=paredes[parede].tipo;if(this.tipo=="pusher"){this.xOriginal=paredes[parede].x+paredes[parede].largura/2-this.lado/2;this.yOriginal=paredes[parede].y+paredes[parede].altura/2-this.lado/2}break}}if(((this.y<canvas.height-this.lado-7)&&livre)||(this.y<canvas.height-this.lado-7)&&this.tipo=="pusher"){this.tipo=0;this.y+=this.velocidade}else{if(somParedeDown==true){this.tipo=0;somParedeDown=false;somParede()}}}}}class UI{constructor(corFundo1,corFundo2,corTexto1,corTexto2){this.bitsCorFundo1=corFundo1;this.bitsCorFundo2=corFundo2;this.bitsCorTexto1=corTexto1;this.bitsCorTexto2=corTexto2;this.bitsCorFundo=this.bitsCorFundo1;this.bitsCorTexto=this.bitsCorTexto1;this.bitsT=0;this.contaMoedas=0}contaBits(){ctx.beginPath();ctx.rect(10,480,50,30);ctx.fillStyle=this.bitsCorFundo;ctx.fill();ctx.closePath();if(this.bitsT>0){this.bitsCorFundo=this.bitsCorFundo2;this.bitsCorTexto=this.bitsCorTexto2;this.bitsT-=1}else{this.bitsCorFundo=this.bitsCorFundo1;this.bitsCorTexto=this.bitsCorTexto1}ctx.font="10px Arial";ctx.fillStyle=this.bitsCorTexto;ctx.fillText("bits ["+this.contaMoedas+"]",20,495);}}class Qdpassante{constructor(x,y,lado,cor,velocidade){this.x=x;this.y=y;this.lado=lado;this.cor=cor;this.velocidade=velocidade}passa(){ctx.beginPath();ctx.rect(this.x,this.y,this.lado,this.lado);ctx.fillStyle=this.cor;ctx.fill();ctx.closePath();this.y-=this.velocidade;if(this.y<0){this.y=700;this.x=canvas.width*(Math.floor((Math.random()*100)+1)/100)}}}class Inimigo{constructor(x,y,lado,cor,sentido,passoMin,passoMax,visaoMax,velocidade,tipo){this.x=x;this.y=y;this.lado=lado;this.cor=cor;this.sentido=sentido;this.passoMin=passoMin;this.passoMax=passoMax;this.visaoMax=visaoMax;this.velocidade=velocidade;this.tipo=tipo;this.passoDirecao=1;this.viV1x=1;this.viV1y=1;this.viV2x=1;this.viV2y=1;this.viV3x=1;this.viV3y=1;this.viV4x=1;this.viV4y=1;this.viMin1x=1;this.viMin1y=1;this.viMax1x=1;this.viMax1y=1;this.viMin2x=1;this.viMin2y=1;this.viMax2x=1;this.viMax2y=1;this.frame=0}desenha(){if(this.sentido=="horizontal"){if(this.passoDirecao==-1){this.viV1x=this.x-this.visaoMax;this.viV1y=this.y-this.lado;this.viV2x=this.x-this.visaoMax;this.viV2y=this.y+this.lado*2;this.viV3x=this.x+this.lado/2;this.viV3y=this.y+this.lado;this.viV4x=this.x+this.lado/2;this.viV4y=this.y;this.viMin1x=this.viV1x;this.viMin1y=this.viV1y;this.viMax1x=this.viV1x+this.visaoMax*7/8;this.viMax1y=this.viV2y;this.viMin2x=this.viV4x-this.visaoMax*2/3;this.viMin2y=this.viV4y;this.viMax2x=this.viV3x;this.viMax2y=this.viV3y}else{this.viV4x=this.x+this.lado+this.visaoMax;this.viV4y=this.y-this.lado;this.viV3x=this.x+this.lado+this.visaoMax;this.viV3y=this.y+this.lado*2;this.viV2x=this.x+this.lado/2;this.viV2y=this.y+this.lado;this.viV1x=this.x+this.lado/2;this.viV1y=this.y;this.viMin1x=this.viV1x;this.viMin1y=this.viV1y;this.viMax1x=this.viV1x+this.visaoMax*2/3;this.viMax1y=this.viV2y;this.viMin2x=this.viV4x-this.visaoMax*7/8;this.viMin2y=this.viV4y;this.viMax2x=this.viV3x;this.viMax2y=this.viV3y}}if(this.sentido=="vertical"){if(this.passoDirecao==-1){this.viV1x=this.x+this.lado*2;this.viV1y=this.y-this.visaoMax;this.viV2x=this.x-this.lado;this.viV2y=this.y-this.visaoMax;this.viV3x=this.x;this.viV3y=this.y+this.lado/2;this.viV4x=this.x+this.lado;this.viV4y=this.y+this.lado/2;this.viMin1x=this.viV3x;this.viMin1y=this.viV3y-this.visaoMax*2/3;this.viMax1x=this.viV4x;this.viMax1y=this.viV4y;this.viMin2x=this.viV2x;this.viMin2y=this.viV2y;this.viMax2x=this.viV1x;this.viMax2y=this.viV1y+this.visaoMax*7/8}else{this.viV1x=this.x+this.lado*2;this.viV1y=this.y+this.lado+this.visaoMax;this.viV2x=this.x-this.lado;this.viV2y=this.y+this.lado+this.visaoMax;this.viV3x=this.x;this.viV3y=this.y+this.lado/2;this.viV4x=this.x+this.lado;this.viV4y=this.y+this.lado/2;this.viMin1x=this.viV2x;this.viMin1y=this.viV2y-this.visaoMax*7/8;this.viMax1x=this.viV1x;this.viMax1y=this.viV1y;this.viMin2x=this.viV3x;this.viMin2y=this.viV3y;this.viMax2x=this.viV4x;this.viMax2y=this.viV4y+this.visaoMax*2/3}}ctx.beginPath();ctx.moveTo(this.viV1x,this.viV1y);ctx.lineTo(this.viV2x,this.viV2y);ctx.lineTo(this.viV3x,this.viV3y);ctx.lineTo(this.viV4x,this.viV4y);ctx.lineTo(this.viV1x,this.viV1y);if(this.tipo=="pusher"){ctx.fillStyle="#0080ff"}else{ctx.fillStyle="yellow"}ctx.fill();ctx.closePath();if(this.frame<15){ctx.beginPath();if(this.sentido=="horizontal"){ctx.rect(this.x,this.y+1,this.lado,this.lado)}else{ctx.rect(this.x+1,this.y,this.lado,this.lado)}ctx.fillStyle=this.cor;ctx.fill();ctx.closePath();this.frame=this.frame+1}else{ctx.beginPath();if(this.sentido=="horizontal"){ctx.rect(this.x,this.y-1,this.lado,this.lado)}else{ctx.rect(this.x-1,this.y,this.lado,this.lado)}ctx.fillStyle=this.cor;ctx.fill();ctx.closePath();if(this.frame<29){this.frame=this.frame+1}else{this.frame=0}}}move(){if(this.sentido=="horizontal"){this.x+=this.passoDirecao*this.velocidade;if(this.x>this.passoMin){this.passoDirecao=this.passoDirecao*(-1)}if(this.x<this.passoMax){this.passoDirecao=this.passoDirecao*(-1)}}if(this.sentido=="vertical"){this.y+=this.passoDirecao*this.velocidade;if(this.y>this.passoMin){this.passoDirecao=this.passoDirecao*(-1)}if(this.y<this.passoMax){this.passoDirecao=this.passoDirecao*(-1)}}}}class Parede{constructor(x,y,largura,altura,cor,tipo,quantasMoedas){this.x=x;this.y=y;this.largura=largura;this.altura=altura;this.cor=cor;this.tipo=tipo;this.quantasMoedas=quantasMoedas;this.xMin=x;this.yMin=y;this.xMax=x+largura;this.yMax=y+altura;this.corTexto="white";this.corTextoOriginal=this.corTexto;this.quadCor=this.cor;this.xMinOriginal=this.xMin;this.yMinOriginal=this.yMin;this.xMaxOriginal=this.xMax;this.yMaxOriginal=this.yMax;this.podeSomAbriu=true;this.podeSomFechou=false}desenha(){if(this.tipo!="pusher"){this.xMin=this.x;this.yMin=this.y;this.xMax=this.x+this.largura;this.yMax=this.y+this.altura;ctx.beginPath();ctx.fillStyle=this.cor;if(this.quantasMoedas-1<ui.contaMoedas){ctx.lineWidth=0.5;ctx.strokeRect(this.x,this.y,this.largura,this.altura);ctx.beginPath();ctx.fillStyle=this.quadCor;if(this.largura<this.altura){ctx.rect(this.x,this.y,16,7)}else{ctx.rect(this.x,this.y,7,16)}ctx.fill();ctx.closePath()}else{ctx.rect(this.x,this.y,this.largura,this.altura)}ctx.strokeStyle=this.cor;ctx.fill();ctx.closePath()}if(this.tipo=="portao"){ctx.beginPath();ctx.font="10px Arial";ctx.fillStyle=this.corTexto;if(this.largura<this.altura){ctx.fillText("["+(this.quantasMoedas)+"]",this.x+2.5,this.y+this.altura/2)}else{ctx.fillText("["+(this.quantasMoedas)+"]",this.x+this.largura/2-5,this.y+10)}if(this.quantasMoedas-1<ui.contaMoedas){this.quadCor="lime";this.corTexto="#666666";this.xMin=1000;this.yMin=1000;this.xMax=1000;this.yMax=1000;if(this.podeSomAbriu==true){somPortaAbriu();this.podeSomAbriu=false;this.podeSomFechou=true}}else{this.quadCor=this.cor;this.corTexto=this.corTextoOriginal;this.xMin=this.xMinOriginal;this.yMin=this.yMinOriginal;this.xMax=this.xMaxOriginal;this.yMax=this.yMaxOriginal;if(this.podeSomFechou==true){somPortaFechou();this.podeSomFechou=false;this.podeSomAbriu=true}}}if(this.tipo=="pusher"){ctx.beginPath();ctx.strokeStyle=this.cor;ctx.lineWidth=2;ctx.strokeRect(this.x,this.y,this.largura,this.altura);ctx.strokeRect(this.x,this.y,this.largura*2/3,this.altura*2/3);ctx.strokeRect(this.x,this.y,this.largura*1/3,this.altura*1/3);ctx.strokeRect(this.x,this.y,this.largura*1/9,this.altura*1/9);ctx.closePath()}}}class Portal{constructor(x,y,raio,cor,destino){this.x=x;this.y=y;this.raio=raio;this.cor=cor;this.destino=destino;this.frame=0}desenha(){if(this.frame<25){ctx.beginPath();ctx.arc(this.x,this.y,this.raio,0,360/180*Math.PI);ctx.fillStyle="purple";ctx.fill();ctx.closePath();ctx.beginPath();ctx.arc(this.x,this.y,this.raio*(8/10),0,360/180*Math.PI);ctx.fillStyle="magenta";ctx.fill();ctx.closePath();ctx.beginPath();ctx.arc(this.x,this.y,this.raio*(6/10),0,360/180*Math.PI);ctx.fillStyle=this.cor;ctx.fill();ctx.closePath();this.frame=this.frame+1}else{ctx.beginPath();ctx.arc(this.x,this.y,this.raio+(Math.floor(Math.random()*10)+1)/2,0,360/180*Math.PI);ctx.fillStyle="purple";ctx.fill();ctx.closePath();ctx.beginPath();ctx.arc(this.x,this.y,(this.raio*(8/10))+(Math.floor(Math.random()*10)+1)/2,0,360/180*Math.PI);ctx.fillStyle="magenta";ctx.fill();ctx.closePath();ctx.beginPath();ctx.arc(this.x,this.y,(this.raio*(7/10))+(Math.floor(Math.random()*10)+1)/2,0,360/180*Math.PI);ctx.fillStyle=this.cor;ctx.fill();ctx.closePath();if(this.frame<49){this.frame=this.frame+1}else{this.frame=0}}}}class Moeda{constructor(x,y,raio,cor,valor){this.x=x;this.y=y;this.raio=raio;this.cor=cor;this.valor=valor;this.frame=0;this.pega=false}desenha(){if(this.pega==false){if(this.frame<50){ctx.beginPath();ctx.arc(this.x,this.y,this.raio,0,360/180*Math.PI);ctx.fillStyle=this.cor;ctx.fill();ctx.closePath();this.frame=this.frame+1}else{ctx.beginPath();ctx.arc(this.x,this.y,this.raio*1.1,0,360/180*Math.PI);ctx.fillStyle=this.cor;ctx.fill();ctx.closePath();if(this.frame<75){this.frame=this.frame+1}else{this.frame=0}}}}}class Batida{constructor(qualNota,duracao,tipo,volume,inicio,intervalo){this.qualNota=qualNota;this.duracao=duracao;this.tipo=tipo;this.volume=volume;this.inicio=inicio;this.intervalo=parseInt((intervalo*200)/3);this.contador=this.intervalo;this.audioCtx=new AudioContext();this.ganho=this.audioCtx.createGain();this.nota=this.audioCtx.createOscillator();this.primeiraVez=true}toca(){if(this.primeiraVez==false){this.inicio=0}if(this.contador==this.intervalo){this.audioCtx.close();this.audioCtx=new AudioContext();this.ganho=this.audioCtx.createGain();this.nota=this.audioCtx.createOscillator();this.ganho.connect(this.audioCtx.destination);this.nota.type=this.tipo;this.nota.frequency.value=notas[this.qualNota];this.nota.connect(this.ganho);this.ganho.gain.setValueAtTime(this.volume,this.audioCtx.currentTime);this.ganho.gain.exponentialRampToValueAtTime(0.00001,this.audioCtx.currentTime+this.duracao);this.nota.start(this.inicio);this.nota.stop(this.audioCtx.currentTime+this.duracao+1);this.contador=0;this.primeiraVez=false}this.contador+=1}}class Notas{constructor(qualNota,duracao,tipo,volume){this.qualNota=qualNota;this.duracao=duracao;this.tipo=tipo;this.volume=volume;this.contador=0;this.audioCtx=new AudioContext();this.ganho=this.audioCtx.createGain();this.nota=this.audioCtx.createOscillator()}toca(){this.audioCtx.close();this.audioCtx=new AudioContext();this.ganho=this.audioCtx.createGain();this.nota=this.audioCtx.createOscillator();this.ganho.connect(this.audioCtx.destination);this.nota.type=this.tipo;this.nota.frequency.value=notas[this.qualNota];this.ganho.gain.setValueAtTime(this.volume,this.audioCtx.currentTime);this.nota.connect(this.ganho);this.nota.start();this.ganho.gain.exponentialRampToValueAtTime(0.00001,this.audioCtx.currentTime+this.duracao);this.nota.stop(this.audioCtx.currentTime+this.duracao+1);}}class Palco{constructor(cena){this.cena=cena}chamaCena(){if(this.cena=="telaInicial"){telaInicial()}if(this.cena=="dialogo1"){dialogo1()}if(this.cena=="fase1"){fase1()}if(this.cena=="fase2"){fase2()}if(this.cena=="fase3"){fase3()}if(this.cena=="dialogo2"){dialogo2()}if(this.cena=="fase4"){fase4()}if(this.cena=="fase5"){fase5()}if(this.cena=="fase6"){fase6()}if(this.cena=="dialogo3"){dialogo3()}if(this.cena=="fase7"){fase7()}if(this.cena=="fase7b"){fase7b()}if(this.cena=="fase8"){fase8()}if(this.cena=="fase9"){fase9()}if(this.cena=="dialogo4"){dialogo4()}if(this.cena=="fase10"){fase10()}if(this.cena=="fase11"){fase11()}if(this.cena=="fase12"){fase12()}if(this.cena=="dialogo5"){dialogo5()}}}function telaInicial(){ctx.beginPath();ctx.rect(0,0,canvas.width,canvas.height);ctx.fillStyle="white";ctx.fill();ctx.closePath();ctx.beginPath();ctx.strokeStyle="black";ctx.lineWidth=1;ctx.strokeRect(0,0,canvas.width,canvas.height);ctx.closePath();ctx.beginPath();ctx.rect(120,110,600,130);ctx.fillStyle="purple";ctx.fill();ctx.closePath();ctx.beginPath();ctx.font="100px Arial";ctx.fillStyle="#FFFFFF";ctx.fillText("TRY TO BE",150,210);ctx.fillStyle="black";ctx.fillText("not",150,330);ctx.closePath();ctx.fillStyle="purple";ctx.fillText("FOUND",335,330);ctx.closePath();ctx.beginPath();ctx.font="18px Arial";piscaTexto("press ENTER to begin","press ENTER to begin","#AAAAAA","purple",335,430,335,430,60,60);ctx.closePath();ctx.fillStyle="#CCCCCC";ctx.font="12px Arial";ctx.fillText("----------------- js13k 2020 ----------------",330,490);ctx.closePath();cena1Carregado=false;fase1Carregado=false;fase2Carregado=false;if(enterPressed){somConfirma();palco.cena="dialogo1"}if(loadingInicial<300){ctx.beginPath();ctx.rect(0,0,canvas.width,canvas.height);ctx.fillStyle="black";ctx.fill();ctx.closePath();ctx.beginPath();ctx.font="20px Arial";ctx.fillStyle="#FFFFFF";ctx.fillText("loading... "+parseInt((loadingInicial/300)*100)+"%",370,canvas.height/2);ctx.closePath();loadingInicial+=1}}function dialogo1(){if(cenaCarregada==false){bonus=185;dialogoPagina=0;textosFrame=0;qdsQuePassam();dialogoLinha1="In a strange night, in the distant";dialogoLinha2="future of 1989, at CERN... ";dialogoLinha3="My child, you must go.";dialogoLinha4="Don't let They find you.";dialogoLinha5="They will remove any aditional bits you may have.";dialogoLinha6="Get the bits to open the gates, don't let they see you";dialogoLinha7="and use the portals to escape.";dialogoLinha8="Your cell is now open. Go and...";dialogoLinha9="Try to be NOT FOUND!";cenaCarregada=true}document.onkeyup=function(e){if(e.keyCode==13){dialogoPagina+=1;if(dialogoPagina>1){somConfirma()}}};if(dialogoPagina==1){ctx.beginPath();ctx.rect(0,0,canvas.width,canvas.height);ctx.fillStyle="black";ctx.fill();ctx.closePath();ctx.beginPath();ctx.font="20px Verdana";ctx.fillStyle="#CCCCCC";ctx.fillText(dialogoLinha1,150,210);ctx.fillText(dialogoLinha2,150,240);ctx.font="14px Verdana";ctx.fillStyle="white";ctx.fillText("press ENTER",600,340)}if(dialogoPagina==2){criaPagina(dialogoLinha3,"","","");ctx.font="14px Verdana";ctx.fillStyle="#888888";ctx.fillText("press ENTER",600,340)}if(dialogoPagina==3){criaPagina(dialogoLinha4,"","","");ctx.font="14px Verdana";ctx.fillStyle="#AAAAAA";ctx.fillText("press ENTER",600,340)}if(dialogoPagina==4){criaPagina(dialogoLinha5,dialogoLinha6,dialogoLinha7,"");ctx.font="14px Verdana";ctx.fillStyle="#DDDDDD";ctx.fillText("press ENTER",600,340)}if(dialogoPagina==5){criaPagina(dialogoLinha8,"","","")}if(dialogoPagina==6){criaPagina(dialogoLinha9,"","","");ctx.font="bold 14px Verdana";ctx.fillStyle="red";ctx.fillText("+10 bonus points for saying the name of the game!",250,bonus);bonus-=0.4}if(dialogoPagina==7){palco.cena="fase1";cenaCarregada=false}ctx.font="bold 14px Verdana";piscaTexto("","                    |]","purple","purple",600,340,600,340,60,60);if(dialogoPagina>1){for(var qdpassante=0;qdpassante<qdpassantes.length;qdpassante+=1){qdpassantes[qdpassante].passa()}}ctx.beginPath();ctx.rect(0,0,canvas.width,dialogoMargem);ctx.fillStyle="black";ctx.fill();ctx.closePath();ctx.beginPath();ctx.rect(0,canvas.height-dialogoMargem,canvas.width,dialogoMargem);ctx.fillStyle="black";ctx.fill();ctx.closePath()}function fase1(){document.onkeyup=null;var corFase="purple";var corFundo="black";if(cenaCarregada==false){criaMusicaFase1a3();ui=new UI("orange","white","black","black");jogador=new Jogador(64,440,jogadorLado,"blue");parede1=new Parede(260,0,115,202,corFase);parede2=new Parede(500,0,31,202,corFase);parede3=new Parede(692,75,31,200,corFase);parede4=new Parede(0,140,150,23,corFase);parede5=new Parede(0,275,375,32,corFase);parede6=new Parede(500,275,430,32,corFase);parede7=new Parede(0,380,702,32,corFase);parede8=new Parede(100,412,9,18,"gray");parede9=new Parede(100,464,9,9,"gray");parede10=new Parede(100,480,9,9,"gray");parede11=new Parede(110,421,40,9,"gray");parede12=new Parede(590,411,16,84,"orange","portao",1);parede13=new Parede(724,161,120,16,"orange","portao",2);parede14=new Parede(375,123,124,16,"orange","portao",3);paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13,parede14];inimigo1=new Inimigo(380,332,20,"purple","horizontal",100,700,75,1.75);inimigo2=new Inimigo(212,60,20,"magenta","vertical",50,180,75,1.75);inimigo3=new Inimigo(620,150,20,"magenta","vertical",50,180,75,1.75);inimigos=[inimigo1,inimigo2,inimigo3];portal1=new Portal(438,50,16,"cyan","fase2");moeda1=new Moeda(436,450,7,"orange","fim");moeda2=new Moeda(60,342,7,"orange","fim");moeda3=new Moeda(60,75,7,"orange","fim");moeda4=new Moeda(60,225,7,"orange","fim");moeda5=new Moeda(785,225,7,"orange","fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5];cenaCarregada=true}loopFase(corFundo,corFase)}function fase2(){var corFase="cyan";var corFundo="black";if(cenaCarregada==false){criaMusicaFase1a3();ui=new UI("orange","white","black","black");jogador=new Jogador(438+jogadorLado/2,50+jogadorLado/2,jogadorLado,"blue");parede1=new Parede(149,201,126,104,corFase);parede10=new Parede(638,201,64,104,corFase);parede11=new Parede(360,201,60,30,corFase);parede12=new Parede(500,201,60,30,corFase);parede3=new Parede(380,269,157,36,corFase);parede2=new Parede(100,100,650,31,corFase);parede4=new Parede(100,229,750,40,corFase);parede5=new Parede(0,370,722,32,corFase);parede13=new Parede(150,440,20,60,corFase);parede6=new Parede(6,253,94,16,"orange","portao",5);parede7=new Parede(653,402,16,92,"orange","portao",1);parede9=new Parede(548,402,16,92,"orange","portao",3);parede8=new Parede(250,402,16,92,"orange","portao",6);paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13];inimigo2=new Inimigo(310,155,20,"purple","horizontal",270,700,75,1.75);inimigo1=new Inimigo(90,328,20,"purple","horizontal",70,400,75,1.75);inimigo3=new Inimigo(470,328,20,"purple","horizontal",450,700,75,1.75);inimigos=[inimigo1,inimigo2,inimigo3];portal1=new Portal(75,450,16,"red","fase3");moeda1=new Moeda(125,216,7,"orange","fim");moeda3=new Moeda(320,216,7,"orange","fim");moeda4=new Moeda(460,216,7,"orange","fim");moeda6=new Moeda(600,216,7,"orange","fim");moeda8=new Moeda(725,216,7,"orange","fim");moeda9=new Moeda(330,285,7,"orange","fim");moeda10=new Moeda(585,285,7,"orange","fim");moeda2=new Moeda(325,450,7,"orange","fim");moeda11=new Moeda(405,450,7,"orange","fim");moeda5=new Moeda(485,450,7,"orange","fim");moeda7=new Moeda(610,450,7,"orange","fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5,moeda6,moeda7,moeda8,moeda9,moeda10,moeda11];cenaCarregada=true}loopFase(corFundo,corFase)}function fase3(){var corFase="red";var corFundo="black";if(cenaCarregada==false){criaMusicaFase1a3();ui=new UI("orange","white","black","black");jogador=new Jogador(64,440,jogadorLado,"white");parede1=new Parede(628,2,38,210,corFase);parede2=new Parede(148,80,122,222,corFase);parede3=new Parede(400,80,116,131,corFase);parede4=new Parede(400,278,445,23,corFase);parede5=new Parede(0,380,702,32,corFase);parede10=new Parede(0,160,150,32,corFase);parede11=new Parede(590,50,40,54,corFase);parede12=new Parede(6,320,60,60,corFase);parede13=new Parede(6,0,60,40,corFase);parede6=new Parede(640,411,16,84,"orange","portao",1);parede7=new Parede(665,411,16,84,"orange","portao",2);parede9=new Parede(254,6,16,74,"orange","portao",1);parede8=new Parede(665,101,179,16,"orange","portao",3);paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13];inimigo1=new Inimigo(380,330,20,"purple","horizontal",270,700,75,1.75);inimigo2=new Inimigo(310,100,20,"magenta","vertical",50,200,75,1.75);inimigo4=new Inimigo(545,180,20,"magenta","vertical",50,200,75,1.75);inimigos=[inimigo1,inimigo2,inimigo4];portal1=new Portal(755,50,16,"white","dialogo2");moeda1=new Moeda(300,450,7,"orange","fim");moeda2=new Moeda(500,450,7,"orange","fim");moeda3=new Moeda(80,100,7,"orange","fim");moeda4=new Moeda(80,250,7,"orange","fim");moeda5=new Moeda(610,30,7,"orange","fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5];cenaCarregada=true}loopFase(corFundo,corFase)}function dialogo2(){if(cenaCarregada==false){bonus=185;dialogoPagina=0;textosFrame=0;qdsQuePassam();dialogoLinha1="Well done, my child.";dialogoLinha2="However, there is still more on your journey.";dialogoLinha3="They will change.";dialogoLinha4="They will move faster, look farther,";dialogoLinha5="try to push you back and change sizes.";dialogoLinha6="Get the bits, try not to be found and...";dialogoLinha7="Don't give up!";cenaCarregada=true}document.onkeyup=function(e){if(e.keyCode==13){dialogoPagina+=1;somConfirma()}};if(dialogoPagina==0){criaPagina(dialogoLinha1,"","","")}if(dialogoPagina==1){criaPagina(dialogoLinha2,"","","")}if(dialogoPagina==2){criaPagina(dialogoLinha3,"","","")}if(dialogoPagina==3){criaPagina(dialogoLinha3,dialogoLinha4,dialogoLinha5,"")}if(dialogoPagina==4){criaPagina(dialogoLinha6,"","","")}if(dialogoPagina==5){criaPagina(dialogoLinha7,"","","");ctx.font="bold 14px Verdana";ctx.fillStyle="red";ctx.fillText("+50 bonus points for don't give up!",250,bonus);bonus-=0.4}if(dialogoPagina==6){palco.cena="fase4";cenaCarregada=false}ctx.font="bold 14px Verdana";piscaTexto("","                    |]","purple","purple",600,340,600,340,60,60);for(var qdpassante=0;qdpassante<qdpassantes.length;qdpassante+=1){qdpassantes[qdpassante].passa()}ctx.beginPath();ctx.rect(0,0,canvas.width,dialogoMargem);ctx.fillStyle="black";ctx.fill();ctx.closePath();ctx.beginPath();ctx.rect(0,canvas.height-dialogoMargem,canvas.width,dialogoMargem);ctx.fillStyle="black";ctx.fill();ctx.closePath()}function fase4(){document.onkeyup=null;var corFase="#ababef";var corFundo="#445f5f";if(cenaCarregada==false){criaMusicaFase4a6();ui=new UI("orange","white","black","black");jogador=new Jogador(770,49,jogadorLado,"blue");parede1=new Parede(660,0,61,300,corFase);parede2=new Parede(360,100,31,180,corFase);parede3=new Parede(80,43,65,65,corFase);parede4=new Parede(80,145,140,101,corFase);parede5=new Parede(216,32,81,214,corFase);parede6=new Parede(120,280,271,60,corFase);parede7=new Parede(120,340,307,50,corFase);parede8=new Parede(425,340,175,26,corFase);parede9=new Parede(600,340,120,50,corFase);parede10=new Parede(600,475,250,30,corFase);parede11=new Parede(720,340,125,50,corFase);parede12=new Parede(360,6,16,94,"orange","portao",2);parede13=new Parede(7,340,113,16,"orange","portao",3);parede14=new Parede(720,390,16,85,"orange","portao",2);paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13,parede14];inimigo1=new Inimigo(380,425,32,"brown","horizontal",100,570,150,1.3);inimigo2=new Inimigo(450,90,14,"lime","horizontal",440,600,50,2.7);inimigo3=new Inimigo(500,170,14,"lime","horizontal",440,600,50,2.7);inimigo4=new Inimigo(590,250,14,"lime","horizontal",440,600,50,2.7);inimigo5=new Inimigo(320,200,18,"green","vertical",52,210,60,2.7);inimigo6=new Inimigo(33,150,20,"magenta","vertical",50,180,75,1.75);inimigos=[inimigo1,inimigo2,inimigo3,inimigo4,inimigo5,inimigo6];portal1=new Portal(790,436,16,"white","fase5");moeda1=new Moeda(450,220,7,"orange","fim");moeda2=new Moeda(600,135,7,"orange","fim");moeda3=new Moeda(45,27,7,"orange","fim");moeda4=new Moeda(180,124,7,"orange","fim");moeda5=new Moeda(62,295,7,"orange","fim");moeda6=new Moeda(62,400,7,"orange","fim");moeda7=new Moeda(572,382,7,"orange","fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5,moeda6,moeda7];cenaCarregada=true}loopFase(corFundo,corFase)}function fase5(){var corFase="#590059";var corFundo="#445f5f";if(cenaCarregada==false){criaMusicaFase4a6();ui=new UI("orange","white","black","black");jogador=new Jogador(790,439,jogadorLado/2,"blue");parede1=new Parede(600,348,150,150,corFase);parede2=new Parede(720,150,150,150,corFase);parede3=new Parede(552,0,150,150,corFase);parede4=new Parede(492,201,150,150,corFase);parede5=new Parede(200,81,320,130,corFase);parede6=new Parede(0,0,150,150,corFase);parede7=new Parede(150,180,75,300,corFase);parede8=new Parede(0,354,75,150,corFase);parede9=new Parede(360,270,150,170,corFase);parede10=new Parede(671,150,16,198,"orange","portao",1);parede11=new Parede(592,150,16,51,"orange","portao",4);parede12=new Parede(6,245,144,16,"orange","portao",6);parede13=new Parede(396,211,16,59,"orange","portao",3);parede14=new Parede(482,11,64,64,"orange","pusher");parede15=new Parede(12,270,130,80,"orange","pusher");paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13,parede14,parede15];inimigo1=new Inimigo(800,320,9,"green","horizontal",710,830,30,1.2);inimigo2=new Inimigo(750,50,10,"brown","horizontal",730,830,30,1.9);inimigo3=new Inimigo(825,100,10,"brown","horizontal",730,830,30,1.8);inimigo4=new Inimigo(770,20,12,"magenta","vertical",10,120,40,1.7);inimigo5=new Inimigo(266,20,12,"lime","horizontal",265,450,34,1.7,"pusher");inimigo6=new Inimigo(360,52,12,"lime","horizontal",265,450,38,1.7,"pusher");inimigo8=new Inimigo(170,15,14,"lime","vertical",5,150,38,2,"pusher");inimigo9=new Inimigo(400,460,16,"magenta","horizontal",399,580,75,1.75);inimigo10=new Inimigo(250,240,13,"lime","horizontal",249,349,32,2.2,"pusher");inimigo11=new Inimigo(300,420,13,"lime","horizontal",249,320,32,2.2,"pusher");inimigo12=new Inimigo(240,350,13,"lime","vertical",249,390,32,2.2,"pusher");inimigo13=new Inimigo(335,300,13,"lime","vertical",249,390,32,2.2,"pusher");inimigos=[inimigo1,inimigo2,inimigo3,inimigo4,inimigo5,inimigo6,inimigo8,inimigo9,inimigo10,inimigo11,inimigo12,inimigo13];portal1=new Portal(452,240,16/2,"white","fase6");moeda1=new Moeda(830,320,7/2,"orange","fim");moeda2=new Moeda(830,20,7/2,"orange","fim");moeda3=new Moeda(830,136,7/2,"orange","fim");moeda4=new Moeda(718,20,7/2,"orange","fim");moeda5=new Moeda(450,20,7/2,"orange","fim");moeda6=new Moeda(345,42,7/2,"orange","fim");moeda7=new Moeda(240,65,7/2,"orange","fim");moeda8=new Moeda(555,380,7/2,"orange","fim");moeda9=new Moeda(555,420,7/2,"orange","fim");moeda10=new Moeda(555,460,7/2,"orange","fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5,moeda6,moeda7,moeda8,moeda9,moeda10];cenaCarregada=true}loopFase(corFundo,corFase)}function fase6(){var corFase="#800040";var corFundo="#445f5f";if(cenaCarregada==false){criaMusicaFase4a6();ui=new UI("orange","white","black","black");jogador=new Jogador(452,237,jogadorLado*2,"blue");parede1=new Parede(100,80,50,50,corFase);parede2=new Parede(100,230,50,50,corFase);parede3=new Parede(100,380,50,50,corFase);parede4=new Parede(301,80,50,50,corFase);parede5=new Parede(301,230,50,50,corFase);parede6=new Parede(301,380,50,50,corFase);parede7=new Parede(499,80,50,50,corFase);parede8=new Parede(499,230,50,50,corFase);parede9=new Parede(499,380,50,50,corFase);parede10=new Parede(700,80,50,50,corFase);parede11=new Parede(700,230,50,50,corFase);parede12=new Parede(700,380,50,50,corFase);parede13=new Parede(8,82,90,16,"orange","portao",5);parede14=new Parede(100,8,16,70,"orange","portao",5);parede15=new Parede(752,414,90,16,"orange","portao",4);parede16=new Parede(734,432,16,60,"orange","portao",4);parede17=new Parede(16,410,74,74,"orange","pusher");parede18=new Parede(416,216,74,74,"orange","pusher");parede19=new Parede(760,16,74,74,"orange","pusher");paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13,parede14,parede15,parede16,parede17,parede18,parede19];inimigo1=new Inimigo(250,168,25,"lime","horizontal",50,750,60,3,"pusher");inimigo2=new Inimigo(250,315,30,"green","horizontal",50,750,60,4);inimigo3=new Inimigo(40,200,25,"lime","vertical",140,330,60,2,"pusher");inimigo4=new Inimigo(205,100,45,"lime","vertical",50,450,80,3,"pusher");inimigo5=new Inimigo(602,100,45,"green","vertical",50,450,80,4);inimigo6=new Inimigo(785,200,25,"lime","vertical",150,350,60,2,"pusher");inimigos=[inimigo1,inimigo2,inimigo3,inimigo4,inimigo5,inimigo6];portal1=new Portal(54,40,16*1.5,"white","dialogo3");moeda1=new Moeda(54,450,7*1.5,"orange","fim");moeda2=new Moeda(325,330,7*1.5,"orange","fim");moeda3=new Moeda(524,180,7*1.5,"orange","fim");moeda4=new Moeda(800,50,7*1.5,"orange","fim");moeda5=new Moeda(795,465,7*1.5,"orange","fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5];cenaCarregada=true}loopFase(corFundo,corFase)}function dialogo3(){if(cenaCarregada==false){bonus=185;dialogoPagina=0;textosFrame=0;qdsQuePassam();dialogoLinha1="Very impressive, my child.";dialogoLinha2="None of my previous 403 experiments came this far";dialogoLinha3="But the path is not yet over.";dialogoLinha4="Now They will will try to confuse your perception";dialogoLinha5="and test everything you learned so far.";dialogoLinha6="Get the bits, try not to be found and...";dialogoLinha7="Keep going, even when things get weird!";cenaCarregada=true}document.onkeyup=function(e){if(e.keyCode==13){dialogoPagina+=1;somConfirma()}};if(dialogoPagina==0){criaPagina(dialogoLinha1,"","","")}if(dialogoPagina==1){criaPagina(dialogoLinha2,"","","")}if(dialogoPagina==2){criaPagina(dialogoLinha3,"","","")}if(dialogoPagina==3){criaPagina(dialogoLinha3,dialogoLinha4,dialogoLinha5,"")}if(dialogoPagina==4){criaPagina(dialogoLinha6,"","","")}if(dialogoPagina==5){criaPagina(dialogoLinha7,"","","");ctx.font="bold 14px Verdana";ctx.fillStyle="red";ctx.fillText("+500 bonus points for keep going when things get weird!",250,bonus);bonus-=0.4}if(dialogoPagina==6){palco.cena="fase7";cenaCarregada=false}ctx.font="bold 14px Verdana";piscaTexto("","                    |]","purple","purple",600,340,600,340,60,60);for(var qdpassante=0;qdpassante<qdpassantes.length;qdpassante+=1){qdpassantes[qdpassante].passa()}ctx.beginPath();ctx.rect(0,0,canvas.width,dialogoMargem);ctx.fillStyle="black";ctx.fill();ctx.closePath();ctx.beginPath();ctx.rect(0,canvas.height-dialogoMargem,canvas.width,dialogoMargem);ctx.fillStyle="black";ctx.fill();ctx.closePath()}function fase7(){document.onkeyup=null;var corFase="black";var corFundo="white";if(cenaCarregada==false){criaMusicaFase7a9();ui=new UI("orange","white","black","black");jogador=new Jogador(54,40,jogadorLado*0.8,"darkblue");parede1=new Parede(120,0,28,402,corFase);parede2=new Parede(93,100,79,50,corFase);parede4=new Parede(0,301,59,200,corFase);parede3=new Parede(120,70,80,197,corFase);parede22=new Parede(203,70,96,16,corFase,"portao",1);parede5=new Parede(301,70,220,26,corFase);parede6=new Parede(399,105,24,12,corFase);parede7=new Parede(399,130,24,12,corFase);parede8=new Parede(399,155,24,12,corFase);parede9=new Parede(399,180,24,12,corFase);parede10=new Parede(399,205,24,12,corFase);parede11=new Parede(301,229,120,221,corFase);parede12=new Parede(498,88,125,26,corFase);parede13=new Parede(621,70,123,68,corFase);parede14=new Parede(498,229,350,73,corFase);parede15=new Parede(399,382,120,202,corFase);parede16=new Parede(621,290,52,130,corFase);parede17=new Parede(654,379,150,79,corFase);parede18=new Parede(523,70,96,16,corFase,"portao",2);parede19=new Parede(746,70,96,16,corFase,"portao",3);parede20=new Parede(16,16,95,74,corFase,"pusher");parede21=new Parede(749,92,91,42,corFase,"pusher");paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13,parede14,parede15,parede16,parede17,parede18,parede19,parede20,parede21,parede22];inimigo1=new Inimigo(77,170,26,corFase,"vertical",160,400,60,2,"pusher");inimigo2=new Inimigo(234,200,30,corFase,"vertical",190,450,90,1.2);inimigo3=new Inimigo(200,160,20,corFase,"horizontal",200,380,80,2.2);inimigo4=new Inimigo(460,160,20,corFase,"horizontal",430,750,80,2.2);inimigo5=new Inimigo(460,26,20,corFase,"horizontal",430,750,80,2.2);inimigo6=new Inimigo(460,26,20,corFase,"horizontal",280,750,80,2.2);inimigo7=new Inimigo(650,470,12,corFase,"horizontal",540,820,60,2,"pusher");inimigo8=new Inimigo(500,330,24,corFase,"horizontal",440,560,60,1.2,"pusher");inimigos=[inimigo1,inimigo2,inimigo3,inimigo4,inimigo5,inimigo6,inimigo7,inimigo8];portal1=new Portal(710,340,16,corFase,"fase7b");moeda1=new Moeda(350,472,7,corFase,"fim");moeda2=new Moeda(160,50,7,corFase,"fim");moeda3=new Moeda(570,35,7,corFase,"fim");moeda4=new Moeda(795,35,7,corFase,"fim");moedas=[moeda1,moeda2,moeda3,moeda4];cenaCarregada=true}loopFase(corFundo,corFase)}function fase7b(){var corFase="white";var corFundo="black";if(cenaCarregada==false){criaMusicaFase7a9();ui=new UI("orange","white","black","black");jogador=new Jogador(700,330,jogadorLado,"lightblue");parede1=new Parede(120,0,28,402,corFase);parede2=new Parede(93,100,79,50,corFase);parede3=new Parede(120,100,80,196,corFase);parede4=new Parede(0,301,59,158,corFase);parede5=new Parede(301,70,220,26,corFase);parede6=new Parede(399,105,24,12,corFase);parede7=new Parede(399,130,24,12,corFase);parede8=new Parede(399,155,24,12,corFase);parede9=new Parede(399,180,24,12,corFase);parede10=new Parede(399,205,24,12,corFase);parede11=new Parede(301,229,120,221,corFase);parede12=new Parede(498,88,125,26,corFase);parede13=new Parede(621,70,123,68,corFase);parede14=new Parede(498,229,350,73,corFase);parede15=new Parede(399,382,120,202,corFase);parede16=new Parede(621,290,52,130,corFase);parede17=new Parede(654,379,150,79,corFase);parede18=new Parede(523,70,96,16,"#CCCCCC","portao",4);parede19=new Parede(746,70,96,16,"#CCCCCC","portao",3);parede20=new Parede(680,310,72,61,corFase,"pusher");parede21=new Parede(120,410,72,76,corFase,"pusher");paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13,parede14,parede15,parede16,parede17,parede18,parede19,parede20,parede21];inimigo1=new Inimigo(80,170,16,"black","vertical",160,480,60,3,"pusher");inimigo2=new Inimigo(200,160,20,corFase,"horizontal",200,380,80,2.2);inimigo3=new Inimigo(460,160,20,"black","horizontal",430,750,80,2.2);inimigo4=new Inimigo(460,26,20,corFase,"horizontal",430,750,80,2.2);inimigo5=new Inimigo(460,26,20,"black","horizontal",230,750,80,2.2);inimigo6=new Inimigo(448,330,24,"black","vertical",148,335,60,1.2,"pusher");inimigo7=new Inimigo(650,470,12,corFase,"horizontal",540,820,60,2,"pusher");inimigos=[inimigo1,inimigo2,inimigo3,inimigo4,inimigo5,inimigo6,inimigo7];portal1=new Portal(54,40,16,corFase,"fase8");moeda1=new Moeda(569,47,7,corFase,"fim");moeda2=new Moeda(460,107,7,corFase,"fim");moeda3=new Moeda(791,112,7,corFase,"fim");moeda4=new Moeda(560,343,7,corFase,"fim");moeda5=new Moeda(350,109,7,corFase,"fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5];cenaCarregada=true}loopFase(corFundo,corFase)}function fase8(){var corFase="white";var corFundo="black";if(cenaCarregada==false){criaMusicaFase7a9();ui=new UI("black","gray","white","black");portal1=new Portal(1000,40,16,corFase,"fase9");jogador=new Jogador(54,40,jogadorLado,"cyan");qdsQuePassam();paredes=[];inimigos=[];moeda1=new Moeda(600,350,7,corFase,"fim");moeda2=new Moeda(0,0,7,corFase,"fim");moeda3=new Moeda(0,0,7,corFase,"fim");moeda4=new Moeda(0,0,7,corFase,"fim");moeda5=new Moeda(0,0,7,corFase,"fim");moeda6=new Moeda(0,0,7,corFase,"fim");moeda7=new Moeda(0,0,7,corFase,"fim");moeda8=new Moeda(0,0,7,corFase,"fim");moeda9=new Moeda(0,0,7,corFase,"fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5,moeda6,moeda7,moeda8,moeda9];cenaCarregada=true}loopFase(corFundo,corFase);for(var qdpassante=0;qdpassante<qdpassantes.length;qdpassante+=1){qdpassantes[qdpassante].passa()}if(ui.contaMoedas==1){moeda2.x=100;moeda2.y=100;moeda2.raio=20;jogador.cor="lightblue";jogador.lado=25}if(ui.contaMoedas==2){moeda3.x=700;moeda3.y=200;moeda3.raio=30;jogador.cor="red";jogador.lado=30}if(ui.contaMoedas==3){moeda4.x=380;moeda4.y=450;moeda4.raio=16;jogador.cor="purple";jogador.lado=50}if(ui.contaMoedas==4){moeda5.x=680;moeda5.y=50;moeda5.raio=30;jogador.cor="yellow";jogador.lado=100}if(ui.contaMoedas==5){moeda6.x=80;moeda6.y=320;moeda6.raio=30;jogador.cor="magenta";jogador.lado=12}if(ui.contaMoedas==6){moeda7.x=480;moeda7.y=480;moeda7.raio=20;jogador.cor="brown";jogador.lado=64}if(ui.contaMoedas==7){moeda8.x=530;moeda8.y=260;moeda8.raio=14;jogador.cor="lime";jogador.lado=25}if(ui.contaMoedas==8){moeda9.x=180;moeda9.y=120;moeda9.raio=9;jogador.cor="green";jogador.lado=16}if(ui.contaMoedas==9){portal1.x=790;portal1.y=238;portal1.raio=86;jogador.cor="#0f380f";jogador.lado=20}}function fase9(){var corFase="#8BAC0F";var corFundo="#CADC9F";if(cenaCarregada==false){criaMusicaFase7a9();ui=new UI("#306230","#9bbc0f","#9bbc0f","#0f380f");jogador=new Jogador(790,138,jogadorLado*0.8,"#0f380f");jogador2=new Jogador(790,338,jogadorLado*0.8,"#0f380f");jogador3=new Jogador(790,238,jogadorLado,"#0f380f");parede1=new Parede(0,0,100,200,corFase);parede2=new Parede(0,300,100,300,corFase);parede3=new Parede(130,70,100,100,corFase);parede4=new Parede(130,330,100,100,corFase);parede6=new Parede(90,200,770,25,corFase);parede7=new Parede(90,275,770,25,corFase);parede9=new Parede(280,100,75,100,corFase);parede10=new Parede(280,300,75,100,corFase);parede8=new Parede(330,150,200,20,corFase);parede11=new Parede(330,330,200,20,corFase);parede12=new Parede(460,50,200,20,corFase);parede13=new Parede(460,100,200,20,corFase);parede14=new Parede(460,380,200,20,corFase);parede5=new Parede(460,430,200,20,corFase);parede16=new Parede(650,0,20,150,corFase);parede17=new Parede(650,346,20,150,corFase);parede18=new Parede(720,60,30,170,corFase);parede15=new Parede(720,270,30,200,corFase);parede19=new Parede(750,225,16,50,"#61780A","portao",8);parede24=new Parede(250,225,16,50,"#61780A","portao",9);parede20=new Parede(598,8,50,40,corFase,"pusher");parede23=new Parede(598,452,50,40,corFase,"pusher");parede21=new Parede(752,8,90,110,corFase,"pusher");parede22=new Parede(752,382,90,110,corFase,"pusher");paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13,parede14,parede15,parede16,parede17,parede18,parede19,parede20,parede21,parede22,parede23,parede24];inimigo1=new Inimigo(250,28,20,"#306230","horizontal",160,420,60,1.2,"pusher");inimigo2=new Inimigo(250,452,20,"#306230","horizontal",160,420,60,1.2,"pusher");inimigo3=new Inimigo(246,30,18,corFase,"vertical",13,160,45,1.2);inimigo4=new Inimigo(246,400,18,corFase,"vertical",317,465,45,1.2);inimigos=[inimigo1,inimigo2,inimigo3,inimigo4];portal1=new Portal(48,250,16,corFase,"dialogo4");moeda1=new Moeda(254,158,7,corFase,"fim");moeda2=new Moeda(254,350,7,corFase,"fim");moeda3=new Moeda(623,31,7,corFase,"fim");moeda4=new Moeda(623,473,7,corFase,"fim");moeda5=new Moeda(368,187,7,corFase,"fim");moeda6=new Moeda(368,316,7,corFase,"fim");moeda7=new Moeda(565,86,7,corFase,"fim");moeda8=new Moeda(565,415,7,corFase,"fim");moeda9=new Moeda(480,250,7,corFase,"fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5,moeda6,moeda7,moeda8,moeda9];cenaCarregada=true}loopFase(corFundo,corFase);jogador2.desenha();jogador2.move();jogador2.inimigoPegou();jogador2.moeda();jogador2.portal();jogador3.desenha();jogador3.move();jogador3.moeda();jogador3.portal()}function dialogo4(){if(cenaCarregada==false){bonus=185;dialogoPagina=0;textosFrame=0;qdsQuePassam();dialogoLinha1="Extremely impressive, my child.";dialogoLinha2="This is it.";dialogoLinha3="Now it's the time of the final chapter.";dialogoLinha4="They will try again, once more you must persist";dialogoLinha5="and finally escape.";dialogoLinha6="Get the bits, try not to be found and...";dialogoLinha7="Let's dance!";dialogoLinha8="";dialogoLinha9="";dialogoLinha10="";dialogoLinha11="";cenaCarregada=true}document.onkeyup=function(e){if(e.keyCode==13){dialogoPagina+=1;somConfirma()}};if(dialogoPagina==0){criaPagina(dialogoLinha1,"","","")}if(dialogoPagina==1){criaPagina(dialogoLinha2,"","","")}if(dialogoPagina==2){criaPagina(dialogoLinha3,"","","")}if(dialogoPagina==3){criaPagina(dialogoLinha3,dialogoLinha4,dialogoLinha5,"")}if(dialogoPagina==4){criaPagina(dialogoLinha6,"","","")}if(dialogoPagina==5){criaPagina(dialogoLinha7,"","","");ctx.font="bold 14px Verdana";ctx.fillStyle="red";ctx.fillText("+1000 bonus points for dancing!",250,bonus);bonus-=0.4}if(dialogoPagina==6){palco.cena="fase10";cenaCarregada=false}ctx.font="bold 14px Verdana";piscaTexto("","                    |]","purple","purple",600,340,600,340,60,60);for(var qdpassante=0;qdpassante<qdpassantes.length;qdpassante+=1){qdpassantes[qdpassante].passa()}ctx.beginPath();ctx.rect(0,0,canvas.width,dialogoMargem);ctx.fillStyle="black";ctx.fill();ctx.closePath();ctx.beginPath();ctx.rect(0,canvas.height-dialogoMargem,canvas.width,dialogoMargem);ctx.fillStyle="black";ctx.fill();ctx.closePath()}function fase10(){document.onkeyup=null;var corFase="#CADC9F";var corFundo="#8BAC0F";if(cenaCarregada==false){criaMusicaFase10a12();ui=new UI("#306230","#9bbc0f","#9bbc0f","#0f380f");jogador=new Jogador(64,250,jogadorLado*0.4,"#0f380f");jogador2=new Jogador(305,434,jogadorLado*0.6,"#0f380f");jogador3=new Jogador(400,435,jogadorLado*0.8,"#0f380f");jogador4=new Jogador(642,24,jogadorLado,"#0f380f");parede1=new Parede(140,30,20,446,corFase);parede2=new Parede(140,30,188,7,corFase);parede3=new Parede(820,20,7,457,corFase);parede4=new Parede(140,470,680,7,corFase);parede5=new Parede(0,470,120,7,corFase);parede7=new Parede(274,405,182,12,corFase);parede8=new Parede(224,420,48,48,corFase,"pusher");parede9=new Parede(274,420,16,50,"#306230","portao",1);parede10=new Parede(440,420,16,50,"#306230","portao",5);parede11=new Parede(420,477,50,16,"#306230","portao",3);parede12=new Parede(457,420,48,48,corFase,"pusher");parede13=new Parede(675,9,16,50,"#306230","portao",6);parede14=new Parede(695,12,120,100,corFase,"pusher");parede31=new Parede(517,83,30,30,corFase,"pusher");parede15=new Parede(829,9,16,50,"#306230","portao",7);parede18=new Parede(340,0,40,240,corFase);parede19=new Parede(340,253,40,222,corFase);parede20=new Parede(510,60,182,20,corFase);parede23=new Parede(570,0,60,455,corFase);parede6=new Parede(303,165,7,220,corFase);parede17=new Parede(255,217,7,200,corFase);parede16=new Parede(227,384,100,7,corFase);parede21=new Parede(303,200,200,16,corFase);parede22=new Parede(34,0,80,200,corFase);parede24=new Parede(0,218,220,20,corFase);parede25=new Parede(550,100,7,377,corFase);parede26=new Parede(797,130,7,105,corFase);parede27=new Parede(750,170,50,50,corFase);parede28=new Parede(700,210,70,70,corFase);parede29=new Parede(680,350,145,80,corFase);parede30=new Parede(8,240,129,40,corFase,"pusher");paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13,parede14,parede15,parede16,parede17,parede18,parede19,parede20,parede21,parede22,parede23,parede24,parede25,parede26,parede27,parede28,parede29,parede30,parede31];inimigo1=new Inimigo(9,450,8,corFase,"horizontal",7,107,30,2,"pusher");inimigo2=new Inimigo(120,341,8,corFase,"vertical",340,440,30,2,"pusher");inimigo3=new Inimigo(232,80,12,corFase,"vertical",70,340,30,2,"pusher");inimigo4=new Inimigo(276,280,12,corFase,"vertical",70,340,30,2,"pusher");inimigo5=new Inimigo(450,170,16,corFase,"horizontal",400,500,40,2,"pusher");inimigo6=new Inimigo(455,235,16,corFase,"horizontal",400,500,40,2,"pusher");inimigo7=new Inimigo(655,200,21,corFase,"vertical",120,310,45,2,"pusher");inimigo8=new Inimigo(700,310,21,corFase,"horizontal",650,760,45,2,"pusher");inimigos=[inimigo1,inimigo2,inimigo3,inimigo4,inimigo5,inimigo6,inimigo7,inimigo8];portal1=new Portal(20,18,16*0.5,corFase,"fase11");moeda1=new Moeda(185,60,7*0.6,"#0f380f","fim");moeda7=new Moeda(282,370,7*0.6,"#0f380f","fim");moeda2=new Moeda(312,485,7*0.4,"#0f380f","fim");moeda3=new Moeda(600,485,7*0.4,"#0f380f","fim");moeda4=new Moeda(835,240,7*0.4,"#0f380f","fim");moeda5=new Moeda(550,35,7*0.8,"#0f380f","fim");moeda6=new Moeda(800,450,7,"#0f380f","fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5,moeda6,moeda7];cenaCarregada=true}loopFase(corFundo,corFase);jogador2.desenha();jogador2.move();jogador2.inimigoPegou();jogador2.moeda();jogador3.desenha();jogador3.move();jogador3.inimigoPegou();jogador3.moeda();jogador4.desenha();jogador4.move();jogador4.inimigoPegou();jogador4.moeda();jogador4.portal()}function fase11(){var corFase="#111111";var corFundo="#EEEEEE";if(cenaCarregada==false){criaMusicaFase10a12();ui=new UI("#AAAAAA","#666666","#666666","#AAAAAA");portal1=new Portal(815,465,16*0.8,corFase,"fase12");jogador=new Jogador(20,20,jogadorLado*0.8,"lightblue");parede1=new Parede(0,250,800,16,"#d8e6ad","portao",1);parede2=new Parede(425,0,16,450,"#d8e6ad","portao",2);parede3=new Parede(408,450,50,50,corFase);parede4=new Parede(800,232,50,50,corFase);parede10=new Parede(770,420,80,16,"#d8e6ad","portao",9);parede11=new Parede(770,420,16,80,"#d8e6ad","portao",9);parede9=new Parede(404,360,20,20,corFase);parede8=new Parede(445,270,12,12,corFase);parede7=new Parede(404,230,20,20,corFase);parede6=new Parede(440,140,16,16,corFase);parede5=new Parede(404,50,20,20,corFase);parede12=new Parede(480,410,20,20,corFase);parede13=new Parede(530,330,20,20,corFase);parede14=new Parede(350,300,20,20,corFase);parede15=new Parede(280,380,25,25,corFase);parede16=new Parede(250,280,20,20,corFase);parede17=new Parede(550,200,20,20,corFase);parede18=new Parede(620,140,32,32,corFase);parede19=new Parede(220,160,20,20,corFase);parede20=new Parede(150,110,12,12,corFase);parede21=new Parede(230,50,20,20,corFase);parede22=new Parede(110,350,80,80,corFase);parede23=new Parede(650,300,70,70,corFase);parede24=new Parede(50,170,60,60,corFase);parede25=new Parede(310,110,50,50,corFase);parede26=new Parede(90,30,40,40,corFase);parede27=new Parede(550,5,30,30,corFase);parede28=new Parede(750,70,20,20,corFase);parede29=new Parede(680,180,32,32,corFase);parede30=new Parede(650,450,20,20,corFase);parede34=new Parede(400,270,8,8,corFase);parede35=new Parede(450,230,9,9,corFase);parede31=new Parede(10,10,40,40,"#e6add8","pusher");parede32=new Parede(10,430,60,60,"#e6add8","pusher");parede33=new Parede(808,10,32,32,"#e6add8","pusher");paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13,parede14,parede15,parede16,parede17,parede18,parede19,parede20,parede21,parede22,parede23,parede24,parede25,parede26,parede27,parede28,parede29,parede30,parede31,parede32,parede33,parede34,parede35];inimigo1=new Inimigo(180,80,12,corFase,"vertical",20,220,30,2);inimigo2=new Inimigo(250,205,18,corFase,"horizontal",110,360,50,2,"pusher");inimigo3=new Inimigo(495,70,27,corFase,"horizontal",490,700,65,2,"pusher");inimigo4=new Inimigo(720,35,16,corFase,"vertical",20,220,40,2);inimigo6=new Inimigo(119,330,8,corFase,"horizontal",30,390,30,2);inimigo5=new Inimigo(119,450,21,corFase,"horizontal",118,350,70,2,"pusher");inimigo7=new Inimigo(505,350,18,corFase,"vertical",300,460,45,2.2);inimigo8=new Inimigo(735,350,21,corFase,"vertical",320,460,45,2.2,"pusher");inimigos=[inimigo1,inimigo2,inimigo3,inimigo4,inimigo5,inimigo6,inimigo7,inimigo8];moeda1=new Moeda(180,60,5,"orange","fim");moeda2=new Moeda(334,210,8,"orange","fim");moeda3=new Moeda(530,80,16,"orange","fim");moeda4=new Moeda(740,195,9,"orange","fim");moeda5=new Moeda(148,457,14,"orange","fim");moeda6=new Moeda(358,340,5,"orange","fim");moeda7=new Moeda(540,306,7,"orange","fim");moeda8=new Moeda(625,460,12,"orange","fim");moeda9=new Moeda(432,258,4,"orange","fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5,moeda6,moeda7,moeda8,moeda9];jogadorLados=[16*0.8,16*0.6,16*0.4,16*1,16*1.2,16*2,16*2.5,16*1.5,16*1.1,16*0.8];cenaCarregada=true}jogador.lado=jogadorLados[ui.contaMoedas];loopFase(corFundo,corFase)}function fase12(){var corFase="purple";var corFundo="white";if(cenaCarregada==false){criaMusicaFase10a12();ui=new UI("#306230","#9bbc0f","#9bbc0f","#0f380f");portal1=new Portal(430,250,16,"white","dialogo5");jogador=new Jogador(800,435,jogadorLado*0.9,"blue");parede1=new Parede(400,220,150,10,corFase);parede2=new Parede(400,230,10,50,corFase);parede3=new Parede(400,270,210,10,corFase);parede4=new Parede(600,185,10,95,corFase);parede5=new Parede(280,175,330,10,corFase);parede6=new Parede(280,175,10,140,corFase);parede7=new Parede(280,315,440,10,corFase);parede8=new Parede(710,95,10,230,corFase);parede9=new Parede(140,95,580,10,corFase);parede10=new Parede(140,95,10,310,corFase);parede11=new Parede(140,395,750,10,corFase);parede12=new Parede(455,230,16,40,corFase,"portao",9);parede13=new Parede(270,390,260,54,corFase);parede14=new Parede(40,30,114,390,corFase);parede15=new Parede(400,40,400,90,corFase);parede16=new Parede(270,310,400,50,corFase);parede17=new Parede(270,160,50,50,corFase);parede18=new Parede(585,255,32,32,corFase);parede19=new Parede(725,136,114,37,corFase,"pusher");parede20=new Parede(790,410,50,80,corFase,"pusher");parede21=new Parede(160,350,105,40,corFase,"pusher");paredes=[parede1,parede2,parede3,parede4,parede5,parede6,parede7,parede8,parede9,parede10,parede11,parede12,parede13,parede14,parede15,parede16,parede17,parede18,parede19,parede20,parede21];inimigo1=new Inimigo(250,462,16,"green","horizontal",50,700,60,2.7,"pusher");inimigo2=new Inimigo(256,462,16,"lime","horizontal",50,700,60,3.9,"pusher");inimigo3=new Inimigo(1000,120,9,"lime","vertical",120,330,21,2,"pusher");inimigo4=new Inimigo(1000,140,9,"lime","vertical",120,330,21,2,"pusher");inimigo5=new Inimigo(1000,220,9,"lime","vertical",120,330,21,2,"pusher");inimigo6=new Inimigo(1000,230,9,"lime","vertical",120,330,21,2,"pusher");inimigo7=new Inimigo(1000,270,9,"lime","vertical",120,330,21,2,"pusher");inimigo8=new Inimigo(1000,280,9,"lime","vertical",120,330,21,2,"pusher");inimigo9=new Inimigo(750,1000,14,"lime","horizontal",729,820,32,2,"pusher");inimigo10=new Inimigo(730,1000,14,"lime","horizontal",729,820,32,2.5,"pusher");inimigos=[inimigo1,inimigo2,inimigo3,inimigo4,inimigo5,inimigo6,inimigo7,inimigo8,inimigo9,inimigo10];moeda1=new Moeda(25,435,9,"orange","fim");moeda2=new Moeda(170,25,9,"orange","fim");moeda3=new Moeda(820,155,9,"orange","fim");moeda4=new Moeda(680,375,9,"orange","fim");moeda5=new Moeda(248,372,9,"orange","fim");moeda6=new Moeda(350,140,9,"orange","fim");moeda7=new Moeda(660,200,9,"orange","fim");moeda8=new Moeda(350,285,9,"orange","fim");moeda9=new Moeda(500,250,9,"orange","fim");moedas=[moeda1,moeda2,moeda3,moeda4,moeda5,moeda6,moeda7,moeda8,moeda9];cenaCarregada=true;coresFundo=["black","black","black","#445f5f","#445f5f","#445f5f","#CADC9F","#8BAC0F","#FFFFFF","#FFFFFF"];coresFase=["purple","cyan","red","#ababef","#800040","#800040","#8BAC0F","#CADC9F","#000000","#000000"]}corFundo=coresFundo[ui.contaMoedas];corFase=coresFase[ui.contaMoedas];for(var i=0;i<paredes.length;i+=1){paredes[i].cor=corFase}parede12.cor="purple";if(ui.contaMoedas==9){for(var i=0;i<paredes.length;i+=1){paredes[i].y=600;paredes[i].yMin=1000;portal1.x=0;portal1.y=250;portal1.raio=80;jogador.lado=50;batida1.volume=0;batida2.volume=0;batida3.volume=0;batida4.volume=0;batida5.volume=0}}else{if(ui.contaMoedas>=1){parede11.altura=1000;inimigo1.y=1000;inimigo2.y=1000}if(ui.contaMoedas>=3){parede9.x=0;parede9.y=0;parede9.largura=1000;parede9.altura=105}if(ui.contaMoedas==3){inimigo9.y=220;inimigo10.y=320}else{inimigo9.y=1000;inimigo10.y=1000}if(ui.contaMoedas>=4){parede8.largura=1000;parede8.altura=1000;parede14.x=0;parede14.y=0;parede14.largura=154;parede14.altura=1000}if(ui.contaMoedas==5){inimigo3.x=160;inimigo4.x=180;inimigo5.x=200;inimigo6.x=220;inimigo7.x=240;inimigo8.x=260}else{inimigo3.x=1000;inimigo4.x=1000;inimigo5.x=1000;inimigo6.x=1000;inimigo7.x=1000;inimigo8.x=1000}if(ui.contaMoedas>=6){parede7.altura=1000;parede6.x=0;parede6.y=0;parede6.largura=290;parede6.altura=1000}}loopFase(corFundo,corFase)}function dialogo5(){if(cenaCarregada==false){bonus=185;bonus2=400;dialogoPagina=0;textosFrame=0;qdsQuePassam();dialogoLinha1="You did it.";dialogoLinha2="You really did it!";dialogoLinha3="Now it's a fact.";dialogoLinha4="In this new protocol that we are writing, your story";dialogoLinha5="will be forever remembered.";dialogoLinha6="Experiment 404...";dialogoLinha7="The one who could not be found.";dialogoLinha8="";dialogoLinha9="";dialogoLinha10="";dialogoLinha11="";cenaCarregada=true}document.onkeyup=function(e){if(e.keyCode==13){dialogoPagina+=1;somConfirma()}};if(dialogoPagina==0){criaPagina(dialogoLinha1,"","","")}if(dialogoPagina==1){criaPagina(dialogoLinha2,"","","")}if(dialogoPagina==2){criaPagina(dialogoLinha3,"","","")}if(dialogoPagina==3){criaPagina(dialogoLinha3,dialogoLinha4,dialogoLinha5,"")}if(dialogoPagina==4){criaPagina(dialogoLinha6,"","","")}if(dialogoPagina==5){criaPagina(dialogoLinha7,"","","");ctx.font="bold 14px Verdana";ctx.fillStyle="red";ctx.fillText("+5000000 bonus points for finishing the game!",250,bonus);bonus-=0.4}if(dialogoPagina==6){ctx.beginPath();ctx.fillStyle="#444444";ctx.rect(0,0,canvas.width,canvas.height);ctx.fill();ctx.closePath();ctx.font="14px Verdana";ctx.fillStyle="white";ctx.fillText("Story, art, code and everything else, including",250,bonus2);ctx.fillText("a little bit of madness created during the developement",250,bonus2+20);ctx.fillText("of this game by Diogo Cesar",250,bonus2+40);ctx.fillText("Thanks for playing! /o/",250,bonus2+160);if(bonus2>160){bonus2-=0.5}}if(dialogoPagina==7){ctx.beginPath();ctx.fillStyle="#444444";ctx.rect(0,0,canvas.width,canvas.height);ctx.fill();ctx.closePath();ctx.font="14px Verdana";ctx.fillStyle="white";ctx.fillText("P.S. You can play again jumping to the stages",250,200);ctx.fillText("you liked most, simply pressing ENTER 3 times",250,220);ctx.fillText("to skip a level.",250,240);ctx.fillText("Enjoy! /o/",250,290)}if(dialogoPagina==8){palco.cena="telaInicial";cenaCarregada=false}ctx.font="bold 14px Verdana";piscaTexto("","                    |]","purple","purple",600,340,600,340,60,60);for(var qdpassante=0;qdpassante<qdpassantes.length;qdpassante+=1){qdpassantes[qdpassante].passa()}ctx.beginPath();ctx.rect(0,0,canvas.width,dialogoMargem);ctx.fillStyle="black";ctx.fill();ctx.closePath();ctx.beginPath();ctx.rect(0,canvas.height-dialogoMargem,canvas.width,dialogoMargem);ctx.fillStyle="black";ctx.fill();ctx.closePath()}document.addEventListener("keydown",keyDownHandler,false);function keyDownHandler(e){if(e.key=="Right"||e.key=="ArrowRight"){rightPressed=true}if(e.key=="Left"||e.key=="ArrowLeft"){leftPressed=true}if(e.key=="Up"||e.key=="ArrowUp"){upPressed=true}if(e.key=="Down"||e.key=="ArrowDown"){downPressed=true}if(e.key=="Enter"){enterPressed=true;enterSolto=false}if(e.key=="x"||e.key=="X"){xPressed=true}}document.addEventListener("keyup",keyUpHandler,false);function keyUpHandler(e){if(e.key=="Right"||e.key=="ArrowRight"){rightPressed=false}if(e.key=="Left"||e.key=="ArrowLeft"){leftPressed=false}if(e.key=="Up"||e.key=="ArrowUp"){upPressed=false}if(e.key=="Down"||e.key=="ArrowDown"){downPressed=false}if(e.key=="Enter"){enterPressed=false}if(e.key=="x"||e.key=="X"){xPressed=false}}function criaMusicaFase1a3(){batida1=new Batida("Do2",0.75,"sine",0.9,0,1);batida2=new Batida("La2",1.75,"sine",0.3,0,1*2);batida3=new Batida("Re#3",2,"sine",0.3,0,1*12);batida4=new Batida("Sol3",2,"sine",0.3,0,1*16);batida5=new Batida("Fa#3",2,"sine",0.3,0,1*20);batidas=[batida1,batida2,batida3,batida4,batida5]}function criaMusicaFase4a6(){batida1=new Batida("Sol2",0.2,"sine",0.2,0,1*1/4);batida2=new Batida("Fa#2",0.75,"sine",0.2,0,1*1);batida3=new Batida("Sol#3",3,"sine",0.3,0,1*4);batida4=new Batida("La#3",3,"sine",0.3,0,1*12);batida5=new Batida("Fa#3",3,"sine",0.3,0,1*16);batidas=[batida1,batida2,batida3,batida4,batida5]}function criaMusicaFase10a12(){batida1=new Batida("Mi2",3,"sine",0.9,0,1*2);batida2=new Batida("Mi4",3,"sine",0.2,0,1*4);batida3=new Batida("La3",0.75,"sine",0.2,0,1*6);batida4=new Batida("Si3",0.75,"sine",0.2,0,1*8);batida5=new Batida("La3",0.75,"sine",0.2,0,1*10);batidas=[batida1,batida2,batida3,batida4,batida5]}function criaMusicaFase7a9(){batida1=new Batida("Re2",0.9,"sine",0.9,0,1);batida2=new Batida("Si2",0.9,"sine",0.3,0,1*2);batida3=new Batida("Fa3",6,"sine",0.3,0,1*8);batida4=new Batida("La3",6,"sine",0.3,0,1*12);batida5=new Batida("Sol3",6,"sine",0.3,0,1*14);batidas=[batida1,batida2,batida3,batida4,batida5]}function somConfirma(){som=new Notas("La4",1,"square",0.2);som.toca()}function somMoeda(){som=new Notas("Si5",3,"triangle",0.7);som.toca()}function somParede(){som=new Notas("Mi2",1,"sawtooth",0.3);som.toca()}function somPego(){som=new Notas("Si2",2,"sawtooth",0.2);som.toca()}function somPortaAbriu(){som=new Notas("Sol5",3,"triangle",0.7);som.toca()}function somPortaFechou(){som=new Notas("Sol2",3,"sawtooth",0.7);som.toca()}function somPortal(){som=new Notas("Sol7",4,"square",0.1);som.toca()}function loopFase(corFundo,corFase){for(var batida=0;batida<batidas.length;batida+=1){batidas[batida].toca()}ctx.beginPath();ctx.fillStyle=corFundo;ctx.rect(0,0,canvas.width,canvas.height);ctx.fill();ctx.closePath();for(var inimigo=0;inimigo<inimigos.length;inimigo+=1){inimigos[inimigo].desenha();inimigos[inimigo].move()}for(var parede=0;parede<paredes.length;parede+=1){paredes[parede].desenha()}ctx.beginPath();ctx.strokeStyle=corFase;ctx.lineWidth=12;ctx.strokeRect(0,0,canvas.width,canvas.height);ctx.closePath();for(var moeda=0;moeda<moedas.length;moeda+=1){moedas[moeda].desenha()}portal1.desenha();jogador.desenha();jogador.move();jogador.inimigoPegou();jogador.moeda();jogador.portal();ui.contaBits();document.onkeyup=function(e){if(e.keyCode==13){skip+=1;}};if(skip>2){jogador.x=portal1.x;jogador.y=portal1.y;skip=0}}function qdsQuePassam(){qdpassante1=new Qdpassante(randomQdpassante,600,2,"#BBBBBB",3);qdpassante2=new Qdpassante(randomQdpassante,800,2,"#BBBBBB",3);qdpassante3=new Qdpassante(randomQdpassante,1000,3,"#BBBBBB",3);qdpassante4=new Qdpassante(randomQdpassante,1200,3,"#BBBBBB",3);qdpassante5=new Qdpassante(randomQdpassante,1400,3,"#BBBBBB",3);qdpassante6=new Qdpassante(randomQdpassante,1600,4,"#BBBBBB",3);qdpassante7=new Qdpassante(randomQdpassante,1800,4,"#BBBBBB",3);qdpassante8=new Qdpassante(randomQdpassante,2000,3,"#BBBBBB",3);qdpassante9=new Qdpassante(randomQdpassante,2200,3,"#BBBBBB",3);qdpassante10=new Qdpassante(randomQdpassante,2400,3,"#BBBBBB",3);qdpassante11=new Qdpassante(randomQdpassante,2600,2,"#BBBBBB",3);qdpassante12=new Qdpassante(randomQdpassante,2800,2,"#BBBBBB",3);qdpassantes=[qdpassante1,qdpassante2,qdpassante3,qdpassante4,qdpassante5,qdpassante6,qdpassante7,qdpassante8,qdpassante9,qdpassante10,qdpassante11,qdpassante12]}function piscaTexto(texto1,texto2,cor1,cor2,pos1x,pos1y,pos2x,pos2y,t1,t2){if(textosFrame<t1){ctx.fillStyle=cor1;ctx.fillText(texto1,pos1x,pos1y);textosFrame+=1}else{ctx.fillStyle=cor2;ctx.fillText(texto2,pos2x,pos2y);textosFrame+=1;if(textosFrame>t1+t2){textosFrame=0}}}function criaPagina(fala1,fala2,fala3,fala4){ctx.beginPath();ctx.rect(0,0,canvas.width,canvas.height);ctx.fillStyle="white";ctx.fill();ctx.closePath();ctx.font="20px Verdana";ctx.fillStyle="green";ctx.fillText(fala1,150,210);ctx.fillText(fala2,150,240);ctx.fillText(fala3,150,270);ctx.fillText(fala4,150,300)}function preSetup(){if(preSetupCarregado==false){palco=new Palco("telaInicial");preSetupCarregado=true}}function main(){ctx.clearRect(0,0,canvas.width,canvas.height);preSetup();palco.chamaCena();requestAnimationFrame(main)}main();</script></body></html>;