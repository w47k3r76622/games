(function(){function e(b){this.id=b;this.running=!1;this.users=[]}var d=[];e.prototype.add=function(b){var a=this,c=this.users.length;this.users.push(b);b.on("disconnect",function(){a.end(c)});this.users.length===2&&this.start()};e.prototype.start=function(){var b=this,a={seed:Math.floor(Math.random()*4294967296)};this.running=!0;this.users.forEach(function(c,d){c.on("data",function(a){b.msg(a)});c.emit("start",JSON.stringify({user:d,details:a}))})};e.prototype.msg=function(b){this.users.forEach(function(a){a.emit("data",
b)})};e.prototype.end=function(b){this.running&&this.users.forEach(function(a){a.emit("end",b);a.disconnect(!0)});d.splice(d.indexOf(this),1)};module.exports=function(b){b.on("start",function(a){a:{var c;for(c=0;c<d.length;c++)if(d[c].id===a&&!d[c].running){a=d[c];break a}a=new e(a);d.push(a)}a.add(b)})}})();
