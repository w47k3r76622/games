(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();const lt={disk:function(e,t,n){this.beginPath(),this.arc(e,t,n,0,Math.PI*2),this.fill()},circle:function(e,t,n){this.beginPath(),this.arc(e,t,n,0,Math.PI*2),this.stroke()},lineDir:function(e,t,n,i){this.beginPath(),this.moveTo(e,t),this.lineTo(e+n.x*i,t+n.y*i),this.stroke()},line:function(e,t,n,i){this.beginPath(),this.moveTo(e,t),this.lineTo(n,i),this.stroke()},fontSize:function(e){this.font=e+"em Calibri"},textCenter:function(){this.textAlign="center",this.textBaseline="middle"},bubbleGradient:function(e,t,n,i){const o=this.createRadialGradient(e+n/2,t-n/2,n/13,e,t,n);o.addColorStop(0,"white"),o.addColorStop(1,i),this.fillStyle=o}};function st(e){for(const[t,n]of Object.entries(lt))e[t]=n.bind(e)}const a={x:0,y:0,down:!1,up:!1,pressed:!1,wheel:0};let L=[];function rt(e){e.addEventListener("mousedown",t=>{a.x=t.offsetX,a.y=t.offsetY,a.down=!0,a.pressed=!0}),e.addEventListener("mouseup",t=>{a.x=t.offsetX,a.y=t.offsetY,a.up=!0,a.pressed=!1}),e.addEventListener("mousemove",t=>{a.x=t.offsetX,a.y=t.offsetY}),e.addEventListener("wheel",t=>{a.wheel=t.deltaY}),e.addEventListener("keydown",t=>{L[t.key]||(L[t.key]={}),L[t.key].down=!0,L[t.key].pressed=!0;const n=ye.keyDown[t.key];n&&n()}),e.addEventListener("keyup",t=>{L[t.key]||(L[t.key]={}),L[t.key].up=!0,L[t.key].pressed=!1;const n=ye.keyUp[t.key];n&&n()})}function ft(){a.up=!1,a.down=!1,a.wheel=0;for(const e of L)e.up=!1,e.down=!1}let ye={};function he(e,t){ye.keyUp[e]=t}function Ae(){ye={keyDown:{},keyUp:{}}}Ae();function E(e,t){return Math.floor(Math.random()*(t-e)+e)}function De(e,t,n){return e<t?t:e>n?n:e}function p(e,t){return{x:e,y:t}}function ut(e){return(e.x**2+e.y**2)**(1/2)}function at(e,t,n,i){return ut(p(n-e,i-t))}function ge(e,t){if(typeof e=="object"&&(t=e.y,e=e.y),e==0||t==0)return p(0,0);const n=Math.sqrt(e*e+t*t);return p(e/n,t/n)}function ze(e,t){const n=ge(e.x,e.y);switch(typeof t){case"object":return{x:n.x*t.x,y:n.y*t.y};case"number":return{x:n.x*t,y:n.y*t};default:return null}}function v(e){return`hsla(${e}, 100%, 80%, 1)`}const ht=(...e)=>Ue(Xe(...e)),Ue=(...e)=>{let t=de.createBufferSource(),n=de.createBuffer(e.length,e[0].length,w);return e.map((i,o)=>n.getChannelData(o).set(i)),t.buffer=n,t.connect(de.destination),t.start(),t},Xe=(e=1,t=.05,n=220,i=0,o=0,l=.1,f=0,r=1,c=0,b=0,S=0,D=0,T=0,j=0,x=0,Y=0,g=0,Z=1,B=0,W=0)=>{let m=2*Math.PI,se=c*=500*m/w**2,re=(0<x?1:-1)*m/4,K=n*=(1+2*t*Math.random()-t)*m/w,I=[],z=0,J=0,d=0,V=1,it=0,ot=0,O=0,fe,Q;for(i=99+w*i,B*=w,o*=w,l*=w,g*=w,b*=500*m/w**3,x*=m/w,S*=m/w,D*=w,T=w*T|0,Q=i+B+o+l+g|0;d<Q;I[d++]=O)++ot%(100*Y|0)||(O=f?1<f?2<f?3<f?Math.sin((z%m)**3):Math.max(Math.min(Math.tan(z),1),-1):1-(2*z/m%2+2)%2:1-4*Math.abs(Math.round(z/m)-z/m):Math.sin(z),O=(T?1-W+W*Math.sin(2*Math.PI*d/T):1)*(0<O?1:-1)*Math.abs(O)**r*e*dt*(d<i?d/i:d<i+B?1-(d-i)/B*(1-Z):d<i+B+o?Z:d<Q-g?(Q-d-g)/l*Z:0),O=g?O/2+(g>d?0:(d<Q-g?1:(Q-d)/g)*I[d-g|0]/2):O),fe=(n+=c+=b)*Math.sin(J*x-re),z+=fe-fe*j*(1-1e9*(Math.sin(d)+1)%2),J+=fe-fe*j*(1-1e9*(Math.sin(d)**2+1)%2),V&&++V>D&&(n+=S,K+=S,V=0),!T||++it%T||(n=K,c=se,V=V||1);return I},dt=.1,w=44100;let de=null;//! ZzFXM (v2.0.3) | (C) Keith Clark | MIT | https://github.com/keithclark/ZzFXM
const ct=(e,t,n,i=125)=>{let o,l,f,r,c,b,S,D,T,j,x,Y,g,Z,B=0,W=[],m=[],se=[],re=0,K=0,I=1,z={},J=w/i*60>>2;for(;I;re++)W=[I=D=Y=0],n.map((d,V)=>{for(S=t[d][re]||[0,0,0],I|=!!t[d][re],Z=Y+(t[d][0].length-2-!D)*J,g=V==n.length-1,l=2,r=Y;l<S.length+g;D=++l){for(c=S[l],T=l==S.length+g-1&&g||j!=(S[0]||0)|c|0,f=0;f<J&&D;f++>J-99&&T?x+=(x<1)/99:0)b=(1-x)*W[B++]/2||0,m[r]=(m[r]||0)-b*K+b,se[r]=(se[r++]||0)+b*K+b;c&&(x=c%1,K=S[1]||0,(c|=0)&&(W=z[[j=S[B=0]||0,c]]=z[[j,c]]||(o=[...e[j]],o[2]*=2**((c-12)/12),c>0?Xe(...o):[])))}Y=Z});return[m,se]},pt={interact:[.1,0,55,.03,.01,.03,4,2,,6,-353,.11,,,,,,.55,.03,,-604],shoot:[,,354,,,0,,3.6,-6,5,,,,,,,,0,.19],explode:[.2,.3,,.02,.27,.41,,3.7,7,,,,.21,,,.3,,.4,.27],score:[.2,0,440,.02,.03,.05,,1.4,,,350,.05,,,,,,.7,.04]};let ee=!1;function yt(){return ee}function gt(){de=new AudioContext,Ce=ct([[.5,0,300,,,.3,,2,,,,,.1,,1,,.4,,.1,.2]],[[[,,15,19,22,20,19,15,19,17,15,12,15,22,20,24,22,20,19,15,17,26,27,31,34,22,24,20,22,19,15,27,26,,],[,,15,,10,,12,,7,,8,,3,,8,,10,,15,,10,,12,,7,,8,,3,,8,,10,,]]],[0],25,{title:"Canon In D",instruments:["0"],patterns:["0"]})}function ve(){ee=!ee,ee?qe():Ee()}function U(e){ee||ht(...pt[e])}let Ce,ae;function Ee(){!Ce||ee||(ae&&ae.stop(),ae=Ue(...Ce),ae.loop=!0)}window.addEventListener("focus",()=>Ee());window.addEventListener("blur",()=>qe());function qe(){ae.stop()}let te=[];function mt(e){const t=E(30,200);te.push({x:E(0,s.width),y:-t,size:t,hue:E(0,360),speed:E(20,150)})}function He(e){for(let t=0;t<te.length;t++){const n=te[t];e.bubbleGradient(n.x,n.y,n.size,v(n.hue)),e.disk(n.x,n.y,n.size)}e.fillStyle="#FFFFFFCC",e.fillRect(0,0,s.width,s.height)}function Ye(e){for(let t=te.length-1;t>0;t--){const n=te[t];n.y+=n.speed*e,n.y>s.height+n.size&&te.splice(t,1)}Math.random()<.05&&mt()}let me;function wt(){Pe(Ye),ke(He),ke(St),Pe(bt),he("m",()=>{ve()}),me=0}function bt(e){me+=e}function St(e){e.save(),e.translate(s.width/2,200);const t=s.width/13;for(let i=0;i<13;i++){const o=i*t-s.width/2+t/2,l=Math.floor(Math.cos(i-me)*t);e.bubbleGradient(o,l,t,v(i*360/13)),e.disk(o,l,t)}e.fontSize(8),e.textCenter(),e.fillStyle=v(me*50%360),e.fillText("13 Bubbles",5,5),e.fillStyle="black",e.fillText("13 Bubbles",0,0),e.restore(),e.save(),e.translate(300,600);const n=130;ue(e,0,0,n,v(180),"Play",6,!1),ue(e,n*1.3,-n,60,v(90),"Easy",2)&&(U("interact"),ie(ne.game,{difficulty:0})),ue(e,n*1.7,0,60,v(50),"Normal",2)&&(U("interact"),ie(ne.game,{difficulty:1})),ue(e,n*1.3,n,60,v(0),"Hard",2)&&(U("interact"),ie(ne.game,{difficulty:2})),e.restore(),ue(e,s.width-50,s.height-50,40,v(270),"Sound "+(yt()?"off":"on"),1)&&ve(),e.fontSize(2),e.fillText("Made by @NoNiMad",s.width/2,s.height-60),e.fontSize(1),e.fillText("Using zzfx(m)",s.width/2,s.height-30)}function ue(e,t,n,i,o,l,f,r,c){if(e.bubbleGradient(t,n,i,o),e.disk(t,n,i),e.fontSize(f),e.textCenter(),e.fillStyle="black",e.fillText(l,t,n),r===!1)return!1;const b=new DOMPoint(t,n).matrixTransform(e.getTransform());return!!(at(b.x,b.y,a.x,a.y)<i*C&&(e.lineWidth=2,e.strokeStyle="black",e.circle(t,n,i),a.up))}const Mt=Object.freeze(Object.defineProperty({__proto__:null,onEnter:wt},Symbol.toStringTag,{value:"Module"})),u=52,G=13,y=39,Ze=.39,je=13*60,kt=13*50;let k,_,h,xe,X,q,P,oe,H,ce,we,$,be,Te,Le,F,A,Se,le,Be;function Oe(){return E(0,3)==0?-E(1,7):E(1,8)}function Pt(){return{value:Oe(),color:E(0,_.length)}}function We(){Ke(),h.unshift([]),xe+=1;for(let e=0;e<G;e++)h[0].push(Pt());Ge((e,t,n)=>{n.gridPos=p(e,t),n.pos=Je(n.gridPos)})}function Ke(){for(let e=h.length-1;e>=0;e--){for(let t=0;t<G;t++)if(h[e][t]!==null)return;h.splice(e,1)}}function Je(e){const t=u*(.5+e.y*7/8),n=y+(e.x+.5+Fe(e.y)/2)*u;return p(n,t)}function Re(e,t){const n=Math.floor(e.y*8/(u*7)-.5714285714285714+.5),i=Math.floor((e.x-y)/u-Fe(n)/2);return!t&&(i<0||i>=G||n<0||n>=h.length)?null:p(i,n)}function zt(e){const t=Re(e);return t==null?null:h[t.y][t.x]}function Ct(e,t){return((e.x-t.pos.x)**2+(e.y-t.pos.y)**2)**.5}function Fe(e){return(e+xe)%2}function Ge(e){for(let t=0;t<h.length;t++){const n=h[t];for(let i=0;i<n.length;i++){let o=n[i];if(o!==null&&e(i,t,o)===!1)return}}}function Qe(e){let t=e.gridPos.x,n=e.gridPos.y,i=[],o=Fe(n)==0,l=o?-1:0;return t>0&&i.push(h[n][t-1]),t<G-1&&i.push(h[n][t+1]),n>0&&((t>0||!o)&&i.push(h[n-1][t+l]),(t<G-1||o)&&i.push(h[n-1][t+1+l])),n<h.length-1&&((t>0||!o)&&i.push(h[n+1][t+l]),(t<G-1||o)&&i.push(h[n+1][t+1+l])),i.filter(f=>f!=null)}function et(e){let t=new Set,n=[e];for(;n.length!=0;)n=n.flatMap(i=>(t.add(i),Qe(i).filter(o=>o.color===e.color&&!t.has(o))));return[...t]}function Tt(){const e=new Set(h.flatMap(t=>t.filter(n=>n!=null)));for(let t of h[0]){if(t==null||!e.has(t))continue;let n=new Set([t]),i,o;for(;n.size!=0;){i=n.values().next().value,e.delete(i),n.delete(i),o=Qe(i);for(let l=0;l<o.length;l++)e.has(o[l])&&n.add(o[l])}}return[...e]}function Lt(e){const t=e.createLinearGradient(y,0,0,0);t.addColorStop(0,"#00000000"),t.addColorStop(1,_[H]),e.fillStyle=t,e.fillRect(0,0,y,s.height);const n=e.createLinearGradient(s.width-y,0,s.width,0);if(n.addColorStop(0,"#00000000"),n.addColorStop(1,_[H]),e.fillStyle=n,e.fillRect(s.width-y,0,s.width,s.height),e.lineWidth=1,e.line(y-1,0,y-1,s.height),e.line(s.width-y+1,0,s.width-y+1,s.height),Ge((i,o,l)=>{pe(e,l.pos,l)}),!A){vt(e);for(let i of oe)pe(e,i.pos,i);q.forEach(i=>pe(e,i.pos,i)),e.fillStyle="black",e.textAlign="left",le>0&&e.fillText(Be,y*1.5+e.measureText("Score: ").width,s.height-u*1.5),e.fillText("Score: "+Se,y*1.5,s.height-u),e.fillText("Next line in: "+(k.shotsBetweenLine-we%k.shotsBetweenLine),y*1.5,s.height-u/2),Et(e)}(A||F)&&(e.textCenter(),e.fillStyle="#FFFFFFBB",e.fillRect(0,0,s.width,s.height),e.fillStyle="black",e.fontSize(8),e.fillText(A?"Game Over!":"Paused",s.width/2,s.height/2-100),e.fontSize(4),e.fillText("Score: "+Se,s.width/2,s.height/2),e.fontSize(1),e.fillText("Click anywhere to "+(A?"go back to the main menu":"resume game"),s.width/2,s.height/2+200),F&&e.fillText("Press Q to go back to the main menu",s.width/2,s.height/2+220))}function vt(e){e.lineWidth=2,e.lineDir($.x,$.y,be,u*2),P[0]!=null&&pe(e,$,{value:P[0],color:H}),e.save(),e.translate(s.width/2,s.height);for(let t=1;t<P.length;t++)e.fillStyle="black",e.fillText(P[t],t*(u+13),-u/2);e.restore()}function Et(e){if(X.length==0)return;let t=0,n=0,i=0;X.forEach(f=>{t+=f.value,i+=f.pos.x,n=Math.max(n,f.pos.y)});let o={x:i/X.length,y:n+u};e.fillStyle="black",e.disk(o.x,o.y,u/2),e.fontSize(1.8),e.textCenter();const l=t%13;l>0?e.fillText(`${t-l} < ${t-l+13}`,o.x,o.y+u):l<0&&e.fillText(`${t-l-13} < ${t-l}`,o.x,o.y+u),e.fillStyle="white",e.fillText(t,o.x,o.y)}function pe(e,t,n){e.bubbleGradient(t.x,t.y,u/2,_[n.color]),e.disk(t.x,t.y,u/2),X.includes(n)&&(e.lineWidth=2,e.strokeStyle="black",e.circle(t.x,t.y,u/2-1)),e.fontSize(1.8),e.textCenter(),e.fillStyle="black",e.fillText(n.value,t.x,t.y)}function xt(e){if(A){a.up&&ie(ne.menu);return}if(F){a.up&&(F=!1);return}le>0&&(le-=e);for(let t=q.length-1;t>=0;t--){const n=q[t];if(n.pos.x<-u||n.pos.x>s.width+u||n.pos.y>s.height+u){q.splice(t,1),Rt(n);continue}n.speed.y+=kt*e,n.pos.x+=n.speed.x*e,n.pos.y+=n.speed.y*e}be=ge(a.x/C-$.x,Math.min(a.y/C,$.y-13)-$.y),Ot(e),Bt()}function Bt(){const e=zt(p(a.x/C,a.y/C));X=e!=null?et(e):[]}function Ot(e){if(a.wheel!=0){let t=a.wheel>0?-1:1,n=H+t;n>=_.length?n=0:n<0&&(n=_.length-1),H=n,U("interact")}ce>Ze?(P[0]==null&&(P.shift(),P.push(Oe())),a.down&&(we++,oe.push({value:P[0],color:H,pos:{...$},speed:p(be.x*je,be.y*je),addLineOnCollision:we%k.shotsBetweenLine==0}),P[0]=null,ce=0,U("shoot"))):ce+=e;for(let t of oe)if(t.pos.x+=t.speed.x*e,t.pos.y+=t.speed.y*e,t.pos.x<Te&&(t.pos.x=Te,t.speed.x=-t.speed.x),t.pos.x>Le&&(t.pos.x=Le,t.speed.x=-t.speed.x),t.pos.y<u/2){const n=u/2-t.pos.y,i=ge(t.speed),o=p(t.pos.x-i.x*n,t.pos.y-i.y*n);Ie(t,o)}else{const n=Re(t.pos,!0);Ge((i,o,l)=>{if(Math.abs(n.x-i)>2||Math.abs(n.y-o)>2)return;const f=Ct(t.pos,l);if(f<=u){const r=u-f,c=ge(t.speed),b=p(t.pos.x-c.x*r,t.pos.y-c.y*r);return Ie(t,b),!1}})}}function Ie(e,t){oe.splice(oe.indexOf(e),1);const n=Re(t,!0);if(n.y>25){Ve();return}n.x=De(n.x,0,G-1),n.y=De(n.y,0,h.length),n.y==h.length&&h.push(new Array(G).fill(null)),e.gridPos=n,h[n.y][n.x]=e;const i=et(e),o=i.reduce((l,f)=>l+f.value,0);if(o%13==0){const l=Math.max(Math.abs(o)/13,1);i.forEach(r=>{h[r.gridPos.y][r.gridPos.x]=null,r.speed=r==e?ze(r.speed,p(130,260)):ze(p(r.pos.x-e.pos.x,r.pos.y-e.pos.y),p(130,260)),delete r.gridPos,r.multiplier=l}),q.push(...i);const f=Tt();f.forEach(r=>{h[r.gridPos.y][r.gridPos.x]=null,r.speed=ze(p(r.pos.x-e.pos.x,r.pos.y-e.pos.y),p(10,260)),delete r.gridPos,r.multiplier=l}),q.push(...f),U("explode"),Ke()}else e.pos=Je(n);e.addLineOnCollision&&(We(),h.length>26&&Ve())}function Rt(e){Se+=Math.abs(e.value*e.multiplier),le=Math.min(le+.2,2),Be=Math.abs(e.value)+" x"+e.multiplier,U("score")}function Ve(){A=!0,X=[]}function Ft(e){if(Pe(Ye),ke(He),ke(Lt),Pe(xt),he("Escape",()=>{F=!F}),he("q",()=>{F&&ie(ne.menu)}),he("m",()=>{ve()}),h=[],X=[],q=[],xe=0,oe=[],H=0,we=0,ce=Ze,$=p(s.width/2,s.height-u),Te=y+u/2,Le=s.width-y-u/2,A=!1,F=!1,Se=0,le=0,Be=1,e.difficulty!==void 0)switch(e.difficulty){case 0:k={initialLines:3,numberOfColors:2,nextValuesCount:5,shotsBetweenLine:5};break;case 1:k={initialLines:5,numberOfColors:3,nextValuesCount:4,shotsBetweenLine:5};break;case 2:k={initialLines:7,numberOfColors:4,nextValuesCount:3,shotsBetweenLine:5};break}else k=e.gameConfig;_=[];const t=E(0,360);for(let n=0;n<k.numberOfColors;n++)_.push(v(t+n*360/k.numberOfColors));for(let n=0;n<k.initialLines;n++)We();P=[];for(let n=0;n<k.nextValuesCount;n++)P.push(Oe())}const Gt=Object.freeze(Object.defineProperty({__proto__:null,onEnter:Ft},Symbol.toStringTag,{value:"Module"})),$t=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),s={};let M,C=1;function _t(){const e=document.querySelector("canvas");s.element=e,s.boundingRect=e.getBoundingClientRect(),s.width=e.width,s.height=e.height,M=e.getContext("2d"),rt(e),st(M),R=performance.now(),Me=R-tt,window.addEventListener("resize",Ne),Ne(),e.addEventListener("focus",()=>{gt(),Ee()},{once:!0}),ie(ne.menu),nt()}function Ne(){C=Math.min(window.innerHeight/1280,1),s.element.width=780*C,s.element.height=1280*C}const Dt=144,tt=1e3/Dt;let R,Me;function nt(){let e=R;R=performance.now();let t=R-e;It(t/1e3),R-Me>=tt&&(jt(),Me=R),ft(),requestAnimationFrame(nt)}function jt(){M.save(),M.scale(C,C),M.fillStyle="white",M.fillRect(0,0,s.width,s.height),M.fillStyle="black",M.fillText(Math.floor(1e3/(R-Me)),10,20),$e.forEach(e=>{M.save(),e(M),M.restore()}),M.restore()}function It(e){_e.forEach(t=>t(e))}let $e=[],_e=[];function ke(e){$e.push(e)}function Pe(e){_e.push(e)}const ne={menu:Mt,game:Gt,customGame:$t};let N=null;function ie(e,t){var n;(n=N==null?void 0:N.onLeave)==null||n.call(N),$e=[],_e=[],Ae(),N=e,N.onEnter(t)}window.addEventListener("load",_t);
