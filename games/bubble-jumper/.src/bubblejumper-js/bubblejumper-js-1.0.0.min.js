/*! bubblejumper-js-1.0.0 2015-09-13 https://github.com/dqsmith/bubblejumper-js*/
function jump(){canJump&&(vy=-16,canJump=!1,removeBubble())}function checkCollison(){if(!collided){for(var a in bubbles){var b=bubbles[a].bubble;if(hasCollided(jumper,b)){collided=!0,canJump=!0;var c=document.getElementById(b.id),d="";if(c.className.indexOf("bonus")>=0&&(d="bonus"),c.className="bubble inner animate-bubble "+d,collidedBubble=bubbles[a],points.className="points",points.textContent="+1",c.appendChild(points),updateScore(score++),combo++,!firstBlood)return firstBlood=!0,void showMessage(messages.FIRST_BLOOD,2);if(1===grounded&&!savior)return savior=!0,void showMessage(messages.SAVIOR,10);d&&showMessage(messages.BONUS,20),5>=comboTicks&&3===combo?showMessage(messages.COMBO,3):comboTicks>5&&(comboTicks=0,combo=0)}}jumperY==stageHeight-75&&(canJump=!0,jump(),grounded++)}}function removeBubbles(){for(var a=bubbles.length;a--;)bubbles[a].y<30&&(stage.removeChild(document.getElementById(bubbles[a].id)),bubbles.splice(a,1))}function moveBubbles(){for(var a=bubbles.length;a--;){var b=bubbles[a].bubble.parentElement.offsetTop+bubbles[a].offsetTop;bubbles[a].y-=bubbles[a].s,b>1e3&&0>b&&(bubbles[a].bubble.style.left=bubbles[a].x+"px",bubbles[a].bubble.style.top=bubbles[a].y+"px")}}function hasCollided(a,b){var c=a.getBoundingClientRect(),d=b.getBoundingClientRect();return!(c.top>d.bottom||c.right<d.left+25||c.bottom<d.top||c.left>d.right-25)}function checkRemoveBubble(){scale>.75&&removeBubble()}function removeBubble(){collided=!1,scale=.5,jumper.style.transform="scale("+scale+")",collidedBubble.y=-collidedBubble.h-50}function draw(){if(isPlaying){if(removeBubbles(),moveBubbles(),collided||(jumping(),checkCollison()),render(),checkRemoveBubble(),2>grounded?requestAnimationFrame(draw):(clearTimeout(timerTimeout),document.getElementById("game-over").className=""),playingCounter%50===0&&bubbles.length<15){var a=bubbleCounter%10===0;bubbles.push(new Bubble(playingCounter,100,100,"collidable",null,null,a)),bubbleCounter++}playingCounter++}}function move(a){null===keyTimer&&(keyTimer=setInterval(function(){1===a?jumperX-=5:jumperX+=5},33))}function jumping(){vy+=gravity,jumperY+=vy,jumperY>stageHeight-75&&(jumperY=stageHeight-75,vy=0,canJump=!0,collided=!1)}function keyDown(a){var b=a.keyCode?a.keyCode:a.which;switch(b){case 38:jump();break;case 40:break;case 37:move(1);break;case 39:move(0)}}function keyUp(a){var b=a.keyCode?a.keyCode:a.which;isPlaying||32!==b||(isPlaying=!0,stage.style.top=-stageY+"px",baseStage.removeChild(document.getElementById("title")),baseStage.removeChild(document.getElementById("instructions")),document.getElementById("time-cont").className="",document.getElementById("score-cont").className="",draw(),gameTimer()),(37===b||39===b)&&(clearInterval(keyTimer),keyTimer=null)}function render(){for(var a in bubbles)bubbles[a].bubble.style.top=bubbles[a].y+"px";collided?(jumperX=collidedBubble.x+10,jumperY=collidedBubble.y+1,scale+=.001,jumper.style.transform="scale("+scale+")",collidedBubble.bubble.transform="scale("+scale+")",jumperY<stageY+stageYOffset+-window.innerHeight+800&&(stageY-=1,stage.style.top=-stageY+window.innerHeight-800+"px",stage.className="start-playing"),jumper.parentElement.offsetTop+jumper.offsetTop<200&&(collidedBubble.y=collidedBubble.y+1)):3190>stageY&&(stageY+=Math.round(vy),stage.style.top=-stageY+window.innerHeight-800+"px"),jumper.style.left=jumperX+"px",jumper.style.top=jumperY+"px"}function updateScore(a){document.getElementById("score").textContent=a}function Bubble(a,b,c,d,e,f,g){var h=document.createElement("div"),a="bubble_"+a,i=Math.round(1*Math.random())+2,e=e||Math.round(Math.random()*stageWidth)-b/2,f=f||Math.round(100*Math.random())+stageHeight,j=g?"bonus":"";return h.setAttribute("id",a),h.className="bubble inner "+d+" "+j,h.style.cssText="left: "+e+"px; top: "+f+"px; width:"+b+"px; height:"+c+"px;",stage.appendChild(h),{bubble:h,id:a,s:i,x:e,y:f,w:b,h:c}}function updateTime(){seconds++,seconds>=60&&(seconds=0,minutes++),seconds%30===0&&showMessage(messages.SURVIVOR,5),comboTicks++,document.getElementById("time").textContent=(minutes?minutes>9?minutes:"0"+minutes:"00")+":"+(seconds>9?seconds:"0"+seconds),seconds%24===0?(direction*=-1,baseStage.className="reverse"):seconds%50===0&&(baseStage.className="forward"),gameTimer()}function showMessage(a,b){message.textContent="",message.className="",scoreContainer.className="",clearTimeout(messageTimeout),message.textContent=a,message.className="show",messageTimeout=setTimeout(function(){message.textContent="",message.className="",scoreContainer.className=""},750),b.textContent="+"+b,updateScore(score+=b),scoreContainer.className="score-animate"}function gameTimer(){timerTimeout=setTimeout(updateTime,1e3)}function placeStage(){baseStage.style.left=window.innerWidth/2-baseStage.clientWidth/2+"px",baseStage.style.height=window.innerHeight+"px",stage.style.top=-stageY+window.innerHeight-790+"px"}var jumper=document.getElementById("jumper"),height=document.getElementById("stage").clientHeight,baseStage=document.getElementById("stage"),stage=document.getElementById("inner-stage"),spikeyTop=document.getElementById("spikey-top"),spikeyBottom=document.getElementById("spikey-bottom"),message=document.getElementById("message"),points=document.createElement("div"),scoreContainer=document.getElementById("score-cont"),stageHeight=stage.clientHeight,stageWidth=stage.clientWidth,jumperX=stageWidth/2-84,stageY=3200-window.innerHeight+800,stageYOffset=400,jumperY=3900,vy=0,gravity=.5,canJump=!0,keyTimer=null,collided=!1,collidedBubble=null,scale=.5,bubbles=[],backgroundBubbles=[],timerInterval,direction=1,j=0,grounded=0,score=0,isPlaying=!1,seconds=0,minutes=0,hours=0,timerTimeout,messageTimeout,playingCounter=0,bubbleCounter=1,combo=0,comboTicks=0,savior=!1,firstBlood=!1,messages={FIRST_BLOOD:"First blood!",SAVIOR:"Savior!!",COMBO:"Combo!!",SURVIVOR:"Survivor!!",BONUS:"Bonus, baby!!!"};bubbles.push(new Bubble(j,100,100,"collidable",jumperX-15,jumperY)),collidedBubble=bubbles[0],collided=!0,jumper.style.cssText="left:"+jumperX+"px;top:3897px;",stage.style.top="0px";for(var spikeyLeft=-18,i=0;40>i;i++){var spikey=document.createElement("div");spikey.className="spikey",spikey.style.cssText="left:"+spikeyLeft+"px;top:3897px;",spikeyLeft+=45,spikeyBottom.appendChild(spikey)}for(var i=0;40>i;i++){var x=Math.round(Math.random()*stage.clientWidth),y=Math.round(Math.random()*stage.clientHeight);backgroundBubbles.push(new Bubble("",30,30,"background",x,y))}window.onkeydown=keyDown,window.onkeyup=keyUp,window.addEventListener("resize",placeStage),placeStage(),draw();