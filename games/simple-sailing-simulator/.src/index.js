var ctx,image,memory,exports;const width=160,height=144;function blit_frame(){ctx.putImageData(image,0,0)}function blit_text(e,t,n,s,o){let i=(new TextDecoder).decode(new Uint8Array(memory.buffer,e,t));ctx.font=o+"px serif",ctx.fillText(i,n,s)}function keyboard_callback(e){const n=exports.KEYCODE.value,t=new Uint8ClampedArray(exports.memory.buffer,n,2);t[0]=e.keyCode,console.log("thing"+t[0]),console.log(n),console.log(t[0]),exports.keyboard_input()}async function init(){const t=document.getElementById("window");t.width=width,t.height=height,ctx=t.getContext("2d");const{instance:e}=await WebAssembly.instantiateStreaming(fetch("./index.wasm"),{env:{js_sin:Math.sin,blit_frame,blit_text}});exports=e.exports,document.getElementById("body").onkeydown=keyboard_callback,memory=e.exports.memory;const s=e.exports.BUFFER.value;image=new ImageData(new Uint8ClampedArray(memory.buffer,s,4*width*height),width),e.exports.frame_entry(),ctx.textBaseline="top",ctx.textAlign="left";const n=()=>{e.exports.frame_entry(),requestAnimationFrame(n)};n()}init()