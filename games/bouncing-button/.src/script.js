(function(){function f(r,s){this.canvas=document.createElement("canvas");this.ctx=this.canvas.getContext("2d");this.w=r;this.h=s;this.x=0;this.y=0;this.touch=false;this.top=0;this.left=0;this.scale=1;this.ratio=1}f.prototype.on=function(r){};f.prototype.bind=function(){var r=this;this.canvas.addEventListener("touchstart",function(s){s.preventDefault();r.x=(s.touches[0].pageX-r.left)/r.scale;r.y=(s.touches[0].pageY-r.top)/r.scale;r.touch=true;r.on("start")});this.canvas.addEventListener("mousedown",function(s){s.preventDefault();r.x=(s.clientX-r.left)/r.scale;r.y=(s.clientY-r.top)/r.scale;r.touch=true;r.on("start")});this.canvas.addEventListener("touchmove",function(s){s.preventDefault();r.x=(s.touches[0].pageX-r.left)/r.scale;r.y=(s.touches[0].pageY-r.top)/r.scale;r.on("move")});this.canvas.addEventListener("mousemove",function(s){s.preventDefault();r.x=(s.clientX-r.left)/r.scale;r.y=(s.clientY-r.top)/r.scale;r.on("move")});this.canvas.addEventListener("touchend",function(s){s.preventDefault();r.on("end");r.touch=false});this.canvas.addEventListener("mouseup",function(s){s.preventDefault();r.on("end");r.touch=false});return this};f.prototype.resize=function(){var t=document.body.clientWidth,r=document.body.clientHeight,s=window.devicePixelRatio||1,u=t/this.w>r/this.h?r/this.h:t/this.w;this.left=Math.round((t-this.w*u)/2);this.top=Math.round((r-this.h*u)/2);if(t/r>this.w/this.h){this.canvas.style.left=this.left+"px";this.canvas.style.top="0px"}else{this.canvas.style.top=this.top+"px";this.canvas.style.left="0px"}this.canvas.width=Math.round(this.w*u*s);this.canvas.height=Math.round(this.h*u*s);this.canvas.style.width=Math.round(this.w*u)+"px";this.canvas.style.height=Math.round(this.h*u)+"px";this.ctx.scale(u*s,u*s);this.scale=u;this.ratio=s;return this};function n(s,t,r,u){this.set(s,t,r,u)}n.prototype.set=function(s,t,r,u){this.w=s||0;this.h=t||0;this.x=r||0;this.y=u||0};n.prototype.ox=function(r){if(r){this.x=r-(this.w/2)}else{r=this.x+(this.w/2)}return r};n.prototype.oy=function(r){if(r){this.y=r-(this.h/2)}else{r=this.y+(this.h/2)}return r};n.prototype.clear=function(r){r.clearRect(this.x,this.y,this.w,this.h)};n.prototype.paint=function(r){};n.prototype.run=function(){};function o(){var r=this;this.storage=new l(a.maps.length);this.game=this.storage.getLevel();this.sound=new m(function(){switch(this.index){case -1:case 3:r.scene.on("load");break;case 4:r.scene.on("music");break}});this.sound.disabled=!this.storage.getSound();this.drawer=new k();this.sprite=new e();this.init();document.body.appendChild(this.drawer.canvas);document.body.appendChild(this.canvas);this.bind()}o.prototype=new f(480,320);o.prototype.init=function(){this.resize();this.drawer.resize();this.sprite.render(this.ctx,this.scale*this.ratio);this.scene=new h(this)};o.prototype.on=function(r){this.scene.on(r,this.x,this.y,this.touch)};o.prototype.paint=function(){this.scene.paint(this.ctx);this.scene.run()};o.prototype.start=function(r){if(r){this.game+=r}delete this.scene;this.scene=new a(this,this.game)};o.prototype.run=function(){var r=this;r.paint();requestAnimFrame(function(){r.run()})};window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(r){window.setTimeout(r,1000/60)};window.onload=function(){var r=new o(),s=null;window.setTimeout(function(){r.run()},500);window.onresize=function(){if(s){window.clearTimeout(s)}s=window.setTimeout(function(){r.init()},500)}};function g(s,r,t){this.sprite=s;this.x=r||0;this.y=t||0;this.r=20;this.a=0;this.l=0.3;this.s=0.985;this.t=null;this.v=null;this.o={x:this.x,y:this.y}}g.prototype=new n(40,40);g.prototype.paint=function(r){this.sprite.paint(r,this.x,this.y,this.w,this.h,Math.round(this.a)*40,this.t?40:0);if(this.t){r.save();r.strokeStyle="#ddd";r.lineCap="round";r.lineWidth=3;r.beginPath();r.moveTo(this.ox(),this.oy());r.lineTo(this.t.x,this.t.y);r.stroke();r.restore()}};g.prototype.run=function(){if(this.v){this.x+=this.v.x;this.y+=this.v.y;this.v.x*=this.s;this.v.y*=this.s;this.v.d*=this.s;var r=this.v.d*this.l;this.a+=r>2?2:r;if(this.a<0){this.a=11}if(this.a>11){this.a=0}if(this.v.d<0.05){this.v=null}return true}return false};g.prototype.stop=function(){if(this.v){this.v={x:0,y:0,d:0}}};g.prototype.check=function(s,A,w){var v=this.ox()-s,u=this.oy()-A,z=Math.sqrt((v*v)+(u*u)),r=z<=this.r;if(r&&w){this.ox(v/z*this.r+s);this.oy(u/z*this.r+A);if(this.v){var t=this.v.d/z;this.v.x=v*t;this.v.y=u*t}}return r};g.prototype.bounce=function(s,r){if(this.v){this.v.x*=s;this.v.y*=r;this.l=-this.l}};g.prototype.hold=function(r,s){this.t={x:r,y:s};this.v=null};g.prototype.shot=function(r,w){var u=r-this.ox(),t=w-this.oy(),v=Math.sqrt((u*u)+(t*t)),s=v/20*(250/v);this.v={x:u/s,y:t/s,d:v/s};this.t=null;this.l=-this.l};g.prototype.reset=function(r,s){this.x=this.o.x;this.y=this.o.y;this.a=0;this.v=null;this.t=null};function p(t,r,A,s,u,z,v){this.sprite=t;this.set(s,u,r,A);this.sx=z;this.sy=v;this.active=false;this.disabled=false}p.prototype=new n();p.prototype.paint=function(r){var s=this.sy;if(!this.disabled){s+=this.h;if(this.active){s+=this.h}}this.sprite.paint(r,this.x,this.y,this.w,this.h,this.sx,s)};p.prototype.check=function(r,s){this.active=this.x<=r&&this.x+this.w>=r&&this.y<=s&&this.y+this.h>=s;return this.active};function b(s,r,t){this.sprite=s;this.x=r||0;this.y=t||0;this.r=5;this.a=Math.round(Math.random()*23);this.has=false;this.hide=false}b.prototype=new n(20,20);b.prototype.paint=function(r){if(!this.hide){this.sprite.paint(r,this.x,this.y,this.w,this.h,this.a*this.w,80)}};b.prototype.run=function(){if(this.has&&!this.hide){this.hide=this.x<1&&this.y<1;this.a=this.a<23?this.a+1:0;this.x-=this.x/10;this.y-=this.y/10;return true}return false};b.prototype.check=function(t){if(this.has){return true}var s=this.ox()-t.ox(),r=this.oy()-t.oy(),u=Math.sqrt((s*s)+(r*r));this.has=u<this.r+t.r;return this.has};function k(){}k.prototype=new f(480,320);k.prototype.rand=function(r){return Math.round(Math.random()*r)-(r/2)};k.prototype.info=function(){var r=this.ctx,u="BOUNCING BUTTON",t=["Shoot the red button 3 times","Collect all golden buttons","Avoid holes","Bounce off walls"];r.save();r.font="bold 36px Arial";r.textAlign="center";r.textBaseline="middle";r.lineWidth=4;r.strokeStyle="#852";r.fillStyle="#f90";r.strokeText(u,240,55);r.fillText(u,240,55);r.font="bold 16px Arial";r.fillStyle="#420";r.textAlign="left";for(var s=0;s<t.length;s++){r.fillText(t[s],190,110+s*35)}this.hole(140,180,18,2);this.wood(115,205,50,20,2,2);r.restore()};k.prototype.hole=function(s,w,u,v){var t=this.ctx;t.save();t.translate(s,w);if(v){t.save();t.scale(1.1,1);t.beginPath();t.arc(v,0,u+v,0,2*Math.PI,false);t.fillStyle="#852";t.fill();t.restore()}t.beginPath();t.arc(0,0,u,0,2*Math.PI,false);t.fillStyle="#000";t.fill();t.restore()};k.prototype.wood=function(A,z,B,v,s,C){var D=this.ctx,t=C?"#852":"#b85";D.save();D.beginPath();D.rect(A,z,B,v);D.fillStyle=C?"#963":"#c96";D.lineWidth=C||0;D.strokeStyle=t;if(C){D.save();D.shadowBlur=10*this.scale;D.shadowColor="#000";D.shadowOffsetX=5*this.scale;D.shadowOffsetY=5*this.scale;D.fill();D.restore();D.stroke()}else{D.fill()}D.restore();if(B>=v){for(var u=s;u<v-s;u+=s){D.save();D.translate(A,z+u+this.rand(s));D.beginPath();D.moveTo(0,this.rand(s));D.bezierCurveTo(B/3,this.rand(s),B/3*2,this.rand(s),B,this.rand(s));D.lineTo(B,this.rand(s));D.bezierCurveTo(B/3*2,this.rand(s),B/3,this.rand(s),0,this.rand(s));D.fillStyle=t;D.fill();D.restore()}}else{for(var u=s;u<B-s;u+=s){D.save();D.translate(A+u+this.rand(s),z);D.beginPath();D.moveTo(this.rand(s),0);D.bezierCurveTo(this.rand(s),v/3,this.rand(s),v/3*2,this.rand(s),v);D.lineTo(this.rand(s),v);D.bezierCurveTo(this.rand(s),v/3*2,this.rand(s),v/3,this.rand(s),0);D.fillStyle=t;D.fill();D.restore()}}};function a(v,w){var r=this,s=v.sprite,t=v.drawer,u=a.maps[w];this.app=v;this.level=w;this.sound=0;this.border=20;this.score=new c(s);this.overlay=new j(s,this.score,w);this.overlay.back.disabled=w<=0;this.overlay.next.disabled=w>=a.maps.length-1;this.ball=new g(s,u.b[0],u.b[1]);this.coins=[];this.walls=[];this.holes=[];t.wood(0,0,this.w,this.h,10);t.wood(0,0,this.w,this.border,2,2);t.wood(0,this.border,this.border,this.h,2,2);u.w.forEach(function(y){var x=new q(y[0],y[1],y[2],y[3]);t.wood(x.x,x.y,x.w,x.h,2,2);r.walls.push(x)});t.wood(this.w-this.border,this.border,this.border,this.h,2,2);t.wood(0,this.h-this.border,this.w,this.border,2,2);s.paint(t.ctx,2,2,16,16,0,116);u.h.forEach(function(x){var y=new d(x[0],x[1]);t.hole(y.ox(),y.oy(),y.r,2);r.holes.push(y)});u.c.forEach(function(x){r.coins.push(new b(s,x[0],x[1]))});this.goal=this.coins.length;this.repaint=true}a.prototype=new n(480,320);a.prototype.paint=function(r){if(this.repaint){this.clear(r);this.score.paint(r);this.coins.forEach(function(s){s.paint(r)});this.ball.paint(r);if(this.end()){this.overlay.paint(r)}this.repaint=false}};a.prototype.end=function(){return !this.ball.v&&(!this.score.shot||!this.goal)};a.prototype.run=function(){var r=0;app=this.app,ball=this.ball,score=this.score,coins=this.coins,repaint=this.score.run(),sound=false;i=0;this.coins.forEach(function(s){if(s.run()){repaint=true}});if(ball.run()){if(this.check(ball)){score.on("wall");sound=0}this.walls.forEach(function(s){if(s.check(ball)){score.on("wall");sound=0}});this.holes.forEach(function(s){if(s.check(ball)){ball.reset();score.on("reset")}});this.coins.forEach(function(s){if(!s.has){if(s.check(ball)){sound=2;score.on("coin")}r++}});this.goal=r;if(this.end()){score.on("end");app.storage.setScore(this.level,score,!r);this.overlay.next.disabled=!score.next}if(sound!==false){app.sound.play(sound+this.sound);this.sound=++this.sound%2}repaint=true}this.repaint=repaint};a.prototype.check=function(r){if(r.x<this.border){r.x=this.border;r.bounce(-1,1);return true}else{if(r.x+r.w>this.w-this.border){r.x=this.w-this.border-r.w;r.bounce(-1,1);return true}}if(r.y<this.border){r.y=this.border;r.bounce(1,-1);return true}else{if(r.y+r.h>this.h-this.border){r.y=this.h-this.border-r.h;r.bounce(1,-1);return true}}return false};a.prototype.on=function(s,r,u,t){if(this.end()){this.repaint=this.overlay.check(r,u)||this.repaint;if(s=="end"){if(this.overlay.start.active){this.app.start()}else{if(this.overlay.next.active&&!this.overlay.next.disabled){this.app.start(1)}else{if(this.overlay.back.active&&!this.overlay.back.disabled){this.app.start(-1)}}}}}else{if(this.score.shot&&this.goal){switch(s){case"start":case"move":if(t){this.ball.hold(r,u)}break;case"end":this.ball.shot(r,u);this.score.on("shot");break}this.repaint=true}else{if(s=="end"){ball.stop()}}}};a.maps=[{b:[220,140],c:[[50,50],[410,50],[140,100],[320,100],[140,200],[320,200],[50,250],[410,250]],w:[],h:[]},{b:[220,140],c:[[230,50],[140,100],[320,100],[50,150],[410,150],[140,200],[320,200],[230,250]],w:[],h:[]},{b:[220,140],c:[[50,50],[230,50],[410,50],[50,150],[410,150],[50,250],[230,250],[410,250]],w:[],h:[]},{b:[130,140],c:[[230,50],[140,100],[320,100],[50,150],[410,150],[140,200],[320,200],[230,250]],w:[],h:[[305,135]]},{b:[130,140],c:[[140,50],[230,50],[320,50],[50,100],[410,100],[50,150],[410,150],[50,200],[410,200],[140,250],[230,250],[320,250]],w:[[20,120,275,100]],h:[]},{b:[220,140],c:[[50,50],[230,50],[410,50],[50,100],[230,100],[410,100],[50,150],[410,150],[50,200],[230,200],[410,200],[50,250],[230,250],[410,250]],w:[[20,200,95,20],[20,200,365,100]],h:[]},{b:[40,40],c:[[230,50],[140,100],[320,100],[50,150],[410,150],[140,200],[320,200],[230,250]],w:[[40,20,190,150],[20,100,230,110],[40,20,250,150]],h:[]},{b:[220,140],c:[[50,50],[140,50],[230,50],[320,50],[410,50],[50,150],[140,150],[320,150],[410,150],[50,250],[140,250],[230,250],[320,250],[410,250]],w:[[175,20,20,100],[175,20,285,200]],h:[]},{b:[40,140],c:[[50,50],[140,50],[230,50],[320,50],[410,50],[50,100],[140,100],[230,100],[320,100],[410,100],[50,200],[140,200],[230,200],[320,200],[410,200],[50,250],[140,250],[230,250],[320,250],[410,250]],w:[[280,20,100,150]],h:[]},{b:[220,140],c:[[230,50],[230,100],[50,150],[140,150],[320,150],[410,150],[230,200],[230,250],],w:[[20,80,185,20],[20,80,275,20],[20,80,185,220],[20,80,275,220]],h:[]},{b:[220,140],c:[[140,50],[230,50],[320,50],[140,100],[320,100],[140,150],[320,150],[140,200],[320,200],[140,250],[230,250],[320,250]],w:[[40,40,85,140],[40,40,355,140]],h:[]},{b:[220,140],c:[[140,50],[230,50],[320,50],[50,100],[410,100],[50,150],[410,150],[50,200],[410,200],[140,250],[230,250],[320,250]],w:[[20,20,50,50],[20,20,410,50],[20,20,50,250],[20,20,410,250]],h:[]},{b:[220,140],c:[[50,50],[140,50],[320,50],[410,50],[50,100],[140,100],[320,100],[410,100],[50,200],[140,200],[320,200],[410,200],[50,250],[140,250],[320,250],[410,250]],w:[],h:[[35,135],[395,135]]},{b:[220,140],c:[[50,50],[140,50],[230,50],[320,50],[410,50],[50,100],[140,100],[230,100],[320,100],[410,100],[50,150],[140,150],[320,150],[410,150],[50,200],[140,200],[230,200],[320,200],[410,200],[50,250],[140,250],[230,250],[320,250],[410,250]],w:[],h:[]},{b:[310,190],c:[[50,50],[230,50],[320,50],[410,50],[50,100],[410,100],[230,150],[50,200],[230,250],[320,250],[410,250]],w:[[160,20,20,150]],h:[]},{b:[220,40],c:[[50,50],[410,50],[50,100],[230,100],[410,100],[50,150],[230,150],[410,150],[50,200],[230,200],[410,200],[50,250],[410,250]],w:[[20,100,185,110],[20,100,275,110]],h:[]},{b:[40,40],c:[[140,50],[230,50],[320,50],[140,150],[230,150],[320,150],[140,250],[230,250],[320,250]],w:[[200,20,20,200]],h:[[395,35]]},{b:[220,140],c:[[50,50],[140,50],[230,50],[320,50],[410,50],[50,250],[140,250],[230,250],[320,250],[410,250]],w:[[140,20,20,150],[140,20,320,150]],h:[]},{b:[220,140],c:[[50,50],[140,50],[410,50],[410,100],[50,200],[50,250],[320,250],[410,250]],w:[[20,80,95,220],[20,80,365,20],[80,20,20,100],[80,20,380,200]],h:[]},{b:[40,40],c:[[230,50],[320,50],[410,50],[140,150],[230,150],[320,150],[50,250],[140,250],[230,250]],w:[[20,100,95,100],[100,20,115,100],[100,20,265,200],[20,100,365,120]],h:[]}];function d(s,u,t){this.x=s||0;this.y=u||0;this.r=t||25;this.w=this.r*2;this.h=this.r*2}d.prototype=new n();d.prototype.check=function(t){var s=this.ox()-t.ox(),r=this.oy()-t.oy(),u=Math.sqrt((s*s)+(r*r));return u<this.r};function h(t){var r=t.sprite,s=t.drawer;this.app=t;this.ball=new g(r,120,90);this.coin=new b(r,130,135);this.sound=new p(r,140,245,100,32,360,100);this.sound.disabled=t.sound.disabled;this.start=new p(r,240,245,100,32,160,100);this.border=20;this.repaint=true;s.wood(0,0,this.w,this.h,10);s.wood(0,0,this.w,this.border,2,2);s.wood(0,this.border,this.border,this.h,2,2);s.wood(this.w-this.border,this.border,this.border,this.h,2,2);s.wood(0,this.h-this.border,this.w,this.border,2,2);s.info()}h.prototype=new n(480,320);h.prototype.paint=function(r){if(this.repaint){this.clear(r);this.coin.paint(r);this.ball.paint(r);this.start.paint(r);this.sound.paint(r)}};h.prototype.check=function(r,s){return this.sound.active^this.sound.check(r,s)|this.start.active^this.start.check(r,s)>0};h.prototype.on=function(s,r,u,t){this.repaint=this.check(r,u)||this.repaint;switch(s){case"end":if(this.start.active){this.app.sound.stop(4);this.app.start()}else{if(this.sound.active){this.sound.disabled=this.app.sound.disable();this.app.storage.setSound(!this.sound.disabled);if(!this.sound.disabled){this.app.sound.play(4,0.5,true)}}}break;case"load":this.repaint=true;break;case"music":this.app.sound.play(4,0.5,true);break}};function j(r,s,t){this.sprite=r;this.score=s;this.level=t;this.levels=a.maps.length;this.back=new p(r,90,220,100,32,60,100);this.start=new p(r,190,220,100,32,160,100);this.next=new p(r,290,220,100,32,260,100)}j.prototype=new n(480,320);j.prototype.paint=function(r){var t=this.score.high?"New Highscore!":"Highscore: "+this.score.highscore,w="Level: "+(this.level+1)+"/"+this.levels,v=this.score.balls,u=this.score.score,s=this.sprite;r.save();r.fillStyle="rgba(0, 0, 0, .6)";r.fillRect(this.x,this.y,this.w,this.h);r.textAlign="center";r.textBaseline="middle";r.lineWidth=4;r.fillStyle="#f90";r.strokeStyle="#420";r.font="bold 24px Arial";r.strokeText(t,240,70);r.fillText(t,240,70);r.font="bold 16px Arial";r.strokeText(w,240,100);r.fillText(w,240,100);r.lineWidth=6;r.font="bold 48px Arial";r.strokeText(u,240,150);r.fillText(u,240,150);r.restore();this.back.paint(r);this.start.paint(r);this.next.paint(r);if(v){s.paint(r,216,180,48,16,0,116)}};j.prototype.check=function(r,s){return this.back.active^this.back.check(r,s)|this.start.active^this.start.check(r,s)|this.next.active^this.next.check(r,s)>0};function c(r){this.sprite=r;this.score=0;this.buffer=0;this.shot=3;this.high=false;this.balls=0;this.highscore=0;this.next=false;this.end=false}c.prototype.on=function(r){switch(r){case"shot":this.shot--;break;case"wall":this.score+=111;break;case"coin":this.score+=3250;break;case"end":this.score+=12500*this.shot;this.end=true;break}};c.prototype.run=function(){var r=this.buffer<this.score,s=this.buffer+43;if(r){this.buffer=s<this.score?s:this.score}return r};c.prototype.paint=function(r){var t=this.end?this.score:this.buffer,s=this.shot*20;if(s){this.sprite.paint(r,480-s,2,s,16,0,100)}r.save();r.font="bold 16px Arial";r.lineWidth=2;r.strokeStyle="#852";r.strokeText(t,25,16);r.fillStyle="#f90";r.fillText(t,25,16);r.restore()};function m(t){var r=this;this.index=-1;this.disabled=true;this.sounds=m.notes;try{this.callback=t;this.service=new Worker("worker.js");this.service.addEventListener("message",function(u){r.finish(u.data)});this.create()}catch(s){t.call(this)}}m.prototype.disable=function(){this.disabled=!this.disabled;if(this.disabled){for(var r=0;r<this.sounds.length;r++){this.stop(r)}}return this.disabled};m.prototype.create=function(){if(++this.index<this.sounds.length){this.service.postMessage(this.sounds[this.index])}else{this.service.terminate()}};m.prototype.finish=function(r){var s=new Audio();s.preload=true;s.src=r;s.load();this.sounds[this.index]=s;this.callback.call(this);this.create()};m.prototype.play=function(s,t,r){var u=this.sounds[s];if(!this.disabled&&typeof u=="object"){u.volume=t||1;u.loop=r||false;if(u.currentTime){u.pause();u.currentTime=0}u.play()}};m.prototype.stop=function(r){var s=this.sounds[r];if(typeof s=="object"){s.pause()}};m.notes=["||||16e3","||||16e3","||||32e5,32b5","||||32e5,32b5","1,4,1,4,1,4,2,4,8b4,8e5,8g5,8a5,8bb5,8b5,8bb5,8a5,4e5,4b4,4d5,2e5,4,16gb5,16g5,16gb5,16e5,4d5,2e5,4,16d5,16e5,16d5,16b4,4a4,2b4,4,8b4,8e5,8g5,8a5,8bb5,8b5,8bb5,8a5,4e5,4b4,4d5,2e5,4,16d5,16e5,16d5,16b4,4a4,2b4,4,16gb5,16g5,16gb5,16e5,4d5,1e5,4,8e6,4g6,8e6,4c6,8a5,8b5,8c6,8db6,8d6,4gb6,8d6,4b5,8g5,8a5,8bb5,8b5,8c6,4e6,8c6,4a5,8gb5,8g5,8a5,8bb5,8b5,8bb5,8b5,8c6,4d6,8d6,8db6,8d6,8eb6,8e6,4g6,8e6,4c6,8a5,8b5,8c6,8db6,8d6,4gb6,8d6,4b5,8g5,8a5,8bb5,8b5,8c6,4e6,8c6,4a5,8gb5,8a5,8d6,8c6,2b5,4,8b4,8e5,8g5,8a5,8bb5,8b5,8bb5,8a5,4e5,4b4,4d5,2e5,4,16gb5,16g5,16gb5,16e5,4d5,2e5,4,16d5,16e5,16d5,16b4,4a4,2b4,4,8b4,8e5,8g5,8a5,8bb5,8b5,8bb5,8a5,4e5,4b4,4d5,2e5,4,16d5,16e5,16d5,16b4,4a4,2b4,4,16gb5,16g5,16gb5,16e5,4d5,1e5,4|8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8c3,4g3b3e4,8e3,4e3,4gb3,4g3b3e4,8b2,4ab3a3d4,8d3,4d3,4e3,4gb3a3d4,8a2,4e3g3c4,8c3,4c3,4d3,4e3g3c4,8g2,4gb3b3d4,8g2,4g2,4b2,4gb3a3d4,8c3,4g3c4e4,8e3,4e3,4gb3,4g3c4e4,8b2,4ab3a3d4,8d3,4d3,4e3,4gb3a3d4,8a2,4e3g3c4,8c3,4c3,4d3,4e3g3c4,8gb2,4gb3a3e4,8gb2,4gb3a3e4,4b2,4gb3a3db4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4,8e2,4g3b3e4,8e2,4g3b3e4,4b3,4ab3a3d4|2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,4c2,1,4b1,1,4a1,1,4b1,2,4g1,4b1,4c2,1,4b1,1,4a1,1,4gb1,2,4b1,4,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1,2e2,4e2,4b2,4b1|4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4,4e6,8,8b8,4,8b8,8,4"];function e(){this.scale=1;this.image=new Image()}e.prototype.paint=function(C,z,t,A,s,v,u){var B=Math.round(A*this.scale),r=Math.round(s*this.scale);v=Math.round(v*this.scale);u=Math.round(u*this.scale);C.drawImage(this.image,v,u,B,r,z,t,A,s)};e.prototype.renderCircle=function(t,s,B,v,z,w,u,A){t.save();t.beginPath();t.arc(s,B,v,0,2*Math.PI,false);if(A){A*=this.scale;t.shadowBlur=A;t.shadowColor="rgba(0,0,0,.5)";t.shadowOffsetX=A;t.shadowOffsetY=A}if(z){t.fillStyle=z;t.fill()}if(w){t.lineWidth=u||1;t.strokeStyle=w;t.stroke()}t.restore()};e.prototype.renderBall=function(t,r,B,A,u,z){var w=t.createRadialGradient(-10,-10,80,-10,-10,0),v=z||1;w.addColorStop(0,"#c00");w.addColorStop(1,"#900");t.save();t.translate(r,B);t.scale(v,v);this.renderCircle(t,0,0,17.5,w,"#600",3,0.5);t.rotate(Math.PI/180*A);this.renderCircle(t,-5,-5,3,"#200","#600");this.renderCircle(t,-5,5,3,"#200","#600");this.renderCircle(t,5,-5,3,"#200","#600");this.renderCircle(t,5,5,3,"#200","#600");if(u){t.lineWidth=2.5;t.lineCap="round";t.strokeStyle="#ddd";t.beginPath();t.moveTo(-5,-5);t.lineTo(5,5);t.stroke();t.beginPath();t.moveTo(-5,5);t.lineTo(5,-5);t.stroke()}t.restore()};e.prototype.renderCoin=function(t,r,A,z,w){var v=t.createRadialGradient(-5,-5,40,-5,-5,0),u=w||1;v.addColorStop(0,"#fc0");v.addColorStop(1,"#f60");t.save();t.translate(r,A);t.scale(u,u);this.renderCircle(t,0,0,8,v,"#c60",2,0.5);t.rotate(Math.PI/180*z);this.renderCircle(t,-3,0,2,"#420","#c60");this.renderCircle(t,3,0,2,"#420","#c60");t.restore()};e.prototype.renderButton=function(D,A,z,B,u,s,C,t){var v=D.createLinearGradient(0,0,0,u);v.addColorStop(0,"#fec");v.addColorStop(1,"#cb9");D.save();D.translate(A,z);D.beginPath();D.moveTo(0,s);D.arcTo(0,0,s,0,s);D.lineTo(B-s,0);D.arcTo(B,0,B,s,s);D.lineTo(B,u-s);D.arcTo(B,u,B-u,u,s);D.lineTo(s,u);D.arcTo(0,u,0,u-s,s);D.closePath();D.fillStyle=v;D.fill();D.strokeStyle=t>1?"#fff":"#cb9";D.lineWidth=2;D.stroke();D.font="bold 20px Arial";D.textAlign="center";D.fillStyle="#ccc";D.fillText(C,B/2,22);D.fillStyle=t>0?"#320":"#986";D.fillText(C,B/2,21);D.restore()};e.prototype.render=function(s,u){this.scale=u;s.save();var t;for(t=0;t<24;t++){var r=t*7.5;if(t<12){this.renderBall(s,t*40+20,20,r,false);this.renderBall(s,t*40+20,60,r,true)}if(t<3){this.renderBall(s,t*20+10,108,0,false,0.35);this.renderCoin(s,t*16+8,124,0,0.8)}this.renderCoin(s,t*20+10,90,r)}for(t=0;t<3;t++){this.renderButton(s,67,t*32+102,86,28,13,"BACK",t);this.renderButton(s,167,t*32+102,86,28,13,"START",t);this.renderButton(s,267,t*32+102,86,28,13,"NEXT",t);this.renderButton(s,367,t*32+102,86,28,13,"SOUND",t)}this.image.src=s.canvas.toDataURL("image/png");s.restore();s.clearRect(0,0,480,320);return this};function l(r){this.levels=r;this.data={level:0,balls:[],score:[],sound:!window.orientation};if(localStorage.data){this.data=JSON.parse(localStorage.data)}}l.prototype.save=function(){localStorage.data=JSON.stringify(this.data)};l.prototype.setScore=function(t,s,r){if(t<=this.data.level){s.highscore=this.data.score[t]||0;s.high=s.score>s.highscore;if(s.high){this.data.score[t]=s.score;this.data.balls[t]=s.shot}if(r&&t<this.levels-1&&t==this.data.level){this.data.level++}this.save();s.balls=this.data.balls[t]||0;s.next=t<this.data.level}};l.prototype.setSound=function(r){this.data.sound=r;this.save()};l.prototype.getSound=function(){return this.data.sound};l.prototype.getLevel=function(){return this.data.level};function q(s,t,r,u){this.set(s,t,r,u)}q.prototype=new n();q.prototype.check=function(A){var z=A.r,s=A.ox(),B=A.oy(),u=this.x,w=this.y,t=u+this.w,v=w+this.h;if(s>=u&&s<=t){if(B<w&&w-B<z){A.oy(w-z);A.bounce(1,-1);return true}if(B>v&&B-v<z){A.oy(v+z);A.bounce(1,-1);return true}}if(B>=w&&B<=v){if(s<u&&u-s<z){A.ox(u-z);A.bounce(-1,1);return true}if(s>t&&s-t<z){A.ox(t+z);A.bounce(-1,1);return true}}if(s<u&&B<w){return A.check(u,w,true)}if(s<u&&B>v){return A.check(u,v,true)}if(s>t&&B<w){return A.check(t,w,true)}if(s>t&&B>v){return A.check(t,v,true)}return false}})();