var aa="#16a085 #27ae60 #2980b9 #8e44ad #f39c12 #d35400 #c0392b #bdc3c7".split(" "),ba="#1abc9c #2ecc71 #3498db #9b59b6 #f1c40f #e67e22 #e74c3c #ecf0f1".split(" ");function l(){void 0===m(n)&&q(n,!0);void 0===m(t)&&q(t,!0);this.B=new ca("base");this.H=new ca("glitch");this.A=void 0;this.C=0;this.J=this.I.bind(this);var a=u;a.C=this.B;a.A[da]=v;a.A[ea]=fa;a.A[ga]=ha;u.start(ea)}l.prototype.start=function(){this.I();this.G()};
l.prototype.G=function(){ia(this.B,this.H);setTimeout(function(){this.H.F.clearRect(0,0,240,400);setTimeout(this.G.bind(this),4E3*Math.random()+2E3)}.bind(this),150*Math.random()+50)};l.prototype.I=function(){if(this.A){var a=(new Date).getTime();this.C=(a-this.A)/1E3;this.A=a}else this.A=(new Date).getTime();u.B.M(this.C);window.requestAnimationFrame?window.requestAnimationFrame(this.J):window.setTimeout(this.J,16.7)};
function ca(a){this.A=document.getElementById(a);this.F=this.A.getContext("2d");this.F.X=!1}function w(a,b){a.F.font=b||"20px MyPixel"}ca.prototype.D=function(a,b,c){this.F.fillText(a,b,c)};function x(a,b){a.F.fillStyle=b||"#000000"}function ja(a){this.G=a;this.A=this.B=300;this.C=!1}function ka(a,b){this.position=a;this.S=b;this.R=0}function la(){this.A=[]}function D(a,b,c){b=new ka(b,c);a.A.push(b);c=0;for(var d=1;d<a.A.length;d++)c+=a.A[d-1].S*(a.A[d].position-a.A[d-1].position);b.R=c}
function ma(a,b){for(var c=a.A.length-1;0<=c;c--){var d=a.A[c];if(d.position<b)return d.R+(b-d.position)*d.S}}function ta(){this.data=[];for(var a=0;32>a;a++){this.data[a]=[];for(var b=0;22>b;b++)this.data[a][b]=0}this.A=void 0;b=Math.ceil(4.8);for(a=32-b;32>a;a++)ua(this,a,.5);for(a=32-b-2;a<32-b;a++)ua(this,a,1)}function ua(a,b,c){c=c||.5;var d;for(d=0;22>d;d++)a.data[b][d]=1;for(d=0;d<22*c;d++)a.data[b][~~(22*Math.random())]=0}
function va(a){for(var b=31,c=0;32>c;c++)if(!a.data[c].every(function(a){return 0===a})){b=c;break}return b}function wa(a){var b=va(a),c=[],d,e;a.data[b].forEach(function(a,b){1===a&&c.push(b)});var f=c[Math.floor(Math.random()*c.length)],f=ya(Math.max(0,f-2),f),k=[];for(d=0;3>d;d++)for(k[d]=[],e=0;3>e;e++)22<=f+e?k[d][e]=0:(k[d][e]=a.data[b+d][f+e],a.data[b+d][f+e]=0);d=new H(k);za(d,f,b);return 0===d.compact().length?wa(a):d}
function H(a,b,c){this.data=a;a=Math.floor(Math.random()*aa.length);this.B=b||aa[a];this.C=c||ba[a];this.A=this.x=0}function za(a,b,c){a.x=b;a.A=c}function Aa(a,b){return a.data[b].every(function(a){return 0===a})}function Ba(a,b){return a.data.map(function(a){return a[b]}).every(function(a){return 0===a})}
H.prototype.compact=function(){var a=[],b=2,c=0,d=2,e=0,f,k;for(f=0;3>f;f++)Aa(this,f)||(b=Math.min(b,f),c=Math.max(b,f)),Ba(this,f)||(d=Math.min(d,f),e=Math.max(d,f));for(k=b;k<=c;k++)for(a[k-b]=[],f=d;f<=e;f++)a[k-b][f-d]=this.data[k][f];return a};function Ca(a,b){var c=a.compact(),d=b.compact();return c.length!==d.length||c[0].length!==d[0].length?!1:c.every(function(a,b){return a.every(function(a,c){return a===d[b][c]})})}
function Da(a,b,c,d){var e,f;for(f=0;f<a.data.length;f++)for(e=0;e<a.data[f].length;e++)if(a.data[f][e]){x(b,a.B);b.F.fillRect(c+10*(a.x+e),d+10*(a.A+f),10,10);var k=a.C,k=k||"#000000";b.F.strokeStyle=k;b.F.strokeRect(c+10*(a.x+e)+1,d+10*(a.A+f)+1,8,8)}}function Na(a){var b=Infinity;if(0>=a.A)for(var c=0;3>c;c++)if(!Aa(a,c)&&0>=a.A+c){b=a.A+c-0;break}return b}function Oa(a,b){var c=Infinity;if(a.x<=b)for(var d=0;3>d;d++)if(!Ba(a,d)&&a.x+d<=b){c=a.x+d-b;break}return c}
function Pa(a,b){var c=Infinity;if(a.x>=b-3)for(var d=b-1,e=2;0<=e;e--)if(!Ba(a,e)&&a.x+e>=d){c=d-(a.x+e);break}return c}H.prototype.clone=function(){var a=[],b,c;for(b=0;3>b;b++)for(a[b]=[],c=0;3>c;c++)a[b][c]=this.data[b][c];return new H(a,this.B,this.C)};H.prototype.rotate=function(){var a=[],b,c;for(b=0;3>b;b++)for(a[b]=[],c=0;3>c;c++)a[b][c]=this.data[2-c][b];this.data=a};function Qa(a){for(var b=0;b<~~(3*Math.random())+1;b++)a.rotate()}
function v(){this.H=void 0;this.C=0;this.B=new ta;this.O=va(this.B);this.A=new H([[Math.round(Math.random()),Math.round(Math.random()),Math.round(Math.random())],[Math.round(Math.random()),Math.round(Math.random()),Math.round(Math.random())],[Math.round(Math.random()),Math.round(Math.random()),Math.round(Math.random())]]);za(this.A,10,18);this.G=this.A.clone();Qa(this.G);this.B.A=this.A;this.J=new ja(this.V.bind(this));this.N=!1;this.K=2;this.I=new la;D(this.I,0,1);D(this.I,100,.5);D(this.I,150,.35);
D(this.I,250,.25)}v.prototype.start=function(a){this.H=a;Ra(this.G,this.C);I.onLR=function(){};I.onA=function(){m(n)&&J.W.play()}};
v.prototype.V=function(){var a;if(this.A&&(za(this.A,this.A.x,this.A.A+-1),0>=Na(this.A))){a=Ca(this.A,this.G);var b=0<=Oa(this.A,9)&&0<=Pa(this.A,13);if(a&&b){delete this.A;this.A=wa(this.B);this.B.A=this.A;b=va(this.B);if(b>this.O)for(a=0;a<b-this.O;a++)setTimeout(function(){var a=this.B;a.data.shift();a.data.push([]);ua(a,31,.5)}.bind(this),1E3*a+1E3);this.G=this.A.clone();Qa(this.G);this.C-=10;this.J.B=Math.max(55,300-ma(this.I,Math.abs(this.C)));m(n)&&J.T.play();Ra(this.G,this.C)}else this.K=
b?0:1,this.N=!0,this.J.C=!0,m(n)&&J.U.play(),Sa(this),setTimeout(function(){u.start(ga)},1500)}};function Sa(a){var b=m(Ta)||[];b.push(a.C);b.sort(function(a,b){return a-b});q(Ta,b.slice(0,6))}
v.prototype.M=function(a){this.N||(K(N)&&(O(N),this.A&&this.A.rotate()),K(T)&&(O(T),this.A&&0<Oa(this.A,0)&&--this.A.x),K(U)&&(O(U),this.A&&0<Pa(this.A,22)&&(this.A.x+=1)));var b=this.J;b.A-=1E3*a;!b.C&&0>=b.A&&(b.G(),b.A=b.B);a=this.H;b=V;Ua(a);b.D(a);b.B&&Da(b.B,a,190,27);x(a,"#e74c3c");for(b=0;11>b;b++)4<b&&7>b||a.F.fillRect(10+20*b,65,10,5);x(a,"#ecf0f1");for(b=0;11>b;b++)3<b&&6>b||a.F.fillRect(20*b+20,65,10,5);1===this.K?(a=this.H,w(a,"30px MyPixel"),x(a,"#f39c12"),a.D("GATE",80,200),a.D("MISSED",
60,230)):0===this.K&&(a=this.H,w(a,"30px MyPixel"),x(a,"#f39c12"),a.D("FIGURE",65,200),a.D("NOT",85,230),a.D("MATCHED",45,260));a=this.B;for(var b=this.H,c=0;32>c;c++)for(var d=0;22>d;d++)if(a.data[c][d]){x(b,"#2980b9");b.F.fillRect(10+10*d,70+10*c,10,10);var e="#3498db",e=e||"#000000";b.F.strokeStyle=e;b.F.strokeRect(10*d+11,10*c+71,8,8)}a.A&&Da(a.A,b,10,70)};
function ia(a,b){b.F.clearRect(0,0,240,400);for(var c=~~(10*Math.random())+1,d=0;d<c;d++){var e=240*Math.random(),f=400*Math.random(),k=240-e,E=5+400/3*Math.random();b.F.drawImage(a.A,0,f,k,E,e,f,k,E);b.F.drawImage(a.A,k,f,e,E,0,f,e,E)}}function Va(){var a=document.getElementById("info");a.classList?a.classList.add("hidden"):a.className+=" hidden"}function Wa(){(new l).start();setTimeout(Va,3E3)}"loading"!=document.readyState?Wa():document.addEventListener("DOMContentLoaded",Wa);var N=65,T=37,U=39;
function Xa(){this.B={};this.C=this.C.bind(this);document.body.addEventListener("keydown",this.C,!1);document.getElementById("vkb_act").addEventListener("touchstart",this.A.bind(this,N),!1);document.getElementById("vkb_left").addEventListener("touchstart",this.A.bind(this,T),!1);document.getElementById("vkb_right").addEventListener("touchstart",this.A.bind(this,U),!1);this.onA=function(){};this.onLR=function(){}}
Xa.prototype.A=function(a){if(a===N)this.onA();else if(40===a||38===a||a===T||a===U)this.onLR();Ya.A&&m(t)&&navigator.A(50);this.B[a]=1};function O(a){I.B[a]=0}function K(a){return 1===I.B[a]}Xa.prototype.C=function(a){this.A(a.keyCode)};var I=new Xa;function Za(){this.A=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01);a=this.b+this.c+this.e;.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}
var $a=new function(){this.A=new Za;var a,b,c,d,e,f,k,E,xa,W,y,Ea;this.B=function(){var a=this.A;d=100/(a.f*a.f+.001);e=100/(a.g*a.g+.001);f=1-a.h*a.h*a.h*.01;k=-a.i*a.i*a.i*1E-6;a.a||(y=.5-a.n/2,Ea=5E-5*-a.o);E=1+a.l*a.l*(0<a.l?-.9:10);xa=0;W=1==a.m?0:(1-a.m)*(1-a.m)*2E4+32};this.G=function(){this.B();var d=this.A;a=d.b*d.b*1E5;b=d.c*d.c*1E5;c=d.e*d.e*1E5+12;return 3*((a+b+c)/3|0)};this.C=function(fb,Fa){var g=this.A,Ga=1!=g.s||g.v,F=g.v*g.v*.1,Ha=1+3E-4*g.w,z=g.s*g.s*g.s*.1,gb=1+1E-4*g.t,hb=1!=
g.s,ib=g.x*g.x,jb=g.g,Ia=g.q||g.r,kb=g.r*g.r*g.r*.2,na=g.q*g.q*(0>g.q?-1020:1020),Ja=g.p?((1-g.p)*(1-g.p)*2E4|0)+32:0,lb=g.d,Ka=g.j/2,mb=g.k*g.k*.01,oa=g.a,pa=a,nb=1/a,ob=1/b,pb=1/c,g=5/(1+g.u*g.u*20)*(.01+z);.8<g&&(g=.8);for(var g=1-g,qa=!1,La=0,P=0,Q=0,X=0,L=0,R,M=0,p,B=0,G,ra=0,h,Ma=0,C,sa=0,Y=Array(1024),S=Array(32),r=Y.length;r--;)Y[r]=0;for(r=S.length;r--;)S[r]=2*Math.random()-1;for(r=0;r<Fa;r++){if(qa)return r;Ja&&++Ma>=Ja&&(Ma=0,this.B());W&&++xa>=W&&(W=0,d*=E);f+=k;d*=f;d>e&&(d=e,0<jb&&(qa=
!0));p=d;0<Ka&&(sa+=mb,p*=1+Math.sin(sa)*Ka);p|=0;8>p&&(p=8);oa||(y+=Ea,0>y?y=0:.5<y&&(y=.5));if(++P>pa)switch(P=0,++La){case 1:pa=b;break;case 2:pa=c}switch(La){case 0:Q=P*nb;break;case 1:Q=1+2*(1-P*ob)*lb;break;case 2:Q=1-P*pb;break;case 3:Q=0,qa=!0}Ia&&(na+=kb,G=na|0,0>G?G=-G:1023<G&&(G=1023));Ga&&Ha&&(F*=Ha,1E-5>F?F=1E-5:.1<F&&(F=.1));C=0;for(var qb=8;qb--;){B++;if(B>=p&&(B%=p,3==oa))for(R=S.length;R--;)S[R]=2*Math.random()-1;switch(oa){case 0:h=B/p<y?.5:-.5;break;case 1:h=1-B/p*2;break;case 2:h=
B/p;h=6.28318531*(.5<h?h-1:h);h=1.27323954*h+.405284735*h*h*(0>h?1:-1);h=.225*((0>h?-1:1)*h*h-h)+h;break;case 3:h=S[Math.abs(32*B/p|0)]}Ga&&(R=M,z*=gb,0>z?z=0:.1<z&&(z=.1),hb?(L+=(h-M)*z,L*=g):(M=h,L=0),M+=L,X+=M-R,h=X*=1-F);Ia&&(Y[ra%1024]=h,h+=Y[(ra-G+1024)%1024],ra++);C+=h}C=.125*C*Q*ib;fb[r]=1<=C?32767:-1>=C?-32768:32767*C|0}return Fa}};
window.A=function(a){$a.A.A(a);var b=$a.G();a=new Uint8Array(4*((b+1)/2|0)+44);var b=2*$a.C(new Uint16Array(a.buffer,44),b),c=new Uint32Array(a.buffer,0,44);c[0]=1179011410;c[1]=b+36;c[2]=1163280727;c[3]=544501094;c[4]=16;c[5]=65537;c[6]=44100;c[7]=88200;c[8]=1048578;c[9]=1635017060;c[10]=b;for(var b=b+44,c=0,d="data:audio/wav;base64,";c<b;c+=3)var e=a[c]<<16|a[c+1]<<8|a[c+2],d=d+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>
12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e&63]);return d};var n=1,Ta=2,t=3;function m(a){if(window.localStorage)return a=window.localStorage.getItem(a)||"{}",(JSON.parse(a)||{}).data}function q(a,b){window.localStorage&&window.localStorage.setItem(a,JSON.stringify({data:b}))}function fa(){this.B=void 0;this.A=Z}
fa.prototype.start=function(a){this.B=a;Ra(void 0,0);I.onLR=function(){m(n)&&J.P.play()};I.onA=function(){m(n)&&J.L.play()}};
fa.prototype.M=function(){if(K(T)||K(38))--this.A,this.A=(4+this.A)%4,O(T),O(38);else if(K(U)||K(40))this.A+=1,this.A=(4+this.A)%4,O(U),O(40);else if(K(N))switch(O(N),this.A){case Z:u.start(da);break;case ab:u.start(ga);break;case bb:q(n,!m(n));break;case cb:q(t,!m(t))}V.A=this.A;var a=this.B,b=V;Ua(a);b.D(a);x(a,"#f39c12");w(a,"55px MyPixel");a.D("GLITCH",20,120);a.D("TRIS",55,170);w(a,"30px MyPixel");x(a,b.A===Z?"#f1c40f":"#7f8c8d");a.D("START",70,230);x(a,b.A===ab?"#f1c40f":"#7f8c8d");a.D("TOP SCORES",
20,270);var c=m(n),d=m(t);x(a,b.A===bb?"#f1c40f":"#7f8c8d");a.D("SOUND "+(c?"(Y)":"(N)"),30,310);x(a,b.A===cb?"#f1c40f":"#7f8c8d");a.D("VIBRATE "+(d?"(Y)":"(N)"),18,350)};function ha(){this.A=void 0}ha.prototype.start=function(a){this.A=a;I.onLR=function(){m(n)&&J.P.play()};I.onA=function(){m(n)&&J.L.play()}};
ha.prototype.M=function(){K(N)&&(m(n)&&J.L.play(),O(N),u.start(ea));var a=this.A,b=V;Ua(a);b.D(a);w(a,"30px MyPixel");x(a,"#f39c12");a.D("TOP SCORES",20,100);w(a,"20px MyPixel");for(var b=m(Ta)||[],c=0;c<b.length;c++)a.D(b[c],30,140+20*c);x(a,"#f1c40f");a.D("BACK",90,280)};
var J={W:[0,,.1475,,.034,.262,,,,,,,,.1777,,,,,1,,,.1,,.3],P:[0,,.0807,.4028,.101,.5044,,,,,,.4262,.5024,,,,,,1,,,,,.3],L:[0,,.0494,.333,.3135,.4888,,,,,,.369,.6492,,,,,,1,,,,,.3],U:[3,,.3181,.2641,.4798,.0678,,.2725,,,,.0944,.8366,,,,.282,-.0434,1,,,,,.27],T:[0,,.0336,.4918,.265,.5115,,,,,,.4608,.5574,,,,,,1,,,,,.4]};Object.keys(J).forEach(function(a){var b=new Audio;b.src=window.A(J[a]);J[a]=b});var ea=1,da=2,ga=3;function db(){this.A={};this.C=this.B=void 0}
db.prototype.start=function(a){this.B=new this.A[a];this.B.start(this.C)};var u=new db,Z=0,ab=1,bb=2,cb=3;function eb(){this.B=void 0;this.C=0;this.A=Z}function Ra(a,b){var c=V;c.B=a;c.C=b}eb.prototype.D=function(a){x(a,"#7f8c8d");w(a,"18px MyPixel");a.D("SCORE",10,18);a.D("FIGURE",160,18);x(a,"#f1c40f");w(a,"35px MyPixel");a.D(~~this.C,10,55)};function Ua(a){x(a,"#2c3e50");a.F.fillRect(0,0,240,400);x(a,"#34495e");a.F.fillRect(10,70,220,320)}var V=new eb;
function ya(a,b){return Math.floor(Math.random()*(b-a+1)+a)}var Ya=new function(){navigator.A=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate;navigator.A&&(this.A=!0)};
