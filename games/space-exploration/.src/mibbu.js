var mibbu = function (c, d, f) { var n, o, u, v, C, F, G, H, I, J, g = !0, j = !0, k = window.document, l = [], m = f ? k.getElementById(f) : k.body, p = c || 400, r = d || 300, s = [], A = new Date, B = !1, D = [], E = []; Array.prototype.i = Array.prototype.indexOf || function ($) { for (var _ = this.length; _-- && this[_] !== $;); return _ }; var K = function ($, _) { return -1 !== _.i($) && (_.splice(_.i($), 1), !0) }, L = 0, N = function () { var $ = ''; 'undefined' == typeof I ? $ += 'Meteor avoided : 0' : $ = 'Meteor Avoided: ' + I, $ = $.fontcolor('white'), g ? (o.fillStyle = 'red', o.fillText(stringFps, 4, 15)) : C && (C.innerHTML = $), L++ }, O = function ($, _) { return ~~(100 * (1 / (60 / $))) / 100 * (_ + 1) }, P = function () { v(); for (var $ = l.length; $--;)l[$].draw(); for ($ = s.length; $--;)s[$](); B && N() }, R = function () { v = g ? function () { o.clearRect(0, 0, p, r) } : function () { }, B && (A = new Date), F = function () { return window.requestAnimationFrame || window.mozRequestAnimationFrame || function ($) { setTimeout($, 1e3 / 60) } }(), G = n.style, n.width = p, n.height = r, G.width = p + 'px', G.height = r + 'px', G.position = 'absolute', G.overflow = 'hidden', m.appendChild(n) }, S = function () { n = k.createElement('canvas'), o = n.getContext('2d'), o.i = o.drawImage, l.sort(function ($, _) { return $.zOrder - _.zOrder }) }, T = function () { n = k.createElement('div'), B && (C = k.createElement('div'), n.appendChild(C)) }, U = !0, V = function () { P(), U && (u = F(V, n)) }, W = function () { clearTimeout(u), U = !1 }, X = function () { for (var _, aa, ba, ca, da, ea, fa, ga, ha, ia, ja, $ = D.length; $--;)for (_ in aa = D[$], ca = aa.posY + aa.cZ.t, da = aa.posY + aa.height - aa.cZ.b, ea = aa.posX + aa.cZ.l, fa = aa.posX + aa.width - aa.cZ.r, D[$].hits) ba = E[_], ga = ba.posY + ba.cZ.t, ha = ba.posY + ba.height - ba.cZ.b, ia = ba.posX + ba.cZ.l, ja = ba.posX + ba.width - ba.cZ.r, ca > ha || da < ga || ea > ja || fa < ia || D[$].hits[_]() }; return function () { k.createElement('canvas').getContext || (g = !1) }(), { showScore: function () { return B = !0, this }, init: function () { return g ? S() : T(), R(), this }, on: function () { if (U = !0, V(), j) for (var $ = l.length; $--;)l[$].image && (l[$].image.style[J + 'AnimationDuration'] = O(l[$].speed, l[$].fs) + 's'); return this }, off: function () { if (W(), j) for (var $ = l.length; $--;)l[$].image && (l[$].image.style[J + 'AnimationDuration'] = 0); return this }, canvas: function () { return n }, ctx: function () { return o }, canvasOff: function () { return g = !1, 'undefined' == typeof m.style.WebkitAnimation ? 'undefined' != typeof m.style.MozAnimation && (H = '-moz-', J = 'Moz', j = !0) : (H = '-webkit-', J = 'Webkit', j = !0), this }, cssAnimationOff: function () { return j = !1, this }, hitsOn: function () { return -1 === s.i(X) && s.push(X), this }, hitsOff: function () { return K(X, s), this }, spr: function ($, _, aa, ba, ca) { var da = j ? function () { } : function () { ea.si.top = -1 * (ea.height * ea.f) + 'px', ea.si.left = -1 * (ea.width * ea.animation) + 'px' }, ea = {}, fa = function () { for (var ka = '@' + H + 'keyframes s' + ea.id + ' {\n', la = 100 / (ea.fs + 1), ma = '% { ' + H + 'transform: translate(', na = 0; na < ea.fs + 1; na++)ka += ~~(100 * (la * na)) / 100 + ma + -1 * (ea.animation * ea.width) + 'px,' + -1 * (na * ea.height) + 'px); }\n', ka += ~~(100 * (la * (na + 1) - 0.01)) / 100 + ma + -1 * (ea.animation * ea.width) + 'px,' + -1 * (na * ea.height) + 'px); }\n'; return ka += '100' + ma + ea.animation * ea.width + 'px, 0px); }\n}' }; ea.id = l.length, ea.image = new Image, ea.image.src = $, ea.speed = 1, ea.width = _, ea.iWidth = _, ea.height = aa, ea.iHeight = aa, ea.fs = ba, ea.animations = ca, ea.colllides = !1, ea.hits = {}, ea.f = 0, ea.animation = 0, ea.speed = 1, ea.interval = 0, ea.posX = 0, ea.posY = 0, ea.zOrder = 1, ea.callback = null, ea.callIters = 0, ea.callMaxIters = 0, ea.cZ = { t: 0, l: 0, b: 0, r: 0 }, g || (ea.div = k.createElement('div'), ea.s = ea.div.style, ea.s.overflow = 'hidden', ea.s.width = _ + 'px', ea.s.height = aa + 'px', ea.s.position = 'absolute', ea.s.zIndex = ea.zOrder, ea.si = ea.image.style, ea.si.position = 'absolute', j && (ea.animStyle = k.createElement('style'), ea.animStyle.innerHTML = fa(), k.body.appendChild(ea.animStyle), ea.si[J + 'Animation'] = 's' + ea.id + ' ' + O(ea.speed, ea.fs) + 's linear 0s infinite'), ea.div.appendChild(ea.image), n.appendChild(ea.div)), ea.id = l.push(ea) - 1, E.push(ea); var ha = function (ka) { ka && -1 === D.i(ea) ? D.push(ea) : !ka && -1 !== D.i(ea) && K(ea, D) }; ea.draw = function () { 0 < ea.fs && (ea.interval == ea.speed && 0 !== ea.speed && (ea.f == ea.fs ? (ea.f = 0, 'function' == typeof ea.callback && (ea.callIters++ , ea.callIters === ea.callMaxIters && (ea.callback(), ea.callIters = 0))) : ea.f++ , ea.interval = 0), 0 !== ea.speed && ea.interval++ , da()) }; return { position: function (ka, la, ma) { return void 0 === ka ? { x: ea.posX, y: ea.posY, z: ea.zOrder } : (ea.posX = ka || ea.posX, ea.posY = la || ea.posY, ea.zOrder = ma || ea.zOrder, g ? ma && l.sort(function (na, oa) { return oa.zOrder - na.zOrder }) : (ea.s.left = ka + 'px', ea.s.top = la + 'px', ea.s.zIndex = ma || ea.zOrder), this) }, hit: function (ka, la) { return ha(!0), ea.hits[ka.id()] = la, -1 === D.i(ea) && D.push(ea), this }, zone: function (ka, la, ma, na) { return void 0 === ka ? ea.cZ : (ea.cZ.l = na, ea.cZ.t = ka, ea.cZ.r = la, ea.cZ.b = ma, this) }, noHits: function () { return ea.hits = {}, this }, callback: function (ka, la) { return ea.callback = ka, ea.callMaxIters = la, this }, change: function (ka, la, ma, na, oa) { return ea.image.src = ka, ea.width = la, ea.height = ma, ea.iWidth = la, ea.iHeight = ma, ea.fs = na, ea.animation = oa, ea.interval = 0, ea.f = 0, ea.callback = null, ea.callIters = 0, ea.callMaxIters = 0, g || (ea.si.width = la * (ea.animation + 1) + 'px', ea.si.height = ma * (ea.fs + 1) + 'px', ea.s.width = la + 'px', ea.s.height = ma + 'px', j && (ea.si[J + 'AnimationName'] = '', ea.animStyle.innerHTML = fa(), ea.si[J + 'AnimationName'] = 's' + ea.id)), ea.cZ = { t: 0, l: 0, b: 0, r: 0 }, this }, size: function (ka, la) { return void 0 === ka ? { width: ea.width, height: ea.height } : (g || (ea.s.width = ka + 'px', ea.s.height = la + 'px', ea.si.width = ka * (ea.animations + 1) + 'px', ea.si.height = la * (ea.fs + 1) + 'px'), ea.width = ka, ea.height = la, j && (ea.si[J + 'AnimationName'] = '', ea.animStyle.innerHTML = fa(), ea.si[J + 'AnimationName'] = 's' + ea.id), this) }, speed: function (ka) { return void 0 === ka ? ea.speed : (ea.speed = ka, ea.interval = 0, j && (ea.si[J + 'AnimationDuration'] = O(ka, ea.fs) + 's'), this) }, animation: function (ka) { return void 0 === ka ? ea.animation : (ea.animation = ka, j && (ea.si[J + 'AnimationName'] = '', ea.animStyle.innerHTML = fa(), ea.si[J + 'AnimationName'] = 's' + ea.id), this) }, frame: function (ka) { return void 0 === ka ? ea.f : (ea.f = ka, this) }, id: function () { return ea.id } } }, bg: function ($, _, aa, ba) { var ca = function () { var ia = da.posX, ja = da.posY; -1 != ia.toString().indexOf('e') && (ia = 0), -1 != ja.toString().indexOf('e') && (ja = 0), n.style.backgroundPosition = ia + 'px ' + ja + 'px' }, da = this, ea = function (ia) { n.style.backgroundImage = 'url(' + ia + ')' }; ea($), da.speed = _ || 3; var fa = Math.PI / 180, ga = function (ia) { if (da.dX = 0, da.dY = 0, 'string' == typeof ia) switch (ia) { case 'N': da.dX = 0, da.dY = -1; break; case 'W': da.dX = -1, da.dY = 0; break; case 'S': da.dX = 0, da.dY = 1; break; case 'E': da.dX = 1, da.dY = 0; break; default: } else 'number' == typeof ia && (ia = fa * ia, da.dX = Math.cos(ia), da.dY = Math.sin(ia)) }; ga(aa), da.zOrder = ba.z || 0, da.posX = ba.x || 0, da.posY = ba.y || 0, da.id = l.push(da), da.moving = 0; return da.draw = function () { da.posX += da.speed * da.dX * da.moving, da.posY += da.speed * da.dY * da.moving, ca() }, { on: function () { return da.moving = 1, this }, off: function () { return da.moving = 0, this }, dir: function (ia) { return ga(ia), this }, speed: function (ia) { return void 0 === ia ? da.speed : (da.speed = ia, this) }, img: function (ia) { return void 0 === ia ? $ : (ea(ia), this) }, position: function (ia, ja) { return void 0 === ia ? { x: da.posX, y: da.posY } : (da.posX = ia || da.posX, da.posY = ja || da.posY, this) } } }, hook: function ($) { return s.push($), this }, unhook: function ($) { return K($, s), this }, changeText: function ($) { I = $ }, resetScoreText: function () { I = 0, printOut = '' } } }; window.mibbu = mibbu;