class SoundPlayer{constructor(){this._audioContext=new AudioContext,this._frequencies=[175,265,355,445],this._sounds=[]}play(a){const b=this._audioContext.createOscillator();b.type="square",b.connect(this._audioContext.destination),b.frequency.value=this._frequencies[a],b.start(),this._sounds[a]=b}stop(a){this._sounds[a].stop()}}function generateButtons(a,b){let c=[];const d=document.getElementById("game-pad");for(let e=0;2>e;e++)for(let f=0;2>f;f++){const g=+`0b${e}${f}`*90,h=document.createElement("div");h.style.backgroundColor=`hsl(${g}, 100%, 50%)`,h.style.height="10rem",h.ontouchstart=()=>{h.style.backgroundColor=`hsl(${g}, 100%, 75%)`,b.play(+`0b${e}${f}`)},h.ontouchend=()=>{h.style.backgroundColor=`hsl(${g}, 100%, 50%)`,b.stop(+`0b${e}${f}`),a(+`0b${e}${f}`)},d.appendChild(h),c.push(h)}return c}class SequenceManager{constructor(a,b){this._buttons=a,this._mode=b,this._slow=0==b%2,this._currentSequence=[],this.generateSequence()}generateSequence(){2>this._mode?this._currentSequence.push(Math.floor(4*Math.random())):2<=this._mode&&(this._currentSequence=Array.from({length:this._currentSequence.length+1},()=>Math.floor(4*Math.random()))),this._temporarySequence=[...this._currentSequence]}playSequence(a=0){let b=this._buttons[this._currentSequence[a]];return this._pressButton(b),a<this._currentSequence.length-1?new Promise(b=>{setTimeout(()=>b(this.playSequence(++a)),this._slow?700:400)}):new Promise(a=>{setTimeout(()=>a(),this._slow?900:600)})}_pressButton(a){a.ontouchstart(),setTimeout(()=>a.ontouchend(),350)}check(a){return a===this._temporarySequence.pop()?0===this._temporarySequence.length?1:0:-1}}const soundPlayer=new SoundPlayer;let demonstration=!0,score=0;const buttonClickCallback=a=>{if(!demonstration){switch(sequenceManager.check(a)){case-1:alert(`Game over! Score: ${score}`),document.getElementById("menu").style.display="flex",document.getElementById("logo").style.display="block",document.getElementById("game-pad").style.display="none",document.getElementById("score").style.display="none",score=0;break;case 1:sequenceManager.generateSequence(),setTimeout(()=>play(),1e3);case 0:score++;}document.getElementById("score").innerHTML=`Score: ${score}`}},buttons=generateButtons(buttonClickCallback,soundPlayer);let sequenceManager;function start(a){sequenceManager=new SequenceManager(buttons,a),document.getElementById("menu").style.display="none",document.getElementById("logo").style.display="none",document.getElementById("game-pad").style.display="grid",document.getElementById("score").style.display="block",play()}function play(){demonstration=!0,sequenceManager.playSequence().then(()=>demonstration=!1)}document.getElementById("btn-classic").onclick=()=>start(0),document.getElementById("btn-classic-fast").onclick=()=>start(1),document.getElementById("btn-random").onclick=()=>start(2),document.getElementById("btn-random-fast").onclick=()=>start(3);