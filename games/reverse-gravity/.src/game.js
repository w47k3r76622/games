requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),w={player:new Image,ground:new Image,rock:new Image,hp:new Image,heli:new Image,bullet:new Image,tornado:new Image},g={canvas:document.getElementById("canvas"),ctx:canvas.getContext("2d"),w:canvas.width,h:canvas.height,r:canvas.width/canvas.height,p:!1,igo:!1,s:0,hs:localStorage.getItem("hscore"),fc:0,gr:.55,re:!1,opacity:0,sh:!1,v:3,lo:function(){var t=0,e=0;for(var n in w)t++,w[n].onload=function(){e++,e===t&&g.ng()},w[n].src="assets/"+n+".png"},mm:function(){canvas.style.opacity=1,canvas.style.background="#000000",g.d.text("REVERSEGRAVITY",g.w/2,50,"#ffffff","center","30px Arial"),g.d.text("Desktop",g.w/2,100,"#ffffff","center","13px Arial"),g.d.text("SPACE to jump, ENTER to reverse gravity",g.w/2,130,"#ffffff","center","13px Arial"),g.d.text("Mobile",g.w/2,160,"#ffffff","center","13px Arial"),g.d.text("Screen LEFT to jump, Screen RIGHT to reverse gravity",g.w/2,190,"#ffffff","center","13px Arial"),g.d.text("CLICK TO PLAY",g.w/2,250,"#ffffff","center","13px Arial")},re:function(){var t=window.innerWidth,e=window.innerHeight,n=t/480,r=e/320,o=t/e,a=Math.min(n,r);o>=g.r&&o<=g.r?(canvas.style.width=t+"px",canvas.style.height=e+"px"):(canvas.style.width=480*a+"px",canvas.style.height=320*a+"px")},info:function(){g.d.rect(g.w-120-3,17,106,31,"#000000"),g.d.rect(g.w-120,20,t.hp,25,"dimgrey"),g.d.text("Run "+g.s+" m",20,45,"#000000","left","18px Arial")},scenario:function(){g.s>=1500&&(ro.t=100),g.s>=2500&&(ro.t=80),g.s>=5500&&(ro.t=60),g.s>=5e3&&(hl.vx=-5,gt.vx=-5,gb.vx=-5,t.o=5,g.s+=2),t.hp<=0||t.hp<0?(t.hp=0,g.s>g.hs&&(g.hs=g.s,localStorage.setItem("hscore",g.hs)),run.innerHTML="Run "+g.s+" m <br>",best.innerHTML="Best "+localStorage.getItem("hscore")+" m <br>",g.igo=!0,g.ctx.setTransform(1,0,0,1,0,0),canvas.style.opacity=.5,gameOver.style.display="block"):(t.hp>=100||100==t.hp)&&(t.hp=100)},u:function(){g.opacity<=1&&(g.opacity+=.01),canvas.style.opacity=g.opacity,g.sh?(g.v=-~~g.v,g.ctx.transform(1,0,0,1,g.v,g.v)):g.ctx.setTransform(1,0,0,1,0,0),g.fc++,g.s++,t.u(),hl.u(),bu.u(),ro.u(),gt.u(),gb.u(),tr.u(),c.u(),g.info(),g.scenario()},ng:function(){canvas.style.opacity=0,gameOver.style.display="none",g.opacity=0,g.s=0,g.gr=.55,g.fc=0,g.igo=!1,t.rt(),go.rt(),hl.rt(),c.rt(),bu.rt(),ro.rt(),tr.rt(),g.m()},m:function(){canvas.style.background="silver",g.ctx.clearRect(0,0,g.w,g.h),g.p?g.u():g.mm(),g.igo||requestAnimFrame(g.m)},mouseDown:function(){g.p||setTimeout(function(){g.p=!0,canvas.style.opacity=0},1e3)},keyDown:function(e){32==e.keyCode&&(t.j=!0),13==e.keyCode&&g.p&&(t.j||(g.gr=-g.gr,t.j=!0,setTimeout(function(){t.fv=t.fv?!1:!0},200)))},touch:function(e){g.p||setTimeout(function(){g.p=!0},1e3),e.preventDefault(),x=e.targetTouches[0].pageX,y=e.targetTouches[0].pageY,x<window.innerWidth/2&&(t.j=!0),x>window.innerWidth/2&&g.p&&(t.j||(g.gr=-g.gr,t.j=!0,setTimeout(function(){t.fv=t.fv?!1:!0},200)))},d:{text:function(t,e,n,r,o,a){g.ctx.save(),g.ctx.font=a,g.ctx.textAlign=o,g.ctx.fillStyle=r,g.ctx.fillText(t,e,n),g.ctx.restore()},rect:function(t,e,n,r,o){g.ctx.save(),g.ctx.fillStyle=o,g.ctx.fillRect(t,e,n,r),g.ctx.restore()}}},sp=function(t,e,n,r,o,a,c){var i={i:t,x:e,y:n,w:r,h:o,vx:a,vy:c,r:function(){g.ctx.save(),i.fv?(g.ctx.scale(1,-1),g.ctx.drawImage(i.i,i.x-i.w/2,-i.y-i.h/2)):i.fh?(g.ctx.scale(-1,1),g.ctx.drawImage(i.w,-i.x-i.w/2,i.y-i.h/2)):(g.ctx.scale(1,1),g.ctx.drawImage(i.i,i.x-i.w/2,i.y-i.h/2)),g.ctx.restore()},cw:function(t){return i.x+i.w/2>=t.x-t.w/2&&i.y+i.h/2>=t.y-t.h/2&&i.x-i.w/2<=t.x+t.w/2&&i.y-i.h/2<=t.y+t.h/2},fv:!1,fh:!1};return i},sa=function(t,e,n,r,o,a,c,i,s,f,h,u,x,l){var w={i:t,x:e,y:n,sx:r,sy:o,sw:a,sh:c,w:i,h:s,f:f,tf:h,o:u,vx:x,vy:l,r:function(){g.ctx.save(),w.fv?(g.ctx.scale(1,-1),g.ctx.drawImage(w.i,w.sx,w.sy*w.f,w.sw,w.sh,w.x-w.w/2,-w.y-w.h/2,w.w,w.h)):w.fh?(g.ctx.scale(-1,1),g.ctx.drawImage(w.i,w.sx,w.sy*w.f,w.sw,w.sh,-w.x-w.w/2,w.y-w.h/2,w.w,w.h)):(g.ctx.scale(1,1),g.ctx.drawImage(w.i,w.sx,w.sy*w.f,w.sw,w.sh,w.x-w.w/2,w.y-w.h/2,w.w,w.h)),g.ctx.restore(),w.fc++,w.fc%w.o==0&&w.f++,w.f==w.tf&&(w.f=0)},cw:function(t){return w.x+w.w/2>=t.x-t.w/2&&w.y+w.h/2>=t.y-t.h/2&&w.x-w.w/2<=t.x+t.w/2&&w.y-w.h/2<=t.y+t.h/2},fc:0,fv:!1,fh:!1};return w},t=function(){var t=sa(w.player,100,canvas.height-29,0,35,35,35,35,35,1,3,6,0,-10);return t.u=function(){t.r(),t.j&&(t.y+=t.vy,t.vy+=g.gr,t.f=0),t.cw(gt)&&(t.j=!1,t.vy=10,gr=-.55,t.y=gt.y+26,t.fv=!0),t.cw(gb)&&(t.j=!1,t.vy=-10,gr=.55,t.y=gb.y-26,t.fv=!1),t.cw(hl)&&(t.hp=0),t.cw(tr)&&(t.hp-=3,g.sh=!0,setTimeout(function(){g.sh=!1},100))},t.rt=function(){t.o=6,t.hp=100,t.j=!1,t.fv=!1,t.y=g.h-29},t.j=!1,t.hp=100,t},hl=function(){var t=sa(w.heli,3e3,Math.floor(150*Math.random()+80),0,32,67,32,67,29,1,2,5,-5,0);return t.u=function(){t.r(),t.x+=t.vx,t.x<-1e3&&(t.x=3e3,t.y=Math.floor(150*Math.random()+80),t.ba=Math.floor(2*Math.random()+1))},t.rt=function(){t.vx=-5,t.x=3e3,t.y=Math.floor(150*Math.random()+80),t.ba=Math.floor(2*Math.random()+1)},t.ba=Math.floor(2*Math.random()+1),t},go={j:function(){var t=sp(w.ground,800,12.5,1601,36,-4,0);return t.u=function(){t.r(),t.fv=!0,t.x+=t.vx,t.x<=0&&(t.x=800)},t},q:function(){var t=sp(w.ground,800,canvas.height-12.5,1601,36,-4,0);return t.u=function(){t.r(),t.x+=t.vx,t.x<=0&&(t.x=800)},t},rt:function(){gt.vx=-4,gb.vx=-4}},c={l:{},t:800,g:function(){c.l[Math.random()]=sp(w.hp,600,canvas.height/2,20,20,-4.5,0)},u:function(){g.fc%c.t==0&&c.g();for(var e in c.l)c.l[e].r(),c.l[e].x+=c.l[e].vx,g.s>=5e3&&(c.l[e].vx=-5),c.l[e].cw(t)?(t.hp<100&&(t.hp+=40),delete c.l[e]):c.l[e].x<=-50&&delete c.l[e]},rt:function(){items={}}},bu={l:{},g:function(){bu.l[Math.random()]=sp(w.bullet,hl.x,hl.y,10,10,-6,1)},u:function(){g.fc%15==0&&bu.g();for(var e in bu.l)bu.l[e].r(),g.s>5e3&&(bu.l[e].vx=-7),bu.l[e].vy=1==hl.ba?1:-1,bu.l[e].x+=bu.l[e].vx,bu.l[e].y+=bu.l[e].vy,bu.l[e].cw(t)?(t.hp-=5,g.sh=!0,setTimeout(function(){g.sh=!1},100),delete bu.l[e]):bu.l[e].y>g.h&&delete bu.l[e]},rt:function(){bu.l={},bu.vx=-6}},tr={t:Math.floor(2e3*Math.random()+1e3),j:{},q:{},g:function(){tr.j[Math.random]=sa(w.tornado,Math.floor(3e3*Math.random()+2e3),70,0,100,40,100,40,100,1,2,2,-6,0),tr.q[Math.random]=sa(w.tornado,Math.floor(3e3*Math.random()+2e3),250,0,100,40,100,40,100,1,2,2,-6,0)},u:function(){g.fc%tr.t==0&&tr.g();for(var e in tr.j)tr.j[e].r(),tr.j[e].fv=!0,tr.j[e].x+=tr.j[e].vx,tr.j[e].cw(t)&&(t.hp-=3,g.sh=!0,setTimeout(function(){g.sh=!1},200)),tr.j[e].x<-100&&delete tr.j[e];for(var e in tr.q)tr.q[e].r(),tr.q[e].x+=tr.q[e].vx,tr.q[e].cw(t)&&(t.hp-=3,g.sh=!0,setTimeout(function(){g.sh=!1},200)),tr.q[e].x<-100&&delete tr.q[e]},rt:function(){tr.j={},tr.q={}}},ro={t:200,vx:-4,j:{},q:{},g:function(){ro.j[Math.random()]=sp(w.rock,Math.floor(1200*Math.random()+900),30,52,32,ro.vx,0),ro.q[Math.random()]=sp(w.rock,Math.floor(1200*Math.random()+900),canvas.height-30,52,32,ro.vx,0)},u:function(){g.fc%ro.t==0&&ro.g();for(var e in ro.j)ro.j[e].r(),ro.j[e].fv=!0,ro.j[e].x+=ro.j[e].vx,ro.j[e].cw(t)&&(g.sh=!0,setTimeout(function(){g.sh=!1},200),t.hp-=1.5),g.s>=5e3&&(ro.j[e].vx=-5),ro.j[e].x<=-50&&delete ro.j[e];for(var e in ro.q)ro.q[e].r(),ro.q[e].x+=ro.q[e].vx,ro.q[e].cw(t)&&(g.sh=!0,t.hp-=1.5,setTimeout(function(){g.sh=!1},200)),g.s>=5e3&&(ro.q[e].vx=-5),ro.q[e].x<=-50&&delete ro.q[e]},rt:function(){ro.t=200,ro.j={},ro.q={}}},gt=go.j(),gb=go.q(),t=t(),hl=hl(),window.addEventListener("load",g.lo,!1),window.addEventListener("load",g.re,!1),window.addEventListener("resize",g.re,!1),window.addEventListener("keydown",g.keyDown,!1),window.addEventListener("mousedown",g.mouseDown,!1),canvas.addEventListener("touchstart",g.touch,!1),playAgain.addEventListener("click",g.ng,!1);