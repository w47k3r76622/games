'use strict';let callbacks$$module$source$kontra={};function on$$module$source$kontra(a,b){callbacks$$module$source$kontra[a]=callbacks$$module$source$kontra[a]||[];callbacks$$module$source$kontra[a].push(b)}function off$$module$source$kontra(a,b){let c;!callbacks$$module$source$kontra[a]||0>(c=callbacks$$module$source$kontra[a].indexOf(b))||callbacks$$module$source$kontra[a].splice(c,1)}
function emit$$module$source$kontra(a,...b){callbacks$$module$source$kontra[a]&&callbacks$$module$source$kontra[a].map(a=>a(...b))}let canvasEl$$module$source$kontra,context$$module$source$kontra;function getCanvas$$module$source$kontra(){return canvasEl$$module$source$kontra}function getContext$$module$source$kontra(){return context$$module$source$kontra}
function init$$module$source$kontra(a){canvasEl$$module$source$kontra=document.getElementById(a)||a||document.querySelector("canvas");if(!canvasEl$$module$source$kontra)throw Error("You must provide a canvas element for the game");context$$module$source$kontra=canvasEl$$module$source$kontra.getContext("2d");context$$module$source$kontra.imageSmoothingEnabled=!1;emit$$module$source$kontra("init");return{canvas:canvasEl$$module$source$kontra,context:context$$module$source$kontra}}
class Animation$$module$source$kontra{constructor({spriteSheet:a,frames:b,frameRate:c,loop:d=!0}={}){this.spriteSheet=a;this.frames=b;this.frameRate=c;this.loop=d;let {width:e,height:f,margin:k=0}=a.frame;this.width=e;this.height=f;this.margin=k;this._a=this._f=0}clone(){return animationFactory$$module$source$kontra(this)}reset(){this._a=this._f=0}update(a=1/60){if(this.loop||this._f!=this.frames.length-1)for(this._a+=a;1<=this._a*this.frameRate;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render({x:a,
y:b,width:c=this.width,height:d=this.height,context:e=getContext$$module$source$kontra()}={}){let f=this.frames[this._f]/this.spriteSheet._f|0,k=this.frames[this._f]%this.spriteSheet._f|0;e.drawImage(this.spriteSheet.image,k*this.width+(2*k+1)*this.margin,f*this.height+(2*f+1)*this.margin,this.width,this.height,a,b,c,d)}}function animationFactory$$module$source$kontra(a){return new Animation$$module$source$kontra(a)}animationFactory$$module$source$kontra.prototype=Animation$$module$source$kontra.prototype;
animationFactory$$module$source$kontra.class=Animation$$module$source$kontra;let imageRegex$$module$source$kontra=/(jpeg|jpg|gif|png)$/,audioRegex$$module$source$kontra=/(wav|mp3|ogg|aac)$/,leadingSlash$$module$source$kontra=/^\//,trailingSlash$$module$source$kontra=/\/$/,dataMap$$module$source$kontra=new WeakMap,imagePath$$module$source$kontra="",audioPath$$module$source$kontra="",dataPath$$module$source$kontra="";function getUrl$$module$source$kontra(a,b){return(new URL(a,b)).href}
function joinPath$$module$source$kontra(a,b){return[a.replace(trailingSlash$$module$source$kontra,""),a?b.replace(leadingSlash$$module$source$kontra,""):b].filter(a=>a).join("/")}function getExtension$$module$source$kontra(a){return a.split(".").pop()}function getName$$module$source$kontra(a){a=a.replace("."+getExtension$$module$source$kontra(a),"");return 2==a.split("/").length?a.replace(leadingSlash$$module$source$kontra,""):a}
function getCanPlay$$module$source$kontra(a){return{wav:"",mp3:a.canPlayType("audio/mpeg;"),ogg:a.canPlayType('audio/ogg; codecs="vorbis"'),aac:a.canPlayType("audio/aac;")}}let imageAssets$$module$source$kontra={},audioAssets$$module$source$kontra={},dataAssets$$module$source$kontra={};function addGlobal$$module$source$kontra(){window.__k||(window.__k={dm:dataMap$$module$source$kontra,u:getUrl$$module$source$kontra,d:dataAssets$$module$source$kontra,i:imageAssets$$module$source$kontra})}
function loadImage$$module$source$kontra(a){addGlobal$$module$source$kontra();return new Promise((b,c)=>{let d,e,f;d=joinPath$$module$source$kontra(imagePath$$module$source$kontra,a);if(imageAssets$$module$source$kontra[d])return b(imageAssets$$module$source$kontra[d]);e=new Image;e.onload=function(){f=getUrl$$module$source$kontra(d,window.location.href);imageAssets$$module$source$kontra[getName$$module$source$kontra(a)]=imageAssets$$module$source$kontra[d]=imageAssets$$module$source$kontra[f]=this;
emit$$module$source$kontra("assetLoaded",this,a);b(this)};e.onerror=function(){c("Unable to load image "+d)};e.src=d})}
function loadAudio$$module$source$kontra(a){return new Promise((b,c)=>{let d,e,f,k;d=new Audio;e=getCanPlay$$module$source$kontra(d);a=[].concat(a).reduce((a,b)=>a?a:e[getExtension$$module$source$kontra(b)]?b:null,0);if(!a)return c("cannot play any of the audio formats provided"+a);f=joinPath$$module$source$kontra(audioPath$$module$source$kontra,a);if(audioAssets$$module$source$kontra[f])return b(audioAssets$$module$source$kontra[f]);d.addEventListener("canplay",function(){k=getUrl$$module$source$kontra(f,
window.location.href);audioAssets$$module$source$kontra[getName$$module$source$kontra(a)]=audioAssets$$module$source$kontra[f]=audioAssets$$module$source$kontra[k]=this;emit$$module$source$kontra("assetLoaded",this,a);b(this)});d.onerror=function(){c("Unable to load audio "+f)};d.src=f;d.load()})}
function loadData$$module$source$kontra(a){addGlobal$$module$source$kontra();let b,c;b=joinPath$$module$source$kontra(dataPath$$module$source$kontra,a);return dataAssets$$module$source$kontra[b]?Promise.resolve(dataAssets$$module$source$kontra[b]):fetch(b).then(a=>{if(!a.ok)throw a;return a.clone().json().catch(()=>a.text())}).then(d=>{c=getUrl$$module$source$kontra(b,window.location.href);"object"===typeof d&&dataMap$$module$source$kontra.set(d,c);dataAssets$$module$source$kontra[getName$$module$source$kontra(a)]=
dataAssets$$module$source$kontra[b]=dataAssets$$module$source$kontra[c]=d;emit$$module$source$kontra("assetLoaded",d,a);return d})}function load$$module$source$kontra(...a){addGlobal$$module$source$kontra();return Promise.all(a.map(a=>{let b=getExtension$$module$source$kontra([].concat(a)[0]);return b.match(imageRegex$$module$source$kontra)?loadImage$$module$source$kontra(a):b.match(audioRegex$$module$source$kontra)?loadAudio$$module$source$kontra(a):loadData$$module$source$kontra(a)}))}
const noop$$module$source$kontra=()=>{};function clear$$module$source$kontra(){let a=getCanvas$$module$source$kontra();getContext$$module$source$kontra().clearRect(0,0,a.width,a.height)}
function GameLoop$$module$source$kontra({fps:a=60,clearCanvas:b=!0,update:c,render:d}={}){function e(){p=requestAnimationFrame(e);w=performance.now();A=w-l;l=w;if(!(1E3<A)){emit$$module$source$kontra("tick");for(f+=A;f>=k;)x.update(n),f-=k;r();x.render()}}if(!c||!d)throw Error("You must provide update() and render() functions");let f=0,k=1E3/a,n=1/a,r=b?clear$$module$source$kontra:noop$$module$source$kontra,l,p,w,A,x;return x={update:c,render:d,isStopped:!0,start(){l=performance.now();this.isStopped=
!1;requestAnimationFrame(e)},stop(){this.isStopped=!0;cancelAnimationFrame(p)},_frame:e,set _last(a){l=a}}}
class Vector$$module$source$kontra{constructor(a=0,b=0){this._x=a;this._y=b}add(a,b=1){return vectorFactory$$module$source$kontra(this.x+(a.x||0)*b,this.y+(a.y||0)*b,this)}clamp(a,b,c,d){this._c=!0;this._a=a;this._b=b;this._d=c;this._e=d}get x(){return this._x}get y(){return this._y}set x(a){this._x=this._c?Math.min(Math.max(this._a,a),this._d):a}set y(a){this._y=this._c?Math.min(Math.max(this._b,a),this._e):a}}
function vectorFactory$$module$source$kontra(a,b,c={}){let d=new Vector$$module$source$kontra(a,b);c._c&&(d.clamp(c._a,c._b,c._d,c._e),d.x=a,d.y=b);return d}vectorFactory$$module$source$kontra.prototype=Vector$$module$source$kontra.prototype;vectorFactory$$module$source$kontra.class=Vector$$module$source$kontra;
class Sprite$$module$source$kontra{constructor(a){this.init(a)}init(a={}){let {x:b,y:c,dx:d,dy:e,ddx:f,ddy:k,width:n,height:r,image:l}=a;this.position=vectorFactory$$module$source$kontra(b,c);this.velocity=vectorFactory$$module$source$kontra(d,e);this.acceleration=vectorFactory$$module$source$kontra(f,k);this.width=this.height=this.rotation=0;this.ttl=Infinity;this.anchor={x:0,y:0};this.context=getContext$$module$source$kontra();for(let b in a)this[b]=a[b];l&&(this.width=void 0!==n?n:l.width,this.height=
void 0!==r?r:l.height);this.sy=this.sx=0}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}get animations(){return this._a}get viewX(){return this.x-this.sx}get viewY(){return this.y-this.sy}set x(a){this.position.x=a}set y(a){this.position.y=a}set dx(a){this.velocity.x=a}set dy(a){this.velocity.y=a}set ddx(a){this.acceleration.x=a}set ddy(a){this.acceleration.y=
a}set animations(a){let b,c;this._a={};for(b in a)this._a[b]=a[b].clone(),c=c||this._a[b];this.currentAnimation=c;this.width=this.width||c.width;this.height=this.height||c.height}set viewX(a){}set viewY(a){}isAlive(){return 0<this.ttl}collidesWith(a){if(this.rotation||a.rotation)return null;let b=this.x-this.width*this.anchor.x,c=this.y-this.height*this.anchor.y,d=a.x,e=a.y;a.anchor&&(d-=a.width*a.anchor.x,e-=a.height*a.anchor.y);return b<d+a.width&&b+this.width>d&&c<e+a.height&&c+this.height>e}update(a){this.advance(a)}render(){this.draw()}playAnimation(a){this.currentAnimation=
this.animations[a];this.currentAnimation.loop||this.currentAnimation.reset()}advance(a){this.velocity=this.velocity.add(this.acceleration,a);this.position=this.position.add(this.velocity,a);this.ttl--;this.currentAnimation&&this.currentAnimation.update(a)}draw(){let a=-this.width*this.anchor.x,b=-this.height*this.anchor.y;this.context.save();this.context.translate(this.viewX,this.viewY);this.rotation&&this.context.rotate(this.rotation);this.image?this.context.drawImage(this.image,0,0,this.image.width,
this.image.height,a,b,this.width,this.height):this.currentAnimation?this.currentAnimation.render({x:a,y:b,width:this.width,height:this.height,context:this.context}):(this.context.fillStyle=this.color,this.context.fillRect(a,b,this.width,this.height));this.context.restore()}}function spriteFactory$$module$source$kontra(a){return new Sprite$$module$source$kontra(a)}spriteFactory$$module$source$kontra.prototype=Sprite$$module$source$kontra.prototype;spriteFactory$$module$source$kontra.class=Sprite$$module$source$kontra;
function parseFrames$$module$source$kontra(a){if(+a===a)return a;let b=[];var c=a.split("..");a=+c[0];c=+c[1];let d=a;if(a<c)for(;d<=c;d++)b.push(d);else for(;d>=c;d--)b.push(d);return b}
class SpriteSheet$$module$source$kontra{constructor({image:a,frameWidth:b,frameHeight:c,frameMargin:d,animations:e}={}){if(!a)throw Error("You must provide an Image for the SpriteSheet");this.animations={};this.image=a;this.frame={width:b,height:c,margin:d};this._f=a.width/b|0;this.createAnimations(e)}createAnimations(a){let b,c;for(c in a){let {frames:d,frameRate:e,loop:f}=a[c];b=[];if(void 0===d)throw Error("Animation "+c+" must provide a frames property");[].concat(d).map(a=>{b=b.concat(parseFrames$$module$source$kontra(a))});
this.animations[c]=animationFactory$$module$source$kontra({spriteSheet:this,frames:b,frameRate:e,loop:f})}}}function spriteSheetFactory$$module$source$kontra(a){return new SpriteSheet$$module$source$kontra(a)}spriteSheetFactory$$module$source$kontra.prototype=SpriteSheet$$module$source$kontra.prototype;spriteSheetFactory$$module$source$kontra.class=SpriteSheet$$module$source$kontra;
function setStoreItem$$module$source$kontra(a,b){void 0===b?localStorage.removeItem(a):localStorage.setItem(a,JSON.stringify(b))}function getStoreItem$$module$source$kontra(a){a=localStorage.getItem(a);try{a=JSON.parse(a)}catch(b){}return a}var module$source$kontra={};module$source$kontra.Animation=animationFactory$$module$source$kontra;module$source$kontra.GameLoop=GameLoop$$module$source$kontra;module$source$kontra.Sprite=spriteFactory$$module$source$kontra;module$source$kontra.SpriteSheet=spriteSheetFactory$$module$source$kontra;
module$source$kontra.emit=emit$$module$source$kontra;module$source$kontra.getCanvas=getCanvas$$module$source$kontra;module$source$kontra.getContext=getContext$$module$source$kontra;module$source$kontra.getStoreItem=getStoreItem$$module$source$kontra;module$source$kontra.imageAssets=imageAssets$$module$source$kontra;module$source$kontra.init=init$$module$source$kontra;module$source$kontra.load=load$$module$source$kontra;module$source$kontra.loadImage=loadImage$$module$source$kontra;
module$source$kontra.off=off$$module$source$kontra;module$source$kontra.on=on$$module$source$kontra;module$source$kontra.setStoreItem=setStoreItem$$module$source$kontra;let rotatePoint$$module$source$Util=(a,b)=>{const c=a.x;a=a.y;return b?{x:c*Math.cos(b)-a*Math.sin(b),y:c*Math.sin(b)+a*Math.cos(b)}:{x:c,y:a}},isMobile$$module$source$Util=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);const localStoragePrefix$$module$source$Util="back-and-forth-js13k-2019-";var module$source$Util={};module$source$Util.isMobile=isMobile$$module$source$Util;module$source$Util.localStoragePrefix=localStoragePrefix$$module$source$Util;
module$source$Util.rotatePoint=rotatePoint$$module$source$Util;const roman$$module$source$Clock=[null,"\u2160","\u2161","\u2162","\u2163","\u2164","\u2165","\u2166","\u2167","\u2168","\u2169","\u216a","\u216b"];
function Clock$$module$source$Clock(a,b,c,d=100){const e=spriteFactory$$module$source$kontra({x:0,y:0,radius:null,numbersRadius:null,minRadius:null,maxRadius:null,scaleUp:!1,scaleSpeed:null,scaleAcceleration:.08,hideNumbers:!1,numbersHidingSpeed:.04,numbersOpacity:1,anchor:{x:.5,y:.5},resize:function(a){this.minRadius=this.radius=a;this.maxRadius=1.5*a;this.scaleSpeed=(this.maxRadius-this.minRadius)/30;this.numbersRadius=2*a;emit$$module$source$kontra("clock_resize",a);return this},reposition:function(a,
b){this.x=a||0;this.y=b||0;emit$$module$source$kontra("clock_reposition",a,b);return this},update(){this.hideNumbers?0<this.numbersOpacity&&(this.numbersOpacity-=this.numbersHidingSpeed,0>this.numbersOpacity&&(this.numbersOpacity=0)):1>this.numbersOpacity&&(this.numbersOpacity+=this.numbersHidingSpeed,1<this.numbersOpacity&&(this.numbersOpacity=1));this.scaleUp?this.radius<this.maxRadius&&(this.radius+=this.scaleSpeed,this.radius>this.maxRadius&&(this.radius=this.maxRadius,this.scaleSpeed=1),this.numbersRadius=
2*this.radius,emit$$module$source$kontra("clock_resize",this.radius)):this.radius>this.minRadius&&(this.radius-=this.scaleSpeed,this.radius<this.minRadius&&(this.radius=this.minRadius,this.scaleSpeed=1),this.numbersRadius=2*this.radius,emit$$module$source$kontra("clock_resize",this.radius))},draw:function(){this.context.fillStyle=a.colorScheme.clock;this.context.beginPath();this.context.arc(this.x,this.y,this.radius,0,2*Math.PI);this.context.fill();this.context.globalAlpha=this.numbersOpacity;for(let b=
1;12>=b;b++){const c=rotatePoint$$module$source$Util({x:0,y:-this.numbersRadius},60*Math.PI*b/360);this.context.fillStyle=a.colorScheme.numbers;this.context.font=" italic bold "+this.radius/2+"px sans-serif";this.context.textBaseline="middle";this.context.textAlign="center";this.context.fillText(roman$$module$source$Clock[b],this.x+c.x,this.y+c.y)}this.context.globalAlpha=1}});e.resize(d).reposition(b,c);return e}var module$source$Clock={};module$source$Clock.Clock=Clock$$module$source$Clock;function SfxrParams$$module$source$jsfxr(){this.setSettings=function(a){for(var b=0;24>b;b++)this[String.fromCharCode(97+b)]=a[b]||0;.01>this.c&&(this.c=.01);a=this.b+this.c+this.e;.18>a&&(a=.18/a,this.b*=a,this.c*=a,this.e*=a)}}
function SfxrSynth$$module$source$jsfxr(){this._params=new SfxrParams$$module$source$jsfxr;var a,b,c,d,e,f,k,n,r,l,p,w;this.reset=function(){var a=this._params;d=100/(a.f*a.f+.001);e=100/(a.g*a.g+.001);f=1-a.h*a.h*a.h*.01;k=-a.i*a.i*a.i*1E-6;a.a||(p=.5-a.n/2,w=5E-5*-a.o);n=1+a.l*a.l*(0<a.l?-.9:10);r=0;l=1==a.m?0:(1-a.m)*(1-a.m)*2E4+32};this.totalReset=function(){this.reset();var d=this._params;a=d.b*d.b*1E5;b=d.c*d.c*1E5;c=d.e*d.e*1E5+12;return 3*((a+b+c)/3|0)};this.synthWave=function(A,x){var g=
this._params,M=1!=g.s||g.v,y=g.v*g.v*.1,N=1+3E-4*g.w,t=g.s*g.s*g.s*.1,W=1+1E-4*g.t,X=1!=g.s,Y=g.x*g.x,Z=g.g,O=g.q||g.r,aa=g.r*g.r*g.r*.2,P=g.q*g.q*(0>g.q?-1020:1020),Q=g.p?((1-g.p)*(1-g.p)*2E4|0)+32:0,ba=g.d,R=g.j/2,ca=g.k*g.k*.01,I=g.a,J=a,da=1/a,ea=1/b,fa=1/c;g=5/(1+g.u*g.u*20)*(.01+t);.8<g&&(g=.8);g=1-g;for(var K=!1,S=0,B=0,C=0,T=0,G=0,D,E=0,m,u=0,v,L=0,h,U=0,z,V=0,H=Array(1024),F=Array(32),q=H.length;q--;)H[q]=0;for(q=F.length;q--;)F[q]=2*Math.random()-1;for(q=0;q<x;q++){if(K)return q;Q&&++U>=
Q&&(U=0,this.reset());l&&++r>=l&&(l=0,d*=n);f+=k;d*=f;d>e&&(d=e,0<Z&&(K=!0));m=d;0<R&&(V+=ca,m*=1+Math.sin(V)*R);m|=0;8>m&&(m=8);I||(p+=w,0>p?p=0:.5<p&&(p=.5));if(++B>J)switch(B=0,++S){case 1:J=b;break;case 2:J=c}switch(S){case 0:C=B*da;break;case 1:C=1+2*(1-B*ea)*ba;break;case 2:C=1-B*fa;break;case 3:C=0,K=!0}O&&(P+=aa,v=P|0,0>v?v=-v:1023<v&&(v=1023));M&&N&&(y*=N,1E-5>y?y=1E-5:.1<y&&(y=.1));z=0;for(var ha=8;ha--;){u++;if(u>=m&&(u%=m,3==I))for(D=F.length;D--;)F[D]=2*Math.random()-1;switch(I){case 0:h=
u/m<p?.5:-.5;break;case 1:h=1-u/m*2;break;case 2:h=u/m;h=6.28318531*(.5<h?h-1:h);h=1.27323954*h+.405284735*h*h*(0>h?1:-1);h=.225*((0>h?-1:1)*h*h-h)+h;break;case 3:h=F[Math.abs(32*u/m|0)]}M&&(D=E,t*=W,0>t?t=0:.1<t&&(t=.1),X?(G+=(h-E)*t,G*=g):(E=h,G=0),E+=G,T+=E-D,h=T*=1-y);O&&(H[L%1024]=h,h+=H[(L-v+1024)%1024],L++);z+=h}z*=.125*C*Y;A[q]=1<=z?32767:-1>=z?-32768:32767*z|0}return x}}var synth$$module$source$jsfxr=new SfxrSynth$$module$source$jsfxr;let jsfxr$$module$source$jsfxr;
jsfxr$$module$source$jsfxr=function(a){synth$$module$source$jsfxr._params.setSettings(a);var b=synth$$module$source$jsfxr.totalReset();a=new Uint8Array(4*((b+1)/2|0)+44);b=2*synth$$module$source$jsfxr.synthWave(new Uint16Array(a.buffer,44),b);var c=new Uint32Array(a.buffer,0,44);c[0]=1179011410;c[1]=b+36;c[2]=1163280727;c[3]=544501094;c[4]=16;c[5]=65537;c[6]=44100;c[7]=88200;c[8]=1048578;c[9]=1635017060;c[10]=b;b+=44;c=0;for(var d="data:audio/wav;base64,";c<b;c+=3){var e=a[c]<<16|a[c+1]<<8|a[c+2];
d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e&63]}return d};var module$source$jsfxr={};module$source$jsfxr.jsfxr=jsfxr$$module$source$jsfxr;let crashURL$$module$source$Sound=jsfxr$$module$source$jsfxr([1,,.01,,.4855,.3389,,-.0109,-.359,,,-.2859,,.009,,,,,1,,,,,.5]),jumpURL$$module$source$Sound=jsfxr$$module$source$jsfxr([0,,.2655,,.2362,.3324,,.1715,,,,,,.3217,,,,,.9182,,,,,.5]),player$$module$source$Sound=new Audio;
const Sound$$module$source$Sound={jump:()=>{player$$module$source$Sound.src=jumpURL$$module$source$Sound;player$$module$source$Sound.play().catch(()=>{})},crash:()=>{player$$module$source$Sound.src=crashURL$$module$source$Sound;player$$module$source$Sound.play().catch(()=>{})}};var module$source$Sound={};module$source$Sound.Sound=Sound$$module$source$Sound;function Bug$$module$source$Bug(a,b){if(!a)throw Error("game is not defined");let c,d,e;on$$module$source$kontra("clock_reposition",e=(a,b)=>{c.x=a;c.y=b});on$$module$source$kontra("clock_resize",d=a=>{let b=1.4*a/4;a=(b+a)/b;c.width=b;c.height=b;c.groundedAnchorY=a;c.isFlying||(c.anchor.y=a)});c=spriteFactory$$module$source$kontra({x:null,y:null,width:null,height:null,groundedAnchorY:null,anchor:{x:.5,y:null},animations:b,currentState:"idle",color:"gray",rotationDeg:0,idleDeg:null,direction:1,rotationSpeed:1,
isFlying:0,gravity:-.0045,jumpSpeed:0,wereOverArrow:!1,isOverArrow:function(){const b=Math.max(a.arrow1.rotationSpeed,a.arrow2.rotationSpeed)+this.rotationSpeed;let c=[];if(this.isFlying)for(let d of[a.arrow1,a.arrow2])d.rotationDeg>this.rotationDeg-b&&d.rotationDeg<this.rotationDeg+b&&c.push(d);return c},updateIdleDeg:function(){var b=a.arrow1.idleDeg,c=a.arrow2.idleDeg;b=Math.min(b,c)+Math.abs(b-c)/2;c=b+180;b%=360;c%=360;this.idleDeg=Math.min(Math.abs(b-a.arrow1.idleDeg),Math.abs(b-a.arrow2.idleDeg))>
Math.min(Math.abs(c-a.arrow1.idleDeg),Math.abs(c-a.arrow2.idleDeg))?b:c},update:function(){this.playAnimation(this.currentState+this.directionToString());this.rotationDeg%=360;0>this.rotationDeg&&(this.rotationDeg+=360);this.rotation=2*Math.PI*this.rotationDeg/360;if(a.gameOver){this.updateIdleDeg();var b=Math.sign(this.idleDeg-this.rotationDeg);180<Math.abs(this.idleDeg-this.rotationDeg)&&(b*=-1);this.rotationDeg>this.idleDeg&&(this.rotationDeg+=2*b,this.rotationDeg<this.idleDeg&&(this.rotationDeg=
this.idleDeg));this.rotationDeg<this.idleDeg&&(this.rotationDeg+=2*b,this.rotationDeg>this.idleDeg&&(this.rotationDeg=this.idleDeg));this.rotationDeg===this.idleDeg&&(this.currentState="idle",this.direction=1)}else this.rotationDeg+=this.rotationSpeed*this.direction;this.currentAnimation.update();this.jumpSpeed&&(this.jumpSpeed+=this.gravity);this.anchor.y+=this.jumpSpeed;this.anchor.y<this.groundedAnchorY&&(this.anchor.y=this.groundedAnchorY,this.isFlying=this.jumpSpeed=0,this.currentState="idle");
b=this.isOverArrow();if(b.length){if(!this.wereOverArrow)for(let a of b)emit$$module$source$kontra("bug_overarrow",a);this.wereOverArrow=!0}else this.wereOverArrow=!1},calculatePath:function(){return[{x:0,y:0},{x:this.width,y:0},{x:this.width,y:this.height},{x:0,y:this.height}]},calculateTransformedPath:function(){let a=this.calculatePath(),b=this.width*this.anchor.x,c=this.height*this.anchor.y;return a=a.map(a=>{a.x-=b;a.y-=c;return rotatePoint$$module$source$Util(a,this.rotation)})},jump:function(){2>
this.isFlying&&(Sound$$module$source$Sound.jump(),this.currentState="jump",this.jumpSpeed=.089,this.isFlying++)},die:function(){this.currentState="idle"},switchDirection:function(){this.direction*=-1},directionToString:function(){return-1==this.direction?"left":"right"}});d(a.clock.radius);e(a.clock.x,a.clock.y);c.updateIdleDeg();return c}var module$source$Bug={};module$source$Bug.Bug=Bug$$module$source$Bug;const mobile$$module$source$ScoreBar=isMobile$$module$source$Util();
function ScoreBar$$module$source$ScoreBar(a){if(!a)throw Error("game is not defined");let b,c,d;on$$module$source$kontra("clock_reposition",d=(a,c)=>{b.x=a;b.y=c});on$$module$source$kontra("clock_resize",c=a=>{b.size=a/2});b=spriteFactory$$module$source$kontra({x:null,y:null,size:null,anchor:{x:.5,y:1},score:0,hiScore:0,primaryTxt:"",secondaryTxt:"",add:function(a){this.score+=a;this.score>this.hiScore&&(this.hiScore=this.score,setStoreItem$$module$source$kontra(localStoragePrefix$$module$source$Util+"hiScore",
this.hiScore));emit$$module$source$kontra("scorebar_add",this.score)},update:function(){a.gameOver?(this.score=0,this.primaryTxt=""+this.hiScore,this.secondaryTxt=mobile$$module$source$ScoreBar?"Tap to play":"Press a key"):(this.primaryTxt=""+this.score,this.secondaryTxt="hi "+this.hiScore)},draw:function(){this.context.globalAlpha=.8;this.context.fillStyle=a.colorScheme.scorebar;this.context.font=" bold "+this.size+"px sans-serif";this.context.textBaseline="middle";this.context.textAlign="center";
this.context.fillText(this.primaryTxt,this.x,this.y-.2*this.size);this.context.font="bold "+this.size/2+"px sans-serif";this.context.globalAlpha=.3;this.context.fillText(this.secondaryTxt,this.x,this.y+this.size/2);this.context.globalAlpha=1}});c(a.clock.radius);d(a.clock.x,a.clock.y);b.hiScore=getStoreItem$$module$source$kontra(localStoragePrefix$$module$source$Util+"hiScore")||0;return b}var module$source$ScoreBar={};module$source$ScoreBar.ScoreBar=ScoreBar$$module$source$ScoreBar;function SATCollision$$module$source$Collision(a,b){a=new Shape$$module$source$Collision(a);b=new Shape$$module$source$Collision(b);return a.checkCollision(b)}function Shape$$module$source$Collision(a,b,c){this.x=b||0;this.y=c||0;this.points=a||[];this.getNormals();this.getMedians()}
Shape$$module$source$Collision.prototype.getNormals=function(){var a=this.points,b=a.length;this.normals=[];for(var c=0;c<b;c++){var d=a[c];var e=a[c+1]||a[0];var f=e.y-d.y;e=-(e.x-d.x);d=Math.sqrt(f*f+e*e);this.normals[c]={x:f/d,y:e/d};this.normals[b+c]={x:-f/d,y:-e/d}}};Shape$$module$source$Collision.prototype.getMedians=function(){var a=this.points;this.medians=[];for(var b=0;b<a.length;b++){var c=a[b];var d=a[b+1]||a[0];this.medians.push({x:(c.x+d.x)/2,y:(c.y+d.y)/2})}};
Shape$$module$source$Collision.prototype.checkCollision=function(a){var b=this,c,d;return b.normals.concat(a.normals).every(function(e){c=b.project(e);d=a.project(e);return c.min<=d.max&&c.max>=d.min||d.min>=c.max&&d.max>=c.min})};Shape$$module$source$Collision.prototype.project=function(a){var b=this,c=Infinity,d=-Infinity,e,f,k;this.points.forEach(function(n){e=b.x+n.x;f=b.y+n.y;k=e*a.x+f*a.y;c=k<c?k:c;d=k>d?k:d});return{min:c,max:d}};var module$source$Collision={};
module$source$Collision.SATCollision=SATCollision$$module$source$Collision;function Arrows$$module$source$Arrows(a){if(!a)throw Error("game is not defined");let b,c,d,e;on$$module$source$kontra("clock_reposition",e=(a,d)=>{b.x=c.x=a;b.y=c.y=d});on$$module$source$kontra("clock_resize",d=a=>{b.width=c.width=a/4;b.height=1.4*a;c.height=1.3*a});b=spriteFactory$$module$source$kontra({x:null,y:null,width:null,height:null,anchor:{x:.5,y:1},rotationDeg:null,rotationSpeed:1,idleDeg:null,idleDirection:1,direction:1,randomDirectionChange:function(){this.direction=.5<Math.random()?
this.direction:-1*this.direction},updateIdleDeg(){this.idleDeg=6*(new Date).getMinutes()},update:function(){this.rotationDeg%=360;0>this.rotationDeg&&(this.rotationDeg+=360);this.rotation=2*Math.PI*this.rotationDeg/360;if(a.gameOver){this.updateIdleDeg();this.rotationSpeed=1;this.direction=this.idleDirection;let a=Math.sign(this.idleDeg-this.rotationDeg);180<Math.abs(this.idleDeg-this.rotationDeg)&&(a*=-1);this.rotationDeg>this.idleDeg&&(this.rotationDeg+=2*a,this.rotationDeg<this.idleDeg&&(this.rotationDeg=
this.idleDeg));this.rotationDeg<this.idleDeg&&(this.rotationDeg+=2*a,this.rotationDeg>this.idleDeg&&(this.rotationDeg=this.idleDeg))}else this.rotationDeg+=this.rotationSpeed*this.direction},calculatePath:function(){return[{x:0,y:this.width},{x:this.width/2,y:0},{x:this.width,y:this.width},{x:2*this.width/3,y:this.width},{x:2*this.width/3,y:this.height},{x:this.width/3,y:this.height},{x:this.width/3,y:this.width},{x:0,y:this.width}]},calculateTransformedPath:function(){let a=this.calculatePath(),
b=this.width*this.anchor.x,c=this.height*this.anchor.y;return a=a.map(a=>{a.x-=b;a.y-=c;return rotatePoint$$module$source$Util(a,this.rotation)})},draw:function(){const b=this.width*this.anchor.x,c=this.height*this.anchor.y;this.context.save();this.context.translate(this.x,this.y);this.rotation&&this.context.rotate(this.rotation);this.context.fillStyle=a.colorScheme.arrows;const d=this.calculatePath();this.context.beginPath();this.context.moveTo(d[0].x,d[0].y);for(let {x:a,y:e}of d)this.context.lineTo(a-
b,e-c);this.context.closePath();this.context.fill();this.context.restore()}});c=spriteFactory$$module$source$kontra({x:null,y:null,width:null,height:null,anchor:{x:.5,y:1},rotationDeg:null,rotationSpeed:1.8,idleDeg:null,idleDirection:-1,direction:-1,randomDirectionChange:b.randomDirectionChange,updateIdleDeg(){let a=new Date,b=a.getMinutes();this.idleDeg=30*(a.getHours()%12)+.5*b},update:b.update,calculatePath:b.calculatePath,calculateTransformedPath:b.calculateTransformedPath,draw:b.draw});d(a.clock.radius);
e(a.clock.x,a.clock.y);b.updateIdleDeg();c.updateIdleDeg();b.rotationDeg=b.idleDeg;c.rotationDeg=c.idleDeg;return[b,c]}var module$source$Arrows={};module$source$Arrows.Arrows=Arrows$$module$source$Arrows;const b$$module$source$ColorSchemes="#000000",w$$module$source$ColorSchemes="#ffffff";class ColorScheme$$module$source$ColorSchemes{constructor(a=b$$module$source$ColorSchemes,b=w$$module$source$ColorSchemes,c=b$$module$source$ColorSchemes,d=b$$module$source$ColorSchemes,e=b$$module$source$ColorSchemes){this.background=a;this.scorebar=b;this.arrows=c;this.clock=d;this.numbers=e}}
const blue$$module$source$ColorSchemes=new ColorScheme$$module$source$ColorSchemes("#0260E8"),green$$module$source$ColorSchemes=new ColorScheme$$module$source$ColorSchemes("#41B619"),yellow$$module$source$ColorSchemes=new ColorScheme$$module$source$ColorSchemes("#FFD600"),red$$module$source$ColorSchemes=new ColorScheme$$module$source$ColorSchemes("#F6522E"),violet$$module$source$ColorSchemes=new ColorScheme$$module$source$ColorSchemes("#6E36CA"),complete_darkness$$module$source$ColorSchemes=new ColorScheme$$module$source$ColorSchemes("#000000",
"#000000"),pool$$module$source$ColorSchemes=[complete_darkness$$module$source$ColorSchemes,blue$$module$source$ColorSchemes,green$$module$source$ColorSchemes,yellow$$module$source$ColorSchemes,violet$$module$source$ColorSchemes,red$$module$source$ColorSchemes],ColorSchemes$$module$source$ColorSchemes={get:function(a){return Object.assign({},pool$$module$source$ColorSchemes[a])},transition:function(a,b){a=this.get(a);b=this.get(b);return transitionColorScheme$$module$source$ColorSchemes(a,b)},length:pool$$module$source$ColorSchemes.length};
function*transitionColorScheme$$module$source$ColorSchemes(a,b){b={background:transitionColor$$module$source$ColorSchemes(a.background,b.background),scorebar:transitionColor$$module$source$ColorSchemes(a.scorebar,b.scorebar),arrows:transitionColor$$module$source$ColorSchemes(a.arrows,b.arrows),clock:transitionColor$$module$source$ColorSchemes(a.clock,b.clock),numbers:transitionColor$$module$source$ColorSchemes(a.numbers,b.numbers)};for(a=Object.assign({},a);;){let c=!0;for(let d of Object.keys(a)){let e=
b[d].next();a[d]=e.value||a[d];e.value&&(c=!1)}if(c)break;else yield a}}
function*transitionColor$$module$source$ColorSchemes(a,b){a=[parseInt(a.slice(1,3),16),parseInt(a.slice(3,5),16),parseInt(a.slice(5,7),16)];b=[parseInt(b.slice(1,3),16),parseInt(b.slice(3,5),16),parseInt(b.slice(5,7),16)];let c=[!1,!1,!1];for(;!c[0]||!c[1]||!c[2];){for(var d=0;3>d;d++){var e=Math.sign(b[d]-a[d]);a[d]+=2*e;-1==e&&a[d]<b[d]&&(a[d]=b[d]);1==e&&a[d]>b[d]&&(a[d]=b[d]);0==e&&(c[d]=!0)}d=a[0].toString(16);e=a[1].toString(16);let f=a[2].toString(16);1==d.length&&(d="0"+d);1==e.length&&(e=
"0"+e);1==f.length&&(f="0"+f);yield"#"+d+e+f}}var module$source$ColorSchemes={};module$source$ColorSchemes.ColorSchemes=ColorSchemes$$module$source$ColorSchemes;let {canvas:canvas$$module$source$Game,context:context$$module$source$Game}=init$$module$source$kontra();const mobile$$module$source$Game=isMobile$$module$source$Util();
class Game$$module$source$Game extends EventTarget{constructor(){super();this.gameOver=!0;this.colorSchemeIdx=1;this.colorScheme=ColorSchemes$$module$source$ColorSchemes.get(0);this.transitionColorScheme=ColorSchemes$$module$source$ColorSchemes.transition(0,1);on$$module$source$kontra("scorebar_add",a=>{if(0==a%5){a=this.colorSchemeIdx;do this.colorSchemeIdx++,this.colorSchemeIdx%=ColorSchemes$$module$source$ColorSchemes.length;while(0==this.colorSchemeIdx);this.transitionColorScheme=ColorSchemes$$module$source$ColorSchemes.transition(a,
this.colorSchemeIdx)}});this.clock=Clock$$module$source$Clock(this);this.scoreBar=ScoreBar$$module$source$ScoreBar(this);var a=Arrows$$module$source$Arrows(this);this.arrow1=a[0];this.arrow2=a[1];a=spriteSheetFactory$$module$source$kontra({image:imageAssets$$module$source$kontra.BUG,frameWidth:50,frameHeight:50,animations:{idleright:{frames:["0..4","4..0"],frameRate:10},jumpright:{frames:5},idleleft:{frames:["11..7","7..11"],frameRate:10},jumpleft:{frames:6}}});this.bug=Bug$$module$source$Bug(this,
a.animations);on$$module$source$kontra("bug_overarrow",a=>{this.scoreBar.add(1);a.randomDirectionChange();a.rotationSpeed+=.04});this.onresize();window.addEventListener("resize",this.onresize.bind(this));mobile$$module$source$Game?document.addEventListener("touchstart",a=>{if(!this.gameOver){var b=window.innerWidth;a.touches.item(0).pageX>b/2?this.bug.jump():this.bug.switchDirection()}}):document.addEventListener("keydown",a=>{if(!this.gameOver)switch(a.keyCode){case 38:this.bug.jump();break;case 32:this.bug.switchDirection()}});
document.addEventListener(mobile$$module$source$Game?"touchstart":"keydown",()=>{this.bug.idleDeg===this.bug.rotationDeg&&this.arrow1.idleDeg===this.arrow1.rotationDeg&&this.arrow2.idleDeg===this.arrow2.rotationDeg&&this.start()})}start(){this.gameOver=!1;this.clock.scaleUp=!0;this.clock.hideNumbers=!0}finish(){Sound$$module$source$Sound.crash();this.bug.die();this.gameOver=!0;this.clock.scaleUp=!1;this.clock.hideNumbers=!1;this.transitionColorScheme=ColorSchemes$$module$source$ColorSchemes.transition(this.colorSchemeIdx,
1);this.colorSchemeIdx=1}onresize(){const a=window.innerWidth,b=window.innerHeight;canvas$$module$source$Game.width=a;canvas$$module$source$Game.height=b;this.clock.resize(mobile$$module$source$Game?a/6:b/10);this.clock.reposition(a/2,b/2)}collidedBugArrows(){const a=this.arrow1.calculateTransformedPath().slice(0,3),b=this.arrow2.calculateTransformedPath().slice(0,3),c=this.bug.calculateTransformedPath();return SATCollision$$module$source$Collision(a,c)||SATCollision$$module$source$Collision(b,c)}update(){if(this.transitionColorScheme){let a=
this.transitionColorScheme.next();this.colorScheme=a.value||this.colorScheme;a.done&&(this.transitionColorScheme=null)}this.clock.update();this.scoreBar.update();this.arrow1.update();this.arrow2.update();this.bug.update();!this.gameOver&&this.collidedBugArrows()&&this.finish()}render(){const a=window.innerWidth,b=window.innerHeight;let c=context$$module$source$Game.createRadialGradient(a/2,b/2,0,a/2,b/2,Math.max(a,b));c.addColorStop(0,this.colorScheme.background);c.addColorStop(1,"#000");context$$module$source$Game.fillStyle=
c;context$$module$source$Game.fillRect(0,0,a,b);this.arrow1.render();this.arrow2.render();this.clock.render();this.bug.render();this.scoreBar.render()}}var $jscompDefaultExport$$module$source$Game=function(){return new Promise((a,b)=>{load$$module$source$kontra("BUG.png").then(()=>{a(new Game$$module$source$Game)}).catch(a=>{b(a)})})},module$source$Game={};module$source$Game.Game=Game$$module$source$Game;module$source$Game.default=$jscompDefaultExport$$module$source$Game;const mobile$$module$source$index=isMobile$$module$source$Util(),greeting_close$$module$source$index=document.getElementById("greeting_close"),greeting_open$$module$source$index=document.getElementById("greeting_open"),greeting$$module$source$index=document.getElementById("greeting"),bob_img$$module$source$index=document.getElementById("bob"),tips_mobile$$module$source$index=document.getElementById("tips_mobile"),tips_desktop$$module$source$index=document.getElementById("tips_desktop");
greeting_open$$module$source$index.onclick=a=>{greeting$$module$source$index.style.display="block";a.stopPropagation()};greeting_close$$module$source$index.onclick=a=>{greeting$$module$source$index.style.display="none";a.stopPropagation()};greeting$$module$source$index.onclick=a=>a.stopPropagation();greeting$$module$source$index.addEventListener("touchstart",a=>a.stopPropagation());greeting_close$$module$source$index.addEventListener("touchstart",a=>a.stopPropagation());
let displayGreeting$$module$source$index=()=>{bob_img$$module$source$index.complete?greeting$$module$source$index.style.display="block":bob_img$$module$source$index.onload=()=>{greeting$$module$source$index.style.display="block"}};
const start$$module$source$index=()=>{function a(){$jscompDefaultExport$$module$source$Game().then(function(a){GameLoop$$module$source$kontra({update:a.update.bind(a),render:a.render.bind(a)}).start()})}mobile$$module$source$index?tips_mobile$$module$source$index.style.display="block":tips_desktop$$module$source$index.style.display="block";getStoreItem$$module$source$kontra(localStoragePrefix$$module$source$Util+"visited")?a():(greeting_close$$module$source$index.addEventListener("click",a,{once:!0}),
displayGreeting$$module$source$index());setStoreItem$$module$source$kontra(localStoragePrefix$$module$source$Util+"visited",!0)};start$$module$source$index();var module$source$index={};
