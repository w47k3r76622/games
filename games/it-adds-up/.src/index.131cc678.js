class t{constructor(t){this.state=t,this.x=0,this.y=0,this.rot=0,this.width=40*this.state.scaleFactor>>0,this.height=40*this.state.scaleFactor>>0,this.rot=0,this.color,this.state.body.addEventListener("mousemove",t=>{this.x=t.clientX,this.y=t.clientY}),this.state.body.addEventListener("click",e=>{t.game&&t.game.started&&(this.discarding?this.discarding=!1:this.discarding=!0)}),this.state.eventEmitter.on("playerNewSum",this.collected.bind(this)),this.state.eventEmitter.on("thirteen",this.thirteen.bind(this))}reset(){this.lives=4,this.currentCollected=0,this.discarding=!1,this.discardLeftValue=3e3,this.discardLeft=this.discardLeftValue}getCollisionRect(){return{x:this.x-this.width/2,y:this.y-this.height/2,width:this.width,height:this.height}}update(t){this.discarding?(this.discardLeft-=1e3*t,this.discardLeft<0&&(this.discarding=!1,this.discardLeft=0)):this.discardLeft<this.discardLeftValue&&(this.discardLeft+=100*t,this.discardLeft=Math.min(this.discardLeft,this.discardLeftValue))}thirteen(){this.lives--,0===this.lives&&this.state.eventEmitter.emit("death"),this.currentCollected=0}collected(t){this.currentCollected=t}draw(t,e){t.save(),t.translate(this.x,this.y),t.rect(-this.width/2,-this.height/2,this.width,this.height),t.fillStyle="#ffffff",t.lineWidth=3,t.strokeStyle=this.discarding?"#80e8ff":"#FFD644",t.stroke(),t.closePath();let s=this.width/2;t.fillStyle="#7fffd6",this.lives>0&&(t.beginPath(),t.arc(-s,-s,5,0,2*Math.PI),t.fill(),t.closePath()),this.lives>1&&(t.beginPath(),t.arc(s,-s,5,0,2*Math.PI),t.fill(),t.closePath()),this.lives>2&&(t.beginPath(),t.arc(-s,s,5,0,2*Math.PI),t.fill(),t.closePath()),this.lives>3&&(t.beginPath(),t.arc(s,s,5,0,2*Math.PI),t.fill(),t.closePath()),t.beginPath(),t.lineWidth=1,t.fillStyle="#80e8ffbb",t.strokeStyle="#80e8ff",t.fillRect(-this.width/2,10+this.height/2,this.width*(this.discardLeft/this.discardLeftValue),10),t.strokeRect(-this.width/2,10+this.height/2,this.width,10),t.fillStyle="#ffffff",t.font=(20*this.state.scaleFactor>>0)+"px monospace",t.fillText(this.currentCollected,0,1),t.restore()}}class e{constructor(t){this.state=t,this.width=50*this.state.scaleFactor>>0,this.height=this.width,this.type="number"}reset(){let t=Math.random();this.baseSpeed=this.state.numbersSpeed,t<.25?(this.x=Math.random()*this.state.width>>0,this.y=-this.baseSpeed,this.dx=t<.12?this.baseSpeed:-this.baseSpeed,this.dy=this.baseSpeed):t<.5?(this.x=Math.random()*this.state.width>>0,this.y=this.state.height+this.baseSpeed,this.dx=t<.37?this.baseSpeed:-this.baseSpeed,this.dy=-this.baseSpeed):t<.75?(this.x=this.state.width+this.baseSpeed,this.y=Math.random()*this.state.height>>0,this.dx=-this.baseSpeed,this.dy=t<.63?this.baseSpeed:-this.baseSpeed):(this.x=-this.baseSpeed,this.y=Math.random()*this.state.height>>0,this.dx=this.baseSpeed,this.dy=t<.88?this.baseSpeed:-this.baseSpeed),this.alive=!0,this.bounces=this.state.numbersBounce,this.number=this.state.numbers[Math.random()*this.state.numbers.length>>0],this.color=this.state.colors[Math.random()*this.state.colors.length>>0]}getCenter(){return[this.x+this.width/2,this.y+this.height/2]}punishment(){this.oldNumber=this.number,this.number=13}repent(){this.number=this.oldNumber}update(t){this.y+=this.dy*t,this.x+=this.dx*t,this.x>this.state.width-this.width&&this.dx>0&&this.bounces>0&&(this.bounces--,this.dx=-1*this.dx),this.y>this.state.height-this.height&&this.dy>0&&this.bounces>0&&(this.bounces--,this.dy=-1*this.dy),this.x<0&&this.dx<0&&this.bounces>0&&(this.bounces--,this.dx=-1*this.dx),this.y<0&&this.dy<0&&this.bounces>0&&(this.bounces--,this.dy=-1*this.dy),(this.x<-this.baseSpeed||this.y<-this.baseSpeed||this.x>this.state.width+this.baseSpeed||this.y>this.state.height+this.baseSpeed)&&this.reset()}draw(t,e){t.fillStyle=`rgba(${this.color})`,t.fillRect(this.x,this.y,this.width,this.height),t.strokeStyle=`rgba(${this.color})`,t.strokeRect(this.x,this.y,this.width,this.height),this.bounces>0&&(t.beginPath(),t.fillStyle=`rgba(${this.color})`,t.arc(this.x,this.y,5,0,2*Math.PI),t.fill()),this.bounces>1&&(t.beginPath(),t.fillStyle=`rgba(${this.color})`,t.arc(this.x+this.width,this.y,5,0,2*Math.PI),t.fill()),this.bounces>2&&(t.beginPath(),t.fillStyle=`rgba(${this.color})`,t.arc(this.x,this.y+this.height,5,0,2*Math.PI),t.fill()),this.bounces>3&&(t.beginPath(),t.fillStyle=`rgba(${this.color})`,t.arc(this.x+this.width,this.y+this.height,5,0,2*Math.PI),t.fill()),t.beginPath(),t.fillStyle="#1D1C18",t.fillText(this.number,this.x+this.width/2,this.y+this.height/2+4)}}class s{constructor(t){this.state=t,this.lines=[],this.state.eventEmitter.on("playerCollectedNumber",this.collected.bind(this)),this.elapsed=0,this.lineWidth=0}reset(){this.lines=[]}collected(t){let[e,s]=t.getCenter(),i=[],h=Math.max(2,t.number),a=2*Math.PI/h,o=Math.random();for(let r=0;r<h;r++){let h=o+r*a,n=Math.max(this.state.width,this.state.height)*Math.cos(h),l=Math.max(this.state.width,this.state.height)*Math.sin(h);i.push([e,s,n,l,.45,t.color,1,Math.random(),Math.random()>.5?1:-1])}this.lines.push(i)}draw(t,e){if(0!==this.lines.length){for(let e of this.lines){for(let s of(t.save(),t.translate(e[0][0],e[0][1]),t.rotate(e[0][7]),t.shadowColor="white",t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=10,e))t.strokeStyle=`RGBA(${s[5]}, ${s[4]})`,t.lineWidth=s[6],t.beginPath(),t.moveTo(0,0),t.lineTo(s[2],s[3]),t.stroke(),s[4]-=.006,s[6]+=.1,s[7]+=.002*s[8];t.restore()}this.lines=this.lines.filter(t=>t[0][4]>0)}}}class i{stars=[];numStars=200;shootingStars=[];constructor(t){this.state=t}reset(){this.stars=[],this.shootingStars=[];for(let t=0;t<this.numStars;t++)this.stars.push(this.createStar())}createStar(){return{x:Math.random()*this.state.width,y:Math.random()*this.state.height,radius:.5+3*Math.random(),alpha:Math.random(),vx:(Math.random()-.5)*.05,vy:(Math.random()-.5)*.05,rx:Math.random()>.5?1:-1}}update(){if(this.stars.forEach(t=>{t.x+=t.vx,t.y+=t.vy,t.x<0&&(t.x=canvas.width),t.x>canvas.width&&(t.x=0),t.y<0&&(t.y=canvas.height),t.y>canvas.height&&(t.y=0),t.alpha+=(Math.random()-.5)*.01,t.alpha<0&&(t.alpha=0),t.alpha>1&&(t.alpha=1),t.radius+=.005*t.rx,(t.radius<.5||t.radius>5)&&(t.rx*=-1)}),0===this.shootingStars.length){let t=this.stars[Math.floor(Math.random()*this.stars.length)],e=this.stars[Math.floor(Math.random()*this.stars.length)],s=(e.x-t.x)/600,i=(e.y-t.y)/600;this.shootingStars.push(t.x),this.shootingStars.push(t.y),this.shootingStars.push(e.x),this.shootingStars.push(e.y),this.shootingStars.push(s),this.shootingStars.push(i)}else this.shootingStars.length>0&&(this.shootingStars[0]+=this.shootingStars[4],this.shootingStars[1]+=this.shootingStars[5],2>Math.sqrt(this.shootingStars[0]-this.shootingStars[2]+(this.shootingStars[1]-this.shootingStars[3]))&&(this.shootingStars=[]))}draw(t){t.clearRect(0,0,canvas.width,canvas.height),t.shadowColor="#ffffff",t.shadowBlur=30,t.shadowOffsetX=0,t.shadowOffsetY=0,this.stars.forEach(e=>{t.beginPath(),t.arc(e.x,e.y,e.radius,0,2*Math.PI),t.fillStyle=`rgba(255, 255, 255, ${Math.min(.3,e.alpha)})`,t.fill()}),this.shootingStars.length>0&&(t.beginPath(),t.arc(this.shootingStars[0],this.shootingStars[1],3,0,2*Math.PI),t.fillStyle="#FFD64477",t.fill())}}class h{constructor(t,e,s,i,h,a,o,r){this.state=t,this.color=r,this.pulseSize=100*o*(this.state.scaleFactor/2)>>0,this.pulseDelta=[this.pulseSize+.1*this.pulseSize>>0,this.pulseSize-.1*this.pulseSize>>0],this.glowAlpha=1,this.glowDirection=-.05,this.score=e,this.x=s,this.y=i,this.dx=h,this.dy=a,this.alive=!0,this.pulseDirection=.5,this.elapsed=0}update(){if(this.x+=this.dx,this.y+=this.dy,this.pulseSize+=this.pulseDirection,(this.pulseSize>this.pulseDelta[0]||this.pulseSize<this.pulseDelta[1])&&(this.pulseDirection*=-1),this.fade){this.glowAlpha-=.05,this.glowAlpha<=0&&(this.alive=!1);return}this.glowAlpha+=this.glowDirection,(this.glowAlpha<=.5||this.glowAlpha>=1)&&(this.glowDirection*=-1)}draw(t,e){this.elapsed+=e,this.elapsed>750&&!this.fade&&(this.fade=!0),t.save(),t.font=`${this.pulseSize>>0}px monospace`,t.fillStyle=`rgba(${this.color}, ${this.glowAlpha})`,t.fillText(this.score,this.x,this.y),t.restore()}}class a{constructor(t){this.state=t,this.index=0,this.collected=[],this.types={"+++":{display:()=>{this.state.collectors[1].innerText="+",this.state.collectors[1].style.backgroundColor="var(--main-yellow)",this.state.collectors[3].innerText="+",this.state.collectors[3].style.backgroundColor="var(--main-yellow)",this.state.collectors[5].innerText="+",this.state.collectors[5].style.backgroundColor="var(--main-yellow)"},sum:()=>this.collected.slice(0,4).reduce((t,e)=>t+e.number,0),addItem:t=>{this.collected.push(t),this.flashNumber(t,this.index),this.index+=2}},"++-":{display:()=>{this.state.collectors[1].innerText="+",this.state.collectors[1].style.backgroundColor="var(--main-yellow)",this.state.collectors[3].innerText="+",this.state.collectors[3].style.backgroundColor="var(--main-yellow)",this.state.collectors[5].innerText="-",this.state.collectors[5].style.backgroundColor="var(--main-yellow)"},sum:()=>this.collected.slice(0,4).reduce((t,e,s)=>t+e.number*(3===s?-1:1),0),addItem:t=>{this.collected.push(t),this.flashNumber(t,this.index),this.index+=2}},">":{display:()=>{this.state.collectors[0].innerText="",this.state.collectors[0].style.backgroundColor="var(--main-light)",this.state.collectors[0].style.borderColor="var(--main-light)",this.state.collectors[1].innerText="",this.state.collectors[1].style.backgroundColor="var(--main-light)",this.state.collectors[3].innerText=">",this.state.collectors[3].style.backgroundColor="var(--main-yellow)",this.state.collectors[5].innerText="",this.state.collectors[5].style.backgroundColor="var(--main-light)",this.state.collectors[6].innerText="",this.state.collectors[6].style.backgroundColor="var(--main-light)",this.state.collectors[6].style.borderColor="var(--main-light)"},sum:()=>{if(this.collected.length<2)return 0;let t=parseInt(`${this.collected[0].number}${this.collected[1].number}`);if(this.collected.length<4)return t;let e=parseInt(`${this.collected[2].number}${this.collected[3].number}`);return 13===e?e:t>e?5*t/e>>0:0},addItem:t=>{(0===this.index||3===this.index)&&this.index++,this.collected.push(t),this.flashNumber(t,this.index),this.index+=1}},"<":{display:()=>{this.state.collectors[0].innerText="",this.state.collectors[0].style.backgroundColor="var(--main-light)",this.state.collectors[0].style.borderColor="var(--main-light)",this.state.collectors[1].innerText="",this.state.collectors[1].style.backgroundColor="var(--main-light)",this.state.collectors[3].innerText="<",this.state.collectors[3].style.backgroundColor="var(--main-yellow)",this.state.collectors[5].innerText="",this.state.collectors[5].style.backgroundColor="var(--main-light)",this.state.collectors[6].innerText="",this.state.collectors[6].style.backgroundColor="var(--main-light)",this.state.collectors[6].style.borderColor="var(--main-light)"},sum:()=>{if(this.collected.length<2)return 0;let t=parseInt(`${this.collected[0].number}${this.collected[1].number}`);if(this.collected.length<4)return t;let e=parseInt(`${this.collected[2].number}${this.collected[3].number}`);return 13===e?e:t<e?5*e/t>>0:0},addItem:t=>{(0===this.index||3===this.index)&&this.index++,this.collected.push(t),this.flashNumber(t,this.index),this.index+=1}},">>>":{display:()=>{this.state.collectors[1].innerText=">",this.state.collectors[1].style.backgroundColor="var(--main-yellow)",this.state.collectors[3].innerText=">",this.state.collectors[3].style.backgroundColor="var(--main-yellow)",this.state.collectors[5].innerText=">",this.state.collectors[5].style.backgroundColor="var(--main-yellow)"},sum:()=>this.collected.length<4?0:this.collected[0].number>this.collected[1].number&&this.collected[1].number>this.collected[2].number&&this.collected[2].number>this.collected[3].number?this.collected[0].number*this.collected[1].number:0,addItem:t=>{this.collected.push(t),this.flashNumber(t,this.index),this.index+=2}}},this.typeKeys=Object.keys(this.types),this.state.eventEmitter.on("playerCollectedNumber",this.addItem.bind(this))}flashNumber(t,e){this.state.collectors[e].innerText=t.number,this.state.collectors[e].style.color="var(--main-black)",this.state.collectors[e].style.transition="background-color 0.3s ease",this.state.collectors[e].style.backgroundColor=`rgb(${t.color})`}level1(t){for(let e of(this.index=0,this.collected=[],0===t?this.currentType="+++":this.currentType=this.typeKeys[Math.floor(Math.random()*this.typeKeys.length)],this.state.collectors))e.innerText="",e.style.border="solid 1px var(--score-border-color)",e.style.backgroundColor="var(--main-light)";this.types[this.currentType].display()}getHand(t){if(t.sort((t,e)=>t-e),t[3]-t[0]==3&&4===new Set(t).size)return this.state.handScores.STRAIGHT;let e={};for(let s of t)e[s]=(e[s]||0)+1;let s=Object.values(e).sort((t,e)=>e-t);return 4===s[0]?this.state.handScores.FOAK:3===s[0]?this.state.handScores.TOAK:2===s[0]&&2===s[1]?this.state.handScores.TWOPAIR:2===s[0]?this.state.handScores.PAIR:["",1]}addItem(t,e){this.state.sounds.sfx(1),this.types[this.currentType].addItem(t);let s=this.types[this.currentType].sum();if((13===t.number||13===s)&&(this.state.eventEmitter.emit("thirteen"),this.state.eventEmitter.emit("playerNewSum",0),this.level1()),4===this.collected.length){let t=new Set(this.collected.map(t=>t.color)),i=this.getHand(this.collected.map(t=>t.number)),h=this.currentType;i[1]>1&&(this.state.eventEmitter.emit("handBonus",i[0]),h+=` ${i[0]}`),s*=i[1],1===t.size&&(s*=this.state.handScores.COLOR,this.state.eventEmitter.emit("colorBonus"),h+=` \u{1F3A8}`);let a=1;e<7e3?a=2:e<15e3&&(a=1.5),a>1&&(s*=a,this.state.eventEmitter.emit("timeBonus"),h+=` \u{23F1}\u{FE0F}`),s>>=0,this.level1(),this.state.eventEmitter.emit("finishedLevel",s,s>0?`${h} (${s})`:`${this.currentType} failed`),this.state.eventEmitter.emit("playerNewSum",0)}else this.state.eventEmitter.emit("playerNewSum",s)}}class o{started=!0;prevTime=0;items=[];numberQueue=[];lastTime=0;fixedTimeStep=1e3/60;accumulatedTime=0;deltaTime=this.fixedTimeStep/1e3;levelStarted=0;constructor(e){this.state=e,this.mouseX=0,this.mouseY=0,this.randomLines=new s(this.state),this.starField=new i(this.state),this.collector=new a(this.state),this.player=new t(this.state),this.state.eventEmitter.on("death",this.death.bind(this)),this.state.eventEmitter.on("finishedLevel",this.finishedLevel.bind(this)),this.state.eventEmitter.on("colorBonus",this.colorBonus.bind(this)),this.state.eventEmitter.on("handBonus",this.handBonus.bind(this)),this.state.eventEmitter.on("timeBonus",this.timeBonus.bind(this)),this.state.eventEmitter.on("thirteen",this.thirteen.bind(this)),this.state.eventEmitter.on("shopChoice",this.shopChoice.bind(this)),this.reset()}reset(){this.score=0,this.screenShake=!1,this.isPlayerCollidable=0,this.levelsCompleted=0,this.bestRoundCombo=0,this.state.gameOver.style.display="none",document.querySelector("body").style.cursor="none",this.collector.level1(this.levelsCompleted),this.player.reset(),this.state.sounds.playSong(0,1),this.state.sounds.playSong(3),this.numberIntervalValue=1500,this.numbersMax=20,this.numberInterval=this.numberIntervalValue,this.log={hands:[],shop:[]},this.shopOptions={},this.shopOptions.misc=[{description:"Numbers bounce one more time",act:()=>{this.state.numbersBounce++}},{description:"Numbers more likely to be pink",act:()=>{this.state.colors.push("255, 61, 109")}},{description:"Numbers more likely to be orange",act:()=>{this.state.colors.push("253, 140, 44")}},{description:"Numbers more likely to be green",act:()=>{this.state.colors.push("60, 252, 140")}}],this.shopOptions.numbers=[{description:"Numbers more likely to be even",act:()=>{this.state.numbers.push(2),this.state.numbers.push(4),this.state.numbers.push(6),this.state.numbers.push(8),this.state.numbers.push(10),this.state.numbers.push(12)}},{description:"Numbers more likely to be odd",act:()=>{this.state.numbers.push(1),this.state.numbers.push(3),this.state.numbers.push(5),this.state.numbers.push(7),this.state.numbers.push(9),this.state.numbers.push(11),this.state.numbers.push(13)}}];for(let t=1;t<=12;t++)this.shopOptions.numbers.push({description:"Number more likely to be "+t,act:()=>{this.state.numbers.push(t)}});for(let t=1;t<=12;t++)this.shopOptions.numbers.push({description:"Number less likely to be "+t,act:()=>{let e=this.state.numbers.findIndex(e=>e===t);e>-1&&this.state.numbers.splice(e,1)}});this.shopOptions.hands=[{description:"Increase multiplier of pair",act:()=>{this.state.handScores.PAIR[1]*=1.1}},{description:"Increase multiplier of two pairs",act:()=>{this.state.handScores.TWOPAIR[1]*=1.1}},{description:"Increase multiplier of straight",act:()=>{this.state.handScores.STRAIGHT[1]*=1.1}},{description:"Increase multiplier of three of a kind",act:()=>{this.state.handScores.TOAK[1]*=1.1}},{description:"Increase multiplier of four of a kind",act:()=>{this.state.handScores.FOAK[1]*=1.1}},{description:"Increase multiplier of same color hand",act:()=>{this.state.handScores.COLOR*=1.5}}],this.shopOptions.mixed=[{description:"Number more likely to be 13",act:()=>{this.state.numbers.push(13)}},{description:"Gain 1 life and number more likely to be 13",act:()=>{this.state.numbers.push(13),this.player.lives=Math.min(this.player.lives+1,4)}}],this.prevTime=0,this.items=[],this.numberQueue=[],this.lastTime=0,this.accumulatedTime=0,this.levelStarted=0,this.randomLines.reset(),this.starField.reset(),this.state.canvas.style.opacity=1,this.state.startfieldCanvas.style.opacity=1,this.state.scoreContainer.style.display="block",this.state.hud.style.display="block",this.state.score.innerText="0";for(let t=0;t<10;t++)this.numberQueue.push(new e(this.state));this.started=!0}thirteen(){this.screenShake=!0,setTimeout(()=>{this.screenShake=!1},300)}colorBonus(){this.items.push(new h(this.state,"\uD83C\uDFA8",this.player.x,this.player.y,-.5,0,.4,"255, 99, 97"))}handBonus(t){this.items.push(new h(this.state,t,this.player.x,this.player.y,0,1,.6,"255, 211, 128"))}timeBonus(){this.items.push(new h(this.state,"⏱️",this.player.x,this.player.y,.5,0,.4,"255, 211, 128"))}death(){this.state.sounds.stopSong(0),this.state.sounds.sfx(2),document.querySelector("body").style.cursor="auto";let t=this.log.hands.map(t=>`${t}<br>`).join(""),e=this.log.shop.map(t=>`${t}<br>`).join(""),s="",i=this.state.load();this.score>i.score?(s+=`<p>Your score is ${this.score}, this is a new record!<p>`,i.score=this.score):s+=`<p>Your score is ${this.score}, not quite as high as ${i.score}.</p>`,this.bestRoundCombo>i.combo?(s+=`<p>Your best combo is ${this.bestRoundCombo}, this is a new record!<p>`,i.combo=this.bestRoundCombo):s+=`<p>Your best combo is ${this.bestRoundCombo}, not quite as high as ${i.combo}.</p>`,this.state.save(i.score,i.combo),this.state.gameOverText.innerHTML=s+"<br/>Click to try again.",this.state.gameOverStat.innerHTML=`<div>${t}</div><div>${e}</div>`,this.state.gameOver.style.display="block",this.state.scoreContainer.style.display="none",this.state.hud.style.display="none",this.state.canvas.style.opacity=.1,this.state.startfieldCanvas.style.opacity=.1,this.started=!1}showShop(){this.started=!1,this.state.sounds.fade(3,0);let t=this.shopOptions.misc[Math.floor(Math.random()*this.shopOptions.misc.length)],e=this.shopOptions.numbers[Math.floor(Math.random()*this.shopOptions.numbers.length)],s=this.shopOptions.hands[Math.floor(Math.random()*this.shopOptions.hands.length)],i=this.shopOptions.mixed[Math.floor(Math.random()*this.shopOptions.mixed.length)];this.state.shop.style.display="grid",this.state.shop1.innerText=t.description,this.state.shop2.innerText=e.description,this.state.shop3.innerText=s.description,this.state.shop4.innerText=i.description,this.currentShop={one:t,two:e,three:s,four:i},document.querySelector("body").style.cursor="auto"}shopChoice(t){this.currentShop[t].act(),this.log.shop.push(this.currentShop[t].description),this.state.sounds.fade(0,3),this.started=!0,this.state.shop.style.display="none",this.isPlayerCollidable=300}finishedLevel(t,s){if(0===t){for(let t of this.items.filter(t=>"number"===t.type))t.punishment(),setTimeout(()=>{t.repent()},6e3);return}this.bestRoundCombo=Math.max(this.bestRoundCombo,t),this.levelStarted=0,this.log.hands.push(s),this.levelsCompleted++,this.levelsCompleted%3==0&&(this.numberIntervalValue=Math.max(100,this.numberIntervalValue-15),this.numbersMax++,this.state.numbersSpeed*=1.05,this.numberQueue.push(new e(this.state)),this.showShop()),this.score+=t,this.state.score.innerText=`${this.score}`,this.items.push(new h(this.state,t,this.player.x,this.player.y,0,-.5,1,"255,255,255"))}areRectanglesColliding(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}draw(t){if(this.started){let s=t-this.prevTime;this.levelStarted+=s,this.prevTime=t;let i=t-this.lastTime;for(this.lastTime=t,this.accumulatedTime+=i,this.isPlayerCollidable>0&&(this.isPlayerCollidable=Math.max(0,this.isPlayerCollidable-i));this.accumulatedTime>=this.fixedTimeStep;){for(let t of(this.starField.update(),this.items))t.update(this.deltaTime),0===this.isPlayerCollidable&&t.alive&&"number"===t.type&&this.areRectanglesColliding(t,this.player.getCollisionRect())&&(t.alive=!1,this.numberQueue.push(new e(this.state)),this.player.discarding||this.state.eventEmitter.emit("playerCollectedNumber",t,this.levelStarted));this.player.update(this.deltaTime),this.items=this.items.filter(t=>t.alive),this.accumulatedTime-=this.fixedTimeStep}if(this.numberInterval>0)this.numberQueue.length>0&&(this.numberInterval-=i);else if(this.numberInterval<=0&&this.numberQueue.length>0&&this.items.filter(t=>t.type&&"number"===t.type).length<this.numbersMax){let t=this.numberQueue.pop();t.reset(),this.items.push(t),this.numberInterval=this.numberIntervalValue}for(let t of(this.state.ctx.clearRect(0,0,this.state.width,this.state.height),this.state.ctx.save(),this.screenShake&&this.state.ctx.translate(-20+40*Math.random(),-20+40*Math.random()),this.starField.draw(this.state.startfieldCtx),this.randomLines.draw(this.state.ctx,s),this.items))t.draw(this.state.ctx,s);this.player.draw(this.state.ctx),this.state.ctx.restore()}else this.prevTime=t,this.lastTime=t;requestAnimationFrame(t=>this.draw(t))}}class r{constructor(){this.events={}}on(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)}off(t,e){this.events[t]&&(this.events[t]=this.events[t].filter(t=>t!==e))}emit(t,...e){this.events[t]&&this.events[t].forEach(t=>{t.apply(this,e)})}once(t,e){let s=(...i)=>{e.apply(this,i),this.off(t,s)};this.on(t,s)}}var n=function(){var t,e,s,i,h,a=function(t){return Math.sin(6.283184*t)},o=function(t){return .003959503758*2**((t-128)/12)},r=function(t,e,s){var i,h,a,r,l,c,d=n[t.i[0]],u=t.i[1],m=t.i[3]/32,p=n[t.i[4]],y=t.i[5],g=t.i[8]/32,b=t.i[9],f=t.i[10]*t.i[10]*4,v=t.i[11]*t.i[11]*4,x=t.i[12]*t.i[12]*4,S=1/x,w=-t.i[13]/16,I=t.i[14],C=s*2**(2-t.i[15]),T=new Int32Array(f+v+x),M=0,L=0;for(i=0,h=0;i<f+v+x;i++,h++)h>=0&&(I=I>>8|(255&I)<<4,h-=C,l=o(e+(15&I)+t.i[2]-128),c=o(e+(15&I)+t.i[6]-128)*(1+8e-4*t.i[7])),a=1,i<f?a=i/f:i>=f+v&&(a=(1-(a=(i-f-v)*S))*3**(w*a)),M+=l*a**m,r=d(M)*u,L+=c*a**g,r+=p(L)*y,b&&(r+=(2*Math.random()-1)*b),T[i]=80*r*a|0;return T},n=[a,function(t){return t%1<.5?1:-1},function(t){return t%1*2-1},function(t){var e=t%1*4;return e<2?e-1:3-e}];this.init=function(a){t=a,e=a.endPattern,s=0,h=new Int32Array(i=a.rowLen*a.patternLen*(e+1)*2)},this.generate=function(){var o,l,c,d,u,m,p,y,g,b,f,v,x,S,w=new Int32Array(i),I=t.songData[s],C=t.rowLen,T=t.patternLen,M=0,L=0,E=!1,k=[];for(c=0;c<=e;++c)for(d=0,p=I.p[c];d<T;++d){var P=p?I.c[p-1].f[d]:0;P&&(I.i[P-1]=I.c[p-1].f[d+T]||0,P<17&&(k=[]));var O=n[I.i[16]],B=I.i[17]/512,A=2**(I.i[18]-9)/C,$=I.i[19],R=I.i[20],F=135.82764118168*I.i[21]/44100,D=1-I.i[22]/255,N=1e-5*I.i[23],z=I.i[24]/32,H=I.i[25]/512,W=6.283184*2**(I.i[26]-9)/C,q=I.i[27]/255,K=I.i[28]*C&-2;for(u=0,f=(c*T+d)*C;u<4;++u)if(m=p?I.c[p-1].n[d+u*T]:0){k[m]||(k[m]=r(I,m,C));var V=k[m];for(l=0,o=2*f;l<V.length;l++,o+=2)w[o]+=V[l]}for(l=0;l<C;l++)(b=w[y=(f+l)*2])||E?(v=F,$&&(v*=O(A*y)*B+.5),M+=(v=1.5*Math.sin(v))*L,x=D*(b-L)-M,L+=v*x,b=3==R?L:1==R?x:M,N&&(b*=N,b=(b<1?b>-1?a(.25*b):-1:1)/N),b*=z,E=b*b>1e-5,S=b*(1-(g=Math.sin(W*y)*H+.5)),b*=g):S=0,y>=K&&(S+=w[y-K+1]*q,b+=w[y-K]*q),w[y]=0|S,w[y+1]=0|b,h[y]+=0|S,h[y+1]+=0|b}return++s/t.numChannels},this.createAudioBuffer=function(t){for(var e=t.createBuffer(2,i/2,44100),s=0;s<2;s++)for(var a=e.getChannelData(s),o=s;o<i;o+=2)a[o>>1]=h[o]/65536;return e},this.createWave=function(){var t=44+2*i-8,e=t-36,s=new Uint8Array(44+2*i);s.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var a=0,o=44;a<i;++a){var r=h[a];r=r<-32767?-32767:r>32767?32767:r,s[o++]=255&r,s[o++]=r>>8&255}return s},this.getData=function(t,e){for(var s=2*Math.floor(44100*t),i=Array(e),a=0;a<2*e;a+=1){var o=s+a;i[a]=t>0&&o<h.length?h[o]/32768:0}return i}};const l={songData:[{i:[2,100,128,0,3,201,128,0,0,0,5,48,40,4,0,0,0,195,6,1,2,118,63,0,32,147,6,67,6],p:[,,,,,,,,,,,,,,,,1,2,3,4,1,2,3,5],c:[{n:[142,,,,,,,,,,,,,,,,140,,,,142,,,,144,,,,147],f:[]},{n:[140,,,,,,,,,,,,,,,,139,,,,140,,,,142,,,,144],f:[]},{n:[139,,,,,,,,,,,,,,,,137,,,,139,,,,140,,,,142],f:[]},{n:[135,,,,,,,,137,,,,,,,,139,,,,,,,,140],f:[]},{n:[135,,,,,,,,137,,,,,,,,139,,,,,,,,140,,,,,,,,,,147,,,,,,,,137,,135,,137,,,,139,,140,,139,,,,137,,144,,147],f:[]}]},{i:[3,100,128,0,3,201,128,0,0,0,0,6,49,0,0,0,0,139,3,1,3,30,184,119,244,147,6,29,3],p:[1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,1,1,2,1,2,3,4,1,1,1,2,1,2,3,4],c:[{n:[118,,130,,118,,130,,118,,130,,118,,130,,118,,130,,118,,130,,118,,130,,118,,130],f:[]},{n:[116,,128,,116,,128,,116,,128,,116,,128,,116,,128,,116,,128,,116,,128,,116,,128],f:[]},{n:[115,,127,,115,,127,,115,,127,,115,,127,,115,,127,,115,,127,,115,,127,,115,,127],f:[]},{n:[111,,123,,111,,123,,111,,123,,111,,123,,111,,123,,113,,125,,115,,127,,116,,128],f:[]}]},{i:[0,255,116,79,0,255,116,0,83,0,4,6,69,52,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[135,,,,135,,,,135,,,,135,,,,135,,,,135,,,,135,,,,135],f:[]},{n:[135,,,,,,,,135,,,,,,135,,135,,,,,,,,135,,,,,,135],f:[]}]},{i:[0,255,152,0,3,255,152,12,0,0,2,0,60,0,0,0,0,0,0,0,2,255,0,0,32,47,3,69,8],p:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,1,,,,,,1,,1],c:[{n:[,,,,,,118,,,,,,,,,,,,,,,,118,,,,,,,,,,,,118,,,,,,,,125,,,,,,,,118,,,,,,,,128,,,,,,,,,,123,,,,,,,,,,,,,,,,123,,,,,,,,,,127],f:[]}]},{i:[2,142,128,0,0,191,116,9,0,0,6,22,34,0,114,3,0,69,3,1,1,22,108,0,32,77,6,123,6],p:[,,,,,,,,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,142,,154,142,,,142],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,140,,152,140,,,140],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,139,,151,139,,,139],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,135,147,135],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,1,,2,,,,,,1,,2],c:[{n:[142,,146,,149,,152,,142,,144,,146,,147,,142,,146,,149,,152,,142,,144,,146,,147],f:[]},{n:[140,,144,,147,,150,,140,,142,,144,,145,,140,,144,,147,,150,,140,,142,,144,,145],f:[]}]},{i:[0,221,128,64,0,210,128,0,64,255,4,6,73,79,0,0,0,64,7,1,3,195,15,0,32,20,0,8,3],p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[,,,,135,,,,,,,,135,,,,,,,,135,,,,,,,,135],f:[]},{n:[,,,,135,,,,,,,,135,,,,,,,,135,,,135,,,135,,135,,135,135],f:[]},{n:[135,,,,,,135,,135,,,,135,,,,,,135,,135,,,,,,,,135],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,81,4,10,47,55,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[147,,147,,147,,147,,147,,147,,147,,147,,147,,147,,147,,147,,147,,147,,147,,147],f:[]}]},{i:[0,0,128,0,0,0,128,0,0,125,0,1,59,0,0,0,0,0,0,0,1,193,171,0,29,39,3,88,3],p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,159],f:[]}]},{i:[0,214,104,64,0,204,104,0,64,229,4,40,43,51,0,0,0,231,6,1,3,183,15,0,32,232,4,74,6],p:[,,,,,,,,,,,,,,,,1,,,,,,,,1],c:[{n:[135],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,24,40,4,0,0,3,195,6,0,2,0,28,0,32,147,3,67,6],p:[,,,,1,2,3,4,,,,,,,,,,,,,,,,,1,2,3,4,,,,,1,2,3,4,,,,,1,2,3,4],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,130,135,142,147,130,135,142,147,130,135,142,147,130,135,142,147,130,135,142,147,130,135,142,147,130,135,142,147,130,135,142,147],f:[22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,128,132,140,144,128,132,140,144,128,132,140,144,128,132,140,144,128,132,140,144,128,132,140,144,128,132,140,144,128,132,140,144],f:[22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,30,31,33,34,35,37,38,39,41,42,43,45,46,47,49,50,51,52,54,55,56,58,59,60,62,63,64,66,67,68,70,71]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,127,132,139,144,127,132,139,144,127,132,139,144,127,132,139,144,127,132,139,144,127,132,139,144,127,132,139,144,127,132,139,144],f:[22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,71,70,68,67,66,64,63,62,60,59,58,56,55,54,52,51,50,49,47,46,45,43,42,41,39,38,37,35,34,33,31,30]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,123,128,135,140,123,128,135,140,123,128,135,140,123,128,135,140,123,128,135,140,123,128,135,140,123,128,135,140,123,128,135,140],f:[22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1]}]}],rowLen:5703,patternLen:32,endPattern:43,numChannels:11},c={songData:[{i:[3,255,128,0,0,255,140,0,0,127,2,2,47,19,0,0,0,96,3,1,3,94,79,0,32,84,2,12,4],p:[1],c:[{n:[135],f:[]}]}],rowLen:5513,patternLen:3,endPattern:0,numChannels:1},d={songData:[{i:[3,100,128,0,3,201,128,0,0,1,5,6,58,0,0,0,3,52,2,0,2,115,0,0,32,147,6,43,6],p:[1],c:[{n:[123,126,130,131,135,142,138,137,135],f:[]}]}],rowLen:9728,patternLen:14,endPattern:0,numChannels:1},u={songData:[{i:[3,100,128,0,3,201,128,0,0,1,5,6,58,0,0,0,3,52,2,0,2,115,0,0,32,147,6,43,6],p:[1,2,3,4],c:[{n:[123,126,130,131,135,138,142,143,142,138,135,131,130,126,130,126,126,129,133,134,138,141,145,146,145,141,138,134,133,129,133,129],f:[]},{n:[128,131,135,136,140,143,147,148,147,143,140,136,135,131,135,131,126,129,133,134,138,141,145,146,145,141,138,134,133,129,133,129],f:[]},{n:[128,131,135,136,140,143,147,148,147,143,140,136,135,131,135,131,130,133,137,138,142,145,149,150,149,145,142,138,137,133,137,133],f:[]},{n:[127,130,134,135,139,142,146,147,146,142,139,135,134,130,134,130,125,128,132,133,137,140,144,145,144,140,137,133,132,128,132,128],f:[]}]},{i:[0,91,128,0,3,95,128,12,0,0,12,124,33,0,0,0,0,0,0,0,2,135,112,0,27,83,3,130,4],p:[1,2,3,4],c:[{n:[138,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,141,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,143],f:[]},{n:[136,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,140,,,,,,,,,,,,150,,,,,,,,,,,,,,,,,,,,,,,,141],f:[]},{n:[147,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,143,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,137,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,142],f:[]},{n:[,,,,,,,,,,,,,,,,140,,,,,,,,,,,,,,,,,,,,,,,,,,,,139,,,,,,,,,,,,,,,,,,,,142],f:[]}]},{i:[0,255,116,79,0,255,116,0,83,0,4,6,69,52,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[1,1,1,1],c:[{n:[135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,81,4,10,47,55,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[1,1,1,1],c:[{n:[,,135,,,135,,135,,,135,,,135,135,,,,135,,,135,,135,,,135,,,135,135],f:[]}]},{i:[3,0,128,0,3,68,128,0,64,218,4,4,53,68,0,0,1,55,4,1,2,67,115,124,190,67,6,39,1],p:[1,1,1,1],c:[{n:[,,135,,,,135,,,,135,,,,135,,,,135,,,,135,,,,135,,,,135],f:[]}]},{i:[3,100,128,0,3,201,128,2,0,0,0,6,49,0,0,0,0,139,4,1,3,30,184,119,244,147,6,84,6],p:[1,2,3,4],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,119,,,,,,119,,119,131,119,,,,,,117,,129,122,,,117,,,,117],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,119,,,,,,119,,,,119,,,,,,117,,,,,,117,,,,117],f:[]},{n:[,,,,119,,,,,,119,,,,119,,,,,,118,,,,,,118,,,,118],f:[]},{n:[,,,,115,,,,,,115,,,,115,,,,,,113,,,,,,113,,,,113],f:[]}]}],rowLen:9728,patternLen:32,endPattern:3,numChannels:6};class m{constructor(){this.player=new n,this.soundsLoading=[l,c,d,u],this.sounds=[],this.currentlyLoadingIndex=0,this.startedLoading=!1}load(t){if(this.startedLoading||(this.player.init(this.soundsLoading[this.currentlyLoadingIndex]),this.startedLoading=!0),1>this.player.generate()){setTimeout(()=>this.load(t),200);return}{let e=this.player.createWave(),s=document.createElement("audio");s.src=URL.createObjectURL(new Blob([e],{type:"audio/wav"})),this.sounds.push(s),this.currentlyLoadingIndex++,this.currentlyLoadingIndex<this.soundsLoading.length?(this.player.init(this.soundsLoading[this.currentlyLoadingIndex]),this.load(t)):(this.sounds[0].loop=!0,this.sounds[0].volume=0,t())}}playSong(t,e=0){this.sounds[t].loop=!0,this.sounds[t].volume=e,this.sounds[t].play()}pauseSong(t){this.sounds[t].pause()}stopSong(t){this.pauseSong(t),this.sounds[t].currentTime=0}sfx(t){this.sounds[t].play()}fade(t,e){this.intervalID&&clearInterval(this.intervalID),this.sounds[t].play(),this.intervalID=setInterval(()=>{if(this.sounds[t].volume<.9){let s=this.sounds[t].volume+.1;if(s>.9&&(s=.9),this.sounds[t].volume=s.toFixed(2),this.sounds[e].volume>0){let t=.9-s;t<0&&(t=0),this.sounds[e].volume=t.toFixed(2)}}else clearInterval(this.intervalID),this.intervalID=void 0},100)}}(()=>{let t=document.getElementById("canvas"),e=t.getContext("2d"),s=document.getElementById("starField"),i=s.getContext("2d"),h={canvas:t,ctx:e,body:document.querySelector("body"),gameOver:document.getElementById("game-over"),gameOverText:document.getElementById("game-over-text"),gameOverStat:document.getElementById("game-over-stat"),gameStart:document.getElementById("game-start"),gameLoading:document.getElementById("game-loading"),scoreContainer:document.getElementById("score-container"),hud:document.getElementById("hud"),score:document.getElementById("score"),shop:document.getElementById("shop"),shop1:document.getElementById("shop-1"),shop2:document.getElementById("shop-2"),shop3:document.getElementById("shop-3"),shop4:document.getElementById("shop-4"),collectors:[document.getElementById("collected-1"),document.getElementById("collected-2"),document.getElementById("collected-3"),document.getElementById("collected-4"),document.getElementById("collected-5"),document.getElementById("collected-6"),document.getElementById("collected-7")],eventEmitter:new r,startfieldCanvas:s,startfieldCtx:i,sounds:new m(void 0),reset:()=>{h.numbers=[1,2,3,4,5,6,7,8,9,10,11,12,13],h.numbersSpeed=100,h.numbersBounce=1,h.handScores={FOAK:["FOAK",100],TOAK:["TOAK",30],TWOPAIR:["TWO PAIRS",10],PAIR:["PAIR",10],STRAIGHT:["STRAIGHT",75],COLOR:3},h.colors=["255, 61, 109","253, 140, 44","60, 252, 140"]},load:()=>{let t=localStorage.getItem("sf.itaddsup.data");return t?JSON.parse(t):{score:0,combo:0}},save:(t,e)=>{localStorage.setItem("sf.itaddsup.data",JSON.stringify({score:t,combo:e}))}};h.reset(),h.shop1.addEventListener("click",t=>{t.stopPropagation(),h.eventEmitter.emit("shopChoice","one")}),h.shop2.addEventListener("click",t=>{t.stopPropagation(),h.eventEmitter.emit("shopChoice","two")}),h.shop3.addEventListener("click",t=>{t.stopPropagation(),h.eventEmitter.emit("shopChoice","three")}),h.shop4.addEventListener("click",t=>{t.stopPropagation(),h.eventEmitter.emit("shopChoice","four")}),h.sounds.load(()=>{h.gameLoading.style.display="none";let t=h.load();h.gameStart.querySelector(".instruction").innerHTML=`<h2>Click to start</h2><p>High score: ${t.score}</p><p>Best combo: ${t.combo}</p>`,h.gameStart.style.display="block"}),document.querySelector("#game-start").addEventListener("click",t=>{t.stopPropagation();let e=new o(h);e.reset(),h.gameStart.style.display="none",h.game=e,e.draw(0)}),document.querySelector("#game-over").addEventListener("click",t=>{t.stopPropagation(),h.reset(),h.game.reset(),h.gameOver.style.display="none"});let a=()=>{h.ctx.canvas.width=window.innerWidth,h.ctx.canvas.height=window.innerHeight,h.width=e.canvas.width,h.height=e.canvas.height,h.scaleFactor=Math.min(e.canvas.width/800,e.canvas.height/600),h.ctx.font=(35*h.scaleFactor>>0)+"px monospace",h.ctx.textAlign="center",h.ctx.textBaseline="middle",h.startfieldCtx.canvas.width=window.innerWidth,h.startfieldCtx.canvas.height=window.innerHeight};window.addEventListener("resize",()=>a()),a()})();