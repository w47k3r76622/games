<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>Origin</title>
<style>*{margin:0;padding:0}html,body,#c,#p,#i{width:100%;height:100%;font-family:sans-serif}::selection{background:transparent}::-moz-selection{background:transparent}#c,#p{position:absolute;top:0;left:0}#p{display:table;letter-spacing:.1em;color:#fff;cursor:default}#i{display:table-cell;vertical-align:middle;text-align:center}#p h1{font-size:5em;text-shadow:0 0 10px #ff0028;font-family:Impact,sans-serif}#s{margin:1em auto;width:500px;color:#fff;border-collapse:collapse}#s th{font-size:2em}#s td{font-size:1.5em}#s tr{border-top:1px solid #fff}#s tr:first-child{border-top:0}#p a,#p span{display:block;text-decoration:none;font-weight:700;font-size:1.5em;line-height:1.5em;text-shadow:0 0 5px #ff0028}#p a{color:#ff0028;display:none}</style>
</head>
<body>
<canvas id="c"></canvas>

<div id="p">
	<div id="i">
		<h1>GAME OVER</h1>
		<table id="s"></table>
		<a id="tweet" target="_blank" href="https://twitter.com/intent/tweet?text=">TWEET THIS SCORE</a>
		<span>HIT SPACE TO PLAY AGAIN</span>
	</div>
</div>

<script>!function(){function t(t){return Array.prototype.slice.call(arguments,1).forEach(function(e){if(e)for(var i in e)t[i]=e[i]}),t}function e(){}function i(){return"rgb("+f(0,255)+","+f(0,255)+","+f(0,255)+")"}function n(t){document.documentElement.style.backgroundColor=t}function o(){var t=me.innerWidth,e=me.innerHeight;g=u(t,e),ye.width=t,ye.height=e,v=A(t/2),C=A(e/2)}function a(t,e){Ce.push([t,e]),Ce.sort(function(t,e){return t[0]>e[0]?-1:1}),Ce.length=u(Ce.length,le),m.set("scores",Ce)}function r(){for(var t="<tr><th></th><th>SCORE</th><th>BEST COMBO</th></tr>",e=0;le>e;e++){var i=Ce[e]||["-","-"];t+="<tr>",t+="<td>"+(e+1)+"</td>",t+="<td>"+i[0]+"</td>",t+="<td>"+i[1]+"</td>",t+="</tr>"}ve.innerHTML=t}function s(t){we.clearRect(0,0,ye.width,ye.height);var e=t-Ve;if(Ve=t,"game"===Te.get())1===f(1,Y)&&w.health>0&&(fe.add(new ce),ce.speed+=z,w.speed+=L),fe.updateAll(e,we);else{var i=h(c(t*P),0)*g*K*q,n=d(c(2*t*P))*g*K*q,o=h(i+n,q*g);we.outline({fillColor:B,shadowColor:b,shadowBlur:2*ne*g,path:function(t){t.arc(v,C,o,0,he,!1)}})}if("menu"===Te.get()){var a="ORIGIN";we.font=$*g+"px "+O,we.fillStyle=te,we.textAlign="center",we.textBaseline="middle",we.shadowBlur=5*_*g,we.shadowColor=ie,we.strokeStyle=ee,we.lineWidth=_*g,we.fillText(a,v,C),we.strokeText(a,v,C),we.font=oe*g+"px "+O,we.fillStyle=ae,we.textBaseline="top",we.fillText("hit space",v,C+$*g/2)}requestAnimationFrame(s)}!function(){for(var t=0,e=["ms","moz","webkit","o"],i=0;i<e.length&&!window.requestAnimationFrame;++i)window.requestAnimationFrame=window[e[i]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-t)),o=window.setTimeout(function(){e(i+n)},n);return t=i+n,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}();var l=function(){};l.extend=function(t){t||(t={});var e,i=this,n=t.initialize,o=function(){n?n.apply(this,arguments):i.apply(this,arguments)};for(e in i)"prototype"!=e&&(o[e]=i[e]);for(e in i.prototype)o.prototype[e]=i.prototype[e];for(e in t)o.prototype[e]=t[e];return o};var d,h,u,c,p,A,f;!function(t){d=function(){return t.abs.apply(t,arguments)},h=function(){return t.max.apply(t,arguments)},u=function(){return t.min.apply(t,arguments)},c=function(){return t.sin.apply(t,arguments)},p=function(){return t.cos.apply(t,arguments)},A=function(t){return t<<0},f=function(e,i){return null==e?t.random():A(t.random()*(i-e))+A(e)}}(Math);var m={get:function(t){return JSON.parse(localStorage.getItem(t))},set:function(t,e){return localStorage.setItem(t,JSON.stringify(e))}};t(CanvasRenderingContext2D.prototype,{outline:function(t){t.shadowBlur?(this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor):this.shadowBlur=0,t.fillColor&&(this.fillStyle=t.fillColor,this.beginPath(),t.path.call(this,this),this.fill()),t.outlineColor&&(this.strokeStyle=t.outlineColor,this.lineWidth=t.outlineWidth,this.beginPath(),t.path.call(this,this),this.stroke(),this.closePath())}}),window.AudioContext=window.AudioContext||window.webkitAudioContext;var y={muted:!0,isSupported:!!window.AudioContext};y.play=function(){var t,e=10,i={sine:0,square:1,sawtooth:2,triangle:3},n=[];return y.isSupported&&(t=new AudioContext),function(o){if(!y.muted)try{if("string"==typeof o){var a=n.filter(function(t){return 1==t.paused})[0];return a||(a=new Audio,n.push(a)),a.volume=1,a.src=o,a.play(),void 0}var r=t.createOscillator();r.connect(t.destination);var s=o.type||0,l=o.from||440,d=o.to||l,h=o.duration||100;"number"==typeof s?r.type=s:"string"==typeof s&&(r.type=i[s]),r.frequency.value=l,r.noteOn(0);var u=(d-l)*e/h,c=setInterval(function(){r.frequency.value+=u},e);setTimeout(function(){isPlaying=!1,r.noteOff(0),r.disconnect(),clearInterval(c)},h)}catch(p){}}}();var w,g,v,C,V=l.extend({initialize:function(){this.destroyed=!1},destroy:function(){this.destroyed=!0},update:e,draw:e}),T=l.extend({initialize:function(){this.entities=[],this.length=0},add:function(t){for(var e=0;e<this.length;e++)if(this.entities[e].destroyed)return this.entities[e]=t,void 0;this.entities.push(t),this.length++},empty:function(){this.entities.length=0,this.length=0},updateAll:function(t,e){for(var i=0;i<this.length;i++)this.entities[i].destroyed||(this.entities[i].update(t),this.entities[i].draw(e))}}),E="data:audio/mpeg;base64,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",x="#ffffff",S="#000000",B="#121011",I="#373536",b="rgb(255,0,40)",U=I,k=x,D=.03,Q=1e-4,z=3e-6,R=5e-4,W=.05,Y=100,q=.04,K=1.1,P=.001,H=1,F=3,M=.5,X=.25,N=.002,L=2e-5,Z=.1,O="Impact, sans-serif",J=.01,G=.005,j=1e-4,$=.3,_=.005,te="transparent",ee=b,ie=S,ne=.05,oe=.05,ae="red",re=37,se=39,le=10,de=Math.PI,he=2*de,ue=V.extend({initialize:function(){var e=this;V.prototype.initialize.apply(e,arguments),t(e,{health:H,holes:F,holePercentage:M,radius:X,direction:0,speed:N,rotationSpeed:0,combo:0,bestCombo:0,points:0,isDead:!1}),addEventListener("keydown",function(t){t.keyCode===re?e.rotationSpeed=-e.speed:t.keyCode===se&&(e.rotationSpeed=e.speed)}),addEventListener("keyup",function(t){t.keyCode===re?e.rotationSpeed=h(0,e.rotationSpeed):t.keyCode===se&&(e.rotationSpeed=u(0,e.rotationSpeed))})},dead:function(){this.isDead||(this.isDead=!0,a(this.points,this.bestCombo),setTimeout(function(){fe.add(new Ae("GAME OVER","255, 0, 0"))},1500),setTimeout(function(){Te.set("gameover")},3e3))},update:function(t){this.health<=0&&this.dead(),this.rotationSpeed&&(this.direction+=this.rotationSpeed*t)},draw:function(t){if(!(this.health<=0)){var e=he*(1-this.holePercentage)/this.holes,i=he*this.holePercentage/this.holes,n=this.radius*g;t.outline({outlineColor:U,outlineWidth:2,path:function(){t.arc(v,C,A(n),0,he,!1)}});for(var o=0;o<this.holes;o++){var a=this.direction+o*(e+i),r=a+e;t.outline({outlineColor:k,outlineWidth:n/15,shadowColor:k,shadowBlur:n/10,path:function(t){t.arc(v,C,A(n),a,r,!1)}})}var s=h(c(Date.now()*P),0)*g*K*q,l=d(c(2*Date.now()*P))*g*K*q,u=h(s+l,q*g);t.outline({fillColor:b,shadowColor:b,shadowBlur:2*q*g,path:function(t){t.moveTo(v,C),t.arc(v,C,A(u),0,he*w.health,!1)}})}}}),ce=V.extend({initialize:function(){V.prototype.initialize.apply(this,arguments),t(this,{direction:f()*he,distance:.75,orbit:0===f(0,Y),speed:ce.speed}),y.play({type:"sine",from:f(500,2e3),to:1,duration:300})},update:function(t){this.distance-=this.speed*t,this.orbit&&(this.direction=(this.direction-R*t)%he);var e=!1;if(this.distance<0)w.health-=W,e=!0,y.play(E),w.health>0&&fe.add(new Ae("OUCH","255, 0, 0")),w.combo=0;else if(d(this.distance-w.radius)<D&&w.health>0){for(var i=this.direction+w.direction;0>i;)i+=he;i%=he/w.holes,e=i>he*w.holePercentage/w.holes,e&&(w.combo++,w.combo>w.bestCombo&&(w.bestCombo=w.combo),0===w.combo%3&&fe.add(new Ae(w.combo+" COMBO","200, 0, 200")),y.play({type:3,from:200,to:1e3,duration:100}),y.play({type:0,from:1e3,to:200,duration:100}))}if(e){this.destroy();for(var n=(this.distance-D)*g,o=v+p(this.direction)*n,a=C-c(this.direction)*n,r=0;100>r;r++)fe.add(new pe({x:o,y:a,direction:this.direction+(f()-.5),speed:.05*f()+.1,age:500}));w.health>0&&w.points++}},draw:function(t){var e=D*g,n=v+p(this.direction)*this.distance*g,o=C-c(this.direction)*this.distance*g,a=i();t.outline({fillColor:a,shadowColor:a,shadowBlur:1.5*e,path:function(t){t.arc(A(n),A(o),A(e),0,he,!1)}})}}),pe=V.extend({initialize:function(e){var n=this;V.prototype.initialize.apply(n,arguments),t(this,{x:e.x||0,y:e.y||0,direction:e.direction||f()*he,speed:e.speed||1,color:e.color||i(),age:e.age||1e3});var o=e.age||1e3;setTimeout(function(){n.destroy()},o)},update:function(t){this.x+=p(this.direction)*this.speed*t,this.y-=c(this.direction)*this.speed*t},draw:function(t){var e=A(this.x),i=A(this.y);t.outline({fillColor:this.color,shadowColor:this.color,shadowBlur:10,path:function(t){t.arc(e,i,1,0,he,!1)}})}}),Ae=V.extend({initialize:function(e,i){var n=this;V.prototype.initialize.apply(n,arguments),t(this,{message:e,outlineColor:i||"255, 0, 0",alpha:0,fadeSpeed:G,offset:0}),setTimeout(function(){n.fadeSpeed*=-1},1e3),setTimeout(function(){n.destroy()},2e3)},update:function(t){this.alpha=u(this.alpha+t*this.fadeSpeed,1),this.offset+=t*j*g},draw:function(t){t.font=Z*g+"px "+O,t.fillStyle="rgba(255, 255, 255, "+this.alpha+")",t.textAlign="center",t.textBaseline="middle",t.shadowBlur=50,t.shadowColor="rgb("+this.outlineColor+")",t.strokeStyle="rgba("+this.outlineColor+", "+this.alpha+")",t.lineWidth=J*g,t.strokeText(this.message,v,C-this.offset),t.fillText(this.message,v,C-this.offset)}}),fe=new T,me=window,ye=document.getElementById("c"),we=ye.getContext("2d"),ge=document.getElementById("p"),ve=document.getElementById("s");me.onresize=o,o();var Ce=m.get("scores");null==Ce&&(Ce=[]),n(B);var Ve=new Date,Te=function(){var t;return{get:function(){return t},set:function(e){t=e,"game"===e?(y.play({type:"sine",from:200,to:1500,duration:2e3}),fe.empty(),w=new ue,fe.add(w),fe.add(new Ae("PROTECT THE HEART!","0, 128, 255")),setTimeout(function(){fe.add(new Ae("USE ARROW KEYS","0, 128, 255"))},1200),ce.speed=Q,ge.style.display="none"):"gameover"===e?(r(),ge.style.display="table"):"menu"===e&&(ge.style.display="none")}}}();Te.set("menu"),addEventListener("keyup",function(t){("menu"===Te.get()||"gameover"===Te.get())&&32===t.keyCode&&Te.set("game")}),s()}();</script>
</body>
</html>