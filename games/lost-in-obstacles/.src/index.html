<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Game</title><style>body{text-align:center}canvas{border:1px solid #000}</style></head><body><canvas></canvas><script>!function(){"use strict";function e(e){return Math.floor(e)}function n(e){return Math.random(e)}function t(e,n,t,r,f){Y.fillStyle=f,Y.fillRect(e,n,t,r)}function r(e,n,t,r,f){Y.fillStyle=f,Y.font=r+"px serif",Y.fillText(t,e,n)}function f(){t(0,0,I,S,T)}function o(){var e=0,n=0,r=x,f=N,o=-1;if(X===de)for(r/=D;++o<D;)t(e,n,r,f,o%2?M:O),e+=r;else for(f/=D;++o<D;)t(e,n,r,f,o%2?M:O),n+=f}function i(e){return!(!P[e]&&P[e-2]===D-1)&&(!(!P[e-2]&&P[e]===D-1)&&P[e]!==P[e-2])}function u(){for(var r,f,o,u=-1;++u<R;){for(o=2*u+1;;)if(P[o]=e(n()*D),i(o))break;X===de?(r=o*U,f=P[o]*$):(r=P[o]*U,f=o*$),t(r,f,U,$,O)}}function c(){t(q+z,A+B,F-2*z,G-2*B,H)}function a(){W=!1,j=!0,y(),l()}function s(e){13===e.keyCode&&(e.preventDefault(),removeEventListener("keyup",s,!1),j?v():C(1))}function v(){var n=e(I/4),f=e(S/8),o=e(10*I/100),i=o;j=!1,f+=i,t(0,0,I,S,J),r(n+e(n/2),f,be,o,K),f+=o/=2,[["↑","move UP"],["↓","move DOWN"],["←","move RIGHT"],["→","move LEFT"],["↵","to PLAY"]].forEach(function(e){r(n,f+=i,e[0]+"  -  "+e[1],o,K)}),r(n,f+=i+o,"Score: "+Q+" - Best: "+V,o,K),addEventListener("keyup",s,!1)}function l(){var n=e(I/4),f=e(S/2),o=e(10*I/100);Q>V&&(V=Q),t(0,0,I,S,J),r(n,f,"You lose",o,K),r(n,f+2*o,"↵  -  to CONTINUE",e(o/2),K),addEventListener("keyup",s,!1)}function d(e,n){t(e+Z,n+_,ee-2*Z,ne-2*_,te)}function k(r){var f,o,i,u,c=r%2?ye:he,s=2*r;X===de?(f=s*ee,o=e(n()*D)*ne):(f=e(n()*D)*ee,o=s*ne),re[s]={offsetX:f,offsetY:o},d(f,o),fe.push(setInterval(function(){W&&(i=f,u=o,X===de?c===he?o+ne<N?o+=ne:(o-=ne,c=ye):o?o-=ne:(o+=ne,c=he):c===he?f+ee<x?f+=ee:(f-=ee,c=ye):f?f-=ee:(f+=ee,c=he),re[s].offsetX=f,re[s].offsetY=o,p(s)?a():(t(i,u,ee,ne,O),d(f,o)))},oe))}function y(){for(var e=fe.length;e--;)clearInterval(fe.pop())}function h(){for(var e=0;++e<R;)k(e)}function b(){t(ie+ue,ce+ae,U-2*ue,$-2*ae,se)}function p(e){if(ve===e&&re[e])return X===de?re[e].offsetY===ce:re[e].offsetX===ie}function m(e){switch(e){case 37:if(le||ce===P[ve-1]*$)return ie-=U,ve-=1,!0;break;case 38:if(!le&&ce)return ce-=$,!0;break;case 39:if(le||ce===P[ve+1]*$)return ie+=U,ve+=1,!0;break;case 40:if(!le&&ce+$<N)return ce+=$,!0}return!1}function E(e){switch(e){case 37:if(!le&&ie)return ie-=U,!0;break;case 38:if(le||ie===P[ve-1]*U)return ce-=$,ve-=1,!0;break;case 39:if(!le&&ie+U<x)return ie+=U,!0;break;case 40:if(le||ie===P[ve+1]*U)return ce+=$,ve+=1,!0}return!1}function L(){var e,n;addEventListener("keyup",function(r){W&&/^3[789]$|^40$/.test(r.keyCode)&&(le=ve%2,e=ie,n=ce,(X===de?m(r.keyCode):E(r.keyCode))&&(p(ve)?a():(t(e,n,U,$,O),b(),ie===q&&ce===A&&C(++R))))},!1)}function w(t){var r=2*t+1,f=e(I/r),o=e(S/r);x=f*r,N=o*r,D=r,X=e(2*n())?de:ke,R=t,P=[],Q=t-1,G=o,z=e((F=f)/5),B=e(G/5),X===de?(q=x-f,A=e(n()*r)*G):(q=e(n()*r)*F,A=N-o),ie=0,ce=0,$=o,ue=e((U=f)/10),ae=e($/10),ve=0,le=!1,re=[],ne=o,Z=e((ee=f)/10),_=e(ne/10),(oe=1e3-50*t)<100&&(oe=100)}function C(e){y(),f(),w(e),o(),u(),c(),b(),h(),W=!0}function g(){var e=document.querySelector("canvas");I=500,S=500,T="#fff",M="blue",O="yellow",W=!1,j=!1,V=0,Q=0,H="green",J="#000",K="#fff",se="red",te="orange",fe=[],e.width=I,e.height=S,Y=e.getContext("2d")}var Y,I,S,T,x,N,X,D,M,O,P,R,U,$,q,z,A,B,F,G,H,W,j,J,K,Q,V,Z,_,ee,ne,te,re,fe,oe,ie,ue,ce,ae,se,ve,le,de="v",ke="h",ye="b",he="f",be="Lost";g(),L(),v()}();</script></body></html>