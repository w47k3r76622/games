function drawStruct(t,e,o,i,l){var r=(e+o+1)*tilewidth-x_offset,a=y_offset+(e-o)*(tilewidth/2);c.fillRect(r-tilewidth/2,a-d*height-tilewidth/2,30,30)}function drawButton(t,e,o,i,l,r){c2.fillStyle=r,c2.fillRect(e,o,50,50),c2.font="10px arial",c2.fillStyle="black",c2.fillText(l,e,o+20)}function drawPanel(t,e,o){if(null!=o){var i=entities[o[1]],l=o[0];-1!=l&&(3==l&&drawFurnace(t,e),6==l&&drawLaunch(t,e),text="Turn on","on"==i.components.status.value.top()&&(text="Turn off"),drawButton(c2,t+20,e+80,1,text,"white")),-1!=currentPanelButton&&(c2.fillStyle="rgb(0, 255, 0, 0.4)",c2.fillRect(t+20+currentPanelButton%4*60,e+20+60*Math.floor(currentPanelButton/4),50,50))}}function drawBuild(t,e){drawButton(c2,t+20,e+20,1,"Generator","white"),drawButton(c2,t+80,e+20,1,"Mine","white"),drawButton(c2,t+140,e+20,1,"Pump","white"),drawButton(c2,t+200,e+20,1,"Furnace","white"),drawButton(c2,t+260,e+20,1,"Platform","white"),drawButton(c2,t+320,e+20,1,"Fan","white"),drawButton(c2,t+20,e+80,1,"Launchpad","white"),-1!=currentButton&&currentButton<10&&(c2.fillStyle="rgb(0, 255, 0, 0.4)",c2.fillRect(t+20+currentButton%6*60,e+20+60*Math.floor(currentButton/6),50,50))}function drawFurnace(t,e){drawButton(c2,t+20,e+20,1,"Steel","white"),drawButton(c2,t+80,e+20,1,"Aluminum","white"),drawButton(c2,t+140,e+20,1,"Plastic","white"),drawButton(c2,t+200,e+20,1,"Dynamite","white")}function drawLaunch(t,e){drawButton(c2,t+20,e+20,1,"Build Rocket","white"),-1!=currentButton&&(c2.fillStyle="rgb(0, 255, 0, 0.4)",c2.fillRect(t+20+currentButton%6*60,e+20+60*Math.floor(currentButton/6),50,50))}function drawPause(t){t&&(ol.fillStyle="rgb(0, 0, 0, 0.5)",ol.fillRect(0,0,overlay.width,overlay.height),ol.font="50px arial",ol.fillStyle="white",ol.fillText("PAUSED",overlay.width/2-100,overlay.height/2))}function drawEnd(t){var e="WITH YOUR REMOTE CONTROL SKILLS AND RESOURCEFULNESS, WE HAVE ESCAPED!!";"water"===t&&(e="YOU RAN OUT OF WATER AND ARE THEREFORE STRANDED FOREVER ON THIS DREADED PLANET..."),"drown"===t&&(e="THE WATER HAS SWALLOWED UP OUR BUILDINGS, ALONG WITH OUR HOPES OF A PROMOTION..."),ol.fillStyle="rgb(0, 0, 0, 0.3)",ol.fillRect(0,0,overlay.width,overlay.height),ol.font="30px arial",ol.fillStyle="white";var o=3*overlay.width/4;const i=e.split(" ");drawWords(ol,e,overlay.width/4-100,150,o,50,10,i)}function drawMenu(){ol.clearRect(0,0,overlay.width,overlay.height),ol.fillStyle="black",ol.fillRect(0,0,overlay.width,overlay.height),ol.strokeStyle="white",ol.lineWidth=5,ol.strokeRect(0,0,overlay.width,overlay.height),ol.font="50px arial",ol.fillStyle="white",ol.fillText("ESCAPE FROM XGS-57",overlay.width/2-280,100),new Button(overlay,ol,{x:overlay.width/2-150,y:200,width:300,height:100},"PLAY",function(){state="play",ol.clearRect(0,0,overlay.width,overlay.height)}).draw(),new Button(overlay,ol,{x:overlay.width/2-150,y:400,width:300,height:100},"INSTRUCTIONS",function(){drawIns(0)}).draw()}function Button(t,e,o,i,l){this.c=e,this.rect=o,this.text=i,this.can=t,this.can.addEventListener("click",function(e){inside(getMousePos(t,e),o)&&"menu"===state&&l.call()},!1)}function getMousePos(t,e){var o=t.getBoundingClientRect();return{x:e.clientX-o.left,y:e.clientY-o.top}}function inside(t,e){return t.x>e.x&&t.x<e.x+e.width&&t.y<e.y+e.height&&t.y>e.y}function message(t){c1.font="36pt arial",c1.fillStyle="red",c1.fillText(t,layer1.width/2-250,layer1.height/2),message_countdown=1}function drawIns(t){ol.clearRect(0,0,overlay.width,overlay.height),0==t&&render(1),ol.fillStyle="rgb(255, 255, 0, 0.65)";var e=overlay.width/2;ol.fillRect(e-10,70,overlay.width/2,overlay.height/2+70),ol.fillStyle="black",ol.font="12pt courier new";var o=overlay.width/2;const i=screens[t].split(" ");(drawWords(ol,screens[t],e,120,o,20,10,i),ol.fillStyle="white",t<6)?new Button(overlay,ol,{x:overlay.width-140,y:overlay.height-220,width:120,height:60},"NEXT",function(){drawIns(t+1)}).draw():new Button(overlay,ol,{x:overlay.width-140,y:overlay.height-220,width:120,height:60},"PLAY",function(){state="play",ol.clearRect(0,0,overlay.width,overlay.height)}).draw()}Button.prototype.draw=function(){this.c.strokeStyle="white",this.c.strokeRect(this.rect.x,this.rect.y,this.rect.width,this.rect.height),this.c.font="30px arial",this.c.fillText(this.text,this.rect.x+this.rect.width/2-9*this.text.length,this.rect.y+this.rect.height/2+10)};var screens=["Well...you did it. You managed to crash the spaceship in the safest, most boring part of the galaxy. Now we're on this godforsaken planet XGS-57 and the whole delivery's ruined! Luckily we've still got a generator and a pump left over. We have to remote control everything from here and rebuild the spaceship so we can make our delivery at Rigel-7!","The top bar indicates your raw resources: ore, water, and power. Ore is needed to make essential materials for space flight at the furnace. Water is gotten from the pumps, if we run out of water all our buildings will shut down. Power comes from the generators and powers all the buildings. If there's not enough power, then the building with the highest power consumption will shut down until power is restored. (Note: power isn't stored in chunks like water, it measures the current!)Inactive buildings are colored in red. ","Click on the bottom left panel to construct buildings. Most of these buildings will need to be built on FLAT land. If that's not possible you may need to make dynamites to level some hills. The pump however is 1x2 tiles and must have one tile on water and one on land. Platforms are an extension of land and must be placed next to the shore. You can hover your cursor over each button to see the specs of that building. ","Now you need to be aware that we are trapped on a water planet, with gigantic icebergs. This means that in order to make more land, we have to build FANS to drop the water level down. But be careful, generators and furnaces generate a lot of heat which will cause the ice caps to melt. Then the water levels will go up again! Make sure the temperature on the top-right corner doesn't exceed 5 degrees Celsius. You can also monitor the water level in the same corner of your screen. ","The most important thing is MATERIALS! In order to manufacture materials you will need a furnace and some raw ore. And in order to get ore you have to build mines on the land. Materials are needed to build pretty much EVERYTHING! You can monitor them on the second top bar. In order to access what buildings may provide, simply click on the building you want to use. For example if you want to produce some plastic, click on any furnace and you will find what you need in the BUILDING PANEL. Note that you always have the option in the building panel to shut down a building voluntary (maybe you are emitting too much carbon?).","Some important controls you might like to know: WASD to move the camera around, Q and E to rotate perspectives. P to take a quick breather and pause. X to rotate a building you are about to place.C to cancel something you're about to build. Everything else is done by the mouse! ","OK we gotta get moving if we want to get out of here! Our goal is to build a launchpad, and when that's ready we build a rocket on top of it and we are good to go! But be warned, if the water levels swallow all our buildings then it's all over!"];function wrapText(t,e,o,i,l,r,a){return e.split(" ")}function drawWords(t,e,o,i,l,r,a,n){for(var h="",u=0;u<n.length;u++){var c=h+n[u]+" ";t.measureText(c).width>l&&u>0?(t.fillText(h,o,i),h=n[u]+" ",i+=r):h=c}t.fillText(h,o,i)}
