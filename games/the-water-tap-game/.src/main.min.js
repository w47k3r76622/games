var a={};addEventListener("keydown",function(b){a[b.keyCode]=!0},!1);addEventListener("keyup",function(b){delete a[b.keyCode]},!1);var d,e,f,g,h,k,l,m,n,p,q,r,s,t,u,v=0,w=0,x,y=0;
function z(){d=document.getElementById("game").firstElementChild;e=d.getContext("2d");g=h=k=f=l=m=0;p=0.7*Math.random()+0.2;q=0.7*Math.random()+0.2;r=0.5<Math.random();s=0.5<Math.random();t=15;u=0.1;n=!1;d.addEventListener("mousedown",function(b){B(b)},!1);d.addEventListener("mouseup",function(b){B(b)},!1);d.addEventListener("mousemove",function(b){B(b)},!1);d.addEventListener("touchstart",function(b){B(b)},!1);d.addEventListener("touchend",function(b){B(b)},!1);d.addEventListener("touchleave",function(b){B(b)},
!1);d.addEventListener("touchmove",function(b){B(b)},!1)}function C(b,c){b?(c+=0.01,0.8<c?c=0.8:0):(c-=0.01,0>c?c=0:0);return c}
function D(b,c){if(0===f){if(b&&s&&c||!b&&!s&&c)r?(p=C(!0,p),0.8>p&&(b?g+=0.1:g-=0.1)):(q=C(!0,q),0.8>q&&(b?g+=0.1:g-=0.1));if(b&&!s&&c||!b&&s&&c)r?(p=C(!1,p),0<p&&(b?g+=0.1:g-=0.1)):(q=C(!1,q),0<q&&(b?g+=0.1:g-=0.1));if(b&&s&&!c||!b&&!s&&!c)r?(q=C(!0,q),0.8>q&&(b?h+=0.1:h-=0.1)):(p=C(!0,p),0.8>p&&(b?h+=0.1:h-=0.1));if(b&&!s&&!c||!b&&s&&!c)r?(q=C(!1,q),0<q&&(b?h+=0.1:h-=0.1)):(p=C(!1,p),0<p&&(b?h+=0.1:h-=0.1))}}
function B(b){b.preventDefault();var c=b.changedTouches;if(0==f)switch(b.type){case "mousedown":case "touchstart":n=!0;c?(l=c[0].pageX,m=c[0].pageY):(l=b.pageX,m=b.pageY);break;case "mousemove":case "touchmove":if(n){var A;c?A=m-c[0].pageY:A=m-b.pageY;5<Math.abs(A)&&(160<l?0<A?D(!0,!1):D(!1,!1):0<A?D(!0,!0):D(!1,!0),c?m=c[0].pageY:b.pageY)}break;case "mouseup":case "touchend":case "touchleave":n=!1}else if(-1==f)switch(b.type){case "mousedown":case "touchstart":f=0}else if(2==f||4==f)switch(b.type){case "mousedown":case "touchstart":z(),
w=0,2==f?f=0:f=-1}}
function E(b,c){e.translate(b,130);e.rotate(c);e.translate(-5,-13);e.beginPath();e.moveTo(0,0);e.lineTo(0,-24);e.quadraticCurveTo(-5,-37,5,-39);e.quadraticCurveTo(15,-37,10,-24);e.lineTo(10,0);e.lineTo(18,8);e.lineTo(42,8);e.quadraticCurveTo(55,3,57,13);e.quadraticCurveTo(55,23,42,18);e.lineTo(18,18);e.lineTo(10,26);e.lineTo(10,50);e.quadraticCurveTo(15,63,5,65);e.quadraticCurveTo(-5,63,0,50);e.lineTo(0,26);e.lineTo(-8,18);e.lineTo(-32,18);e.quadraticCurveTo(-45,23,-47,13);e.quadraticCurveTo(-45,3,
-32,8);e.lineTo(-8,8);e.closePath();e.stroke();e.translate(5,13);e.rotate(-c);e.translate(-b,-130)}
function F(){e.shadowBlur=2;e.shadowColor="#606060";e.shadowBlur=1;e.fillStyle="#E7D4C3";e.strokeStyle="#E7D4C3";e.fillRect(80,120,160,3);e.beginPath();e.lineWidth=3;e.moveTo(80,150);e.quadraticCurveTo(150,170,145,270);e.quadraticCurveTo(160,300,175,270);e.quadraticCurveTo(170,170,240,150);e.stroke();E(70,g);E(250,h);e.font="18px sans-serif";e.fillStyle="#212121";e.fillText("The Water Tap Game",60,20)}
function G(){var b=Math.floor(Math.random()*t+5);0==t?b=0:0;e.fillStyle="#14AFF1";e.fillRect(160-b/2,285,b,250);e.globalAlpha=p;e.fillStyle="#F15614";e.fillRect(160-b/2,285,b,250);e.globalAlpha=q;e.fillStyle="#005577";e.fillRect(160-b/2,285,b,250);e.globalAlpha=1;e.shadowBlur=2}
function H(){0==f?(a[37]&&D(!0,!0),a[39]&&D(!1,!0),a[38]&&D(!0,!1),a[40]&&D(!1,!1),480<k?f=2:0!=t?k+=u*t:0):1==f&&(v++,y+=4,5<=Math.floor(v/60)&&(y=v=0,10==w?f=4:(g=h=k=f=l=m=0,p=0.7*Math.random()+0.2,q=0.7*Math.random()+0.2,r=0.5<Math.random(),s=0.5<Math.random(),t=15,u+=0.01,n=!1)));t=9*(p+q);0==f&&0==t&&(w++,f=1);e.fillStyle="#C3D9E7";e.fillRect(0,0,320,480);if(0==f)e.shadowBlur=10,e.shadowColor="#212121",e.fillStyle="#000088",e.fillRect(0,480-k,320,480),e.shadowBlur=2,e.shadowColor="#606060",
G(),F();else if(-1==f)F(),e.font="18px sans-serif",e.fillStyle="#000088",e.fillText("Stop the water before it fills the screen",5,220),e.fillRect(7,230,305,10),e.fillStyle="#212121",e.fillText("Tap anywhere to start",60,260);else if(1==f){e.fillStyle="#212121";e.font="18px sans-serif";e.fillText("   Prepare Yourself!   ",60,260);e.fillText("        Round:    "+w+"    ",60,200);e.font="50px sans-serif";var b=Math.floor(5-v/60);x!=b&&(y=0,x=b);e.fillText(Math.floor(5-v/60),135,550-y)}else 2==f?(F(),
e.font="18px sans-serif",e.fillStyle="#000088",e.fillText("   You could stop the water "+w+" time"+(1<w?"s":""),5,220),e.fillRect(7,230,305,10),e.fillStyle="#212121",e.fillText("Tap anywhere to restart",58,260)):4==f&&(G(),F(),e.fillStyle="#E7D4C3",e.strokeStyle="#E7D4C3",e.beginPath(),e.moveTo(135,270),e.quadraticCurveTo(160,330,185,270),e.closePath(),e.fill(),e.arc(70,130,53,0,2*Math.PI,!1),e.fill(),e.beginPath(),e.arc(250,130,53,0,2*Math.PI,!1),e.fill(),e.fillRect(159,290,3,10),e.font="50px sans-serif",
e.fillStyle="#000088",e.fillText("YES",105,220),e.fillRect(7,230,305,10),e.font="18px sans-serif",e.fillStyle="#212121",e.fillText("This looks like a dick!",58,260));requestAnimationFrame(H)}z();f=-1;requestAnimationFrame(H);
