<style>body {display: block; margin:0;background:black;}</style>
<body>
<canvas width="128" height="128" style="display:block;height:100%;margin: auto auto;image-rendering:pixelated;image-rendering:crisp-edges;"></canvas>
<script>'use strict';let b=Math.floor,aa=Math.abs,ba=Math.round,h=Math.random,m=null;addEventListener("gamepadconnected",c=>{m=navigator.getGamepads()[c.J.index]});addEventListener("gamepaddisconnected",()=>{m=null});let ca=new AudioContext,da=ca.createOscillator(),ea=ca.createGain();da.type="square";da.connect(ea);ea.gain.value=0;da.start();ea.connect(ca.destination);
let n=c=>{let d=c[0];da.frequency.setValueAtTime(d[0],ca.currentTime);ea.gain.value=.04;setTimeout(()=>{ea.gain.value=0;da.frequency.value=0;1<c.length&&n(c.slice(1))},d[1]+5)},p=[[110,35],[220,25],[180,15],[440,25],[220,25],[110,25],[55,50],[0,50],[55,75]],t=[[440,15],[220,15],[110,15]],fa=[[0,10],[440,10],[680,10]],ha=[[523,30],[466,30],[311,30],[261,30],[523,30],[1047,30]],ia=[],ja=document.querySelector("canvas"),v=ja.getContext("2d"),ka=document.createElement("canvas"),la=ka.getContext("2d"),
ma=0,na=0,qa=1E3/60;new ImageData(128,128);let ra=new Image;new Image;
let w=new Image,x=0,sa=0,A=new Uint8Array(256),ta=[[22,33,26],[127,6,34],[214,36,17],[255,132,38],[255,209,0],[250,253,255],[255,128,164],[255,38,116],[148,33,106],[67,0,103],[35,73,117],[104,174,212],[191,255,60],[16,210,117],[0,120,153],[0,0,0]],ua=[0,0,128,128],C=0,D=0,va=[[55,56,71,72,87,88,103,104],[57,58,73,74,89,90,105,106],[91,92,93,94,107,108,109,110],[119,120,121,122,135,136,137,138],[123,124,125,126,139,140,141,142]],G=(c,d=8,f=8)=>({frames:c,H:c.length,width:d,height:f}),wa=G([214],16),
xa=G([15],8,12),ya=[G([251]),G([255])],za=G([165]),Aa=G([198]),H=[],Ba=G([112]),Ca=G([114]),Da=G([115,116,133,116]),Ea=G([75],24),Fa=G([169]),Ga=G([160,161]),Ha=0,Ia=G([14],8,16),Ja=G([118]),Ka=G([117]),La=G([21]),Ma=G([22,40]),Na=[G([5]),G([24]),G([6]),G([25]),G([23])],Oa=G([224],40),Pa=G([240],32),Qa=[G([200]),G([201]),G([216]),G([217])],Ra=G([131],16),Sa=G([205],24,12),Ua=G([202],24,12),Va=G([172],8,16),Wa=G([173],12,16),Xa=G([183]),Ya=G([168]),Za=G([147],16,16),$a=[G([162]),G([146]),G([130])],
ab=G([192],16,16),bb=G([179,180]),cb=G([196,197]),db=G([181,182]),eb=[G([0]),G([16]),G([1])],J=~~sessionStorage.getItem("px"),K=~~sessionStorage.getItem("py"),fb=!0,gb=[15,12,13,2,11,7,1,14,8,6],jb=0,kb=[],lb=G([32,33,34]),mb=[G([46]),G([47])],nb=G([7,8,9]),ob=G([35,36,37,38,39]),pb=G([17]),L=[],qb=0,rb=1;var sb=[0,0,0,0],tb=[0,0],ub=[0,0,0,0];
let vb=G([2]),wb=G([18,19]),xb=G([20]),yb=G([3,4]),zb=G([9,8,7]),Ab=~~sessionStorage.getItem("pwep")||0,N=[~~sessionStorage.getItem("boss0"),~~sessionStorage.getItem("boss1"),~~sessionStorage.getItem("boss2"),~~sessionStorage.getItem("boss3"),~~sessionStorage.getItem("boss4")],Bb=[[[220,10]],[[550,15],[440,30],[350,20]],[[220,10],[320,10]],[[440,5],[330,5],[220,5],[110,10]],[[880,5],[440,5],[220,5],[110,5],[55,5]]],Cb=[[-1,0],[-.7,-.7],[0,-1],[.7,-.7],[1,0],[.7,.7],[0,1],[-.7,.7]],Fb=[(c,d,f)=>L.push({f:vb,
x:c,y:d,m:f,effect:null,l:1}),(c,d,f)=>L.push({f:wb,x:c,y:d,m:f,effect:null,l:2}),(c,d,f)=>L.push({f:xb,x:c,y:d,m:f,effect:Db,l:3}),(c,d,f)=>L.push({f:yb,x:c,y:d,m:f,effect:Eb,l:4}),(c,d,f)=>L.push({f:zb,x:c,y:d,m:f,effect:Db,l:5})],Gb=0,Hb=(c,d)=>0==Gb++%2&&kb.push({f:lb,x:c,y:d,w:8,m:0,A:0}),Ib=(c,d)=>0==Gb++%4&&kb.push({f:mb[x%2?0:1],x:c,y:d,w:30,m:0,A:-.15}),Db=(c,d)=>kb.push({f:nb,x:c,y:d,w:12,m:0,A:0}),Eb=(c,d)=>kb.push({f:ob,x:c,y:d,w:12,m:0,A:0}),Jb=(c,d)=>{Cb.forEach(f=>kb.push({f:pb,x:c,
y:d,w:50,m:f[0],A:f[1]}))},Mb=(c,d)=>{Cb.forEach(f=>kb.push({f:nb,x:c,y:d,w:200,m:f[0],A:f[1]}))},O=(c,d)=>{[[c,d],[c+16,d],[c+8,d+8],[c,d+16],[c+16,d+16]].forEach(f=>Eb(...f))},Nb=G([28]),Ob=G([26]),Pb=[],Qb=[[(c,d)=>[c,d,!1,P[3],270,1,0],(c,d)=>[c,d,!1,P[4],180,0,1],(c,d)=>[c,d,!1,P[5],0,0,0]],[(c,d)=>[c,d,!1,P[0],180,0,1],(c,d)=>[c,d,!1,P[1],180,0,1],(c,d)=>[c,d,!1,P[2],180,0,1],(c,d)=>[c,d,!1,P[4],180,0,1]],[(c,d)=>[c,d,!1,P[0],90,-1,0],(c,d)=>[c,d,!1,P[2],90,-1,0],(c,d)=>[c,d,!1,P[3],90,-1,0]],
[(c,d)=>[c,d,!1,P[0],0,0,-1],(c,d)=>[c,d,!1,P[1],0,0,-1],(c,d)=>[c,d,!1,P[2],0,0,-1],(c,d)=>[c,d,!1,P[4],0,0,-1]],[(c,d)=>[c,d,!1,P[0],270,1,0],(c,d)=>[c,d,!1,P[2],270,0,-1],(c,d)=>[c,d,!1,P[3],270,1,-1]]],Rb=[],Sb=[],Tb=[],Ub=[],Q=null,Vb=0,Wb=G([96]),Xb=G([144]),Yb=G([48,64]),Zb=G([81]),$b=G([100]),ac=G([86]),bc=G([85]),cc=G([101]),P=[(c,d,f=0,r=0,l=0)=>Sb.push({f:Wb,x:c,y:d,dir:f,g:r,h:l,a:3,type:0}),(c,d,f=0,r=0,l=0)=>Sb.push({f:Xb,x:c,y:d,dir:f,g:r,h:l,a:4,type:1}),(c,d,f=0,r=0,l=0)=>Sb.push({f:ac,
x:c,y:d,dir:f,g:r,h:l,a:4,type:2}),(c,d,f=0,r=0,l=0)=>Sb.push({f:512>d?Zb:$b,x:c,y:d,dir:f,g:r,h:l,a:5,type:3}),(c,d,f=0,r=0,l=0)=>Sb.push({f:512>d?Zb:$b,x:c,y:d,dir:f,g:r,h:l,a:5,type:4}),(c,d,f=0,r=0,l=0)=>Sb.push({f:512>d?bc:cc,x:c,y:d,dir:f,g:r,h:l,a:2,type:5})],S=(c,d,f,r,l,y=Yb)=>{n([[110,20]]);Tb.push({I:y,x:c,y:d,type:f,g:r,h:l,l:1})},dc=[],ec=G([78],16),fc=G([10],16),gc=[G([60]),G([61]),G([62]),G([63])],hc=G([170],16,16),ic=G([185]),jc=G([149],48),kc=G([230],72),lc=!1,mc=0,T=6,nc=6,oc=0,
pc=!1,U=0,V=0,W=0,X=0,qc=50,rc=0,sc=0,tc=0,uc=c=>{let d=[],f=0;for(let r=0;r<c;r++,f++)d[f]=f;return d},vc=(c,d,f)=>{let r=0;for(let l of ta){if(l[0]===c&&l[1]===d&&l[2]===f)return r;r++}return 15},Y=(c,d,f,r=0,l=!1,y=0)=>{let z=c.frames[x%c.H];[d,f]=[b(d),b(f)];let [B,M]=[z%16,b(z/16)];y--&&x%-3||(v.save(),v.translate(d+c.width/2,f+c.height/2),d=2*Math.PI-Math.PI/180*r,l&&v.scale(-1,1),v.rotate(d),v.drawImage(ra,8*B,8*M,c.width,c.height,-c.width/2,-c.height/2,c.width,c.height),v.restore())},wc=(c,
d,f)=>{c=c[(d+f)%c.length];c=[c%16,b(c/16)];let [r,l]=c;v.drawImage(ra,8*r,8*l,8,8,8*d,8*f,8,8)},xc=(c,d)=>{c=128*d+c;d=0;128<c&&5===w[c-128]&&(d=1)||5===w[c-1]&&(d=4);16256>c&&5===w[c+128]&&(d=3)||5===w[c+1]&&(d=2);return d},yc=(c,d)=>{var f=V/(1.5*Q.j);f*=f;return(1-f)*c+f*d},zc=()=>{var c;ka.width=ka.height=128;for(c in sb)sb[c]=~~sessionStorage.getItem(`hp${c}`)||0;for(c in tb)tb[c]=~~sessionStorage.getItem(`suit${c}`)||0;for(c in ub)ub[c]=~~sessionStorage.getItem(`wep${c}`)||0;for(c=0;4>c;c++)ia.push([131,
150],[262,150],[277,150],[139,150]);ia.push([131,50],[66,20],[33,10],[16,5]);for(let d in w){let [f,r]=[d%128,b(d/128)];c=w[128*r+f];13===c&&([J,K]=[8*f,8*r],[C,D]=[b(f/16),b(r/16)]);if(2===c){let l=xc(f,r);Rb.push(Qb[l][b(Math.random()*Qb[l].length)](8*f,8*r))}7===c&&dc.push({x:8*f,y:8*r});1===c&&Ub.push({x:8*f,y:8*r,type:f%4})}sessionStorage.getItem("px")?(J=~~sessionStorage.getItem("px"),K=~~sessionStorage.getItem("py")):(sessionStorage.setItem("px",J),sessionStorage.setItem("py",K));T=nc=6+sb.reduce((d,
f)=>d+2*f);qb=tb.reduce((d,f)=>d+f);Ab=ub.reduce((d,f)=>d+f);rb-=.25*qb},Z=(c,d,f,r,l,y,z,B)=>!(c+f<l||c>l+z||d+r<y||d>y+B),Ac=(c,d,f=c,r=d)=>{c=b(c/8);d=b(d/8);f=b(f/8);r=b(r/8);r=w[128*r+f];return 1^(gb.includes(w[128*d+c])&&gb.includes(r))},Bc=c=>{c.forEach(d=>Y(...d))},Cc=c=>{let d={b:0,c:0,j:0,s:0,B:0,x:0,y:0};1===c&&(d.a=20,d.C=[],d.G=[],d.u=1);2===c&&(d.a=20,d.open=0,d.u=2);3===c&&(d.a=20,d.K=0,d.u=2);4===c&&(d.a=20,d.v=4);return d};
ra.onload=()=>{v.clearRect(...ua);v.save();v.drawImage(ra,0,128,128,128,...ua);let c=v.getImageData(...ua),d=[];v.restore();for(let f=0;f<c.data.length;f+=4)d.push(vc(...c.data.slice(f,f+4)));w=d;zc();ma=window.performance.now();Dc();w.src="./map.png"};ra.src="./sprsheet4.png";onkeydown=c=>A[c.keyCode]=1;onkeyup=c=>A[c.keyCode]=0;
let Dc=()=>{let c=window.performance.now();var d=c-ma;1E3<d&&(d=qa);for(na+=d;na>qa;){v.clearRect(...ua);var f=0,r=f=d=0,l=0;let e,E,k=16*C,q=16*D;if(tc){for(e=0;16>e;e++)for(E=0;7>E;E++)Y(Qa[b(4*h())%4],8*e,8*E,90*b(4*h()),.5<h());Y(jc,40,64);Y(kc,28,72);Y(hc,112,112);Y(ic,100,120);return}var y=(a,g,u=1)=>[(a-k)*u,(g-q)*u];for(var z=q;z<q+16;z++)for(var B=k;B<k+16;B++){var M=w[128*z+B];3==C&&0==D&&(15===M&&4>z&&Y(Qa[(z&B)%4],8*B-8*k,8*z-8*q),rc&&Z(J,K,8,8,88+8*k,48+8*q,16,8)&&(tc=1),Y(Ra,88,48,0,
1));5===M&&(l=0,4>C&&4>D&&(l=1),3<C&&4>D&&(l=3),4>C&&3<D&&(l=2),3<C&&3<D&&(l=4),3<=C&&4>=C&&3<=D&&4>=D&&(l=0),d|=3<D&&0!=l,wc(va[l],...y(B,z)));11===M&&(Y(G([49,50,51],8,8),...y(B,z,8),0),r=8*(z-q)+4,d=!0);if(12===M){let [a,g]=y(B,z,8);Y(Da,a,g);Z(J,K,8,8,a+8*k,g+8*q,8,8)&&(Ha||(n([[329,50],[440,50],[659,50]]),sessionStorage.setItem("px",J),sessionStorage.setItem("py",K),Jb(a,g),T=nc),Ha=60)}if(14===M&&!sb[l-1]){let [a,g]=y(B,z,8);Y(Ma,a,g);Y(La,a,g);Z(J,K,8,8,a+8*k,g+8*q,8,8)&&(Jb(a,g),Mb(a,g),n(ha),
sb[l-1]=1,sessionStorage.setItem(`hp${l-1}`,1),nc=T=nc+2)}if(8===M&&!tb[64>B?0:1]){let [a,g]=y(B,z,8);Y(Ma,a,g);Y(Na[0],a,g);Z(J,K,8,8,a+8*k,g+8*q,8,8)&&(Jb(a,g),Mb(a,g),n(ha),tb[64>B?0:1]=1,sessionStorage.setItem(`suit${64>B?0:1}`,1),qb++,rb-=.25)}if(6===M&&!ub[l-1]){let [a,g]=y(B,z,8);Y(Ma,a,g);Y(Na[l],a,g);Z(J,K,8,8,a+8*k,g+8*q,8,8)&&(Jb(a,g),Mb(a,g),n(ha),n(p),ub[l-1]=1,sessionStorage.setItem(`wep${l-1}`,1),Ab++)}if(9===M&&!f&&0<qc){let [a,g]=y(B,z,8);if(4==N.reduce((u,F)=>u+F)){for(e of L)Z(a-
1+8*k,g-2+8*q,16,24,e.x,e.y,8,8)&&(e.x=-100,n(p),U=4,qc-=e.l);0>=qc&&(n(ia),n(p),n(ha),U=8,Mb(a+4,g+6),O(a-8,g-8),O(a+16,g-8),O(a-8,g+24),O(a+16,g+24),rc=1);Bc([[wa,a,g-16],[wa,a,g+24,180,!0],[xa,a,g-2],[xa,a+8,g-2,0,1],[xa,a,g+10,180,1],[xa,a+8,g+10,180,0],[ya[N[1]],a-8,g-16],[ya[N[2]],a+16,g-16],[ya[N[3]],a+16,g+24],[ya[N[4]],a-8,g+24],[Ba,a+4,g-8],[Ba,a+4,g+16,180,!0],[Ca,a+4,g-16],[Ca,a+4,g+24,180,!0]])}else Bc([[wa,a,g],[wa,a,g+8,180,!0],[ya[N[1]],a-8,g-16],[ya[N[2]],a+16,g-16],[ya[N[3]],a+16,
g+24],[ya[N[4]],a-8,g+24],[Ba,a+4,g-8],[Ba,a+4,g+16,180,!0],[Ca,a+4,g-16],[Ca,a+4,g+24,180,!0]]);f=!0}}rc&&(Y(Pa,48,120),20>sc?sc++:(U=1+b(3*h()),sc=0,n(t),n(t),d=!0,Eb(128*h(),128*h()),O(128*h(),128*h())));C=b(J/8/16);D=b(K/8/16);let R=(a,g)=>{oc||(oc=g,T-=a*rb,n(t),U=2)},oa=(a,g)=>{[a,g]=[a-8*k,g-8*q];return 0>a||127<a||0>g||127<g},pa=(a,g,u=8,F=8,I=null)=>{for(e of L)Z(e.x+2,e.y+2,4,4,a,g,u,F)&&I&&I(e)};kb=kb.filter(a=>{Y(a.f,a.x,a.y);--a.w;a.x+=a.m;a.y+=a.A;return 0<a.w});L=L.filter(a=>{Y(a.f,
a.x-8*k,a.y-8*q,0,0>a.m);a.x+=a.m;let g=!0;Ac(a.x+2,a.y+2,a.x+6,a.y+6)&&(a.effect&&a.effect(a.x-8*k,a.y-8*q),n([[100,20]]),g=!1);return g^=oa(a.x,a.y)});Ub=Ub.filter(a=>{let g=!0;Y(Ia,a.x-8*k,a.y-8*q);1==a.type&&Y(Ka,a.x-8*k,a.y+4-8*q);2==a.type&&Y(Ja,a.x-8*k,a.y+4-8*q);Z(a.x,a.y,8,16,J,K,8,8)&&(J=a.x+4>J?a.x-8:a.x+8);pa(a.x,a.y,8,16,u=>{u.x=-1E3;u.l-1>=a.type+1?(n(p),O(a.x-8-8*k,a.y-4-8*q),g=!1):n(fa)});return g});let Kb=[];Tb=Tb.filter(a=>{Y(a.I,a.x-8*k,a.y-8*q);let g=!0,u=(F,I,Ta,Ec,Lb=1)=>{let [hb,
ib]=[Ta-F,Ec-I];F=Math.sqrt(hb*hb+ib*ib);return[hb/F*Lb,ib/F*Lb]};1==a.type&&!a.F&&(a.F=a.g=J<a.x?-1:1);2==a.type&&(!a.D&&(a.D=8*q+16+b(64*h())),a.y>a.D&&(a.y-=.5),a.y<=a.D&&(g=0));3==a.type&&!a.F&&(a.F=[a.g,a.h]=u(a.x,a.y,J,K,.6));a.x+=a.g;a.y+=a.h;2==a.type&&0==g&&(Cb.forEach(F=>Kb.push([a.x,a.y,0,...F])),g=0);Ac(a.x+2,a.y+2,a.x+6,a.y+6)&&(g=3==a.type?1:0);oa(a.x,a.y)&&(g=0);return g});for(e of Kb)S(...e);for(let a of Rb){f=a;if(y=!oa(a[0],a[1]))a[3]&&!a[2]&&a[3](a[0],a[1],a[4],a[5],a[6]),y=!0;
f[2]=y}Sb=Sb.filter(a=>{if(oa(a.x,a.y))return!1;Y(a.f,a.x-8*k,a.y-8*q,a.dir);mc%60||0!=a.type||S(a.x,a.y,a.type,a.g,a.h);mc%80||1!=a.type||S(a.x,a.y,a.type,a.g,a.h);mc%70||2!=a.type||S(a.x,a.y,3,0,0,Ga);3==a.type&&(Ac(a.x+1+.4*a.g,a.y+1,a.x+7+.4*a.g,a.y+7)?(a.g=-a.g,a.x=8*b((a.x+4)/8),a.dir=0<a.g?270:90):a.x+=.4*a.g);4==a.type&&(Ac(a.x+1,a.y+1+.4*a.h,a.x+7,a.y+7+.4*a.h)?(a.h=-a.h,a.y=8*b((a.y+4)/8),a.dir=0<a.h?180:0):a.y+=.4*a.h);(3==a.type||4==a.type)&&0==x%3&&(640<a.y?Ib(a.x-8*k,a.y-8*q):Hb(a.x-
8*k,a.y-8*q));Z(a.x+2,a.y+2,4,4,J,K,8,8)&&R(2,50);for(let g of L)if(Z(a.x,a.y,8,8,g.x+2,g.y+2,4,4)&&(a.a-=g.l,n([[100,20],[220,50],[110,75]]),U=1,g.x=-100,0>=a.a))return Eb(a.x-8*k,a.y-8*q),T<nc&&50<100*h()&&Pb.push([a.x,a.y]),5==a.type&&Cb.forEach(u=>S(a.x,a.y,0,...u)),!1;return!0});Pb=Pb.filter(a=>{if(oa(...a))return!1;Y(Ob,a[0]-8*k,a[1]-8*q);return Z(a[0]+2,a[1]+2,4,4,J,K,8,8)?(n(fa),T<nc&&T++,!1):!0});for(let a of dc)N[l]=~~sessionStorage.getItem(`boss${l}`),!oa(a.x,a.y)&&8<J-8*k&&121>J-8*k&&
(a.x=-100,N[l]||(V=W=0,Q=Cc(l),Vb=0));if(Q)if(Bc([[Nb,0,56],[Nb,0,64],[Nb,120,56],[Nb,120,64]]),180>Vb)Y(Oa,44,30),0==Vb&&n(ia),Vb++;else{Q.b&&Q.b--;if(4===l){f=F=>{Z(J,K,8,8,24+X+8*k,u+8*q,24*Q.v,24)&&(R(2,50),Db(J-8*k,K-8*q),U=2,J-=24,F())};let [a,g]=[112,56];y=b(3*Math.sin(jb/2));let u=g-2+y;y=g-2-y;z=F=>{if(!Q.b)for(let I of L)if(Z(I.x+2,I.y+2,4,4,a-16*Q.v+8*k,u+8*q,24,24)&&(I.x=-100,Q.a-=I.l,n(t),Q.b=60,U=1,F(),0>=Q.a))if(1<Q.v)O(a-16*Q.v,g),Q.v--,n(p),U=4,Q.a=20;else{Mb(a+8,u+8);U=8;n(p);Q=
null;break}};switch(W){case 0:X=128;W++;break;case 1:X>a-16*(Q.v+1)?X--:W++;break;case 2:z(()=>0>=Q.a&&(W=3));60>V&&V++;60<=V&&(V=0,50<Date.now()%100?W=6:[[-1,0],[-.7,-.7],[-.7,.7]].forEach(F=>{S(X+16+8*k,u+8+8*q,0,...F)}));break;case 3:128>X?X+=2:W=4;break;case 4:for(e of uc(64))H[e]=[8*e,0,24+Date.now()%64,0,128];W=5;break;case 5:0==x%2&&n([[55,4],[110,8]]);for(e in H){if(-512<H[e][0])H[e][0]-=.25*(5-Q.v);else{W=1;H=[];break}if(!(-8>H[e][0])){-128<H[e][0]&&H[e][3]<H[e][2]&&(H[e][3]+=.2*(5-Q.v));
-128<H[e][0]&&H[e][4]>H[e][2]+24&&(H[e][4]-=.2*(5-Q.v));z=H[e][3]+b(12*Math.sin(jb/16+H[e][0]/16+e/8));B=H[e][4]+b(12*Math.sin(jb/16+H[e][0]/16+e/8));Y(za,H[e][0],z,180,!0);Y(za,H[e][0],B);for(E=0;12>E;E++)Y(Aa,H[e][0],z-8-8*E,180,!0),Y(Aa,H[e][0],B+8+8*E);(Z(H[e][0]+8*k,8*q,8,z-5,J,K,8,8)||Z(H[e][0]+8*k,B+9+8*q,8,B,J,K,8,8))&&R(2,50)}}break;case 6:104>V&&V++;z(()=>0>=Q.a&&(W=3));if(104<=V)for(e in uc(6))H[e]=[8,56-8*e,40,8*-e,0],H[e+6]=[8,64+8*e,40,8*-e,0],W=7;Y(za,X+16-V,u+8,270,!0);for(e=0;6>e;e++)Y(Aa,
X+16-V+8+8*e,u+8,270,!0);Z(J,K,8,8,X+24-V+8*k,u+8+8*q,56,8)&&R(2,50);break;case 7:B=0;z(()=>0>=Q.a&&(W=3));for(e in H){Y(za,H[e][0]+H[e][3],H[e][1],90,!0);for(E=0;6>E;E++)Y(Aa,H[e][0]+H[e][3]-8-8*E,H[e][1],90,1);H[e][4]||(H[e][3]<H[e][2]?(H[e][3]++,B++):H[e][4]=1);1==H[e][4]&&(0<H[e][3]?(H[e][3]-=2,B++):(Eb(H[e][0],H[e][1]),0==b(H[e][1]/8)%8%2&&S(H[e][0]+8*k,H[e][1]+8*q,0,1,0),H[e][4]=2,H[e][0]=-8));Z(8+8*k,H[e][1]+8*q,H[e][3],8,J,K,8,8)&&R(2,50)}B||(W=1,H=[])}if(Q)for(f(()=>null),Bc([[Sa,X+16,u,
0,!1,Q.b],[Sa,X+16,u+12,180,!0,Q.b]]),f=0;f<Q.v;f++)Bc([[Ua,X+26+16*f,f%2?y:u,0,!1],[Ua,X+26+16*f,f%2?y+12:u+12,180,!0]])}if(2===l){let [a,g,u,F]=[56,96,16,16];Z(J,K,8,8,a+8*k,g+8*q,u,F)&&R(2,50);Q.open?Bc([[Wa,52,96,0,0,Q.b&&0==Q.b%2],[Wa,64,96,0,1,Q.b&&0==Q.b%2]]):Bc([[Va,64,96,0,0,Q.b&&0==Q.b%2],[Va,56,96,0,1,Q.b&&0==Q.b%2]]);pa(a+8*k,g+8*q,u,F,I=>{Q.b||(I.x=-100,Q.open?(n([[0,10],...t]),Q.a-=e.l,Q.b=10,U=2):n(fa))});f=2*Math.sin(2*jb);switch(W){case 0:Y(Xa,36+f,112);Y(Xa,84-f,112);120>V?V+=1+
.5*(2-Q.u):(V=0,Q.j<4+2*(2-Q.u)?(Q.j++,S(48*Q.c+36+f+8*k,112+8*q,2,0,0,Fa),Q.c=!Q.c):(Q.c=112,Q.j=5,W=1));break;case 1:0==Q.B?8<Q.c&&(Q.c-=2):120>Q.c?Q.c+=2:W=2;Y(Xa,36+f,Q.c);Y(Xa,84-f,Q.c);for(e=0;e<b((128-Q.c)/8)-1;e++)Y(Ya,36+f,Q.c+8*e,0,0==e%2,1==Q.s%2),Y(Ya,84-f,Q.c+8*e,0,0==e%2,1==Q.s%2);0==Q.B&&[36+f+8*k,84-f+8*k].forEach(I=>{Z(J,K,8,8,I,Q.c+8*q,8,120-Q.c)&&R(1,50);pa(I,Q.c+8*q,8,120-Q.c,Ta=>{Ta.x=-100;Q.s||(n([[0,15],...p]),Q.s=30,Q.j-=Ta.l,U=1)});if(0>=Q.j)for(Q.B=1,e=0;16>e;e++)Eb(I-8*
k,8*e)});Q.s&&Q.s--;break;case 2:Q.open=1,0>=Q.a&&(O(a-4,g-4),n(p),0<Q.u&&(Q.u--,Q.a=20,Q.open=0,W=Q.B=0))}0>=Q.a&&(Mb(a+4,g+4),n(p),Q=null,V=W=0)}if(1===l){Y(Za,16,56,0,0,0<Q.b&&0==Q.b%2);let [a,g]=[16+8*k,56+8*q];0<Q.b&&Q.b--;pa(a,g,16,16,u=>{u.x=-1E3;Q.b||(Q.b=15,Q.a-=u.l,n(t),U=2)});Z(a,g,16,16,J,K,8,8)&&(J=a+24,R(2,30),U=2);switch(W){case 0:[[40,48],[56,48],[64,48],[80,48],[96,48]].forEach(u=>Q.C.push([...u,3])),W=1;case 1:Q.C=Q.C.filter(u=>{for(E=0;4>E;E++)Y($a[u[2]-1],u[0],u[1]+8*E);J-8*k<
u[0]+8&&(J=u[0]+8+8*k);pa(u[0]+8*k,u[1]+8*q,8,32,F=>{F.x=-1E3;n(fa);U=1;--u[2]});return 0<u[2]});for(e of Q.G)Y(Xb,e[0],e[1],56>e[1]?180:0);if(90>V)V++;else for(e of Q.G)V=0,S(e[0]+8*k,e[1]+8*q,3,0,64>e[1]?1:-1,Ga),n(fa)}0>=Q.a&&(0<Q.u?(Q.u--,Q.a=20,J=108+8*k,K=60+8*q,W=0,Q.G=[[8,80],[32,80],[8,24],[32,24]]):(Q=null,V=W=0),Mb(a+4-8*k,g+4-8*q),U=4,n(p))}if(3===l){0==Q.x&&(Q.x=48,Q.y=16);Bc([[ab,Q.x,Q.y,0,0,Q.b&&0==Q.b%2],[ab,Q.x+16,Q.y,0,1,Q.b&&0==Q.b%2],[Ba,Q.x+12,Q.y-8]]);for(e=Q.y-16;0<e;e-=8)Y(Ca,
Q.x+12,e);pa(Q.x+8*k,Q.y+8*q,32,16,a=>{a.x=-100;n(fa);Q.b||(Q.b=90,U=1,Q.a-=a.l)});0<Q.b&&Q.b--;Z(Q.x+8*k,Q.y+8*q,32,16,J,K,8,8)&&(64>J-8*k?J-=16:J+=16,R(1,50));switch(W){case 0:Q.o=[8,48,88,48],Q.i=0,W=1,Q.j=30;case 1:3<Q.i&&(Q.i=0);V<Q.j?V++:(V=0,W=6>Q.c?2:6);break;case 2:V<=Q.j?(V+=.5,Q.x=yc(Q.x,Q.o[Q.i])):(V=0,W=3,U=1,n(t));break;case 3:E=8;Y(bb,Q.o[Q.i]+2,28);Y(bb,Q.o[Q.i]+22,28);for(e=0;e<=E;e++)Y(bb,Q.o[Q.i]+2,32+8*e),Y(bb,Q.o[Q.i]+22,32+8*e);10>V?V++:(V=0,W=4,U=1);break;case 4:E=8;Y(cb,Q.o[Q.i]+
2,28);Y(cb,Q.o[Q.i]+22,28);for(e=0;e<=E;e++)Y(db,Q.o[Q.i]+2,32+8*e),Y(db,Q.o[Q.i]+22,32+8*e);20>V?V++:(Cb.forEach(a=>{S(Q.o[Q.i]+2+8*k,32+8*E+8*q,0,...a,Ga);S(Q.o[Q.i]+22+8*k,32+8*E+8*q,0,...a,Ga)}),W=5);[2,22].forEach(a=>{Z(Q.x+a+8*k,Q.y+32+8*q,8,64,J,K,8,8)&&R(4,50)});break;case 5:S(Q.o[Q.i]+12+8*k,20+8*q,3,0,0,Ga);W=1;V=0;Q.i++;U=1;Q.c++;break;case 6:V<Q.j?V++:(V=0,W=7,U=3,n(p),O(Q.x+4,Q.y-8));Q.y=yc(Q.y,88);break;case 7:V<Q.j?V++:(V=0,S(Q.x+12+8*k,Q.y+8+8*q,3,0,0,Ga));400>Q.s?Q.s++:(W=8,V=Q.s=
0);break;case 8:V<Q.j?V++:(V=0,W=1,U=3,n(t),Q.c=0),Q.y=yc(Q.y,16)}0>=Q.a&&(O(Q.x,Q.y),0<Q.u?(Q.a=20,Q.j-=5,Q.u--,V=0,W=7==W?8:1,Q.i=0,Q.s=0):(Q=null,W=V=0,n(p)))}Q||(N[l]=1,sessionStorage.setItem(`boss${l}`,1))}if(pc)49===x%50&&(window.location=window.location);else{for(let a of Tb){if(oc)break;Z(J,K,8,8,a.x+3,a.y+3,2,2)&&(a.x=-100,R(1,30))}0>=T&&(pc=!0,x=0,n(p),Mb(J-8*k,K-8*q));y=A[39]-A[37];z=A[40]-A[38];m&&(m=navigator.getGamepads()[m.index],y=(.5<m.axes[0]?1:0)-(-.5>m.axes[0]?1:0),z=(.5<m.axes[1]?
1:0)-(-.5>m.axes[1]?1:0),A[32]=m.buttons[0].value?1:0);f=y|z;fb=y?0>y:fb;Q&&(J=8>J-8*k?8+8*k:J,J=112<J-8*k?112+8*k:J);B=J+4+5*y;M=K+4+5*z;J=Ac(B,K+1,B,K+7)?8*b((J+1)/8):J+y;K=Ac(J+1,M,J+7,M)?8*b((K+1)/8):K+z;A[32]&&!lc&&5>L.length&&Fb[Ab](J,K,fb?-2:2)&&n(Bb[Ab]);lc=A[32];f&&[Hb,Ib][2==l||4==l||d&&r<K-8*q?1:0](J-8*k,K-8*q);Y(eb[qb],J-8*k,K-8*q,0,!fb,oc);oc&&oc--}v.getImageData(...ua);la.clearRect(...ua);l=2*Math.sin(2*jb);f=2*Math.cos(2*jb);l=U?0==U*x%2?l*U*-1:l*U:0;f=U?0==U*x%2?f*U*-1:f*U:0;for(la.drawImage(ja,
0,0);128>r;r++)y=d?ba(Math.sin(2*jb+1280*r)):0,aa(y),la.clearRect(0,r,128,1),la.drawImage(ja,0,r,128,1,0<y?-1:0>y?0:-1,r,128,1);v.clearRect(...ua);v.drawImage(ka,l-1,f);U&&U--;jb+=.05;Y(fc,0,120);for(d=0;d<b(T);d++)Y(gc[0],14+2*d,120);if(Q){for(e=Q.a;e--;)Y(gc[3],103-2*(e-1),120,0,1);Y(ec,112,120)}Ha&&(Ha--,Y(Ea,52,60));mc++;for(sa++;5<sa;)x++,sa-=5;na-=qa}ma=c;requestAnimationFrame(Dc)};
</script></body>