(()=>{var t={182:t=>{t.exports.h=20,t.exports.Q=5}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var a=e[o]={exports:{}};return t[o](a,a.exports,n),a.exports}(()=>{"use strict";const t=[[[[-140,111,112,-71,99,-90,-154,101],[1,0,3,3,2,1],[20,0,0],[0,0]],[[282,170,294,163,338,158,372,123,378,82,351,31,355,98,329,131,287,151,269,151,282,170],[1,10,9,6,5,4,4,3,2,2,1,9,7,6,4,2,9,8,7,4,2,2,8,7],[20,0,0],[-170,-241]]],[null,0]],e=[[[[-195,158,195,-51,180,-64,-208,146],[1,0,3,3,2,1],[20,0,0],[0,0]],[[20,22,-37,-27,-181,-97,-91,-76,-17,-39,35,9],[4,5,0,1,2,3,3,4,0,0,1,3],[20,0,0],[175,-73]],[[-20,-22,37,27,181,97,91,76,17,39,-35,-9],[4,5,0,1,2,3,3,4,0,0,1,3],[20,0,0],[-188,168]]],[null,0,0]],o=[[[[-172,140,173,-120,160,-139,-185,130],[1,0,3,3,2,1],[20,0,0],[0,0]],[[-11,9,-54,-49,-149,-104,-75,-96,-16,-57,14,-9],[4,5,0,1,2,3,3,4,0,0,1,3],[20,0,0],[148,-121]]],[null,0]],r=[[[[19,4,43,-90,29,-112,-18,-115,-35,-90,-15,9,19,4],[1,0,6,6,5,4,4,3,2,2,1,6,6,4,2],[3,3,3],[28,300]],[[65,-96,-52,-82,-40,-5,-18,24,16,21,37,-2],[1,0,5,5,4,3,3,2,1,1,5,3],[3,3,3],[5,-85]],[[],[],[],[70,-144]],[[97,0,76,62,44,320,72,363,77,392,66,425,44,450,-22,451,-88,412,-111,312,-76,342,-50,347,-75,156,-91,87,-111,40,-140,16,-180,0,97,0],[16,17,0,2,3,4,4,5,6,6,7,8,8,9,10,15,16,0,2,4,6,6,8,10,14,15,0,6,10,11,13,14,0,2,6,11,12,13,0,1,2,11,11,12,0,0,1,11],[4,4,4],[0,0]],[[],[],[],[61,-136]],[[-34,7,-60,-107,-17,-96,19,-91,60,-93,41,8,4,35],[5,6,0,0,1,2,3,4,5,5,0,2,2,3,5],[5,5,5],[-4,-75]],[[158,383,135,366,120,333,134,311,155,296,192,298,207,316,214,344,201,373,183,388,158,383],[9,0,1,1,2,3,3,4,5,5,6,7,7,8,9,9,1,3,3,5,7,7,9,3],[0,0,0],[-147,44]],[[-18,13,-39,-68,-19,-96,25,-95,37,-67,26,-4,16,19,6,23,-8,21,-18,13],[8,9,0,0,1,2,2,3,4,4,5,6,6,7,8,8,0,2,2,4,6,6,8,2],[5,5,5],[-51,281]]],[3,0,1,null,5,7,3,3]],a=new Float32Array([1,0,0,0,1,0,0,0,1]),c=()=>new Float32Array(a),s=(t=0,e=0)=>new Float32Array([t,e]),l=(t,e)=>(t[0]*=e,t[1]*=e,t),i=t=>{const e=(t=>(t[0]**2+t[1]**2)**.5)(t);return l(t,0===e?0:1/e)},u=t=>{const e=t[0],n=t[1];return s(-n,e)},d=(c(),t=>(t.set(a,0),t)),m=(t,e)=>{const n=Math.cos(e),o=Math.sin(e),r=t[0],a=t[1],c=t[2],s=t[3],l=t[4],i=t[5];t[0]=n*r-o*s,t[1]=n*a-o*l,t[2]=n*c-o*i,t[3]=o*r+n*s,t[4]=o*a+n*l,t[5]=o*c+n*i},h=(t,e,n)=>{t[0]*=e,t[4]*=n},f=(t,e,n)=>{const o=t[6],r=t[7],a=t[8];t[6]=e*t[0]+n*t[3]+o,t[7]=e*t[1]+n*t[4]+r,t[8]=e*t[2]+n*t[5]+a},p=(t,e)=>f(t,e[0],e[1]),y=(t,e)=>(t[0]+=e[0],t[1]+=e[1],t),g=(t,e)=>(t.set(e,0),t);let v=0,M=0;const A=()=>v,S=()=>M,w=(t,e)=>{t[0].uniform1f(t[3][2],e)},L=(t,e,n)=>{const o=t.createShader(e);return t.shaderSource(o,n),t.compileShader(o),o},E=(t,e,n,o)=>{const r=t[0],a=r.createVertexArray();r.bindVertexArray(a),b(t,0,e,2);const c=[];for(let t=0;t<e.length;t+=2){const n=s(e[t],e[t+1]),o=(t+2)%e.length,r=s(e[o],e[o+1]);c.push(u(i((m=n,(d=r)[0]-=m[0],d[1]-=m[1],d))))}var d,m;const h=[],f=e.length/2;for(let t=0;t<f;t++){const e=c[(t-1+f)%f],n=c[t],o=l(y(s((p=e)[0],p[1]),n),.5);h.push(o[0],o[1])}var p;b(t,1,h,2);const g=r.createBuffer();return r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,g),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),r.STATIC_DRAW),{0:a,1:n.length,2:r.TRIANGLES,3:new Float32Array(o)}},b=(t,e,n,o)=>{const r=t[0],a=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,a),r.bufferData(r.ARRAY_BUFFER,new Float32Array(n),r.STATIC_DRAW);const c=t[2][e];r.vertexAttribPointer(c,o,r.FLOAT,!1,0,0),r.enableVertexAttribArray(c)},x=(t,e)=>{t[0].uniformMatrix3fv(t[3][1],!1,e)},_=(t,e,n)=>{const o=t[0];o.bindVertexArray(e[0]),o.uniform3fv(t[3][3],n||e[3]),o.drawElements(e[2],e[1],o.UNSIGNED_SHORT,0),o.bindVertexArray(null)},q=[[[[-17,41,-43,-4,-23,-61,-39,-98,-32,-136,-11,-137,-8,-123,-23,-120,-25,-102,19,-73,30,-20],[9,10,0,0,1,2,2,3,4,4,5,6,8,9,0,4,6,7,8,0,2,4,7,8,8,2,4],[9,5,3],[-67,134]],[[-18,-33,-18,-79,3,-128,21,-130,24,-113,10,-112,6,-82,16,-9],[6,7,0,0,1,2,2,3,4,5,6,0,2,4,5,5,0,2],[9,5,3],[96,129]],[[349,233,338,256,326,216],[1,2,0],[9,5,3],[-292,-158]],[[-128,130,-103,98,-59,104,-24,111,15,86,92,93,116,121,122,178,64,187,-101,189],[8,9,0,0,1,2,3,4,5,5,6,7,7,8,0,0,2,3,3,5,7,7,0,3],[13,7,3],[0,0]],[[4,17,-12,17,-20,-17,-23,-72,-1,-121,17,-123,19,-106,5,-105,1,-75,15,-12],[8,9,0,0,1,2,2,3,4,4,5,6,8,0,2,4,6,7,7,8,2,2,4,7],[13,7,3],[80,121]],[[-5,25,-38,-1,-17,-57,-34,-94,-26,-132,-5,-133,-3,-119,-18,-116,-20,-99,24,-69,32,-26,27,7],[10,11,0,0,1,2,2,3,4,4,5,6,8,9,10,10,0,2,4,6,7,8,10,2,4,7,8,8,2,4],[13,7,3],[-90,130]],[[-9,-13,16,-25,44,2,57,16,99,13,98,24,107,38,69,54,68,69,58,75,37,75,25,99,13,58,-14,11],[12,13,0,0,1,2,3,4,5,5,6,7,7,8,9,10,11,12,12,0,2,3,5,7,7,9,10,10,12,2,2,3,7,7,10,2],[13,7,3],[78,176]],[[400,200,394,213,404,213,407,207,400,200],[1,4,3,3,2,1],[0,0,0],[-297,-171]],[[389,201,357,202,386,192,389,201],[2,0,1],[0,0,0],[-288,-173]],[[371,195,387,192,382,174,374,176,379,188,371,195],[1,5,4,4,3,2,2,1,4],[20,10,10],[-296,-167]],[[-32,102,-53,50,-16,-1,7,12,-37,52,-32,102],[4,5,0,1,2,3,4,0,1,1,3,4],[13,7,3],[-90,176]],[[349,227,356,227,356,220,349,220],[1,0,3,3,2,1],[2,2,2],[-300,-175]],[[363,233,371,233,371,227,363,227],[1,0,3,3,2,1],[2,2,2],[-300,-175]]],[3,3,6,null,3,3,3,6,6,6,3,6,6]],R=[[[[-13,-77,13,-74,16,0,-14,1],[2,3,0,0,1,2],[20,16,13],[-1,-24]],[[-8,-53,-9,-70,2,-77,25,-72,24,-57,19,-47,17,-5,3,7,-10,-3],[7,8,0,0,1,2,2,3,4,5,6,7,7,0,2,2,4,5,5,7,2],[20,16,13],[-4,-69]],[[-13,7,-20,-26,21,-25,17,7,8,12,-3,13],[4,5,0,0,1,2,2,3,4,4,0,2],[20,13,16],[38,303]],[[-20,0,-22,-34,56,-34,55,-20,29,-15,13,1],[4,5,0,0,1,2,2,3,4,4,0,2],[19,19,19],[5,-68]],[[-13,12,-19,-9,-15,-68,19,-68,19,-6,13,15,-2,22,-13,12],[0,1,2,2,3,4,4,5,6,0,2,4,4,6,7],[7,0,0],[3,-84]],[[-10,14,-22,-4,-15,-93,23,-90,26,0,17,16],[4,5,0,0,1,2,2,3,4,4,0,2],[7,0,0],[10,179]],[[-18,0,-20,-34,57,-34,56,-20,31,-16,16,-1],[4,5,0,0,1,2,2,3,4,4,0,2],[19,19,19],[-2,-65]],[[-13,14,-20,-4,-20,-66,14,-66,19,-4,12,15,-1,20,-13,14],[0,1,2,2,3,4,4,5,6,0,2,4,4,6,7],[7,0,0],[-11,-75]],[[-10,23,-26,3,-30,-79,8,-79,15,-19,29,21],[4,5,0,0,1,2,2,3,4,4,0,2],[7,0,0],[-16,167]],[[-18,173,17,171,36,177,43,301,28,329,-37,327,-51,270,-43,227,-43,179],[7,8,0,0,1,2,2,3,4,4,5,6,6,7,0,0,2,4,4,6,0],[20,13,16],[0,0]],[[-13,-63,-8,-76,9,-79,13,-62,17,3,-13,5],[4,5,0,0,1,2,2,3,4,4,0,2],[20,16,13],[-3,-26]],[[-20,-53,-22,-70,-12,-79,11,-75,20,-56,7,-53,8,-7,3,10,-9,11,-18,-4],[8,9,0,0,1,2,2,3,4,5,6,7,7,8,0,0,2,4,5,7,0,0,4,5],[20,16,13],[5,-61]],[[163,381,125,390,82,385,83,326,95,297,106,278,136,278,149,296,169,295,174,322,174,356],[9,10,0,0,1,2,2,3,4,4,5,6,7,8,9,9,0,2,2,4,6,7,9,2,2,6,7],[20,16,13],[-126,49]],[[-13,9,-21,-24,20,-25,17,8,8,13,-2,14],[4,5,0,0,1,2,2,3,4,4,0,2],[20,13,16],[-45,302]],[[109,407,64,391,48,346,76,308,88,308,82,343,89,355,98,334,108,332,115,373,156,383,162,402,143,408],[11,12,0,0,1,2,2,3,4,6,7,8,9,10,11,11,0,2,2,4,5,6,8,9,9,11,2,2,5,6,6,9,2],[7,0,0],[11,-6]],[[186,403,180,395,186,388,191,395],[2,3,0,0,1,2],[3,0,0],[-40,-49]],[[205,407,200,400,205,393,210,400],[2,3,0,0,1,2],[3,0,0],[-41,-49]],[[201,371,182,365,183,361,198,364],[2,3,0,0,1,2],[17,7,7],[-37,-51]],[[200,388,198,377,206,378],[1,2,0],[20,18,17],[-168,-2]]],[2,0,9,4,5,9,7,8,9,null,13,10,9,9,12,12,12,12,9]],k=[[[[-7,-77,10,-74,11,1,-9,0],[2,3,0,0,1,2],[20,16,13],[1,-26]],[[-3,-53,-8,-70,3,-77,26,-71,25,-57,15,-47,12,-4,3,7,-5,-3],[7,8,0,0,1,2,2,3,4,5,6,7,7,0,2,2,4,5,5,7,2],[20,16,13],[-2,-69]],[[-9,7,-13,-26,15,-25,12,8,6,13,-3,13],[4,5,0,0,1,2,2,3,4,4,0,2],[20,13,16],[25,304]],[[-13,0,-16,-34,50,-34,49,-19,26,-14,11,0],[4,5,0,0,1,2,2,3,4,4,0,2],[0,0,0],[3,-65]],[[-11,11,-14,-6,-11,-65,15,-65,14,-3,8,14,-2,19,-11,11],[6,0,1,1,2,3,3,4,5,5,6,1,1,3,5],[7,0,0],[3,-93]],[[-12,0,-15,-34,53,-35,51,-20,28,-15,14,-1],[4,5,0,0,1,2,2,3,4,4,0,2],[0,0,0],[-4,-66]],[[-8,22,-23,7,-12,-99,17,-96,27,-33,27,2,19,22],[5,6,0,0,1,2,2,3,4,4,5,0,0,2,4],[7,0,0],[10,179]],[[-11,14,-16,-6,-16,-67,12,-67,14,-6,10,15,-1,21,-11,14],[6,7,0,0,1,2,2,3,4,4,5,6,6,0,2,2,4,6],[7,0,0],[-4,-81]],[[8,32,-21,27,-28,11,-29,-31,-20,-88,10,-88,20,-23,23,-12,27,15],[7,8,0,0,1,2,2,3,4,4,5,6,6,7,0,0,2,4,4,6,0],[7,0,0],[-22,169]],[[187,332,164,261,146,336,187,332],[1,3,2],[7,0,0],[-25,-19]],[[164,381,125,390,92,378,83,326,97,313,106,278,136,278,142,294,159,296,166,302,174,326,174,356],[10,11,0,0,1,2,2,3,4,4,5,6,7,8,9,9,10,0,0,2,4,4,6,7,7,9,0,0,4,7],[20,16,13],[-126,44]],[[-19,178,14,181,34,190,24,220,26,251,37,265,41,287,26,309,11,322,-31,322,-42,268,-33,229,-49,186],[11,12,0,0,1,2,4,5,6,6,7,8,8,9,10,10,11,0,0,2,3,4,6,8,8,10,0,0,3,4,4,8,0],[20,13,16],[0,0]],[[-11,-63,-7,-76,5,-79,8,-62,13,3,-9,5],[4,5,0,0,1,2,2,3,4,4,0,2],[20,16,13],[-5,-26]],[[116,379,78,362,71,324,77,263,68,242,85,221,108,255,124,334,151,347,153,360,169,333,167,355,157,375,116,379],[12,0,1,1,2,3,3,4,5,5,6,7,7,8,9,9,10,11,1,3,5,9,11,12,1,5,7,7,9,12,12,1,7],[7,0,0],[5,23]],[[-17,-53,-24,-70,-14,-78,9,-75,18,-57,2,-53,5,-7,1,10,-8,11,-14,-3],[8,9,0,0,1,2,2,3,4,5,6,7,7,8,0,0,2,4,5,7,0,0,4,5],[20,16,13],[3,-62]],[[-11,9,-18,-23,16,-26,14,8,7,13,-3,14],[4,5,0,0,1,2,2,3,4,4,0,2],[20,13,16],[-37,292]],[[184,403,177,394,185,386,190,394],[2,3,0,0,1,2],[3,0,0],[-39,-48]],[[206,408,200,400,206,393,210,400],[2,3,0,0,1,2],[3,0,0],[-40,-49]],[[201,371,182,365,183,361,198,364,201,371],[3,0,1,1,2,3],[17,7,7],[-36,-51]],[[200,388,198,377,206,378,200,388],[2,0,1],[20,18,17],[-167,-7]]],[2,0,11,4,6,7,11,8,11,10,11,null,15,10,12,11,10,10,10,11]],T=[[[[44,45,36,29,24,14,7,0,24,-13,36,-28,44,-44,-43,-44,-38,-28,-26,-13,-6,0,-26,14,-38,29,-43,45],[1,0,13,13,12,11,10,9,8,8,7,6,6,5,4,3,2,1,1,13,11,10,8,6,6,4,3,3,1,11,10,6,3,3,11,10],[6,9,14],[0,0]],[[-30,26,-21,17,0,2,0,-16,-22,-43,27,-43,4,-16,4,2,25,17,34,27],[8,9,0,0,1,2,3,4,5,7,8,0,3,5,6,7,0,2,2,3,6,6,7,2],[18,17,14],[-2,-1]],[[-47,59,48,59,48,45,-47,45],[1,0,3,3,2,1],[17,11,7],[0,0]],[[-47,-44,48,-44,48,-58,-47,-58],[1,0,3,3,2,1],[17,11,7],[0,0]]],[null,0,0,0]];var F=n(182);let I;const $=(t,e,n=!0)=>{const o=e[0].map((e=>N(t,e,n))),r=t=>{let n=0,o=t;for(;"number"==typeof e[1][o];)n++,o=e[1][o];return n},a=e[1].map(((t,e)=>e));return a.sort(((t,e)=>r(t)-r(e))),{0:o,1:e[1],2:a}},U=(t,e={},n={})=>({0:t[0].map((t=>O(t))),1:t,2:c(),3:e,4:n}),O=t=>({0:t,1:c()}),P=(t,e)=>{const n=t[0][e],o=t[3][e],r=o?C(o):n[1],a=t[1][1][e];g(r,"number"==typeof a?t[0][a][1]:t[2]),p(r,n[0][1]),o&&B(o)},B=t=>{for(const e of t[1][2])P(t,e)},D=(t,e)=>{const n=t[0].length;for(let o=0;o<n;o++){const n=t[3][o];if(void 0!==n){null!==n&&(g(C(n),H(t,o)),D(n,e));continue}const r=t[0][o];x(e,r[1]);const a=t[4][o];_(e,r[0][0],a)}},N=(t,e,n)=>{const o=t=>t/(n?F.Q:1);return{0:E(t,e[0].map(o),e[1],e[2].map((t=>t/(n?F.h:1)))),1:s(...e[3].map(o)||[0,0])}},H=(t,e)=>t[0][e][1],C=t=>t[2],j=t=>t[1][2],z=(t=0)=>({0:t,1:!1}),W=(t,e)=>{const n=t[0];n[1]=!0;const o=t[2]*e,r=t[1]-n[0];Math.abs(r)<=o?n[0]=t[1]:n[0]+=o*Math.sign(r)},V=t=>t[0][0]===t[1],Y=(t,e)=>{var n;if(!t[1])return!1;let o=!0;const r=t[0][t[2]],a=r[0];let c=a.length;for(;c--;){const t=a[c];t[0][1]||(W(t,e),V(t)||(o=!1))}if(o){t[2]++;const e=J(t);return e&&(t[1]=!1),null===(n=r[1])||void 0===n||n.call(r),e}return!1},G=t=>t[1],J=t=>t[2]===t[0].length,Q=t=>t[0],X=t=>({0:t,1:!1,2:0}),K=t=>{t[2]=0,t[1]=!0},Z=(t,e,n)=>({0:t,1:e,2:n}),tt=(t,e=null)=>({0:t,1:e}),et=(t,e,n=0)=>({0:t,1:n,2:e}),nt=t=>{const e=t[1];let n=e.length;for(;n--;){const o=e[n];o[0][1]=!1;const r=H(t[0],o[2]);d(r)}},ot=(t,e)=>{const n=j(t).map((t=>[]));for(const t of e)n[t[2]].push(t);return{0:t,1:e,2:n}},rt=t=>{const e=t[0];for(const n of j(e)){P(e,n);const o=H(t[0],n);for(const e of t[2][n])0===e[1]?m(o,Q(e[0])):1===e[1]&&f(o,0,Q(e[0]))}},at=(t,e)=>{D(t[0],e)},ct=t=>C(t[0]),st=(t,e)=>{const n=ct(t[1]);d(n),p(n,t[0]),rt(t[1]),at(t[1],e)},lt=(t,e)=>{nt(t[1]),Y(t[2],e),t[0][1]-=.2*e},it=t=>t[0],ut={0:{1:20,0:78},1:{1:0,0:66},2:{1:-5,0:90}},dt=(()=>{const t=[];for(let e=0;e<4;e++)for(let n=0;n<5;n++)t.push([e,n]);return t.sort((([t,e],[n,o])=>{const r=[t,e,n,o],a=Math.min(...r),c=Math.max(...r);return a===c?0:t===c!=(n===c)?t===c?1:-1:e===c!=(o===c)?e===c?1:-1:t===c?e-o:t-n})),t})(),mt=Object.values(ut).length,ht=t=>(t/3|0)%dt.length,ft=t=>dt[ht(t)][0],pt=t=>dt[ht(t)][1],yt=t=>t%mt,gt=t=>ut[yt(t)][0],vt=t=>ut[yt(t)][1],Mt=(t,e,n=1)=>{const o=z(0),r=z(-1.5),a=z(0),c=z(-.5),s=z(),l=z(),i=[Z(o,0,.005),Z(r,-1.5,.005)],u=[...i,Z(a,0,.005),Z(c,-.5,.005)],d=X([tt(u)]),m=X([tt([Z(o,-1,.01),Z(r,-.2,.008),Z(a,1,.01),Z(c,-.5,.005)]),tt([Z(o,1,.01),Z(r,-2,.008),Z(a,-1,.01),Z(c,-.4,.005)])]),h={0:t,1:0,2:ot(U(I[0],{2:e&&on(e),4:null}),[et(o,0),et(r,1),et(a,7),et(c,5),et(s,2),et(l,3,1)]),3:ot(U(I[0],{2:null,4:e&&on(e)}),[et(a,0),et(c,1),et(o,7),et(r,5),et(s,2),et(l,3,1)]),4:null,5:d,6:m,7:null,8:!1,9:!1,10:null,11:0,12:e,13:n,14:o};return h[4]=X([tt([Z(o,-3,.02),Z(r,-2,.02)],(()=>{h[9]=!0,h[10]=new WeakSet})),tt([Z(o,-.7,.04),Z(r,0,.04)]),tt(i)]),h[7]=X([tt([Z(o,0,.01),Z(r,0,.01),Z(a,0,.01),Z(c,0,.01),Z(s,.6,.002),Z(l,60,.05)],(()=>K(h[7])))]),h},At=(t,e)=>{w(e,t[11]);const n=t[8]?t[3]:t[2],o=ct(n);d(o),p(o,t[0]),t[8]&&h(o,-1,1),rt(n),at(n,e),w(e,1)},St=t=>{G(t[4])||t[1]>0||K(t[4])},wt=(t,e,n)=>{const o=t[0][0]+.3*e*(n?-1:1);var r;t[0][0]=Math.max(-Ce/2,Math.min(Ce/2,o)),(r=t[6])[1]=!0,J(r)&&(r[2]=0),t[8]=n},Lt=t=>!bt(t)&&t[9],Et=t=>{t[13]=0,K(t[7])},bt=t=>t[13]<=0,xt=(t,e)=>{Lt(t)&&1===_t(t)&&(t[9]=!1);const n=bt(t)?-.5:1;t[11]=Math.max(0,Math.min(1,t[11]+.002*e*n)),nt(t[2]),nt(t[3]),t[1]=Math.max(0,t[1]-e),Y(t[7],e),Y(t[4],e)&&(t[1]=100),Y(t[6],e),G(t[5])||K(t[5]),Y(t[5],e),t[6][1]=!1},_t=t=>{const e=t[14];return(Q(e)- -3)/2.3},qt=(t,e,n)=>{if(!Lt(t))return!1;const o=((t,e)=>{const n=vt(rn(t[12])),o=gt(rn(t[12])),r=t[8]?-1:1;return t[0][0]+r*n+e*r*o-.5})(t,_t(t));return o<n&&o+1>=e},Rt=(t,e)=>!t[10].has(e)&&(t[10].add(e),!0),kt=(t,e)=>{if(bt(t))return!1;const[n,o]=it(e),[r,a]=t[0];return n+15>=r-25&&n-15<=r+25&&o>=a&&o<=a+100},Tt=t=>t[0],Ft=t=>t[8],It=t=>t[0][0]-25,$t=t=>t[0][0]+25,Ut=t=>2+2*ft(rn(t[12])),Ot=(t,e)=>{t[13]-=e/(t=>15+2*pt(rn(t[12])))(t),bt(t)&&Et(t)},Pt=t=>t[13],Bt=(t,e)=>{bt(t)||(t[13]+=e,bt(t)&&Et(t))},Dt=t=>rn(t[12]),Nt=t=>t[6],Ht=t=>t[4]<=0,Ct=(t,e)=>{t[4]-=e/4,Ht(t)&&K(t[3])},jt=(t,e)=>{w(e,t[7]);const n=ct(t[1]);d(n),p(n,t[0]),t[5]&&h(n,-1,1),rt(t[1]),at(t[1],e),w(e,1)},zt=(t,e)=>{Ht(t)?t[6]+=e:t[0][0]+=(t[5]?-1:1)*e*.2;const n=t[6]>1e3?-1:1;t[7]=Math.max(0,Math.min(1,t[7]+.002*e*n)),nt(t[1]),Y(t[3],e),Y(t[2],e)},Wt=t=>t[0],Vt=t=>t[0][0]-20,Yt=t=>t[0][0]+20,Gt=new Promise((t=>{try{const e=document.monetization;if(!e)return;e.addEventListener("monetizationstart",(()=>{t("started"===e.state)}))}catch(t){}t(!1)})),Jt="thiagorb_death-tournament",Qt=()=>{let t={0:0,1:null,2:[]};try{const e=JSON.parse(localStorage.getItem(Jt));Xt(e)&&(t=e)}catch(t){}return t},Xt=t=>"object"==typeof t&&"number"==typeof t[0]&&!(!Array.isArray(t[2])||t[2].some((t=>"number"!=typeof t)))&&(null===t[1]||"string"==typeof t[1]),Kt=t=>{const e=Qt();t(e),localStorage.setItem(Jt,JSON.stringify(e))},Zt=()=>Qt()[0],te=t=>{Kt((e=>e[1]=t))},ee=()=>Qt()[2],ne=async t=>{const e=`${Jt}-${t}`,n="death-tournament."+("testnet"===t?"testnet":"near"),o=await nearApi.connect({nodeUrl:`https://rpc.${t}.near.org`,walletUrl:`https://wallet.${t}.near.org`,helperUrl:`https://helper.${t}.near.org`,explorerUrl:`https://explorer.${t}.near.org`,networkId:t,keyStore:new nearApi.keyStores.BrowserLocalStorageKeyStore(localStorage,e)}),r=new nearApi.WalletConnection(o,e),a=window.contract=await new nearApi.Contract(r.account(),n,{viewMethods:["is_registered","get_opponent","get_player_weapons","get_registered_players","get_weapons"],changeMethods:["register_player","claim_weapon"],sender:r.getAccountId()});return{0:t,1:n,2:r,3:a}},oe=t=>t[2].getAccountId(),re=t=>t[2].isSignedIn();let ae,ce=()=>ne("testnet"),se=()=>ne("mainnet");const le=()=>(ae||(ae=(async()=>{const t=Qt()[1];if(!t)return null;const e=await("testnet"===t?ce():se());return(async t=>{re(t)&&(await t[3].is_registered({playerId:oe(t)})||await t[3].register_player())})(e),re(e)?e:null})()),ae),ie=t=>({0:0,1:t}),ue=(t,e)=>{e!==t[0]&&(t[0]=e,t[1](e))},de=document.querySelector("#score"),me=document.querySelector("#player-health"),he=document.querySelector("#player-name"),fe=document.querySelector("#opponent-health"),pe=document.querySelector("#opponent-name"),ye=(t,e=null)=>{fe.classList.toggle("hidden",!t),pe.classList.toggle("hidden",!t),e&&(pe.innerText=e)},ge=ie((t=>de.style.setProperty("--score",`'${t}`))),ve=ie((t=>Ae(me,t))),Me=ie((t=>Ae(fe,t))),Ae=(t,e)=>t.style.setProperty("--progress",Math.max(0,Math.min(1,e)));let Se,we=0;const Le=(t,e=null)=>{document.querySelector("#high-score").innerText=Zt();const n=e||Object.assign(We(0),{0:Mt(s(0,-1e4),null),9:1/0});let o=!1,r=0,a=.5,c=null,l=[],i=[],u=!1;Gt.then((t=>{u=t,y(i)}));const p=t=>{we=Math.max(0,Math.min(l.length-1,we+t))},y=t=>{i=[...new Set([...u?[0,1,12]:[0,1],...t])],i.sort(((t,e)=>t-e)).reverse(),l=i.map(nn).map(on),p(0)},g=e=>{const s=(e-r)*a;if(r=e,n[10]+=s,o){if(Ee(n))return void c.catch((t=>null)).then((e=>{document.querySelectorAll(".game-ui").forEach((t=>t.classList.remove("hidden")));const n=We(i[we],1.1);n[12]=xe(e),Ze(n,t)}));a+=.001*s}Xe(n,s),Ke(n,t),v(s),requestAnimationFrame(g)},v=e=>{const r=we-Se,a=.01*e,c=o||r>0?1:-1;Math.abs(r)>a||o?Se+=a*c:Se=we;for(let e=-2;e<3;e++){const o=c>0?Math.ceil(Se+e):Math.floor(Se+e);if(o<0||o>=l.length)continue;const r=l[o],a=C(r),s=o-Se,i=1-Math.abs(s/3);d(a),f(a,A()/2-150,60*s),h(a,Math.max(0,i),Math.max(0,i)),f(a,0,60*s),m(a,.001*n[10]),B(r),w(t,Math.max(0,i)**2),D(r,t),w(t,1)}};requestAnimationFrame((t=>g(r=t)));const M=document.querySelector("#start-game"),S=document.querySelector("#sign-in"),L=document.querySelector("#network-id"),E=document.querySelector("#sign-out"),b=document.querySelector("#account-id"),x=(t,e)=>{t.style.display=e?null:"none"},_=async t=>{var e;x(S,null===t),x(E,null!==t),x(b,null!==t),e=null!==t?be(oe(t)):"HEALTH",he.innerText=e,t?(document.querySelector("#account-id").innerText=`logged as ${oe(t)} (${(t=>t[0])(t)})`,y(await(t=>t[3].get_player_weapons({playerId:oe(t)}))(t))):y(ee())};le().then(_);const q=()=>{c=le().then((async t=>t?(t=>t[3].get_opponent({playerId:oe(t)}))(t):null)),o=!0,n[6]=1/0,n[8]=1/0,n[7]=1/0,document.querySelector("#menu-ui").classList.add("hidden"),M.removeEventListener("click",q),S.removeEventListener("click",k),L.removeEventListener("click",T),E.removeEventListener("click",F),document.body.removeEventListener("keypress",q),document.body.removeEventListener("click",R)},R=t=>{if("menu-ui"!==t.target.id)return;const e=t.clientY>document.body.offsetHeight/2?-1:1;p(e)},k=()=>{S.style.display="none",L.style.display=null},T=t=>{const e=t.target.getAttribute("data-network-id");e&&(async t=>{te(t);const e=await("testnet"===t?ce():se());e[2].requestSignIn(e[1],"Death Tournament")})(e)},F=async()=>{await(async()=>{(await le())[2].signOut(),ae=null,te(null)})(),_(null)};setTimeout((()=>{ye(!1),M.addEventListener("click",q),document.body.addEventListener("keypress",q),S.addEventListener("click",k),L.addEventListener("click",T),E.addEventListener("click",F),document.body.addEventListener("click",R),document.querySelectorAll(".game-ui").forEach((t=>t.classList.add("hidden"))),document.querySelector("#menu-ui").classList.remove("hidden")}),e?3e3:0),Se=e?-17:-3},Ee=t=>0===t[1].size&&0===t[3].size&&0===t[2].size,be=t=>{const e=t.split(".");return e.length>1&&e.pop(),e.join(".")},xe=t=>{return{0:(null==t?void 0:t.weaponType)||(e=Math.random(),e**1.5*(dt.length*mt)|0),1:be((null==t?void 0:t.playerId)||"ENEMY")};var e},_e=[.86,.8,.72],qe=[_e,[.27,.38,.55],[.3,.3,.3]],Re=[_e,[.3,.3,.3]],ke=[[.63,.4,.37],[.35,.18,.16]],Te=[[.98,.91,.63],[.14,.07,.04]],Fe=(t,e)=>{w(e,t[7]);const n=ct(t[4]);d(n),p(n,t[0]),t[3]&&h(n,-1,1),rt(t[4]),at(t[4],e),w(e,1)},Ie=t=>t[5]<=0,$e=(t,e)=>{t[5]-=e/5,Ie(t)&&K(t[2])},Ue=t=>t[6],Oe=(t,e)=>{Ie(t)?t[6]+=e:t[0][0]+=(t[3]?-1:1)*e*.2;const n=t[6]>1e3?-1:1;t[7]=Math.max(0,Math.min(1,t[7]+.002*e*n)),nt(t[4]),Ie(t)?Y(t[2],e):Y(t[1],e)},Pe=t=>t[0][0]-25,Be=t=>t[0][0]+25,De=t=>t[0],Ne=-90,He=500,Ce=670,je=(t=>{const e=Object.fromEntries(["Space","ArrowLeft","ArrowRight"].map((t=>[t,!1])));return addEventListener("keydown",(t=>{const n=t.code;n in e&&(t.preventDefault(),t.stopPropagation(),e[n]=!0)})),addEventListener("keyup",(t=>{const n=t.code;n in e&&(t.preventDefault(),t.stopPropagation(),e[n]=!1)})),"undefined"!=typeof ontouchstart?(()=>{const t=document.querySelector('[data-key="Space"]');t.addEventListener("touchstart",(()=>e.Space=!0)),t.addEventListener("touchend",(()=>e.Space=!1));const n=t=>{const n=t.touches[0].clientX-o.clientLeft<o.clientWidth/2;e.ArrowLeft=n,e.ArrowRight=!n},o=document.querySelector('[data-key="Arrows"]');o.addEventListener("touchstart",n),o.addEventListener("touchmove",n),o.addEventListener("touchend",(t=>{e.ArrowLeft=!1,e.ArrowRight=!1})),document.ondblclick=t=>t.preventDefault()})():document.querySelector("#touch").remove(),e})(),ze=t=>t[0]>1.1*A()/2||t[0]<1.1*-A()/2||t[1]>1.1*S()/2||t[1]<1.1*-S()/2,We=(t,e=1)=>({0:Mt(s(0,Ne),nn(t),e),1:new Set,2:new Set,3:new Set,4:null,5:0,6:1e3,7:3e3,8:5e3,9:1e3*(15+30*Math.random()),10:0,11:0,12:null}),Ve=t=>Ge("HIT",t[0],t[1]+50,"hit"),Ye=(t,e)=>{Bt(t[0],e/30);const n=Tt(t[0]),o=e>0?"bonus":"penalty";Ge(`${e>0?"+":""}${e}s`,n[0],n[1]+120,o)},Ge=(t,e,n,o)=>{const r=document.createElement("div");r.classList.add("indicator"),r.classList.add(o),r.onanimationend=()=>r.remove(),r.innerText=t,Object.assign(r.style,{left:`calc(50% + ${e}px`,top:`calc(50% - ${n}px`}),document.querySelector("#screen").appendChild(r)};let Je=null,Qe=0;const Xe=(t,e)=>{tn(t)||((je.ArrowLeft||je.ArrowRight)&&wt(t[0],e,je.ArrowLeft),je.Space&&St(t[0])),xt(t[0],e),((t,e)=>{for(const n of t[1])!Ie(n)&&qt(t[0],Pe(n),Be(n))&&Rt(t[0],n)&&(Ve(De(n)),$e(n,Ut(t[0])),Ie(n)&&(t[11]++,Bt(t[0],.4/30)),t[5]+=t[11]),Oe(n,e),(Ue(n)>2e3||ze(De(n)))&&t[1].delete(n);if(t[6]-=e,t[6]<0){const e=(t=>{const e=z(),n=z(),o=z(),r=z(),a=z(),c=z(),s=z(),l=z(),i=z(),u={0:t,4:Math.random()>.5?ot(U(I[5],{},(()=>{const t=qe[4*Math.random()|0],e=qe[4*Math.random()|0],n=qe[4*Math.random()|0],o=Re[3*Math.random()|0],r=ke[3*Math.random()|0];return{2:t,13:t,9:e,8:n,7:n,5:n,4:n,6:o,3:o,0:r,1:r,10:r,11:r,12:r,18:r&&r.map((t=>Math.min(1,1.2*t))),14:Te[3*Math.random()|0]}})()),[et(e,2),et(n,1),et(o,13),et(r,11),et(a,8),et(c,7),et(s,5),et(l,4),et(i,9)]):ot(U(I[6],{},(()=>{const t=qe[4*Math.random()|0],e=qe[4*Math.random()|0],n=qe[4*Math.random()|0],o=Re[3*Math.random()|0],r=ke[3*Math.random()|0],a=Te[3*Math.random()|0];return{2:t,15:t,11:e,8:n,7:n,6:n,4:n,5:o,3:o,0:r,1:r,12:r,14:r,10:r,19:r&&r.map((t=>Math.min(1,1.2*t))),13:a,9:a}})()),[et(e,2),et(n,1),et(o,15),et(r,14),et(a,8),et(c,7),et(s,6),et(l,4),et(i,11)]),1:null,2:null,3:!1,5:1,6:0,7:0};return u[2]=X([tt([Z(e,-3.1,.007),Z(n,-.3,.005),Z(o,0,.005),Z(r,-2.2,.003),Z(a,0,.005),Z(c,.1,.005),Z(s,0,.005),Z(l,.4,.005),Z(i,1.5,.003)],(()=>K(u[2])))]),u[1]=X([tt([Z(e,-1,.006),Z(n,-.2,.0048),Z(o,1,.006),Z(r,-1.1,.003),Z(a,-1,.006),Z(c,.2,.0048),Z(s,1,.006),Z(l,1.1,.003)]),tt([Z(e,1,.006),Z(n,-2,.0048),Z(o,-1,.006),Z(r,-1.4,.003),Z(a,1,.006),Z(c,2,.0048),Z(s,-1.2,.006),Z(l,.5,.003)],(()=>K(u[1])))]),K(u[1]),u})(s((Math.random()-.5)*Ce,Ne));t[1].add(e),Math.random()<.5&&(t=>{t[3]=!0})(e),t[6]=1e3+300*Math.random()-Math.min(900,.006*t[10])}})(t,e),((t,e)=>{for(const n of t[2])lt(n,e),kt(t[0],n)&&!tn(t)&&(t[2].delete(n),Ye(t,10)),ze(it(n))&&t[2].delete(n);if(t[7]-=e,t[7]<0){const e=(t=>{const e=z(),n={0:t,1:ot(U(I[7]),[et(e,0)]),2:X([tt([Z(e,-.6,.003)]),tt([Z(e,.6,.003)],(()=>K(n[2])))])};return K(n[2]),n})(s((Math.random()-.5)*Ce,250));t[2].add(e),t[7]=3e3*Math.random()+5e3+Math.min(8e3,.1*t[10])}})(t,e),((t,e)=>{for(const n of t[3])zt(n,e),!Ht(n)&&qt(t[0],Vt(n),Yt(n))&&Rt(t[0],n)&&(Ve(Wt(n)),Ct(n,Ut(t[0])),Ht(n)&&Ye(t,-5)),(Nt(n)>2e3||ze(Wt(n)))&&t[3].delete(n);if(t[8]-=e,t[8]<0){const e=(t=>{const e=z(),n=z(),o=z(),r=z(),a=z(),c=z(),s=z(),l={0:t,1:ot(U(I[4]),[et(e,1),et(n,4),et(o,0),et(r,5),et(a,10),et(c,3,1),et(s,6)]),2:null,3:null,4:1,5:!1,6:0,7:0},i=.01;return l[2]=X([tt([Z(e,.5,i),Z(n,-.5,i),Z(o,-.5,i),Z(r,.5,i)]),tt([Z(e,-.5,i),Z(n,.5,i),Z(o,.5,i),Z(r,-.5,i)],(()=>K(l[2])))]),l[3]=X([tt([Z(e,-1.5,.02),Z(n,-1.5,.02),Z(o,-1.5,.02),Z(r,-1.5,.02),Z(a,-1.5,.02),Z(s,1,.02),Z(c,-18,.2)],(()=>K(l[3])))]),K(l[2]),l})(s((Math.random()-.5)*Ce,Ne));Math.random()<.5&&(t=>{t[5]=!0})(e),t[3].add(e),t[8]=3e3+1e3*Math.random()-Math.min(3e3,.006*t[10])}})(t,e),((t,e)=>{const n=t[0],o=t[4];if(o&&(xt(o,e),!tn(t)&&!bt(o))){const t=Tt(n)[0],r=t-Tt(o)[0];let a;const c=Dt(o),s=vt(c)+gt(c);a=Math.abs(t)>Ce/2-100?t+s*(t>0?-1:1):t+s*(r>0?-1:1);const l=a-Tt(o)[0],i=Ft(o)!==r<0;let u=null;Math.abs(l)>10&&i||Math.abs(l)>20?u=1:i&&(u=2),Qe>0?Qe-=e:Je!==u?(Qe=150+150*Math.random(),Je=u):1===u?wt(o,e,l<0):2===u&&wt(o,e,!Ft(o)),!i&&Math.random()<.01&&St(o),qt(o,It(n),$t(n))&&Rt(o,n)&&(Ot(n,Ut(o)),Ve(Tt(n))),qt(n,It(o),$t(o))&&Rt(n,o)&&(Ot(o,Ut(n)),Ve(Tt(o)),ue(Me,Pt(o)),bt(o)&&(ye(!1),(async t=>{const e=await le();var n;e?(t=>{t[3].claim_weapon()})(e):(n=[...new Set([...ee(),t])],Kt((t=>t[2]=n)))})(Dt(o))))}if(t[9]-=e,t[9]<0){const n=Mt(s(0,Ne),nn(t[12][0]));Math.random()<.5&&wt(n,e,!0),t[4]=n,t[9]=1/0,ye(!0,t[12][1]),ue(Me,Pt(n))}})(t,e)},Ke=(t,e)=>{((t,e=[0,0,0,1])=>{t[0].clearColor(...e),t[0].clear(t[0].COLOR_BUFFER_BIT)})(e,cn),ln(e);for(const n of t[1])Fe(n,e);for(const n of t[2])st(n,e);for(const n of t[3])jt(n,e);t[4]&&At(t[4],e),At(t[0],e)},Ze=(l(s(800,He),-.5),s(800,He),l(s(Ce,He),-.5),s(Ce,He),(t,e)=>{let n=0;const o=ie((e=>{if(0===e)return;if(n=1e3,1===e)return;const o=Tt(t[0]);Ge(`${e}x`,o[0],o[1]+100,"combo")}));let r=0;const a=c=>{const s=c-r;r=c;const l=.6+Math.min(.3,(4e-5*t[10]|0)/10);if(Xe(t,s*l),Ke(t,e),Bt(t[0],-.001*s/30),t[10]+=s,ue(ve,Pt(t[0])),ue(ge,t[5]),ue(o,t[11]),n-=s,n<=0&&(t[11]=0,n=0),bt(t[0])){document.querySelectorAll(".after-game").forEach((t=>t.classList.remove("hidden")));const n=t[5];i=Math.max(Zt(),n),Kt((t=>t[0]=i)),document.querySelector("#last-score").innerText=n,Le(e,t)}else requestAnimationFrame(a);var i};requestAnimationFrame((t=>a(r=t)))}),tn=t=>bt(t[0]),en=[[.4,.22,0],[.75,.54,.44],[.81,.82,.84],[.83,.69,.22]],nn=t=>{const e=(t=>t%Object.values(ut).length)(t),n=[I[1],I[2],I[3]][e],o=en[1+ft(t)],r=en[pt(t)];return{0:U(n,{},[{1:o,0:r},{1:o,0:r},{1:o,2:o,0:r}][e]),1:t}},on=t=>t[0],rn=t=>t[1];let an;const cn=[.1,0,.3,1],sn=(t,e,n)=>t.map(((t,o)=>t*n+e[o]*(1-n))),ln=t=>{D(an,t)};window.onload=async()=>{const n=((t,e,n)=>{const o=t.getContext("webgl2",{antialias:!1});o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA);const r=o.createProgram();o.attachShader(r,L(o,o.VERTEX_SHADER,"#version 300 es\nuniform mat3 h,i;in vec2 g,f;out vec2 c;void main(){c=normalize((h*vec3(f,0.)).xy),gl_Position=vec4(i*h*vec3(g,1.),1.);}")),o.attachShader(r,L(o,o.FRAGMENT_SHADER,"#version 300 es\nprecision highp float;uniform float e;uniform vec3 d;in vec2 c;out vec4 b;void main(){float o=.5+.5*max(0.,dot(vec2(sqrt(.2),-.8944272),c));b=vec4(d*o,e);}")),o.linkProgram(r),o.useProgram(r);const a=o.getUniformLocation(r,"h");o.uniformMatrix3fv(a,!1,c());const s=o.getUniformLocation(r,"i"),l=()=>{const e=1/devicePixelRatio;t.width=document.body.clientWidth/e,t.height=document.body.clientHeight/e;const n=document.body.clientWidth/e,r=document.body.clientHeight/e,a=Math.min(n/800,r/500);v=n/a,M=r/a,o.viewport(0,0,n,r);const l=c();h(l,2/v,2/M),o.uniformMatrix3fv(s,!1,l);const i=document.querySelector("#screen");i.style.width=`${v}px`,i.style.height=`${M}px`,i.style.transform=`scale(${a*e})`};addEventListener("resize",l),l();const i={0:o,1:r,3:{0:s,1:a,2:o.getUniformLocation(r,"e"),3:o.getUniformLocation(r,"d")},2:{0:o.getAttribLocation(r,"g"),1:o.getAttribLocation(r,"f")}};return w(i,1),i})(document.querySelector("canvas"));(n=>{const a={0:$(n,r),1:$(n,o),2:$(n,t),3:$(n,e),4:$(n,q),5:$(n,R),6:$(n,k),7:$(n,T)};I=a})(n),(t=>{const e=[];var n,o;e.push({0:[n=-1e3,o=-1010,n+2e3,o,1e3,o+1e3,n,-10],1:[0,2,1,0,3,2],2:[.1,0,.1],3:[0,0]});for(let t=0;t<4;t++){const n=[],o=[],r=[],a=[];let c=300*Math.random()*(1+t)/4-700;const s=(t+1)/4;for(;c<700;){const t=300*s+50*Math.random(),l=c-t/2,i=400-200*s+50*Math.random(),u=-30-40*s**3,d=n.length/2|0;r.push(d,d+2,d+1,d,d+3,d+2),n.push(l,u,l+t,u,l+t,u+i,l,u+i);const m=10+5*s|0,h=t/m,f=5e-4*t*i*(2+10*Math.random())/h|0,p=i/h|0;for(let t=0;t<f;t++){const t=4*s,e=t+(Math.random()*m|0)*h,n=t+(2+Math.random()*(p-2)|0)*h,r=o.length/2|0;a.push(r,r+2,r+1,r,r+3,r+2);const c=l+e,d=u+i-n,f=c+h-2*t,y=d+h-2*t;o.push(c,d,f,d,f,y,c,y)}c+=t+50+600*Math.random()*s,e.push({0:n,1:r,2:sn([.2,.2,.2],cn,.3+.5*s),3:[0,0]}),e.push({0:o,1:a,2:sn([1,1,.5],cn,s),3:[0,0]})}}an=U($(t,{0:e,1:[]},!1))})(n),Le(n)}})()})();