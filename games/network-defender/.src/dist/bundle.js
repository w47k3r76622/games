!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var i=function(t,e){return Math.round(t+Math.random()*(e-t))},a=function(t,e){e.fillStyle="#000",e.fillRect(0,0,t.width,t.height)},o=[],l=[{primary:"#99ff99",secondary:"#33ff33"},{primary:"#ff9999",secondary:"#ff3333"},{primary:"#9999ff",secondary:"#3333ff"}],r=[{primary:"#f03f00",secondary:"#c00c00"},{primary:"#121212",secondary:"#909090"},{primary:"#e3ff19",secondary:"#e0f060"}];var s=function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.upgrade=function(t,n){n.gold>=t.costs[2]&&(e.level+=1,n.health+=100,n.maxHealth+=100,n.gold-=t.costs[2],t.update(2,n))},this.upgradeFire=function(t,n){n.gold>=t.costs[3]&&(e.fireLevel+=1,n.gold-=t.costs[3],t.update(3,n))},this.draw=function(n,i){i.fillStyle=l[e.level].primary,i.fillRect(t.x,0,t.size,n.height),i.fillStyle=l[e.level].secondary,i.fillRect(t.x+t.size/4,0,t.size/2,n.height)},this.level=0,this.fireLevel=0};function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}s.size=10,s.x=60;var u=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e.width+10,this.y=t.size+Math.random()*(e.height-2*t.size),this.level=i,this.health=40+40*i+5*n,this.value=10+20*i+2*n,this.lastAttack=new Date,this.attackInterval=2==i?600:1e3,this.movePerFrame=(e.width-s.x+s.size)/1e3}return function(t,e,n){e&&c(t.prototype,e),n&&c(t,n)}(t,[{key:"update",value:function(t){if(this.health<=0)return!1;if(this.x>s.x+s.size+2)this.x-=this.movePerFrame;else if(new Date-this.lastAttack>this.attackInterval){var e=7+5*this.level-2*t.wall.level;t.health-=e>0?e:0,this.health-=t.wall.fireLevel,this.lastAttack=new Date}return!0}},{key:"draw",value:function(e){e.fillStyle=r[this.level].primary,e.fillRect(this.x,this.y,t.size,t.size),e.fillStyle=r[this.level].secondary,e.fillRect(this.x+t.size/4,this.y+t.size/4,t.size/2,t.size/2)}}]),t}();function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}u.size=10;var f=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),d.call(this),this.x=e,this.y=n,this.lastAttack=new Date,this.attackAnimations=[]}return function(t,e,n){e&&h(t.prototype,e),n&&h(t,n)}(t,[{key:"shot",value:function(t,e){this.attackAnimations.push({target:t,opacity:1}),this.lastAttack=new Date,t.health-=10*e*e}}]),t}();f.size=20;var d=function(){var t=this;this.draw=function(e,n,i,a,o){var r=f.size,s=e.height/(o+1)*(a+1);n.fillStyle=l[i].primary,n.fillRect(r,s,f.size,f.size),n.fillStyle=l[i].secondary,n.beginPath(),n.arc(r+f.size/2,s+f.size/2,f.size/3,0,2*Math.PI),n.fill();var c=!0,h=!1,d=void 0;try{for(var y,v=t.attackAnimations[Symbol.iterator]();!(c=(y=v.next()).done);c=!0){var p=y.value,b=p.target,g=p.opacity;n.lineWidth=4,n.strokeStyle="rgba(125,0,0,".concat(g,")"),n.moveTo(t.x+f.size/2,t.y+f.size/2),n.lineTo(b.x+u.size/2,b.y+u.size/2),n.stroke(),n.lineWidth=1,n.strokeStyle="rgba(255,255,0,".concat(g,")"),n.moveTo(t.x+f.size/2,t.y+f.size/2),n.lineTo(b.x+u.size/2,b.y+u.size/2),n.stroke(),p.opacity-=.3,p.opacity<=0&&t.attackAnimations.splice(t.attackAnimations.indexOf(p),1)}}catch(t){h=!0,d=t}finally{try{c||null==v.return||v.return()}finally{if(h)throw d}}}};function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var v=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.buyTurret=function(t){e.gold>=t.costs[0]&&(e.turrets.push(new f),e.gold-=t.costs[0],t.update(0,e))},this.upgradeTurrets=function(t){e.gold>=t.costs[4]&&(e.turretsLevel+=1,e.gold-=t.costs[4],t.update(4,e))},this.increateFireRate=function(t){e.gold>=t.costs[1]&&(e.attackInterval*=.98,e.gold-=t.costs[1],t.update(1,e))},this.turretsLevel=0,this.turrets=[new f],this.wall=new s,this.health=100,this.maxHealth=100,this.gold=0,this.attackInterval=1e3}return function(t,e,n){e&&y(t.prototype,e),n&&y(t,n)}(t,[{key:"draw",value:function(t,e){var n=this.turretsLevel,i=this.turrets,a=!0,o=!1,l=void 0;try{for(var r,s=i[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var c=r.value;c.draw(t,e,n,i.indexOf(c),i.length)}}catch(t){o=!0,l=t}finally{try{a||null==s.return||s.return()}finally{if(o)throw l}}this.wall.draw(t,e)}},{key:"update",value:function(t){var e=!0,n=!1,i=void 0;try{for(var a,o=this.turrets[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var l=a.value;if(new Date-l.lastAttack<this.attackInterval)return;var r=null,s=!0,c=!1,u=void 0;try{for(var h,f=t[Symbol.iterator]();!(s=(h=f.next()).done);s=!0){var d=h.value;if(d.health>0){r=d;break}}}catch(t){c=!0,u=t}finally{try{s||null==f.return||f.return()}finally{if(c)throw u}}r&&l.shot(r,this.turretsLevel+1)}}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}}}]),t}();function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var b=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.x,a=n.y,o=n.text,l=n.bgColor,r=void 0===l?"#000":l,s=n.hoverColor,c=void 0===s?"#020":s,u=n.color,h=void 0===u?"#fff":u,f=n.onClick;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.button=document.createElement("button"),this.button.classList.add("btn"),this.button.style.left=i+"px",this.button.style.top=a+"px",this.button.style.backgroundColor=r,this.button.style.color=h,this.button.style.cursor="pointer",this.button.innerText=o,this.button.onmouseenter=function(){e.button.style.backgroundColor=c},this.button.onmouseleave=function(){e.button.style.backgroundColor=r},this.button.onclick=f,t.container.appendChild(this.button)}return function(t,e,n){e&&p(t.prototype,e),n&&p(t,n)}(t,[{key:"updatePosition",value:function(t){var e=t.width-window.innerWidth,n=t.height-window.innerHeight,i=this.button.style;i.left=Number(i.left.slice(0,i.left.length-2))-e+"px",i.top=Number(i.top.slice(0,i.top.length-2))-n+"px"}}]),t}();b.container=document.getElementById("ui");var g=function(){var t=this;this.show=function(){t.visible?t.hide():(t.shop.style.display="flex",t.visible=!0)},this.hide=function(){t.shop.style.display="none",t.visible=!1},this.updateAvailability=function(e){for(var n=0;n<t.costs.length;n++){var i=document.getElementsByClassName("btn-shop")[n];3!=t.levels[n]||2!=n&&4!=n?t.costs[n]>e.gold?(i.style.background="#8B4513",i.style.boxShadow="inset 0 0 5px black"):(i.style.background="#455B13",i.style.boxShadow="0 0 5px black"):(i.style.background="#0c0c0c",i.style.boxShadow="inset 0 0 10px black",i.style.color="#fff",i.onclick=null)}},this.update=function(e,n){t.levels[e]+=1,t.costs[e]=Math.round(2.2*t.costs[e]);var i=document.getElementsByClassName("cost")[e],a=document.getElementsByClassName("level")[e];3!=t.levels[e]||2!=e&&4!=e?(i.innerHTML="Cost: ".concat(t.costs[e]),a.innerHTML="Level: ".concat(t.levels[e])):(i.innerHTML="",a.innerHTML="Level: MAX"),t.updateAvailability(n)}},w=document.getElementById("game"),m=w.getContext("2d");w.width=window.innerWidth,w.height=window.innerHeight,window.onresize=function(){A.updatePosition(w),P.updatePosition(w),w.width=window.innerWidth,w.height=window.innerHeight};var x=0,k=5,z=!1,T=new v,S=new function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),g.call(this),this.shop=document.getElementById("shop"),this.costs=[100,60,150,500,1e3],this.levels=[1,1,1,0,1],document.getElementById("close-shop").onclick=this.hide,this.visible=!1,this.updateAvailability(e)}(T),M=[];window.addTurret=T.buyTurret.bind(null,S),window.increateFireRate=T.increateFireRate.bind(null,S),window.upgradeWall=T.wall.upgrade.bind(null,S,T),window.upgradeWallDmg=T.wall.upgradeFire.bind(null,S,T),window.upgradeTurrets=T.upgradeTurrets.bind(null,S);var C=function(){!function(t,e){for(var n=0;n<t.height;n+=30)for(var a=0;a<t.width;a+=30){var l=o[n/30+a/30+n/30*t.height/30];l||(l="rgb(".concat(i(220,225),", ").concat(i(200,205),", ").concat(i(175,180),")"),o[n/30+a/30+n/30*t.height/30]=l),e.fillStyle=l,e.fillRect(a,n,30,30)}}(w,m),T.draw(w,m);for(var t=0;t<M.length;t++){M[t].draw(m)}m.fillStyle="#000",m.font="20px Monospace",m.fillText("Wave: ".concat(x,"    ")+"Enemies: ".concat(M.length,"    ")+"Gold: ".concat(T.gold,"    ")+"Fire rate: ".concat(Math.round(T.attackInterval)/1e3,"    ")+"Health: ".concat(T.health,"/").concat(T.maxHealth),100,20)};!function t(){if(z){a(w,m),m.fillStyle="#000",m.fillRect(0,0,w.width,w.height),m.fillStyle="#fff",m.font="50px Monospace";var e="You've gone offline";m.fillText(e,w.width/2-m.measureText(e).width/2,w.height/2),m.font="30px Monospace",e="Reload to play again",m.fillText(e,w.width/2-m.measureText(e).width/2,w.height/2+50)}else a(w,m),function(){T.update(M);for(var t=[],e=0;e<M.length;e++){var n=M[e];n.update(T)||t.push(n)}for(var i=0;i<t.length;i++){var a=t[i];M.splice(M.indexOf(a),1),T.gold+=a.value}t.length&&S.updateAvailability(T),T.health<=0&&(z=!0,A&&(A.button.style.display="none"),P&&(P.button.style.display="none"))}(),C();setTimeout(t,1e3/60)}();var A=new b({x:w.width-100,y:w.height-50,text:"Next wave",onClick:function(){0==M.length&&(x+=1,T.health=Math.min(T.maxHealth,T.health+20),function t(){var e=0+Number(50*Math.random()<x)+Number(500*Math.random()<x);M.push(new u(w,x,e)),(k-=1)>0?setTimeout(t,1e3):k=Math.min(20,5+Math.round(x/5))}())}}),P=new b({x:w.width-150,y:w.height-50,text:"Shop",onClick:S.show})}]);