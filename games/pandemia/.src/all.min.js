function n(n,t,e){var r=U.createElement("canvas");return r.width=n,r.height=t,e(r.getContext("2d"),r),r}function t(){this.setSettings=function(n){for(var t=0;t<24;t++)this[String.fromCharCode(97+t)]=n[t]||0;this.c<.01&&(this.c=.01);var e=this.b+this.c+this.e;if(e<.18){var r=.18/e;this.b*=r,this.c*=r,this.e*=r}}}function e(){this._params=new t;var n,e,r,i,c,x,o,s,u,l,h,d;this.reset=function(){var n=this._params;i=100/(n.f*n.f+.001),c=100/(n.g*n.g+.001),x=1-n.h*n.h*n.h*.01,o=-n.i*n.i*n.i*1e-6,n.a||(h=.5-n.n/2,d=5e-5*-n.o),s=1+n.l*n.l*(n.l>0?-.9:10),u=0,l=1==n.m?0:(1-n.m)*(1-n.m)*2e4+32},this.totalReset=function(){this.reset();var t=this._params;return n=t.b*t.b*1e5,e=t.c*t.c*1e5,r=t.e*t.e*1e5+12,3*((n+e+r)/3|0)},this.synthWave=function(t,w){var y=this._params,m=1!=y.s||y.v,p=y.v*y.v*.1,g=1+3e-4*y.w,b=y.s*y.s*y.s*.1,I=1+1e-4*y.t,S=1!=y.s,D=y.x*y.x,R=y.g,N=y.q||y.r,G=y.r*y.r*y.r*.2,k=y.q*y.q*(y.q<0?-1020:1020),E=y.p?32+((1-y.p)*(1-y.p)*2e4|0):0,T=y.d,W=y.j/2,z=y.k*y.k*.01,C=y.a,A=n,P=1/n,L=1/e,F=1/r,M=5/(1+y.u*y.u*20)*(.01+b);M>.8&&(M=.8),M=1-M;for(var H,O,j,B,U,V,_=!1,q=0,Y=0,X=0,Z=0,K=0,Q=0,J=0,$=0,nn=0,tn=0,en=new Array(1024),rn=new Array(32),an=en.length;an--;)en[an]=0;for(an=rn.length;an--;)rn[an]=2*v()-1;for(an=0;an<w;an++){if(_)return an;if(E&&++nn>=E&&(nn=0,this.reset()),l&&++u>=l&&(l=0,i*=s),x+=o,(i*=x)>c&&(i=c,R>0&&(_=!0)),O=i,W>0&&(O*=1+f(tn+=z)*W),(O|=0)<8&&(O=8),C||((h+=d)<0?h=0:h>.5&&(h=.5)),++Y>A)switch(Y=0,++q){case 1:A=e;break;case 2:A=r}switch(q){case 0:X=Y*P;break;case 1:X=1+2*(1-Y*L)*T;break;case 2:X=1-Y*F;break;case 3:X=0,_=!0}N&&((j=0|(k+=G))<0?j=-j:j>1023&&(j=1023)),m&&g&&((p*=g)<1e-5?p=1e-5:p>.1&&(p=.1)),V=0;for(var cn=8;cn--;){if(++J>=O&&(J%=O,3==C))for(var fn=rn.length;fn--;)rn[fn]=2*v()-1;switch(C){case 0:U=J/O<h?.5:-.5;break;case 1:U=1-J/O*2;break;case 2:U=.225*(((U=1.27323954*(B=6.28318531*((B=J/O)>.5?B-1:B))+.405284735*B*B*(B<0?1:-1))<0?-1:1)*U*U-U)+U;break;case 3:U=rn[a(32*J/O|0)]}m&&(H=Q,(b*=I)<0?b=0:b>.1&&(b=.1),S?(K+=(U-Q)*b,K*=M):(Q=U,K=0),Z+=(Q+=K)-H,U=Z*=1-p),N&&(en[$%1024]=U,U+=en[($-j+1024)%1024],$++),V+=U}V*=.125*X*D,t[an]=V>=1?32767:V<=-1?-32768:32767*V|0}return w}}function r(){var n=window.innerHeight,t=n*O.cv.width/O.cv.height;O.cv.style.width=t+"px",O.cv.style.height=n+"px"}raf=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)},caf=window.cancelAnimationFrame||window.mozCancelAnimationFrame,Object.prototype.inherits=function(n){this.prototype=Object.create(n.prototype),this.prototype.constructor=this};var a=Math.abs,c=Math.cos,f=Math.sin,x=Math.tan,o=Math.atan,s=Math.atan2,u=Math.ceil,l=Math.floor,h=Math.max,d=Math.min,w=Math.pow,m=Math.sqrt,p=Math.round,v=Math.random,g=Date.now,b=Math.PI,I=function(n,t,e){return n<t?t:null!==e&&void 0!==e&&n>e?e:n},S=function(n,t){return l(v()*(t-n))+n},D=function(n){return n[S(0,n.length)]},R=function(){var n=this,t={},e={};U.body.addEventListener("keydown",function(n){n.keyCode in t&&(n.preventDefault(),e[n.keyCode]=-1,t[n.keyCode]=1)}),U.body.addEventListener("keyup",function(n){n.keyCode in t&&(n.preventDefault(),e[n.keyCode]=1,t[n.keyCode]=0)}),n.p=function(n){if(n instanceof Array){for(var e=0;e<n.length;e++)if(t[n[e]])return 1;return 0}return!!t[n]},n.b=function(n){n.forEach(function(n){t[n]=0,e[n]=0})}},N=function(n,t,e,r){var a=this;a.w=n,a.h=t,a.ww=e,a.wh=r,a.ofx=0,a.ofy=0,a.tg=0,a.setWorldSize=function(n,t){a.ww=n,a.wh=t},a.setTarget=function(n){a.tg=n},a.txPCoord=function(n,t){return{x:n-a.ofx,y:t-a.ofy}},a.txRCoord=function(n){return{x:n.x-a.ofx,y:n.y-a.ofy,r:n.b.r-a.ofx,b:n.b.b-a.ofy}},a.inView=function(n){var t=a.txRCoord(n);return(t.r>=0&&t.r<=a.w||t.x>=0&&t.x<=a.w)&&(t.b>=0&&t.b<=a.h||t.y>=0&&t.y<=a.h)},a.u=function(){if(a.tg){var n,t=0,e=a.w/2,r=a.h/2;a.ww<=a.w?n=a.tg.x:a.tg.x<=e?n=a.tg.x:a.tg.x>e&&a.tg.x+e<=a.ww?n=e:a.tg.x>e&&a.tg.x+e>a.ww&&(n=a.w-(a.ww-a.tg.x)),a.wh<=a.h?t=a.tg.y:a.tg.y<=r?t=a.tg.y:a.tg.y>r&&a.tg.y+r<=a.wh?t=r:a.tg.y>r&&a.tg.y+r>a.wh&&(t=a.h-(a.wh-a.tg.y)),a.ofx=a.tg.x-n,a.ofy=a.tg.y-t}},a.r=function(n){n&&(n instanceof Array||(n=[n]),n.forEach(function(n){if(a.inView(n)){var t=a.txRCoord(n);n.r(t,t.x,t.y)}}))}},G=function(){var n=this;n.reset=function(){n.ex=0,n.t={s:0,fo:0},O.e=0,n.to=null},n.start=function(){n.reset(),n.init(),n.loop()},n.init=function(){},n.loop=function(){O.e=0!==n.t.s?g()-n.t.s:0,n.update(),n.t.s=g(),n.ex||raf(n.loop.bind(n))},n.exit=function(){n.ex=1},n.reset()},k=function(){var n=this;n.e=[],n.add=function(t){n.e.push(t)},n.c=function(t,e){var r,a;for(r=n.e.length;r--;)a=n.e[r],O.cam.inView(a)&&O.o.rect(t,a)&&e(t,a)},n.u=function(){var t,e,r=[];for(t=n.e.length;t--;)(e=n.e[t]).hasOwnProperty("u")&&e.u(),e.a||r.push(t);r.length>0&&(n.e=n.e.filter(function(n,t){return r.indexOf(t)<0}))},n.r=function(){O.cam.r(n.e)},n.clr=function(){n.e=[]}},E=function(n,t,e,r){var a=this;a.x=n,a.y=t,a.w=e,a.h=r,a.a=1,a.b={},a.updateRect=function(){a.b={b:a.y+a.h,t:a.y,l:a.x,r:a.x+a.w}},a.updateRect()},T=function(){var n=this;n.rect=function(n,t){return 0!==Object.keys(n.b).length&&0!==Object.keys(t.b).length&&!(n.b.b<t.b.t||n.b.t>t.b.b||n.b.l>t.b.r||n.b.r<t.b.l)},n.faces=function(n,t){return{t:a(n.b.b-t.b.t),b:a(n.b.t-t.b.b),l:a(n.b.r-t.b.l),r:a(n.b.l-t.b.r)}},n.bottom=function(t,e){var r=n.faces(t,e);return r.t<r.b&&r.t<r.l&&r.t<r.r},n.top=function(t,e){var r=n.faces(t,e);return r.b<r.t&&r.b<r.l&&r.b<r.r},n.right=function(t,e){var r=n.faces(t,e);return r.l<r.b&&r.l<r.t&&r.l<r.r},n.left=function(t,e){var r=n.faces(t,e);return r.r<r.b&&r.r<r.l&&r.r<r.t}},W=function(n,t,e){var r=this;r.arr=n,r.d=t||150,r.c=0,r.f=e||0,r.cb=0,r.u=function(){r.c+=O.e,r.c>r.d&&(r.c=0,r.f+=1,r.f=r.f>r.arr.length-1?0:r.f,r.cb&&r.cb(r.f))},r.g=function(){return r.arr[r.f]}},z=new e;window.jsfxr=function(n){z._params.setSettings(n);var t=z.totalReset(),e=new Uint8Array(4*((t+1)/2|0)+44),r=2*z.synthWave(new Uint16Array(e.buffer,44),t),a=new Uint32Array(e.buffer,0,44);a[0]=1179011410,a[1]=r+36,a[2]=1163280727,a[3]=544501094,a[4]=16,a[5]=65537,a[6]=44100,a[7]=88200,a[8]=1048578,a[9]=1635017060,a[10]=r,r+=44;for(var i=0,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f="data:audio/wav;base64,";i<r;i+=3){var x=e[i]<<16|e[i+1]<<8|e[i+2];f+=c[x>>18]+c[x>>12&63]+c[x>>6&63]+c[63&x]}return f};var C=function(){var n=this;n.s={},n.a=function(t,e,r){r=r||1,n.s[t]=new A(e,r)},n.p=function(t){n.s.hasOwnProperty(t)&&n.s[t].p()}},A=function(n,t){var e=this;e.c=[];for(var r=t;r--;)e.c.push(new P(n));e.p=function(){for(var n=e.c.length;n--;)if(!e.c[n].b){e.c[n].p();break}}},P=function(n){var t=this;t.b=0,t.a=new Audio,t.a.src=jsfxr(n),t.a.addEventListener("playing",function(){t.b=1}),t.a.addEventListener("ended",function(){t.b=0}),t.p=function(){t.a.play().then(function(n){}).catch(function(n){})}},L=function(n,t,e,r){var a=this;a.x=n,a.y=t,a.w=e,a.h=r,a.update=function(){a.b={b:a.y+a.h,t:a.y,l:a.x,r:a.x+a.w}},a.toGrid=function(){return new L(l(a.x/GS),l(a.y/GS),a.w/GS,a.h/GS)},a.center=function(){return new F(a.x+a.w/2,a.y+a.h/2)},a.update()};L.fromGrid=function(n){return new L(n.x*GS,n.y*GS,n.w*GS,n.h*GS)};var F=function(n,t){var e=this;e.x=n,e.y=t,e.toGrid=function(){return new F(l(e.x/GS),l(e.y/GS))}},M=function(n,t,e){var r=this;r.ww=n,r.wh=t,r.mx=e,r.getdist=function(n,t){return m(w(n.x-t.x,2)+w(n.y-t.y,2))},r.neighbors=function(n,t){var e,a,i,c,f,x,o=t-1,s=t+1,u=n+1,l=n-1,h=o>-1&&!O.lvl.isWall(n,o),d=s<r.wh&&!O.lvl.isWall(n,s),w=u<r.ww&&!O.lvl.isWall(u,t),y=l>-1&&!O.lvl.isWall(l,t),m=0,p=0,v=[];return h&&(v.push({x:n,y:o}),e=1),d&&(v.push({x:n,y:s}),i=1),w&&(v.push({x:u,y:t}),a=1),y&&(v.push({x:l,y:t}),m=1),c=m&&e,f=e&&a,x=a&&i,p=i&&m,c&&!O.lvl.isWall(l,o)&&v.push({x:l,y:o}),f&&!O.lvl.isWall(u,o)&&v.push({x:u,y:o}),x&&!O.lvl.isWall(u,s)&&v.push({x:u,y:s}),p&&!O.lvl.isWall(l,s)&&v.push({x:l,y:s}),v},r.findpath=function(n,t){for(var e,a,i,c,f,x,o,s,u=new H(null,new F(n.x,n.y).toGrid(),r.ww),l=new H(null,new F(t.x,t.y).toGrid(),r.ww),h=O.lvl.length(),d=new Array(h),w=[u],y=[],m=[];c=w.length;){for(f=h,x=-1,o=0;o<c;o++)w[o].f<f&&(f=w[o].f,x=o);if((a=w.splice(x,1)[0]).v===l.v){i=y[y.push(a)-1];do{if(m.push(new F(i.x*GS,i.y*GS)),m.length>r.mx)return[]}while(i=i.p);d=y=w=[],m.reverse()}else{for(o=0,s=(e=r.neighbors(a.x,a.y)).length;o<s;o++)d[(i=new H(a,e[o],r.ww)).v]||(i.g=a.g+r.getdist(e[o],a),i.f=a.g+r.getdist(e[o],l),w.push(i),d[i.v]=!0);y.push(a)}}return m}},H=function(n,t,e){var r=this;r.p=n,r.v=t.x+t.y*e,r.x=t.x,r.y=t.y,r.f=0,r.g=0},O={},B=!1,U=document;O.cv=U.querySelector("canvas"),O.init=function(n,t){O.vh=O.cv.height,O.vw=O.cv.width,O.g={},O.e=0,O.x=O.cv.getContext("2d"),O.cam=new N(O.vw,O.vh),O.x.s=O.x.save,O.x.r=O.x.restore,O.x.f=O.x.fill,O.x.k=O.x.stroke,O.x.tn=O.x.translate,O.x.ro=O.x.rotate,O.x.sr=O.x.strokeRect,O.x.cr=O.x.clearRect,O.x.mt=O.x.measureText,O.x.di=O.x.drawImage,O.x.sc=O.x.scale,O.x.bp=O.x.beginPath,O.x.cp=O.x.closePath,O.x.mv=O.x.moveTo,O.x.lt=O.x.lineTo,O.x.e=O.x.ellipse,O.x.lw=function(n){O.x.lineWidth=n},O.x.fr=function(n,t,e,r){O.x.fillRect(l(n),l(t),e,r)},O.x.fs=function(n){O.x.fillStyle=n},O.x.ss=function(n){O.x.strokeStyle=n},O.x.clr=function(n){O.x.cr(0,0,O.vw,O.vh),O.x.fs(n||"#000"),O.x.fr(0,0,O.vw,O.vh)},O.x.ga=function(n){O.x.globalAlpha=n},O.x.ts=function(n,t,e,r){e=e||"serif",r=r||"",O.x.fs(t||"#000"),O.x.font=r+" "+String(n)+"px "+e},O.x.ft=function(n,t,e,r,a,i,c,f){f=f||"l",O.x.ts(t,a,i,c),"r"===f&&(e-=O.x.mt(n).width),O.x.fillText(n,e,r)},O.x.ct=function(n,t,e,r,a,i){O.x.ts(t,r,a,i);var c=O.x.mt(n);O.x.fillText(n,(O.vw-c.width)/2,e)}},O.byId=function(n){return U.getElementById(n)},window.addEventListener("load",r,!1),window.addEventListener("resize",r,!1),GS=64,MIN_PS=1.55,MIN_ZS=1,MAX_ZPD=15,MIN_BD=900,LIVES=3,BEAT=150,IT={A:2,M:3,S:4,F:5},IN={L:[65,81,37],R:[68,39],U:[87,90,38],D:[83,40],E:[13],T:[84]},DIR={LEFT:"l",RIGHT:"r",UP:"u",DOWN:"d"},WPN={MG:{ID:"MACHINEGUN",DL:50,SP:50,SI:10},SG:{ID:"SHOTGUN",DL:300,SP:30,SI:16},FL:{ID:"FLAME",DL:40,SP:7,SI:60}},VACC_PD=1300,DROP=.3,AMMO=10,WH="#fff",BL="#000",RD="#f00",FC="#5a5a5a",AC="#4b4e44",HC="#f3c17f",FN="sans-serif";var V=function(){var n=this;n.inherits(G),G.call(n),n.anim=new W([0,1]),n.init=function(){n.xc=0,n.de=400,n.ef=0},n.update=function(){var t,e;for(n.de=I(n.de-O.e,0),n.xc=I(n.xc-O.e,0),0===n.xc&&n.ef?(n.exit(),O.scn.game.start()):n.ef||n.anim.u(),O.x.clr(WH),O.x.ss("#f80"),O.x.bp(),O.x.lw(12),e=0;e<2;e++)for(t=0;t<20;t++)O.x.mv(1024*e-30*(e+1),30*t),O.x.lt(1024*e+60,30*(t+1));O.x.cp(),O.x.k(),O.x.fs("#f80"),O.x.fr(50,0,O.vw-100,O.vh),O.x.ct("PANDEMIA",125,150,WH,FN),n.anim.g()&&O.x.ct("Press ENTER to start",35,490,WH,FN),O.x.ct("By @satanas82 for js13k 2017",15,550,"#eee",FN);var r=l(O.vw/2),a=l(O.vh/2)+40,i=60;O.x.fs(WH),n.dc(r,a-i+10,i),n.dc(r-i+10,a+30,i),n.dc(r+i-10,a+30,i),O.x.fs("#f80"),n.dc(r,a-40-30,40),n.dc(r-40-30,a+40,40),n.dc(r+40+30,a+40,40),n.dc(r,a,10),!O.in.p(IN.E)||n.ef||n.de||(n.ef=1,n.xc=300,n.anim.f=0,O.sn.p("sl"))},n.dc=function(n,t,e){O.x.bp(),O.x.arc(n,t,e,0,2*b),O.x.cp(),O.x.f()}},_=function(){var n=this;n.maxBlur=5,n.be=0,n.end=0,n.zn=0,n.tries=0,n.zk=0,n.sh=0,n.vm="delivered the vaccine to save the human race.",n.inherits(G),G.call(n),O.ss=new on,O.hud=new xn,n.init=function(){n.be=0,n.end=0,n.zk=0,n.sh=0,O.msg=0,n.zn?(Object.keys(O.g).forEach(function(n){O.g[n].clr()}),n.ww=n.wh=6144,n.tries?O.lvl.reload():O.lvl.gen(n.ww,n.wh)):(Object.keys(O.g).forEach(function(n){O.g[n].clr()}),n.ww=1024,n.wh=576,O.lvl.iroom(n.ww,n.wh)),O.cam.setWorldSize(n.ww,n.wh),O.hud.sws(n.ww,n.wh),O.cam.setTarget(O.player)},n.nz=function(){n.zn+=1,n.reset(),n.init()},n.update=function(){O.x.clr("#787878"),O.msg=0,n.be=I(n.be-O.e,0),O.g.w.u(),O.g.s.u(),O.g.z.u(),O.g.i.u(),O.g.h.u(),O.g.x.u(),O.player.u(),O.g.n.u(),O.g.b.u(),O.cam.u(),O.hud.u(),O.ss.u(),O.g.s.r(),O.g.d.r(),O.g.h.r(),O.g.w.r(),O.g.i.r(),O.g.z.r(),O.cam.r(O.player),O.g.n.r(),O.g.x.r(),O.g.b.r(),O.player.dAim(),O.hud.r(),n.fx(),n.gm(),n.zn||n.pi(),n.mod()},n.fx=function(){var t=O.player.hum,e=0,r=0;e=I(2*(100-t),0,100),t<=70&&t>0&&(r=I(2*(50-t),0,100)),O.cv.style.filter="grayscale("+e+"%) blur("+r*n.maxBlur/100+"px)",n.be&&(O.x.fs("rgba(255,0,0,0.4)"),O.x.fr(0,0,O.vw,O.vh))},n.pi=function(){O.x.fs("rgba(0,0,0,0.5)"),O.x.fr(300,460,430,70),O.x.ct("WASD, ZQSD and ARROWS to move",20,490,WH,FN),O.x.ct("MOUSE to aim and shoot",20,515,WH,FN)},n.over=function(){n.end||(n.end=1,O.sn.p("go"),O.lvl.ds.push(new nn(O.player.x,O.player.y,1)))},n.win=function(){n.end=2,O.sn.p("wn")},n.gm=function(){O.msg&&O.x.ct(O.msg,30,200,WH,FN)},n.mod=function(){if(n.end){var t,e,r=WH,a=FN,i="play again",c=0,f=(O.vw,(O.vh-500)/2);n.rstfx(),1===n.end?(O.x.fs(BL),n.tries<LIVES?(t="YOU DIED",i="send another soldier",O.in.p(IN.E)&&(n.zn=0,n.tries+=1,n.init(),O.sn.p("sl"))):(t="GAME OVER",O.in.p(IN.E)&&n.goToMenu())):2===n.end&&(O.x.fs("#f80"),c=1,t="WELL DONE!",e="You "+n.vm,O.in.p(IN.E)&&n.goToMenu()),O.x.fr(0,0,O.vw,O.vh),O.x.ct(t,90,f+150,r,a),e&&O.x.ct(e,18,f+250,r,a),O.x.ct("Press ENTER to "+i+". T to share",20,f+450,r,a),O.in.p(IN.T)&&n.share(c)}},n.rstfx=function(){O.cv.style.filter=""},n.goToMenu=function(){O.sn.p("sl"),n.tries=0,n.zn=0,n.exit(),O.scn.menu.start()},n.share=function(t){if(!n.sh){n.sh=1;var e=document.createElement("a"),r="I killed "+n.zk+" zombie";n.zn>10&&(r+="s"),r+=t?" and "+n.vm:" but couldn't save the human race.",r+=" Try Pandemia on https://satanas.github.io/pandemia/ #js13k",e.target="_blank",e.href="https://twitter.com/intent/tweet?text="+escape(r),e.click()}}},q=function(){var n=this;n.ww=0,n.wh=0,n.map=[],n.bkmap=[],n.leafs=[],n.root=null,n.maxLeafSize=20,n.pcoord=0,n.os=new L(0,0,0,0),n.iroom=function(t,e){var r=0,a=0;for(n.ww=t/GS,n.wh=e/GS,a=0;a<n.wh;a++)for(n.map[a]=[],r=0;r<n.ww;r++)if(0===a||a===n.wh-1||0===r||r===n.ww-1){if(a>=3&&a<=5&&15===r){O.scn.game.tries||O.g.w.add(new J((r-1)*GS,a*GS));continue}n.map[a][r]="#",O.g.w.add(new Q(r*GS,a*GS))}else n.map[a][r]=".",O.g.d.add(new $(r*GS,a*GS));for(O.g.h.add(new ln(970,202)),O.player=new X(640,320),O.scientist=new Z(320,320),O.g.n.add(O.scientist),O.g.h.add(new dn(256,256)),O.scn.game.tries||O.g.x.add(new fn(128,128)),r=0;r<LIVES-O.scn.game.tries;r++)O.g.n.add(new K(378+100*r,110))},n.gen=function(t,e){var r=0,a=0;for(n.ww=t/GS,n.wh=e/GS,n.os.w=n.ww,n.os.h=n.wh,n.arooms=[],n.srooms=[],n.ds=[],n.makeLeafs(),n.root.createRooms(),a=0;a<n.wh;a++)for(n.map[a]=[],r=0;r<n.ww;r++)n.map[a][r]="#";for(n.leafs.forEach(function(t){var e=t.room;if(null!==e)for(n.arooms.push(L.fromGrid(e)),a=e.y;a<e.y+e.h;a++)for(r=e.x;r<e.x+e.w;r++)n.map[a][r]=".",O.g.d.add(new $(r*GS,a*GS));t.halls.forEach(function(t){if(null!==t&&void 0!==t)for(a=t.y;a<t.y+t.h;a++)for(r=t.x;r<t.x+t.w;r++)n.map[a][r]=".",O.g.d.add(new $(r*GS,a*GS))})}),a=0;a<n.wh;a++)for(r=0;r<n.ww;r++)n.isWall(r,a)&&O.g.w.add(new Q(r*GS,a*GS));var i,c=[];r=S(0,n.arooms.length),i=n.arooms[r].center(),O.vaccine=new fn(i.x,i.y),O.g.x.add(O.vaccine),n.pcoord=new F(i.x,i.y),O.player.reset(i.x,i.y),c.push(r);do{a=S(0,n.arooms.length)}while(a===r||n.getdist(i,n.arooms[a])<=2*n.ww/3*GS);for(i=n.arooms[a].center(),O.endzone=new hn(i.x,i.y),O.g.h.add(O.endzone),r=0;r<n.arooms.length;r++)-1===c.indexOf(r)&&(n.addSpawner(n.arooms[r]),n.srooms.push(n.arooms[r]));n.bkmap=n.map.slice(0)},n.reload=function(){for(n.map=n.bkmap.slice(0),n.ww=n.os.w,n.wh=n.os.h,n.ds=n.ds.filter(function(n){return n.a&&(n.rst(),O.g.z.add(n)),n.a}),O.g.h.add(O.endzone),O.g.x.add(O.vaccine),O.player.reset(n.pcoord.x,n.pcoord.y),j=0;j<n.wh;j++)for(i=0;i<n.ww;i++){var t=n.map[j][i];"#"===t?O.g.w.add(new Q(i*GS,j*GS)):"."===t&&O.g.d.add(new $(i*GS,j*GS))}for(i=0;i<n.srooms.length;i++)O.g.s.add(new tn(n.srooms[i]))},n.isWall=function(t,e){return"#"===n.map[e][t]},n.getWorldSize=function(){return new L(0,0,n.ww*GS,n.wh*GS)},n.length=function(){return n.ww*n.wh},n.addSpawner=function(t){var e=new tn(t),r=new L(e.x,e.y,e.w,e.h).toGrid();for(O.g.s.add(e),j=r.y;j<r.b.b;j++)for(i=r.x;i<r.b.r;i++)n.map[j][i]="s"},n.makeLeafs=function(){var t=!0;for(n.root=new Y(0,0,n.ww,n.wh),n.leafs.push(n.root);t;){t=!1;for(var e=0;e<n.leafs.length;e++){var r=n.leafs[e];null===r.lc&&null===r.rc&&(r.w>n.maxLeafSize||r.h>n.maxLeafSize||v()>.25)&&r.split()&&(n.leafs.push(r.lc),n.leafs.push(r.rc),t=!0)}}},n.print=function(){var t,e,r;for(t=0;t<n.wh;t++)for(r=[],e=0;e<n.ww;e++)r.push(n.map[t][e])},n.getdist=function(n,t){return m(w(n.x-t.x,2)+w(n.y-t.y,2))}},Y=function(n,t,e,r){var i=this;i.x=n,i.y=t,i.w=e,i.h=r,i.lc=null,i.rc=null,i.min=10,i.room=null,i.halls=[],i.split=function(){if(i.lc||i.rc)return 0;var n=!!S(0,2);i.w>i.h&&i.w/i.h>=1.25?n=0:i.h>i.w&&i.h/i.w>=1.25&&(n=1);var t=(n?i.h:i.w)-i.min;if(t<=i.min)return 0;var e=S(i.min,t+1);return n?(i.lc=new Y(i.x,i.y,i.w,e),i.rc=new Y(i.x,i.y+e,i.w,i.h-e)):(i.lc=new Y(i.x,i.y,e,i.h),i.rc=new Y(i.x+e,i.y,i.w-e,i.h)),1},i.createRooms=function(){if(null!==i.lc||null!==i.rc)null!==i.lc&&i.lc.createRooms(),null!==i.rc&&i.rc.createRooms(),null!==i.lc&&null!==i.rc&&i.createHall(i.lc.getRoom(),i.rc.getRoom());else{var n=S(5,i.w-2),t=S(5,i.h-2),e=S(1,i.w-n-1),r=S(1,i.h-t-1);i.room=new L(i.x+e,i.y+r,n,t)}},i.getRoom=function(){if(i.room)return i.room;var n,t;return i.lc&&(n=i.lc.getRoom()),i.rc&&(t=i.rc.getRoom()),n||t?t?n&&v()>.5?n:t:n:null},i.createHall=function(n,t){function e(n,t,e,r){i.halls.push(new L(n,t,e,r))}var r=new F(S(n.b.l+1,n.b.r-2),S(n.b.t+1,n.b.b-2)),c=new F(S(t.b.l+1,t.b.r-2),S(t.b.t+1,t.b.b-2)),f=c.x-r.x,x=c.y-r.y;f<0?x<0?v()<.5?(e(c.x,r.y,a(f),3),e(c.x,c.y,3,a(x))):(e(c.x,c.y,a(f),3),e(r.x,c.y,3,a(x))):x>0?v()<.5?(e(c.x,r.y,a(f),3),e(c.x,r.y,3,a(x))):(e(c.x,c.y,a(f),3),e(r.x,r.y,3,a(x))):e(c.x,c.y,a(f),3):f>0?x<0?v()<.5?(e(r.x,c.y,a(f),3),e(r.x,c.y,3,a(x))):(e(r.x,r.y,a(f),3),e(c.x,c.y,3,a(x))):x>0?v()<.5?(e(r.x,r.y,a(f),3),e(c.x,r.y,3,a(x))):(e(r.x,c.y,a(f),3),e(r.x,r.y,3,a(x))):e(r.x,r.y,a(f),3):x<0?e(c.x,c.y,3,a(x)):x>0&&e(r.x,r.y,3,a(x))}},X=function(n,t){var e=this;e.mxs=0,e.d=DIR.LEFT,e.s=.35,e.dx=0,e.dy=0,e.ic=0,e.hum=100,e.hd=e.hum/420,e.vaccine=0,e.an=0,e.ammo=500,e.hf=0,e.hc=e.hf,e.bd=BEAT,e.bc=0,e.aim=new F(0,0),e.wpn=WPN.MG,e.anim=new W([0,1]),e.inherits(E),E.call(e,n,t,64,64),e.u=function(){0===O.scn.game.end&&(e.hum=I(e.hum-O.e*e.hd/1e3,.1),e.mxs=I(e.hum/10-1.5,MIN_PS),e.sd=I(e.sd-O.e,0),e.ic=I(e.ic-O.e,0),e.hc=I(e.hc-O.e,0),e.bd=I(e.bd-O.e,0),e.hf=10*e.hum,e.anim.u(),O.in.p(IN.L)?(e.d=DIR.LEFT,e.dx-=e.s):O.in.p(IN.R)&&(e.d=DIR.RIGHT,e.dx+=e.s),O.in.p(IN.U)?(e.d=DIR.UP,e.dy-=e.s):O.in.p(IN.D)&&(e.d=DIR.DOWN,e.dy+=e.s),e.dx=I(e.dx,-e.mxs,e.mxs),e.dy=I(e.dy,-e.mxs,e.mxs),O.in.p(IN.L)||O.in.p(IN.R)||(e.dx=0),O.in.p(IN.U)||O.in.p(IN.D)||(e.dy=0),e.x+=e.dx,e.y+=e.dy,e.x=I(e.x,0,O.cam.ww-e.w),e.y=I(e.y,0,O.cam.wh-e.h),e.updateRect(),O.g.w.c(e,function(n,t){O.o.top(n,t)?n.y=t.b.b:O.o.bottom(n,t)&&(n.y=t.b.t-n.h),O.o.left(n,t)?n.x=t.b.r:O.o.right(n,t)&&(n.x=t.b.l-n.w)}),O.g.z.c(e,function(n,t){0===e.ic&&(e.hum=I(e.hum-t.bite(),0),e.ic=300,e.drop(),O.scn.game.be=30,O.ss.shake(4,200),O.sn.p("ph"),e.hum<=0&&(O.scn.game.over(),O.sn.p("fp")))}),O.g.i.c(e,function(n,t){t.a=0,O.sn.p("it"),t.t===IT.A?e.ammo+=AMMO:t.t===IT.M?e.wpn=WPN.MG:t.t===IT.S?e.wpn=WPN.SG:t.t===IT.F&&(e.wpn=WPN.FL)}),e.vaccine||O.g.x.c(e,function(n,t){t.isPickable()&&(O.sn.p("vp"),t.pick(),e.vaccine=t);var r=O.scientist;1===r.st&&r.n()}),e.vaccine&&(e.vaccine.x=e.x+16,e.vaccine.y=e.y),O.g.h.c(e,function(n,t){if(t.end&&e.vaccine&&!t.o)O.scn.game.win();else if(t.intro){if(O.scn.game.tries)return;var r=O.scientist;0===r.st&&r.n()}else t.start&&(O.scn.game.tries?O.scn.game.nz():e.vaccine?O.scn.game.nz():t.al())}),e.hc||(e.bc<2?e.bd||(e.bd=BEAT,e.bc+=1,O.sn.p("hb")):(e.bc=0,e.bd=BEAT,e.hc=e.hf)),e.updateRect(),e.shooting&&!e.sd&&e.shoot())},e.r=function(n){e.d===DIR.UP&&(e.vaccine?fn.d(n.x+16,n.y-6):(O.x.fs(HC),O.x.fr(n.x+9,n.y+44,7,5),O.x.fr(n.x+50,n.y+44,7,5))),O.x.fs("#ffca85"),O.x.fr(n.x+2,n.y,62,38),O.x.fs("#727254"),O.x.fr(n.x+16,n.y+38,34,13),O.x.fs("#203622"),O.x.fr(n.x+16,n.y+50,34,5),e.dx||e.dy?e.anim.g()?O.x.fr(n.x+16,n.y+55,14,8):e.anim.g()||O.x.fr(n.x+36,n.y+55,14,8):(O.x.fr(n.x+16,n.y+55,14,8),O.x.fr(n.x+36,n.y+55,14,8)),e.d!==DIR.UP&&e.d!==DIR.DOWN||(O.x.fs(AC),O.x.fr(n.x+9,n.y+39,7,5),O.x.fr(n.x+50,n.y+39,7,5)),O.x.fs(RD),O.x.fr(n.x+2,n.y+5,62,4),e.d===DIR.UP?(O.x.ss(RD),O.x.lw(3),O.x.bp(),O.x.mv(n.x+20,n.y+20),O.x.lt(n.x+32,n.y+8),O.x.lt(n.x+42,n.y+20),O.x.k()):e.d===DIR.DOWN?(O.x.fs(HC),O.x.fr(n.x+9,n.y+44,7,5),O.x.fr(n.x+50,n.y+44,7,5),O.x.fs(FC),O.x.fr(n.x+15,n.y+19,6,6),O.x.fr(n.x+45,n.y+19,6,6),O.x.fr(n.x+27,n.y+31,12,2),e.vaccine&&fn.d(n.x+16,n.y+16)):e.d===DIR.LEFT?(O.x.fs(AC),O.x.fr(n.x+11,n.y+40,16,7),O.x.fs(HC),O.x.fr(n.x+5,n.y+40,6,7),e.vaccine&&fn.d(n.x-30,n.y+16),O.x.fs(FC),O.x.fr(n.x+10,n.y+19,6,6),O.x.fr(n.x+4,n.y+31,4,2)):e.d===DIR.RIGHT&&(O.x.fs(AC),O.x.fr(n.x+39,n.y+40,16,7),O.x.fs(HC),O.x.fr(n.x+55,n.y+40,6,7),e.vaccine&&fn.d(n.x+62,n.y+16),O.x.fs(FC),O.x.fr(n.x+50,n.y+19,6,6),O.x.fr(n.x+58,n.y+31,4,2))},e.shoot=function(){if(!(e.ammo<=0)){e.drop(),e.sd=e.wpn.DL;var n,t=e.getCenter();if(e.ammo-=1,O.g.b.add(new sn(t.x,t.y,e.an,e.wpn)),e.wpn.ID===WPN.SG.ID){for(n=4;n--;)O.g.b.add(new sn(t.x,t.y,e.an+S(4,15)*b/180,e.wpn)),e.ammo=I(e.ammo-1,0);O.sn.p("sh")}else e.wpn.ID===WPN.FL.ID?O.sn.p("fl"):O.sn.p("gu")}},e.reset=function(n,t){e.x=n,e.y=t,e.vaccine=0},e.drop=function(){e.vaccine&&(e.vaccine.drop(e),e.vaccine=0)},e.getCenter=function(){return new F(e.x+e.w/2,e.y+e.h/2)},e.offc=function(n){return new F(n.x+e.w*e.scaleX/2,n.y+e.h*e.scaleY/2)},e.uAim=function(n){var t=O.cv.getBoundingClientRect(),r=O.cam.txPCoord(e.x,e.y),a=e.offc(r);e.scaleX=O.cv.width/t.width,e.scaleY=O.cv.height/t.height,e.aim.x=(n.clientX-t.left)*e.scaleX,e.aim.y=(n.clientY-t.top)*e.scaleY,e.an=s(e.aim.y-a.y,e.aim.x-a.x)},e.dAim=function(){O.x.fs(RD),O.x.bp(),O.x.arc(e.aim.x,e.aim.y,2,0,2*b),O.x.cp(),O.x.f(),O.x.fr(e.aim.x-2,e.aim.y-18,5,12),O.x.fr(e.aim.x-2,e.aim.y+7,5,12),O.x.fr(e.aim.x-18,e.aim.y-2,12,5),O.x.fr(e.aim.x+7,e.aim.y-2,12,5)},O.cv.addEventListener("mousemove",function(n){e.uAim(n)},!1),O.cv.addEventListener("mousedown",function(n){e.shooting=1}),O.cv.addEventListener("mouseup",function(n){e.shooting=0})},Z=function(n,t){var e=this;e.anim=new W([0,1]),e.st=0,e.ba=1,e.fda=[["Soldier, come here. I need your help"],["the safe zone. So, pick it up...","human race delivering the vaccine to","are all infected. But we can save the","The zombies overrun the place and we"],["the vaccine before you lose your humanity.","Now blow up the barricade and deliver"]],e.sda=[["take it to the safe zone.","Go soldier! Retrieve the vaccine and"]],e.dg=O.scn.game.tries?e.sda:e.fda,e.inherits(E),E.call(e,n,t,64,64),e.u=function(){e.anim.u()},e.r=function(n){var t,r=WH,a=FN,i="#c68642";for(O.x.fs(i),O.x.fr(n.x+2,n.y,62,38),O.x.fs(r),O.x.fr(n.x+16,n.y+38,34,13),O.x.fr(n.x+16,n.y+50,34,5),O.x.fs("#2196f3"),O.x.fr(n.x+43,n.y+38,7,18),O.x.fs("#333"),O.x.fr(n.x+16,n.y+55,14,8),O.x.fr(n.x+36,n.y+55,14,8),O.x.fs("#ededed"),O.x.fr(n.x+30,n.y+40,7,16),O.x.fs(i),O.x.fr(n.x+30,n.y+51,6,7),O.x.fs(FC),O.x.fr(n.x+50,n.y+19,6,6),O.x.fr(n.x+58,n.y+31,4,2),O.x.ss(r),O.x.bp(),O.x.mv(n.x-64,n.y-20),O.x.lt(n.x+128,n.y-20),O.x.mv(n.x+42,n.y),O.x.lt(n.x+5,n.y-20),O.x.cp(),O.x.k(),t=0;t<e.dg[e.st].length;t++)O.x.ft(e.dg[e.st][t],16,250,280-20*t,r,a);1===e.st&&e.anim.g()?O.x.ft("VACCINE",16,110,180,r,a):2===e.st&&e.anim.g()&&e.ba&&O.x.ft("BARRICADE",16,880,300,r,a)},e.n=function(){e.st+=1}},K=function(n,t){var e=this;e.inherits(E),E.call(e,n,t,64,64),e.r=function(n,t,e){O.x.fs("#ffca85"),O.x.fr(t+2,e,62,38),O.x.fs("#727254"),O.x.fr(t+16,e+38,34,13),O.x.fs("#203622"),O.x.fr(t+16,e+50,34,5),O.x.fr(t+16,e+55,14,8),O.x.fr(t+36,e+55,14,8),O.x.fs(AC),O.x.fr(t+9,e+39,7,5),O.x.fr(t+50,e+39,7,5),O.x.fs(HC),O.x.fr(t+9,e+44,7,5),O.x.fr(t+50,e+44,7,5),O.x.fs(FC),O.x.fr(t+15,e+19,6,6),O.x.fr(t+45,e+19,6,6),O.x.fr(t+27,e+31,12,2)}},Q=function(n,t){var e=this;e.inherits(E),E.call(e,n,t,GS,GS),e.r=function(n){O.x.lw(1),O.x.fs("#c2c2c2"),O.x.ss("#949494"),O.x.fr(n.x,n.y,e.w,e.h),O.x.sr(n.x,n.y,e.w,e.h)}},J=function(n,t){var e=this;e.health=S(4,6),e.inherits(E),E.call(e,n,t,GS,GS),e.u=function(){O.g.b.c(e,function(n,t){e.health-=1,e.health<=0&&(O.g.n.add(new un(e.x,e.y)),e.a=0,O.scientist.ba=0,O.sn.p("ex"),O.ss.shake(2,100))})},e.r=function(n){O.x.lw(1);for(var t=0;t<3;t++)O.x.fs("#8d5524"),O.x.fr(n.x,n.y,e.w,e.h),O.x.ss("#522900"),O.x.bp(),O.x.mv(n.x,n.y),O.x.lt(n.x+64,n.y),O.x.mv(n.x,n.y+21),O.x.lt(n.x+64,n.y+21),O.x.mv(n.x,n.y+44),O.x.lt(n.x+64,n.y+44),O.x.cp(),O.x.k()}},$=function(n,t){var e=this;e.inherits(E),E.call(e,n,t,64,64),e.r=function(n){O.x.lw(1),O.x.fs("#787878"),O.x.ss("#696969"),O.x.fr(n.x,n.y,e.w,e.h),O.x.sr(n.x,n.y,e.w,e.h),O.x.bp(),O.x.mv(n.x,n.y+32),O.x.lt(n.x+64,n.y+32),O.x.mv(n.x+32,n.y),O.x.lt(n.x+32,n.y+64),O.x.cp(),O.x.k()}},nn=function(n,t,e){var r=this;r.mindist=500,r.path=[],r.ctimer=300,r.cc=0,r.an=0,r.tp=0,r.bc=0,r.s=v()+MIN_ZS,r.hsc=0,r.gc=S(0,4e3),r.d="d",r.anim=new W([0,1]),r.sol=e,r.health=e?50:S(3,5),r.or=new F(n,t),r.inherits(E),r.inherits(M),E.call(r,n,t,64,64),M.call(r,O.lvl.ww,O.lvl.wh),r.rst=function(){r.x=r.or.x,r.y=r.or.y,r.health=50},r.u=function(){if(2!==O.scn.game.end){r.cc+=O.e,r.hsc=I(r.hsc-O.e,0),r.gc=I(r.gc-O.e,0),r.bc=I(r.bc-O.e,0),!r.gc&&v()>.98&&r.tp&&(O.sn.p("zg"),r.gc=S(1e3,4e3));var n=r.getdist(r,O.player);if(!r.bc)if(0===r.path.length)n<=r.mindist&&p(n)>40&&(r.path=r.findpath(r,O.player,MAX_ZPD),r.tp=new F(O.player.x,O.player.y));else{if(n>r.mindist)return r.tp=null,void(r.path=[]);var t,e,i,x=r.path[0],o=r.getdist(r,x);r.anim.u(),0===o?r.path.shift():(r.an=s(x.y-r.y,x.x-r.x),e=(t=d(o,r.s))*c(r.an),i=t*f(r.an),a(e)>a(i)?r.d=e<0?DIR.LEFT:DIR.RIGHT:r.d=i<0?DIR.UP:DIR.DOWN,r.x+=e,r.y+=i,r.updateRect(),r.cc>=r.ctimer&&null!==r.tp&&(O.player.x!==r.tp.x||O.player.y!==r.tp.y)&&r.clrPath())}O.g.b.c(r,function(n,t){if(t.type!==WPN.FL.ID&&(t.a=0),r.health-=1,r.health<=0){if(O.sn.p("zd"),O.scn.game.zk+=1,r.a=0,O.g.n.add(new un(r.x,r.y)),v()>=DROP){var e=S(3,6),a=r.x,i=r.y;v()<=.8?O.g.i.add(new en(a,i)):e===IT.M?O.g.i.add(new rn(a,i)):e===IT.S?O.g.i.add(new an(a,i)):e===IT.F&&O.g.i.add(new cn(a,i))}}else r.hsc||(O.sn.p("zh"),r.hsc=700)}),O.g.h.c(r,function(n,t){t.end&&t.occ()})}},r.r=function(n){nn.d(n.x,n.y,r.d,r.tp,r.anim,r.sol)},r.bite=function(){return r.bc=S(MIN_BD,MIN_BD+200),S(4,8)},r.clrPath=function(){r.path.splice(1,r.path.length),r.cc=0}};nn.d=function(n,t,e,r,a,i){var c,f,x,o,s;o="#84ae8d",i?(s="#607d8b",c="#727254",f="#203622",x=AC):(s="#a0d6ab",c="#83bd90",f="#8b938d",x="#8ecc9b"),O.x.fs(s),O.x.fr(n+2,t,62,38),O.x.fs(c),O.x.fr(n+16,t+38,34,13),O.x.fs(f),O.x.fr(n+16,t+50,34,5),r?a&&(a.g()?O.x.fr(n+16,t+55,14,8):O.x.fr(n+36,t+55,14,8)):(O.x.fr(n+16,t+55,14,8),O.x.fr(n+36,t+55,14,8)),e===DIR.UP?(O.x.fs(x),O.x.fr(n+9,t+39,7,5),O.x.fr(n+50,t+39,7,5)):e===DIR.DOWN?(O.x.fs(x),O.x.fr(n+9,t+39,7,10),O.x.fr(n+50,t+39,7,10),O.x.fs(o),O.x.fr(n+9,t+49,7,5),O.x.fr(n+50,t+49,7,5),O.x.fs(FC),O.x.fr(n+15,t+19,6,6),O.x.fr(n+45,t+19,6,6),O.x.fr(n+32,t+26,2,9),O.x.fr(n+27,t+31,12,2)):e===DIR.LEFT?(O.x.fs(x),O.x.fr(n+11,t+40,16,7),O.x.fs(o),O.x.fr(n+5,t+40,6,7),O.x.fs(FC),O.x.fr(n+10,t+19,6,6),O.x.fr(n+2,t+26,2,9),O.x.fr(n+4,t+31,4,2)):e===DIR.RIGHT&&(O.x.fs(x),O.x.fr(n+39,t+40,16,7),O.x.fs(o),O.x.fr(n+55,t+40,6,7),O.x.fs(FC),O.x.fr(n+50,t+19,6,6),O.x.fr(n+62,t+26,2,9),O.x.fr(n+58,t+31,4,2))};var tn=function(n){var t=this;t.ro=n,t.ad=1e3,t.z=[],t.c=0,t.inherits(E),E.call(t,t.ro.x,t.ro.y,64,64),t.u=function(){var n,e=m(w(t.x-O.player.x,2)+w(t.y-O.player.y,2)),r=l(S(t.ro.x,t.ro.x+t.ro.w-32)),a=l(S(t.ro.y,t.ro.y+t.ro.h-32)),i=e<=t.ad||O.o.rect(O.player,t.ro);t.c||i?i||(t.c=I(t.c-O.e,0)):(n=new nn(r,a),t.z.push(n),O.g.z.add(n),t.z.length>=20&&(t.c=8e3)),t.z=t.z.filter(function(n){return n.a})},t.r=function(n){}},en=function(n,t){var e=this;e.t=IT.A,e.inherits(E),E.call(e,n,t,32,32),e.r=function(n){en.d(n.x,n.y)}};en.d=function(n,t){O.x.fs("#f6de88"),O.x.fr(n,t,32,6),O.x.fs("#f2c010"),O.x.fr(n,t+6,32,6),O.x.fs("#9b4a0e"),O.x.fr(n,t+12,32,20),O.x.fs("#571a08"),O.x.fr(n+7,t,6,32),O.x.fr(n+20,t,6,32),O.x.fs("#121212"),O.x.fr(n,t+27,32,5)};var rn=function(n,t){var e=this;e.t=IT.M,e.inherits(E),E.call(e,n,t,32,32),e.r=function(n){rn.d(n.x,n.y)}};rn.d=function(n,t){O.x.fs(FC),O.x.fr(n+8,t+14,51,9),O.x.fs("#2b2b2b"),O.x.fr(n,t+23,64,6),O.x.fr(n,t+28,4,4),O.x.fr(n+8,t+28,51,4),O.x.fr(n+12,t+32,42,4),O.x.fr(n+20,t+36,4,4),O.x.fr(n+8,t+36,11,8),O.x.fr(n+4,t+40,11,8),O.x.fr(n+28,t+36,10,21),O.x.fr(n+46,t+36,8,14),O.x.fr(n+12,t+10,8,4),O.x.fr(n+52,t+10,4,4)};var an=function(n,t){var e=this;e.t=IT.S,e.inherits(E),E.call(e,n,t,32,32),e.r=function(n){an.d(n.x,n.y)}};an.d=function(n,t){O.x.fs("#9e9e9e"),O.x.fr(n+12,t+19,52,8),O.x.fr(n+57,t+11,4,8),O.x.fs(FC),O.x.fr(n+12,t+27,52,8),O.x.fs("#795548"),O.x.fr(n,t+31,8,24),O.x.fr(n+4,t+27,8,24),O.x.fr(n+12,t+35,35,8)};var cn=function(n,t){var e=this;e.t=IT.F,e.inherits(E),E.call(e,n,t,64,64),e.r=function(n){cn.d(n.x,n.y)}};cn.d=function(n,t){O.x.fs("#f44336"),O.x.fr(n+10,t+13,30,10),O.x.fs("#ffeb3b"),O.x.fr(n+40,t+13,4,10),O.x.fs(BL),O.x.fr(n,t+18,4,23),O.x.fr(n,t+22,64,4),O.x.fr(n+11,t+18,21,4),O.x.fr(n,t+26,45,6),O.x.fr(n+5,t+32,5,17),O.x.fr(n+10,t+32,7,4),O.x.fr(n+8,t+44,7,9),O.x.fr(n+15,t+44,10,3),O.x.fr(n+21,t+32,4,12)};var fn=function(n,t){var e=this;e.pk=0,e.anim=new W([0,1]),e.pd=0,e.inherits(E),E.call(e,n,t,32,32),e.u=function(){e.anim.u(),e.pd=I(e.pd-O.e,0),e.updateRect()},e.r=function(n){e.pk||(e.pd>0&&e.anim.g()?(O.x.fs(RD),O.x.fr(n.x,n.y,e.w,e.h)):fn.d(n.x,n.y))},e.isPickable=function(){return!e.pd},e.pick=function(){e.pk=1},e.drop=function(n){e.pk=0,O.sn.p("vd"),e.pd=VACC_PD,e.x=n.x+16,e.y=n.b.b-32}};fn.d=function(n,t,e){O.x.fs("#3f51b5"),O.x.fr(n,t,32,32),O.x.fs("#4caf50"),O.x.fr(n+13,t+6,7,19),O.x.fs("#9e9e9e"),O.x.fr(n+11,t+1,10,2),O.x.fr(n+15,t+3,3,3),O.x.fr(n+9,t+8,14,2),O.x.fr(n+16,t+26,1,6)};var xn=function(){var n=this;n.bmx=300,n.bw=n.bmx,n.mm=new L(O.vw-140,O.vh-140,120,120),n.sws=function(t,e){n.ww=t,n.wh=e},n.u=function(){n.bw=O.player.hum*n.bmx/100},n.r=function(){var t=WH,e=FN;O.x.fs("#333"),O.x.fr(50,30,n.bmx,30),O.x.fs(RD),O.x.fr(50,30,n.bw,30),O.x.ft("HUMANITY",26,60,55,t,e),en.d(670,30),O.x.ft("AMMO:",26,720,55,t,e),O.x.ft(O.player.ammo+"",26,820,55,t,e);var r,a=(O.vw-64)/2;O.x.fs("rgba(220,220,220,0.6)"),O.x.fr(a-2,14,68,68),O.x.ss(t),O.x.lw(4),O.x.sr(a-2,14,68,68),O.player.wpn.ID===WPN.MG.ID?rn.d(a,16,64,64):O.player.wpn.ID===WPN.SG.ID?an.d(a,16,64,64):O.player.wpn.ID===WPN.FL.ID&&cn.d(a,16,64,64),O.player.vaccine?(O.x.fs("rgba(0,0,0,0.8)"),O.x.fr(a,16,64,64),fn.d(a+16,32),r="VACCINE"):r=O.player.wpn.ID,O.x.ct(r,18,105,t,e);O.scn.game.zn&&(n.dc(n.mm.x+5,n.mm.y-18,"#0f0"),O.x.ft("= safe zone",11,n.mm.x+10,n.mm.y-15,t,e),n.dc(n.mm.x+5,n.mm.y-8,"#f0f"),O.x.ft("= vaccine",11,n.mm.x+10,n.mm.y-5,t,e),O.x.ga(.5),O.x.fs("#04d"),O.x.fr(n.mm.x,n.mm.y,n.mm.w,n.mm.h),O.x.ga(.7),n.rp(O.player.x,O.player.y,t),n.rp(O.endzone.x,O.endzone.y,"#0f0"),n.rp(O.vaccine.x,O.vaccine.y,"#f0f"),O.x.ga(1))},n.rp=function(t,e,r){var a=l(120*t/n.ww),i=l(120*e/n.wh);n.dc(n.mm.x+a,n.mm.y+i,r)},n.dc=function(n,t,e){O.x.fs(e),O.x.bp(),O.x.arc(n,t,2,0,2*b),O.x.cp(),O.x.f()}},on=function(){var n=this;n.elapsed=0,n.duration=0,n.magnitude=0,n.speed=20,n.perc=0,n.u=function(){if(n.duration&&n.elapsed<n.duration){n.elapsed+=O.e;var t=n.elapsed/n.duration,e=1-I(4*t-3,0,.1),r=v()%32768*D([-1,1]);y=v()%32768*D([-1,1]),r*=n.magnitude*e,y*=n.magnitude*e,O.cam.ofx+=r,O.cam.ofy+=y,n.elapsed>=n.duration&&(n.duration=0)}},n.shake=function(t,e){n.elapsed=0,n.perc=0,n.duration=e,n.magnitude=t}},sn=function(n,t,e,r){var a=this;a.an=e,a.type=r,a.sp=a.type.SP,a.lt=500,a.type.ID===WPN.FL.ID&&(a.an+=S(-8,8)*b/180,a.anVar=a.an+D([-20,-15,0,15,20])*b/180,a.xdecay=20,a.color=7,a.w=S(40,60)),a.inherits(E),n+=20*c(e),t+=20*f(e),E.call(a,n,t,a.type.SI,a.type.SI),a.u=function(){a.x+=a.sp*c(a.an),a.y+=a.sp*f(a.an),a.type.ID!==WPN.FL.ID?O.g.w.c(a,function(n,t){a.a=0}):(a.w=I(a.w-O.e*a.xdecay/1e3,1),a.lt=I(a.lt-O.e,0),a.color=I(a.color+O.e/12,7,22),a.lt<400&&a.anVar&&(a.an=a.anVar,a.anVar=0)),O.cam.inView(a)&&a.lt||(a.a=0),a.updateRect()},a.r=function(n){if(a.type.ID===WPN.FL.ID){var t=255*a.color/100,e=a.lt/200;O.x.fs("hsla("+t+",100%,50%,"+e+")")}else O.x.fs(WH);O.x.bp(),O.x.arc(n.x,n.y,a.w/2,0,2*b),O.x.cp(),O.x.f()}},un=function(n,t){var e=this;e.l=100,e.inherits(E),E.call(e,n,t,64,64),e.u=function(){e.l-=O.e,e.w=I(e.w-64*O.e/100,0),e.l<0&&(e.a=0)},e.r=function(n){O.x.fs(WH),O.x.bp(),O.x.arc(n.x+32,n.y+32,e.w,0,2*b),O.x.cp(),O.x.f()}},ln=function(n,t){var e=this;e.start=1,e.ac=0,e.inherits(E),E.call(e,n,t,54,172),e.u=function(){e.ac=I(e.ac-O.e,0),e.ac&&!O.scn.game.tries&&(O.msg="You cannot leave the lab without the vaccine")},e.r=function(n){},e.al=function(){e.ac||(e.ac=2e3)}},hn=function(n,t){var e=this;e.end=1,e.ow=256,e.oh=160,e.oc=0,e.inherits(E),E.call(e,n-64,t-40,e.ow/2,e.oh/2),e.ca=U.createElement("canvas"),e.ca.width=2*e.ow,e.ca.width=2*e.oh,e.cx=e.ca.getContext("2d"),e.lw=16,e.u=function(){e.oc=I(e.oc-O.e,0),e.oc&&(O.msg="There are zombies in the safe zone. Kill them first!")},e.r=function(n){var t,r,a=n.x-64,i=n.y-40;for(e.cx.lineWidth=1,e.cx.fillStyle=BL,e.cx.beginPath(),t=1;t<=13;t++)r=2*e.lw*t,e.cx.moveTo(0,0+r),e.cx.lineTo(0,0+r-e.lw),e.cx.lineTo(0+r-e.lw,0),e.cx.lineTo(0+r,0),e.cx.lineTo(0,0+r),e.cx.closePath();e.cx.fill(),O.x.fs("yellow"),O.x.fr(a,i,e.ow,e.oh),O.x.di(e.ca,0,0,256,160,a,i,256,160),O.x.fs(BL),O.x.fr(n.x-64,n.y+90,e.ow,30),O.x.ft("SAFE ZONE",18,n.x+10,n.y+110,WH,FN)},e.occ=function(){e.oc=1e3}},dn=function(n,t){var e=this;e.intro=1,e.inherits(E),E.call(e,n,t,192,192),e.r=function(n){}};window.addEventListener("load",function(){O.init(),O.in=new R,O.o=new T,O.in.b([].concat(IN.L).concat(IN.R).concat(IN.U).concat(IN.D).concat(IN.E).concat(IN.T)),O.g.w=new k,O.g.z=new k,O.g.s=new k,O.g.i=new k,O.g.h=new k,O.g.b=new k,O.g.x=new k,O.g.n=new k,O.g.d=new k,O.lvl=new q,O.sn=new C,O.sn.a("gu",[1,,.1799,.138,.3683,.6868,.0362,-.5561,,,,,,.0728,.1995,,,,1,,,.1175,,.4],10),O.sn.a("sh",[,.001,.228,.039,.228,.418,,-.465,,,,,,.195,.0166,,,,1,,,.1804,,.5],9),O.sn.a("fl",[3,,.3554,.2783,.3645,.0744,,,,,,,,,,,,,1,,,,,.36],9),O.sn.a("ph",[,,.0209,,.1543,.344,,-.3079,,,,,,.1952,,,,,1,,,,,.5],1),O.sn.a("vd",[,,.1832,,.3385,.3446,,.2004,,,,,,.082,,.439,,,1,,,,,.3],1),O.sn.a("vp",[1,,.123,,.2337,.35,,.443,-.139,,,,,1,,.662,,,1,,,,,.4],1),O.sn.a("zh",[,,.0279,,.178,.2231,,-.3218,,,,,,.3812,,,,,1,,,,,.7],20),O.sn.a("zg",[,,.274,.011,.386,.147,,.162,-.257,,,.066,-.6916,.7262,-.2,-.8884,.016,.016,1,1,,,.016,.4],10),O.sn.a("sl",[,,.2695,,.3831,.215,,.3887,,,,,,.1218,,.5948,,,1,,,,,.6],1),O.sn.a("zd",[3,,.199,.2506,.436,.0582,,.285,,.5539,.3764,-.7496,.7366,,,,,,1,,,,,.7],9),O.sn.a("ex",[3,,.3825,.4313,.3835,.7215,,-.3735,,,,,,,,,.0109,-.0889,1,,,,,.5],9),O.sn.a("go",[3,,.2291,.2146,.4937,.1678,,-.031,,.1136,.5919,-.7315,.8418,,,.7931,-.0576,-.0337,1,,,,,.6],1),O.sn.a("wn",[,.003,.762,,.555,.393,,.186,-.117,.685,.518,,,.4869,,.3,1,-.574,1,,,,,.7],1),O.sn.a("it",[,,.0114,,.1006,.4195,,.333,,,,,,.0069,,.5867,,,1,,,,,.5],10),O.sn.a("hb",[1,,.0609,,.1962,.3755,,-.6577,,,,,,1,,,,,1,,,,,.6],2),O.sn.a("fp",[2,,1,,,.3517,,,,,,,,,,,,,1,,,,,.7],1),O.scn={},O.scn.menu=new V,O.scn.game=new _,O.scn.menu.start()});