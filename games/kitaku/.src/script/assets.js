!function(){function t(t,i){this.type=Const.actors.player,this.enabled=!0,this.home={x:t,y:i},this.x=t,this.y=i,this.z=0,this.width=32,this.length=32,this.dx=0,this.dy=0,this.dz=0,this.bonus=0,this.amount=1,this.death=!1,this.jumping=!1,this.dest={x:0,y:0},this.accel=90,this.action=Const.actions.up,this.status=0,this.anims=[],this.anims.push(new AnimObj(0,-60,0,Factory.Hat())),this.ride={on:null,a:0},this.help=null,this.shadow=[Factory.Tile("rgba(100, 100, 100, 0.3)",this.width)],this.body=[Factory.Man2(0),Util.FlipX(Factory.Man1(0)),Util.FlipX(Factory.Man2(0)),Factory.Man1(0),[],[],Factory.Flat()],this.reset=function(t){1==t&&(this.death=t),this.jumping=!1,this.dx=0,this.dy=0,this.z=0}}t.prototype={Logic:function(t){var i=this.accel*t;if(0==this.death)if(this.jumping){var s=AssetUtil.HopLogic(this,32,16);if(!this.jumping){if(this.status=0,-1!=map.colliders.over.indexOf(s)){if(s>12&&s<16)if(1==this.ride.a)this.ride.a=2;else{this.ride.a=0,this.action=Const.actions.splash,this.anims[0].enabled=!1;for(var h=0;h<8;h++)this.anims.push(new AnimObj(0,0,60,Factory.Cube(["#2BA6FF","#49B3FF","#77C6FF"],Util.RndI(6,8)),!0))}else{this.action=Const.actions.fall;for(h=0;h<this.anims.length;h++)this.anims[h].d.x=0,this.anims[h].d.y=-48,this.anims[h].ct=80,this.anims[h].die=!0}0==this.ride.a&&this.reset(!0)}else{this.ride={on:null,a:0};var o=gameAsset.scene.Cell(this.x,this.y,32);this.x=o.x,this.y=o.y}-1!=map.colliders.home.indexOf(s)&&(this.status=Const.game.status.home)}}else{var e={up:2!=this.ride.a&&(input.isDown("UP")||input.isDown("W")),down:2!=this.ride.a&&(input.isDown("DOWN")||input.isDown("S")),left:input.isDown("LEFT")||input.isDown("A"),right:input.isDown("RIGHT")||input.isDown("D")};AssetUtil.InputLogic(e,this,i,32),2==this.ride.a&&(null==this.ride.on||this.ride.on.enabled||(this.ride.a=0,this.reset(!0)),this.jumping&&(this.ride={on:null,a:3}))}},Update:function(t){2==this.ride.a?(this.x=this.ride.on.x,this.y=this.ride.on.y):(this.x+=this.dx,this.y+=this.dy);for(var i=0;i<this.anims.length;i++)this.anims[i].enabled&&this.anims[i].Update(t);this.bonus>0&&(this.bonus--,0==this.bonus&&(this.amount=1))},Collider:function(t){if(0==this.ride.a){var i;if(this.jumping)!(i=AssetUtil.Collisions(this,t,this.jumping))||i.type!=Const.actors.stump&&i.type!=Const.actors.dood||this.reset();if((i=AssetUtil.Collisions(this,t,!1))&&i.type==Const.actors.log)this.ride={on:i,a:1};else if(i&&i.type>=Const.actors.carhr&&i.type<=Const.actors.drone){this.reset(!0),this.action=Const.actions.squash;for(var s=0;s<this.anims.length;s++)this.anims[s].ct=80}}},Render:function(t){var i=this.x,s=this.y,h=Util.IsoPoint(i-t.x,s-t.y);this.death||Renderer.PolySprite(h.x,h.y,this.shadow),Renderer.PolySprite(h.x,h.y-this.z,this.body[this.action]);for(var o=0;o<this.anims.length;o++)this.anims[o].enabled&&(this.anims[o].p.y=h.y-this.z,this.anims[o].p.x=h.x,this.anims[o].Render());if(null!=this.help){var e=this.help.c.S(),a=this.help.d;i=400,s=300;e.v&&(a.right?(i=600,s=458):a.left?(i=150,s=100):a.up?(s=100,i=600):a.down&&(s=458,i=150),Renderer.ImgText(29,go[this.help.t],i,s,2,"rgba(255,0,0,1)")),e.a||(this.help=null)}}},window.Player=t}(),function(){function t(t,i,s){this.type=Const.actors.dood,this.enabled=!0,this.death=0,this.hold=0,this.x=t,this.y=i,this.z=0,this.width=24,this.length=24,this.ol=!1,this.range={see:224,follow:{min:64,max:160}},this.accel=70;var h=dCols[s];this.id=s,s=0,this.ride={on:null,a:0},this.dx=0,this.dy=0,this.dz=0,this.jumping=!1,this.dest={x:0,y:0},this.status=Const.game.status.lost,this.target=null,this.shadow=[Factory.Tile("rgba(100, 100, 100, 0.3)",this.width)],this.action=Const.actions.up,this.anims=[],this.value={val:0,x:0,y:0,f:0};var o=[[Factory.Boy2(0,h),Util.FlipX(Factory.Boy1(0,h)),Util.FlipX(Factory.Boy2(0,h)),Factory.Boy1(0,h),[],[],Factory.Flat(h),Factory.Boy2(1,h),Util.FlipX(Factory.Boy1(1,h)),Util.FlipX(Factory.Boy2(1,h)),Factory.Boy1(1,h)]];this.body=o[s]}t.prototype={Logic:function(t){var i=this.accel*t;if(this.death>0)this.death--,this.death;else if(this.target)if(this.hold>0)this.jumping=!1,this.hold--;else if(this.jumping){var s=AssetUtil.HopLogic(this,2==this.ride.a?32:16,2==this.ride.a?16:8);if(this.status!=Const.game.status.home&&!this.jumping){if(-1!=map.colliders.over.indexOf(s)){if(s>12&&s<16)if(1==this.ride.a)this.ride.a=2;else{this.action=Const.actions.splash;for(var h=0;h<8;h++)this.anims.push(new AnimObj(0,0,60,Factory.Cube(["#2BA6FF","#49B3FF","#77C6FF"],Util.RndI(6,8)),!0))}else{this.action=Const.actions.fall;for(h=0;h<this.anims.length;h++)this.anims[h].ct=80}0==this.ride.a&&(this.death=5e3,this.jumping=!1,this.dx=0,this.dy=0,this.z=0,this.type=Const.actors.null)}else if(3==this.ride.a){this.ride={on:null,a:0};var o=gameAsset.scene.Cell(this.x,this.y,32);this.x=o.x,this.y=o.y}-1!=map.colliders.home.indexOf(s)&&(this.status=Const.game.status.home,this.target.bonus>0&&this.target.amount++,plyrScore+=100*this.target.amount,this.target.bonus=500,this.value={val:this.target.amount,x:-16,y:-112,f:64},this.target=this.target.home,this.range.follow.min=32)}}else{var e=AssetUtil.Dir(this.target,this);e.d<this.range.follow.max&&e.d>this.range.follow.min?(this.status==Const.game.status.lost&&(this.status=Const.game.status.follow),this.range.follow.max=1e4,AssetUtil.InputLogic(e,this,i,16),2==this.ride.a&&this.jumping&&(this.ride={on:null,a:3})):e.d<this.range.see&&this.status!=Const.game.status.follow&&(e.right?this.action=this.ol?Const.actions.waveleft:Const.actions.waveright:e.left?this.action=this.ol?Const.actions.waveright:Const.actions.waveleft:e.up?this.action=this.ol?Const.actions.wavedown:Const.actions.waveup:e.down&&(this.action=this.ol?Const.actions.waveup:Const.actions.wavedown))}},Update:function(t){2==this.ride.a?(this.x=this.ride.on.x,this.y=this.ride.on.y):(this.x+=this.dx,this.y+=this.dy);for(var i=0;i<this.anims.length;i++)this.anims[i].enabled&&this.anims[i].Update(t)},Collider:function(t){if(0==this.ride.a){var i;if(this.jumping)!(i=AssetUtil.Collisions(this,t,this.jumping))||i.type!=Const.actors.stump&&i.type!=Const.actors.player&&i.type!=Const.actors.dood||(this.jumping=!1,this.dx=0,this.dy=0,this.z=0);(i=AssetUtil.Collisions(this,t,!1))&&i.type==Const.actors.log?this.ride={on:i,a:1}:i&&i.type>=Const.actors.carhr&&i.type<=Const.actors.drone&&(this.death=5e3,this.jumping=!1,this.dx=0,this.dy=0,this.z=0,this.action=Const.actions.squash,this.type=Const.actors.null)}},Render:function(t){var i=this.x,s=this.y,h=Util.IsoPoint(i-t.x,s-t.y);0==this.death&&Renderer.PolySprite(h.x,h.y,this.shadow),Renderer.PolySprite(h.x,h.y-this.z,this.body[this.action]),this.value.f>1&&this.value.val>0&&Renderer.ImgText(22,scrs[this.value.val-1],h.x-16,h.y-112,2,"rgba(255,0,0,"+this.value.f--/100+")");for(var o=0;o<this.anims.length;o++)this.anims[o].enabled&&(this.anims[o].p.y=h.y-this.z,this.anims[o].p.x=h.x,this.anims[o].Render())}},window.Dood=t}(),function(){function t(t,i,s,h){this.type=h,this.enabled=!0,this.x=t,this.y=i,this.z=0,this.width=32,this.length=32,this.dx=0,this.dy=0,this.dz=0,this.skip=0,this.stop=0,this.driving=0,this.dest={x:0,y:0},this.accel=2,this.max=s;var o=s<2?0:s<3.2?1:2;this.cols=[["#6287BF","#4D67A7","#94B7CD"],["#FDB42B","#B46219","#FFC030"],["#DA4938","#831816","#F16152"]],this.color=this.cols[o];var e=[Util.Scale(Factory.CarF(this.cols[o]),1),Util.Scale(Factory.CarB(this.cols[o]),1),Util.Scale(Util.FlipX(Factory.CarB(this.cols[o])),1),Util.Scale(Util.FlipX(Factory.CarF(this.cols[o])),1)];this.body=e[this.type-Const.actors.carhr]}t.prototype={Logic:function(t){var i=this.accel*t,s=Const.game.friction*t;if(0==this.driving){this.type==Const.actors.carhl?(this.dx-=this.dx>-this.max?i:0,this.dest={x:this.x-64,y:this.y}):this.type==Const.actors.carhr?(this.dx+=this.dx<this.max?i:0,this.dest={x:this.x+64,y:this.y}):this.type==Const.actors.carvu?(this.dy-=this.dy>-this.max?i:0,this.dest={x:this.x,y:this.y-64}):this.type==Const.actors.carvd&&(this.dy+=this.dy<this.max?i:0,this.dest={x:this.x,y:this.y+64});var h=gameAsset.scene.Content(this.x,this.y);-1!=map.colliders.fend.indexOf(h)&&(this.enabled=!1)}else this.dx<0?this.dx=this.dx+s>0?0:this.dx+s:this.dx>0&&(this.dx=this.dx-s<0?0:this.dx-s),this.dy<0?this.dy=this.dy+s>0?0:this.dy+s:this.dy>0&&(this.dy=this.dy-s<0?0:this.dy-s),this.driving--;this.stop>100&&(this.driving=0,this.stop=0,this.skip=64),this.skip>1&&this.skip--},Update:function(t){this.x+=this.dx,this.y+=this.dy},Collider:function(t){var i=AssetUtil.Collisions(this,t,!0);i&&i.type>=Const.actors.carhr&&i.type<=Const.actors.drone&&(0==this.skip?(this.driving=64,this.max=i.max,this.stop++):this.stop=0)},Render:function(t){var i=this.x,s=this.y,h=Util.IsoPoint(i-t.x,s-t.y);Renderer.PolySprite(h.x,h.y-this.z,this.body)}},window.Car=t}(),function(){function t(t){this.type=Const.actors.Drone,this.enabled=!0,this.x,this.y,this.z=0,this.width=32,this.length=32,this.target=t,this.offset={x:0,y:0},this.target.type==Const.actors.carvu?(this.body=Util.Scale(Util.FlipX(Factory.CarF(this.target.color)),1),this.offset.y=32):this.target.type==Const.actors.carvd?(this.body=Util.Scale(Util.FlipX(Factory.CarB(this.target.color)),1),this.offset.y=-32):this.target.type==Const.actors.carhl?(this.body=Util.Scale(Factory.CarF(this.target.color),1),this.offset.x=32):this.target.type==Const.actors.carhr&&(this.body=Util.Scale(Factory.CarB(this.target.color),1),this.offset.x=-32),this.dx=0,this.dy=0,this.dz=0,this.max=this.target.max}t.prototype={Logic:function(t){},Update:function(t){this.x=this.target.x+this.offset.x,this.y=this.target.y+this.offset.y,this.max=this.target.max,this.enabled=this.target.enabled},Collider:function(t){},Render:function(t){var i=this.target.x+this.offset.x,s=this.target.y+this.offset.y,h=Util.IsoPoint(i-t.x,s-t.y);Renderer.PolySprite(h.x,h.y-this.z,this.body)}},window.Drone=t}(),function(){function t(t,i,s,h,o,e){this.type=s,this.enabled=!0,this.x=t,this.y=i,this.z=0,this.width=h,this.length=h,this.dx=0,this.dy=0,this.dz=0,this.accel=o,this.max=e,this.body=s==Const.actors.log?Fac[4]:Util.OneOf([Fac[3],Util.FlipX(Fac[3]),Fac[2],Fac[0],Fac[1]])}t.prototype={Logic:function(t){if(this.type==Const.actors.log){var i=this.accel*t;this.dy-=this.dy>-this.max?i:0;var s=gameAsset.scene.Content(this.x,this.y);-1!=map.colliders.fend.indexOf(s)&&(this.enabled=!1)}},Update:function(t){this.type==Const.actors.log&&(this.x+=this.dx,this.y+=this.dy)},Collider:function(t){},Render:function(t){var i=Util.IsoPoint(this.x-t.x,this.y-t.y);Renderer.PolySprite(i.x,i.y-this.z,this.body)}},window.Feature=t}(),function(){function t(t,i,s,h,o){this.type=Const.actors.null,this.enabled=!0,this.p={x:0,y:0},this.o={x:t,y:i},this.ct=s,this.d={x:Util.Rnd(64)-32,y:-(Util.Rnd(64)+32)},this.body=h,this.die=o}t.prototype={Update:function(t){this.ct>0&&(this.ct--,this.o.y+=this.d.y*t,this.o.x+=this.d.x*t,this.d.y+=2.5,0==this.ct&&this.die&&(this.enabled=!1))},Render:function(){Renderer.PolySprite(this.p.x+this.o.x,this.p.y+this.o.y,this.body)}},window.AnimObj=t}();