!function(){"use strict";function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function t(){var e=35208;return function(){var t=e>>1&1,r=e>>9&1,i=t^r;return e=(i<<15|e>>>1)>>>0}}function r(e){return function(){return(e()-2)/65532}}function i(e,t,r,i,n){var a=document.createElement("canvas");a.width=e.width,a.height=e.height;var o=a.getContext("2d");o.drawImage(e,0,0);for(var s=o.getImageData(0,0,a.width,a.height),u=s.data,l=0;l<u.length;l+=4)u[l+0]=t,u[l+1]=r,u[l+2]=i,u[l+3]=0!==u[l+3]?n:0;return o.putImageData(s,0,0),a}function n(e,n,a){var o,s=12,u=9,l=16,c=(o={},we(o,Y,{x:0,y:5*s,w:s,h:s}),we(o,J,{x:0,y:4*s,w:s,h:s}),we(o,Z,{x:0,y:3*s,w:s,h:s}),we(o,q,{x:0,y:7*s,w:s,h:s}),we(o,ae,{x:0,y:9*s,w:s,h:s}),we(o,oe,{x:0,y:10*s,w:s,h:s}),we(o,se,{x:0,y:11*s,w:s,h:s}),we(o,ue,{x:0,y:12*s,w:s,h:s}),we(o,le,{x:0,y:14*s,w:s,h:s}),we(o,ce,{x:0,y:13*s,w:s,h:s}),we(o,j,{x:0,y:0*s,w:s,h:s}),we(o,Q,{x:0,y:8*s,w:s,h:s}),we(o,fe,{x:0,y:15*s,w:s,h:s}),we(o,pe,{x:0,y:99*s,w:s,h:s}),we(o,z,{x:0,y:6*s,w:s,h:s}),we(o,X,{x:0,y:1*s,w:s,h:s}),we(o,$,{x:0,y:2*s,w:s,h:s}),we(o,ee,{x:0,y:20*s,w:s,h:s}),we(o,te,{x:0,y:19*s,w:s,h:s}),we(o,re,{x:0,y:18*s,w:s,h:s}),we(o,ie,{x:0,y:16*s,w:s,h:s}),we(o,ne,{x:0,y:17*s,w:s,h:s}),o),h={"0,0-2,8":ee,"3,0-8,9":te,"0,9-15,15":te,"8,0-8,1":ie,"8,4":ne,"8,6":ne,"8,8":ne,"8,10":ne,"0,9-2,9":re},d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!?&.'-○✗❤★♪:█,",f={2:"ilI!.':,",3:"t1",4:"abcdefghjknopqrsuvxyzL?-",5:"ABCDEFGHJKNOPRSUZ023456789& █",6:"mwMQTVWXY○✗❤★♪"},p=i(a,255,0,0,255),v={debug:!1,view:"BOOT_GAME_VIEW",SPRITE_SIZE:s,SPRITE_COLS:u,SPRITE_ROWS:l,screen:A(e,s*u,s*l,2),tileImage:n,tileSet:c,tileMap:h,fontImage:a,fontImageWhite:a,fontImageBlack:p,fontChrWidths:f,fontChrOrder:d,rng:r(t()),customers:[],orders:[],money:0,reputation:0,totalCustomersServed:0,levelTime:0,levelMaxTime:10*N*100,sun:{position:{start:0,end:0},height:{start:0,end:0},distance:{start:0,end:0}},levelIdx:0,lastCustomerSpawnDT:0,customerNames:["Benjamin","Kira","Julian","Miles","Jadzia","Keiko","Kasidy","Jake","Worf"].map(function(e){return{name:e,hasSpawned:!1}}),levels:[{wants:[{type:ue,rarity:0,minimumTime:10*N*10}]},{wants:[{type:oe,rarity:.2,minimumTime:10*N*10},{type:ue,rarity:0,minimumTime:10*N*10}]},{wants:[{type:oe,rarity:.5,minimumTime:10*N*10},{type:se,rarity:.3,minimumTime:10*N*10},{type:ue,rarity:.1,minimumTime:10*N*10}]}],log:[],hasLoggedElapsedForPct:{},stations:{offset:{cols:2,rows:ye},entries:[{type:j,name:"The Register"},{type:X,name:"Counter",has:[]},{type:$,name:"Cup Counter"},{type:Z,name:"Hot Water",has:[],timer:{value:0,max:10,hold:!0,active:!1,green:1,red:1}},{type:J,name:"Grouphead",has:[{type:le}],timer:{value:0,max:30,hold:!1,active:!1,green:.55,red:.95}},{type:Y,name:"Milk Steamer",has:[],timer:{value:0,max:30,hold:!0,active:!1,green:.55,red:.95}},{type:z,name:"Trash / Grounds Chute"},{type:q,name:"Grinder",setting:20,has:[],timer:{value:0,max:10,hold:!0,active:!1,green:1,red:1}},{type:Q,name:"The Counter",has:[]}]},player:{isActivating:!1,position:{cols:0,rows:0},offset:{cols:0,rows:ye},field:{cols:1,rows:8},has:[]}};return v.sun.position.start=4*v.screen.height,v.sun.position.end=v.screen.height/3,v.sun.distance.start=v.sun.distance.end=v.screen.width/2,v.sun.height.start=v.screen.height/2,v.sun.height.end=3*v.screen.height,v}function a(e){var t=(e.player,e.player.position),r=e.stations.entries,i=r[t.rows];return i}function o(e,t,r){var i=t.has.findIndex(function(e){return e.type===r});if(i!==-1){var n=t.has.splice(i,1);e.has.push(n[0]),e.has.sort(f)}}function s(e,t,r){var i={type:t,sprite:r||t};return e.has.push(i),e.has.sort(f),i}function u(e,t){return e.has.find(function(e){return e.type===t})}function l(e,t){var r=e.has.findIndex(function(e){return e.type===t});if(r!==-1)return e.has.splice(r,1)[0]}function c(e){e.has.length=0}function h(e){return e.has[0].type}function d(e,t){for(var r=function(r){if(e.has.find(function(e){return e.type===t[r]}))return{v:t[r]}},i=0;i<t.length;i++){var n=r(i);if("object"===("undefined"==typeof n?"undefined":ge(n)))return n.v}return!1}function f(e,t){return e.type===le||e.type===ce?1:t.type===le||t.type===ce?-1:0}function p(e,t){if("BETWEEN_LEVEL_VIEW"===t.type)return e.view="BETWEEN_LEVEL_VIEW",e;if("NEXT_LEVEL"===t.type){var r=n(e.screen.cvs,e.tileImage,e.fontImage);return r.money=e.money,r.reputation=e.reputation,r.totalCustomersServed=e.totalCustomersServed,r.levelIdx="BOOT_GAME_VIEW"===e.view?0:e.levelIdx+1,r.view="LEVEL_VIEW",r}if("SHOW_SUMMARY_VIEW"===t.type)return e.view="SUMMARY_VIEW",e.customers.forEach(function(t){t.paid===!0&&(e.reputation-=me)}),e;if(t.type===G)return e.debug=!e.debug,e;if(t.type===k){var i=e.player;return i.isActivating=!1,e}if(t.type===H){e.SPRITE_COLS;return e.customers.push({name:t.data.name,wants:t.data.wants,paid:!1,position:{rows:0,cols:0}}),v(e),e}if(t.type===F){var f=e.player.position.rows-=1;return f<0&&(e.player.position.rows=0),e}if(t.type===B){var p=e.player.position.rows+=1;return p>=e.player.field.rows&&(e.player.position.rows=e.player.field.rows),e}if(t.type===K){var y=e.log;for(y.push(t.data);y.length>5;)y.shift();return e}if(t.type===V&&"LEVEL_VIEW"===e.view){e.levelTime+=N;for(var m=e.player,E=e.stations,g=a(e),w=0;w<E.entries.length;w++){var S=E.entries[w];if(S.timer){if(S.timer.active&&S.timer.value/S.timer.max>=S.timer.green){if(S.type===J&&u(S,ae)&&(l(S,ae),s(S,ue)),S.type===J&&u(S,de)&&(l(S,de),s(S,oe)),S.type===Z&&u(S,ue)){var I=l(S,ue),T=s(S,oe);T.wellBrewed=I.wellBrewed}if(S.type===Z&&u(S,ae)){var _=l(S,ae),L=s(S,de,ae);L.wellBrewed=_.wellBrewed}if(S.type===Y&&u(S,ue)){var O=l(S,ue),x=s(S,se);x.wellBrewed=O.wellBrewed}if(S.type===Y&&u(S,ae)){var R=l(S,ae),P=s(S,he,se);P.wellBrewed=R.wellBrewed}}if(S.timer.active&&S.timer.value>=S.timer.max&&(S.timer.active=!1,S.type===q))return c(S),s(S,ce),e;S.timer.hold&&S.timer.active&&g===S&&m.isActivating&&(S.timer.value+=1),!S.timer.hold&&S.timer.active&&(S.timer.value+=1)}}return e}if(t.type===U){var b=e.player,C=a(e);if(C.type===Z){if((u(b,ue)||u(b,ae))&&0===C.has.length)return o(C,b,h(b)),e;if(1===C.has.length&&(u(C,ue)||u(C,ae)))return C.timer.active=!0,b.isActivating=!0,e;if(C.has.length&&C.timer.active===!1)return o(b,C,h(C)),C.timer.value=0,e}if(C.type===J){if(u(C,ce)&&(u(C,ae)||u(C,de)))return C.timer.active=!0,b.isActivating=!0,e;if(u(C,ce)&&C.timer.active===!0)return C.timer.active=!1,b.isActivating=!0,e;if(0===b.has.length&&u(C,ce)&&(u(C,ue)||u(C,oe))){var A=d(C,[ue,oe]);o(b,C,A);var W=C.timer.value/C.timer.max;return b.has[0].wellBrewed=W<=C.timer.red,l(C,ce),s(C,le),C.timer.value=0,e}if(u(C,le)&&0===b.has.length)return o(b,C,le),e;if((u(b,le)||u(b,ce))&&!u(C,le)&&!u(C,ce))return o(C,b,h(b)),e;if((u(b,ae)||u(b,de))&&!u(C,ae)&&!u(C,oe)&&!u(C,ue)&&!u(C,se)&&!u(C,de))return o(C,b,h(b)),e}if(C.type===$){if(0===b.has.length)return s(b,ae),e;if(u(b,ae))return l(b,ae),e}if(C.type===j){for(var M=0;M<e.customers.length;M++){var D=e.customers[M];if(!D.paid){e.money+=5,D.paid=!0;break}}return e}if(C.type===q&&u(C,le))return b.isActivating=!0,C.timer.active=!0,e;if(C.type===q&&u(C,ce)&&!b.isActivating)return o(b,C,ce),C.timer.value=0,e;if(C.type===q&&u(b,le))return o(C,b,le),e;if(C.type===z){if(u(b,ce))return l(b,ce),s(b,le),e;if(b.has.length&&!u(b,le))return l(b,h(b)),e}if(C.type===Y){if(0===C.has.length&&(u(b,ue)||u(b,oe)||u(b,ae)))return o(C,b,h(b)),e;if(u(C,ue)||u(C,oe)||u(C,ae))return b.isActivating=!0,C.timer.active=!0,e;if(0!==C.has.length&&0===b.has.length&&!b.isActivating)return o(b,C,h(C)),C.timer.value=0,e}}if("CUSTOMER_DRINK_READY"===t.type){var X=e.player;if(u(X,ue)||u(X,se)||u(X,oe)||u(X,he)||u(X,de)){var Q=h(X),ee=l(X,Q),te=e.customers,re=t.data;ee.wellBrewed&&(e.reputation+=me),e.totalCustomersServed+=1,te.splice(re,1),v(e)}}return e}function v(e){var t=.5,r=e.customers,i=e.SPRITE_COLS;r.forEach(function(e,r){e.position={rows:t+r,cols:Math.floor(i/2)}})}function y(e,t,r,i){var n=e.SPRITE_SIZE,a=e.screen,o=e.tileSet,s=e.tileImage,u=a.scale,l=o[t];a.ctx.drawImage(s,l.x,l.y,l.w,l.h,r*n*u,i*n*u,n*u,n*u)}function m(e,t){for(var r=t.player,i=r.offset,n=r.position,a=n.cols,o=n.rows,s=i.cols+a,u=i.rows+o,l=0;l<r.has.length;l++){var c=r.has[l];y(t,c.sprite||c.type,s+.5,u)}y(t,fe,s,u)}function E(e,t,r,i,n,a,o){var s=e.SPRITE_SIZE,u=e.screen,l=u.scale,c=s*l,h=c/3,d=c-h,f=t/r,p=f*c,v=f<a?"rgba(255,255,255,0.8)":f>=a&&f<=o?"rgba(0,255,0,0.8)":"rgba(255,0,0,0.8)";u.ctx.fillStyle=v,u.ctx.fillRect(i*s*l,n*s*l+d,p,h)}function g(e,t){var r=t.stations,i=r.offset,n=r.entries,a=i.cols,o=i.rows;n.forEach(function(e,r){var i=o;if(y(t,e.type,a,i),e.has)for(var n=0;n<e.has.length;n++){var s=e.has[n];y(t,s.sprite||s.type,a-1,i)}e.timer&&e.timer.value>0&&E(t,e.timer.value,e.timer.max,a,i,e.timer.green,e.timer.red),o+=1})}function w(e,t,r,i){var n=arguments.length<=4||void 0===arguments[4]?Ee:arguments[4],a=arguments.length<=5||void 0===arguments[5]?1:arguments[5],o=e.SPRITE_SIZE,s=e.fontChrWidths,u=e.fontChrOrder,l=e.fontImageWhite,c=e.fontImageBlack,h=e.screen,d=h.scale,f=n===Ee?l:c,p=Object.keys(s).reduce(function(e,t){return s[t].split("").forEach(function(r){return e[r]=parseInt(t,10)}),e},{}),v=o*d*r,y=o*d*i;t.split("").forEach(function(e){for(var t=0,r=0;r<u.length;r++){var i=u[r];if(e===i)break;t+=p[i]}" "!==e&&h.ctx.drawImage(f,t,0,p[e],f.height,v,y,p[e]*a,f.height*a),v+=p[e]*a})}function S(e,t){var r=t.customers,i=t.SPRITE_COLS,n=.5;w(t,"CUSTOMERS",Math.floor(i/2),n+ye),r.forEach(function(e,r){var i=e.wants,a=(i.type,i.name),o=e.position,s=o.cols,u=o.rows;w(t,(e.paid?"":"█ ")+e.name+": "+a,s,n+u+ye)})}function I(e,t){for(var r=(t.stations,t.screen,t.tileSet,t.tileMap),i=(t.SPRITE_COLS,t.SPRITE_ROWS,Object.keys(r)),n=0;n<i.length;n++){var a=i[n],o=a;a.indexOf("-")===-1&&(a=a+"-"+a);var s=/(\d+),(\d+)-(\d+),(\d+)/g,u=s.exec(a),l=Se(u,5),c=l[1],h=l[2],d=l[3],f=l[4];c=parseInt(c,10),h=parseInt(h,10),d=parseInt(d,10),f=parseInt(f,10);for(var p=c;p<=d;p++)for(var v=h;v<=f;v++)y(t,r[o],p,v)}}function T(e,t){var r=t.SPRITE_COLS,i=t.SPRITE_ROWS,n=t.tileMap,a=t.sun,o=t.screen,s=t.levelTime/t.levelMaxTime,u=-1*a.distance.start,l=a.position.start+(a.position.end-a.position.start)*s,c=a.height.start+(a.height.end-a.height.start)*s,h=c/2,d=Object.keys(n).filter(function(e){return n[e]===ne||n[e]===ie}),f=/(\d+),(\d+)/,p=o.width/r,v=o.height/i;o.ctx.save(),o.ctx.globalCompositeOperation="lighter";for(var y=0;y<d.length;y++){var m=d[y];if(m.indexOf("-")>-1){var E=m.split("-"),g=Se(E,2),w=g[1];d.push(w)}var S=f.exec(m),I=Se(S,3),T=I[1],_=I[2];T=parseInt(T,10),_=parseInt(_,10),o.ctx.fillStyle="rgba(255, 255, 255, "+.1*s+")",o.ctx.beginPath(),o.ctx.moveTo((T+1)*p,_*v),o.ctx.lineTo(u,l-h),o.ctx.lineTo(u,l+h),o.ctx.lineTo((T+1)*p,(_+1)*v),o.ctx.fill()}o.ctx.restore()}function _(e,t){var r=t.screen;t.tileSet,t.tileMap,t.SPRITE_COLS,t.SPRITE_ROWS;r.ctx.fillStyle="rgba(0,0,0,0.7)",r.ctx.fillRect(0,0,r.width,r.height);var i=3;w(t,"Night-Shift",1,2,Ee,i),w(t,"Barista",1,3,Ee,i);var n=.5,a=6.5;w(t,"You are the sole barista at a 24-hour coffee",1,a+=n),w(t,"shop. Serve your customers the glitching brew",1,a+=n),w(t,"their sleepless brains require, while waiting",1,a+=n),w(t,"for the safety of the sun.",1,a+=n);var o=a+3*n;w(t,"CONTROLS:",1,o+=n),w(t,"UP: Move up",1,o+=n),w(t,"DOWN: Move down",1,o+=n),w(t,"RIGHT: Activate - Pick up - Put down",1,o+=n);var s=1;w(t,"Programming & Design: Drew Petersen",1,14,Ee,s),w(t,"Sprites: Lisa Leung",1,14.5,Ee,s),w(t,"A 2016 JS13k Competition Entry",1,15,Ee,s)}function L(e,t){var r=t.log,i=10,n=.5;w(t,"THOUGHTS",ve,i),r.forEach(function(e,r){w(t,e,ve,i+=n)})}function O(e,t){var r=t.screen;t.tileSet,t.tileMap,t.SPRITE_COLS,t.SPRITE_ROWS;r.ctx.fillStyle="rgba(0,0,0,0.7)",r.ctx.fillRect(0,0,r.width,r.height);var i=2;w(t,"Weekly",1,2,Ee,i),w(t,"Night-Shifts:",1,3,Ee,i),w(t,"Complete!",1,4,Ee,i);var n=.5,a=4.5;w(t,"❤: "+t.reputation,1,a+=n),w(t,"█: "+t.money,1,a+=n),w(t,"Customers: "+t.totalCustomersServed,1,a+=n);var o=1;w(t,"Thank you for playing!",1,a+=n,Ee,o)}function x(e,t){var r=t.screen;t.tileSet,t.tileMap,t.SPRITE_COLS,t.SPRITE_ROWS;r.ctx.fillStyle="rgba(0,0,0,0.7)",r.ctx.fillRect(0,0,r.width,r.height);var i=2;w(t,"Shift Complete!",1,2,Ee,i),w(t,"The next night",1,4,Ee,i),w(t,"... Begins!",1,5,Ee,i)}function R(){Promise.all([W("assets/tiles.png"),W("assets/m05-short.png")]).then(function(e){var t=Se(e,2),r=t[0],i=t[1],a=new C(p,n(window.c,r,i));a.subscribe(function(){var e=a.getState();if(e.debug){var t=window.d;t||(t=document.createElement("pre"),t.id="d",t.style="display:block;position:absolute;color:white;overflow:scroll;z-index:9000;height:100%;width:100%;top:0;left:0",document.body.appendChild(t)),t.innerHTML=JSON.stringify(a.getState(),null,"  ")}P(1,e)});var o=M({drawTime:D,updateTime:N,draw:function(e){},update:function(e){a.dispatch({type:V,data:e}),a.dispatch(Ie()),a.dispatch(Le()),a.dispatch(_e())}});document.body.addEventListener("keydown",function(e){27===e.which&&(o.stop(),console.log("halt in the name of science")),[37,38,39,40].indexOf(e.which)>-1&&e.preventDefault(),38===e.which&&a.dispatch({type:F}),40===e.which&&a.dispatch({type:B}),39===e.which&&a.dispatch(Te()),188===e.which&&e.metaKey&&e.shiftKey&&a.dispatch({type:G})},!1),document.body.addEventListener("keyup",function(e){39===e.which&&a.dispatch({type:k})},!1),"ontouchstart"in window&&(window.scrollTo(0,0),window.ipt.style.display="block",window.btnup.addEventListener("touchend",function(e){e.preventDefault(),a.dispatch({type:F})},!1),window.btndown.addEventListener("touchend",function(e){e.preventDefault(),a.dispatch({type:B})},!1),window.btnact.addEventListener("touchstart",function(e){e.preventDefault(),a.dispatch(Te())},!1),window.btnact.addEventListener("touchend",function(e){e.preventDefault(),a.dispatch({type:k})},!1))})}function P(e,t){var r=t.screen,i=t.view;r.ctx.clearRect(0,0,r.width,r.height),"LEVEL_VIEW"===i&&(I(e,t),m(e,t),g(e,t),S(e,t),L(e,t),T(e,t)),"BETWEEN_LEVEL_VIEW"===i&&(I(e,t),g(e,t),x(e,t)),"BOOT_GAME_VIEW"===i&&(I(e,t),g(e,t),_(e,t)),"SUMMARY_VIEW"===i&&(I(e,t),g(e,t),O(e,t))}var b=e(function(e,t){function r(e,t){var r=this,i=t,n=[];this.getState=function(){return i},this.dispatch=function(t){return"function"==typeof t?t(r.dispatch,r.getState):(i=e(i,t),n.forEach(function(e){return e()}),t)},this.subscribe=function(e){return n.push(e),function(){n=n.filter(function(t){return t!==e})}},this.dispatch({type:"@@INIT"})}Object.defineProperty(t,"__esModule",{value:!0}),t.Store=r}),C=b.Store,A=function(e,t,r,i){var n=e.getContext("2d");e.style.margin="0 auto",e.style.display="block";var a="BODY"!==e.parentNode.nodeName?e.parentNode:null;a&&(a.style.margin="0 auto",a.style.display="block"),t<r?(e.style.height="90vh",a&&(a.style.height="90vh")):(e.style.width="100vw",a&&(a.style.width="100vw")),t*=i,r*=i,e.width=t,e.height=r,n.webkitImageSmoothingEnabled=!1,n.msImageSmoothingEnabled=!1,n.mozImageSmoothingEnabled=!1,n.imageSmoothingEnabled=!1;var o={width:t,height:r,cvs:e,ctx:n,scale:i,destroy:function(){Object.keys(o).map(function(e){return delete o[e]})}};return o},W=function(e){return new Promise(function(t,r){var i=new Image;i.onload=function(){return t(i)},i.onerror=r,i.src=e})},M=function(e){var t=e.drawTime,r=e.updateTime,i=e.draw,n=e.update,a=e.panicAt,o=void 0===a?10:a,s=e.onPanic,u=void 0===s?function(){}:s,l=e.onFPS,c=void 0===l?function(){}:l,h=window.performance,d=t,f=r,p=h.now.bind(h),v=window.requestAnimationFrame.bind(window),y=0,m=null,E=p(),g=p(),w=0,S=0;!function T(e){m=v(T);var t=e-E;y+=t,E=e;var r=y-d>=0,a=Math.floor(y/f);if(a>=o)return y=0,E=p(),void u();for(;a-- >0;)y-=f,n(f);r&&i(y/d),w+=1,g+1e3<=e&&(S=.25*w+.75*S,w=0,g=e,c(S))}(p());var I=function(){m&&cancelAnimationFrame(m)};return{stop:I}},D=1e3/60,N=100,V="GAME_TICK",F="SWIPE_UP",B="SWIPE_DOWN",U="ACTIVATE",k="ACTIVATE_CEASE",H="NEW_CUSTOMER",G="DEBUG_TOGGLE",K="LOG_ENTRY_ADDED",j="ORDER_COUNTER",Y="STEAMER",J="GROUPHEAD",q="GRINDER",Z="HOT_WATER",z="TRASH",X="EMPTY_COUNTER",Q="PICKUP_COUNTER",$="CUP_COUNTER",ee="COUNTER_FLOOR",te="SHOP_FLOOR",re="DECORATIVE_PLANT",ie="SHOP_DOOR",ne="SHOP_WINDOW",ae="CLEAN_CUP",oe="FILLED_AMERICANO_CUP",se="FILLED_CAPPUCCINO_CUP",ue="FILLED_ESPRESSO_CUP",le="CLEAN_PORTAFILTER",ce="FILLED_PORTAFILTER",he="FILLED_STEAMED_MILK_CUP",de="FILLED_HOT_WATER_CUP",fe="BARISTA",pe="CHECKMARK",ve=.5,ye=0,me=10,Ee="FONT_COLOR_WHITE",ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},we=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},Se=function(){function e(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);i=!0);}catch(u){n=!0,a=u}finally{try{!i&&s["return"]&&s["return"]()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Ie=function(){return function(e,t){var r=t();if("LEVEL_VIEW"===r.view&&r.levelTime>=r.levelMaxTime)return e(r.levelIdx+1<r.levels.length?{type:"BETWEEN_LEVEL_VIEW"}:{type:"SHOW_SUMMARY_VIEW"})}},Te=function(){return function(e,t){var r=t();if("LEVEL_VIEW"===r.view){var i=a(r),n=r.player;if(n.has.length&&i.type===Q){var o=function(){var t=h(n),i=r.customers,a=i.findIndex(function(e){return e.wants.type===t});if(a>-1){var o=i[a];return o.paid?{v:e({type:"CUSTOMER_DRINK_READY",data:a})}:{v:e({type:K,data:"They need to pay to receive the drink!"})}}}();if("object"===("undefined"==typeof o?"undefined":ge(o)))return o.v}if(!r.player.isActivating)return e({type:U})}return"BOOT_GAME_VIEW"===r.view?e({type:"NEXT_LEVEL"}):"BETWEEN_LEVEL_VIEW"===r.view?e({type:"NEXT_LEVEL"}):void 0}},_e=function(){return function(e,t){var r=t(),i=r.levelTime/r.levelMaxTime,n=i.toPrecision(2);if(!r.hasLoggedElapsedForPct[n])return"0.25"===n?(e({type:K,data:"Phew, a quarter through my shift!"}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.5"===n?(e({type:K,data:"Halfway through my shift!"}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.75"===n?(e({type:K,data:"Just a quarter of my shift left!"}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.91"===n?(e({type:K,data:"I think I can see daylight!"}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.92"===n?(e({type:K,data:"What is 'daylight'?"}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.93"===n?(e({type:K,data:"I remember now!"}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.94"===n?(e({type:K,data:"Daylight is definitely approaching!"}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.95"===n?(e({type:K,data:"It's getting so bright!"}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.96"===n?(e({type:K,data:"So bright..."}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.97"===n?(e({type:K,data:"So sleepy..."}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.98"===n?(e({type:K,data:"I can almost smell my bed..."}),void(r.hasLoggedElapsedForPct[n]=!0)):"0.99"===n?(e({type:K,data:"Almost time to close up!"}),void(r.hasLoggedElapsedForPct[n]=!0)):"1"===n?(e({type:K,data:"Everybody out!"}),void(r.hasLoggedElapsedForPct[n]=!0)):void 0}},Le=function(){return function(e,t){var r=t();if("LEVEL_VIEW"===r.view){var i=r.lastCustomerSpawnDT,n=r.levelTime,a=r.rng,o=r.customerNames,s=(r.customers,r.levels[r.levelIdx]),u=0,l=!1;s.wants.forEach(function(t){if(!l&&(0===i&&n>=u||n-i>t.minimumTime)){var s=a();if(s>t.rarity){var c=o.filter(function(e){return e.hasSpawned===!1});c.length||(o.forEach(function(e){return e.hasSpawned=!1}),c=o);var h=Math.floor(a()*(c.length-1)),d=c[h];d.hasSpawned=!0,e({type:H,data:{name:d.name,wants:{type:t.type,name:t.type===oe?"Americano":t.type===ue?"Espresso":"Cappuccino"}}}),e({type:K,data:"A new customer walked in!"}),0===r.lastCustomerSpawnDT&&e({type:K,data:"... I'd better take their money █."}),l=!0,r.lastCustomerSpawnDT=n}}})}}};R()}();