<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">body,html{width:100%;height:100%;margin:0;padding:0;background-color:#111}#g{width:100%;height:99.6%}</style></head>

<body>
  <canvas id="g"></canvas>
<script type="text/javascript">!function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var i={};t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function L(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function N(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function F(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function X(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function z(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Q(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function K(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function J(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function $(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var ee=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),te=function(){function e(t){n(this,e),this.timeUPS=1e3/t,this.running=!1,this.lastUpdateTime=null,this._render=this._render.bind(this),this._update=this._update.bind(this),this.scene=null}return ee(e,[{key:"_render",value:function(){this.scene.render(pe.context),this.running&&window.requestAnimationFrame(this._render)}},{key:"_update",value:function(){for(var e=window.performance.now()-this.lastUpdateTime;e>this.timeUPS;)this.scene.update(),this.lastUpdateTime+=this.timeUPS,e-=this.timeUPS;this.running&&setTimeout(this._update,0)}},{key:"start",value:function(e){this.running=!0,this.scene=e,window.requestAnimationFrame(this._render),this.lastUpdateTime=window.performance.now(),setTimeout(this._update,this.timeUPS)}},{key:"stop",value:function(){this.running=!1}}]),e}(),ie=te,ne=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),oe=function(){function e(){o(this,e),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUpLeave=this.onMouseUpLeave.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEndCancel=this.onTouchEndCancel.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.isMobile=!1}return ne(e,[{key:"addOnPressEvent",value:function(e,t){this.finished=t,this.element=e,this.isMobile||(this.element.addEventListener("mousedown",this.onMouseDown),this.element.addEventListener("mousemove",this.onMouseMove)),this.element.addEventListener("touchstart",this.onTouchStart)}},{key:"removeOnPressEvent",value:function(){this.isMobile||(this.element.removeEventListener("mousedown",this.onMouseDown),this.element.removeEventListener("mousemove",this.onMouseMove)),this.element.removeEventListener("touchstart",this.onTouchStart),this.finished=null,this.element=null}},{key:"callbackPressed",value:function(e,t){this.finished.pressed(e,t)}},{key:"callbackReleased",value:function(){this.finished.released()}},{key:"callbackMoved",value:function(e,t){this.finished.moved(e,t)}},{key:"onMouseDown",value:function(e){var t=e.clientX/e.target.offsetWidth*pe.width,i=e.clientY/e.target.offsetHeight*pe.height;this.element.addEventListener("mouseup",this.onMouseUpLeave),this.element.addEventListener("mouseleave",this.onMouseUpLeave),this.callbackPressed(t,i)}},{key:"onMouseMove",value:function(e){var t=e.clientX/e.target.offsetWidth*pe.width,i=e.clientY/e.target.offsetHeight*pe.height;this.callbackMoved(t,i)}},{key:"onMouseUpLeave",value:function(){this.element.removeEventListener("mouseup",this.onMouseUpLeave),this.element.removeEventListener("mouseleave",this.onMouseUpLeave),this.callbackReleased()}},{key:"onTouchStart",value:function(e){this.isMobile||(this.isMobile=!0,this.element.removeEventListener("mousedown",this.onMouseDown),this.element.removeEventListener("mousemove",this.onMouseMove),this.element.removeEventListener("mouseup",this.onMouseUpLeave),this.element.removeEventListener("mouseleave",this.onMouseUpLeave));var t=e.touches[0].clientX/e.target.offsetWidth*pe.width,i=e.touches[0].clientY/e.target.offsetHeight*pe.height;this.element.addEventListener("touchmove",this.onTouchMove),this.element.addEventListener("touchend",this.onTouchEndCancel),this.element.addEventListener("touchcancel",this.onTouchEndCancel),this.callbackPressed(t,i)}},{key:"onTouchEndCancel",value:function(){this.element.removeEventListener("touchmove",this.onTouchMove),this.element.removeEventListener("touchend",this.onTouchEndCancel),this.element.removeEventListener("touchcancel",this.onTouchEndCancel),this.callbackReleased()}},{key:"onTouchMove",value:function(e){var t=e.touches[0].clientX/e.target.offsetWidth*pe.width,i=e.touches[0].clientY/e.target.offsetHeight*pe.height;this.callbackMoved(t,i)}}]),e}(),se=oe,re=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),ae=function(){function e(){s(this,e),this.assets={}}return re(e,[{key:"get",value:function(e){return this.assets[e]}},{key:"set",value:function(e,t){this.assets[e]=t}}]),e}(),he=ae,le={RED:"RED",GREEN:"GREEN",BLUE:"BLUE",SINGULARITY:"SINGULARITY",CAT:"CAT",PLANET_SQUARE:"PLANET_SQUARE",PLANET_SQUARE_ACTIVE:"PLANET_SQUARE_ACTIVE",LEVEL_SQUARE:"LEVEL_SQUARE",LEVEL_SQUARE_ACTIVE:"LEVEL_SQUARE_ACTIVE",LEVEL_SQUARE_DONE:"LEVEL_SQUARE_DONE",PROBE:"PROBE",PROBE_SQUARE:"PROBE_SQUARE",PROBE_SQUARE_ACTIVE:"PROBE_SQUARE_ACTIVE",ENERGY:"ENERGY",BACKGROUND:"BACKGROUND",PANEL:"PANEL"},ue=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),ce=null,fe=function(){function e(){r(this,e)}return ue(e,[{key:"setup",value:function(e,t,i){this.canvas=e,this.width=t,this.height=i,this.canvas.width=t,this.canvas.height=i,this.context=this.canvas.getContext("2d"),this.assets=new he,this.events=new se,this.loop=new ie(60),this.scene=null,this.globals=null}},{key:"isMobile",value:function(){return this.events.isMobile}},{key:"setScene",value:function(e){this.scene=e}},{key:"startScene",value:function(){this.events.addOnPressEvent(this.canvas,this.scene),this.loop.start(this.scene)}},{key:"removeScene",value:function(){this.loop.stop(),this.scene.unload(),this.scene=null,this.events.removeOnPressEvent()}},{key:"_putAsset",value:function(e,t){this.assets.set(e,t)}},{key:"getAsset",value:function(e){return this.assets.get(e)}}]),e}(),de=function e(){return r(this,e),ce||(ce=new fe),ce},pe=new de,ye=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),ve=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;a(this,e),this.x=t,this.y=i,this.width=n,this.height=o,this.image=this.getImage()}return ye(e,[{key:"inRange",value:function(e,t){return e>this.x&&e<this.x+this.width&&t>this.y&&t<this.y+this.height}},{key:"getImage",value:function(){}},{key:"render",value:function(e){e.drawImage(this.image,this.x,this.y,this.width,this.height)}}]),e}(),ge=ve,be=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),ke=function(){function e(){h(this,e)}return be(e,[{key:"render",value:function(e){}},{key:"unload",value:function(){}}]),e}(),we=ke,me=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Ee=function(e){function t(){return l(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,e),me(t,[{key:"getImage",value:function(){return pe.getAsset(le.PLANET_SQUARE)}},{key:"setId",value:function(e,t){this.idX=e,this.idY=t}},{key:"setFake",value:function(e){this.fake&&this.fake!==e&&this.fake.setSquare(null),this.fake=e,this.fake&&this.fake.setSquare(this)}},{key:"render",value:function(e){e.drawImage(this.image,this.x,this.y,this.width,this.height),this.fake&&this.fake.renderInLocation(this.x,this.y,e)}}]),t}(ge),Se=Ee,Te=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),_e=function(e){function t(){return f(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p(t,e),Te(t,[{key:"getImage",value:function(){return pe.getAsset(le.PROBE_SQUARE)}},{key:"setState",value:function(e){this.image=pe.getAsset(e)}}]),t}(ge),Pe=_e,Le=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),xe=function(e){function t(){return y(this,t),v(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return g(t,e),Le(t,[{key:"getImage",value:function(){return pe.getAsset(le.BACKGROUND)}}]),t}(ge),Re=xe,Ae=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Oe=function(e){function t(){return b(this,t),k(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return w(t,e),Ae(t,[{key:"getImage",value:function(){return pe.getAsset(le.PANEL)}}]),t}(ge),Ce=Oe,je=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),De={RED:["#cc0000","#ff0033","#cc0066"],GREEN:["#006600","#009900","#00cc00"],BLUE:["#0000ff","#0033ff","#0066ff"]},Ie={RED:["#f80000","#d80000","#a80000"],GREEN:["#33ff00","#33cc00","#339900"],BLUE:["#3366ff","#3333ff","#3300ff"]},Ue=function(e){function t(){return m(this,t),E(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return S(t,e),je(t,[{key:"fakeIt",value:function(){this.fake=!0}},{key:"setScene",value:function(e){this.scene=e}},{key:"setProbe",value:function(e){this.fake=!1,this.finished=!1,this.probe=e,this.pathX=[],this.pathY=[],this.directionHistory=[],this.step=0,this.currentColor=St.RED,this.singularityNearby=!1,this.probe.x<this.x?(this.pathX.push(this.probe.x+this.probe.width),this.pathY.push(this.probe.y+20),this.direction="right"):this.probe.x>this.width?(this.pathX.push(this.probe.x-10),this.pathY.push(this.probe.y+20),this.direction="left"):this.probe.y<this.y?(this.pathX.push(this.probe.x+20),this.pathY.push(this.probe.y+this.probe.width),this.direction="down"):this.probe.y>this.height&&(this.pathX.push(this.probe.x+20),this.pathY.push(this.probe.y-10),this.direction="up"),this.directionHistory.push(this.direction)}},{key:"drawBeam",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=this.pathX.length,s=this.pathX[0]+5,r=this.pathY[0]+5,a=this.directionHistory[0],h=void 0;for(e.beginPath(),e.strokeStyle=i,e.lineWidth=t,e.globalAlpha=n,e.moveTo(s,r),h=1;h<o;h+=1)a!==this.directionHistory[h]&&(a===St.SINGULARITY?e.moveTo(this.pathX[h-1]+5,this.pathY[h-1]+5):e.lineTo(this.pathX[h-1]+5,this.pathY[h-1]+5),a=this.directionHistory[h]);e.lineTo(this.pathX[o-1]+5,this.pathY[o-1]+5),e.stroke(),e.globalAlpha=1}},{key:"getActualColor",value:function(e){if(this.singularityNearby)return"#212121";var t=e[0];return this.step>2&&this.step<6?t=e[1]:this.step>5&&(t=e[2]),t}},{key:"getHelperColor",value:function(){return this.getActualColor(Ie[this.currentColor])}},{key:"getColor",value:function(){return this.getActualColor(De[this.currentColor])}},{key:"drawLines",value:function(e){this.fake?this.drawBeam(e,2,this.getColor(),.2):(this.drawBeam(e,6,this.getHelperColor()),this.drawBeam(e,3,this.getColor()),this.drawBeam(e,1,"#ffffff"))}},{key:"drawPoint",value:function(e){e.save();var t=this.pathX.length-1,i=this.pathX[t]+5,n=this.pathY[t]+5,o=15;this.fake&&(o=8);var s=e.createRadialGradient(i,n,1,i,n,o),r=this.getColor();s.addColorStop(0,r),s.addColorStop(1,"transparent"),e.fillStyle=s,e.beginPath(),e.arc(i,n,20,0,2.01*Math.PI),e.shadowBlur=20,e.shadowColor=r,e.fill(),e.restore()}},{key:"render",value:function(e){this.drawLines(e),this.drawPoint(e)}},{key:"moveLine",value:function(e,t,i){"up"===e?(this.pathX.push(t),this.pathY.push(i-10)):"down"===e?(this.pathX.push(t),this.pathY.push(i+10)):"left"===e?(this.pathX.push(t-10),this.pathY.push(i)):"right"===e&&(this.pathX.push(t+10),this.pathY.push(i))}},{key:"update",value:function(){if(this.step+=1,9===this.step&&(this.step=0),!this.finished){var e=this.pathX.length-1,t=this.pathX[e],i=this.pathY[e];if(t<this.x-50||t>this.width+40||i<this.y-50||i>this.height+40)return this.finished=!0,void(this.singularityNearby=!1);if(t>this.x&&t<this.width&&i>this.y&&i<this.height&&(e+3)%5==0){this.singularityNearby=!1;var n=this.scene.determineDirection(t,i,this.direction,this.fake);this.direction=n[0],this.currentColor=De[n[1]]?n[1]:this.currentColor,n[1]===St.SINGULARITY&&(this.singularityNearby=!0);var o=n[2];o&&(this.moveLine(this.direction,o[0],o[1]),this.directionHistory.push(St.SINGULARITY),e=this.pathX.length-1,t=this.pathX[e],i=this.pathY[e])}"stop"===this.direction&&(this.finished=!0),this.moveLine(this.direction,t,i),this.directionHistory.push(this.direction)}}}]),t}(ge),Me=Ue,Ne={a:[[,1],[1,,1],[1,,1],[1,1,1],[1,,1]],b:[[1,1],[1,,1],[1,1,1],[1,,1],[1,1]],c:[[1,1,1],[1],[1],[1],[1,1,1]],d:[[1,1],[1,,1],[1,,1],[1,,1],[1,1]],e:[[1,1,1],[1],[1,1,1],[1],[1,1,1]],f:[[1,1,1],[1],[1,1],[1],[1]],g:[[,1,1],[1],[1,,1,1],[1,,,1],[,1,1]],h:[[1,,1],[1,,1],[1,1,1],[1,,1],[1,,1]],i:[[1,1,1],[,1],[,1],[,1],[1,1,1]],j:[[1,1,1],[,,1],[,,1],[1,,1],[1,1,1]],k:[[1,,,1],[1,,1],[1,1],[1,,1],[1,,,1]],l:[[1],[1],[1],[1],[1,1,1]],m:[[1,1,1,1,1],[1,,1,,1],[1,,1,,1],[1,,,,1],[1,,,,1]],n:[[1,,,1],[1,1,,1],[1,,1,1],[1,,,1],[1,,,1]],o:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],p:[[1,1,1],[1,,1],[1,1,1],[1],[1]],q:[[0,1,1],[1,,,1],[1,,,1],[1,,1,1],[1,1,1,1]],r:[[1,1],[1,,1],[1,,1],[1,1],[1,,1]],s:[[1,1,1],[1],[1,1,1],[,,1],[1,1,1]],t:[[1,1,1],[,1],[,1],[,1],[,1]],u:[[1,,1],[1,,1],[1,,1],[1,,1],[1,1,1]],v:[[1,,,,1],[1,,,,1],[,1,,1],[,1,,1],[,,1]],w:[[1,,,,1],[1,,,,1],[1,,1,,1],[1,,1,,1],[1,1,1,1,1]],x:[[1,,,,1],[,1,,1],[,,1],[,1,,1],[1,,,,1]],y:[[1,,1],[1,,1],[,1],[,1],[,1]],z:[[1,1,1,1,1],[,,,1],[,,1],[,1],[1,1,1,1,1]],2:[[,1],[1,,1],[,1],[1],[1,1,1]],3:[[,1,1],[1,,,1],[,,1],[1,,,1],[,1,1]],4:[[,,,1],[,,1,1],[,1,,1],[1,1,1,1,1],[,,,1]],5:[[1,1,1,1],[1],[1,1,1],[,,,1],[1,,,1],[,1,1]],6:[[,1,1],[1,,,1],[1,1,1],[1,,,1],[1,,,1],[,1,1]],7:[[1,1,1,1],[,,,1],[,,1],[,1],[,1]],8:[[,1],[1,,1],[,1],[1,,1],[,1]],9:[[,1],[1,,1],[,1,1],[,,1],[,1]],0:[[,1],[1,,1],[1,,1],[1,,1],[,1]],"&":[[,1,1],[1,,],[,1,,1],[1,,1],[,1,,1]]," ":[[0],[0],[0],[0],[0]],1:[[,,1],[,1,1],[1,,1],[,,1],[,,1]],"!":[[1],[1],[1],[,],[1]],"?":[[,1,1],[1,,,1],[,,1,,],[,,,],[,,1]],",":[[,],[,],[,],[,],[1],[1]],".":[[,],[,],[,],[,],[1]],"'":[[1],[1],[,],[,],[,]],"[":[[1,1],[1],[1],[1],[1],[1,1]],"]":[[1,1],[,1],[,1],[,1],[,1],[1,1]],"-":[[,],[,],[1,1],[,],[,]],":":[[,],[,],[1],[,],[1]]},Ye=function(e){var t=void 0,i=0;for(t=0;t<e.length;t+=1)e[t].length>i&&(i=e[t].length);return i},qe=function(e){var t=void 0,i=0;for(t=0;t<e.length;t+=1)i+=e[t];return i},Fe=function(e,t,i,n,o,s,r,a){o=o.toLowerCase();var h=[],l=void 0,u=void 0,c=[],f=[],d=[];for(l=0;l<o.length;l++){var p=Ne[o.charAt(l)];if(p&&(h.push(p),c.push(a*(Ye(p)+1)),qe(c)>.9*i)){for(var y=0;" "!==o.charAt(l-y)&&y<=h.length;)y+=1;y>=h.length&&(y=0),l-=y,y>0&&(c.splice(-y),h.splice(-y)),d.push(qe(c)),c=[],f.push(h),h=[]}}for(f.push(h),d.push(qe(c)),s.fillStyle=r,u=0;u<f.length;u+=1){h=f[u];var v=0;for(l=0;l<h.length;l++){for(var g=h[l],b=0,k=0,w=0;w<g.length;w++){for(var m=g[w],E=0;E<m.length;E++)m[E]&&s.fillRect(e+(i-d[u])/2+v+E*a,t+(u+1)*(n/(f.length+1))-5*a/2+b,a,a);k=Math.max(k,m.length*a),b+=a}v+=a+k}}},Ge=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Be=function(e){function t(e,i,n,o,s){T(this,t);var r=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n,o));return r.callback=s,r}return P(t,e),Ge(t,[{key:"getImage",value:function(){return pe.getAsset(le.ENERGY)}},{key:"setEnergy",value:function(e){this.energy=e,this.max=e}},{key:"update",value:function(){this.energy>0&&(this.energy-=1)}},{key:"renderLightning",value:function(e){var t=this.x+this.width/2-25,i=this.y+this.height/2-50;e.beginPath(),e.fillStyle="#f9f316",e.moveTo(t,this.y+this.height/2+7),e.lineTo(t+40,i),e.lineTo(t+25,this.y+this.height/2-7),e.lineTo(t+50,this.y+this.height/2-7),e.lineTo(t+10,i+100),e.lineTo(t+25,this.y+this.height/2+7),e.lineTo(t,this.y+this.height/2+7),e.fill()}},{key:"render",value:function(e){e.drawImage(this.image,this.x,this.y,this.width,this.height),e.fillStyle="green",e.fillRect(this.x,this.y+(1-this.energy/this.max)*this.height,this.width,this.energy/this.max*this.height),this.energy<this.max&&Fe(this.x,this.y+this.height-50,this.width,50,"Click to replace the battery",e,"#ffffff",2),this.renderLightning(e)}},{key:"pressed",value:function(e,t){this.inRange(e,t)&&this.callback()}},{key:"moved",value:function(e,t){}}]),t}(ge),Xe=Be,Ve=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),ze=function(e){function t(e,i,n,o,s,r){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"#dddddd",h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"#ffffff",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"#000000";L(this,t);var u=x(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n,o));return u.text=s,u.color=a,u.colorHover=h,u.textColor=l,u.state=0,u.onClick=r,u.size=2,u}return R(t,e),Ve(t,[{key:"setFontSize",value:function(e){this.size=e}},{key:"setNormal",value:function(){this.state=0}},{key:"setHover",value:function(){this.state=1}},{key:"render",value:function(e){this.noRender||(this.state?e.fillStyle=this.colorHover:e.fillStyle=this.color,e.fillRect(this.x,this.y,this.width,this.height),Fe(this.x,this.y,this.width,this.height,this.text,e,this.textColor,this.size))}},{key:"pressed",value:function(e,t){return!!this.inRange(e,t)&&(this.onClick(),!0)}},{key:"moved",value:function(e,t){!this.state&&this.inRange(e,t)?this.setHover():this.state&&!this.inRange(e,t)&&this.setNormal()}},{key:"disabled",value:function(){this.noRender=!0}}]),t}(ge),Qe=ze,He=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),We=function(e){function t(e,i,n,o,s,r){A(this,t);var a=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n,o));return a.info=r,a.state=0,a.level=s,a.onClick=a.goToLevel,a}return C(t,e),He(t,[{key:"getImage",value:function(){return pe.getAsset(le.LEVEL_SQUARE)}},{key:"render",value:function(e){var t=this.image;this.info.done&&(t=pe.getAsset(le.LEVEL_SQUARE_DONE)),this.state&&(t=pe.getAsset(le.LEVEL_SQUARE_ACTIVE)),e.drawImage(t,this.x,this.y,this.width,this.height),Fe(this.x,this.y,this.width,this.height,this.level+1+"",e,"#ffffff",2)}},{key:"goToLevel",value:function(){pe.removeScene(),pe.setScene(new kt(this.info,this.level)),pe.startScene()}}]),t}(Qe),Ke=We,Je=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Ze=function(e){function t(e,i,n,o,s,r){j(this,t);var a=D(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n,o));return a.continueClicked=a.continueClicked.bind(a),a.continue=new Qe(e+n-50,i+o-20,50,20,"[...]",a.continueClicked,"#333333","#545454","#AA1111"),s?(a.noGuideText=!1,a.finished=s.length-1):(a.noGuideText=!0,a.finished=0),a.currentText=0,a.texts=s,a.scientist=r,a.continueEnabled=!1,a.noGuideText?a.textToLoad(null):a.textToLoad(a.texts[a.currentText]),a}return I(t,e),Je(t,[{key:"setPixelSize",value:function(e){this.size=e,this.continue.setFontSize(e-1);var t=30*(e-1),i=15*(e-1),n=t,o=i;pe.isMobile()&&(n=1.5*t,o=1.5*i),n>100&&(n=100),o>60&&(o=60),this.continue.width=n,this.continue.height=o,this.continue.x=this.x+this.width-t/2,this.continue.y=this.y+this.height-i/2}},{key:"textToLoad",value:function(e){e?this.scientist.setTalking(!0):this.scientist.setTalking(!1),this.text=e,this.textSoFar="",this.currentLetter=0,this.interval=6,this.step=0,this.stop=!1}},{key:"setFinishedCallback",value:function(e){this.finishedCallback=e}},{key:"setStepCallback",value:function(e){this.stepCallback=e}},{key:"showContinue",value:function(){this.scientist.setTalking(!1),this.stop=!0,this.currentText===this.finished&&this.finishedCallback?this.continueEnabled=!0:this.currentText!==this.finished&&(this.continueEnabled=!0)}},{key:"continueClicked",value:function(){this.continueEnabled=!1,this.stepCallback&&this.stepCallback(this.currentText),this.currentText===this.finished?this.finishedCallback&&this.finishedCallback():(this.currentText+=1,this.textToLoad(this.texts[this.currentText]))}},{key:"pressed",value:function(e,t){return!(!this.continueEnabled||!this.continue.pressed(e,t))||!!this.inRange(e,t)&&(this.loadText(),!0)}},{key:"moved",value:function(e,t){this.continueEnabled&&this.continue.moved(e,t)}},{key:"update",value:function(){this.text&&(this.step+=1,this.stop||this.step%this.interval!=0||(this.textSoFar=this.textSoFar+this.text[this.currentLetter],this.currentLetter+=1,this.currentLetter===this.text.length&&this.showContinue()))}},{key:"loadText",value:function(){this.textSoFar=this.text,this.showContinue()}},{key:"render",value:function(e){this.text&&(e.fillStyle="#DDDDDD",e.fillRect(this.x,this.y,this.width,this.height),Fe(this.x,this.y,this.width,this.height,this.textSoFar,e,"#121212",this.size),this.continueEnabled&&this.continue.render(e))}}]),t}(ge),$e=Ze,et=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),tt=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;U(this,t);var r=9*o,a=27*o,h=M(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,r,a));return h.dialogFinished=h.dialogFinished.bind(h),h.colors=["#1bd9c9","#2eec2b","#ba1717","#eeeab1","#6d2904","#271003","#000000","#ffffff"],h.guy=[[0,0,5,0,5,0,5,0,0],[0,5,5,5,5,5,5,5,0],[0,0,5,4,4,4,5,0,0],[0,0,7,7,4,7,7,0,0],[0,0,7,7,4,7,7,0,0],[0,0,0,4,4,4,0,0,0],[0,0,0,0,4,0,0,0,0],[0,0,1,1,4,1,1,0,0],[0,1,1,8,8,8,1,1,0],[1,0,1,8,7,8,1,0,1],[1,0,1,8,8,8,1,0,1],[1,0,1,8,7,8,1,0,1],[1,0,1,8,8,8,1,0,1],[1,0,1,8,7,8,1,0,1],[1,0,1,8,8,8,1,0,1],[4,0,1,6,6,6,1,0,4],[0,0,1,6,6,6,1,0,0],[0,0,1,6,1,6,1,0,0],[0,0,1,6,1,6,1,0,0],[0,0,1,6,1,6,1,0,0],[0,0,0,6,0,6,0,0,0],[0,0,0,6,0,6,0,0,0],[0,0,7,7,0,7,7,0,0]],h.mouth=[[[0,0,0,4,4,4,0,0,0],[0,0,0,4,3,4,0,0,0]],[[0,0,0,4,4,4,0,0,0],[0,0,0,3,3,3,0,0,0]],[[0,0,0,4,3,4,0,0,0],[0,0,0,4,3,4,0,0,0]]],h.eyes=[[[0,7,8,8,7,8,8,7,0],[0,7,8,2,7,8,2,7,0]],[[0,7,8,8,7,8,8,7,0],[0,7,2,8,7,2,8,7,0]],[[0,7,2,8,7,2,8,7,0],[0,7,8,8,7,8,8,7,0]],[[0,7,8,2,7,8,2,7,0],[0,7,8,8,7,8,8,7,0]]],h.talking=!1,h.dialogSize=s,n?h.say(n):h.dialog=null,h.size=o,h.eyeTick=0,h.eyeTickLimit=Math.floor(200*Math.random())+20,h.mouthTick=0,h.mouthTickLimit=10,h.currentMouth=0,h.currentEyes=h.eyes[0],h}return N(t,e),et(t,[{key:"stopSpeach",value:function(){this.dialogFinished(),this.setTalking(!1)}},{key:"say",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.dialog||(this.dialog=new $e(this.x+this.width+3*this.dialogSize,this.y,120*this.dialogSize,30*this.dialogSize,e,this),this.dialog.setPixelSize(this.dialogSize),this.dialog.setFinishedCallback(this.dialogFinished),t&&this.setDialogFinishedCallback(t))}},{key:"dialogFinished",value:function(){this.dialog=null,this.onDialogFinished&&this.onDialogFinished()}},{key:"onClick",value:function(e){this.clickCallback=e}},{key:"setTalking",value:function(e){e?(this.talking=!0,this.currentMouth=1):(this.talking=!1,this.mouthTick=0,this.currentMouth=0)}},{key:"getRandomFace",value:function(e){return e[Math.floor(Math.random()*e.length)]}},{key:"moved",value:function(e,t){this.dialog&&this.dialog.moved(e,t)}},{key:"pressed",value:function(e,t){if(this.dialog){if(this.dialog.pressed(e,t))return!0}return!(!this.inRange(e,t)||!this.clickCallback)&&(this.clickCallback(),!0)}},{key:"setDialogFinishedCallback",value:function(e){this.onDialogFinished=e}},{key:"setDialogStepCallback",value:function(e){this.dialog.setStepCallback(e)}},{key:"update",value:function(){this.eyeTick+=1,this.eyeTick===this.eyeTickLimit&&(this.eyeTick=0,this.eyeTickLimit=Math.floor(100*Math.random())+20,this.currentEyes=this.getRandomFace(this.eyes)),this.talking&&(this.mouthTick+=1,this.mouthTick===this.mouthTickLimit&&(this.mouthTick=0,this.currentMouth+=1,this.currentMouth===this.mouth.length&&(this.currentMouth-=2))),this.dialog&&this.dialog.update()}},{key:"renderLine",value:function(e,t,i){var n=void 0;for(n=0;n<9;n+=1){var o=t[n];0!==o&&(e.fillStyle=this.colors[o-1],e.fillRect(this.x+n*this.size,this.y+i*this.size,this.size,this.size))}}},{key:"render",value:function(e){var t=this.guy.length,i=void 0,n=void 0;for(i=0;i<t;i+=1){if(4===i)for(n=0;n<this.currentEyes.length;n+=1)this.renderLine(e,this.currentEyes[n],i+n);if(5===i)for(n=0;n<2;n+=1)this.renderLine(e,this.mouth[this.currentMouth][n],i+this.currentEyes.length+n);var o=i;i>3&&(o+=this.currentEyes.length),i>4&&(o+=2),this.renderLine(e,this.guy[i],o)}this.dialog&&this.dialog.render(e)}}]),t}(ge),it=tt,nt=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),ot=function(e){function t(e){Y(this,t);var i=q(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.x-5,e.y-5,e.width+10,e.height+10));return i.time=0,i.maxTime=10,i.interval=1,i}return F(t,e),nt(t,[{key:"update",value:function(){this.time+=this.interval,this.time===this.maxTime&&(this.interval=-1),0===this.time&&(this.interval=1)}},{key:"render",value:function(e){e.globalAlpha=this.time/this.maxTime,e.strokeStyle="#aaaa00",e.lineWidth=5,e.strokeRect(this.x,this.y,this.width,this.height),e.globalAlpha=1}}]),t}(ge),st=ot,rt=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),at=["welcome to my lab!","this is a blackbox","yes, i know it's purple","it's essentially a microscopic universe","well... in a box.","anyway - it helps me in sciency stuff","go ahead! take a look!"],ht=["well done!","you sorted out all of the blackboxes!"],lt=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:99;G(this,t);var i=B(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));i.nextStep=i.nextStep.bind(i),i.background=new Re(0,0,pe.width,pe.height),i.levels=[];var n=void 0,o=pe.globals.levels,s=0;for(n=0;n<o.length;n+=1){var r=o[n];if(!r.open)break;var a=Math.floor(n/6);i.levels.push(new Ke(100+n%6*125,100+125*a,100,100,n,r)),!pe.globals.finished&&r.done&&(s+=1)}var h=null;return e?12===s&&(h=ht,pe.globals.finished=!0):h=at,i.scientist=new it(pe.width/2-50,pe.height-95,h,4,2),e||i.scientist.setDialogStepCallback(i.nextStep),i}return X(t,e),rt(t,[{key:"nextStep",value:function(e){this.indicator=0===e||e>4?new st(this.levels[0]):null}},{key:"moved",value:function(e,t){var i=void 0;for(i=0;i<this.levels.length;i+=1)this.levels[i].moved(e,t);this.scientist.moved(e,t)}},{key:"released",value:function(){}},{key:"pressed",value:function(e,t){var i=void 0;for(i=0;i<this.levels.length;i+=1)this.levels[i].pressed(e,t);this.scientist.pressed(e,t)}},{key:"update",value:function(){this.indicator&&this.indicator.update(),this.scientist.update()}},{key:"render",value:function(e){this.background.render(e);var t=void 0;for(t=0;t<this.levels.length;t+=1)this.levels[t].render(e);this.scientist.render(e),this.indicator&&this.indicator.render(e),Fe(0,0,pe.width,60,"blackbox: lost particles",e,"#ffffff",5),Fe(0,350,pe.width/2,60,"Won: "+pe.globals.won,e,"#ffffff",3),Fe(pe.width/2,350,pe.width/2,60,"Lost: "+pe.globals.lost,e,"#ffffff",3)}}]),t}(we),ut=lt,ct=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),ft=["let's not waste any more time","you have to place the particles from here","to the blackbox","you don't know where the 'red particle' is in the box","but you can check it out using lasers here","lasers deplete the battery","you can replace it whenever","but this changes positions of particles in the blackbox","you have infinite power in tutorial levels","normally, the laser beam will go in a straight line","but particles are bending and influencing the laser beam","'red particle' is here, as it bends the beam by 90 degrees at corner squares","notice how this beam splits into two","that big beam goes into the blackbox","and is affected by particles in the box","smaller one goes above the box","and is affected by particles that you place","i will place the 'red particle' where it belongs","now - both lasers align","this is how you know you made the right decision","shoot directly at a particle and beam will stop","if a particle is placed at the edge of the box","and you activate a nearby laser from that edge","the beam will return","oh - and in case you get too annoyed","you can check how particles are placed in current blackbox","so - you can play around here","when you are finished - and particle placement is correct","click me and I will check your box"],dt=["there is a 'blue particle' here","you may also encounter a 'green' variety","check how it discolors the laser"],pt=["this here is a 'singularity'","experiment on it - as it behaves differently from particles"],yt=["this new particle is the 'schrodinger bunny'","when you hit it","it bends the beam in a different direction each time"],vt=["two singularities create a wormhole for your laser"],gt=function(e){return"left"===e?"right":"right"===e?"left":"up"===e?"down":"down"===e?"up":void 0},bt=function(e){function t(e,i){V(this,t);var n=z(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.currentLevel=i,n.check=n.check.bind(n),n.backToLevel=n.backToLevel.bind(n),n.checkSolution=n.checkSolution.bind(n),n.nextStep=n.nextStep.bind(n),n.restartLevel=n.restartLevel.bind(n),n.levelWon=n.levelWon.bind(n),n.disableTutorial=n.disableTutorial.bind(n),n.placePlanet=n.placePlanet.bind(n),n.activateLaser=n.activateLaser.bind(n),n.selectPlanet=n.selectPlanet.bind(n),n.laser=null,n.selectedPlanet=null,n.beam=null,n.fake=null,n.energyIndicator=new Xe(pe.width-125,25,100,350,n.restartLevel),n.solutionButton=new Qe(pe.width-120,pe.height-60,90,40,"solution",n.checkSolution),n.width=e.width,n.height=e.height,n.planets=e.planets,n.isTutorial=e.isTutorial,n.fakeDetermine=new Array(n.width),n.determine=new Array(n.width),n.probeSquares=new Array(2*n.width+2*n.height),n.currentProbeSquare=0,n.planetSquares=new Array(n.width*n.height);var o=0;n.objects=[];var s=void 0,r=void 0,a=void 0;n.fakePlanets=new Array(n.planets.length),n.energyIndicator.setEnergy(1e3*n.planets.length),n.background=new Re(0,0,pe.width,pe.height),n.leftPanel=new Ce(10,10,130,pe.height-20),n.objects.push(n.leftPanel),n.objects.push(new Ce(pe.width-140,10,130,pe.height-20));var h=50*n.width,l=50*n.height;for(n.limitX1=pe.width/2-h/2,n.limitY1=pe.height/2-l/2,n.limitX2=pe.width/2+h/2,n.limitY2=pe.height/2+l/2,s=0;s<n.width;s+=1)for(n.fakeDetermine[s]=new Array(n.height),n.determine[s]=new Array(n.height),r=0;r<n.height;r+=1)a=new Se(n.limitX1+50*s,n.limitY1+50*r,50,50),a.setId(s,r),n.objects.push(a),n.planetSquares[o++]=a,n.fakeDetermine[s][r]=null,n.determine[s][r]=null;for(n.fillDirections(),s=0;s<n.width;s+=1){var u=n.limitX1+50*s;n.addProbe(u,n.limitY1-100),n.addProbe(u,n.limitY2+50)}for(s=0;s<n.height;s+=1){var c=n.limitY1+50*s;n.addProbe(n.limitX1-100,c),n.addProbe(n.limitX2+50,c)}for(s=0;s<n.planets.length;s+=1){var f=new Et(25+s%2*50,25+65*Math.floor(s/2),50,50,n.planets[s].type);n.fakePlanets[s]=f,n.objects.push(f)}n.objects.push(n.energyIndicator),n.objects.push(n.solutionButton);var d=null;return e.isTutorial?(d=ft,n.skipTutorial=new Qe(pe.width-120,pe.height-110,90,40,"skip tutorial",n.disableTutorial)):e.newPlanets?d=dt:e.newSingularity?d=pt:e.newCat?d=yt:e.newWormhole&&(d=vt),n.scientist=new it(80,pe.height-95,d,4,2),n.scientist.onClick(n.check),e.isTutorial&&n.scientist.setDialogStepCallback(n.nextStep),n.energyNotAffected=e.energyNotAffected,n.indicator=[],n.middlePanel=new ge(n.limitX1,n.limitY1,h,l),e.isTutorial=!1,e.newPlanets=!1,e.newSingularity=!1,e.newWormhole=!1,e.newCat=!1,n.solutionMode=!1,n}return Q(t,e),ct(t,[{key:"addProbe",value:function(e,t){this.probeSquares[this.currentProbeSquare++]=new Pe(e,t,50,50)}},{key:"disableTutorial",value:function(){this.skipTutorial=null,this.isTutorial=!1,this.scientist.stopSpeach(),this.indicator=[],this.deactivateLaser()}},{key:"indicate",value:function(e){var t=void 0;for(this.indicator=[],t=0;t<e.length;t+=1)this.indicator.push(new st(e[t]))}},{key:"nextStep",value:function(e){e?1===e||6===e?this.indicate([this.middlePanel]):2===e?this.indicate([this.fakePlanets[0]]):3===e?this.indicate(this.probeSquares):4===e||5===e?this.indicate([this.energyIndicator]):8===e?this.activateLaser(this.probeSquares[5]):9===e||17===e?(this.deactivateLaser(),this.activateLaser(this.probeSquares[3])):12===e||13===e?(this.indicate([this.probeSquares[3],this.probeSquares[11]]),this.indicator[0].y-=50,this.indicator[1].x-=50):14===e||15===e?(this.indicate([this.probeSquares[3]]),this.indicator[0].y-=250,this.indicator[0].height=250):16===e?(this.deactivateLaser(),this.selectPlanet(this.fakePlanets[0]),this.placePlanet(this.planetSquares[1]),this.indicate([this.planetSquares[1]])):19===e?(this.indicator=[],this.deactivateLaser(),this.activateLaser(this.probeSquares[9])):10===e?this.indicate([this.planetSquares[1]]):20===e||23===e?this.deactivateLaser():21===e?(this.deactivateLaser(),this.indicate([this.probeSquares[6],this.probeSquares[10]])):22===e?(this.indicate([this.probeSquares[6],this.probeSquares[10]]),this.activateLaser(this.probeSquares[6])):24===e?(this.indicate([this.solutionButton]),this.deactivateLaser()):e>27?(this.indicate([this.scientist]),this.isTutorial=!1):this.indicator=[]:this.indicate([this.leftPanel])}},{key:"getPotentialLocation",value:function(){var e=Math.floor(Math.random()*this.width),t=Math.floor(Math.random()*this.height);return this.determine[e][t]&&this.determine[e][t].planet?this.getPotentialLocation():[e,t]}},{key:"determineColorChange",value:function(e,t){return e?e===St.BLUE||t===St.BLUE?St.BLUE:t===St.GREEN||e===St.GREEN?St.GREEN:St.RED:t}},{key:"addDirection",value:function(e,t,i,n,o){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!(e<0||t<0||e>=this.width||t>=this.height)){var r=this.determine;s&&(r=this.fakeDetermine);var a=r[e][t];if(a||(r[e][t]={},a=r[e][t]),"stop"!==a[i]){if(a[i]){if(a[i]===gt(i))return void(gt(i)===n&&(a["change_"+i]=this.determineColorChange(a["change_"+i],o)));a[i]===gt(n)?(a["change_"+i]=this.determineColorChange(a["change_"+i],o),a[i]=gt(i)):(a["change_"+i]=this.determineColorChange(a["change_"+i],o),a[i]=n)}else a["change_"+i]=o,a[i]=n;"planet"===i&&(a.left="stop",a.change_left=o,a.right="stop",a.change_right=o,a.up="stop",a.change_up=o,a.down="stop",a.change_down=o)}}}},{key:"addPlanet",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.addDirection(e,t,"planet",i,i,n),i===St.SINGULARITY?(this.addDirection(e-1,t-1,"left","down",i,n),this.addDirection(e-1,t-1,"up","right",i,n),this.addDirection(e+1,t-1,"up","left",i,n),this.addDirection(e+1,t-1,"right","down",i,n),this.addDirection(e-1,t+1,"left","up",i,n),this.addDirection(e-1,t+1,"down","right",i,n),this.addDirection(e+1,t+1,"down","left",i,n),this.addDirection(e+1,t+1,"right","up",i,n)):i!==St.CAT&&(this.addDirection(e-1,t-1,"right","up",i,n),this.addDirection(e-1,t-1,"down","left",i,n),this.addDirection(e+1,t-1,"down","right",i,n),this.addDirection(e+1,t-1,"left","up",i,n),this.addDirection(e-1,t+1,"right","down",i,n),this.addDirection(e-1,t+1,"up","left",i,n),this.addDirection(e+1,t+1,"up","right",i,n),this.addDirection(e+1,t+1,"left","down",i,n),e?e===this.width-1&&(this.addDirection(e,t-1,"left","right",i,n),this.addDirection(e,t+1,"left","right",i,n)):(this.addDirection(e,t-1,"right","left",i,n),this.addDirection(e,t+1,"right","left",i,n)),t?t===this.height-1&&(this.addDirection(e+1,t,"up","down",i,n),this.addDirection(e-1,t,"up","down",i,n)):(this.addDirection(e+1,t,"down","up",i,n),this.addDirection(e-1,t,"down","up",i,n)))}},{key:"fillDirections",value:function(){var e=void 0;for(e=0;e<this.planets.length;e+=1){var t=this.planets[e];if(void 0===t.x){var i=this.getPotentialLocation();t.x=i[0],t.y=i[1]}this.addPlanet(t.x,t.y,t.type)}}},{key:"zeroFakeDetermine",value:function(){var e,t;for(e=0;e<this.width;e+=1)for(t=0;t<this.height;t+=1)this.fakeDetermine[e][t]=null}},{key:"planetPlaced",value:function(){this.zeroFakeDetermine();var e=void 0;for(e=0;e<this.fakePlanets.length;e+=1){var t=this.fakePlanets[e];t.square&&this.addPlanet(t.square.idX,t.square.idY,this.planets[e].type,!0)}}},{key:"getFromSquare",value:function(e){var t=void 0;for(t=0;t<this.planets.length;t+=1)if(this.planets[t].x===e.idX&&this.planets[t].y===e.idY)return t}},{key:"getFakeFromSquare",value:function(e){var t=void 0;for(t=0;t<this.fakePlanets.length;t+=1)if(this.fakePlanets[t].square&&this.fakePlanets[t].square.idX===e.idX&&this.fakePlanets[t].square.idY===e.idY)return t}},{key:"getSingularityCount",value:function(e){var t=void 0,i=0;for(t=0;t<this.planets.length;t+=1)this.planets[t].type===St.SINGULARITY&&(e&&this.fakePlanets[t].square||!e)&&(i+=1);return i}},{key:"getSecondSingularity",value:function(e){var t=void 0;for(t=0;t<this.planets.length;t+=1)if(this.planets[t].type===St.SINGULARITY&&(this.planets[t].x!==e.x||this.planets[t].y!==e.y))return this.planets[t]}},{key:"getSecondFakeSingularity",value:function(e){var t=void 0;for(t=0;t<this.fakePlanets.length;t+=1)if(this.fakePlanets[t].type===St.SINGULARITY&&this.fakePlanets[t].square&&(this.fakePlanets[t].square.idX!==e.idX||this.fakePlanets[t].square.idY!==e.idY))return this.fakePlanets[t].square}},{key:"deactivateLaser",value:function(){this.laser&&(this.laser.setState(le.PROBE_SQUARE),this.laser=null,this.beam=null,this.fake=null)}},{key:"activateLaser",value:function(e){this.laser=e,this.laser.setState(le.PROBE_SQUARE_ACTIVE),this.beam=new Me(this.limitX1,this.limitY1,this.limitX2,this.limitY2),this.beam.setProbe(e),this.beam.setScene(this),this.fake=new Me(this.limitX1,this.limitY1,this.limitX2,this.limitY2),this.fake.setProbe(e),this.fake.setScene(this),this.fake.fakeIt()}},{key:"selectPlanet",value:function(e){return this.selectedPlanet&&this.selectedPlanet.setState(1),this.selectedPlanet===e?this.selectedPlanet=null:(this.selectedPlanet=e,this.selectedPlanet.setState(0)),!0}},{key:"placePlanet",value:function(e){var t=!1;if(e.fake&&(e.setFake(null),t=!0),this.selectedPlanet){e.setFake(this.selectedPlanet),this.selectedPlanet.setState(1);var i=this.fakePlanets[this.getFromSquare(this.selectedPlanet.square)];i&&i.type===this.selectedPlanet.type&&this.selectedPlanet.align(i),this.selectedPlanet=null,t=!0}t&&this.planetPlaced()}},{key:"determineDirection",value:function(e,t,i,n){var o=this.determine;n&&(o=this.fakeDetermine);var s=this.planetSquares.length,r=null,a=void 0;for(a=0;a<s&&(r=this.planetSquares[a],!r.inRange(e,t));a+=1);var h=o[r.idX][r.idY];if(!h)return[i,null];var l=h[i]?h[i]:i,u=null;if("stop"===l)if(h.planet===St.CAT){var c=void 0;c=n?this.fakePlanets[this.getFakeFromSquare(r)]:this.fakePlanets[this.getFromSquare(r)],l=c.getDirectionForCat(i,n)}else if(h.planet===St.SINGULARITY&&2===this.getSingularityCount(n)){var f=void 0,d=void 0,p=this.getFromSquare(r);n?(p=this.getFakeFromSquare(r),f=this.fakePlanets[p].square,d=this.getSecondFakeSingularity(f),d={x:d.idX,y:d.idY}):(f=this.planets[p],d=this.getSecondSingularity(f)),l=i,u=[this.limitX1+50*d.x+20,this.limitY1+50*d.y+20]}return[l,h["change_"+i]?h["change_"+i]:null,u]}},{key:"helperLoop",value:function(e,t,i,n){var o=void 0;for(o=0;o<e.length;o+=1)if(e[o].inRange(i,n)){t(e[o]);break}}},{key:"pressed",value:function(e,t){this.scientist.pressed(e,t)||(e>160&&e<pe.width-160?e>this.limitX1&&e<this.limitX2&&t>this.limitY1&&t<this.limitY2?this.solutionMode||this.isTutorial||this.helperLoop(this.planetSquares,this.placePlanet,e,t):this.isTutorial||this.helperLoop(this.probeSquares,this.activateLaser,e,t):e<160?this.solutionMode||this.isTutorial||this.helperLoop(this.fakePlanets,this.selectPlanet,e,t):this.isTutorial?this.skipTutorial.pressed(e,t):(this.solutionButton.pressed(e,t),this.energyIndicator.pressed(e,t)))}},{key:"released",value:function(){this.isTutorial||this.deactivateLaser()}},{key:"moved",value:function(e,t){this.scientist.moved(e,t),this.isTutorial?this.skipTutorial.moved(e,t):this.laser&&!this.laser.inRange(e,t)?this.deactivateLaser():this.solutionButton.moved(e,t)}},{key:"update",value:function(){var e=void 0;for(this.beam&&(this.beam.update(),this.fake.update(),this.solutionMode||this.energyIndicator.update(),this.energyIndicator.energy||this.energyNotAffected||this.solutionMode||this.released()),e=0;e<this.indicator.length;e+=1)this.indicator[e].update();this.scientist.update()}},{key:"check",value:function(){this.solutionMode&&this.scientist.say(["hope you learned something","i'll reset the box now"],this.restartLevel);var e,t;for(e=0;e<this.width;e+=1)for(t=0;t<this.height;t+=1){var i=this.determine[e][t],n=this.fakeDetermine[e][t];if(i&&i.planet){if(!n||!n.planet)return pe.globals.lost+=1,void this.scientist.say(["not quite. Maybe check an easier box?"],this.backToLevel);if(i.planet.type!==n.planet.type)return pe.globals.lost+=1,void this.scientist.say(["not quite. Maybe check an easier box?"],this.backToLevel)}}this.scientist.say(["you did it! try another blackbox!"],this.levelWon)}},{key:"resetPlanets",value:function(){var e=void 0;for(e=0;e<this.planets.length;e+=1)this.planets[e].x=void 0,this.planets[e].y=void 0}},{key:"restartLevel",value:function(){this.resetPlanets(),pe.globals.lost+=1,pe.removeScene(),pe.setScene(new t(pe.globals.levels[this.currentLevel],this.currentLevel)),pe.startScene()}},{key:"levelWon",value:function(){if(this.resetPlanets(),this.currentLevel<pe.globals.levels.length-1){var e=pe.globals.levels[this.currentLevel+1];e.open||(e.open=!0)}pe.globals.levels[this.currentLevel].done=!0,pe.globals.won+=1,this.backToLevel()}},{key:"checkSolution",value:function(){this.fakeDetermine=this.determine,this.solutionMode=!0,this.solutionButton.disabled();var e=void 0,t=void 0,i=this.planetSquares.length;for(e=0;e<this.planets.length;e+=1){var n=void 0;for(t=0;t<i&&(n=this.planetSquares[t],n.idX!==this.planets[e].x||n.idY!==this.planets[e].y);t+=1);this.selectPlanet(this.fakePlanets[e]),this.placePlanet(n)}this.planetPlaced()}},{key:"backToLevel",value:function(){this.resetPlanets(),pe.removeScene(),pe.setScene(new ut),pe.startScene()}},{key:"render",value:function(e){e.clearRect(0,0,pe.width,pe.height);var t=void 0,i=this.probeSquares.length;for(this.background.render(e),t=0;t<i;t+=1)this.probeSquares[t].render(e);for(this.beam&&(this.beam.render(e),e.fillStyle="#111111",e.fillRect(this.limitX1,this.limitY1,50*this.width,50*this.height)),i=this.objects.length,t=0;t<i;t+=1)this.objects[t].render(e);for(this.beam&&this.fake.render(e),t=0;t<this.indicator.length;t+=1)this.indicator[t].render(e);this.scientist.render(e),this.skipTutorial&&this.skipTutorial.render(e)}}]),t}(we),kt=bt,wt=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),mt=function(e){function t(e,i,n,o,s){H(this,t);var r=W(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n,o));return r.type=s,r.image=r.getImage(),r.lastVertical="left",r.lastHorizontal="up",r.lastVerticalFake="left",r.lastHorizontalFake="up",r.aligned=!1,r}return K(t,e),wt(t,[{key:"getImage",value:function(){return pe.getAsset(this.type)}},{key:"render",value:function(e){this.renderInLocation(this.x,this.y,e),this.square&&this.renderSelectionBox(this.x,this.y,e,"white")}},{key:"renderSelectionBox",value:function(e,t,i,n){i.fillStyle=n,i.globalAlpha=.2,i.fillRect(e,t,this.width,this.height),i.globalAlpha=1}},{key:"renderInLocation",value:function(e,t,i){i.drawImage(this.image,e,t,this.width,this.height),0===this.state&&this.renderSelectionBox(e,t,i,"red")}},{key:"align",value:function(e){this.lastVerticalFake=e.lastVertical,this.lastHorizontalFake=e.lastHorizontal,this.aligned=!0}},{key:"getDirectionForCat",value:function(e,t){return"left"===e||"right"===e?t&&!this.aligned?(this.lastHorizontalFake=gt(this.lastHorizontalFake),this.lastHorizontalFake):(t||(this.lastHorizontal=gt(this.lastHorizontal)),this.lastHorizontal):t&&!this.aligned?(this.lastVerticalFake=gt(this.lastVerticalFake),this.lastVerticalFake):(t||(this.lastVertical=gt(this.lastVertical)),this.lastVertical)}},{key:"setSquare",value:function(e){this.aligned=!1,this.square&&e&&this.square.setFake(null),this.square===e?this.square=null:this.square=e}},{key:"setState",value:function(e){this.state=e}}]),t}(ge),Et=mt,St={RED:"RED",GREEN:"GREEN",BLUE:"BLUE",SINGULARITY:"SINGULARITY",CAT:"CAT"},Tt=function(e,t){var i=document.createElement("canvas");return i.width=e,i.height=t,i},_t=function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=Tt(e,t),s=o.getContext("2d"),r=n?4:2,a=e-2*r,h=t-2*r;return s.fillStyle=i,s.fillRect(r,r,a,h),o},Pt=function(e,t,i,n,o,s){var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=Tt(e,t),l=h.getContext("2d"),u=n?o:2,c=e-2*r-2*u,f=t-2*a-2*u;return l.fillStyle=i,l.globalAlpha=s,l.fillRect(u,u,c,f),l.globalAlpha=1,n&&(l.strokeStyle=n,l.lineWidth=o,l.strokeRect(u+r,u+a,c,f)),h},Lt=function(e,t,i,n,o,s,r){var a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:2*Math.PI,l=Tt(e,t),u=l.getContext("2d"),c=e/2,f=t/2;return u.fillStyle=n,u.globalAlpha=r,u.arc(c,f,i,a,h),u.fill(),u.globalAlpha=1,o&&(u.strokeStyle=o,u.lineWidth=s,u.stroke()),l},xt=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Rt=function(e){function t(){J(this,t);var e=Z(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e.onSkip=e.onSkip.bind(e),e.moveToLevelChoice=e.moveToLevelChoice.bind(e),e.moveCloser=e.moveCloser.bind(e),e.background=new Re(0,0,pe.width,pe.height);var i=e.background.image.getContext("2d");return i.lineWidth=5,i.fillStyle="#888888",i.strokeStyle="#000000",i.moveTo(0,pe.height),i.lineTo(200,pe.height-200),i.lineTo(pe.width-200,pe.height-200),i.lineTo(pe.width,pe.height),i.lineTo(0,pe.height),i.fill(),i.moveTo(200,pe.height-200),i.lineTo(200,0),i.moveTo(pe.width-200,pe.height-200),i.lineTo(pe.width-200,0),i.stroke(),e.texts1=["oh, what a mess!","my lab is wrecked!","someone opened the cages once again!","bloody monkeys escaped!"],e.texts2=["oh, and who are you?!","i have never seen you here!","are you the new intern?","splendid!","you will help me out!","i've lost all of the data","good thing i know what's in blackboxes","follow me"],e.scientist=new it(pe.width/2-200,pe.height/2-75,e.texts1,8,3),e.scientist.setDialogFinishedCallback(e.moveCloser),e.skip=new Qe(pe.width-125,25,100,30,"skip & play",e.onSkip),e}return $(t,e),xt(t,[{key:"onSkip",value:function(){this.moveToLevelChoice()}},{key:"moveCloser",value:function(){this.scientist=new it(100,pe.height/2,this.texts2,16,5),this.scientist.setDialogFinishedCallback(this.moveToLevelChoice)}},{key:"moveToLevelChoice",value:function(){pe.removeScene(),pe._putAsset(le.BACKGROUND,_t(960,540,"#111111")),pe.setScene(new ut(0)),pe.startScene()}},{key:"moved",value:function(e,t){this.skip.moved(e,t),this.scientist.moved(e,t)}},{key:"released",value:function(){}},{key:"pressed",value:function(e,t){this.skip.pressed(e,t),this.scientist.pressed(e,t)}},{key:"update",value:function(){this.scientist.update()}},{key:"render",value:function(e){this.background.render(e),this.scientist.render(e),this.skip.render(e)}}]),t}(we),At=Rt,Ot=document.getElementById("g");pe.setup(Ot,960,540),pe._putAsset(le.RED,Lt(50,50,15,"#a10000","#a10000",2,.3)),pe._putAsset(le.BLUE,Lt(50,50,15,"#003399","#003399",2,.3)),pe._putAsset(le.GREEN,Lt(50,50,15,"#00a100","#00a100",2,.3)),pe._putAsset(le.SINGULARITY,Lt(50,50,10,"#000000","#ffffff",1,.6)),pe._putAsset(le.CAT,function(){var e=Lt(50,50,12,"#aa4400","#aa4400",1,.6),t=e.getContext("2d");t.drawImage(Lt(50,50,8,"#aa4400","#aa4400",1,.6),-10,-10);var i=Lt(50,50,5,"#aa4400","#aa4400",1,.6,3*Math.PI/4,Math.PI+3*Math.PI/4);t.drawImage(i,-10,-20),t.drawImage(i,-1,-20);var n=Lt(50,50,5,"#aa4400","#aa4400",1,.6,Math.PI);t.drawImage(n,6,15),t.drawImage(n,-6,15);var o=Tt(50,50);return t=o.getContext("2d"),t.drawImage(e,5,5),o}()),pe._putAsset(le.PLANET_SQUARE,Pt(50,50,"#330066","#330066",2,.3)),pe._putAsset(le.PLANET_SQUARE_ACTIVE,_t(50,50,"#660066")),pe._putAsset(le.PROBE_SQUARE,Pt(50,50,"#00cc99","#00cc99",2,.3)),pe._putAsset(le.PROBE_SQUARE_ACTIVE,Pt(50,50,"#e80000","#e80000",2,.3)),pe._putAsset(le.ENERGY,_t(100,350,"#dd55aa")),pe._putAsset(le.BACKGROUND,_t(960,540,"#111111")),pe._putAsset(le.PANEL,Pt(130,520,"#6600ff","#6600ff",2,.4)),pe._putAsset(le.LEVEL_SQUARE,_t(100,100,"#660066")),pe._putAsset(le.LEVEL_SQUARE_DONE,_t(100,100,"#006666")),pe._putAsset(le.LEVEL_SQUARE_ACTIVE,_t(100,100,"#6600ff")),pe.globals={won:0,lost:0,levels:[{width:3,height:3,planets:[{type:St.RED,x:0,y:1}],open:!0,isTutorial:!0,energyNotAffected:!0},{width:4,height:4,planets:[{type:St.RED},{type:St.RED}],open:!1},{width:3,height:3,planets:[{type:St.RED,x:0,y:1},{type:St.BLUE,x:1,y:1}],open:!1,newPlanets:!0,energyNotAffected:!0},{width:6,height:6,planets:[{type:St.RED},{type:St.RED},{type:St.GREEN},{type:St.BLUE}],open:!1},{width:4,height:4,planets:[{type:St.SINGULARITY}],open:!1,newSingularity:!0,energyNotAffected:!0},{width:6,height:6,planets:[{type:St.RED},{type:St.GREEN},{type:St.BLUE},{type:St.SINGULARITY}],open:!1},{width:4,height:4,planets:[{type:St.CAT,x:0,y:1},{type:St.GREEN,x:2,y:2}],open:!1,newCat:!0,energyNotAffected:!0},{width:7,height:7,planets:[{type:St.RED},{type:St.RED},{type:St.GREEN},{type:St.BLUE},{type:St.CAT},{type:St.CAT}],open:!1},{width:4,height:4,planets:[{type:St.SINGULARITY,x:0,y:1},{type:St.SINGULARITY,x:2,y:2}],open:!1,newWormhole:!0,energyNotAffected:!0},{width:7,height:7,planets:[{type:St.RED},{type:St.BLUE},{type:St.SINGULARITY},{type:St.SINGULARITY},{type:St.CAT},{type:St.CAT}],open:!1},{width:8,height:7,planets:[{type:St.RED},{type:St.RED},{type:St.BLUE},{type:St.BLUE},{type:St.GREEN},{type:St.GREEN},{type:St.CAT},{type:St.CAT}],open:!1},{width:9,height:7,planets:[{type:St.RED},{type:St.RED},{type:St.BLUE},{type:St.BLUE},{type:St.GREEN},{type:St.GREEN},{type:St.CAT},{type:St.CAT},{type:St.SINGULARITY},{type:St.SINGULARITY}],open:!1}]},pe.setScene(new At),pe.startScene();i(1)},function(e,t){}]);</script></body>

</html>
