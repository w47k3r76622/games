<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>13</title><style>#exp,#out,#out .t,.box{font-weight:400}.box,body,html{box-sizing:border-box;overflow:hidden}#logo,#op{position:relative;color:#fff}#ui,canvas{display:block}#ui,body,html{pointer-events:none;width:100vw;height:100vh}#speed .l,.t{font-family:Arial}#left,#minimap{width:10vw;position:absolute}#pm,body,html{background-color:#fff}#bl,#bottom,#exp,#intro,#left,#lm,#log1,#log2,#minimap,#minimap .p,#out,#outro,#place,#pm,#retry,#speed,#start,#time,#top,#ui,canvas{position:absolute}#bl,#logo,#op,#speed .l,.box{color:#fff}body,html{transition:background-color 4s;margin:0;padding:0;touch-action:none;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#intro,#outro{top:6vh;left:10vw;width:80vw;height:80vh;display:flex;align-items:center;justify-content:center;flex-direction:column;transform:scale(1);opacity:1;transition:transform 1s,opacity .8s}#logo{width:0;height:0;letter-spacing:-3vw;top:-24vh;left:-4vh;transform:skewX(10deg)}#log1,#log2{font-size:14vw;top:0}#log1{left:-15vw;text-shadow:0 0 2vw #444}#log2{color:#45abff;text-shadow:0 0 2vw #3c3c97;left:6vw}#exp,#out{top:40vh}.box{background-color:rgba(0,0,0,.4);border-left:1vw solid #fff;padding:6vh 4vh}#retry,#speed .l,#start,.h{font-weight:700}#retry,#start{font-size:2vh;left:-.4vh;text-transform:uppercase;bottom:-.4vh}#op{text-shadow:0 0 2vw #3c3c3c;top:-8vh}#bl{font-weight:400;opacity:.4;bottom:-4vw;left:0}.t{letter-spacing:1;line-height:1;font-size:1.5vh}.h{font-size:12vh}#ui{opacity:0;transition:opacity 1s}#bottom,#top{left:25vw;top:5vh;height:20vh;width:50vw}#bottom{top:auto;bottom:10vh;height:10vh}#speed{display:flex;justify-content:center;align-items:center;width:60vw;height:10vh;left:-5vw;top:10vh;transform:skew(20deg)}#speed .l{width:3vh;height:2vh;margin:.2vw;background:linear-gradient(180deg,#afafaf,#7e7e7e);transition:.2s ease-in;text-align:center}#speed #l12{width:6vw;height:2vh;transform:scaleY(3);background:linear-gradient(180deg,#e42,#421)!important;margin:.5vw;display:flex;align-items:center;justify-content:center}#speed .l.x{transform:scaleY(3);background:linear-gradient(180deg,#ffcf32,#fc9c36);opacity:1;animation:.3s bounce}#left{left:12vw;top:35vh;height:40vh}#minimap{top:20vh;left:0;height:0}#minimap .p,#pm{width:2vh;height:2vh;top:1vh;left:1vh;border-left:1vh solid #fff;border-top:1vh solid #fff;transform:scaleX(.6) rotate(45deg)}#lm{height:40vh;top:-20vh;left:2.25vh;width:.5vh;border-left:.5vh solid #fff}#pm{height:.5vh;width:6vh;border-radius:0;transform:none;border:none;left:-.5vh;top:0}#place,#time{width:10vw;height:10vh;font-size:3vh;display:flex;justify-content:center;align-items:center;top:1vh;left:0;color:#fff}#place{transform:skewX(-20deg)}#time{transform:skewX(20deg);left:auto;right:0}#time .s{font-size:6vh}@keyframes bounce{from{background:#fff;transform:scaleY(0)}to{background:#fff;transform:scaleY(10)}}</style></head><body id="body"><canvas id="glcanvas"></canvas><div id="intro"><div id="logo"><div id="log1" class="t h">SUB</div><div id="log2" class="t h">13</div></div><div id="exp" class="box t">► Race ahead of the competition<br /><br />► Your speed is constantly decreasing<br /><br />► Build up speed by picking up <b>boosts</b><br /><br />► If a <b>boost</b> takes you over <b>12</b> speed, you <b>lose</b> it instead<br /><br />► Use sound<br /><br /><br /><div id="start" class="t h">SPACE/TAP: Start</div></div><div id="bl" class="t">A JS13K entry by <b>Charlie Norin</b> and <b>Felix Magnell</b></div></div><div id="outro"><div id="op" class="t h">5th</div><div id="out" class="box"><div id="ot" class="t">Could be worse, but not by a lot. Go again!</div><div id="retry" class="t h">SPACE/TAP: Restart</div></div></div></div><div id="ui"><div id="top"><div id="speed"></div></div><div id="left"><div id="minimap"><div id="pm"></div><div id="lm"></div></div></div><div id="bottom"><div id="time" class="t"><div class="h">60</div>s</div><div id="place" class="t"><div class="h">5</div>/5</div></div></div><script>const T=()=>Math.floor(5*Math.random()+1);function ba(c){const d=Math.sqrt(c[0]*c[0]+c[1]*c[1]+c[2]*c[2]);return[c[0]/d,c[1]/d,c[2]/d]}function ia(c,d){return[c[1]*d[2]-c[2]*d[1],c[2]*d[0]-c[0]*d[2],c[0]*d[1]-c[1]*d[0]]}function ja(c,d){return c[0]*d[0]+c[1]*d[1]+c[2]*d[2]};var ka=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),na=new Uint16Array([0,1,2,2,3,0,4,5,6,6,7,4,8,9,10,10,11,8,12,13,14,14,15,12,16,17,18,18,19,16,20,21,22,22,23,20]);function oa(c){function d(q){const x=a.createFramebuffer();a.bindTexture(a.TEXTURE_2D,q);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.canvas.width,a.canvas.height,0,a.RGBA,a.UNSIGNED_BYTE,null);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.bindFramebuffer(a.FRAMEBUFFER,x);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,q,0);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,b);return x}function e(q,x){q=a.createShader(q);a.shaderSource(q,x);a.compileShader(q);return a.getShaderParameter(q,a.COMPILE_STATUS)?q:(console.error(a.getShaderInfoLog(q)),a.deleteShader(q),null)}function h(q,x){q=e(a.VERTEX_SHADER,q);x=e(a.FRAGMENT_SHADER,x);const z=a.createProgram();a.attachShader(z,q);a.attachShader(z,x);a.linkProgram(z);a.useProgram(z);return a.getProgramParameter(z,a.LINK_STATUS)?z:(console.error(a.getProgramInfoLog(z)),a.deleteProgram(z),null)}const a=c.canvas.getContext("webgl2");a.enable(a.DEPTH_TEST);a.enable(a.BLEND);const f=[],m=[],b=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,b);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,a.canvas.width,a.canvas.height);const k=a.createTexture(),C=d(k),F=a.createTexture(),y=d(F),A=h("#version 300 es\n\n  precision mediump float;\n\n  const vec2 positions[3] = vec2[3](\n      vec2(-1.0, -1.0),\n      vec2(3.0, -1.0),\n      vec2(-1.0, 3.0)\n  );\n\n  void main() {\n      gl_Position = vec4(positions[gl_VertexID], -1.0, 1.0);\n  }\n  ","#version 300 es\n\n  precision mediump float;\n\n  uniform vec2 uResolution;\n  uniform sampler2D uTexture;\n\n  out vec4 outColor;\n\n  void main() {\n    vec2 uv = gl_FragCoord.xy / uResolution;\n    outColor = texture(uTexture, uv);\n  }\n  ");a.useProgram(A);const B=a.getUniformLocation(A,"uTexture"),G=a.getUniformLocation(A,"uResolution");return{m:a,createProgram:h,A:function(q,x,z,I=!0){var L=new Float32Array([]);a.useProgram(q);q=a.getAttribLocation(q,x);const U=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,U);a.vertexAttribPointer(q,z,a.FLOAT,!1,0,0);a.enableVertexAttribArray(q);I&&a.vertexAttribDivisor(q,1);const W=()=>{a.bindBuffer(a.ARRAY_BUFFER,U);a.bufferData(a.ARRAY_BUFFER,L,a.DYNAMIC_DRAW)};return{V:()=>a.bindBuffer(a.ARRAY_BUFFER,U),i:V=>{L=new Float32Array([...L,...V]);W()},aa:()=>L,la:V=>{L=V;W()}}},ja:d,ga:q=>{a.viewport(0,0,a.canvas.width,a.canvas.height);a.canvas.width=window.innerWidth;a.canvas.height=window.innerHeight;a.bindTexture(a.TEXTURE_2D,F);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.canvas.width,a.canvas.height,0,a.RGBA,a.UNSIGNED_BYTE,null);a.bindTexture(a.TEXTURE_2D,k);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.canvas.width,a.canvas.height,0,a.RGBA,a.UNSIGNED_BYTE,null);a.bindFramebuffer(a.FRAMEBUFFER,C);a.bindRenderbuffer(a.RENDERBUFFER,b);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,a.canvas.width,a.canvas.height);a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);for(var x of f)x(q);var z=y,I=k;for(x of m)a.bindFramebuffer(a.FRAMEBUFFER,z),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,I),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),x(q),z=z==C?y:C,I=I==k?F:k;a.bindFramebuffer(a.FRAMEBUFFER,null);a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);a.useProgram(A);a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,I);a.uniform2f(G,a.canvas.width,a.canvas.height);a.uniform1i(B,0);a.drawArrays(a.TRIANGLES,0,3)},Y:q=>f.push(q),R:q=>m.push(q)}};function pa(c){function d(m,b,k){m[0]+=(b[0]-m[0])*k*.001;m[1]+=(b[1]-m[1])*k*.001;m[2]+=(b[2]-m[2])*k*.001}const e=document.getElementById("body");var h;const a=[{u:[.7,.7,.9],track:[1,1,1],D:[.3,.2,.4],g:[.8,.8,.8]},{u:[.7,.6,.4],track:[1,.8,.4],D:[.8,.5,.5],g:[.9,.9,.7]},{u:[.2,.1,.4],track:[.4,.9,.1],D:[.5,.9,.5],g:[.2,.8,.2]},{u:[.1,.1,.1],track:[.8,.9,1],D:[.8,.8,.9],g:[1,1,1]}],f={u:[...a[0].u],track:[...a[0].track],D:[...a[0].D],g:[...a[0].g]};return{update:function(m){const b=a[Math.abs(Math.floor(c.g.speed/.3))];b!==h&&(e.style.backgroundColor=`rgb(${b.u.map(k=>Math.floor(255*k)).join(",")})`,h=b);d(f.u,h.u,m);d(f.track,h.track,m);d(f.D,h.D,m);d(f.g,h.g,m)},current:f,keys:Object.keys(f)}};function qa(c){function d(f,m){h||(h=!0,c.s.T());" "===f.key&&.01>c.j.o&&!c.race.I&&c.race.start();if(!(.9>c.j.o))switch(f.key.toLowerCase()){case "a":case "h":case "arrowleft":!a.left&&m?c.g.G=1:a.right||m||(c.g.G=0);a.left=m;break;case "arrowright":case "l":case "d":!a.right&&m?c.g.G=-1:a.left||m||(c.g.G=0)}}function e(f,m){const b=f.changedTouches.item(0).clientX<window.innerWidth/2,k=f.changedTouches.item(0).clientY>window.innerHeight/2;d({key:b?"arrowleft":"arrowright"},m);k&&d({key:" "},m);f.preventDefault()}var h=!1;const a={left:!1,right:!1};document.addEventListener("keydown",function(f){d(f,!0)});document.addEventListener("keyup",function(f){d(f,!1)});document.addEventListener("touchstart",function(f){e(f,!0)});document.addEventListener("touchend",function(f){e(f,!1)});document.addEventListener("touchcancel",function(f){e(f,!1)});return a};function ra(c){function d(){return"undefined"!==typeof InstallTrigger}function e(J,w,E,D,H=1){J=J.createBiquadFilter();J.type=E;J.frequency.value=D;J.Q.value=H;w.connect(J);return J}const h={M:0,J:0,H:0,F:0};let a=!1,f=0,m=0,b=.5/6,k=.5/3,C=.14,F=.07;const y={C0:16.35,"C#0":17.32,D0:18.35,"D#0":19.45,E0:20.6,F0:21.83,"F#0":23.12,G0:24.5,"G#0":25.96,A0:27.5,"A#0":29.14,B0:30.87,C1:32.7,"C#1":34.65,D1:36.71,"D#1":38.89,E1:41.2,F1:43.65,"F#1":46.25,G1:49,"G#1":51.91,A1:55,"A#1":58.27,B1:61.74,C2:65.41,"C#2":69.3,D2:73.42,"D#2":77.78,E2:82.41,F2:87.31,"F#2":92.5,G2:98,"G#2":103.83,A2:110,"A#2":116.54,B2:123.47,C3:130.81,"C#3":138.59,D3:146.83,"D#3":155.56,E3:164.81,F3:174.61,"F#3":185,G3:196,"G#3":207.65,A3:220,"A#3":233.08,B3:246.94,C4:261.63,"C#4":277.18,D4:293.66,"D#4":311.13,E4:329.63,F4:349.23,"F#4":369.99,G4:392,"G#4":415.3,A4:440,"A#4":466.16,B4:493.88,C5:523.25,"C#5":554.37,D5:587.33,"D#5":622.25,E5:659.26,F5:698.46,"F#5":739.99,G5:783.99,"G#5":830.61,A5:880,"A#5":932.33,B5:987.77,C6:1046.5,"C#6":1108.73,D6:1174.66,"D#6":1244.51,E6:1318.51,F6:1396.91,"F#6":1479.98,G6:1567.98,"G#6":1661.22,A6:1760,"A#6":1864.66,B6:1975.53,C7:2093,"C#7":2217.46,D7:2349.32,"D#7":2489.02,E7:2637.02,F7:2793.83,"F#7":2959.96,G7:3135.96,"G#7":3322.44,A7:3520,"A#7":3729.31,B7:3951.07,C8:4186.01,"C#8":4434.92,D8:4698.63,"D#8":4978.03,E8:5274.04,F8:5587.65,"F#8":5919.91,G8:6271.93,"G#8":6644.88,A8:7040,"A#8":7458.62,B8:7902.13},A=[[[0,4]],[[0,4]],[[0,4]],[[0,4]],[["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5]],[["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5]],[["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125]],[["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5]]],B=[[[0,4]],[[0,4]],[[0,4]],[[0,4]],[[0,.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],[0,.125],["E4",.125],["A4",.125],["F#4",.125],[0,.125],["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5]],[[0,.125],["B4",.125],["A4",.125],["F#5",.125],[0,.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],["E4",.125],[0,.125],["F#4",.125],["B4",.125],["E4",.125],[0,.125],["F#4",.125],["C#5",.125],[0,.5]],[[0,.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],[0,.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125]],[[0,.125],["B4",.125],[0,.125],["F#5",.125],["E4",.125],[0,.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5]]],G=d()?B:A,q=[[["B3",.5],["E4",.5],["G4",.5],["F#4",.5],[0,.25],["D4",.25],["B3",.5],["E4",1]],[["B3",.5],["E4",.5],["G4",.5],["F#4",.5],[0,.25],["D4",.25],["B3",.5],["E4",1]],[["D4",.5],["G4",.5],["A#4",.5],["A4",.5],["G4",.5],["A#4",.5],["C5",.5],["F5",.5]],[["D4",.5],["G4",.5],["A#4",.5],["A4",.5],["G4",.5],["A#4",.5],["C5",.5],["D5",.5]],[[0,4]],[[0,4]],[[0,4]],[[0,4]]],x=[[[0,4]],[[0,4]],[["D3",k],["G3",k],["A3",k],["A#3",k],["D4",k],["G4",k],["A4",k],["A#4",k],["D5",k],["G5",k],["A5",k],["A#5",k],["G3",k],["A#3",k],["C4",k],["F4",k],["G4",k],["A#4",k],["C5",k],["F5",k],["G5",k],["A#5",k],["C6",k],["F6",k]],[["G3",k],["A3",k],["A#3",k],["D4",k],["G4",k],["A4",k],["A#4",k],["D5",k],["G5",k],["A5",k],["A#5",k],["D6",k],["A#3",k],["C4",k],["D4",k],["G4",k],["A#4",k],["C5",k],["D5",k],["G5",k],["A#5",k],["C6",k],["D6",k],["G6",k]],[[0,4]],[[0,4]],[[0,4]],[[0,4]]],z=[[[0,4]],[[0,4]],[["D3",b],["G3",b],["A3",b],["A#3",b],["D4",b],["G4",b],["A4",b],["A#4",b],["D5",b],["G5",b],["A5",b],["A#5",b],["A#5",b],["A5",b],["G5",b],["D5",b],["A#4",b],["A4",b],["G4",b],["D4",b],["A#3",b],["A3",b],["G3",b],["D3",b],["G3",b],["A#3",b],["C4",b],["F4",b],["G4",b],["A#4",b],["C5",b],["F5",b],["G5",b],["A#5",b],["C6",b],["F6",b],["F6",b],["C6",b],["A#5",b],["G5",b],["F5",b],["C5",b],["A#4",b],["G4",b],["F4",b],["C4",b],["A#3",b],["G3",b]],[["G3",b],["A3",b],["A#3",b],["D4",b],["G4",b],["A4",b],["A#4",b],["D5",b],["G5",b],["A5",b],["A#5",b],["D6",b],["D6",b],["A#5",b],["A5",b],["G5",b],["D5",b],["A#4",b],["A4",b],["G4",b],["D4",b],["A#3",b],["A3",b],["G3",b],["A#3",b],["C4",b],["D4",b],["G4",b],["A#4",b],["C5",b],["D5",b],["G5",b],["A#5",b],["C6",b],["D6",b],["G6",b],["G6",b],["D6",b],["C6",b],["A#5",b],["G5",b],["D5",b],["C5",b],["A#4",b],["G4",b],["D4",b],["C4",b],["A#3",b]],[[0,4]],[[0,4]],[[0,4]],[[0,4]]],I=[[[0,4]],[[0,4]],[["G4",.25],["A#4",.25],["A4",.25],["G4",.25],["G4",.25],["A#4",.25],["A4",.25],["G4",.25],["G4",.25],["A#4",.25],["A4",.25],["G4",.25],["G4",.25],["A#4",.25],["A4",.25],["G4",.25]],[["G4",.25],["A#4",.25],["A4",.25],["G4",.25],["G4",.25],["A#4",.25],["A4",.25],["G4",.25],["D4",.25],["A4",.25],["F#4",.25],["D4",.25],["D4",.25],["A4",.25],["F#4",.25],["D4",.25]],[[0,4]],[[0,4]],[[0,4]],[[0,4]]],L=[[[["B2","E3"],2],[["C3","F#3"],2]],[[["D3","G3"],2],[["E3","A3"],2]],[[["G3","D4"],2],[["A3","D#4"],2]],[[["A#3","F4"],2],[["C4","G4"],2]],[[["F#4","A4"],2],[["B3","E4"],2]],[[["A3","D4"],2],[["E3","B3"],2]],[[["F#4","A4"],2],[["B3","E4"],2]],[[["A3","D4"],2],[["E3","B3"],2]]],U=[[[0,4]],[[1,.5],[0,.25],[1,.25],[0,.25],[1,.25],[0,.5],[0,.125],[1,.25],[1,.125],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125]],[[1,.5],[0,.25],[1,.25],[0,.125],[1,.125],[0,.25],[1,.5],[1,.125],[1,.25],[1,.125],[0,.25],[1,.25],[1,.25],[0,.125],[1,.125],[0,.25],[0,.125],[1,.125]],[[0,4]],[[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25],[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25]],[[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25],[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25]],[[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25],[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25]],[[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25],[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25]]],W=[[[0,4]],[[0,4]],[[0,4]],[[0,4]],[[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125],[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125]],[[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125],[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125]],[[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125],[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125]],[[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125],[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125]]],V=[[["E1",4]],[["E1",4]],[["G1",4]],[["G1",4]],[["E2",4]],[["G1",4]],[["E2",4]],[["G1",4]]],ca=[[[0,4]],[[0,4]],[[0,4]],[[0,.25],[1,.25],[1,.5],[1,.125],[1,.125],[1,.25],[0,.125],[1,.25],[1,.125],[0,.125],[1,.125],[1,.25],[1,.125],[1,.125],[1,.25],[1,.25],[1,.25],[1,.5]],[[0,.25],[1,.25],[1,.5],[1,.125],[1,.125],[1,.25],[0,.125],[1,.25],[1,.125],[0,.125],[1,.125],[1,.25],[1,.125],[1,.125],[1,.25],[1,.25],[1,.25],[1,.5]],[[0,.25],[1,.25],[1,.5],[1,.125],[1,.125],[1,.25],[0,.125],[1,.25],[1,.125],[0,.125],[1,.125],[1,.25],[1,.125],[1,.125],[1,.25],[1,.25],[1,.25],[1,.5]],[[0,.25],[1,.25],[1,.5],[1,.125],[1,.125],[1,.25],[0,.125],[1,.25],[1,.125],[0,.125],[1,.125],[1,.25],[1,.125],[1,.125],[1,.25],[1,.25],[1,.25],[1,.5]],[[0,.25],[1,.25],[1,.5],[1,.125],[1,.125],[1,.25],[0,.125],[1,.25],[1,.125],[0,.125],[1,.125],[1,.25],[1,.125],[1,.125],[1,.25],[1,.25],[1,.25],[1,.5]]];return{keys:Object.keys(h),v:h,fa:function(J){h.M=Math.max(0,h.M-J/1E3);h.H=Math.max(0,h.H-J/500);h.J=Math.max(0,h.J-J/500);h.F=Math.max(0,h.F-J/500)},T:function(){function J(p){const n=g.createOscillator(),v=g.createGain();n.type="sine";n.frequency.setValueAtTime(150,p);n.frequency.exponentialRampToValueAtTime(.01,p+.5);v.gain.setValueAtTime(1,p);v.gain.exponentialRampToValueAtTime(.001,p+.5);const l=g.createBiquadFilter();l.type="peaking";l.frequency.value=120;l.gain.value=3;n.connect(v);v.connect(l);l.connect(da);setTimeout(function(){return h.F=1},1E3*(p-g.currentTime));n.start(p);n.stop(p+.5)}function w(p){var n=g.createBuffer(1,.2*g.sampleRate,g.sampleRate),v=n.getChannelData(0);for(var l=0;l<n.length;l++)v[l]=2*Math.random()-1;v=g.createBufferSource();v.buffer=n;n=g.createBiquadFilter();n.type="highpass";n.frequency.setValueAtTime(1500,p);l=g.createGain();l.gain.setValueAtTime(1,p);l.gain.exponentialRampToValueAtTime(.01,p+.2);v.connect(n);n.connect(l);l.connect(Y);l=g.createBuffer(1,.05*g.sampleRate,g.sampleRate);n=l.getChannelData(0);for(var r=0;r<l.length;r++)n[r]=2*Math.random()-1;n=g.createBufferSource();n.buffer=l;l=g.createBiquadFilter();l.type="highpass";l.frequency.setValueAtTime(1E3,p);r=g.createGain();r.gain.setValueAtTime(1,p);r.gain.exponentialRampToValueAtTime(.01,p+.05);n.connect(l);l.connect(r);r.connect(Y);l=g.createOscillator();l.type="square";l.frequency.setValueAtTime(400,p);l.connect(Y);v.start(p);n.start(p);l.start(p);v.stop(p+.2);n.stop(p+.05);l.stop(p+.01);setTimeout(function(){return h.H=1},1E3*(p-g.currentTime))}function E(p){var n=g.createBuffer(1,.05*g.sampleRate,g.sampleRate),v=n.getChannelData(0);for(var l=0;l<n.length;l++)v[l]=2*Math.random()-1;v=g.createBufferSource();v.buffer=n;n=g.createBiquadFilter();n.type="highpass";n.frequency.setValueAtTime(8E3,p);l=g.createGain();l.gain.setValueAtTime(.5,p);l.gain.exponentialRampToValueAtTime(.01,p+.05);v.connect(n);n.connect(l);l.connect(ea);v.start(p);v.stop(p+.05)}function D(p,n,v){const l=g.createGain();l.gain.value=C;const r=g.createOscillator();r.type="triangle";r.frequency.setValueAtTime(p,n);const t=g.createBiquadFilter();t.type="lowpass";t.frequency.setValueAtTime(800,n);if(d())r.connect(t),t.connect(l),l.connect(O),r.start(n),r.stop(n+v);else{const u=g.createOscillator();u.frequency.value=5;const K=g.createGain();K.gain.value=7;u.connect(K);K.connect(r.frequency);r.frequency.setTargetAtTime(p,n,.1);r.connect(t);t.connect(l);l.connect(O);r.start(n);u.start(n);r.stop(n+v);u.stop(n+v)}}function H(p,n,v){const l=g.createGain();l.gain.value=.5;const r=[];for(let t=0;4>t;t++){const u=g.createOscillator();u.type="sine";const K=10*(t-2);u.frequency.setValueAtTime(2*p,n);u.detune.setValueAtTime(K,n);u.connect(l);r.push(u)}p=g.createConvolver();p.buffer=function(){const t=.8*g.sampleRate,u=g.createBuffer(2,t,g.sampleRate);for(let K=0;K<u.numberOfChannels;K++){const Z=u.getChannelData(K);for(let P=0;P<t;P++)Z[P]=(2*Math.random()-1)*Math.pow(1-P/t,2)}return u}();l.connect(p);p.connect(aa);aa.connect(O);O.connect(g.destination);r.forEach(t=>{t.start(n);t.stop(n+v)})}function M(p,n,v){const l=g.createOscillator();l.type="sawtooth";l.frequency.value=p;l.detune.value=0;var r=g.createGain();r.gain.value=.3;l.connect(r);const t=g.createBiquadFilter();t.type="notch";t.frequency.value=.3*g.sampleRate;t.Q.value=.3;p=g.createBiquadFilter();p.type="lowpass";p.frequency.setTargetAtTime(500,g.currentTime,0);p.Q.value=.04;p.gain.value=1;var u=g.createBiquadFilter();u.type="highpass";u.frequency.setTargetAtTime(200,g.currentTime,0);u.Q.value=1;r.connect(t);t.connect(p);p.connect(u);r=g.createGain();r.gain.value=.9;u.connect(r);r.connect(O);O.connect(g.destination);u=g.createOscillator();r=g.createGain();u.type="sine";u.frequency.value=3;r.gain.value=100;u.connect(r);r.connect(p.frequency);setTimeout(function(){return h.J=1},1E3*(n-g.currentTime));l.start(n);u.start(n);l.stop(n+v);u.stop(n+v)}function N(p,n,v){const l=g.createOscillator();l.type="sawtooth";l.frequency.value=p;l.detune.value=0;var r=g.createGain();r.gain.value=.5;l.connect(r);const t=g.createBiquadFilter();t.type="notch";t.frequency.value=.3*g.sampleRate;t.Q.value=.3;const u=g.createBiquadFilter();u.type="lowpass";u.frequency.setTargetAtTime(500,g.currentTime,0);u.Q.value=.04;u.gain.value=1;p=g.createBiquadFilter();p.type="highpass";p.frequency.setTargetAtTime(200,g.currentTime,0);p.Q.value=1;r.connect(t);t.connect(u);u.connect(p);r=g.createGain();r.gain.value=.5;p.connect(r);r.connect(O);O.connect(g.destination);l.start(n);l.stop(n+v)}function sa(p,n,v){const l=g.createGain(),r=g.createOscillator(),t=g.createOscillator();r.type="sine";r.frequency.setValueAtTime(2*p,n);t.type="sine";t.frequency.setValueAtTime(4*p,n);t.detune.value=3;r.connect(l);t.connect(l);l.gain.setValueAtTime(F,n);l.gain.exponentialRampToValueAtTime(1E-4,n+v);r.start(n);t.start(n);r.stop(n+v);t.stop(n+v);l.connect(O);O.connect(g.destination)}function ta(p,n,v){const l=g.createOscillator(),r=g.createOscillator(),t=g.createOscillator();l.type="sawtooth";r.type="sawtooth";t.type="sawtooth";l.frequency.value=p;r.frequency.value=4*p;t.frequency.value=2*p;l.detune.value=0;r.detune.value=2;t.detune.value=-3;var u=g.createGain(),K=g.createGain();const Z=g.createGain();u.gain.value=.8;K.gain.value=.6;Z.gain.value=.6;l.connect(u);r.connect(K);t.connect(Z);const P=g.createBiquadFilter();P.type="notch";P.frequency.value=120;P.Q.value=1;p=g.createBiquadFilter();p.type="lowpass";p.frequency.setTargetAtTime(400,g.currentTime,0);u.connect(P);K.connect(P);Z.connect(P);P.connect(p);p.connect(fa);u=g.createOscillator();K=g.createGain();u.type="sine";u.frequency.value=3;K.gain.value=100;u.connect(K);K.connect(p.frequency);l.start(n);r.start(n);t.start(n);u.start(n);l.stop(n+v);r.stop(n+v);t.stop(n+v);u.stop(n+v)}function ha(p,n,v){let l=n;p[m].forEach(([r,t])=>{1===r&&v(l);l+=t})}function X(p,n,v){let l=v;p[f].forEach(([r,t])=>{const u=y[r];0!==r&&n(u,l,t);l+=t});return l}function ua(p,n,v){let l=v;p[f].forEach(([r,t])=>{r.forEach(u=>{n(y[u],l,t)});l+=t});return l}function la(){const p=X(V,ta,R||S);X(q,D,R||S);X(G,M,R||S);X(I,sa,R||S);var n=R||S;ha(U,n,J);ha(W,n,w);ha(ca,n,E);d()||ua(L,H,R||S);a&&(.9<c.g.speed?X(z,N,R||S):.4<c.g.speed&&X(x,N,R||S));7>f?f++:(f=2,F=.02,C=.1,a=!0);6<m?m=4:m++;R=p;setTimeout(la,1E3*(R-g.currentTime))}const g=new (window.AudioContext||window.webkitAudioContext),O=g.createGain();O.gain.value=.5;O.connect(g.destination);const Q=g.createDynamicsCompressor();Q.threshold.setValueAtTime(-20,g.currentTime);Q.knee.setValueAtTime(30,g.currentTime);Q.ratio.setValueAtTime(4,g.currentTime);Q.attack.setValueAtTime(.005,g.currentTime);Q.release.setValueAtTime(.25,g.currentTime);Q.connect(O);const fa=g.createGain();fa.gain.value=.9;e(g,fa,"lowpass",150).connect(Q);const ma=g.createGain();ma.gain.value=.6;e(g,ma,"highpass",500).connect(Q);const aa=g.createGain();aa.gain.value=.12;e(g,aa,"bandpass",300,1).connect(Q);const da=g.createGain();da.gain.value=.4;const Y=g.createGain();Y.gain.value=.25;const ea=g.createGain();ea.gain.value=.3;da.connect(Q);Y.connect(Q);ea.connect(Q);let R;const S=g.currentTime+.5;la()}}};function va(c){const d={o:0},e=c.h.m,h=c.h.createProgram("#version 300 es\n\n  precision mediump float;\n\n  in vec3 a;\n  in vec3 b;\n  in vec3 c;\n  in vec3 d;\n  in vec4 e;\n  in vec4 f;\n  in vec4 g;\n  in vec4 r;\n\n  uniform float h;\n  uniform vec2 i;\n  uniform mat4 j;\n  uniform vec4 k;\n  uniform vec4 l;\n  uniform vec4 q;\n  uniform vec4 m;\n  uniform float n;\n  uniform vec3 o;\n  uniform vec3 p;\n\n  out float vDepth;\n  out vec3 vColor;\n\n  void main() {\n    float levelScale = length(f * k);\n    float powerupScale = length(g * l);\n    float powerupValue = length(g * m);\n    vec4 opponentVec = (r * q);\n\n    vec3 scaledVertex = a * c * (.4 + (levelScale * 0.4));\n\n    vec3 bgTrans = b;\n    bgTrans.z -= (n / 100.);\n    bgTrans.z = mod(bgTrans.z, 20.) - 5.;\n    bgTrans *= e.x;\n\n    vec3 oTrans = b;\n    oTrans += vec3(0., 0., powerupScale);\n    oTrans.x -= step((powerupValue * 0.12) - 0.3, b.y) * 9999.;\n    oTrans *= e.y;\n\n    vec3 playerTrans = b;\n    playerTrans += o;\n    playerTrans *= e.z;\n\n    vec3 opponentTrans = b;\n    opponentTrans.z += opponentVec.x + opponentVec.y + opponentVec.z + opponentVec.w;\n\n    opponentTrans.x = (\n      smoothstep(.0, .4, cos((opponentTrans.z + (n * 0.02)) * 0.01))\n      - smoothstep(.7, 1.,sin((opponentTrans.z + (n * 0.05)) * 0.01))\n    ) * .3;\n\n    opponentTrans *= e.w;\n\n    vec3 combined = bgTrans + oTrans + playerTrans + opponentTrans;\n    float plainMod = 1. - step(0.01, abs(length(combined)));\n    combined += (b * plainMod);\n\n    vec4 vertexPosition = j * vec4(scaledVertex + combined, 1.);\n    float depth = max(vertexPosition.z * vertexPosition.z * 0.1, 0.);\n    vDepth = (depth / vertexPosition.w);\n\n    vec3 color = d + (vec3(f.rgb * levelScale));\n\n    vColor = color * ((1. + (h * .6)) * (0.2 + (vDepth * 0.6)));\n    vColor += (plainMod * vec3(.3));\n\n    gl_Position = vertexPosition + vec4(i * depth, 0, 0.);\n  }","#version 300 es\n\n  precision mediump float;\n\n  const float fn = 0.3;\n  const float ff = 1.4;\n\n  in float vDepth;\n  in vec3 vColor;\n\n  out vec4 oColor;\n\n  void main() {\n    float fog = smoothstep(fn, ff, vDepth);\n    oColor = mix(vec4(vColor, 1.), vec4(0.), fog);\n  }"),a=e.createVertexArray();e.bindVertexArray(a);const f=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f);e.bufferData(e.ELEMENT_ARRAY_BUFFER,na,e.STATIC_DRAW);const m=c.h.A(h,"a",3,!1);m.i(ka);const b=c.h.A(h,"d",3),k=c.h.A(h,"f",4),C=c.h.A(h,"e",4),F=c.h.A(h,"g",4),y=c.h.A(h,"b",3),A=c.h.A(h,"c",3),B=c.h.A(h,"r",4);e.bindVertexArray(null);const G=e.getUniformLocation(h,"i"),q=e.getUniformLocation(h,"k"),x=e.getUniformLocation(h,"j"),z=e.getUniformLocation(h,"n"),I=e.getUniformLocation(h,"h"),L=e.getUniformLocation(h,"o"),U=e.getUniformLocation(h,"p"),W=e.getUniformLocation(h,"l"),V=e.getUniformLocation(h,"m"),ca=e.getUniformLocation(h,"q");d.X=(w,E)=>{y.i([.3*w,-.3+.1*E,0]);b.i([.5,.5,E/5]);A.i([.3,.05,.2]);C.i([0,1,0,0]);F.i([-1==w?1:0,0==w?1:0,1==w?1:0,0]);k.i([0,0,0,0]);B.i([0,0,0,0])};d.Z=(w,E)=>{y.i([w,-.3,E]);b.i([.8,.8,.8]);A.i([.2,.02,.37]);C.i([0,0,0,0]);F.i([0,0,0,0]);k.i([0,0,0,0]);B.i([0,0,0,0])};d.L=(w,E,D,H,M,N=-1)=>{y.i([w,-.2,E]);b.i([Math.max(.4,9*D),Math.max(.4,10*D),Math.max(.4,12*D)]);A.i([D,H,M]);C.i([0,0,-1===N?1:0,-1===N?0:1]);F.i([0,0,0,0]);k.i([0,0,0,0]);B.i([0===N?1:0,1===N?1:0,2===N?1:0,3===N?1:0])};d.W=()=>{var w=2*Math.random()*Math.PI;y.i([1.6*Math.cos(w),1.6*Math.sin(w),20*Math.random()+-4]);w=Math.random()*(1-.9)+.9;b.i([w,w,w]);w=.4+.2*Math.random();A.i([w,w,.6+.4*Math.random()]);C.i([1,0,0,0]);F.i([0,0,0,0]);w=Math.random();k.i([1*(0<w&&.1>w),1*(.1<w&&.2>w),1*(.2<w&&.3>w),1*(.3<w&&.4>w)]);B.i([0,0,0,0])};let J=1010*Math.random()+1304;d.ha=w=>{J+=w*c.g.speed*1.6*d.o;e.useProgram(h);e.bindVertexArray(a);w=1/Math.tan((Math.PI/3+.4*c.g.speed)/2);var E=1/-999.9;w=new Float32Array([w/(e.canvas.width/e.canvas.height),0,0,0,0,w,0,0,0,0,1000.1*E,-1,0,0,200*E,0]);E=[1.2*c.g.N,0,0];var D=[10*(1-d.o),10*(1-d.o),10];D=ba([E[0]-D[0],E[1]-D[1],E[2]-D[2]]);var H=ba(ia([0,1,0],D)),M=ia(D,H);E=new Float32Array([H[0],M[0],D[0],0,H[1],M[1],D[1],0,H[2],M[2],D[2],0,-ja(H,E),-ja(M,E),-ja(D,E),1]);D=new Float32Array(16);for(H=0;4>H;H++)for(M=0;4>M;M++){D[4*M+H]=0;for(let N=0;4>N;N++)D[4*M+H]+=w[4*N+H]*E[4*M+N]}e.uniformMatrix4fv(x,!1,D);e.uniform1f(z,J);e.uniform1f(I,c.g.speed);e.uniform2f(G,c.track.offset.x,c.track.offset.y);e.uniform4f(W,c.C.l[0],c.C.l[1],c.C.l[2],0);e.uniform4f(V,c.C.values[0],c.C.values[1],c.C.values[2],0);e.uniform3f(L,c.g.position.x+c.g.P.x,c.g.position.y+c.g.P.y,c.g.position.z+c.g.P.z);e.uniform3f(U,.2,-.1,.1);e.uniform4f(q,c.s.v.H,c.s.v.F,c.s.v.M,c.s.v.J);e.uniform4f(ca,c.B.l[0],c.B.l[1],c.B.l[2],c.B.l[3]);m.V();e.drawElementsInstanced(e.TRIANGLES,na.length,e.UNSIGNED_SHORT,0,b.aa().length/3);e.bindVertexArray(null)};return d};function wa(c){var d=(a,f="")=>{const m=c.h.createProgram("#version 300 es\n\n  precision mediump float;\n\n  const vec2 positions[3] = vec2[3](\n      vec2(-1.0, -1.0),\n      vec2(3.0, -1.0),\n      vec2(-1.0, 3.0)\n  );\n\n  void main() {\n      gl_Position = vec4(positions[gl_VertexID], -1.0, 1.0);\n  }\n  ",`#version 300 es\nprecision mediump float;const float tau = 3.1415 * 2.;uniform float ${"c"};uniform float ${"f"};uniform vec2 ${"b"};uniform sampler2D ${"a"};uniform vec4 ${"d"};uniform vec2 ${"e"};out vec4 outColor;${a}void main() {vec2 uv = gl_FragCoord.xy / ${"b"};${f}}`),b=c.h.m.getUniformLocation(m,"a"),k=c.h.m.getUniformLocation(m,"b"),C=c.h.m.getUniformLocation(m,"c"),F=c.h.m.getUniformLocation(m,"d"),y=c.h.m.getUniformLocation(m,"e"),A=c.h.m.getUniformLocation(m,"f");var B=0;return G=>{B+=G;c.h.m.useProgram(m);c.h.m.uniform1f(C,B);c.h.m.uniform2f(k,c.h.m.canvas.width,c.h.m.canvas.height);c.h.m.uniform4f(F,c.s.v.H,c.s.v.F,c.s.v.M,c.s.v.J);c.h.m.uniform1i(b,0);c.h.m.uniform1f(A,c.g.speed);c.h.m.uniform2f(y,c.track.offset.x,c.track.offset.y);c.h.m.drawArrays(c.h.m.TRIANGLES,0,3)}};const e=d("\n  vec4 avgS(vec2 uv, float xd, float yd) {\n    const float samples = 6.;\n    vec4 r = vec4(0.);\n\n    for (float i = 0.; i < (samples * 2.); i++) {\n      float baseOffset = mod(i, samples) - (samples / 2.);\n      float xOffset = (baseOffset / (samples / 2.)) * (1. - step(samples, i));\n      float yOffset = (baseOffset / (samples / 2.)) * step(samples, i);\n      vec2 sampleUv = uv + vec2(xOffset * xd, yOffset * yd);\n\n      r += texture(a, sampleUv);\n    }\n\n    return r / (samples * 2.);\n  }\n","\n  const float size = 6.;\n  float sDistX = 1. / b.x;\n  float sDistY = 1. / b.y;\n\n  vec4 baseSample = texture(a, uv);\n  vec4 glowSample = avgS(uv, sDistX * 10., sDistY * 10.);\n  glowSample += avgS(uv, sDistX * 6., sDistY * 6.);\n  glowSample += avgS(uv, sDistX * 4., sDistY * 4.);\n  glowSample += avgS(uv, sDistX * 2., sDistY * 2.);\n  glowSample /= (4. - (d.b * 1.5));\n  glowSample = clamp(glowSample - smoothstep(.2, 0.4, baseSample), 0., 1.);\n  outColor = baseSample += glowSample;\n"),h=d("","\n  vec4 baseSample = texture(a, uv);\n  vec2 offset = (e * .5);\n  vec2 c = vec2(.5, .5) + offset;\n  float sizeMod = f * 0.4 + (d.g * 0.2);\n  float cDist = 1. - smoothstep(0., 1. + sizeMod, distance(uv, c));\n  vec4 xSample = texture(a, uv - ((uv - c) * (cDist * .01)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .02)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .03)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .05)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .06)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .07)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .08)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .10)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .12)));\n  xSample *= 0.25;\n\n  vec3 shadowSample = ((xSample.rgb * cDist) * .7);\n  vec4 color = vec4(cDist + .2, cDist + .2, cDist + .7, 1.) * 0.6;\n  color.rgb -= (shadowSample * 0.6);\n  color.rgb *= vec3(1., .8, .7);\n  color.rgb *= (cDist * cDist * 1.2) + 0.4;\n  outColor = mix(color, baseSample, baseSample.a);\n  outColor += vec4(vec3(pow(cDist, 40.) * 0.2), 0.);\n");d=d("","\n  vec4 baseSample = texture(a, uv);\n  vec2 offset = (e * .5);\n  vec2 c = vec2(.5, .5) + offset;\n  float cDist = 1. - smoothstep(0., 1., distance(uv, c));\n\n  vec3 solarColor = vec3(\n    smoothstep(.1, .7, baseSample.r),\n    smoothstep(.1, .5, baseSample.g),\n    smoothstep(.2, .9, baseSample.b)\n  );\n\n  outColor = vec4(mix(vec3(\n      smoothstep(cos(f * 5.) * 0.1, 1. - (f * .1), baseSample.r),\n      smoothstep(sin(f * 14.) * 0.2, .7 + (f * .4), baseSample.g),\n      smoothstep(sin(f * 28.) * 0.3, 1. - (f * .3), baseSample.b)\n    ), solarColor, 0.1),\n    1.\n  );\n");return{ba:e,u:h,ca:d}};function xa(c){const d={offset:{x:0,y:0}};var e=5E3,h={x:0,y:0},a=0,f=0;d.update=m=>{var b=e/1E4;if(1<=b){var k=.1*c.g.speed;h={...d.offset};b=-.1-k;a=Math.random()*(.1+k-b)+b;f=Math.random()*(.2+k-k)+k;e=0}else 1>b&&(k=h.x,d.offset.x=k+(a-k)*Math.sin(Math.PI*b),k=h.y,d.offset.y=k+(f-k)*Math.sin(Math.PI*b));e+=m*c.g.speed};return d};function ya(c){const d={l:[25*Math.random()+5,25*Math.random()+5,25*Math.random()+5],values:[T(),T(),T()],reset:()=>{d.l=[25*Math.random()+5,25*Math.random()+5,25*Math.random()+5];d.values=[T(),T(),T()]},update:e=>{for(var h=0;3>h;h++){var a=.6<d.l[h];d.l[h]-=e*c.g.speed*.012*c.j.o;var f=.6>=d.l[h];a&&f&&c.g.G===h-1&&c.g.da(d.values[h]);0>d.l[h]&&(d.l[h]=20*Math.random()+10,d.values[h]=T())}}};return d};function za(c){function d(m,b){function k(){const q=.5*f.sampleRate,x=f.createBuffer(2,q,f.sampleRate);for(let z=0;z<x.numberOfChannels;z++){const I=x.getChannelData(z);for(let L=0;L<q;L++)I[L]=(2*Math.random()-1)*Math.pow(1-L/q,3)}return x}var C=m+b;const F=[261.63,293.66,329.63,349.23,392,440,493.88,554.37,659.26,739.99,830.61,987.77];if(12<C)for(m=0;m<b;m++){var y=F[Math.max(11-m,0)];C=f.createOscillator();var A=f.createOscillator();C.type="triangle";A.type="triangle";C.frequency.setValueAtTime(y,f.currentTime+.04*m);A.frequency.setValueAtTime(.99*y,f.currentTime+.04*m);y=f.createGain();y.gain.setValueAtTime(.1*(1-.15*m),f.currentTime+.04*m);y.gain.exponentialRampToValueAtTime(.2,f.currentTime+.04*m+.2);var B=f.createBiquadFilter();B.type="lowpass";B.frequency.setValueAtTime(1500,f.currentTime);var G=f.createConvolver();G.buffer=k();C.connect(y);A.connect(y);y.connect(B);B.connect(G);G.connect(f.destination);C.start(f.currentTime+.04*m);A.start(f.currentTime+.04*m);C.stop(f.currentTime+.04*m+.2);A.stop(f.currentTime+.04*m+.2)}else for(b=m;b<C;b++){B=F[b%F.length];A=f.createOscillator();y=f.createOscillator();A.type="triangle";y.type="triangle";A.frequency.setValueAtTime(B,f.currentTime+.04*(b-m));y.frequency.setValueAtTime(.99*B,f.currentTime+.04*(b-m));B=f.createGain();B.gain.setValueAtTime(.1*(1-.15*(b-m)),f.currentTime+.04*(b-m));B.gain.exponentialRampToValueAtTime(.2,f.currentTime+.04*(b-m)+.2);G=f.createBiquadFilter();G.type="lowpass";G.frequency.setValueAtTime(1500,f.currentTime);const q=f.createConvolver();q.buffer=k();A.connect(B);y.connect(B);B.connect(G);G.connect(q);q.connect(f.destination);A.start(f.currentTime+.04*(b-m));y.start(f.currentTime+.04*(b-m));A.stop(f.currentTime+.04*(b-m)+.2);y.stop(f.currentTime+.04*(b-m)+.2)}}const e={G:0,level:2,N:0,speed:.2,position:{x:0,y:0,z:0},P:{x:0,y:0,z:0}};var h=0,a=0;e.update=m=>{a+=.02*m*e.speed;e.N+=m/50*(.3*e.G-e.N);e.position.x+=m/100*(e.N-e.position.x);e.P.x=.01*Math.cos(.1*a);e.P.y=.02*-Math.sin(.05*a);e.speed+=m/50*(e.level/12-e.speed)*.1;h+=m*c.j.o;2E3<h&&(h=0,e.level=Math.max(2,e.level-1))};const f=new (window.AudioContext||window.webkitAudioContext);e.da=m=>{const b=e.level+m;d(e.level,m);12<b?e.level-=m:e.level=b;h=0};return e};function Aa(c){const d={K:90,I:!1,finished:!1,O:5,start:()=>{c.B.reset();c.C.reset();c.g.level=5;d.K=90;d.I=!0;d.finished=!1},update:e=>{if(!d.I||d.finished)0<c.j.o&&(c.j.o=Math.max(0,c.j.o-5E-4*e),c.g.level*=.9);else{1>c.j.o&&(c.j.o=Math.min(1,c.j.o+5E-4*e));d.K-=e/1E3;0>d.K&&(d.K=0,d.finished=!0,d.I=!1);d.O=5;for(var h of c.B.l)0>h&&--d.O}}};return d};function Ba(c){const d=document.querySelector("#intro"),e=document.querySelector("#ui"),h=document.querySelector("#speed"),a=document.querySelector("#place .h"),f=document.querySelector("#time .h"),m=document.querySelector("#outro"),b=document.querySelector("#op"),k=document.querySelector("#ot"),C=document.querySelector("#minimap"),F=(q,x,...z)=>{const I=document.createElement("div");I.id=x;q.appendChild(I);for(var L of z)I.classList.add(L);return I},y=(q,x,z)=>{q.classList.remove(x);q.classList.add(z)},A=Array.from({length:13},(q,x)=>F(h,`l${x}`,"l"));A[12].textContent="13";const B=Array.from({length:4},(q,x)=>F(C,`p${x}`,"p"));var G=0;return{update:()=>{if(c.g.level!==G){G=c.g.level;for(var q=0;13>q;q++){const x=q<c.g.level;y(A[q],x?"o":"x",x?"x":"o")}}if(!c.race.I&&c.race.finished){m.style.opacity=1;q=[];switch(c.race.O){case 1:q.push("1st");q.push("You did it! Absolute legend! But can you do it again?");break;case 2:q.push("2nd");q.push("Awesome, almost there! Next time, surely.");break;case 3:q.push("3rd");q.push("Nice work! It's a placement. By a hair.");break;case 4:case 5:case 6:q.push(c.race.O+"th"),q.push("Could be worse, but not by a lot. Go again!")}b.textContent=q[0];k.textContent=q[1]}else m.style.opacity=0;B.forEach((x,z)=>{x.style.top=Math.max(-18,Math.min(18,-.2*c.B.l[z]))-1+"vh"});a.textContent=c.race.O;f.textContent=Math.floor(c.race.K);e.style.opacity=1<=c.j.o?1:0;d.style.opacity=c.race.I||c.race.finished?0:1}}};function Ca(c){const d=[1,3,5,7],e=[.67,.75,.82,.88],h={l:[...d],U:[...e],reset:()=>{h.l=[...d];h.U=[...e]},update:a=>{h.ea=5;for(var f=0;4>f;f++)h.l[f]+=(a/100*h.U[f]-a/100*c.g.speed)*c.j.o,.2>h.l[f]&&--h.ea}};return h};(function(){function c(){const f=Math.min(performance.now()-a,20);a=performance.now();d.g.update(f);d.h.ga(f);d.B.update(f);d.$.update(f);d.track.update(f);d.ia.update(f);d.C.update(f);d.s.fa(f);d.race.update(f);requestAnimationFrame(c)}const d={canvas:document.getElementById("glcanvas"),ka:0,v:{M:0,J:0,H:0,F:0}};d.h=oa(d);d.s=ra(d);d.$=pa(d);d.g=za(d);d.track=xa(d);d.j=va(d);d.S=wa(d);d.C=ya(d);d.controls=qa(d);d.B=Ca(d);d.ia=Ba(d);d.race=Aa(d);for(var e=0;200>e;e++)d.j.W();for(var h of[-.3,0,.3])for(e=-4;20>e;e+=.27)d.j.Z(h,e);h=(f=-1)=>{d.j.L(0,.55,.12,.02,.03,f);d.j.L(0,.6,.01,.1,.2,f);d.j.L(0,.52,.04,.03,.08,f);d.j.L(-.04,.6,.04,.01,.23,f);d.j.L(.04,.6,.04,.01,.23,f)};h();for(e=0;4>e;e++)h(e);for(let f of[-1,0,1])for(let m of[1,2,3,4,5])d.j.X(f,m);d.h.Y(d.j.ha);d.h.R(d.S.ba);d.h.R(d.S.u);d.h.R(d.S.ca);var a=performance.now();c();document.getElementById("glcanvas").addEventListener("click",d.s.T)})();</script></body></html>