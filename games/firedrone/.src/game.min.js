!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i(1);var s=i(2),n=(i(3),i(4),i(5)),o=i(6);var a=function(t,e){this.type="bonus",this.state={id:e.id,type:e.type,position:e.pos,radius:48,life:0,color:d(["#347E2F","#5BA459","#C93F21","#81C284"])[0]},this.update=function(){if(1==gamePad.rain&&t.state.entities.drone.state.inventory>=50){for(var e=0;e<10;e++)i=void 0,s=void 0,n=void 0,o=void 0,a=void 0,i=t.constants.width,s=t.constants.height,n=Math.random()*i-10,o=Math.random()*s-10,a=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,25),t.state.entities["mushroom__"+n+o+a]=new c(t,{name:"mushroom",pos:{x:n,y:o},id:"mushroom__"+n+o+a});t.state.entities.drone.state.inventory-=50}var i,s,n,o,a;if(1==gamePad.boost&&t.state.entities.drone.state.inventory>=50){for(var r in t.state.entities)"mushroom"==t.state.entities[r].type&&t.state.entities[r].state.radius<50&&(t.state.entities[r].state.radius*=1.25);t.state.entities.drone.state.inventory-=50}if(1==gamePad.explode&&t.state.entities.drone.state.inventory>=50){for(var r in t.state.entities)"mushroom"==t.state.entities[r].type&&t.state.entities[r].state.radius<50&&(t.state.entities.drone.state.position=t.state.entities[r].state.position,t.state.entities[r].update());t.state.entities.drone.state.inventory-=50}gamePad.rain=!1,gamePad.explode=!1,gamePad.boost=!1},this.render=function(){}},r=function(t,e){this.name=e.name||Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),this.type="drone",this.state={inventory:100,position:e.pos,radius:16,color:"rgb("+[Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random())].join()+")",vel:{x:10,y:10}},this.update=function(){(s.isPressed.left||window.joyStick.left())&&(this.state.position.x-=this.state.vel.x,this.state.orientation="left"),(s.isPressed.right||window.joyStick.right())&&(this.state.position.x+=this.state.vel.x,this.state.orientation="right"),(s.isPressed.up||window.joyStick.up())&&(this.state.position.y-=this.state.vel.y,this.state.orientation="up"),(s.isPressed.down||window.joyStick.down())&&(this.state.position.y+=this.state.vel.y,this.state.orientation="down"),this.state.position.x=this.state.position.x.boundary(this.state.radius,t.constants.width-this.state.radius),this.state.position.y=this.state.position.y.boundary(this.state.radius,t.constants.height-this.state.radius)},this.render=function(){var e=function(e){e.radius=e.radius/1.5,t.context.save(),t.context.translate(e.pos.x,e.pos.y),t.context.rotate(360*Math.random()*(Math.PI/180)),t.context.translate(-e.pos.x,-e.pos.y),t.context.beginPath(),t.context.arc(e.pos.x,e.pos.y,e.radius/8,0,2*Math.PI),t.context.lineWidth=1,t.context.strokeStyle="#fff",t.context.fillStyle=e.color,t.context.fill(),t.context.stroke(),t.context.beginPath(),t.context.arc(e.pos.x+e.radius/2,e.pos.y,e.radius/4,0,2*Math.PI),t.context.lineWidth=1,t.context.strokeStyle="#fff",t.context.fillStyle=e.color,t.context.fill(),t.context.stroke(),t.context.beginPath(),t.context.arc(e.pos.x-e.radius/2,e.pos.y,e.radius/4,0,2*Math.PI),t.context.lineWidth=1,t.context.strokeStyle="#fff",t.context.fillStyle=e.color,t.context.fill(),t.context.stroke(),t.context.restore()};t.context.beginPath();var i=this.state.position.x-1.5*this.state.radius,s=this.state.position.y-1.5*this.state.radius;t.context.arc(i,s,this.state.radius,0,2*Math.PI),t.context.lineWidth=5,t.context.strokeStyle="#fff",t.context.stroke(),e({pos:{x:i,y:s},radius:this.state.radius,color:this.state.color}),t.context.beginPath();i=this.state.position.x-1.5*this.state.radius,s=this.state.position.y+1.5*this.state.radius;t.context.arc(i,s,this.state.radius,0,2*Math.PI),t.context.lineWidth=5,t.context.strokeStyle="#fff",t.context.stroke(),e({pos:{x:i,y:s},radius:this.state.radius,color:this.state.color}),t.context.beginPath();i=this.state.position.x+1.5*this.state.radius,s=this.state.position.y-1.5*this.state.radius;t.context.arc(i,s,this.state.radius,0,2*Math.PI),t.context.lineWidth=5,t.context.strokeStyle="#fff",t.context.stroke(),e({pos:{x:i,y:s},radius:this.state.radius,color:this.state.color}),t.context.beginPath();i=this.state.position.x+1.5*this.state.radius,s=this.state.position.y+1.5*this.state.radius;t.context.arc(i,s,this.state.radius,0,2*Math.PI),t.context.lineWidth=5,t.context.strokeStyle="#fff",t.context.stroke(),e({pos:{x:i,y:s},radius:this.state.radius,color:this.state.color}),t.context.save(),t.context.beginPath(),t.context.arc(this.state.position.x,this.state.position.y,this.state.radius,0,2*Math.PI),t.context.lineWidth=5,t.context.strokeStyle="#fff",t.context.fillStyle=this.state.color,t.context.fill(),t.context.stroke(),t.context.restore()}},h=function(t,e,i,s,n,o){this.type="debris",this.state={id:s,radius:o||5+20*Math.random(),life:50*Math.random(),color:n,position:{x:e,y:i}},this.render=function(){t.context.beginPath(),t.context.arc(this.state.position.x,this.state.position.y,this.state.radius,0,2*Math.PI),t.context.fillStyle=this.state.color,t.context.fill()},this.update=function(){this.state.life--,this.state.radius-=.1,this.state.position.x+=10*(Math.random()-.5),this.state.position.y+=10*(Math.random()-.5),(this.state.life<0||this.state.radius<0)&&delete t.state.entities[this.state.id]}},c=function(t,e){this.type="mushroom",this.state={id:e.id,position:e.pos,radius:3,life:0,color:d(["#347E2F","#5BA459","#C93F21","#81C284"])[0]},this.state.maxRad=10*this.state.radius,zzfx.z(926,{frequency:60}),this.update=function(){if(this.state.position.x+=Math.random()-.5,this.state.position.y+=Math.random()-.5,this.state.radius<this.state.maxRad)this.state.radius+=.025;else{for(var e=0;e<2;e++)for(var i=0;i<2;i++){var s=function(){return Math.random()>.5?1:-1};t.state.entities["debris__"+this.state.id+e+i]=new h(t,this.state.position.x+e*Math.random()*20*s(),this.state.position.y+i*Math.random()*20*s(),"debris__"+this.state.id+e+i,"rgba(255,255,255, "+Math.random()+")",5)}!0==(n=this.state.id,o="drone",a=t.state.entities[n].state.position.x-t.state.entities[o].state.position.x,r=t.state.entities[n].state.position.y-t.state.entities[o].state.position.y,c=a*a+r*r,(u=t.state.entities[n].state.radius+t.state.entities[o].state.radius)*u>=c)&&(zzfx.z(56514),t.state.entities.drone.state.inventory+=Math.round(this.state.radius/5),delete t.state.entities[this.state.id])}var n,o,a,r,c,u},this.render=function(){t.context.beginPath(),t.context.arc(this.state.position.x,this.state.position.y,this.state.radius,0,2*Math.PI),t.context.fillStyle=this.state.color,t.context.fill()}},u=function(t){return this.type="hub",this.score=0,this.treasure=[],this.update=function(){},this.render=function(){t.context.save(),t.context.font="14px Arial",t.context.fillStyle="#ff0",t.context.fillText("inventory: "+t.state.entities.drone.state.inventory,16,50),t.context.fillText("green: __ ",35,75),t.context.beginPath(),t.context.arc(16,70,10,0,2*Math.PI),t.context.fillStyle="#81C284",t.context.fill(),t.context.fillStyle="#ff0",t.context.fillText("red:   __ ",35,100),t.context.beginPath(),t.context.arc(16,95,10,0,2*Math.PI),t.context.fillStyle="#C93F21",t.context.fill(),t.context.restore()},this};function d(t){for(var e,i,s=t.length;0!==s;)i=Math.floor(Math.random()*s),e=t[s-=1],t[s]=t[i],t[i]=e;return t}window.promoted=!1,document.monetization&&document.monetization.addEventListener("monetizationstart",function(){window.promoted=!0});var l,p,f,y="undefined"!=typeof AudioContext?new AudioContext:new webkitAudioContext,m=y.currentTime;l=new o.Sequence(y,132,["_  e","G4 e","G5 e","G4 e","D5 e","C5 e","B4 e","C5 e","_  e","G4 e","D5 e","E5 e","D5 e","C5 e","B4 e","A4 e","_  e","G4 e","G5 e","G4 e","D5 e","C5 e","B4 e","C5 e","_  e","G4 e","D5 e","E5 e","D5 e","B4 e","A4 e","G4 e"]),p=new o.Sequence(y,132,["C2  e","C2  e","C2  e","C2  e","C2  e","C2  e","C2  e","G2  e","G2  e","G2  e","G2  e","G2  e","G2  e","G2  e","G2  e","E2  e","E2  e","E2  e","E2  e","E2  e","E2  e","E2  e","E2  e","G2  e","G2  e","G2  e","G2  e","D2  e","D2  e","D2  e","D2  e","C2  e"]),f=new o.Sequence(y,132,["G3 3.5","G3 4","G3 4","G3 4","G3 0.5"]),l.staccato=.55,p.staccato=.55,f.staccato=.05,f.smoothing=.4,l.gain.gain.value=.2,p.gain.gain.value=.08,f.gain.gain.value=.065,l.mid.frequency.value=800,l.mid.gain.value=3,p.mid.frequency.value=1200,f.mid.gain.value=3,f.bass.gain.value=6,f.bass.frequency.value=80,f.mid.gain.value=-6,f.mid.frequency.value=500,f.treble.gain.value=-2,f.treble.frequency.value=1400,m=y.currentTime,l.play(m+60/132*20),p.play(m),f.play(m+60/132*28),window.game=new class extends cg.game{init(){super.init();var t=this,e=this.constants.width,i=this.constants.height;t.state.entities.randomforest={update:function(){var s=Math.random()*e-10,n=Math.random()*i-10;if(!(Math.random()<.99)){var o=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,25);t.state.entities["mushroom__"+s+n+o]=new c(t,{name:"mushroom",pos:{x:s,y:n},id:"mushroom__"+s+n+o})}},render:function(){}},t.state.entities.loader=new function(){return this.type="loader",this.state={position:{x:0,y:0}},this.update=function(){if(this.state.position.x+=Math.random()-.5,this.state.position.y+=Math.random()-.5,!window.loadtimer||Date.now()-window.loadtimer>8e3){if(!window.loadtimer)return window.loadtimer=Date.now();t.state.entities.drone=new r(t,{name:"f-18",pos:{x:e/2,y:i/2}}),t.state.entities.hub=new u(t),t.state.entities.powerups=new a(t,{name:"jackpot",pos:{x:e-85,y:i-85},id:"powerups"}),window.joyStick=new n({stationaryBase:!0,baseX:65,baseY:window.innerHeight-90,limitStickTravel:!0,stickRadius:50,strokeStyle:"#546e7a",mouseSupport:!0}),window.joyStick.addEventListener("touchStartValidation",function(t){var e=t.changedTouches[0];return e.pageX<=window.innerWidth/2&&e.pageY>=window.innerHeight/2}),window.gamePad={},document.querySelector("body").insertAdjacentHTML("beforeend",'<style> .fab {width: 56px;height: 56px;background: #546e7a;border-radius: 50%;box-shadow: 0 0 4px rgba(0, 0, 0, 0.14), 0 4px 8px rgba(0, 0, 0, 0.28);color: #fff;display: flex;justify-content: center;align-items: center;cursor: pointer; position: fixed;bottom: 0;right: 0;margin: 25px;-webkit-tap-highlight-color: transparent;-webkit-backface-visibility: hidden;backface-visibility: hidden;overflow: hidden;}.fab.active {background: #faab1a;}.fab__ripple {position: absolute;left: -17px;bottom: -12px;width: 56px;height: 56px;-webkit-transform: scale(0.5);transform: scale(0.5);background: #fff;border-radius: 50%;-webkit-transform-origin: 50%;transform-origin: 50%;transition: -webkit-transform 0.35s cubic-bezier(0, 0, 0.3, 1) 0ms;transition: transform 0.35s cubic-bezier(0, 0, 0.3, 1) 0ms;transition: transform 0.35s cubic-bezier(0, 0, 0.3, 1) 0ms, -webkit-transform 0.35s cubic-bezier(0, 0, 0.3, 1) 0ms;-webkit-backface-visibility: hidden;backface-visibility: hidden;will-change: transform;z-index: 2;opacity: 0;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}.fab:active .fab__ripple {opacity: 0.2;-webkit-transform: scale(1) translate(31%, -22%);transform: scale(1) translate(31%, -22%);}.fab__image {overflow: hidden;z-index: 3;}</style><div onClick="window.gamePad.boost=true" style="margin-right:16px; margin-bottom:195px" class="fab button__rain"><div class="fab__ripple"></div>X2</div><div onClick="window.gamePad.explode=true" style="margin-right:16px; margin-bottom:65px" class="fab button__rain"><div class="fab__ripple"></div>💣</div><div onClick="window.gamePad.rain=true" style="margin-right:16px; margin-bottom:130px" class="fab button__rain"><div class="fab__ripple"></div>💧</div>'),delete t.state.entities.loader}},this.render=function(){if(Date.now()-window.loadtimer>3e3)return t.context.save(),t.context.font="64px Arial",t.context.fillText("🚁",e/4+10+this.state.position.x,i/2+this.state.position.y,e),t.context.font="32px Arial",t.context.fillText("f-18️",e/4+65,i/2,e),t.context.font="16px Arial",t.context.fillText("🔥 fire drone 💥",e/4+10,i/2+25,e),t.context.font="14px Arial",t.context.fillText("use touch buttons or direction keys",e/4+10,i/2+50,e),t.context.font="12px Arial",t.context.fillText("https://github.com/swashvirus/firedrone️",16,i-16,e),void t.context.restore();t.context.save(),t.context.font="64px Arial",t.context.fillText("☄️",e/4+10+this.state.position.x,i/2+this.state.position.y,e),t.context.font="32px Arial",t.context.fillText("Craters.js️",e/4+65,i/2,e),t.context.font="16px Arial",t.context.fillText("loading...",e/4+10,i/2+25,e),t.context.font="12px Arial",t.context.fillText("https://github.com/swashvirus/️",16,i-16,i),t.context.restore()},this}}}("#container",window.innerWidth,window.innerHeight,60,!0)},function(t,e){!function(t){"use strict";t.cg={version:"1.0.1"},cg.game=class{constructor(t,e,i,s,n){this.container=t,this.constants={width:e,height:i,frames:s,debug:n},this.state={entities:{}},this.init()}init(){this.viewport=class{static getPixelRatio(e){console.log("Determining pixel ratio.");var i=t.devicePixelRatio,s=["webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio"].reduce(function(t,i){return e.hasOwnProperty(i)?e[i]:1});return i/s}static generateCanvas(t,e){console.log("Generating canvas.");var i=document.createElement("canvas"),s=i.getContext("2d"),n=this.getPixelRatio(s);return i.width=Math.round(t*n),i.height=Math.round(e*n),i.style.width=t+"px",i.style.height=e+"px",s.setTransform(n,0,0,n,0,0),i}}.generateCanvas(this.constants.width,this.constants.height),this.viewport.id="gameViewport",this.context=this.viewport.getContext("2d"),this.container=document.querySelector(this.container),this.container.insertBefore(this.viewport,this.container.firstChild),this.update=new e(this),this.render=new i(this),this.loop=new s(this)}},cg.entity=class{constructor(){this.state={position:{x:0,y:0}}}update(){}render(){}},cg.class=class{constructor(){this.init()}init(){}update(){}render(){}};class e{constructor(t){return this.update(t)}update(t){return function(e){var i=t.state||{};if(i.hasOwnProperty("entities")){var s=i.entities;for(var n in s)s[n].update()}return i}}}class i{constructor(t){return this.render(t)}render(t){var e=t.constants.width,i=t.constants.height;return function(){if(t.context.clearRect(0,0,e,i),t.constants.debug&&(t.context.fillStyle="#ff0",t.context.fillText("fps : "+t.loop.fps,e-100,50)),t.state.hasOwnProperty("entities")){var s=t.state.entities;for(var n in s)"drone"!=n&&s[n].render();s.drone&&s.drone.render()}}}}class s{constructor(t){return this.loop(t)}loop(e){var i={},s=e.constants.frames,n=1e3/s,o=t.performance.now(),a={new:{frameCount:0,startTime:o,sinceStart:0},old:{frameCount:0,startTime:o,sineStart:0}},r="new";return i.fps=0,i.main=function(h){i.stopLoop=t.requestAnimationFrame(i.main);var c,u,d=h,l=d-o;if(l>n){for(var p in o=d-l%n,a)++a[p].frameCount,a[p].sinceStart=d-a[p].startTime;c=a[r],i.fps=Math.round(1e3/(c.sinceStart/c.frameCount)*100)/100,u=a.new.frameCount===a.old.frameCount?5*s:10*s,c.frameCount>u&&(a[r].frameCount=0,a[r].startTime=d,a[r].sinceStart=0,r="new"===r?"old":"new"),e.state=e.update(d),e.render()}},i.main(),i}}}(window)},function(t,e){t.exports=function(){var t,e,i,s;return this.isPressed={},document.onkeydown=function(n){39===n.keyCode&&(e=!0),37===n.keyCode&&(t=!0),38===n.keyCode&&(i=!0),40===n.keyCode&&(s=!0)},document.onkeyup=function(n){39===n.keyCode&&(e=!1),37===n.keyCode&&(t=!1),38===n.keyCode&&(i=!1),40===n.keyCode&&(s=!1)},Object.defineProperty(this.isPressed,"left",{get:function(){return t},configurable:!0,enumerable:!0}),Object.defineProperty(this.isPressed,"right",{get:function(){return e},configurable:!0,enumerable:!0}),Object.defineProperty(this.isPressed,"up",{get:function(){return i},configurable:!0,enumerable:!0}),Object.defineProperty(this.isPressed,"down",{get:function(){return s},configurable:!0,enumerable:!0}),this}()},function(t,e){t.exports=function(){return this.sounds={},this.instances=[],this.default_volume=1,this.load=function(t,e,i){if(this.sounds[t]=new Audio(e),"function"!=typeof i)return new Promise((e,i)=>{this.sounds[t].addEventListener("canplaythrough",e),this.sounds[t].addEventListener("error",i)});this.sounds[t].addEventListener("canplaythrough",i)},this.remove=function(t){void 0!==this.sounds&&delete this.sounds[t]},this.play=function(t,e,i,s){if(s=s||!1,void 0===this.sounds[t])return console.error("Can't find sound called '"+t+"'."),!1;var n=this.sounds[t].cloneNode(!0);return n.volume="number"==typeof i?i:this.default_volume,n.loop=s,n.play(),this.instances.push(n),n.addEventListener("ended",()=>{var t=this.instances.indexOf(n);-1!=t&&this.instances.splice(t,1)}),"function"==typeof e?(n.addEventListener("ended",e),!0):new Promise((t,e)=>n.addEventListener("ended",t))},this.stop_all=function(){var t=this.instances.slice();for(var e of t)e.pause(),e.dispatchEvent(new Event("ended"))},this}},function(t,e){var i=function(t,e){return Math.min(Math.max(this,t),e)};Number.prototype.boundary=i,t.exports=i},function(t,e){var i,s=function(t){t=t||{},this._container=t.container||document.body,this._strokeStyle=t.strokeStyle||"cyan",this._stickEl=t.stickElement||this._buildJoystickStick(),this._baseEl=t.baseElement||this._buildJoystickBase(),this._mouseSupport=void 0!==t.mouseSupport&&t.mouseSupport,this._stationaryBase=t.stationaryBase||!1,this._baseX=this._stickX=t.baseX||0,this._baseY=this._stickY=t.baseY||0,this._limitStickTravel=t.limitStickTravel||!1,this._stickRadius=void 0!==t.stickRadius?t.stickRadius:100,this._useCssTransform=void 0!==t.useCssTransform&&t.useCssTransform,this._container.style.position="relative",this._container.appendChild(this._baseEl),this._baseEl.style.position="absolute",this._baseEl.style.display="none",this._container.appendChild(this._stickEl),this._stickEl.style.position="absolute",this._stickEl.style.display="none",this._pressed=!1,this._touchIdx=null,!0===this._stationaryBase&&(this._baseEl.style.display="",this._baseEl.style.left=this._baseX-this._baseEl.width/2+"px",this._baseEl.style.top=this._baseY-this._baseEl.height/2+"px"),this._transform=!!this._useCssTransform&&this._getTransformProperty(),this._has3d=this._check3D();var e=function(t,e){return function(){return t.apply(e,arguments)}};this._$onTouchStart=e(this._onTouchStart,this),this._$onTouchEnd=e(this._onTouchEnd,this),this._$onTouchMove=e(this._onTouchMove,this),this._container.addEventListener("touchstart",this._$onTouchStart,!1),this._container.addEventListener("touchend",this._$onTouchEnd,!1),this._container.addEventListener("touchmove",this._$onTouchMove,!1),this._mouseSupport&&(this._$onMouseDown=e(this._onMouseDown,this),this._$onMouseUp=e(this._onMouseUp,this),this._$onMouseMove=e(this._onMouseMove,this),this._container.addEventListener("mousedown",this._$onMouseDown,!1),this._container.addEventListener("mouseup",this._$onMouseUp,!1),this._container.addEventListener("mousemove",this._$onMouseMove,!1))};s.prototype.destroy=function(){this._container.removeChild(this._baseEl),this._container.removeChild(this._stickEl),this._container.removeEventListener("touchstart",this._$onTouchStart,!1),this._container.removeEventListener("touchend",this._$onTouchEnd,!1),this._container.removeEventListener("touchmove",this._$onTouchMove,!1),this._mouseSupport&&(this._container.removeEventListener("mouseup",this._$onMouseUp,!1),this._container.removeEventListener("mousedown",this._$onMouseDown,!1),this._container.removeEventListener("mousemove",this._$onMouseMove,!1))},s.touchScreenAvailable=function(){return"createTouch"in document},(i=s.prototype).addEventListener=function(t,e){return void 0===this._events&&(this._events={}),this._events[t]=this._events[t]||[],this._events[t].push(e),e},i.removeEventListener=function(t,e){void 0===this._events&&(this._events={}),t in this._events!=0&&this._events[t].splice(this._events[t].indexOf(e),1)},i.dispatchEvent=function(t){if(void 0===this._events&&(this._events={}),void 0!==this._events[t])for(var e=this._events[t].slice(),i=0;i<e.length;i++){var s=e[i].apply(this,Array.prototype.slice.call(arguments,1));if(void 0!==s)return s}},s.prototype.deltaX=function(){return this._stickX-this._baseX},s.prototype.deltaY=function(){return this._stickY-this._baseY},s.prototype.up=function(){if(!1===this._pressed)return!1;var t=this.deltaX(),e=this.deltaY();return!(e>=0)&&!(Math.abs(t)>2*Math.abs(e))},s.prototype.down=function(){if(!1===this._pressed)return!1;var t=this.deltaX(),e=this.deltaY();return!(e<=0)&&!(Math.abs(t)>2*Math.abs(e))},s.prototype.right=function(){if(!1===this._pressed)return!1;var t=this.deltaX(),e=this.deltaY();return!(t<=0)&&!(Math.abs(e)>2*Math.abs(t))},s.prototype.left=function(){if(!1===this._pressed)return!1;var t=this.deltaX(),e=this.deltaY();return!(t>=0)&&!(Math.abs(e)>2*Math.abs(t))},s.prototype._onUp=function(){this._pressed=!1,this._stickEl.style.display="none",0==this._stationaryBase&&(this._baseEl.style.display="none",this._baseX=this._baseY=0,this._stickX=this._stickY=0)},s.prototype._onDown=function(t,e){if(this._pressed=!0,0==this._stationaryBase&&(this._baseX=t,this._baseY=e,this._baseEl.style.display="",this._move(this._baseEl.style,this._baseX-this._baseEl.width/2,this._baseY-this._baseEl.height/2)),this._stickX=t,this._stickY=e,!0===this._limitStickTravel){var i=this.deltaX(),s=this.deltaY(),n=Math.sqrt(i*i+s*s);if(n>this._stickRadius){var o=i/n,a=s/n;this._stickX=o*this._stickRadius+this._baseX,this._stickY=a*this._stickRadius+this._baseY}}this._stickEl.style.display="",this._move(this._stickEl.style,this._stickX-this._stickEl.width/2,this._stickY-this._stickEl.height/2)},s.prototype._onMove=function(t,e){if(!0===this._pressed){if(this._stickX=t,this._stickY=e,!0===this._limitStickTravel){var i=this.deltaX(),s=this.deltaY(),n=Math.sqrt(i*i+s*s);if(n>this._stickRadius){var o=i/n,a=s/n;this._stickX=o*this._stickRadius+this._baseX,this._stickY=a*this._stickRadius+this._baseY}}this._move(this._stickEl.style,this._stickX-this._stickEl.width/2,this._stickY-this._stickEl.height/2)}},s.prototype._onMouseUp=function(t){return this._onUp()},s.prototype._onMouseDown=function(t){t.preventDefault();var e=t.clientX,i=t.clientY;return this._onDown(e,i)},s.prototype._onMouseMove=function(t){var e=t.clientX,i=t.clientY;return this._onMove(e,i)},s.prototype._onTouchStart=function(t){if(null===this._touchIdx&&!1!==this.dispatchEvent("touchStartValidation",t)){this.dispatchEvent("touchStart",t),t.preventDefault();var e=t.changedTouches[0];this._touchIdx=e.identifier;var i=e.pageX,s=e.pageY;return this._onDown(i,s)}},s.prototype._onTouchEnd=function(t){if(null!==this._touchIdx){this.dispatchEvent("touchEnd",t);for(var e=t.changedTouches,i=0;i<e.length&&e[i].identifier!==this._touchIdx;i++);if(i!==e.length)return this._touchIdx=null,t.preventDefault(),this._onUp()}},s.prototype._onTouchMove=function(t){if(null!==this._touchIdx){for(var e=t.changedTouches,i=0;i<e.length&&e[i].identifier!==this._touchIdx;i++);if(i!==e.length){var s=e[i];t.preventDefault();var n=s.pageX,o=s.pageY;return this._onMove(n,o)}}},s.prototype._buildJoystickBase=function(){var t=document.createElement("canvas");t.width=126,t.height=126;var e=t.getContext("2d");return e.beginPath(),e.strokeStyle=this._strokeStyle,e.lineWidth=6,e.arc(t.width/2,t.width/2,40,0,2*Math.PI,!0),e.stroke(),e.beginPath(),e.strokeStyle=this._strokeStyle,e.lineWidth=2,e.arc(t.width/2,t.width/2,60,0,2*Math.PI,!0),e.stroke(),t},s.prototype._buildJoystickStick=function(){var t=document.createElement("canvas");t.width=86,t.height=86;var e=t.getContext("2d");return e.beginPath(),e.strokeStyle=this._strokeStyle,e.lineWidth=6,e.arc(t.width/2,t.width/2,40,0,2*Math.PI,!0),e.stroke(),t},s.prototype._move=function(t,e,i){this._transform?this._has3d?t[this._transform]="translate3d("+e+"px,"+i+"px, 0)":t[this._transform]="translate("+e+"px,"+i+"px)":(t.left=e+"px",t.top=i+"px")},s.prototype._getTransformProperty=function(){for(var t,e=["webkitTransform","MozTransform","msTransform","OTransform","transform"],i=document.createElement("p"),s=0;s<e.length;s++)if(t=e[s],null!=i.style[t])return t},s.prototype._check3D=function(){var e=this._getTransformProperty();if(!e||!window.getComputedStyle)return t.exports=!1;var i=document.createElement("div");i.style[e]="translate3d(1px,1px,1px)",document.body.insertBefore(i,null);var s=getComputedStyle(i).getPropertyValue({webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"}[e]);return document.body.removeChild(i),null!=s&&s.length&&"none"!=s},t.exports=s},function(t,e,i){var s,n,o;n=[e],void 0===(o="function"==typeof(s=function(t){function e(t){var i=t.split(o);this.frequency=e.getFrequency(i[0])||0,this.duration=e.getDuration(i[1])||0}function i(t,e,i){this.ac=t||new AudioContext,this.createFxNodes(),this.tempo=e||120,this.loop=!0,this.smoothing=0,this.staccato=0,this.notes=[],this.push.apply(this,i||[])}var s=440*Math.pow(Math.pow(2,1/12),-9),n=/^[0-9.]+$/,o=/\s+/,a=/(\d+)/,r={};"B#-C|C#-Db|D|D#-Eb|E-Fb|E#-F|F#-Gb|G|G#-Ab|A|A#-Bb|B-Cb".split("|").forEach(function(t,e){t.split("-").forEach(function(t){r[t]=e})}),e.getFrequency=function(t){var e=t.split(a),i=r[e[0]],n=(e[1]||4)-4,o=s*Math.pow(Math.pow(2,1/12),i);return o*Math.pow(2,n)},e.getDuration=function(t){return n.test(t)?parseFloat(t):t.toLowerCase().split("").reduce(function(t,e){return t+("w"===e?4:"h"===e?2:"q"===e?1:"e"===e?.5:"s"===e?.25:0)},0)},i.prototype.createFxNodes=function(){var t=this.gain=this.ac.createGain();return[["bass",100],["mid",1e3],["treble",2500]].forEach(function(e,i){(i=this[e[0]]=this.ac.createBiquadFilter()).type="peaking",i.frequency.value=e[1],t.connect(t=i)}.bind(this)),t.connect(this.ac.destination),this},i.prototype.push=function(){return Array.prototype.forEach.call(arguments,function(t){this.notes.push(t instanceof e?t:new e(t))}.bind(this)),this},i.prototype.createCustomWave=function(t,e){e||(e=t),this.waveType="custom",this.customWave=[new Float32Array(t),new Float32Array(e)]},i.prototype.createOscillator=function(){return this.stop(),this.osc=this.ac.createOscillator(),this.customWave?this.osc.setPeriodicWave(this.ac.createPeriodicWave.apply(this.ac,this.customWave)):this.osc.type=this.waveType||"square",this.osc.connect(this.gain),this},i.prototype.scheduleNote=function(t,e){var i=60/this.tempo*this.notes[t].duration,s=i*(1-(this.staccato||0));return this.setFrequency(this.notes[t].frequency,e),this.smoothing&&this.notes[t].frequency&&this.slide(t,e,s),this.setFrequency(0,e+s),e+i},i.prototype.getNextNote=function(t){return this.notes[t<this.notes.length-1?t+1:0]},i.prototype.getSlideStartDelay=function(t){return t-Math.min(t,60/this.tempo*this.smoothing)},i.prototype.slide=function(t,e,i){var s=this.getNextNote(t),n=this.getSlideStartDelay(i);return this.setFrequency(this.notes[t].frequency,e+n),this.rampFrequency(s.frequency,e+i),this},i.prototype.setFrequency=function(t,e){return this.osc.frequency.setValueAtTime(t,e),this},i.prototype.rampFrequency=function(t,e){return this.osc.frequency.linearRampToValueAtTime(t,e),this},i.prototype.play=function(t){return t="number"==typeof t?t:this.ac.currentTime,this.createOscillator(),this.osc.start(t),this.notes.forEach(function(e,i){t=this.scheduleNote(i,t)}.bind(this)),this.osc.stop(t),this.osc.onended=this.loop?this.play.bind(this,t):null,this},i.prototype.stop=function(){return this.osc&&(this.osc.onended=null,this.osc.disconnect(),this.osc=null),this},t.Note=e,t.Sequence=i})?s.apply(e,n):s)||(t.exports=o)}]);