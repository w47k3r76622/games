<html><head><title>Hotel 404</title><style>canvas#img{position:absolute;visibility:hidden}div#floor{position:absolute;width:100%;height:100%;overflow:hidden}.fake-luggage{background-color:#453630;background-image:repeating-radial-gradient( circle at 0.4em 0.4em, transparent, transparent 0.03em, #9B7E4B 0.03em, #9B7E4B 0.08em, transparent 0.09em, transparent 0.45em, #9B7E4B 0.46em, #9B7E4B 0.6em);background-size:0.8em 0.8em;background-position:0.6em 0.6em}div#startScreen{position:absolute;color:#FFA400;background:#000;line-height:250px;text-align:center;vertical-align:middle;width:100%;height:100%;z-index:9}div#win{position:absolute;color:#FFF;background:#000;line-height:250px;text-align:center;vertical-align:middle;width:100%;height:100%;display:none;z-index:9}div#lose{position:absolute;color:#F00;background:#000;line-height:250px;text-align:center;vertical-align:middle;width:100%;height:100%;display:none;z-index:9}.blinking{animation:bText 1s infinite}@keyframes bText{0%{opacity:0}50%{opacity:1}100%{opacity:0}}div#ceiling{position:absolute;width:100%;height:50%;background-color:rgb(255,255,255)}div#shadow{position:absolute;width:100%;height:100%;background:linear-gradient(rgba(0,0,0,0),rgba(0,0,0,1),rgba(0,0,0,0))}div#flashlight{position:absolute;width:100%;height:100%;background:radial-gradient(transparent,black);z-index:7}canvas#ui{position:absolute;width:100%;height:100%;z-index:8}.blackout{background:rgba(0,0,0,.95) !important}#screen{position:relative;width:800px;height:600px;margin:0 auto;border:1px solid black;overflow:hidden}</style></head><body onload="init()"><div id="screen"><div id="startScreen"><h2>HOTEL 404</h2><p class="blinking">Press Space to Start</p></div><div id="floor" class="fake-luggage"></div><div id="ceiling"></div><div id="shadow"></div><div id="flashlight"></div><div id="lose"><h2>Error 404</h2><p class="blinking">Player not found...</p></div><div id="win"><h2>You have escaped!</h2></div> <canvas id="ui"></canvas></div><div id="c"> <canvas id="img" width='800px' height='600px'></canvas></div></body> <footer> <script>'use strict';let zzfx,zzfxV,zzfxX,zzfxR;zzfxV=.3;zzfx=(q=1,k=.05,c=220,e=0,t=0,u=.1,r=0,F=1,v=0,z=0,w=0,A=0,l=0,B=0,x=0,G=0,d=0,y=1,m=0,C=0)=>{let b=2*Math.PI,H=v*=500*b/zzfxR**2,I=(0<x?1:-1)*b/4,D=c*=(1+2*k*Math.random()-k)*b/zzfxR,Z=[],g=0,E=0,a=0,n=1,J=0,K=0,f=0,p,h;e=99+zzfxR*e;m*=zzfxR;t*=zzfxR;u*=zzfxR;d*=zzfxR;z*=500*b/zzfxR**3;x*=b/zzfxR;w*=b/zzfxR;A*=zzfxR;l=zzfxR*l|0;for(h=e+m+t+u+d|0;a<h;Z[a++]=f)++K%(100*G|0)||(f=r?1<r?2<r?3<r?Math.sin((g%b)**3):Math.max(Math.min(Math.tan(g),1),-1):1-(2*g/b%2+2)%2:1-4*Math.abs(Math.round(g/b)-g/b):Math.sin(g),f=(l?1-C+C*Math.sin(2*Math.PI*a/l):1)*(0<f?1:-1)*Math.abs(f)**F*q*zzfxV*(a<e?a/e:a<e+m?1-(a-e)/m*(1-y):a<e+m+t?y:a<h-d?(h-a-d)/u*y:0),f=d?f/2+(d>a?0:(a<h-d?1:(h-a)/d)*Z[a-d|0]/2):f),p=(c+=v+=z)*Math.sin(E*x-I),g+=p-p*B*(1-1E9*(Math.sin(a)+1)%2),E+=p-p*B*(1-1E9*(Math.sin(a)**2+1)%2),n&&++n>A&&(c+=w,D+=w,n=0),!l||++J%l||(c=D,v=H,n=n||1);q=zzfxX.createBuffer(1,h,zzfxR);q.getChannelData(0).set(Z);c=zzfxX.createBufferSource();c.buffer=q;c.connect(zzfxX.destination);c.start();return c};zzfxX=new(window.AudioContext||webkitAudioContext);zzfxR=44100;var map=[[1,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[2,0,0,1,1,1,1,2,1,0,0,0,1,1,2,1,1,1,1,2,1,1,0,0,0,1,2,1,1,1,1,0,0,1],[1,0,0,1,1,2,1,1,1,0,0,0,1,2,1,1,1,1,1,1,2,1,0,0,0,1,1,1,2,1,1,0,0,2],[1,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,1],[2,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1],[1,0,0,1,2,0,0,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,1,2,1,1,1,0,0,1,1,0,0,2],[1,0,0,1,1,0,0,1,1,1,2,1,1,1,0,0,1,1,0,0,1,1,1,2,1,1,1,0,0,2,1,0,0,1],[2,0,0,1,1,0,0,2,1,0,0,0,1,2,0,0,2,2,0,0,2,1,0,0,0,1,2,0,0,1,1,0,0,1],[1,0,0,2,1,0,0,1,1,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1,1,0,0,2],[1,0,0,1,1,0,0,1,2,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1,2,0,0,1],[2,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1],[1,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,2],[1,0,0,1,1,0,0,1,2,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,1,1,0,0,2,1,0,0,1],[2,0,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1,1,0,0,1,1,0,0,0,1,1,0,0,1,1,0,0,1],[1,0,0,2,1,0,0,2,1,0,0,0,1,2,0,0,2,2,0,0,2,1,0,0,0,1,2,0,0,1,1,0,0,2],[1,0,0,1,1,0,0,1,1,1,2,1,1,1,0,0,1,1,0,0,1,1,1,2,1,1,1,0,0,1,2,0,0,1],[2,0,0,1,1,0,0,1,2,1,1,1,2,1,0,0,1,1,0,0,1,2,1,1,1,2,1,0,0,1,1,0,0,1],[1,0,0,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,0,2],[1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1],[2,0,0,1,1,2,1,1,1,0,0,0,1,2,1,1,1,1,1,1,1,2,0,0,0,1,1,1,2,1,1,0,0,1],[1,0,0,1,1,1,1,2,1,0,0,0,1,1,2,1,1,1,1,1,2,1,0,0,0,1,2,1,1,1,1,0,0,2],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,2,1,1,1]];var generateImage=()=>{var c=$("img");c.width=64*2;c.height=64*3;var tc=c.getContext("2d");tc.beginPath();tc.fillStyle="#D4E6B5";tc.rect(0,0,64,64*3);tc.fill();tc.beginPath();tc.fillStyle="#AFC97E";tc.rect(64,0,64*2,64*3);tc.fill();for(var i=0;i<=64*3;i+=8) {tc.beginPath();tc.strokeStyle="#585123";tc.moveTo(0,i);tc.lineTo(64*2,i);tc.stroke();} tc.beginPath();tc.fillStyle="#431B0F";tc.rect(12,64+8,64-24,64-8);tc.fill();tc.beginPath();tc.rect(64+12,64+8,64-24,64-8);tc.fill();tc.beginPath();tc.rect(12,(64*2)+8,64-24,64-8);tc.fill();tc.beginPath();tc.rect(64+12,(64*2)+8,64-24,64-8);tc.fill();tc.fillStyle="#FFA400";tc.font="8px Arial";tc.fillText("404",90,84);tc.fillText("200",90,148);tc.scale(-1,1);tc.fillText("404",-38,84);tc.fillText("200",-38,148);tc.scale(-1,1);imgUrl=c.toDataURL();};var player={x:10,y:10,dir:0,rot:0,speed:0,moveSpeed:0.1,rotSpeed:6};var mapWidth=0;var mapHeight=0;var miniMapScale=8;var screenWidth=800;var screenHeight=600;var stripWidth=2;var fov=60*Math.PI/180;var numRays=Math.ceil(screenWidth/stripWidth);var fovHalf=fov/2;var viewDist=(screenWidth/2)/Math.tan((fov/2));var twoPI=Math.PI*2;var screenStrips=[];var numTextures=3;var imgUrl="";var gFlag='s';var x200=0;var y200=0;var footTimer=15;var timer=0;var drums=[2,4,2,4,2,4,2,3,4,1,2,3,4,1,2,3,4];var drumIndex=0;var $=(id)=>{return document.getElementById(id);};var dc=(tag)=>{return document.createElement(tag);};var show=(id)=>{$(id).style.display="block";};var rand=(i)=>{return Math.floor(Math.random()*i);};var refresh=()=>{location.reload();};var start=()=>{$("startScreen").style.display='none';};var off=false;var flash=100;var flicker=()=>{if(off){$("flashlight").classList.remove("blackout");off=false;} if(Math.ceil(Math.random()*flash)<=2){$("flashlight").classList.add("blackout");playSound("flashlight");off=true;if(flash>1){flash--;} if(flash==1){show("lose");gFlag='e';}}};var fCounter=()=>{var c=$('ui');var f=c.getContext('2d');f.clearRect(0,0,c.width,c.height);f.beginPath();f.fillStyle='#0F0';f.rect(5,5,30-Math.floor((100-flash)*3/10),10);f.fill();f.strokeStyle='#FFF';f.fillStyle='#FFF';f.beginPath();f.rect(5,5,30,10);f.stroke();f.beginPath();f.rect(35,8,3,3);f.stroke();f.fill();f.beginPath();f.font="8px Arial";f.fillText(flash+'%',10,13);};var s={flashlight:[1,.05,521,0,.21,.09,2,.74,0,0,-415,.01,0,.3,0,0,.14,.33,0,.15],door:[1,.05,55,.01,0,0,3,1.69,0,.7,0,0,.05,0,.6,0,.17,.25,.05,.5],};var playSound=(name)=>{var a=s[name];zzfx(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15],a[16],a[17],a[18],a[19]);};var playMusic=()=>{if(timer%16==0){zzfx(1,.05,drums[drumIndex]*25,.01,.17,.17,0,.92,0,0,0,0,0,1,0,0,.02,.61,.08,0);drumIndex++;if(drumIndex>=drums.length){drumIndex=0;}}};var castRays=()=>{var stripIndex=0;for(var i=0;i<numRays;i++){var rayScreenPos=(-numRays/2+i)*stripWidth;var rayViewDist=Math.sqrt(rayScreenPos*rayScreenPos+viewDist*viewDist);var rayAngle=Math.asin(rayScreenPos/rayViewDist);castSingleRay(player.rot+rayAngle,stripIndex++);}};var castSingleRay=(rayAngle,stripIndex)=>{rayAngle%=twoPI;if(rayAngle<0){rayAngle+=twoPI;} var right=(rayAngle>twoPI*0.75||rayAngle<twoPI*0.25);var up=(rayAngle>Math.PI);var angleSin=Math.sin(rayAngle),angleCos=Math.cos(rayAngle);var dist=0;var xHit=0,yHit=0;var textureX;var wallX;var wallY;var wallType=0;var wallIsShaded=false;var wallisHorizontal=false;var slope=angleSin/angleCos;var dX=right?1:-1;var dY=dX*slope;var x=right?Math.ceil(player.x):Math.floor(player.x);var y=player.y+(x-player.x)*slope;while(x>=0&&x<mapWidth&&y>=0&&y<mapHeight){wallX=Math.floor(x+(right?0:-1));wallY=Math.floor(y);if(map[wallY][wallX]>0){var distX=x-player.x;var distY=y-player.y;dist=distX*distX+distY*distY;wallType=map[wallY][wallX];textureX=y%1;if(!right)textureX=1-textureX;xHit=x;yHit=y;wallIsShaded=true;wallisHorizontal=true;break;} x+=dX;y+=dY;} var slope=angleCos/angleSin;var dY=up?-1:1;var dX=dY*slope;var y=up?Math.floor(player.y):Math.ceil(player.y);var x=player.x+(y-player.y)*slope;while(x>=0&&x<mapWidth&&y>=0&&y<mapHeight){var wallY=Math.floor(y+(up?-1:0));var wallX=Math.floor(x);if(map[wallY][wallX]>0){var distX=x-player.x;var distY=y-player.y;var blockDist=distX*distX+distY*distY;if(!dist||blockDist<dist){dist=blockDist;xHit=x;yHit=y;wallType=map[wallY][wallX];textureX=x%1;wallIsShaded=false;if(up)textureX=1-textureX;} break;} x+=dX;y+=dY;} if(dist){var strip=screenStrips[stripIndex];dist=Math.sqrt(dist);dist=dist*Math.cos(player.rot-rayAngle);var height=Math.round(viewDist/dist);var width=height*stripWidth;var top=Math.round((screenHeight-height)/2);strip.style.height=height+"px";strip.style.top=top+"px";strip.img.style.height=Math.floor(height*numTextures)+"px";strip.img.style.width=Math.floor(width*2)+"px";strip.img.style.top=-Math.floor(height*(wallType-1))+"px";var texX=Math.round(textureX*width);if(texX>width-stripWidth) texX=width-stripWidth;texX+=(wallIsShaded?width:0);strip.img.style.left=-texX+"px";}};var move=()=>{var moveStep=player.speed*player.moveSpeed;player.rot+=player.dir*player.rotSpeed*Math.PI/180;var newX=player.x+Math.cos(player.rot)*moveStep;var newY=player.y+Math.sin(player.rot)*moveStep;if(isBlocking(newX,newY)){return;}else{player.x=newX;player.y=newY;}};var isBlocking=(x,y)=>{if(y<0||y>=mapHeight||x<0||x>=mapWidth){return true;} return(map[Math.floor(y)][Math.floor(x)]!==0);};var clearKeys=()=>{document.onkeydown=null;document.onkeyup=null;};var bindKeys=()=>{clearKeys();document.onkeydown=(e)=>{e=e||window.event;if(gFlag=='s'){if(e.keyCode==32){gFlag='i';}} else if(gFlag=='i'){switch(e.keyCode){case 38:case 87:player.speed=1;break;case 40:case 83:player.speed=-1;break;case 37:case 65:player.dir=-1;break;case 39:case 68:player.dir=1;break;case 32:doorCheck();break;}} else if(gFlag=='e'){if(e.keyCode==32){refresh();}}};document.onkeyup=(e)=>{e=e||window.event;switch(e.keyCode){case 38:case 87:case 83:case 40:player.speed=0;break;case 37:case 65:case 68:case 39:player.dir=0;break;}}};var doorCheck=()=>{var r=Math.floor(player.rot*(180/Math.PI))%360;if(r<0) r+=360;var rx=0;var ry=0;if(r>=315||r<=45){rx=1;}else if(r<315&&r>=225){ry=-1;}else if(r<225&&r>=135){rx=-1;}else if(r<135&&r>45){ry=1;} var lx=Math.floor(player.x)+rx;var ly=Math.floor(player.y)+ry;if(map[ly][lx]!=0){playSound('door');} if(map[ly][lx]==3){gFlag='e';bindKeys();show("win");}else if(map[ly][lx]==2){map[ly][lx]=1;}};var init=()=>{mapWidth=map[0].length;mapHeight=map.length;generateImage();setDoor();bindKeys();initScreen();gameCycle();};var gameCycle=()=>{timer+=1;if(gFlag=='i'){start();move();flicker();castRays();playMusic();fCounter();} setTimeout(gameCycle,1000/30);};var initScreen=()=>{var screen=$("screen");for(var i=0;i<screenWidth;i+=stripWidth){var strip=dc("div");strip.style.position="absolute";strip.style.left=i+"px";strip.style.width=stripWidth+"px";strip.style.height="0px";strip.style.overflow="hidden";strip.style.backgroundColor="grey";var img=new Image();img.src=imgUrl;img.style.position="absolute";img.style.left="0px";strip.appendChild(img);strip.img=img;screenStrips.push(strip);screen.appendChild(strip);}};var setDoor=()=>{var x=map.length;var y=map[0].length;while(true){x200=rand(x);y200=rand(y);if(map[x200][y200]==2){map[x200][y200]=3;break;}}};</script> </footer></html>