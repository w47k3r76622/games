<html><title>The Book of Ani</title><link rel="stylesheet" href="style.css"><script type="text/javascript" src="player-small.js"></script><script type="text/javascript" src="Blob.js"></script><canvas id="canvas"></canvas><script>!function(){var $=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=$}();var canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),swtHide=!0,plShadow=!1,cansit=!0,stage=-1,hist=0,sarc=620,width=1e3,height=620,player={x:width/2,y:500,width:35,height:80,speed:3,velX:0,velY:0,jumping:!1,grounded:!1,color:"rgba(0,0,0,0)",power:0,sitting:!1,ani:!1,valid:!1,walking:!1,side:"right",feather:!1,ibis:!1},keys=[],friction=.8,gravity=.8,door={x:-950,y:320,width:40,height:100,color:"#000"},validation=[{a:0},{a:400},{a:400},{a:400},{a:400},{a:0},{a:0},{a:0},{a:0},{a:0},],boxes=[{x:0,y:0,width:10,height:height,color:"#e7d09e"},{x:0,y:height-10,width:width,height:10,color:"#e7d09e"},{x:0,y:height-30,width:width,height:10,color:"#e7d09e"},{x:width-10,y:0,width:50,height:height,color:"#e7d09e"},{x:-10,y:0,width:width,height:10,color:"#e7d09e"},{x:-10,y:20,width:width,height:10,color:"#e7d09e"}],platforms=[{x:24,y:470,width:80,height:120,color:"#ac7e41",stage:0},{x:-430,y:200,width:80,height:height-230,color:"#ac7e41",stage:0},{x:120,y:490,width:300,height:28,color:"#ac7e41",stage:0},{x:120,y:520,width:300,height:70,color:"#ac7e41",stage:0},{x:700,y:560,width:280,height:30,color:"#ac7e41",stage:0},{x:730,y:525,width:220,height:33,color:"#ac7e41",stage:0},{x:760,y:490,width:170,height:33,color:"#ac7e41",stage:0},{x:785,y:455,width:120,height:33,color:"#ac7e41",stage:0},{x:815,y:420,width:60,height:33,color:"#ac7e41",stage:0},{x:920,y:160,width:0,height:10,color:"#ac7e41",stage:0},{x:700,y:560,width:290,height:30,color:"#d2a660",stage:1},{x:750,y:525,width:240,height:35,color:"#d2a660",stage:1},{x:800,y:490,width:190,height:35,color:"#d2a660",stage:1},{x:850,y:455,width:140,height:35,color:"#d2a660",stage:1},{x:900,y:420,width:90,height:35,color:"d2a660",stage:1},{x:520,y:485,width:60,height:10,color:"#d2a660",stage:1},{x:150,y:140,width:90,height:398,color:"#d2a660",stage:1},{x:125,y:540,width:140,height:50,color:"#d2a660",stage:1},{x:310,y:430,width:140,height:10,color:"#d2a660",stage:1},{x:595,y:350,width:170,height:10,color:"#d2a660",stage:1},{x:750,y:200,width:240,height:10,color:"#d2a660",stage:1},{x:750,y:130,width:10,height:70,color:"#d2a660",stage:1},{x:200,y:390,width:100,height:10,color:"#d2a660",stage:1},{x:195,y:270,width:400,height:10,color:"#d2a660",stage:1},{x:150,y:130,width:600,height:10,color:"#d2a660",stage:1},{x:10,y:460,width:40,height:10,color:"#d2a660",stage:1},{x:110,y:350,width:40,height:10,color:"#d2a660",stage:1},{x:10,y:280,width:40,height:10,color:"#d2a660",stage:1},{x:585,y:280,width:10,height:80,color:"#d2a660",stage:1},{x:300,y:390,width:10,height:50,color:"#d2a660",stage:1},{x:920,y:490,width:70,height:10,color:"#e7d09e",stage:5},{x:309,y:410,width:70,height:15,color:"#2b3526",stage:3},{x:51,y:410,width:70,height:15,color:"#2b3526",stage:3},{x:900,y:-20,width:270,height:15,color:"#e8dbc1",stage:3},{x:-259,y:-320,width:60,height:15,color:"#2b3526",stage:3},{x:-115,y:-320,width:60,height:15,color:"#2b3526",stage:3},{x:880,y:560,width:100,height:30,color:"#e7d09e",stage:3},{x:700,y:560,width:280,height:30,color:"#e7d09e",stage:3},{x:880,y:525,width:80,height:33,color:"#e7d09e",stage:3},{x:730,y:525,width:80,height:33,color:"#e7d09e",stage:3},{x:760,y:490,width:50,height:33,color:"#e7d09e",stage:3},{x:880,y:490,width:50,height:33,color:"#e7d09e",stage:3},{x:785,y:455,width:120,height:33,color:"#e7d09e",stage:3},{x:815,y:420,width:60,height:33,color:"#e7d09e",stage:3},{x:640,y:565,width:80,height:25,color:"#d2a660",stage:2},{x:204,y:540,width:135,height:60,color:"#e7d09e",stage:2},{x:228,y:40,width:85,height:550,color:"#e7d09e",stage:2},{x:780,y:270,width:210,height:10,color:"#e7d09e",stage:2},{x:740,y:290,width:250,height:10,color:"#e7d09e",stage:2},{x:440,y:420,width:170,height:10,color:"#e7d09e",stage:2},{x:440,y:400,width:200,height:10,color:"#e7d09e",stage:2},{x:580,y:340,width:60,height:60,color:"#ac6533",stage:2},{x:10,y:-200,width:70,height:10,color:"#e7d09e",stage:2},{x:10,y:-220,width:90,height:10,color:"#e7d09e",stage:2},{x:-512,y:320,width:90,height:10,color:"#e7d09e",stage:2},{x:-512,y:320,width:90,height:10,color:"#e7d09e",stage:2},],powerup=[{x:805,y:491,width:32,height:32,color:"rgba(0,0,0,0)",effect:"hide"},{x:50,y:480,width:30,height:30,color:"rgba(0,0,0,0)",effect:"hide",stay:!1,stage:1},{x:246,y:450,width:50,height:50,color:"rgba(0,0,0,0)",effect:"gravity",stay:!1,stage:1},{x:246,y:300,width:50,height:50,color:"rgba(0,0,0,0.0)",effect:"gravity",stay:!1,stage:1},{x:246,y:160,width:17,height:35,color:"rgba(0,0,0,1)",effect:"none",stay:!1,stage:1},{x:827,y:-80,width:40,height:40,color:"rgba(0,0,0,0)",effect:"none",stay:!1,stage:0},{x:150,y:-341,width:40,height:80,color:"rgba(100,0,0,0)",effect:"none",stay:!1,stage:0},{x:200,y:-341,width:40,height:80,color:"rgba(0,100,0,0)",effect:"none",stay:!1,stage:0},{x:250,y:-341,width:40,height:80,color:"rgba(100,0,0,0)",effect:"none",stay:!1,stage:0},{x:300,y:-341,width:40,height:80,color:"rgba(100,0,0,0)",effect:"none",stay:!1,stage:0},{x:350,y:-341,width:40,height:80,color:"rgba(100,0,0,0)",effect:"none",stay:!1,stage:0},{x:920,y:-90,width:48,height:48,color:"rgba(0,0,0,0)",effect:"none",stage:3,stay:!1},{x:835,y:504,width:48,height:48,color:"rgba(0,0,0,0)",effect:"none",stage:3,stay:!1},{x:930,y:170,width:40,height:80,color:"rgba(0,0,0,0)",effect:"none",stage:2,stay:!1},{x:85,y:460,width:40,height:80,color:"rgba(0,0,0,0)",effect:"none",stage:2,stay:!1}];function update(){player.walking=!1,(keys[38]||keys[32]||keys[87])&&!player.jumping&&player.grounded&&(player.jumping=!0,player.grounded=!1,player.velY=-(2.5*player.speed),player.height=93,player.y-=20),(keys[39]||keys[68])&&(player.velX<player.speed&&(player.velX++,player.walking=!0),player.side="right",0==validation[9].a&&(startMusic(),validation[9].a=1)),(keys[37]||keys[65])&&(player.velX>-player.speed&&(player.velX--,player.walking=!0),player.side="left"),player.velX*=friction,player.velY+=gravity,ctx.clearRect(0,0,width,height),ctx.beginPath(),player.grounded=!1;for(var $=0;$<boxes.length;$++){ctx.fill(),ctx.fillStyle=boxes[$].color,ctx.fillRect(boxes[$].x,boxes[$].y,boxes[$].width,boxes[$].height);var e=colCheck(player,boxes[$]);"l"===e||"r"===e?(player.velX=0,player.jumping=!1):"b"===e?(player.grounded=!0,player.jumping=!1):"t"===e&&(player.velY*=-1)}if(ctx.fillStyle="#000",ctx.fillRect(door.x,door.y,door.width,door.height),-1==stage&&(player.x>10&&!1==player.valid&&(player.x=10,player.valid=!0),ctx.fillStyle="#e8dbc1",0==hist&&(ctx.font="Bold 25px Tahoma",ctx.fillText("| The book of Ani |",390,154),ctx.font="25px Tahoma",ctx.fillText("This is a retelling of a real event documented",208,240),ctx.fillText("in a papyrus found in Thebes, Egypt.",208,280),ctx.font="Italic 18px Tahoma",ctx.fillStyle="#e7d09e",ctx.fillText("hold",430,340),ctx.fillText("button",510,340),ctx.drawImage(imgmap,21,44,4,7,480,324,12,21)),1==hist&&(ctx.font="Bold 25px Tahoma",ctx.fillText("| The book of Ani |",390,154),ctx.font="25px Tahoma",ctx.fillText("Ani was a scribe who guaranteed his afterlife",208,240),ctx.fillText("through the enchantments described in",208,278),ctx.fillText("the Book of the Dead.",208,317),ctx.font="Italic 18px Tahoma",ctx.fillStyle="#e7d09e",ctx.fillText("hold",430,370),ctx.fillText("button",510,370),ctx.drawImage(imgmap,21,44,4,7,480,354,12,21)),0==hist&&player.x>700&&(hist=1,player.valid=!1,player.x=10),1==hist&&(ctx.filter="brightness(0.3)",ctx.drawImage(imgmap,32,32,13,30,820,410,80,180),ctx.filter="none",ctx.drawImage(imgmap,64,19,23,17,790,380,136,120),player.x>=500&&platforms[30].y<600&&(player.velX=0,platforms[30].y+=1,600==platforms[30].y&&(player.valid=!1,player.x=-400,hist=2))),2==hist&&(player.y=-100,player.x=400,ctx.font="Bold 25px Tahoma",ctx.fillText("| The book of Ani |",390,154),ctx.font="25px Tahoma",ctx.fillText('Also known as "Chapters of Going Forth by Day"',230,240),ctx.fillText("A magical book from",380,278),ctx.font="Bold 25px Tahoma",ctx.fillText("13th Century BC.",390,317),ctx.fillStyle="#e7d09e",ctx.font="Italic 18px Tahoma",ctx.fillText("press",360,409),ctx.fillText("to start the game",495,409),ctx.font="18px Tahoma",ctx.fillText("enter",426,409),ctx.strokeStyle="#e7d09e",ctx.roundRect(415,390,65,27,[8]),ctx.stroke(),sarc>=485&&(sarc-=6),ctx.filter="saturate(0.3)",ctx.drawImage(imgmap,48,38,16,26,51,sarc,60,105),ctx.filter="none",ctx.filter="saturate(0.5)",ctx.drawImage(imgmap,48,38,16,26,151,sarc,60,105),ctx.filter="none",ctx.filter="saturate(0.1)",ctx.drawImage(imgmap,48,38,16,26,251,sarc,60,105),ctx.filter="none",ctx.filter="saturate(0.7)",ctx.drawImage(imgmap,48,38,16,26,351,sarc,60,105),ctx.filter="none",ctx.filter="saturate(0.3)",ctx.drawImage(imgmap,64,0,32,8,550,438,200,47),ctx.fillStyle="#d2a660",ctx.fillRect(490,485,300,30),ctx.fillRect(490,517,300,73),ctx.filter="none",ctx.filter="brightness(0.3)",ctx.drawImage(imgmap,32,32,13,30,820,410,80,180),ctx.filter="none",ctx.drawImage(imgmap,64,19,23,17,790,380,136,120),keys[13]&&(stage=0,hist=3)),player.ani=!1,player.side="none",friction=.6,ctx.filter="brightness(0.5)",ctx.filter="saturate(0.4)",ctx.drawImage(imgmap,48,38,16,26,player.x,player.y-10,60,105),ctx.drawImage(imgmap,48,38,16,26,player.x+210,player.y-10,60,105),ctx.drawImage(imgmap,64,0,32,8,player.x+40,player.y-50,200,47),ctx.fillStyle="#d2a660",ctx.fillRect(player.x+30,player.y-3,200,40)),0==gravity&&(gravity=.2),0==stage){3==hist&&(player.x=500,player.y=400,hist=4,player.side="right");for(var t=0;t<platforms.length;t++)if(0==platforms[t].stage){ctx.fill(),ctx.fillStyle=platforms[t].color,ctx.fillRect(platforms[t].x,platforms[t].y,platforms[t].width,platforms[t].height);var _=colCheck(player,platforms[t]);"l"===_||"r"===_?(player.velX=0,player.jumping=!1):"b"===_?(player.grounded=!0,player.jumping=!1):"t"===_&&(player.velY*=-1)}ctx.drawImage(imgmap,0,0,16,32,powerup[5].x,powerup[5].y,40,80),ctx.drawImage(imgmap,16,0,8,16,powerup[5].x+10,powerup[5].y+15,20,40),ctx.drawImage(imgmap,0,0,16,32,powerup[6].x,powerup[6].y,40,80),ctx.drawImage(imgmap,16,16,14,16,powerup[6].x+5,powerup[6].y+20,32,35),ctx.drawImage(imgmap,0,0,16,32,powerup[7].x,powerup[7].y,40,80),ctx.drawImage(imgmap,32,16,13,13,powerup[7].x+5,powerup[7].y+20,30,30),ctx.drawImage(imgmap,0,0,16,32,powerup[8].x,powerup[8].y,40,80),ctx.drawImage(imgmap,32,0,12,13,powerup[8].x+5,powerup[8].y+20,30,35),ctx.drawImage(imgmap,0,0,16,32,powerup[9].x,powerup[9].y,40,80),ctx.drawImage(imgmap,48,0,14,12,powerup[9].x+4,powerup[9].y+20,33,35),ctx.drawImage(imgmap,0,0,16,32,powerup[10].x,powerup[10].y,40,80),ctx.drawImage(imgmap,24,0,8,16,powerup[10].x+10,powerup[10].y+20,17,35),ctx.drawImage(imgmap,64,0,32,8,platforms[2].x+70,platforms[2].y-40,170,40),ctx.drawImage(imgmap,16,16,14,16,160,541,32,35),ctx.drawImage(imgmap,32,16,14,14,210,545,30,30),ctx.drawImage(imgmap,32,0,12,13,260,541,30,35),ctx.drawImage(imgmap,48,0,14,12,310,541,32,35),ctx.drawImage(imgmap,24,0,8,16,360,541,17,35),ctx.drawImage(imgmap,16,0,8,16,840,422,15,30),ctx.drawImage(imgmap,87,9,12,16,50,platforms[0].y+10,36,48),player.x>790&&player.x<870&&(!0==player.sitting&&platforms[2].x<422&&(platforms[2].x+=.7),platforms[2].x>190&&(powerup[6].y=341),platforms[2].x>240&&(powerup[7].y=341),platforms[2].x>290&&(powerup[8].y=341),platforms[2].x>340&&(powerup[9].y=341),platforms[2].x>390&&(powerup[10].y=341),platforms[2].x>419&&platforms[2].y<560&&(platforms[2].y+=10)),platforms[2].x>390&&platforms[2].x<422&&(platforms[2].x+=.5),powerup[6].x<0&&powerup[7].x<0&&powerup[8].x<0&&powerup[9].x<0&&powerup[10].x<0&&powerup[5].y<300&&(powerup[5].y+=.7),powerup[5].x<0&&!1==player.ani&&(validation[7].a<300&&(validation[7].a++,ctx.font="italic 25px Arial",ctx.fillText("Ani, Wake Up!",680,240)),validation[7].a>299&&(player.y=-100,player.ani=!0,player.valid=!1)),!0==player.ani&&!1==player.valid&&(player.x=160,player.y=400,player.y+=15,player.valid=!0,hist=5),!0==player.valid&&5==hist&&(ctx.drawImage(imgmap,73,56,23,7,131,513,69,21),door.x=950,door.y=55,platforms[9].x>120&&(platforms[9].x-=3),platforms[9].width<867&&(platforms[9].width+=3),!0==player.ani&&player.x>20&&player.x<120&&!0==player.sitting&&platforms[0].y>160&&(platforms[0].y-=3,platforms[0].height+=3)),null!==colCheck(player,door)&&(stage=1,console.log(stage),powerup[2].x=246,powerup[3].x=246),validation[1].a>0&&(validation[1].a-=1,ctx.fillStyle="#3a2937",ctx.fillRect(10,10,980,600),ctx.fillStyle="#e7d09e",ctx.font="Bold 25px Tahoma",ctx.fillText("| Chapter 1 |",420,154),ctx.font="25px Tahoma",ctx.fillText("Anubis colects all the Amulets, then Ani wake up.",200,240))}if(1==stage){5==hist&&(powerup[1].x=50,player.x=400,player.y=450,powerup[4].x=246,hist=6),door.x=-1e3,document.getElementById("canvas").style.background="#593859";for(var a=0;a<platforms.length;a++)if(1==platforms[a].stage){ctx.fill(),ctx.fillStyle=platforms[a].color,ctx.fillRect(platforms[a].x,platforms[a].y,platforms[a].width,platforms[a].height);var l=colCheck(player,platforms[a]);"l"===l||"r"===l?(player.velX=0,player.jumping=!1):"b"===l?(player.grounded=!0,player.jumping=!1):"t"===l&&(player.velY*=-1)}ctx.fillStyle=powerup[1].color,ctx.fillRect(powerup[1].x,powerup[1].y,40,80),ctx.drawImage(imgmap,0,0,16,32,powerup[1].x,powerup[1].y,40,80),ctx.drawImage(imgmap,32,1,12,13,powerup[1].x+4,powerup[1].y+18,35,35),ctx.fillRect(powerup[4].x,powerup[4].y,40,80),ctx.drawImage(imgmap,0,0,16,32,powerup[4].x,powerup[4].y,40,80),ctx.drawImage(imgmap,24,0,8,16,powerup[4].x+10,powerup[4].y+20,17,35),ctx.fillRect(powerup[2].x,powerup[2].y,40,40),ctx.drawImage(imgmap,48,16,16,16,powerup[2].x,powerup[2].y,35,35),ctx.fillRect(powerup[3].x,powerup[3].y,40,40),ctx.drawImage(imgmap,48,16,16,16,powerup[3].x,powerup[3].y,35,35),(null!==colCheck(player,powerup[4])||powerup[4].x<-999)&&(player.power=1,powerup[4].x+=1),ctx.drawImage(imgmap,64,9,12,10,855,465,36,32),player.x>820&&player.x<900&&!0==player.sitting&&(swtHide=!1),!1==swtHide&&(ctx.drawImage(imgmap,87,9,9,12,755,533,36,32),player.x>730&&player.x<790&&!0==player.sitting&&platforms[17].x<326&&(platforms[17].x+=1)),powerup[1].x<0&&powerup[4].x<0&&(door.x=950,door.y=100),null!==colCheck(player,door)&&(door.x=-1e3,powerup[13].x=920,powerup[14].x=35,player.valid=!1,player.x=740,player.y=400,stage=2),validation[2].a>0&&(validation[2].a-=1,ctx.fillStyle="#593859",ctx.fillRect(10,10,980,600),ctx.fillStyle="#e7d09e",ctx.font="Bold 25px Tahoma",ctx.fillText("| Chapter 2 |",420,154),ctx.font="25px Tahoma",ctx.fillText("Ani needs the Sheut (Shadow) power.",300,240))}if(2==stage){document.getElementById("canvas").style.background="#686090";for(var r=0;r<platforms.length;r++)if(2==platforms[r].stage){ctx.fill(),ctx.fillStyle=platforms[r].color,ctx.fillRect(platforms[r].x,platforms[r].y,platforms[r].width,platforms[r].height);var l=colCheck(player,platforms[r]);"l"===l||"r"===l?(player.velX=0,player.jumping=!1):"b"===l?(player.grounded=!0,player.jumping=!1):"t"===l&&(player.velY*=-1)}ctx.drawImage(imgmap,0,0,16,32,powerup[13].x,powerup[13].y,40,80),ctx.drawImage(imgmap,32,16,13,13,powerup[13].x+5,powerup[13].y+20,30,30),ctx.drawImage(imgmap,0,0,16,32,powerup[14].x,powerup[14].y,40,80),ctx.drawImage(imgmap,16,16,14,16,powerup[14].x+5,powerup[14].y+20,32,35),ctx.drawImage(imgmap,87,9,9,12,670,565,18,24),player.x>605&&player.x<720&&player.y>450&&player.y<620&&platforms[46].y<400&&(platforms[46].y+=2,platforms[46].height-=2),(player.x<605&&0==validation[5].a||player.x>720&&0==validation[5].a)&&platforms[46].y>=40&&(platforms[46].y-=2,platforms[46].height+=2),powerup[13].x<0&&(player.power=2,ctx.drawImage(imgmap,32,16,13,13,player.x+2,player.y-27,30,30)),"right"==player.side&&2==player.power&&player.x>=platforms[51].x-50&&player.x<platforms[51].x&&player.y>300&&player.y<400&&platforms[51].x<640&&(platforms[51].x+=2),640==platforms[51].x&&platforms[51].y<505&&(platforms[51].y+=5),platforms[51].y>500&&(validation[5].a=1,platforms[46].y<400&&(platforms[46].y+=2,platforms[46].height-=2)),validation[3].a>0&&(validation[3].a-=1,ctx.fillStyle="#686090",ctx.fillRect(10,10,980,600),ctx.fillStyle="#e7d09e",ctx.font="Bold 25px Tahoma",ctx.fillText("| Chapter 3 |",420,154),ctx.font="25px Tahoma",ctx.fillText("With Ka (Vital Force), you can move objects.",260,240)),powerup[13].x<0&&powerup[14].x<0&&0==validation[6].a&&(door.x=950,door.y=170,validation[6].a=1),null!==colCheck(player,door)&&(stage=3,door.x=-1e3,powerup[11].x=920,powerup[12].x=835,player.valid=!1)}if(3==stage){document.getElementById("canvas").style.background="#7c89b3";for(var o=0;o<platforms.length;o++)if(3==platforms[o].stage){ctx.fill(),ctx.fillStyle=platforms[o].color,ctx.fillRect(platforms[o].x,platforms[o].y,platforms[o].width,platforms[o].height);var l=colCheck(player,platforms[o]);"l"===l||"r"===l?(player.velX=0,player.jumping=!1):"b"===l?(player.grounded=!0,player.jumping=!1):"t"===l&&(player.velY*=-1)}ctx.strokeRect(214,253,17,194),ctx.fillStyle="#d2a660",ctx.fillRect(215,253,15,306),ctx.fillStyle="#3c4a35",ctx.fillRect(215,353,15,90),ctx.drawImage(imgmap,31,16,1,13,215,253,15,20),ctx.drawImage(imgmap,31,16,1,13,215,290,15,30),ctx.strokeRect(214,366,17,194),ctx.strokeRect(79,269,272,17),ctx.fillStyle="#d2a660",ctx.fillRect(80,270,270,15),ctx.fillStyle="#3c4a35",ctx.fillRect(120,270,60,15),ctx.fillRect(260,270,60,15),ctx.drawImage(imgmap,31,30,13,1,80,270,30,15),ctx.drawImage(imgmap,31,30,13,1,318,270,30,15),ctx.strokeStyle="#3e496b",ctx.strokeRect(80,280,0,130),ctx.strokeRect(351,280,0,130),ctx.strokeRect(80,560,280,30),ctx.drawImage(imgmap,64,40,7,24,powerup[12].x,powerup[12].y,21,52),ctx.fillStyle=powerup[12].color,ctx.fillRect(powerup[12].x,powerup[12].y,20,48),ctx.drawImage(imgmap,87,17,9,4,830,430,30,15),player.x>790&&player.x<870&&player.y>320&&player.y<360?(player.power=0,cansit=!0,!0==player.sitting&&platforms[37].x>79&&(platforms[37].x-=.7)):player.power=1,platforms[37].x<400&&platforms[37].x>79&&(platforms[37].x-=.7),powerup[12].x<0&&(player.feather=!0,!0==player.feather&&ctx.drawImage(imgmap,64,40,7,24,player.x+4,player.y-80,21,52)),player.x>300&&player.x<370&&player.y>380&&player.y<5e3&&!0==player.feather&&(player.valid=!0,powerup[12].x=1e3,player.feather=!1),!0==player.valid&&!1==player.feather&&(ctx.drawImage(imgmap,64,40,7,24,330,335,21,52),ctx.fillRect(platforms[33].x,platforms[33].y,90,10),ctx.drawImage(imgmap,0,0,16,32,powerup[11].x,powerup[11].y,40,80),ctx.drawImage(imgmap,48,0,14,12,powerup[11].x+4,powerup[11].y+20,33,35),platforms[33].y<280&&(platforms[33].y+=.7),powerup[11].y<90&&platforms[33].y>=280&&(powerup[11].y+=.7)),powerup[11].x<0&&powerup[0].x<0&&(ctx.drawImage(imgmap,16,32,14,12,player.x+10,player.y-40,30,26),player.ibis=!0),player.x>40&&player.x<130&&player.y>380&&player.y<500&&!0==player.ibis&&(player.ibis=!1,powerup[0].y=-1e3),!1==player.ibis&&powerup[0].y<0&&(ctx.drawImage(imgmap,16,32,14,12,68,355,40,34),powerup[0].x=1,validation[8].a=1),validation[4].a>0&&(validation[4].a-=1,ctx.fillStyle="#593859",ctx.fillRect(10,10,980,600),ctx.fillStyle="#e7d09e",ctx.font="Bold 25px Tahoma",ctx.fillText("| Chapter 4 |",420,154),ctx.font="25px Tahoma",ctx.fillText("In front of the Gods now your challange",270,240),ctx.fillText("will be to scale the Ibis (Heart)",310,278),ctx.fillText("with the feather of Ammut.",340,316)),1==validation[8].a&&(ctx.fillStyle="#2b3526",ctx.font="bold 	25px Tahoma",ctx.fillText("So... Ani, you collected all the Amulets and",260,140),ctx.fillText("showed the weight of your heart to the Gods.",260,190),ctx.fillText("Now you can live forever in the Osiris Paradise",260,240),ctx.fillText("Well done!!",660,290),ctx.font="Italic 18px Tahoma",ctx.fillText("press",410,409),ctx.fillText("to play again",545,409),ctx.font="18px Tahoma",ctx.fillText("enter",476,409),ctx.strokeStyle="#2b3526",ctx.roundRect(465,390,65,27,[8]),ctx.stroke(),keys[13]&&(window.location.href=window.location.href))}ctx.fillStyle=player.color,ctx.fillRect(player.x,player.y,player.width,player.height),!1==plShadow&&(!1==player.ani&&(ctx.filter="brightness(0.3)"),!1==player.walking&&("right"==player.side&&(ctx.drawImage(imgmap,0,32,13,30,player.x-3,player.y+2,40,90),!1==player.ani&&(ctx.filter="none",ctx.drawImage(imgmap,73,38,23,17,player.x-14,player.y-20,68,60))),"left"==player.side&&(ctx.drawImage(imgmap,32,32,13,30,player.x-3,player.y+2,40,90),!1==player.ani&&(ctx.filter="none",ctx.drawImage(imgmap,64,19,23,17,player.x-24,player.y-21,68,60)))),ctx.filter="none",player.height=93),keys[40]||keys[83]?(1==player.power&&(plShadow=!0,cansit=!1,player.height=24,player.walking=!1,ctx.drawImage(imgmap,6,33,1,1,player.x,player.y+24,42,10)),!0==cansit&&(player.height=62,plShadow=!0,player.sitting=!0,!1==player.ani&&(ctx.filter="brightness(0.3)"),ctx.drawImage(imgmap,48,38,16,26,player.x,player.y-10,40,70),ctx.filter="none",!1==player.ani&&(ctx.filter="none",ctx.drawImage(imgmap,73,38,23,17,player.x-14,player.y-30,68,60)),player.walking=!1)):(plShadow=!1,player.sitting=!1),!0==player.walking&&(!1==player.ani&&(ctx.filter="brightness(0.3)"),"right"==player.side&&(ctx.drawImage(imgmap,0,32,13,25,player.x-3,player.y,40,76),ctx.drawImage(imgmap,13,58,12,6,player.x,player.y+75,40,20),!1==player.ani&&(ctx.filter="none",ctx.drawImage(imgmap,73,38,23,17,player.x-14,player.y-20,68,60))),"left"==player.side&&(ctx.drawImage(imgmap,32,32,13,25,player.x-3,player.y,40,76),ctx.drawImage(imgmap,13,52,12,6,player.x-5,player.y+73,40,20),!1==player.ani&&(ctx.filter="none",ctx.drawImage(imgmap,64,19,23,17,player.x-25,player.y-20,68,60))),ctx.filter="none"),player.grounded&&(player.velY=0,player.walking),player.x+=player.velX,player.y+=player.velY,ctx.restore();for(var p=0;p<powerup.length;p++)null!==colCheck(player,powerup[p])&&("gravity"===powerup[p].effect?gravity-=.2:"tele"===powerup[p].effect&&(player.x=powerup[p].px,player.y=powerup[p].py),!0!==powerup[p].stay&&(powerup[p].x=-1e3));requestAnimationFrame(update)}function colCheck($,e){var t=$.x+$.width/2-(e.x+e.width/2),_=$.y+$.height/2-(e.y+e.height/2),a=$.width/2+e.width/2,l=$.height/2+e.height/2,r=null;if(Math.abs(t)<a&&Math.abs(_)<l){var o=a-Math.abs(t),p=l-Math.abs(_);o>=p?_>0?(r="t",$.y+=p):(r="b",$.y-=p):t>0?(r="l",$.x+=o):(r="r",$.x-=o)}return r}function startMusic(){var $=new CPlayer;$.init({songData:[{i:[1,251,128,164,3,240,128,139,64,144,4,7,23,176,0,0,3,208,14,1,2,255,81,0,160,61,5,44,12],p:[,,,,,,,7,7,7,7,8,3,3,3,5,5,5,2,,,,,,,,7,7,7,7,8,3,3,3,5,5,5,2],c:[{n:[],f:[]},{n:[138,137,,,,,,,,145,144,,,,,144,142,,,,,141,,,,138,137],f:[]},{n:[130,,,,133,,,,138,,,,141,,,,137],f:[]},{n:[125,,,,,,125,,,,,,125,,125,,125,,,,,,125,,,,,,125],f:[]},{n:[125,,,,,,149,,125,,,,,,,,125,,,,,,125,,149],f:[]},{n:[101,,,,,,101,,,,,,,,,,101,,,,,,101],f:[]},{n:[,,,,147,147,,,,,147,147,,,147,147,,,,,147,147,,,,,147,147,,,147,147,125,,125,,,,125,,125,,,,,,,,125,,125,,,,125,,125,,,,,,,,,,,,,,,,,,,,149,,,,,,,,,,,,,,,,149],f:[]},{n:[,,,,,,,,,,147,147,,,,,,,,,,,,,,,,147,,,,,125,,125,,,,125,,125,,,,,,,,125,,125,,,,125,,125,,,,,,,,,,,,,,,,,,,,149,,,,,,,,,,,,,,,,149,,,,,,,,,,,,,,,,,,,,,,,,,141,,,,138,137],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[,4,,4,,,3,,,3,2,,,,,,,,,,4,,4,,,3,,,3,2],c:[{n:[],f:[]},{n:[126,125,,,,,,,,133,132,,,,,132,130,,,,,129,,,,126,125],f:[]},{n:[114,,,,,,113,,,,,,,,113,,,,,,,,113],f:[]},{n:[,,,,,,,,,,,,,,169,,,,,,,,168],f:[]}]},{i:[3,191,128,0,2,184,140,18,0,255,64,119,218,203,0,0,0,101,3,1,3,2,0,1,27,212,3,0,8],p:[,,4,5,7,,,,6,,,,2,2,2,3,3,3,3,,,4,5,7,,,,6,,,,2,2,2,3,3,3,3],c:[{n:[],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,141,,,144,,,148,,,150,,,153,,,148,,,144,,,,141,,,137,,,136,,,141],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,131,,,,,,,134,,,,,,,,,,131,,,,,,,136],f:[]},{n:[165,,,,,,,,,,,,,,,,161],f:[]},{n:[160],f:[]},{n:[165,,,,,,,,,,,,,,,,161,,,,,,,,160,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,137,,,,,,,,136],f:[]},{n:[,,,,156,,,,,,,,,,,,,,155],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,0,6,84,0,0,0,0,195,4,0,2,50,184,119,244,91,6,0,6],p:[,,,,,,,,,,,,2,2,2,3,3,3,3,,,,,,,,,,,,,2,2,2,3,3,3,3],c:[{n:[],f:[]},{n:[112,,,,,,112,,,,,,,,,,,,,,,,,,,,,,117],f:[]},{n:[117,,,,,,115,,,,,,,,,,113,,,,,,110,,,,,,120],f:[]}]},{i:[3,255,128,0,0,216,140,15,0,0,2,4,81,57,0,0,0,47,12,1,3,135,113,1,45,56,4,43,1],p:[,,,,,,,,,,,6,,2,2,4,3,4,5,,,,,,,,,,,,6,,2,2,4,3,4,5],c:[{n:[],f:[]},{n:[136,,,,,,143,,,,,,,,,,146,,,,144,,,,,,141,,,,148],f:[]},{n:[,,,,,,,,,,,,144,146,144,,,,,,143,144,143,,,,,,149,148,153],f:[]},{n:[,,,,,,144,146,144,,,,,,143,144,143,,,,,,141,142,141,,,,137],f:[]},{n:[,,149,148,,,144,143,,,,,144,146,144,,142,141,,,143,144,143,,,139,138,,149,148,153],f:[]},{n:[,,,148,,,144,143,,,,,144,146,144,,142,141,,,143,144,,,,,,,149,148,153],f:[]}]},{i:[0,100,128,190,3,55,128,0,0,0,17,23,116,187,0,0,0,180,0,1,2,32,0,15,109,0,6,0,6],p:[],c:[]},{i:[3,0,128,0,3,0,128,2,0,255,138,9,39,0,0,0,0,0,0,0,2,9,40,99,159,0,0,0,6],p:[],c:[]},{i:[1,203,128,0,3,201,128,0,0,0,5,6,58,0,0,0,0,195,6,0,1,20,173,0,32,147,13,112,2],p:[],c:[]},{i:[0,146,128,80,3,41,128,12,100,195,48,40,91,113,0,0,0,168,1,0,3,6,122,16,81,147,6,0,6],p:[],c:[]},{i:[0,0,140,0,0,0,140,0,0,81,4,11,0,55,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[8,8,8,8,8,8,,8,8,8,2,,,,,,,,,8,8,8,8,8,8,,8,8,8,2],c:[{n:[],f:[]},{n:[,,,,147,147,,,,,147,147,,,147,147,,,,,147,147,,,,,147,147,,,147,147],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[108,,,,,,,,108,,,,,,,,108,,,,,,,,108],f:[]},{n:[159,,,,,,159,,,,,,,,,,,,,,,,159],f:[]},{n:[,,,,,,159,,,,,,159,,,132,134,134,134,134,,,,,,,,,159],f:[]}]},{i:[0,255,116,64,0,255,120,0,64,127,4,6,35,0,0,0,0,0,0,0,2,14,0,10,32,0,0,0,0],p:[],c:[]},{i:[0,0,140,0,0,0,140,0,0,255,158,158,158,0,0,0,0,51,2,1,2,58,239,0,32,88,1,157,2],p:[8,8,8,8,8,8,8,,,,8,,,,,,,,,8,8,8,8,8,8,8,,,,8],c:[{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[142],f:[]}]},{i:[3,212,128,156,0,224,128,0,124,11,0,13,56,85,0,0,2,190,0,1,3,143,137,0,32,61,0,0,6],p:[,,,,,,2,2,2,2,2,2,,,,,,,,,,,,,,2,2,2,2,2,2],c:[{n:[],f:[]},{n:[,,,,147,147,,,,,147,147,,,147,147,,,,,147,147,,,,,147,147,,,147,147],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,255,4,10,47,55,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[,,,,,,2,2,8,2,2,8,,,,,,,,,,,,,,2,2,8,2,2,8],c:[{n:[],f:[]},{n:[135,,135,,,,137,,135,,,,,,,,135,,135,,,,137,,135,,,,130,130,130],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[130,,,,,,159,,,,,,159,,,132,134,134,134,134,,,130,,,,,,159],f:[]}]},],rowLen:5513,patternLen:32,endPattern:37,numChannels:14});var e=!1;setInterval(function(){if(!e&&(e=$.generate()>=1)){var t=$.createWave(),_=document.createElement("audio");_.src=URL.createObjectURL(new Blob([t],{type:"audio/wav"})),_.loop=!0,_.play()}},0)}canvas.width=width,canvas.height=height,ctx.imageSmoothingEnabled=!1,(imgmap=new Image).src="./img/imgmap.png",document.body.addEventListener("keydown",function($){keys[$.keyCode]=!0}),document.body.addEventListener("keyup",function($){keys[$.keyCode]=!1}),window.addEventListener("load",function(){update()});</script></html>