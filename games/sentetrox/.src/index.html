<!DOCTYPE html><html><head><meta charset=utf-8><style>body{margin:0;background:#222}body,div{display:flex;width:100vw;height:100vh;overflow:hidden;align-items:center;justify-content:center;color:#eee;background:#000;font-family:monospace}div{position:fixed;display:none}body.l div{display:flex}canvas{width:100%;height:100%;object-fit:contain}</style></head><body class=l><canvas width=600 height=400></canvas><div>Generating audio assets...</div><script>'use strict';let aa={38:88,67:16,17:90},ba=[,"#0ff","#01f","#f80","#ff0","#0f0","#909","#f00"],ca=[,"#5aa","#549","#a74","#995","#5a4","#747","#954"];var k={},m={},p=null,da={};function q(a){return p.buttons[a].pressed}function ea(){return Object.values(k).some(a=>a)}function r(a){return!!k[a]&&!m[a]}
function fa(){if(p){var a=function(b,c){c&&!da[b]&&(ha(b),da[b]=!0);!c&&da[b]&&(ia(b),da[b]=!1)};p=navigator.getGamepads()[p.index];a(37,-.3>p.axes[0]||q(14));a(39,.3<p.axes[0]||q(15));a(32,-.3>p.axes[1]||q(12));a(40,.3<p.axes[1]||q(13));a(88,q(1)||q(3));a(90,q(0)||q(2));a(16,q(4)||q(5)||q(6)||q(7));a(27,q(8)||q(9)||q(10))}}function ja(){Object.entries(k).forEach(([a,b])=>{m[a]=b})}function ha(a){a=aa[a]||a;m[a]=k[a];k[a]=!0}function ia(a){a=aa[a]||a;m[a]=k[a];k[a]=!1}
document.addEventListener("keydown",({repeat:a,keyCode:b})=>{a||ha(b)},!1);document.addEventListener("keyup",({keyCode:a})=>{ia(a)},!1);window.addEventListener("gamepadconnected",a=>{p||(p=a.gamepad)});let t=document.querySelector("canvas"),u=t.getContext("2d");u.imageSmoothingEnabled=!1;function ka(){u.resetTransform()}function la(a,b,c,d){u.fillRect(a,b,c,d);u.strokeRect(a,b,c,d)}function ma(a,b,c){u.save();u.translate(a,b);c();u.restore()}
function v(a,b,c,d=0,e=1,f=1,g=0){ma(b,c,()=>{u.rotate(g);u.scale(e,f);let h=a.L[d];u.drawImage(a.S,h.x,h.y,h.s,h.o,-h.v,-h.w,h.s,h.o)})}
class na{constructor(){this.y=this.x=this.u=0;this.M=this.T=!1;this.F=0;this.D=[0,0];this.a=0;this.b=.01}move(a,b){this.x+=a;this.y+=b}I(){this.u=(this.u+1)%4}H(){this.u=(this.u+3)%4}i(){this.a++;if(60<this.a&&Math.random()<this.b){if(this.F)this.F=0;else if(.4>Math.random()){this.a=50;this.F=this.b=1;return}this.a=0;this.b=.01;this.D=[4*Math.random()-2,4*Math.random()-2]}}}
function w(a,b,c){return class extends na{ca(){return a}N(){return ba[a]}B(){return b[this.u].map(([d,e])=>[this.x+d,this.y+e])}ea(){return c[this.u]}da(){return c[(this.u+3)%4].map(([d,e])=>[-d,-e])}}}
let x=[[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]]],oa=w(6,[[[0,0],[-1,0],[0,1],[1,0]],[[0,0],[0,1],[1,0],[0,-1]],[[0,0],[1,0],[0,-1],[-1,0]],[[0,0],[0,-1],[-1,0],[0,1]]],x),pa=[[0,1],[1,1],[0,0],[1,0]],qa=w(4,[pa,pa,pa,pa],[]),y=new AudioContext,z=y.createDynamicsCompressor();z.knee.setValueAtTime(40,0);z.threshold.setValueAtTime(-12,0);z.connect(y.destination);let A,B=y.sampleRate;
async function C(a,b=1,c=!1){let d=y.createBufferSource();d.buffer=await a;c&&d.connect(A);if(1!==b){let e=y.createGain();e.gain.setValueAtTime(b,0);d.connect(e);d.onended=()=>e.disconnect(z);e.connect(z)}else d.connect(z);d.start()}function D(a,b){for(;a.b<a.a.length-1;){let [c,d,e=1]=a.a[a.b],[f,g]=a.a[a.b+1];if(c<=b&&b<f)return b=(b-c)/(f-c),b=1<e?b**e:1-(1-b)**(1/e),a.g?d*(g/d)**b:d+b*(g-d);a.b++}return a.a[a.a.length-1][1]}class E{constructor(a,b=!1){this.a=a;this.g=b;this.b=0}}
async function ra(){await new Promise(a=>requestAnimationFrame(a))}function G(a,b){a=a.toString();return a.length>b?Array(b).fill(9).join(""):Array(b-a.length).fill(0).join("")+a}function H(){return 2*Math.random()-1}function sa(a){return"number"===typeof a?[[0,a],[1,a]]:a}function ta(a,b){let c=0,d=0;for(let e=0;e<a.length;++e){let f=b(e/(a.length-1)),g=a[e],h=g*f[0]+c;a[e]=h;c=g*f[1]-h*f[3]+d;d=g*f[2]-h*f[4]}return a}
function ua(a,b,c=Math.SQRT1_2){let d=new E(sa(b),!0),e=new E(sa(c));return ta(a,f=>{{var g=D(d,f);var h=D(e,f);g=1/Math.tan(Math.PI*g/B);f=g*g;h=1/h;let l=1/(1+h*g+f);g=[l,2*l,l,2*l*(1-f),l*(1-h*g+f)]}return g})}function I(a,b,c=Math.SQRT1_2){let d=new E(sa(b),!0),e=new E(sa(c));return ta(a,f=>{{var g=D(d,f);var h=D(e,f);g=1/Math.tan(Math.PI*g/B);f=g*g;h=1/h;let l=1/(1+h*g+f);g=[l*g*h,0,-l*g*h,2*l*(1-f),l*(1-h*g+f)]}return g})}
function J(a,b){a=new Float32Array(a*B);for(let c=0;c<a.length;c++)a[c]=b(c/a.length,c/B);return a}function K(a,b){b=new E(b);for(let c=0;c<a.length;c++)a[c]*=D(b,c/a.length);return a}async function L(a){a=a();Array.isArray(a)||(a=[a]);let b=y.createBuffer(a.length,a[0].length,B);for(let c=0;c<a.length;c++)b.getChannelData(c).set(a[c]);await ra();return b}function va(){return I(K(J(.2,H),[[0,0,.5],[.1,.3,.2],[1,0]]),[[0,2E3,.2],[1,800]])}
function wa(a,b,c,d=!1){Array.isArray(a)||(a=[a]);Array.isArray(b)||(b=[b]);for(let e=0;e<b.length;e++){let f=a[e%a.length],g=b[e%b.length],h=Math.min(c+f.length,g.length);for(let l=c;l<h;l++)g[l]=d?f[l-c]:g[l]+f[l-c]}}function xa(a){let b=0,c=[],d=0;a.forEach(([e,...f])=>{e<d&&(b+=4);d=e;c.push([b+e,...f])});return c}function M(a,b,c,d,e=!1){let f={};a.forEach(g=>{let h=g.slice(1).join("|");f[h]||(f[h]=c(440*2**(g[1]/12),...g.slice(2)));wa(f[h],b,Math.round(B*g[0]*60/d),e)})}
function N(a,b){a.forEach(c=>{c[0]+=b});return a}function ya(a,b){for(let c=0;c<a.length-1;c++)a[c][2]=a[c+1][0]-a[c][0];a[a.length-1][2]=b-a[a.length-1][0];return a}function za(a){a.a.forEach(b=>{b.source&&b.source.disconnect();b.source=null})}function Aa(a,b=1){a.a.forEach(c=>{c.Z.linearRampToValueAtTime(0,y.currentTime+b)});setTimeout(()=>za(a),1E3*b)}
function Ba(){var a=Ca;a.a.forEach(b=>{b.source.playbackRate.setValueAtTime(1,y.currentTime);b.source.playbackRate.linearRampToValueAtTime(1E-4,y.currentTime+1)});setTimeout(()=>za(a),1E3)}
class Da{constructor(a,b=null){let c=y.createGain();this.a=a.map(d=>{let e=y.createGain();e.connect(c);if(d.K){let f=y.createGain();f.gain.value=d.K;e.connect(f);f.connect(A)}return{buffer:d.buffer,fa:e,volume:d.volume,Z:e.gain}});this.b=b;c.connect(z)}play(){this.a.forEach(a=>{a.source&&a.source.disconnect();let b=y.createBufferSource();this.b&&(b.loop=!0,b.loopStart=this.b.start,b.loopEnd=a.buffer.duration);b.buffer=a.buffer;b.connect(a.fa);b.start();a.source=b;a.Z.setValueAtTime(1,y.currentTime)})}}
function O(a,b){return()=>{let c=0,d=[[0,0],[.01/b,.2,.5],[1-.01/b,.2,.5],[1,0]];return ua(K(J(b,function(e){c+=440*2**(a[0|e*a.length]/12)/B;return 2*(c%1<.5-.2*e)-1}),d),4200)}}let Ea=O([-2],.1),Fa=O([-2,5],.2),Ga=O([-2,5,10],.3),Ha=O([10,17,10,17,10,5,5,8,8],.5),Ia=O([-2,5,-2,10,5,10,15,10,15,17,15,17,22],.6);function Ja(){function a(){let e=0,f=[];do f.push([e,Math.random()]),e+=.01;while(1>=e);return f}let b=a(),c=a(),d=[[0,0,.5],[.05,1,.2],[1,0]];return[K(K(J(4,H),b),d),K(K(J(4,H),c),d)]}
let Ka=Math.ceil(80*B),La=960/132,Ma=[[0,0],[.001,.12,.35],[.04,.02,.3],[1,0,1]];function Na(a){let b=[[0,Math.min(B/2,18*a),.5],[1,a/3]],c=Math.random();return ua(K(J(4,function(){c+=a/B;return.4*(2*(.5>c%1)-1)+.4*(2*(.55>2*c%1)-1)}),Ma),b,1)}
function Oa(){let a=new Float32Array(Ka),b=N(xa([[0,5],[1,1],[1.5,0],[2,-2],[3,1],[3.5,0],[0,-2],[1.5,1],[2,5],[3,3],[3.5,1],[0,0],[.5,-2],[1,-4],[1.5,-7],[2,3],[3,5],[0,1],[1,-2],[2,0],[2.5,-4],[3,-2],[3.5,-7],[0,-6],[.5,3],[1.5,6],[2,10],[3,8],[3.5,6],[0,5],[1.5,1],[2,5],[3,1],[3.5,0],[0,-2],[1.5,-7],[2,-2],[2.5,1],[3,5],[3.5,3],[0,1],[1,-2],[1.96,-3],[2.04,0],[.5,-2],[1.5,1],[2,5],[3,10],[3.5,8],[0,5],[1.5,1],[2,5],[3,3],[3.5,1],[0,0],[1,1],[1.5,3],[2,5],[2.5,0],[3,-2],[3.5,-3],[0,-2],[1,-7],[2,
-14],[0,5],[0,1],[0,-2],[2,1],[2,-2],[2,-7],[0,3],[0,-2],[0,-6],[2,0],[2,-2],[2,-6],[0,1],[0,-2],[0,-6],[2,-2],[2,-6],[2,-9],[0,-4],[0,-7],[0,-11],[2,0],[2,-4],[2,-7],[0,-6],[0,-11],[1.5,-2],[1.5,-6],[3,1],[3,-4],[0,3],[0,-2],[1,1],[1,-2],[1.5,0],[1.5,-2],[2,1],[2,-4],[3,0],[3,-4],[0,-6],[0,-11],[1.5,-2],[1.5,-6],[3,1],[3,-4],[0,3],[0,0],[1,1],[1,-4],[1.25,0],[1.25,-4],[1.75,0],[1.75,-3],[3,-7],[3,-12],[0,5],[1,1],[1.5,0],[2,-2],[3,1],[3.25,0],[3.75,-2],[.5,-2],[1.25,-2],[1.5,1],[2,5],[3,3],[3.5,
1],[0,0],[.5,-2],[1,-4],[1.25,-7],[2,3],[3,5],[0,1],[1,-2],[2,0],[2.5,-4],[3,-2],[3.25,-7],[3.75,-6],[.5,3],[1.5,6],[2,10],[2.5,10],[3,8],[3.25,6],[3.75,5],[1.5,1],[2,5],[2.5,5],[2.75,1],[3.25,0],[3.75,-2],[.5,-2],[1.25,-2],[1.5,-7],[2,-2],[2.5,1],[3,5],[3.25,3],[3.75,1],[.5,1],[1,-2],[1.96,-3],[2.04,0],[.5,-2],[1.5,1],[2,5],[2.5,5],[3,10],[3.25,8],[3.75,5],[.5,5],[1.25,5],[1.5,1],[2,5],[2.5,5],[3,3],[3.25,1],[3.75,0],[.5,0],[1,1],[1.5,3],[2,5],[2.5,0],[3,-2],[3.25,-3],[0,-2],[1,-7],[1.5,-6],[1.75,
-7],[2,-14],[0,5],[0,1],[0,-2],[2,1],[2,-2],[2,-7],[0,3],[0,-2],[0,-6],[2,0],[2,-2],[2,-6],[0,1],[0,-2],[0,-6],[2,-2],[2,-6],[2,-9],[0,-4],[0,-7],[0,-11],[2,0],[2,-4],[2,-7],[0,-6],[0,-11],[1.5,-2],[1.5,-6],[3,1],[3,-4],[0,3],[0,-2],[1,1],[1,-2],[1.25,0],[1.25,-2],[1.75,0],[1.75,-2],[3,-4],[3,-7],[0,-6],[0,-11],[1.5,-2],[1.5,-6],[3,1],[3,-4],[0,3],[0,0],[1,1],[1,-4],[1.5,0],[1.5,-4],[2,0],[2,-3],[2,-7],[3,-7],[3,-12],[3,-15]]),16);M(b,a,Na,132);return a}
let Pa=[[0,0,1],[.005,.06,.5],[.05,.015,.1],[1,0,1]];function Qa(a){let b=0;return ua(K(J(2,function(){b+=a/B;return 2*(.5>b%1)-1}),Pa),9500)}let Ra=[[0,1,3],[.25,0,1/3],[.5,-1,3],[.75,0,1/3],[1,1]];function Sa(a,b){let c=1/(1E3*b),d=[[0,0,2],[2*c,1,20],[1-2*c,.5],[1,0]],e=[[0,.055],[1,.055*Math.max(0,1-b/3)]],f=0,g=new E([[0,7,2],[15*c,0]]),h=new E(Ra);return K(K(J(b,function(l){f+=a*2**(D(g,l)/12)/B;1<f&&(--f,h.b=0);return D(h,f)}),e),d)}
let Ta=N(xa([[0,-26],[2,-26],[3.5,-23],[0,-30],[2,-30],[0,-28],[1.5,-28],[2,-31],[3,-31],[0,-26],[1.5,-26],[2,-26],[3,-28],[3.5,-34],[0,-33],[2,-33],[3.5,-33],[0,-23],[1.5,-23],[2,-23],[3,-23],[0,-21],[1,-21],[2,-24],[3,-24],[3.5,-23],[0,-31],[1,-31],[2,-31],[3.5,-26],[0,-30],[1.5,-30],[2,-30],[0,-28],[1.5,-28],[2,-28],[0,-27],[1,-27],[2,-31],[3,-31],[0,-26],[1,-31],[2,-26],[0,-26],[2,-26],[0,-26],[2,-26],[0,-26],[2,-26],[0,-35],[2,-31],[0,-30],[2,-28],[0,-26],[2,-28],[0,-30],[2,-30],[0,-28],[2,-27],
[0,-26],[2,-26],[3.5,-23],[0,-30],[2,-30],[0,-28],[1.5,-28],[2,-31],[3,-31],[0,-26],[1.5,-26],[2,-26],[3,-28],[3.5,-34],[0,-33],[2,-33],[3.5,-33],[0,-23],[1.5,-23],[2,-23],[3,-23],[0,-21],[1,-21],[2,-24],[3,-24],[3.5,-23],[0,-31],[1,-31],[2,-31],[3.5,-26],[0,-30],[1.5,-30],[2,-30],[0,-28],[1.5,-28],[2,-28],[0,-27],[1,-27],[2,-31],[3,-31],[0,-26],[1,-31],[2,-26],[0,-26],[.5,-26],[1,-26],[1.5,-26],[2,-26],[2.5,-26],[3,-26],[3.5,-23],[0,-30],[.5,-30],[1,-30],[1.5,-30],[2,-30],[2.5,-30],[3,-30],[3.5,
-26],[0,-33],[.5,-33],[1,-33],[1.5,-33],[2,-33],[2.5,-33],[3,-33],[3.5,-33],[0,-35],[.5,-35],[1,-35],[1.5,-35],[2,-31],[2.5,-31],[3,-31],[3.5,-31],[0,-30],[.5,-30],[1,-30],[1.5,-30],[2,-28],[2.5,-28],[3,-28],[3.5,-28],[0,-26],[.5,-26],[1,-26],[1.5,-26],[2,-28],[2.5,-28],[3,-28],[3.5,-28],[0,-30],[.5,-30],[1,-30],[1.5,-30],[2,-30],[2.5,-30],[3,-30],[3.5,-30],[0,-28],[.5,-28],[1,-28],[1.5,-28],[2,-27],[2.5,-27],[3,-27],[3.5,-27]]),16);
function Ua(){let a=new Float32Array(Ka);M(ya(Ta,176),a,Sa,132,!0);return a}
function Va(){let a=new Float32Array(Ka);M([...Ta,...xa([[0,-14],[.5,-7],[.5,-2],[1.5,-7],[1.5,-2],[2,-14],[2.5,-7],[2.5,-2],[3.5,-14],[3.5,-7],[3.5,-2],[0,-18],[.5,-11],[.5,-7],[1.5,-11],[1.5,-7],[2,-18],[2.5,-11],[2.5,-7],[3.5,-11],[3.5,-7],[0,-16],[.5,-12],[.5,-9],[1.5,-16],[1.5,-12],[1.5,-9],[2,-19],[2.5,-12],[2.5,-9],[3,-19],[3.5,-12],[3.5,-9],[0,-14],[.5,-11],[.5,-7],[1,-19],[1.5,-11],[1.5,-7],[2,-26],[3.5,10],[3.667,12],[3.833,13],[.5,-7],[.5,-2],[1.5,-7],[1.5,-2],[2.5,-7],[2.5,-2],[3.5,-7],
[3.5,-2],[.5,-11],[.5,-7],[1.5,-11],[1.5,-7],[2.5,-11],[2.5,-7],[3.5,-11],[3.5,-7],[.5,-12],[.5,-9],[1.5,-12],[1.5,-9],[2.5,-12],[2.5,-9],[3.5,-12],[3.5,-9],[.5,-11],[.5,-7],[1.5,-11],[1.5,-7],[2.5,-11],[2.5,-7],[3.5,-11],[3.5,-7],[.5,-14],[.5,-9],[1.5,-14],[1.5,-9],[2.5,-14],[2.5,-9],[3.5,-14],[3.5,-9],[.5,-7],[.5,-4],[1.5,-7],[1.5,-4],[2.5,-7],[2.5,-4],[3.5,-7],[3.5,-4],[.5,-6],[.5,-2],[1.5,-6],[1.5,-2],[2.5,-6],[2.5,-2],[3.5,-6],[3.5,-2],[.5,-7],[1,-2],[1.5,-7],[2.5,-7],[3,-7],[3,-3],[3.5,-3],
[3.5,0],[.5,-6],[.5,-2],[.5,1],[1.5,-6],[1.5,-2],[1.5,1],[2.5,-6],[2.5,-2],[2.5,1],[3.5,-6],[3.5,-2],[3.5,1],[.5,-4],[.5,0],[.5,3],[1.5,-4],[1.5,0],[1.5,3],[2.5,-4],[2.5,0],[2.5,3],[3.5,-4],[3.5,0],[3.5,3],[.5,-3],[.5,0],[.5,3],[1.5,-3],[1.5,0],[1.5,3],[2.5,-3],[2.5,1],[2.5,5],[3.5,-3],[3.5,1],[3.5,5],[0,1],[0,5],[1,-3],[1,0],[2,-7],[1,-7],[1,-2],[3,-7],[3,-2],[1,-6],[1,-2],[3,-6],[3,-2],[1,-6],[1,-2],[3,-6],[3,-2],[1,-4],[1,0],[3,-4],[3,0],[1,-2],[1,1],[3,0],[3,3],[1,1],[1,5],[3,0],[3,3],[1,-2],
[1,1],[3,-2],[3,1],[1,-4],[1,1],[1,5],[3,-3],[3,0],[3,5],[3.5,10],[3.667,12],[3.833,13],[.5,-7],[.5,-2],[1.5,-7],[1.5,-2],[2.5,-7],[2.5,-2],[3.5,-7],[3.5,-2],[.5,-11],[.5,-7],[1.5,-11],[1.5,-7],[2.5,-11],[2.5,-7],[3.5,-11],[3.5,-7],[.5,-12],[.5,-9],[1.5,-12],[1.5,-9],[2.5,-12],[2.5,-9],[3.5,-12],[3.5,-9],[.5,-11],[.5,-7],[1.5,10],[1.5,-11],[1.5,-7],[1.667,12],[1.833,13],[2,12],[2.5,-11],[2.5,-7],[2.5,8],[3,10],[3.25,5],[3.5,-11],[3.5,-7],[3.75,6],[.5,-14],[.5,-9],[1.5,-14],[1.5,-9],[2.5,-14],[2.5,
-9],[3.5,-14],[3.5,-9],[.5,-7],[.5,-4],[1.5,-7],[1.5,-4],[2.5,-7],[2.5,-4],[3.5,-7],[3.5,-4],[.5,-6],[.5,-2],[1.5,-6],[1.5,-2],[2.5,-6],[2.5,-2],[3.5,-6],[3.5,-2],[.5,-7],[1,-2],[1.5,-7],[2.5,-7],[3,-7],[3,-3],[3.5,-3],[3.5,0],[.5,-6],[.5,-2],[.5,1],[1.5,-6],[1.5,-2],[1.5,1],[2.5,-6],[2.5,-2],[2.5,1],[3.5,-6],[3.5,-2],[3.5,1],[.5,-4],[.5,0],[.5,3],[1.5,-4],[1.5,0],[1.5,3],[2.5,-4],[2.5,0],[2.5,3],[3.5,-4],[3.5,0],[3.5,3],[.5,-3],[.5,0],[.5,3],[1.5,-3],[1.5,0],[1.5,3],[2.5,-3],[2.5,1],[2.5,5],[3.5,
-3],[3.5,1],[3.5,5],[0,1],[0,5],[1,-3],[1,0],[2,-7],[3.5,10],[3.667,12],[3.833,13],[1,-7],[1,-2],[3,-7],[3,-2],[1,-6],[1,-2],[3,-6],[3,-2],[1,-6],[1,-2],[3,-6],[3,-2],[1,-4],[1,0],[3,-4],[3,0],[1,-2],[1,1],[3,0],[3,3],[1,1],[1,5],[3,0],[3,3],[1,-2],[1,1],[3,-2],[3,1],[1,-4],[1,1],[1,5],[3,-3],[3,0],[3,5],[3.5,10],[3.667,12],[3.833,13]])],a,Qa,132);return a}
async function Wa(){let [a,b,c]=await Promise.all([Oa,Va,Ua].map(d=>L(d)));return new Da([{buffer:a,K:.5},{buffer:b,K:.5},{buffer:c}],{start:La})}let Xa=Math.ceil(1219.98/120*B);
function Ya(){let a=new Float32Array(Xa);M([[0,-6],[.167,-4],...N([[0,-2],[1,-2],[1.333,-2],[1.667,-2],[2,0],[2.5,0],[2.667,-4],[2.833,-9],[3,0],[3.667,3],[4,5],[4,10],[5,5],[5,10],[5.667,2],[5.833,3],[6,5],[7.667,2],[7.833,3],[8,5],[8.333,10],[8.667,8],[9,5],[9.667,3],[10,5],[10.333,3],[10.667,5],[11,2],[11.667,-4],[12,-14],[12.167,-7],[12.25,-2],[12.333,0],[12.5,2]],.333)],a,Na,120);return a}
function Za(){let a=new Float32Array(Xa);var b=[[0,-18],[1,-18],[1.333,-18],[1.667,-18],[2,-16],[3,-16],[3.667,-16],[4,-14],[8,-14],[9,-16],[10,-17],[11,-19]];for(let c=0,d=b.length;c<d;c++){let [e,f,...g]=b[c];b.push([e,f+12,...g])}b=[...b,[4.333,5],[4.667,10],[5,14],[5.333,10]];M(N(b,.333),a,Qa,120);return a}
function $a(){let a=new Float32Array(Xa);M(ya(N([[0,-30],[1,-30],[1.333,-30],[1.667,-30],[2,-28],[3,-28],[3.667,-28],[4,-26],[8,-26],[9,-28],[10,-29],[11,-31],[12.25,-26]],.333),20.333),a,Sa,120,!0);K(a,[[0,1],[.9,1],[1,0]]);return a}async function ab(){let [a,b,c]=await Promise.all([Ya,Za,$a].map(d=>L(d)));return new Da([{buffer:a,K:.5},{buffer:b,K:.5},{buffer:c}])}
var bb={J:"data:image/gif;base64,R0lGODlh8AAGAIAAAP///////yH5BAEAAAEALAAAAADwAAYAAALXjAOny4ngTHwRuivthdn244FgSHWbp52SWJrI+ipVHIfaeFboPfeiv0oFWYwFBsaBvYBHYoOWmC2V0Z9VZsxSi1Xp6AGeDsfiMnYLrKmVtG3xDHU6c1EbiZpM1/PaZbJdU+WW9QfYNSVYlrj4QaSH6BhJyHPD5jVxZ/nktRbIIZSGZvTXUwk4xBm3oWqDmBnnJnioSNrH9gR32Ye5KQl7pagKfPs4KEsMzDgR+GvMcjz7yzuIO6pD1/hMcodJyhe0nWeH0vDtiYPGk9y4TKHMLVPI23SpUQAAOw=="},cb={J:"data:image/gif;base64,R0lGODlh0wASAIAAAP///wAAACH5BAEAAAEALAAAAADTABIAAAL/BIKpYdv8IDQU0fjukSmuflmbqJFZKU7op46au2HHO8dwatqguTsjHpLQWidiTeH5DD3LlzFF+yGdT05F6DzprNmbqjf15bBKDPTGlIrP4TUZ+EuWXTguryHXHrl0Ga8OBtcyCJLG8QZYpljoxyYY+PVXV4SFp1YUJKOZGWXYpkfIuNPUxnIYuNKE4inaWkVZkbp1laZH2xknRTlxalHoU8LK4iecYxk0rObwS9RDjLwL+9uYPAeb+zSEeMytrNptOWqzlWh9W30YvtZoq25XyjiLrS2bXhOLDGybjeZVnHyl1yNEzvzBODewnKmFDBs6fAgxosSJFCtalBgCHK6N4RyDdfwIMmQUIyJL4jOJMuDFlSxbunwJM6bDPgx8jaNTs4MrXRlVRsrp6yfQMfSgjQkaz9VPXZKayiRzZMbQGJOQ5mSKRKdVqlpxDv2qNezVrVbBxiFrD6lXsDCluhXClipXb8uydrV7Fuhatl/zcg2K1W5dwDWl6hWr7CVNuZLmjuXV18zdyYBXAVOiD2eqy2IRE75quXPMxTYxP7aCdzBav6kpl+3MOq7q11PL/j3N9ynD2LE/w27tG/dtvoEf0xXsuXbf1ch1QzSqfOmtk7VybTp4M2/y4X9kVf8dSujTAgA7",
L:[{x:0,y:0,s:52,o:10,v:26,w:4},{x:53,y:0,s:67,o:10,v:33,w:4},{x:121,y:0,s:45,o:10,v:22,w:4},{x:0,y:11,s:14,o:5,v:7,w:3},{x:15,y:11,s:38,o:7,v:19,w:3},{x:54,y:11,s:43,o:7,v:21,w:3},{x:98,y:11,s:39,o:7,v:19,w:3},{x:139,y:11,s:39,o:7,v:19,w:3},{x:167,y:0,s:44,o:10,v:22,w:4}]},db={J:"data:image/gif;base64,R0lGODlhEQAIAPD/AAAAAP///yH5BAUAAAIALAAAAAARAAgAAAIclIBgywsBg2rsRTjpuVgbe03ZsXFZcoZelaxGAQA7",L:[{x:0,y:0,s:8,o:8,v:4,w:4},{x:9,y:0,s:8,o:8,v:4,w:4},{x:18,y:0,s:8,o:8,v:4,w:4}]},eb={J:"data:image/gif;base64,R0lGODlhTwArAIAAAP///wAAACH5BAEAAAEALAAAAABPACsAAAL/jI+pywcNo5y0vYqzjnf7CoTiSJbmeX5Up2ZsC8eyZc5LKoeMbge88vtccK/WsOZTPVDMptOZ3CxFPSm1KJlWYTosJLg1enfjsBVEppod6tvE+yrHWGN53dddT/O7BAkPJWcEGDiCULYXFba39NVn4adHqOhW+eiwRmlnaYDE9ifUNvkZB3Qo5UHniMl62ooh6GYIN9lRpKoRazrbhwL4qhuZW9t79drp6oLKK2uMLEwqSigNG2XbhvsMzUnJhZ1seCyerJ1zyny5vcs3o4rOTR7p3H4+bwpZ3Gjjbq9+fz8kzRM1pZLcySKQ1rBb1Mal8+fwjUJ4HB5GHEQxyy0gIsFobPTTkaOtT+Z+aWuYqgsYLiATLXqZcR/Mf2ZCoonZoAAAOw==",
L:[{x:0,y:0,s:79,o:43,v:39,w:0}]},fb={J:"data:image/gif;base64,R0lGODlhMwAuAKIAACKxTKNJpACi6P/yAP9/J////+0cJAAAACH5BAEAAAcALAAAAAAzAC4AAAP/eLpc9o/JSattMMPL+zGYJoIU4Z3OqEpEe3ZqTC7me6XyaL+5vB8DTowx/E0iH91RZKSQVk5N0wKNbi41ntI6o00V1eiklb0EK+FTmUdML7pfdDG+y3EK5PVZsRfaJ3h5LnQ9EoGCgwUDizBLPgqIgnyLfXWPkgeSlJuVYEhcTHkMopybElJUSoM0ZECljG+oqaFrra6MnLGysxuRraaTsG6Ovb4mlAy5c3IZmb7BEqaPzMWYt5XSf6eottGwycg94s4WyN7C4kWrrLcTwEnptLUu5uDf8PFIxjX1C+90APFp8PVqAICDCA8KWMhwYYCHEB8GnLgi0jVTCQ8uaChAbYFEjwE8ySP16kBGjRwXHoC48mOsUWvAMdCoAGVHBSpbstwGs5u/PjRNAjiQk+hNnWJY+Zw086TRjUd38mRX4Z7TpzhvRgw5FRIimQtoIjTKEalUTz1F/WwadijZnC5dTowTg+CrkwpTCtjKMgEAOw==",
L:[{x:0,y:0,s:51,o:46,v:25,w:0}]};function P(a){return new Promise(b=>{let c=new Image;c.onload=()=>{a.S=c;b(a)};c.src=a.J})}
let gb,Q,hb,ib,jb,Ca,kb,lb=L(function(){return I(K(J(.1,H),[[0,.5,.2],[.3,0],[.301,.4,.2],[.5,0],[.501,.35,.2],[1,0]]),1800,3)}),mb=L(function(){return I(K(J(.2,H),[[0,.3,.2],[1,0]]),1800,2)}),nb=L(va),R=L(function(){return I(K(J(.1,H),[[0,.1,.2],[1,0]]),2E3)}),ob=[L(Ea),L(Fa),L(Ga),L(Ia)],pb=L(function(){return I(K(J(.2,H),[[0,.2,.2],[1,0]]),2E3)}),qb=L(va),rb=L(function(){let a=new E([[0,5],[.3,12],[.6,10]]),b=0;return K(J(.25,function(c){c=D(a,c);c=b+=440*2**(c/12)/B;c%=1;return Math.sin(2*Math.PI*
(3-2*c)*c*c)}),[[0,0,.1],[.3,.3,20],[.5,0],[.6,0,.1],[.8,.3],[1,0]])}),sb=L(Ha);async function tb(){let a=y.createConvolver(),b=Ja(),c=y.createBuffer(2,b[0].length,B);c.getChannelData(0).set(b[0]);c.getChannelData(1).set(b[1]);a.buffer=c;A=y.createGain();A.gain.value=.7;A.connect(a);a.connect(z);await ra()}let S,T=0,ub=0,U=1;
class vb{constructor(a,b){this.a=a;this.f=b}i(){this.C();{var a=this.f,b=this.a;let c=a.h.get(b);for(let [d,e]of c)a.a[e][d]=0;wb(a,b)}this.P&&this.f.P(this.a)}move(a,b){this.a.move(a,b);if(xb(this.f,this.a))return this.a.move(-a,-b),!1;this.O=0;return!0}H(){let a=this.a.da();this.a.H();for(let b of a){this.a.move(b[0],b[1]);if(!xb(this.f,this.a))return this.O=1,!0;this.a.move(-b[0],-b[1])}this.a.I();return!1}I(){let a=this.a.ea();this.a.I();for(let b of a){this.a.move(b[0],b[1]);if(!xb(this.f,this.a))return this.O=
1,!0;this.a.move(-b[0],-b[1])}this.a.H();return!1}}function yb(a){14>a.l?(a.b=30,a.l++):(C(nb),a.done=!0)}
class zb extends vb{constructor(a,b){super(a,b);this.m=k[37]||k[39]?0:12;this.A=0;this.g=60*(.8-.007*(U-1))**(U-1);this.l=0;this.b=-1;this.h=this.g;this.c=0;this.G=!1;this.O=null}C(){this.g=60*(.8-.007*(U-1))**(U-1);let a=this.a.x,b=this.a.u;var c=k[37]?-1:k[39]?1:0;c&&(r(37)||r(39)?(this.move(c,0)&&C(R),this.m=12):0>=this.m&&0>=this.A&&(this.move(c,0)&&C(R),this.A=2),this.m--,this.A--);c=this.a instanceof qa;r(90)?(c||this.H())&&C(lb):r(88)&&(c||this.I())&&C(lb);if(r(32)){for(c=0;this.move(0,-1);)c++;
T+=2*c;C(pb);this.done=!0}else{c=0;r(40)&&(this.c=0);var d=!1;if(this.g<1/this.f.height)c=this.f.height;else{if(d=!!k[40])for(this.c--;0>=this.c;)c++,this.c+=this.g/30;for(this.h--;0>=this.h;)d||c++,this.h+=this.g}var e=0;for(let f=0;f<c&&this.move(0,-1);f++)e++;0<e&&(0<this.l&&this.l--,d&&(T+=e,C(R)))}this.move(0,-1)?(this.move(0,1),c=void 0):c=!0;c&&!this.G&&C(mb);c||(this.b=0);!c||a===this.a.x&&b===this.a.u||yb(this);c&&0>=this.b&&yb(this);0<this.b&&(this.b--,c?0===this.b&&(C(nb),this.done=!0):
this.b=0);this.G=c}}class V{constructor(a){this.g=a;this.b=this.a=0}i(){this.a++;this.b=this.a/this.g;this.a===this.g&&(this.done=!0)}}class Ab extends V{constructor(a,b){super(30);this.c=a;this.rows=b}j(){let a=20>this.a?this.a:0;u.fillStyle=20>this.a?`rgba(255,255,255,${this.a/15})`:"#000";for(let b of this.rows)u.fillRect(-a,16*(this.c.ga-1-b),this.c.width+2*a,16)}}class Bb{constructor(a){this.a=a;this.b=0}N(){return this.b?ca[this.a]:ba[this.a]}i(){this.b=1}}let Cb=new Bb(1);
function xb(a,b){for(let [c,d]of b.B()){if(0>c||c>=a.width||0>d)return!0;if(d>=a.a.length)continue;let e=a.a[d][c];if(e&&e!==b)return!0}return!1}function W(a,b,c){return 0>b||b>=a.width||0>c?Cb:a.a[c][b]}function Db(a,b){return a.a[b].every(c=>!c)}function Eb(a,b){return a.a[b].every(c=>c)}function Fb(a,b){if(a.a[a.height+2].some(c=>c))return!0;b=b.B();for(let [c,d]of b)if(a.a[d+a.height][c+a.width/2-1])return!0;return!1}
function wb(a,b){let c=[];for(let [d,e]of b.B())a.a[e][d]=b,c.push([d,e]);a.h.set(b,c);a.g.add(b);a.b.add(b)}function Gb(a,b,c){for(let d=0;d<a.width;d++){let e=a.a[b][d];e&&c(e)}}function Hb(a,b){b.sort((e,f)=>e-f);let c=new Map,d=0;for(let e=0;e<a.c;e++)e===b[d]?(Gb(a,e,f=>{f instanceof Bb&&a.b.delete(f)}),d++):(Gb(a,e,f=>{f instanceof na&&c.set(f,d)}),a.a[e-d]=a.a[e]);for(let [e,f]of c)e.y-=f,wb(a,e);for(b=a.c-d;b<a.c;b++)a.a[b]=Array(a.width).fill(0)}
function Ib(a,b){let c=new Set;for(let d of b)Gb(a,d,e=>{e instanceof na&&c.add(e)});return c}class Jb{constructor(a,b){this.width=a;this.height=b;this.c=this.height+4;this.a=[];for(a=0;a<this.c;a++)this.a.push(Array(this.width).fill(0));this.g=new Set;this.b=new Set;this.h=new Map}P(a){this.g.delete(a);this.b.delete(a);this.h.delete(a);for(let [b,c]of a.B())this.a[c][b]=0}}let Kb={".":[0,2],":":[2,2],"!":[4,2],"+":[6,6],"-":[12,6],",":[18,3]};
function X(a,b,c,d=1,e=0){let f=0,g=0;for(let h=0;h<a.length;h++)if(" "===a[h])f+=6+e;else if("\n"===a[h])f=0,g+=8;else{let l=Kb[a[h]],n,F=6;l?(n=l[0],F=l[1]):n="A">a[h]?25+6*(a.charCodeAt(h)-48):85+6*(a.charCodeAt(h)-65);u.drawImage(gb.S,n,0,F-1,6,b+d*f,c+d*g,d*(F-1),6*d);f+=F+e}}function Y(a,b,c,d=1){X(a,b,c,d,1);X(a,b+d,c,d,1)}function Lb(a,b,c){X(a,b-6*a.length/2,c,1)}function Mb(a,b){Y(a,-(0|7*a.length/2),b,1)}function Nb(a){a.a=0;a.l.push(new Ab(a.c,[a.m]));a.m++}
class Ob extends V{constructor(a,b){super(b?120:200);this.C=b;this.c=a;this.m=0;this.l=[];Nb(this);this.A=new E([[0,0],[.4,0,2],[.45,2.5,1.5],[.5,2]])}i(){super.i();2<this.a&&this.m<this.c.f.height&&Nb(this);this.h++;this.l.forEach(a=>{a.i()})}j(){this.l.forEach(a=>a.j());if(10<this.a){let a=this.c.width/2,b=D(this.A,(this.a-10)/60);this.C||v(Q,a,112,8,b,b);this.a>=this.g&&30>(this.a-this.g)%60&&(Lb("PRESS ANY BUTTON",a,160),Lb("TO START A NEW GAME",a,167))}}}
class Pb extends V{constructor(a){super(30);this.c=a;this.x=60*Math.random()}j(){this.done||(u.globalAlpha=1-this.b**2,X((0<this.c?"+":"")+this.c,20+this.x,294-this.a/2,2),u.globalAlpha=1)}}class Qb extends V{constructor(){super(120);this.c=new E([[0,0],[.1,0,2],[.2,1.3,1.5],[.3,1],[.9,1,2]])}j(){if(!this.done){var a=D(this.c,this.b);X("BACK-TO-BACK",-36*a,150,a)}}}
class Rb extends V{constructor(a){super(120);this.type=a;this.m=[1,2].includes(a);this.c={[3]:2,[1]:2,[2]:2,[4]:2,[5]:2,[6]:2,[10]:0,[11]:1}[a];this.h={[2]:4,[4]:4,[5]:5,[6]:6}[a];void 0===this.c&&(this.done=!0);this.l=new E([[0,0,2],[.1,1.75,1.5],[.2,1],[.9,1,2],[1,1.4]]);this.C=new E([[0,0,6],[.2,1.2,1.5],[.3,1]]);this.A=new E([[0,2===this.c?2*Math.PI:0,.04],[1,0]])}j(){if(!this.done){var a=this.b,b=D(this.l,a),c=D(this.C,a);a=D(this.A,a);this.m&&v(Q,0,100,3,b,b);v(Q,0,112,this.c,b,b,a);this.h&&
v(Q,0,130,this.h,c,c)}}}
let Sb=w(1,[[[-1,0],[0,0],[1,0],[2,0]],[[1,1],[1,0],[1,-1],[1,-2]],[[-1,-1],[0,-1],[1,-1],[2,-1]],[[0,1],[0,0],[0,-1],[0,-2]]],[[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[1,0],[-2,0],[1,-2],[-2,1]]]),Tb=w(3,[[[-1,0],[0,0],[1,0],[1,1]],[[0,1],[0,0],[0,-1],[1,-1]],[[-1,0],[0,0],[1,0],[-1,-1]],[[0,1],[0,0],[0,-1],[-1,1]]],x),Ub=w(2,[[[-1,0],[0,0],[1,0],[-1,1]],[[0,1],[0,0],[0,-1],[1,1]],[[-1,0],[0,0],[1,0],[1,-1]],[[0,1],[0,0],[0,
-1],[-1,-1]]],x),Vb=w(5,[[[-1,0],[0,0],[0,1],[1,1]],[[0,1],[0,0],[1,0],[1,-1]],[[1,0],[0,0],[0,-1],[-1,-1]],[[0,-1],[0,0],[-1,0],[-1,1]]],x),Wb=w(7,[[[1,0],[0,0],[0,1],[-1,1]],[[0,-1],[0,0],[1,0],[1,1]],[[-1,0],[0,0],[0,-1],[1,-1]],[[0,1],[0,0],[-1,0],[-1,-1]]],x);class Xb{constructor(){this.a=[Sb,Tb,Ub,oa,qa,Vb,Wb];for(let a=6;1<a;a--){let b=0|Math.random()*(a+1),c=this.a[b];this.a[b]=this.a[a];this.a[a]=c}}}function Yb(a){let b=a.a.a.pop();return b?new b:(a.a=new Xb,Yb(a))}
class Zb{constructor(){this.a=new Xb}}let $b={"-1":"2",1:"3"};
function Z(a,b=5,c=""){if(0===b)return"";let d=a.a.x,e=a.a.y,f=a.a.u,g=()=>{a.a.x=d;a.a.y=e;a.a.u=f};if(a.move(0,1)&&a.move(0,1))return c+"11";g();if(a.a.M&&a.move(0,1))return c+"1";g();if(a.move(0,1)){var h=Z(a,b-1,c+"1");if(h)return h}g();if(a.move(a.b,0)&&(h=Z(a,b-1,c+$b[a.b])))return h;g();if(a.move(-a.b,0)&&(a.b=-a.b,h=Z(a,b-1,c+$b[a.b])))return h;g();if(!(a.a instanceof qa)){if(a.H()&&(h=Z(a,b-1,c+"5")))return h;g();if(a.I()&&(b=Z(a,b-1,c+"4")))return b;g()}return""}
class ac extends vb{constructor(a,b){super(a,b);this.g=[];this.c=this.h=0;this.m=5<U?1:2;this.l=0;this.b=1}C(){if(!this.done&&(this.a.M=!0,this.h++,this.h===this.m))a:{this.h=0,T+=5*-U;if(this.c<this.g.length){switch(this.g[this.c]){case "1":this.move(0,1);C(R);break;case "2":this.move(-1,0);C(R);break;case "3":this.move(1,0);C(R);break;case "4":this.I();C(lb);break;case "5":this.H(),C(lb)}this.c++}else if(this.move(0,1))C(R);else{if(10<this.l){this.a.M=!1;this.done=!0;break a}this.l++;this.c=0;this.g=
Z(this);break a}this.a.y>this.f.height&&(this.P=this.done=!0)}}}class bc extends V{constructor(a,b){super(120);this.x=a;this.y=b;this.c=H();this.h=H()}i(){super.i();this.c+=.5;this.y+=this.c;this.x+=this.h}j(){v(hb,this.x-4,this.y,0);v(hb,this.x+4,this.y,0)}}class cc{constructor(a){this.a=a}j(){this.a.paused=!0;this.a.j();this.a.paused=!1;ka();u.fillStyle="rgba(0,0,0,0.8)";u.fillRect(0,0,t.width,t.height)}}
class dc extends cc{constructor(a,b=!1){super(a);this.b=b;k={};m={}}i(){if(r(27)||this.b&&ea())S=this.a}j(){super.j();u.setTransform(1,0,0,1,t.width/2,0);u.scale(2,2);Mb("PAUSED",30);u.scale(.5,.5);Mb("INSTRUCTIONS",100);X("YOUR GOAL IS PLAIN AND SIMPLE.\n\nMAKE 200 LINES WITH THE TETROMINOES THAT FALL DOWN\nEITHER AS FAST AS POSSIBLE OR WITH AN END SCORE AS\nHIGH AS POSSIBLE.\nTHERE IS ONE CATCH THOUGH: THESE TETROMINOES WILL\nTRY FLEEING ONCE THEY REALIZE THEIR FATE IS TO BE\nDISINTEGRATED! SO TRY TO NEUTRALIZE THEM BEFORE\nTHEY GO BACK UP.\n\nTRY TO CLEAR AS MUCH LINES AT THE SAME TIME AS\nPOSSIBLE, AND ALSO TRY OUT SOME TRICKS... THEY MIGHT\nREWARD YOU SOME EXTRA POINTS...\n\nGOOD LUCK!",
-150,118);u.setTransform(1,0,0,1,t.width/2-100,248);Mb("KEYBOARD CONTROLS",0);X("UN/PAUSE GAME   - ESC\nHARD DROP       - SPACE\nSOFT DROP       - ARROW DOWN\nROTATE CLOCKW   - ARROW UP/X\nROTATE C CLOCKW - CTRL/Z\nHOLD            - SHIFT/C\n",-83,18);u.setTransform(1,0,0,1,t.width/2+100,248);Mb("GAMEPAD CONTROLS",0);v(ib,0,22);X("HOLD",-12,15);X("HARD\nDROP",-64,33);X("SOFT\nDROP",-32,66);X("ROTATE\nC.CLOCKW",7,66);X("ROTATE\nCLOCKW",42,36)}}
function ec(a){if(!a.image){a.image=document.createElement("canvas");a.image.width=t.width+80;a.image.height=t.height+80;var b=a.image.getContext("2d");for(let c=0;c<a.image.width;c+=80)for(let d=0;d<a.image.height;d+=80)b.save(),b.translate(c+28,d+20),b.rotate(-Math.PI/4),b.drawImage(jb.S,-25,-20),b.restore();b.fillStyle="rgba(0,0,0,0.85)";b.fillRect(0,0,a.image.width,a.image.height)}}
class fc{constructor(){this.y=this.x=0;this.direction=this.a=Math.PI/3;this.speed=1}i(a){var b=this.speed;a=a?.5:1.08**U;var c=1/30;this.speed=b>a?Math.max(b-c,a):Math.min(b+c,a);b=2*Math.PI;a=(this.a-this.direction)%b;b=2*a%b-a;this.direction+=b/500;.1>Math.abs(b)&&(this.a=Math.random()*Math.PI*2);this.x+=Math.cos(this.direction)*this.speed;this.y+=Math.sin(this.direction)*this.speed;-80>=this.x&&(this.x+=80);-80>=this.y&&(this.y+=80);0<this.x&&(this.x-=80);0<this.y&&(this.y-=80)}j(){u.drawImage(this.image,
this.x,this.y)}}let gc=new fc;function hc(a){200<=ub?ic(a):(jc(a,a.C.shift()),a.C.push(Yb(a.Y)))}function kc(a,b){let c=[];for(var d of b)Eb(a.f,d)&&c.push(d);c.sort((f,g)=>f-g);b=lc(a);d=c.length;let e=mc(a,c);nc(a,b,d,e);0===d?Fb(a.f,a.C[0])?(a.b=new Ob(a,!0),Ba()):hc(a):(oc(a,c),a.a=null)}
function pc(a){for(var b=0;b<a.f.height;b++)for(var c=0;c<a.f.width;c++){var d=W(a.f,c,b);d&&qc(c,19-b,d.N(),16,d instanceof Bb)}if(!a.b){for(var e of a.f.g)rc(e);if(a.a){b=sc;c=a.a;d=a.a.B();e=[0,0,0,0];for(let f=0;4>f;f++){let [g,h]=d[f];for(let l=0;l<=h;l++){let n=W(a.f,g,h-l);if(n&&n!==a.a)break;else e[f]=l}}d=-Math.min(...e);b(a,c,d,16,19);tc(a.a,16,19)}}a.c&&a.c.j();a.b&&a.b.j();for(let f of a.R)f.j()}
function uc(a){let b=0|a.time/60%1*100;a=0|a.time/60;let c=0|a/60;return`${G(0|a/3600,2)}:${G(c%60,2)}:${G(a%60,2)}.${G(b,2)}`}function vc(a){let b=8;for(let c=0;c<a.C.length;c++)tc(a.C[c],b,3),0===c?(u.translate(0,5*b),b*=.75):u.translate(0,4*b)}function sc(a,b,c,d,e){a=b.B();b=b.N();a.forEach(f=>f[1]+=c);for(let [f,g]of a)wc(f,e-g,b,d)}function tc(a,b,c){let d=a.B(),e=a.N();for(let [f,g]of d)qc(f,c-g,e,b);16===b&&rc(a)}
function lc(a){if(!(a.a instanceof oa)||1!==a.controller.O)return!1;let b=a.a.x,c=a.a.y,d=[!!W(a.f,b-1,c+1),!!W(a.f,b+1,c+1),!!W(a.f,b+1,c-1),!!W(a.f,b-1,c-1)];if(1< !d[0]+!d[1]+!d[2]+!d[3])return!1;a=[W(a.f,b-1,c)===a.a,W(a.f,b,c+1)===a.a,W(a.f,b+1,c)===a.a,W(a.f,b,c-1)===a.a];return 2>[d[0]+a[1]+d[1],d[1]+a[2]+d[2],d[2]+a[3]+d[3],d[3]+a[0]+d[0]].filter(e=>3===e).length?1:3}function mc(a,b){for(b=b.length;20>b;b++)if(!Db(a.f,b))return!1;return!0}
function nc(a,b,c,d){T+=50*U*a.m;ub+=c;U=0|ub/10+1;b&&C(rb,1,!0);d?(xc(a,11),C(sb,1,!0),T+=1500*U):0<c&&(C(ob[c-1],1,!0),a.V&&4===c?(a.l=new Qb,T+=1200*U):T+={1:100,2:300,3:500,4:800}[c]*U,xc(a,6+c));3===b?(a.V&&0<c?(a.l=new Qb,T+=600*(c+1)*U):T+=400*(c+1)*U,xc(a,3+c)):1===b&&(T+=U*(c+1)*100,xc(a,1+c));a.W||(0<c?(a.m++,a.V=b||4===c):a.m=0)}
function oc(a,b){a.c=new Ab(a,b);var c=Ib(a.f,b),d=a.f;for(var e of c){for(let [n,F]of e.B())d.a[F][n]=new Bb(e.ca()),d.b.add(d.a[F][n]);d.g.delete(e);d.b.delete(e)}for(var f of c){let [n,F]=f.B()[1];a.R.add(new bc(16*(n+.5),16*(19-F+.5)))}d=new Set;for(var g of b)for(b=0;10>b;b++)d.add(`${b}:${g}`);for(var h of c)for(let [n,F]of h.B())d.add(`${n}:${F}`);g=1E3;c=-1E3;for(l of d)h=Number(l.split(":")[1]),g=Math.min(h,g),c=Math.max(h,c);var l=new Set;for(--g;g<=c+1;g++)for(h=0;10>h;h++)if(!d.has(`${h}:${g}`)&&
(b=W(a.f,h,g),b instanceof na))for(e=[`${h-1}:${g}`,`${h+1}:${g}`,`${h}:${g-1}`,`${h}:${g+1}`],f=0;4>f;f++)if(d.has(e[f])){l.add(b);break}d=new Set;for(let n of l)n.T&&d.add(n),n.T=!0,l=n,l.D=[0,2],l.a=30,l.b=1;a.ba=d}function xc(a,b){b&&(a.A=new Rb(b))}function ic(a){a.b=new Ob(a);Aa(Ca);setTimeout(()=>kb.play(),700)}function qc(a,b,c,d=16,e=!1){u.fillStyle=c;u.fillRect(a*d,b*d,d-1,d-1);e||(u.fillStyle="rgba(255,255,255,0.5)",u.fillRect(a*d,b*d,2,d),u.fillRect(a*d,b*d,d,2))}
function rc(a){u.fillStyle="#000";let [b,c]=a.B()[1],d=16*(19-c+.5),e=16*(b+.25),f=16*(b+.75);if(a.M)a.F=0,a.D=[0,-2];else if(a.T){a.F=0;let g=2*Math.random()-1;e+=g;f+=g;d+=2*Math.random()-1}v(hb,e,d,a.F);v(hb,f,d,a.F);0===a.F&&(u.fillRect(e-1+a.D[0],d-1+a.D[1],2,2),u.fillRect(f-1+a.D[0],d-1+a.D[1],2,2))}function jc(a,b){a.a=b;b.x=a.f.width/2-1;b.y=a.f.height-2;for(b.D=[0,2];xb(a.f,b);)b.move(0,1);wb(a.f,b);a.controller=new zb(b,a.f)}
function wc(a,b,c,d=16){u.fillStyle=c;u.fillRect(a*d,b*d,d-1,d-1);u.fillStyle="#000";u.fillRect(a*d+1,b*d+1,d-3,d-3)}
class yc{constructor(){k={};m={};ub=T=0;U=1;this.ga=20;this.time=0;this.f=new Jb(10,20);this.width=160;this.height=320;this.V=!1;this.m=0;this.h=new Set;this.G=[];this.R=new Set;u.lineWidth=2;this.U=gc;ec(this.U);this.Y=new Zb;this.g=null;this.C=Array.from(Array(6),()=>Yb(this.Y));hc(this);this.X=!1;this.aa=Array.from(Array(20),(a,b)=>b)}i(){this.X||(this.X=!0,Aa(kb,.1),Ca.play());if(r(27))S=new dc(this);else{if(!this.b)this.time++;else if(this.b.done&&ea()){S=new yc;return}this.A&&!this.A.done&&
this.A.i();this.l&&!this.l.done&&this.l.i();this.U.i(this.b);if(this.c&&!this.c.done)this.c.i();else{this.b&&this.b.i();for(var a of this.R)a.i(),a.done&&this.R.delete(a);for(var b of this.G)b.i();for(var c of this.f.b)c.i()}if(this.c){if(this.c.done){Hb(this.f,this.c.rows);this.c=null;var d,e=this.ba,f=new Set;for(d of e){e=new ac(d,this.f);{a=e;b=a.a.x;c=a.a.y;let g=a.a.u;a.g=Z(a);a.a.x=b;a.a.y=c;a.a.u=g;a=!!a.g}a&&f.add(e)}this.h=d=f;0<this.h.size?this.a=null:hc(this)}}else{d=T;a=0<this.h.size||
this.b;if(0<this.h.size){for(e of this.h)e.i(),e.done&&this.h.delete(e);0===this.h.size&&(this.W=!0,kc(this,this.aa),this.W=!1)}if(!a)if(r(16)&&!this.controller.$)this.f.P(this.a),this.g&&Fb(this.f,this.g)?(this.b=new Ob(this,!0),Ba()):(C(qb),f=this.g,this.g=this.a,this.g.x=0,this.g.y=0,this.g.u=0,f?jc(this,f):hc(this),this.controller.$=!0);else if(this.controller.i(),this.controller.done){this.a.D=[0,0];e=this.a.B();a=new Set;for(f of e)a.add(f[1]);kc(this,a)}T!==d&&(this.G.push(new Pb(T-d)),4===
this.G.length&&this.G.shift())}}}j(){ka();u.clearRect(0,0,t.width,t.height);this.U.j();u.translate((t.width-160)/2,(t.height-320)/2);u.strokeStyle="#fff";u.fillStyle="#000";la(-1,-1,162,322);this.paused||pc(this);u.translate(185,0);u.fillStyle="#000";la(-16,-1,48,170);X("TIME:",-17,189);Y(uc(this),-17,196);X("LEVEL:",-17,210);Y(G(Math.min(20,U),2),-17,217);X("LINES:",-17,231);Y(G(ub,4),-17,238);X("SCORE:",-17,297);Y(G(T,9),-17,309,2);for(let a of this.G)a.j();this.paused||this.b||vc(this);ka();u.translate((t.width-
160)/2-40,(t.height-320)/2+10);u.fillStyle="#000";la(-17,-11,48,40);Y("HOLD",-6,-8);this.paused||this.b||!this.g||(this.controller.$?(sc(this,this.g,0,8,2),u.fillStyle="rgba(0,0,0,0.5)",u.fillRect(-8,8,32,16)):tc(this.g,8,2));ma(-10,50,()=>{1<this.m&&(v(Q,0,0,7),Y(`${10>this.m?" ":""}${this.m-1}`,-5,7,2));this.A&&this.A.j();this.l&&this.l.j()})}}
class zc extends cc{constructor(a){super(a);this.h=0}i(){ea()&&(S=new dc(this.a,!0));this.h++}j(){super.j();u.setTransform(1,0,0,1,t.width/2,150);v(jb,0,0,0,2,2);30>this.h%60&&Lb("PRESS ANY BUTTON TO START",0,130)}}let Ac=0,Bc=0;function Cc(a){requestAnimationFrame(Cc);let b=Bc?a-Bc:0;Bc=a;Ac+=b;67<1E3/Ac||(Ac=0,a=S,fa(),a.i(),ja(),a.j())}
(async function(){await Promise.all([R,lb,mb,nb,...ob,pb,qb,rb,sb]);[gb,Q,hb,ib,jb]=await Promise.all([P(bb),P(cb),P(db),P(eb),P(fb)]);await tb();[Ca,kb]=await Promise.all([Wa(),ab()]);document.body.classList.remove("l")})().then(function(){S=new zc(new yc);requestAnimationFrame(Cc)});
</script></body></html>