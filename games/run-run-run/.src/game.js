function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t){i.d(s,r,function(e){return t[e]}.bind(null,r))}return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var s=/*#__PURE__*/function(){function s(t,e,i,_s){if(t===void 0){t=0}if(e===void 0){e=0}if(i===void 0){i=0}if(_s===void 0){_s=0}this.left=t,this.top=e,this.right=i,this.bottom=_s}s.from=function from(_ref){var _ref$x=_ref.x,t=_ref$x===void 0?0:_ref$x,_ref$y=_ref.y,e=_ref$y===void 0?0:_ref$y,_ref$width=_ref.width,i=_ref$width===void 0?0:_ref$width,_ref$height=_ref.height,r=_ref$height===void 0?0:_ref$height;return new s(t,e,t+i,e+r)};var _proto=s.prototype;_proto.collides=function collides(t){var e=0;e=this.left<t.left?t.right-this.left:this.right-t.left;var i=0;return i=this.top<t.top?t.bottom-this.top:this.bottom-t.top,this.width+t.width>=e&&this.height+t.height>=i};_createClass(s,[{key:"x",get:function get(){return this.left},set:function set(t){this.right=t+this.width,this.left=t}},{key:"y",get:function get(){return this.top},set:function set(t){this.bottom=t+this.height,this.top=t}},{key:"width",get:function get(){return this.right-this.left},set:function set(t){this.right=this.left+t}},{key:"height",get:function get(){return this.bottom-this.top},set:function set(t){this.bottom=this.top+t}}]);return s}();var r={VK_START:!1,VK_PAUSE:!1,VK_UP:!1,VK_RIGHT:!1,VK_DOWN:!1,VK_LEFT:!1},h=function h(t,e){switch(t.keyCode){case 13:r.VK_START=e;break;case 27:case 80:r.VK_PAUSE=e;break;case 38:case 90:case 87:r.VK_UP=e;break;case 39:case 68:r.VK_RIGHT=e;break;case 40:case 83:r.VK_DOWN=e;break;case 37:case 65:case 81:r.VK_LEFT=e;}};document.addEventListener("keydown",function(t){h(t,!0)}),document.addEventListener("keyup",function(t){h(t,!1)});var n=/*#__PURE__*/function(){function n(){this.delta=new s,this.startPressed=!1,this.startKeyCurrentState=r.VK_START,this.startKeyPreviousState=this.startKeyCurrentState,this.pausePressed=!1,this.pauseKeyCurrentState=r.VK_PAUSE,this.pauseKeyPreviousState=this.pauseKeyCurrentState}var _proto2=n.prototype;_proto2.reset=function reset(){this.pausePressed=!1,this.startPressed=!1};_proto2.handle=function handle(t){this.pauseKeyCurrentState=r.VK_PAUSE,!1===this.pauseKeyCurrentState&&!0===this.pauseKeyPreviousState&&(this.pausePressed=!0),this.pauseKeyPreviousState=this.pauseKeyCurrentState,this.startKeyCurrentState=r.VK_START,!1===this.startKeyCurrentState&&!0===this.startKeyPreviousState&&(this.startPressed=!0),this.startKeyPreviousState=this.startKeyCurrentState,r.VK_LEFT?this.delta.x=160*-t:r.VK_RIGHT?this.delta.x=160*t:this.delta.x=0};_createClass(n,[{key:"isPausePressed",get:function get(){var t=this.pausePressed;return this.pausePressed=!1,t}},{key:"isStartPressed",get:function get(){var t=this.startPressed;return this.startPressed=!1,t}}]);return n}();var a=/*#__PURE__*/function(){function a(t){var _this=this;this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d"),this.rect=s.from({width:this.canvas.width,height:this.canvas.height}),this.canvas.addEventListener("resize",function(t){_this.rect.width=_this.canvas.width,_this.rect.height=_this.canvas.height})}var _proto3=a.prototype;_proto3.isVisible=function isVisible(t){return this.rect.collides(t.imageRect)};_proto3.drawScore=function drawScore(t){this.context.font="30px sans-serif",this.context.textAlign="center",this.context.fillStyle="#333",this.context.fillText(""+t,this.rect.width/2,30)};_proto3.drawLifeBar=function drawLifeBar(t){this.context.fillStyle="#0ff",this.context.fillRect(30,15,t,15)};_proto3.drawSprite=function drawSprite(t){return!!this.isVisible(t)&&(t.draw(this.context),!0)};_proto3.drawRunner=function drawRunner(t){return!!this.isVisible(t.sprite)&&(t.draw(this.context),!0)};_proto3.drawInit=function drawInit(){this.context.font="20px sans-serif",this.context.textAlign="center",this.context.fillStyle="#333",this.context.fillText("Use Left/Right arrows or A/D keys to move",this.rect.width/2,this.rect.height/2-80),this.context.fillText("Use Esc/P keys to pause",this.rect.width/2,this.rect.height/2-40),this.context.fillText("Press Enter and run~",this.rect.width/2,this.rect.height/2+10)};_proto3.drawPaused=function drawPaused(){this.context.font="60px sans-serif",this.context.textAlign="center",this.context.fillStyle="#ddd",this.context.fillRect(0,this.rect.height/2-35,this.rect.width/4,70),this.context.fillRect(3*this.rect.width/4,this.rect.height/2-35,this.rect.width/4,70),this.context.fillStyle="#eee",this.context.fillRect(this.rect.width/5,this.rect.height/2-50,3*this.rect.width/5,70),this.context.fillStyle="#333",this.context.fillText("PAUSED",this.rect.width/2,this.rect.height/2)};_proto3.drawLose=function drawLose(){this.context.font="20px sans-serif",this.context.textAlign="center",this.context.fillStyle="#333",this.context.fillText("Press enter and run again~",this.rect.width/2,this.rect.height/2)};_proto3.clear=function clear(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);var t=this.rect.height/8,e=this.rect.width/2*Math.cos(Math.PI/3);this.context.beginPath(),this.context.moveTo(0,t),this.context.lineTo(this.rect.width,t),this.context.stroke(),this.context.beginPath(),this.context.moveTo(0,this.rect.height/2),this.context.lineTo(e,t),this.context.stroke(),this.context.beginPath(),this.context.moveTo(this.rect.width,this.rect.height/2),this.context.lineTo(this.rect.width-e,t),this.context.stroke()};return a}();var o=/*#__PURE__*/function(){function o(t,e){if(t===void 0){t=null}if(e===void 0){e=s()}this.image=t,this.imageRect=e}var _proto4=o.prototype;_proto4.draw=function draw(t){t.drawImage(this.image,this.imageRect.x,this.imageRect.y,this.imageRect.width,this.imageRect.height)};return o}();var c=/*#__PURE__*/function(){function c(t,e){if(e===void 0){e=0}this.clock=t,this.startTick=this.clock.getTicks(),this.currentTick=0,this.previousTick=0,this.targetTicks=e}var _proto5=c.prototype;_proto5.setTimeout=function setTimeout(t){this.targetTicks=t};_proto5.reset=function reset(){this.startTick=this.clock.getTicks(),this.currentTick=this.startTick,this.previousTick=this.startTick};_proto5.update=function update(){this.currentTick=this.clock.getTicks()};_proto5.tick=function tick(){this.previousTick=this.currentTick,this.currentTick=this.clock.getTicks()};_proto5.delta=function delta(){return this.currentTick-this.previousTick};_proto5.deltaStart=function deltaStart(){return this.currentTick-this.startTick};_proto5.timeout=function timeout(){return this.delta()>this.targetTicks};return c}();var l=180,u=360,d=120,m=256,p=150,g=30,f=0,T=1,w=2;function x(t,e,i){return Math.max(e,Math.min(t,i))}var S=/*#__PURE__*/function(){function S(t,e,i){if(e===void 0){e=s.from({x:l,y:u,width:d,height:m})}if(i===void 0){i=g}this.spriteRect=e,this.staticSprite=new o(S.buildRunnerImage("#0f0",f),this.spriteRect),this.leftMoveSprite=new o(S.buildRunnerImage("#0f0",T),this.spriteRect),this.rightMoveSprite=new o(S.buildRunnerImage("#0f0",w),this.spriteRect),this.sprite=this.staticSprite,this.speed=i;var r=this.spriteRect.width/4,h=this.spriteRect.height/4;this.collisionRect=new s(this.spriteRect.left+r,this.spriteRect.top+h,this.spriteRect.right-r,this.spriteRect.bottom-h),this.animTimer=new c(t,p*g/i),this.anim=[f,T,f,w],this.animIdx=0}S.buildHead=function buildHead(t,e,i){t.beginPath(),t.arc(e/2,i/8,i/8,0,2*Math.PI),t.fill()};S.buildTrunkAndArms=function buildTrunkAndArms(t,e,i,s){if(s===void 0){s=f}t.beginPath(),t.moveTo(e/2,i/4),t.lineTo(e/8,i/4),t.arcTo(0,i/4,0,i/4+i/8,i/8),s===T?(t.lineTo(0,i/2),t.lineTo(e/4,i/2),t.lineTo(e/4,3*i/5)):t.lineTo(0,3*i/5),s===w?(t.lineTo(3*e/4,3*i/5),t.lineTo(3*e/4,i/2),t.lineTo(e,i/2)):(t.lineTo(e,3*i/5),t.lineTo(e,i/4+i/8)),t.arcTo(e,i/4,e-e/8,i/4,i/8),t.closePath(),t.fill()};S.buildLegs=function buildLegs(t,e,i,s){if(s===void 0){s=f}t.beginPath(),t.moveTo(e/4,i/2),s===w?(t.lineTo(e/4,3*i/4),t.lineTo(e/2,3*i/4),t.lineTo(e/2,i)):t.lineTo(e/4,i),s===T?(t.lineTo(e/2,i),t.lineTo(e/2,3*i/4),t.lineTo(3*e/4,3*i/4)):t.lineTo(3*e/4,i),t.lineTo(3*e/4,i/2),t.closePath(),t.fill()};S.buildRunnerImage=function buildRunnerImage(t,e){if(t===void 0){t="#0f0"}if(e===void 0){e=f}var i=document.createElement("canvas");i.width=120,i.height=256;var s=i.getContext("2d");return s.fillStyle=t,S.buildHead(s,i.width,i.height,e),S.buildTrunkAndArms(s,i.width,i.height,e),S.buildLegs(s,i.width,i.height,e),i};var _proto6=S.prototype;_proto6.collides=function collides(t){return this.collisionRect.collides(t.collisionRect)};_proto6.update=function update(t){this.animTimer.update(),this.animTimer.timeout()&&(this.animTimer.tick(),this.animIdx=(this.animIdx+1)%this.anim.length,this.anim[this.animIdx]===f?this.sprite=this.staticSprite:this.anim[this.animIdx]===T?this.sprite=this.leftMoveSprite:this.anim[this.animIdx]===w&&(this.sprite=this.rightMoveSprite))};_proto6.draw=function draw(t){this.sprite.draw(t)};_createClass(S,[{key:"x",get:function get(){return this.spriteRect.x},set:function set(t){this.spriteRect.x=t;var e=this.spriteRect.width/4;this.collisionRect.left=this.spriteRect.left+e,this.collisionRect.right=this.spriteRect.right-e}},{key:"y",get:function get(){return this.spriteRect.y},set:function set(t){this.spriteRect.y=t;var e=this.spriteRect.height/4;this.collisionRect.top=this.spriteRect.top+e,this.collisionRect.bottom=this.spriteRect.bottom+e}},{key:"width",get:function get(){return this.spriteRect.width},set:function set(t){this.spriteRect.width=t;var e=this.spriteRect.width/4;this.collisionRect.left=this.spriteRect.left+e,this.collisionRect.right=this.spriteRect.right-e}},{key:"height",get:function get(){return this.spriteRect.height},set:function set(t){this.spriteRect.height=t;var e=this.spriteRect.height/4;this.collisionRect.top=this.spriteRect.top+e,this.collisionRect.bottom=this.spriteRect.bottom-e}}]);return S}();var y=/*#__PURE__*/function(_S){_inheritsLoose(y,_S);function y(t){var _this2;for(var _len=arguments.length,e=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){e[_key-1]=arguments[_key]}_this2=_S.call.apply(_S,[this].concat(e))||this,_this2.color="#00f",_this2.targetSpeed=t,_this2.isCollided=!1,_this2.collisionFactor=0;return _this2}var _proto7=y.prototype;_proto7.updateColor=function updateColor(){var t=x(Math.round(255*this.collisionFactor),0,255),e=x(Math.round(255*(1-this.collisionFactor)),0,255);t=(t=t.toString(16)).length<2?"0"+t:t,e=(e=e.toString(16)).length<2?"0"+e:e,this.color="#"+t+"00"+e};_proto7.update=function update(t){_S.prototype.update.call(this,t);var e=this.targetSpeed-this.speed,i=2*t*e/this.targetSpeed;this.isCollided&&this.collisionFactor<1?(this.collisionFactor=Math.min(this.collisionFactor+i,1),this.updateColor()):this.collisionFactor>0&&(this.collisionFactor=Math.max(this.collisionFactor-i,0),this.updateColor());var s=t*e;this.y+=s;var r=this.y/u*m;this.height=r;var h=l+d/2;var n=this.y/u*d;this.x>h?this.width=n:this.x<h?(this.x+=this.width-n,this.width=n):(this.x-=Math.abs(this.width-n)/2,this.width=n)};_createClass(y,[{key:"color",set:function set(t){this.staticSprite.image=S.buildRunnerImage(t,f),this.leftMoveSprite.image=S.buildRunnerImage(t,T),this.rightMoveSprite.image=S.buildRunnerImage(t,w)}}]);return y}(S);var R=/*#__PURE__*/function(){function R(t,e){if(t===void 0){t=1}this.startTime=R.filterTimestamp(e),this.currentTime=this.startTime,this.previousTime=this.startTime,this.deltaTime=0,this.tickRate=t,this.tickCount=0}R.isValidTimestamp=function isValidTimestamp(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)};R.isPreciseTimestamp=function isPreciseTimestamp(){return!(!performance||!performance.now)};R.timestampNow=function timestampNow(){return R.isPreciseTimestamp()?performance.now():Date.now()};R.filterTimestamp=function filterTimestamp(t){return R.isValidTimestamp(t)?R.isPreciseTimestamp()?R.timestampNow():t:R.timestampNow()};var _proto8=R.prototype;_proto8.reset=function reset(t){this.startTime=R.filterTimestamp(t),this.currentTime=this.startTime,this.previousTime=this.startTime,this.deltaTime=0};_proto8.resetTicks=function resetTicks(){this.tickCount=0};_proto8.update=function update(t){if(this.currentTime=R.filterTimestamp(t),this.deltaTime+=Math.max(this.currentTime-this.previousTime,0),this.previousTime=this.currentTime,this.deltaTime>=this.tickRate){var _t=parseInt(this.deltaTime/this.tickRate);this.tickCount+=_t,this.deltaTime-=_t*this.tickRate}};_proto8.getTicks=function getTicks(){return this.tickCount};_proto8.ticksToMilliseconds=function ticksToMilliseconds(t){return t*this.tickRate};_proto8.ticksToSeconds=function ticksToSeconds(t){return this.ticksToMilliseconds(t)/1e3};return R}();var v=140,k=340,b=10,P=40,M=1e3,I=5e3;var L=/*#__PURE__*/function(){function L(t,e){this.clock=t,this.player=e,this.timer=new c(t)}var _proto9=L.prototype;_proto9.spawn=function spawn(){return null};return L}();var K=/*#__PURE__*/function(_L){_inheritsLoose(K,_L);function K(){var _this3;for(var _len2=arguments.length,t=new Array(_len2),_key2=0;_key2<_len2;_key2++){t[_key2]=arguments[_key2]}_this3=_L.call.apply(_L,[this].concat(t))||this,_this3.minTimeout=M,_this3.maxTimeout=I,_this3.timer.setTimeout(K.generateSpwanTimeout(_this3.minTimeout,_this3.maxTimeout));return _this3}K.generateRunner=function generateRunner(t,e){var i=P/t.y*t.width,r=parseInt(function(t,e){if(t===void 0){t=.5}if(e===void 0){e=2}var i=Math.random(),s=Math.random();for(;i<Number.EPSILON;){i=Math.random()}for(;s<Number.EPSILON;){s=Math.random()}return e*(Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*s))+t}(t.x+t.width/2,i/3));r=Math.max(v,Math.min(r,k));var h=Math.random()*(t.speed/8-b)+b;return new y(t.speed,e,s.from({x:r,y:P}),h)};K.generateSpwanTimeout=function generateSpwanTimeout(t,e){return parseInt(Math.random()*(e-t)+t)};var _proto10=K.prototype;_proto10.reset=function reset(){this.timer.reset()};_proto10.spawn=function spawn(){return this.timer.update(),this.timer.timeout()?(this.timer.reset(),this.timer.setTimeout(K.generateSpwanTimeout(this.minTimeout,this.maxTimeout)),K.generateRunner(this.player,this.clock)):null};_createClass(K,[{key:"timeout",get:function get(){return this.maxTimeout},set:function set(t){this.maxTimeout=Math.max(this.minTimeout,t)}}]);return K}(L);var A=function A(){var t,e,i,s,r,h=function h(t){return Math.sin(6.283184*t)},n=function n(t){return .003959503758*Math.pow(2,(t-128)/12)},a=function a(t,e,i){var s,r,h,a,c,l,u,d=o[t.i[0]],m=t.i[1],p=t.i[3],g=o[t.i[4]],f=t.i[5],T=t.i[8],w=t.i[9],x=t.i[10]*t.i[10]*4,S=t.i[11]*t.i[11]*4,y=t.i[12]*t.i[12]*4,R=1/y,v=t.i[13],k=i*Math.pow(2,2-t.i[14]),b=new Int32Array(x+S+y),P=0,M=0;for(s=0,r=0;s<x+S+y;s++,r++){r>=0&&(r-=k,l=n(e+(15&(v=v>>8|(255&v)<<4))+t.i[2]-128),u=n(e+(15&v)+t.i[6]-128)*(1+8e-4*t.i[7])),h=1,s<x?h=s/x:s>=x+S&&(h-=(s-x-S)*R),a=l,p&&(a*=h*h),c=d(P+=a)*m,a=u,T&&(a*=h*h),c+=g(M+=a)*f,w&&(c+=(2*Math.random()-1)*w),b[s]=80*c*h|0}return b},o=[h,function(t){return t%1<.5?1:-1},function(t){return t%1*2-1},function(t){var e=t%1*4;return e<2?e-1:3-e}];this.init=function(h){t=h,e=h.endPattern,i=0,s=h.rowLen*h.patternLen*(e+1)*2,r=new Int32Array(s)},this.generate=function(){var n,c,l,u,d,m,p,g,f,T,w,x,S,y,R=new Int32Array(s),v=t.songData[i],k=t.rowLen,b=t.patternLen,P=0,M=0,I=!1,L=[];for(l=0;l<=e;++l){for(p=v.p[l],u=0;u<b;++u){var K=p?v.c[p-1].f[u]:0;K&&(v.i[K-1]=v.c[p-1].f[u+b]||0,K<16&&(L=[]));var A=o[v.i[15]],C=v.i[16]/512,E=Math.pow(2,v.i[17]-9)/k,V=v.i[18],_=v.i[19],F=43.23529*v.i[20]*3.141592/44100,O=1-v.i[21]/255,U=1e-5*v.i[22],N=v.i[23]/32,j=v.i[24]/512,D=6.283184*Math.pow(2,v.i[25]-9)/k,q=v.i[26]/255,B=v.i[27]*k&-2;for(w=(l*b+u)*k,d=0;d<4;++d){if(m=p?v.c[p-1].n[u+d*b]:0){L[m]||(L[m]=a(v,m,k));var H=L[m];for(c=0,n=2*w;c<H.length;c++,n+=2){R[n]+=H[c]}}}for(c=0;c<k;c++){(T=R[g=2*(w+c)])||I?(x=F,V&&(x*=A(E*g)*C+.5),M+=(x=1.5*Math.sin(x))*(S=O*(T-M)-(P+=x*M)),T=3==_?M:1==_?S:P,U&&(T=(T*=U)<1?T>-1?h(.25*T):-1:1,T/=U),I=(T*=N)*T>1e-5,y=T*(1-(f=Math.sin(D*g)*j+.5)),T*=f):y=0,g>=B&&(y+=R[g-B+1]*q,T+=R[g-B]*q),R[g]=0|y,R[g+1]=0|T,r[g]+=0|y,r[g+1]+=0|T}}}return++i/t.numChannels},this.createWave=function(){var t=44+2*s-8,e=t-36,i=new Uint8Array(44+2*s);i.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var h=0,n=44;h<s;++h){var a=r[h];a=a<-32767?-32767:a>32767?32767:a,i[n++]=255&a,i[n++]=a>>8&255}return i},this.getData=function(t,e){for(var i=2*Math.floor(44100*t),s=new Array(e),h=0;h<2*e;h+=1){var n=i+h;s[h]=t>0&&n<r.length?r[n]/32768:0}return s}},C={songData:[{i:[0,0,128,0,0,0,128,0,0,125,0,1,59,0,0,0,0,0,0,1,193,171,0,29,39,3,88,3],p:[1,2,1,2,1,2],c:[{n:[135,,,,135,,,,139,,,,135,,139,,140,,,,139,,,,140],f:[]},{n:[139,,138,,137,,,,135,,,,137,,,,140,,139,,135],f:[]}]},{i:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[2,,2,,2],c:[{n:[],f:[]},{n:[135,,,,135,,,,139,,140,,135,,,,139,,,,140,,,,140],f:[]}]},{i:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[,4,,4,,4],c:[{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[139,,,,137,,,,139,,140,,142,,140,,139,,,,135],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[,,,,1,2],c:[{n:[159,,,,,,,,161,,,,,,,,163,,,,,,,,159],f:[]},{n:[159,,,,156,,,,158,,,,159],f:[]}]}],rowLen:5513,patternLen:32,endPattern:5,numChannels:4},E={songData:[{i:[0,0,140,0,0,0,140,0,0,60,4,10,34,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[1],c:[{n:[139],f:[]}]}],rowLen:5513,patternLen:1,endPattern:0,numChannels:1};var V=/*#__PURE__*/function(){function V(){var _this4=this;var t=new A;t.init(C),this.runningSong=document.createElement("audio");var e=setInterval(function(){if(t.generate()>=1){clearInterval(e);var _i=t.createWave(),_s2=URL.createObjectURL(new Blob([_i],{type:"audio/wav"}));_this4.runningSong.loop=!0,_this4.runningSong.src=_s2}},0),i=new A;i.init(E),this.crashSong=document.createElement("audio");var s=setInterval(function(){if(i.generate()>=1){clearInterval(s);var _t2=i.createWave(),_e=URL.createObjectURL(new Blob([_t2],{type:"audio/wav"}));_this4.crashSong.src=_e}},0)}var _proto11=V.prototype;_proto11.playRunningSong=function playRunningSong(){this.runningSong.play()};_proto11.pauseRunningSong=function pauseRunningSong(){this.runningSong.pause()};_proto11.resetRunningSong=function resetRunningSong(){this.runningSong.pause(),this.runningSong.currentTime=0,this.runningSong.play()};_proto11.playCrashSong=function playCrashSong(){this.crashSong.play()};return V}();var _=0,F=1,O=2,U=3,N=4,j=[500,500,250,250,500,500,500,1e3,500,500,250,250,250,250,500,1500],D=100;new(/*#__PURE__*/function(){function _class(){var _this5=this;this.state=_,this.requestAnimationId=-1,this.clock=new R(1),this.timer=new c(this.clock),this.currentScoreIdx=0,this.currentScoreTimeout=j[this.currentScoreIdx],this.score=0,this.renderer=new a("game-render"),this.audioManager=new V,this.life=D,this.player=new S(this.clock),this.runnerList=[],this.runnerSpawner=new K(this.clock,this.player),this.difficultyIncreased=!1,this.input=new n(this.player),document.addEventListener("visibilitychange",function(t){_this5.state!==F&&_this5.state!==O||(document.hidden?_this5.stop():_this5.start())}),window.addEventListener("blur",function(t){_this5.state===F&&(_this5.pause(),_this5.state=O)}),window.addEventListener("focus",function(t){_this5.state===O&&(_this5.resume(),_this5.state=F)})}var _proto12=_class.prototype;_proto12.start=function start(){var _this6=this;this.clock.reset(),this.requestAnimationId=requestAnimationFrame(function(t){return _this6.run(t)},this.renderer.canvas),this.resume()};_proto12.stop=function stop(){this.pause(),this.requestAnimationId=cancelAnimationFrame(this.requestAnimationId)};_proto12.resume=function resume(t){if(t===void 0){t=!1}(t||this.state===F||this.state===O||this.state===U)&&this.audioManager.playRunningSong()};_proto12.pause=function pause(){this.state===F&&this.audioManager.pauseRunningSong()};_proto12.reset=function reset(){this.state===N&&(this.runnerList=[],this.runnerSpawner.reset(),this.audioManager.resetRunningSong(),this.life=D,this.currentScoreIdx=0,this.currentScoreTimeout=j[this.currentScoreIdx],this.score=0)};_proto12.update=function update(t){var _this7=this;var e=this.runnerSpawner.spawn();if(null!==e&&e instanceof y&&this.runnerList.push(e),this.player.x+=this.input.delta.x,this.player.update(t),this.player.x<0?this.player.x=0:this.player.x+this.player.width>this.renderer.rect.width&&(this.player.x=this.renderer.rect.width-this.player.width),this.runnerList.forEach(function(e){e.update(t)}),this.runnerList=this.runnerList.filter(function(t){return Math.abs(t.collisionFactor-1)<=Number.EPSILON?(_this7.life=Math.max(0,_this7.life-20),_this7.audioManager.playCrashSong(),!1):_this7.renderer.isVisible(t.sprite)}),this.runnerList=this.runnerList.sort(function(t,e){return t.y-e.y}),this.runnerList.forEach(function(t){_this7.player.collides(t)?t.isCollided=!0:t.isCollided=!1}),this.score%15==0?this.difficultyIncreased||(this.difficultyIncreased=!0,console.log(this.runnerSpawner.maxTimeout),this.runnerSpawner.timeout-=t*this.runnerSpawner.maxTimeout):this.difficultyIncreased=!1,this.timer.deltaStart()>=this.currentScoreTimeout){this.timer.reset();var _t3=(this.currentScoreIdx+1)%j.length,_e2=j[_t3];this.currentScoreIdx=_t3,this.currentScoreTimeout=_e2,this.timer.deltaStart()>this.currentSocreTimeout&&(this.currentScoreTimeout-=this.timer.deltaStart()-this.currentScoreTimeout),this.score++}0==this.life&&(this.input.reset(),this.state=N)};_proto12.draw=function draw(){var _this8=this;this.renderer.clear();var t=this.runnerList.filter(function(t){return t.y<=_this8.player.y}),e=this.runnerList.filter(function(t){return t.y>_this8.player.y}),i=function i(t){return _this8.renderer.drawRunner(t)};t.forEach(i),this.renderer.drawRunner(this.player),e.forEach(i),this.renderer.drawLifeBar(this.life),this.renderer.drawScore(this.score),this.state===_?this.renderer.drawInit():this.state===O||this.state===U?this.renderer.drawPaused():this.state===N&&this.renderer.drawLose()};_proto12.run=function run(t){var _this9=this;if(t===void 0){t=0}this.requestAnimationId=requestAnimationFrame(function(t){return _this9.run(t)},this.renderer.canvas),this.clock.update(t),this.timer.tick();var e=this.clock.ticksToSeconds(this.timer.delta());this.input.handle(e),this.state===_?this.input.isStartPressed&&(this.resume(!0),this.input.reset(),this.state=F):this.state===F||this.state===U?this.input.isPausePressed&&(this.state===F?(this.pause(),this.state=U):(this.resume(),this.state=F)):this.state===N&&this.input.isStartPressed&&(this.reset(),this.input.reset(),this.state=F),this.state===F&&this.update(e),this.draw()};return _class}())().start()}]);