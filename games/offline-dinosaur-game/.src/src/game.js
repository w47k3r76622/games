"use strict";function _toConsumableArray(n){if(Array.isArray(n)){for(var r=0,t=Array(n.length);r<n.length;r++)t[r]=n[r];return t}return Array.from(n)}!function(n,s){var h=function(){return s.performance.now()},o=function(n,r){return Math.floor(Math.random()*(r-n+1))+n},e=32,r=32,i=32,f=20,u=function(n){return!(n.y+n.h<w.y)&&(!(n.x+n.w<0)&&!(n.x-n.w>w.w))},c=function(n,r,t,o){for(var i=t.velocity_x<0?t.w:0,f=t.velocity_x<0?-1:1,e=o.velocity_x<0?o.w:0,u=o.velocity_x<0?-1:1,c=0;c<n.length;c++)for(var a=0;a<r.length;a++){var v=[t.x+i+n[c][0]*f,t.y+n[c][1],t.x+i+(n[c][0]+n[c][2])*f,t.y+n[c][1]+n[c][3]],p=[o.x+e+r[a][0]*u,o.y+r[a][1],o.x+e+(r[a][0]+r[a][2])*u,o.y+r[a][1]+r[a][3]];if(v[0]<p[2]&&p[0]<v[2]&&v[1]<p[3]&&p[1]<v[3])return!0}return!1},y=n.getElementById("game");y.focus();var t={};y.addEventListener("keydown",function(n){t[n.key]=!0}),y.addEventListener("keyup",function(n){t[n.key]=!1});var a=y.getContext("2d");a.imageSmoothingEnabled=!1;var v,p,d,x,_,l,g=function(n){return n.w||n.ArrowUp||n[" "]},E=function(n){return n.s||n.ArrowDown},w={x:0,y:0,w:320,h:480},I=160,m="#fff",N="#222",M=0,O=0,A=0,C=s.localStorage.getItem("hiscore")||0,D=void 0,R={DINO_DUCK:[146,0,r,r,p=[[10,22,8,10],[6,23,4,7],[1,23,5,3],[19,15,9,13],[18,23,5,8],[25,22,7,6]]],DINO_DUCK_REV:[178,0,r,r,p],DINO:[[114,0,r,r,v=[[15,6,9,14],[24,13,4,7],[10,22,8,10],[4,20,3,7],[7,22,3,7],[12,20,10,4],[14,18,6,9]]],[306,0,r,r,v],[338,0,r,r,v],[306,0,r,r,v]],DINO_REV:[[210,0,r,r,v],[242,0,r,r,v],[274,0,r,r,v],[242,0,r,r,v]],ENEMY:[[370,0,i,f,d=[[1,8,9,12],[6,2,2,6],[8,0,9,17],[17,4,6,12],[4,8,4,8],[27,8,5,5]]],[402,0,i,f,x=[[1,8,31,4],[5,12,20,2],[9,6,8,9],[2,14,8,3],[17,3,6,5],[23,5,5,3]]],[434,0,i,f,_=[[1,8,31,4],[5,12,20,2],[9,6,8,9],[2,14,8,3],[17,3,6,5],[23,5,5,3]]],[466,0,i,f,l=[[1,7,31,4],[4,6,15,10],[17,2,6,5],[23,4,5,3]]],[434,0,i,f,_],[402,0,i,f,x]],ENEMY_REV:[[498,0,i,f,d],[530,0,i,f,x],[562,0,i,f,_],[594,0,i,f,l],[562,0,i,f,_],[530,0,i,f,x]],CACTUS:[[96,0,18,24,[[5,0,8,24],[0,9,5,9],[12,11,6,11]]]],BOX:[[0,0,e,e],[32,0,e,e]],BOX_SLEEP:[[64,0,e,e]]},S=function(n,r){return{state:0,velocity_x:0,velocity_y:0,x:n,y:r,w:e,h:e,gfx:[R.BOX_SLEEP[0]]}},b=void 0,T=[],j=[],k=void 0,U=void 0,V=function(n,r){o(0,100)<n&&r()},B=function(){m="#fff",N="#222",k=.8,U=.1,A=M=0,w.x=0,w.y=0,b={mirror:!1,state:0,velocity_x:0,velocity_y:0,x:144,y:128,w:32,h:32,gfx:[R.DINO[0]]},(T=[]).push(S(144,b.y+b.h));for(var n=8;n<2*w.h/e;n++){var r=o(0,w.w-16);T.push(S(r-r%16,n*e))}j=[];for(var t=0;t<T.length;t++)T[t].y>b.x+b.h&&J(T[t])},F=!0,H={};H[5]=jsfxr([2,,.04,.2,.4,.5,,,,,,,,,,,,,1,,,,,.1]),H[6]=jsfxr([1,,.09,.2,.4,.5,,,,,,,,,,,,,1,,,,,.1]);function K(){this.sounds={}}K.prototype.add=function(i,f,n){this.sounds[i]=[],n.forEach(function(n,r){this.sounds[i].push({tick:0,count:f,pool:[]});for(var t=0;t<f;t++){var o=new Audio;o.src=jsfxr(n),this.sounds[i][r].pool.push(o)}},this)},K.prototype.play=function(n){var r=this.sounds[n],t=1<r.length?r[Math.floor(Math.random()*r.length)]:r[0];t.pool[t.tick].play(),t.tick<t.count-1?t.tick++:t.tick=0};var P=new K;P.add("die",1,[[3,,.1645,.7236,.34,.03,,,,,,,,,,,,,1,,,,,.4]]),P.add("jump",2,[[1,,.1,,.1,.3,,.2,,,,,,,,.3,,,1,,,,,.2]]);var X,Y,q,G=function(){O=2;var n=void 0;n=1===b.state?b.mirror?[5,19]:[20,19]:b.mirror?[9,10]:[16,10],b.gfx.push([372,28,7,3,[]].concat(_toConsumableArray(n))),C=Math.max(C,A),s.localStorage.setItem("hiscore",C),F=!1,P.play("die")},L=function(){b.velocity_y=-9,P.play("jump")},W=!1,z=function(n){var r,t;if(F){if(g(n)){if(!W){var o=w.h,i=setInterval(function(){if(o>=s.innerHeight)return y.style="height: 100%;",void clearInterval(i);y.style="height: "+o+"px;",o+=20},15);r=101,t={101:[[{n:5,p:.4}],[],[{n:5,p:.4}],[],[{n:5,p:.5}],[],[{n:5,p:.6}],[]]},new Sequencer([200,H,t,[[r],[],[],[],[],[],[],[],[r],[],[],[],[],[],[],[],[r],[],[],[],[],[],[],[],[r],[],[],[],[],[],[],[],[r,{n:6,p:1}],[],[{n:6,p:.6}],[],[],[],[],[],[r],[],[],[],[],[],[],[],[r],[],[],[],[],[],[],[],[r,{n:6,p:.7}],[],[],[],[{n:6,p:.8}],[],[],[],[r,{n:6,p:1.2}],[],[{n:6,p:.9}],[],[{n:6,p:.6}],[],[],[{n:6,p:.9}],[r,{n:6,p:.6}],[],[],[],[{n:6,p:.8}],[],[],[],[r,{n:6,p:.9}],[],[],[],[],[],[],[],[r,{n:6,p:1.2}],[],[{n:6,p:1}],[],[{n:6,p:.8}],[],[{n:6,p:.6}],[],[r,{n:6,p:1}],[],[{n:6,p:.6}],[],[],[],[],[]],W=!0,1.4]).play()}O=1,B(),L()}}else F=!g(n)},J=function(t){V(33,function(){var n,r;j.push((n=t.x+16-9,r=t.y-24,{type:0,state:0,velocity_x:0,velocity_y:0,x:n,y:r,w:18,h:24,gfx:[R.CACTUS]}))})},Q=function(){V(50,function(){var n=0===o(0,1)?-2:2;j.push(function(n,r,t){return{type:1,state:0,velocity_x:t,velocity_y:3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,x:n,y:r,w:i,h:f,gfx:[0<t?R.ENEMY:R.ENEMY_REV]}}(0<n?-i:w.w+i,o(w.y+w.h/2,w.y+w.h),n,o(-1,1)))})},Z=function(){var n;n=m,m=N,N=n,k+=U},$=function(n,r,t){n%r==0&&t()},nn=function(){A++},rn=function(){j.find(function(n){return function(n,r){for(var t=0;t<n.gfx.length;t++)for(var o=0;o<r.gfx.length;o++)if(c(n.gfx[t][4],r.gfx[o][4],n,r))return!0;return!1}(n,b)})&&G(),b.y+b.h/2>w.y+w.h&&G()},tn=function(n){M++,function(){var n=T.length;T=T.filter(function(n){return u(n)});for(var r=0;r<n-T.length;r++){var t=S(o(0,w.w-e),T[T.length-1].y+e);T.push(t),J(t)}}(),j=j.filter(function(n){return u(n)}).map(function(n){return n.x+=n.velocity_x,n.y+=n.velocity_y,n.gfx=[cn(un(n),10)],n}),function(i){var n,r;b.velocity_x=0,b.velocity_y+=9/16,b.state=E(i)?1:0,(r=i).a||r.ArrowLeft?(b.velocity_x=-2,b.mirror=!0):((n=i).d||n.ArrowRight)&&(b.velocity_x=2,b.mirror=!1);var t=b.y+b.velocity_y,f=parseInt(t-t%e,10);if(T.map(function(n){var r=b.x-b.w/5>n.x-n.w&&b.x+b.w/5<n.x+n.w,t=n.y-b.h,o=t>=b.y&&t===f;r&&o?(b.y=t,g(i)?L():b.velocity_y=0,n.state=2,n.gfx=[cn(R.BOX,60)]):(n.state=0,n.gfx=[R.BOX_SLEEP[0]])}),E(i)&&0===b.velocity_y&&(b.velocity_x=0),b.y+=b.velocity_y,b.x+=b.velocity_x,1===b.state)b.gfx=[b.mirror?R.DINO_DUCK_REV:R.DINO_DUCK];else{var o=b.mirror?R.DINO_REV:R.DINO;b.gfx=[b.velocity_x?cn(o,5):o[0]]}}(n),$(M,10,nn),$(M,720,Z),$(M,60,Q),w.y+=k,rn()},on=function(){1===O?tn(t):z(t)},fn=function(n,r,t){a.fillText(t,I+n-w.x,r-w.y)},en=function(n,r,t){a.fillText(t,I+n,r)},un=function(n){if(0===n.type)return R.CACTUS;if(1===n.type)return 0<n.velocity_x?R.ENEMY:R.ENEMY_REV;throw new Error("")},cn=function(n,r){for(var t=M%(n.length*r),o=0;o<=n.length;o++)if(t<r*(o+1))return n[o];return n[0]},an=function(n,r,t,o,i){a.fillStyle=i,a.fillRect(n,r,t,o)},vn=function(n){for(var r=0;r<n.gfx.length;r++)t=n.x+(n.gfx[r][5]||0),o=n.y+(n.gfx[r][6]||0),i=n.gfx[r],a.drawImage(D,i[0],i[1],i[2],i[3],I+t-w.x,o-w.y,i[2],i[3]);var t,o,i},pn=function(){if(n.body.style.backgroundColor=m,an(0,0,y.width,y.height,m),0===O)return vn(b),a.font="13px 'Segoe UI', Tahoma, sans-serif",a.fillStyle="#646464",fn(64,b.y+188,"DNS_PROBE_FINISHED_NO_INTERNET"),a.fillStyle=N,fn(64,b.y+96,"Try:"),fn(76,b.y+116,"● Checking the network cable or router"),fn(76,b.y+136,"● Resetting the modem or router"),fn(76,b.y+156,"● Reconnecting to Wi-Fi"),a.font="24px 'Segoe UI', Tahoma, sans-serif",void fn(64,b.y+64,"No Internet");!function(){for(var n=0;n<T.length;n++)vn(T[n]);for(var r=0;r<j.length;r++)vn(j[r]);vn(b)}(),an(0,0,I,w.h,N),an(I+w.w,0,I,w.h,N),an(0,0,159,w.h,m),an(I+w.w+1,0,I,w.h,m),2===O&&an(0,0,y.width,y.height,"#fff"===m?"rgba(255, 255, 255, 0.5)":"rgba(0,0,0, 0.5)"),function(){var n=function(n){return("00000"+n).slice(-5)},r=function(n){return a.measureText(n).width},t="HI "+n(C)+" "+n(A);if(a.font="bold 18px Courier",a.fillStyle=N,en(w.w-16-r(t),16,t),2===O){var o="GAME OVER";en(w.w/2-r(o)/2,w.h/2,o)}}()};X="src/spritesheet.png",Y=function(){var n,r,t,o,i,f,e,u,c,a,v,p;B(),r=(n={fps:60,update:on,render:pn,canvas:y}).fps||60,t=n.slow||1,o=n.update,i=n.render,f=n.canvas,e=s.requestAnimationFrame,c=t*(u=1/r),a=void 0,v=0,p=h(),e(function n(){for(a=h(),v+=Math.min(1,(a-p)/1e3);c<v;)v-=c,o(u);i(v/t),p=a,e(n,f)})},(q=new Image).onload=Y,q.src=X,D=q}(document,window);