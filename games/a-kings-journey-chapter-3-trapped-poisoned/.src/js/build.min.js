function SfxrParams(){this.setSettings=function(t){for(var e=0;e<24;e++)this[String.fromCharCode(97+e)]=t[e]||0;this.c<.01&&(this.c=.01);var i=this.b+this.c+this.e;if(i<.18){var a=.18/i;this.b*=a,this.c*=a,this.e*=a}}}function SfxrSynth(){this._params=new SfxrParams;var t,e,i,a,o,r,n,s,l,h,c,d;this.reset=function(){var t=this._params;a=100/(t.f*t.f+.001),o=100/(t.g*t.g+.001),r=1-t.h*t.h*t.h*.01,n=-t.i*t.i*t.i*1e-6,t.a||(c=.5-t.n/2,d=5e-5*-t.o),s=1+t.l*t.l*(t.l>0?-.9:10),l=0,h=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.totalReset=function(){this.reset();var a=this._params;return t=a.b*a.b*1e5,e=a.c*a.c*1e5,i=a.e*a.e*1e5+12,3*((t+e+i)/3|0)},this.synthWave=function(f,p){var y=this._params,u=1!=y.s||y.v,g=y.v*y.v*.1,m=1+3e-4*y.w,x=y.s*y.s*y.s*.1,w=1+1e-4*y.t,W=1!=y.s,v=y.x*y.x,H=y.g,P=y.q||y.r,S=y.r*y.r*y.r*.2,F=y.q*y.q*(y.q<0?-1020:1020),k=y.p?32+((1-y.p)*(1-y.p)*2e4|0):0,b=y.d,T=y.j/2,q=y.k*y.k*.01,A=y.a,C=t,I=1/t,M=1/e,R=1/i,D=5/(1+y.u*y.u*20)*(.01+x);D>.8&&(D=.8),D=1-D;for(var E,G,B,X,Y,N,j=!1,L=0,K=0,O=0,_=0,U=0,V=0,z=0,$=0,J=0,Q=0,Z=new Array(1024),tt=new Array(32),et=Z.length;et--;)Z[et]=0;for(et=tt.length;et--;)tt[et]=2*Math.random()-1;for(et=0;et<p;et++){if(j)return et;if(k&&++J>=k&&(J=0,this.reset()),h&&++l>=h&&(h=0,a*=s),r+=n,(a*=r)>o&&(a=o,H>0&&(j=!0)),G=a,T>0&&(Q+=q,G*=1+Math.sin(Q)*T),(G|=0)<8&&(G=8),A||((c+=d)<0?c=0:c>.5&&(c=.5)),++K>C)switch(K=0,++L){case 1:C=e;break;case 2:C=i}switch(L){case 0:O=K*I;break;case 1:O=1+2*(1-K*M)*b;break;case 2:O=1-K*R;break;case 3:O=0,j=!0}P&&((B=0|(F+=S))<0?B=-B:B>1023&&(B=1023)),u&&m&&((g*=m)<1e-5?g=1e-5:g>.1&&(g=.1)),N=0;for(var it=8;it--;){if(++z>=G&&(z%=G,3==A))for(var at=tt.length;at--;)tt[at]=2*Math.random()-1;switch(A){case 0:Y=z/G<c?.5:-.5;break;case 1:Y=1-z/G*2;break;case 2:Y=.225*(((Y=1.27323954*(X=6.28318531*((X=z/G)>.5?X-1:X))+.405284735*X*X*(X<0?1:-1))<0?-1:1)*Y*Y-Y)+Y;break;case 3:Y=tt[Math.abs(32*z/G|0)]}u&&(E=V,(x*=w)<0?x=0:x>.1&&(x=.1),W?(U+=(Y-V)*x,U*=D):(V=Y,U=0),_+=(V+=U)-E,Y=_*=1-g),P&&(Z[$%1024]=Y,Y+=Z[($-B+1024)%1024],$++),N+=Y}N*=.125*O*v,f[et]=N>=1?32767:N<=-1?-32768:32767*N|0}return p}}function start(){canvas=document.getElementById("myCanvas"),(ctx=canvas.getContext("2d")).scale(2,2),render()}function render(){ctx.clearRect(0,0,canvas.width,canvas.height),assetLoaded&&fontLoaded&&(0==gameState?drawTitle():1==gameState?drawPrologue():2==gameState?(drawMap(),drawPlayer(),drawShadow(),drawText()):3==gameState&&drawGameOver()),requestAnimationFrame(render)}function drawMap(){for(var t=Player.posX*tileWidth-160,e=Player.posY*tileHeight-160,i=0;i<map.length;i++)if((s=Player.tempMap[i]-1)>=0){var a=i%mapWidth*tileWidth-t,o=Math.floor(i/mapHeight)*tileHeight-e,r=s%4*tileWidth,n=Math.floor(s/4)*tileHeight;ctx.drawImage(asset,r,n,tileWidth,tileHeight,a,o,tileWidth,tileHeight)}for(i=0;i<item.length;i++){var s=Player.tempItem[i]-1;if(s>=0){var a=i%mapWidth*tileWidth-t,o=Math.floor(i/mapHeight)*tileHeight-e,r=s%4*tileWidth,n=Math.floor(s/4)*tileHeight;ctx.drawImage(asset,r,n,tileWidth,tileHeight,a,o,tileWidth,tileHeight)}}}function drawPlayer(){var t=Player.posX*tileWidth-160,e=Player.posY*tileHeight-160,i=Player.posX*tileWidth-t,a=Player.posY*tileHeight-e;ctx.drawImage(asset,0,0,tileWidth,tileHeight,i,a,tileWidth,tileHeight)}function drawText(){ctx.drawImage(asset,3*tileWidth,1*tileHeight,tileWidth,tileHeight,9*tileWidth,0,tileWidth,tileHeight),ctx.drawImage(asset,3*tileWidth,2*tileHeight,tileWidth,tileHeight,7*tileWidth,0,tileWidth,tileHeight),ctx.drawImage(asset,0*tileWidth,2*tileHeight,tileWidth,tileHeight,0,0*tileHeight,tileWidth,tileHeight),Font.drawText(""+Player.mainKey,10*tileWidth,0*tileHeight+8),Font.drawText(""+Player.key,8*tileWidth,0*tileHeight+8),Font.drawText(""+Player.life,1*tileWidth,0*tileHeight+8)}function drawShadow(){ctx.globalAlpha=1,ctx.fillStyle="#000000",ctx.fillRect(0,0,352,32),ctx.fillRect(0,320,352,32),ctx.fillRect(0,0,32,352),ctx.fillRect(320,0,32,352),ctx.globalAlpha=.75,ctx.fillRect(32,32,288,32),ctx.fillRect(32,288,288,32),ctx.fillRect(32,32,32,288),ctx.fillRect(288,32,32,288),ctx.globalAlpha=.5,ctx.fillRect(64,64,224,32),ctx.fillRect(64,256,224,32),ctx.fillRect(64,64,32,224),ctx.fillRect(256,64,32,224),ctx.globalAlpha=.25,ctx.fillRect(96,96,160,32),ctx.fillRect(96,224,160,32),ctx.fillRect(96,96,32,160),ctx.fillRect(224,96,32,160),ctx.globalAlpha=1}function checkCollision(t,e,i,a){var o=!0,r=t+i+(30*e+30*a);return 2==Player.tempMap[r]&&(o=!1),12==Player.tempItem[r]?(keySfx.play(),Player.key++,Player.tempItem[r]=0):8==Player.tempItem[r]?(keySfx.play(),Player.mainKey++,Player.tempItem[r]=0):10==Player.tempItem[r]?Player.key>0?(doorSfx.play(),Player.key--,Player.tempItem[r]=0):(lockedSfx.play(),o=!1):6==Player.tempItem[r]?Player.mainKey>0?(doorSfx.play(),Player.mainKey--,Player.tempItem[r]=7,o=!1):(lockedSfx.play(),o=!1):7==Player.tempItem[r]&&(gameState=3,sequence.stop()),o}function drawTitle(){Font.drawText("a king's journey",1.5*tileWidth,1*tileHeight+8),Font.drawText("chapter 3:",3*tileWidth,3*tileHeight+8),Font.drawText("trapped & poisoned",1*tileWidth,4*tileHeight+8),ctx.drawImage(asset,0,0,tileWidth,tileHeight,5*tileWidth,6.5*tileHeight,tileWidth,tileHeight),Font.drawText("press space",3*tileWidth,9*tileHeight+8),Font.drawText("to continue",3*tileWidth,10*tileHeight+8)}function drawPrologue(){Font.drawText("after poisoned by",1*tileWidth,0*tileHeight+8),Font.drawText("the chancellor, you",1*tileWidth,1*tileHeight+8),Font.drawText("are thrown to the",1*tileWidth,2*tileHeight+8),Font.drawText("dungeon.",1*tileWidth,3*tileHeight+8),Font.drawText("you need to move",1*tileWidth,4*tileHeight+8),Font.drawText("fast to escape",1*tileWidth,5*tileHeight+8),Font.drawText("before succumbing",1*tileWidth,6*tileHeight+8),Font.drawText("to death.",1*tileWidth,7*tileHeight+8),Font.drawText("press space",3*tileWidth,9*tileHeight+8),Font.drawText("to continue",3*tileWidth,10*tileHeight+8)}function drawGameOver(){Player.life<=0?(Font.drawText("the end",3*tileWidth,9*tileHeight+8),Font.drawText("alas, the poison",1.5*tileWidth,4*tileHeight+8),Font.drawText("has killed you...",1.5*tileWidth,5*tileHeight+8)):(Font.drawText("to be continued...",1*tileWidth,9*tileHeight+8),Font.drawText("you finally found",1.5*tileWidth,3*tileHeight+8),Font.drawText("the way out.",1.5*tileWidth,4*tileHeight+8),Font.drawText("it's time to get",1.5*tileWidth,5*tileHeight+8),Font.drawText("revenge!",1.5*tileWidth,6*tileHeight+8))}function keyDownHandler(t){if(0==gameState)13!=t.keyCode&&32!=t.keyCode||(gameState=1);else if(1==gameState)13!=t.keyCode&&32!=t.keyCode||(gameState=2,sequence.play());else if(2==gameState){if(39==t.keyCode)(e=checkCollision(Player.posX,Player.posY,1,0))&&Player.posX++;else if(37==t.keyCode)(e=checkCollision(Player.posX,Player.posY,-1,0))&&Player.posX--;else if(38==t.keyCode)(e=checkCollision(Player.posX,Player.posY,0,-1))&&Player.posY--;else if(40==t.keyCode){var e=checkCollision(Player.posX,Player.posY,0,1);e&&Player.posY++}e&&(Player.life--,stepSfx.play(),Player.life<=0&&(gameState=3,sequence.stop()))}else 3==gameState&&(13!=t.keyCode&&32!=t.keyCode||(Player.init(),gameState=0))}!function(t,e){"function"==typeof define&&define.amd?define(["exports"],e):e("object"==typeof exports&&"string"!=typeof exports.nodeName?exports:t.TinyMusic={})}(this,function(t){function e(t){var i=t.split(s);this.frequency=e.getFrequency(i[0])||0,this.duration=e.getDuration(i[1])||0}function i(t,e,i){this.ac=t||new AudioContext,this.createFxNodes(),this.tempo=e||120,this.loop=!0,this.smoothing=0,this.staccato=0,this.notes=[],this.push.apply(this,i||[])}var a="B#-C|C#-Db|D|D#-Eb|E-Fb|E#-F|F#-Gb|G|G#-Ab|A|A#-Bb|B-Cb",o=440*Math.pow(Math.pow(2,1/12),-9),r=/^[0-9.]+$/,n=4,s=/\s+/,l=/(\d+)/,h={};a.split("|").forEach(function(t,e){t.split("-").forEach(function(t){h[t]=e})}),e.getFrequency=function(t){var e=t.split(l),i=h[e[0]],a=(e[1]||n)-n;return o*Math.pow(Math.pow(2,1/12),i)*Math.pow(2,a)},e.getDuration=function(t){return r.test(t)?parseFloat(t):t.toLowerCase().split("").reduce(function(t,e){return t+("w"===e?4:"h"===e?2:"q"===e?1:"e"===e?.5:"s"===e?.25:0)},0)},i.prototype.createFxNodes=function(){var t=[["bass",100],["mid",1e3],["treble",2500]],e=this.gain=this.ac.createGain();return t.forEach(function(t,i){(i=this[t[0]]=this.ac.createBiquadFilter()).type="peaking",i.frequency.value=t[1],e.connect(e=i)}.bind(this)),e.connect(this.ac.destination),this},i.prototype.push=function(){return Array.prototype.forEach.call(arguments,function(t){this.notes.push(t instanceof e?t:new e(t))}.bind(this)),this},i.prototype.createCustomWave=function(t,e){e||(e=t),this.waveType="custom",this.customWave=[new Float32Array(t),new Float32Array(e)]},i.prototype.createOscillator=function(){return this.stop(),this.osc=this.ac.createOscillator(),this.customWave?this.osc.setPeriodicWave(this.ac.createPeriodicWave.apply(this.ac,this.customWave)):this.osc.type=this.waveType||"square",this.osc.connect(this.gain),this},i.prototype.scheduleNote=function(t,e){var i=60/this.tempo*this.notes[t].duration,a=i*(1-(this.staccato||0));return this.setFrequency(this.notes[t].frequency,e),this.smoothing&&this.notes[t].frequency&&this.slide(t,e,a),this.setFrequency(0,e+a),e+i},i.prototype.getNextNote=function(t){return this.notes[t<this.notes.length-1?t+1:0]},i.prototype.getSlideStartDelay=function(t){return t-Math.min(t,60/this.tempo*this.smoothing)},i.prototype.slide=function(t,e,i){var a=this.getNextNote(t),o=this.getSlideStartDelay(i);return this.setFrequency(this.notes[t].frequency,e+o),this.rampFrequency(a.frequency,e+i),this},i.prototype.setFrequency=function(t,e){return this.osc.frequency.setValueAtTime(t,e),this},i.prototype.rampFrequency=function(t,e){return this.osc.frequency.linearRampToValueAtTime(t,e),this},i.prototype.play=function(t){return t="number"==typeof t?t:this.ac.currentTime,this.createOscillator(),this.osc.start(t),this.notes.forEach(function(e,i){t=this.scheduleNote(i,t)}.bind(this)),this.osc.stop(t),this.osc.onended=this.loop?this.play.bind(this,t):null,this},i.prototype.stop=function(){return this.osc&&(this.osc.onended=null,this.osc.disconnect(),this.osc=null),this},t.Note=e,t.Sequence=i});var synth=new SfxrSynth;window.jsfxr=function(t){synth._params.setSettings(t);var e=synth.totalReset(),i=new Uint8Array(4*((e+1)/2|0)+44),a=2*synth.synthWave(new Uint16Array(i.buffer,44),e),o=new Uint32Array(i.buffer,0,44);o[0]=1179011410,o[1]=a+36,o[2]=1163280727,o[3]=544501094,o[4]=16,o[5]=65537,o[6]=44100,o[7]=88200,o[8]=1048578,o[9]=1635017060,o[10]=a,a+=44;for(var r=0,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s="data:audio/wav;base64,";r<a;r+=3){var l=i[r]<<16|i[r+1]<<8|i[r+2];s+=n[l>>18]+n[l>>12&63]+n[l>>6&63]+n[63&l]}return s};var keySource=jsfxr([0,,.0164,.5154,.2574,.8994,,,,,,.5116,.5301,,,,,,1,,,,,.5]),keySfx=new Audio;keySfx.src=keySource;var stepSource=jsfxr([0,,.0348,,.1451,.344,,-.5765,-.104,,,,,.5122,,,,,1,,,,,.368]),stepSfx=new Audio;stepSfx.src=stepSource;var doorSource=jsfxr([0,,.0871,.4169,.2305,.584,,,,,,.4559,.576,,,,,,1,,,,,.5]),doorSfx=new Audio;doorSfx.src=doorSource;var lockedSource=jsfxr([0,,.061,,.154,.5381,,-.6061,,,,,,.5983,,,,,1,,,.1389,,.5]),lockedSfx=new Audio;lockedSfx.src=lockedSource;var map=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,2,2,2,2,4,2,4,4,4,4,4,4,4,2,4,4,4,4,4,2,4,2,2,4,2,2,2,2,2,4,4,4,4,2,4,2,2,2,2,4,2,2,2,2,4,2,2,2,4,2,4,2,2,4,2,2,4,2,2,4,2,2,4,2,4,4,4,4,2,4,4,4,4,4,4,2,4,2,4,2,4,2,2,4,2,2,4,2,2,4,2,2,4,2,4,2,2,4,2,2,2,2,2,2,4,2,4,2,4,2,4,2,2,4,2,2,4,2,2,4,2,2,2,2,4,2,2,4,2,4,4,4,4,2,4,2,4,2,4,2,4,2,2,4,2,2,4,2,2,4,2,4,2,2,4,2,4,4,2,4,2,2,4,2,4,2,4,2,4,2,4,2,2,4,2,2,4,2,2,4,2,4,2,2,4,2,4,2,2,4,2,2,4,2,4,2,4,2,2,2,4,2,2,4,2,2,4,2,2,4,2,4,2,2,4,2,4,2,2,2,2,2,4,2,4,2,4,4,4,4,4,2,2,4,2,4,4,4,4,4,2,4,2,2,4,2,4,2,2,4,2,4,4,2,4,2,2,2,2,2,4,2,2,4,2,4,2,2,2,2,2,4,2,2,4,2,4,2,2,4,2,4,2,2,4,4,4,4,4,4,4,2,2,4,2,4,2,4,4,4,4,4,2,2,4,2,4,2,2,4,2,4,2,2,2,2,2,4,2,4,2,2,2,4,2,4,2,4,2,2,2,4,2,2,4,2,4,4,4,4,2,4,2,2,2,2,2,4,2,4,2,2,2,4,2,2,2,4,2,2,2,2,2,2,4,2,2,2,2,2,2,4,2,4,4,4,4,4,2,4,2,2,2,4,4,4,4,4,4,4,4,4,2,2,4,4,4,4,4,4,4,4,2,2,2,2,2,4,2,4,2,2,2,4,2,2,2,2,2,2,4,4,4,4,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,2,2,4,4,4,2,2,2,2,2,2,2,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,2,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,2,2,2,2,2,2,2,2,2,2,4,2,2,2,2,2,2,2,2,4,2,2,2,2,2,2,4,4,4,2,4,4,4,4,4,4,4,4,4,4,4,2,2,4,4,4,4,4,4,4,2,2,2,2,2,2,2,4,2,2,4,2,2,2,4,2,4,2,2,2,4,2,2,4,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,2,4,2,4,2,4,2,4,2,4,2,4,2,2,4,2,4,4,4,4,4,4,4,4,4,4,4,4,4,2,2,4,2,4,2,4,2,4,2,4,2,2,2,2,4,2,4,2,2,2,2,2,2,2,2,2,2,2,4,2,4,4,2,4,2,2,2,2,2,4,2,4,2,2,4,2,4,2,4,2,2,2,2,2,2,2,2,2,4,2,2,2,2,4,4,4,4,4,4,4,2,4,2,2,4,2,4,2,4,4,4,4,4,4,4,4,4,4,4,2,4,4,4,4,2,2,2,2,2,2,2,4,2,2,4,2,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,2,4,4,4,4,4,4,4,2,2,4,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,2,2,2,2,4,2,2,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,4,4,4,4,2,2,4,2,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,4,2,2,4,2,2,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],item=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,0,0,0,0,0,0,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Player={};Player.life=250,Player.key=0,Player.mainKey=0,Player.posX=15,Player.posY=18,Player.tempMap=[],Player.tempItem=[],Player.init=function(){this.life=250,this.key=0,this.mainKey=0,this.posX=15,this.posY=18,this.tempMap=[],this.tempItem=[];for(t=0;t<map.length;t++)this.tempMap.push(map[t]);for(var t=0;t<item.length;t++)this.tempItem.push(item[t])},Player.init();var fontWidth=16,fontHeight=16,Font={};Font.letterArr=[" ","!",'"',"#","$","%","&","'","(",")","_","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","[","\\","]",-1,-1],Font.drawText=function(t,e,i){for(var a=0;a<t.length;a++){var o=this.getCoordinate(t.charAt(a));ctx.drawImage(font,o.x,o.y,fontWidth,fontHeight,e+fontWidth*a,i,fontWidth,fontHeight)}},Font.getCoordinate=function(t){var e=this.letterArr.indexOf(t);return{x:e%16*fontWidth,y:Math.floor(e/16)*fontHeight}};var mapWidth=30,mapHeight=30,tileWidth=32,tileHeight=32,gameState=0,font=new Image,fontLoaded=!1;font.onload=function(){fontLoaded=!0};var asset=new Image,assetLoaded=!1;asset.onload=function(){assetLoaded=!0},font.src="asset/font.png",asset.src="asset/games.png";var canvas,ctx;document.addEventListener("keydown",keyDownHandler,!1);var ac=new AudioContext,tempo=60,sequence=new TinyMusic.Sequence(ac,tempo,["-   e","Bb3 e","A3  e","Bb3 e","G3  e","A3  e","F3  e","G3  e","E3  e","F3  e","G3  e","F3  e","E3  e","F3  e","D3  q","-   e","D4  s","C4  s","D4  e","Bb3 e","C4  e","Bb3 e","A3  e","Bb3 e","G3  e","A3  e","Bb3 e","A3  e","G3  s","A3  s","G3  e","F3  q"]);sequence.loop=!0,sequence.gain.gain.value=.25;