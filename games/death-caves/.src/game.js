let{init:init,initKeys:initKeys,Sprite:Sprite,Text:Text,collides:collides,keyPressed:keyPressed,load:load,setImagePath:setImagePath,imageAssets:imageAssets,GameLoop:GameLoop,randInt:randInt}=kontra,{canvas:canvas,context:context}=init();initKeys();let overlay=document.querySelector(".overlay"),scoreBoard=document.querySelector(".scoreBoard"),gameOver=document.querySelector(".gameOver");function playGame(){load("rock.png","c.png","left.png","right.png").then((function(){overlay.style.display="none",gameOver.style.display="none",scoreBoard.style.display="block",zzfxV=.3,zzfx=(e=1,t=.05,s=220,n=0,a=0,o=.1,l=0,r=1,i=0,p=0,d=0,u=0,c=0,x=0,y=0,v=0,f=0,m=1,h=0,I=0)=>{let g,S,z=Math,k=44100,A=2*z.PI,w=i*=500*A/k/k,T=s*=(1-t+2*t*z.random(t=[]))*A/k,B=0,E=0,b=0,P=1,L=0,G=0,q=0;for(p*=500*A/k**3,y*=A/k,d*=A/k,u*=k,c=k*c|0,S=(n=k*n+9)+(h*=k)+(a*=k)+(o*=k)+(f*=k)|0;b<S;t[b++]=q)++G%(100*v|0)||(q=l?1<l?2<l?3<l?z.sin((B%A)**3):z.max(z.min(z.tan(B),1),-1):1-(2*B/A%2+2)%2:1-4*z.abs(z.round(B/A)-B/A):z.sin(B),q=(c?1-I+I*z.sin(A*b/c):1)*(0<q?1:-1)*z.abs(q)**r*e*zzfxV*(b<n?b/n:b<n+h?1-(b-n)/h*(1-m):b<n+h+a?m:b<S-f?(S-b-f)/o*m:0),q=f?q/2+(f>b?0:(b<S-f?1:(S-b)/f)*t[b-f|0]/2):q),g=(s+=i+=p)*z.cos(y*E++),B+=g-g*x*(1-1e9*(z.sin(b)+1)%2),P&&++P>u&&(s+=d,T+=d,P=0),!c||++L%c||(s=T,i=w,P=P||1);return(e=zzfxX.createBuffer(1,S,k)).getChannelData(0).set(t),(s=zzfxX.createBufferSource()).buffer=e,s.connect(zzfxX.destination),s.start(),s},zzfxX=new(window.AudioContext||webkitAudioContext);let e=[],t=3,s=40,n=!0;let a,o,l=0,r=document.getElementById("canvas"),i=(e,t,s,n,a,o,l,r)=>Text({type:e,text:t,font:s,color:"white",x:n,y:a,dy:o,dx:l,ttl:r});function p(e,t,s){return Sprite({id:e,type:"rock",x:t,y:s,dy:1,image:imageAssets.rock})}let d=Sprite({type:"player",x:150,y:125,image:imageAssets.left});function u(){let p=!0,u=!0;for(value of(e.forEach((e=>{e.update()})),l+=.01,document.getElementById("score").innerText=Math.ceil(l),e))value.y>123&&value.y<125&&"rock"===value.type&&(zzfx(...[1.05,,993,.02,.18,.48,4,1.77,1,,,,.12,.9,,.2,,.47,.08,.49]),r.style.animation="shake 0.5s 1",setTimeout((()=>{r.style.animation=""}),500)),value.y>=125&&(value.dy=0,value.x<d.x&&d.x-value.x<=25&&"rock"===value.type?u=!1:value.x>d.x&&value.x-d.x<=15&&"rock"===value.type?p=!1:(value.x>d.x&&value.x-d.x<=15||value.x<d.x&&d.x-value.x<=15&&"gold"===value.type)&&(value.ttl=0,zzfx(...[1.25,,201,,.07,.17,1,.74,,,169,.08,,,,,,.72,,.07]),l+=5));d.x<=3?d.x=3:d.x>=canvas.width-28&&(d.x=canvas.width-28),p&&keyPressed("arrowright")&&(d.image=imageAssets.right,d.x+=1,d.y=randInt(120,125),a=!0,o=!1),u&&keyPressed("arrowleft")&&(d.image=imageAssets.left,d.x-=1,d.y=randInt(120,125),o=!0,a=!1),s>0&&(keyPressed("space")&&n&&a?(n=!1,setTimeout((()=>n=!0),750),e.push(i("bullet","ðŸ§¨","10px Arial",d.x+20,d.y+3,0,2,1200)),s-=1,zzfx(...[1.02,,429,.01,.09,.06,1,.24,-5.9,,,,.09,.9,,.1,,.86,.09,.23])):keyPressed("space")&&n&&o&&(n=!1,setTimeout((()=>n=!0),750),e.push(i("bullet","ðŸ§¨","10px Arial",d.x-5,d.y+3,0,-2,1200)),s-=1,zzfx(...[1.02,,429,.01,.09,.06,1,.24,-5.9,,,,.09,.9,,.1,,.86,.09,.23])));for(let n of e)"rock"===n.type&&collides(d,n)&&(n.ttl=0,t-=1,zzfx(...[,,499,.01,.09,.2,,1.78,1.8,,,,.08,,15,,,.56,.05]),r.style.height="56vh",r.style.width="760px",setTimeout((()=>{r.style.height="530px",r.style.width="900px"}),100)),"life"===n.type&&collides(d,n)&&(n.ttl=0,t+=1,zzfx(...[1.07,,459,.09,.27,.27,,1.62,,1.7,-153,.04,.05,,,,,.53,.14,.3]),l+=20),"explosive"===n.type&&collides(d,n)&&(n.ttl=0,s+=10,zzfx(...[,,594,.06,.11,.47,,1.61,,6.4,-65,.11,.01,,,,,.67,.14,.13]),l+=10);for(const t of e)if("bullet"===t.type){let s=t;for(value2 of e)"rock"===value2.type&&collides(s,value2)&&zzfx(...[1.01,,756,.02,.27,.58,2,3.46,.7,,,,.09,1.4,,.7,,.34,.15]),"rock"!==value2.type&&"gold"!==value2.type||collides(s,value2)&&(value2.type="gold",value2.image=imageAssets.c,s.ttl=0)}e=e.filter((e=>e.isAlive())),t<=0&&(zzfx(...[1.03,,308,.08,.13,.48,,1.71,,.6,-8,.03,.11,,,,,.66,.27,.02]),y.stop(),v.stop(),scoreBoard.style.display="none",gameOver.style.display="block",document.getElementById("finalScore").innerText=Math.ceil(l)),s<=0&&t>1?(t-=1,s+=15,zzfx(...[1.87,,189,.04,.27,.29,1,.61,-9.5,,-5,.18,.19,,,,.13,.74,.24,.36])):s<=0&&t<=1&&setTimeout((()=>{t=0,document.getElementById("extraInfo").innerText="You had no explosives for too long"}),6e3),document.getElementById("lives").innerText=t,document.getElementById("explosives").innerText=s}function c(){e.forEach((e=>e.render()))}var x;e.push(p(1,randInt(2,45),0)),e.push(p(2,randInt(50,70),-50)),e.push(p(3,randInt(100,130),-20)),e.push(p(4,randInt(140,180),-35)),e.push(p(5,randInt(200,240),-20)),e.push(p(6,randInt(250,280),-10)),e.push(d);var y=kontra.GameLoop({update:function(){u()},fps:60,render:function(){c()}});y.start();var v=kontra.GameLoop({update:function(){u(),x=!0},fps:80,render:function(){c()}});window.addEventListener("blur",(()=>{x||y.stop(),x&&v.stop()})),setTimeout((()=>{y.stop(),v.start(),setInterval((()=>{y.isStopped&&v.isStopped||e.push(p(7,randInt(2,90),-10))}),3e3),setInterval((()=>{y.isStopped&&v.isStopped||e.push(p(8,randInt(95,190),-35))}),3133),setInterval((()=>{y.isStopped&&v.isStopped||e.push(p(9,randInt(200,280),0))}),3899),setInterval((()=>{y.isStopped&&v.isStopped||e.push(i("explosive","ðŸ’£","10px Arial",randInt(10,290),0,1,0,1200))}),13e3)}),18e4),setInterval((()=>{y.isStopped&&v.isStopped||e.push(i("life","ðŸ’–","10px Arial",randInt(10,290),0,1,0,1200))}),6e4),setInterval((()=>{y.isStopped&&v.isStopped||e.push(i("explosive","ðŸ’£","10px Arial",randInt(10,290),0,1,0,1200))}),15e3),setInterval((()=>{y.isStopped&&v.isStopped||e.push(p(1,randInt(2,45),0))}),6899),setInterval((()=>{y.isStopped&&v.isStopped||e.push(p(2,randInt(50,85),-50))}),6111),setInterval((()=>{y.isStopped&&v.isStopped||e.push(p(3,randInt(100,130),-20))}),6989),setInterval((()=>{y.isStopped&&v.isStopped||e.push(p(4,randInt(140,180),-35))}),6133),setInterval((()=>{y.isStopped&&v.isStopped||e.push(p(5,randInt(200,240),-20))}),5773),setInterval((()=>{y.isStopped&&v.isStopped||e.push(p(6,randInt(250,280),-10))}),6e3),window.addEventListener("focus",(()=>{x||y.start(),x&&v.start()}))}))}setImagePath(""),document.querySelector(".playBtn").addEventListener("click",playGame),document.querySelector(".playAgain").addEventListener("click",(()=>location.reload()));