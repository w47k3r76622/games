<!doctype html><html><head><style>@keyframes flash{from{background-color:#000}to{background-color:red}}@keyframes story{80%{width:600px}100%{transform:rotateX(360deg);width:600px}}.flash{animation:flash .5s 5 alternate}.story{animation:story 5s forwards}p{color:#fff;font:14px Wawati SC;overflow:hidden;margin-left:auto;margin-right:auto;width:0;z-index:100;top:50px;transform:rotateX(180deg);position:relative}</style><script>"use strict";var CPlayer=function(){var r,n,i,t,a,e=function(r){return Math.sin(6.283184*r)},o=function(r){return 2*(r%1)-1},f=function(r){return.5>r%1?1:-1},u=function(r){var n=r%1*4;return 2>n?n-1:3-n},c=function(r){return.003959503758*Math.pow(2,(r-128)/12)},h=function(r,n,i){var t,a,e,o,f,u,h,s=v[r.i[0]],w=r.i[1],M=r.i[3],p=v[r.i[4]],y=r.i[5],g=r.i[8],A=r.i[9],l=r.i[10]*r.i[10]*4,L=r.i[11]*r.i[11]*4,I=r.i[12]*r.i[12]*4,d=1/I,D=r.i[13],P=i*Math.pow(2,2-r.i[14]),m=new Int32Array(l+L+I),C=0,U=0;for(t=0,a=0;l+L+I>t;t++,a++)a>=0&&(D=D>>8|(255&D)<<4,a-=P,u=c(n+(15&D)+r.i[2]-128),h=c(n+(15&D)+r.i[6]-128)*(1+8e-4*r.i[7])),e=1,l>t?e=t/l:t>=l+L&&(e-=(t-l-L)*d),o=u,M&&(o*=e*e),C+=o,f=s(C)*w,o=h,g&&(o*=e*e),U+=o,f+=p(U)*y,A&&(f+=(2*Math.random()-1)*A),m[t]=80*f*e|0;return m},v=[e,f,o,u];this.init=function(e){r=e,n=e.endPattern-2,i=0,t=e.rowLen*e.patternLen*(n+1)*2,a=new Int32Array(t)},this.generate=function(){var o,f,u,c,s,w,M,p,y,g,A,l,L,I,d=new Int32Array(t),D=r.songData[i],P=r.rowLen,m=r.patternLen,C=0,U=0,W=!1,b=[];for(u=0;n>=u;++u)for(M=D.p[u],c=0;m>c;++c){var j=M?D.c[M-1].f[c]:0;j&&(D.i[j-1]=D.c[M-1].f[c+m]||0,15>j&&(b=[]));var k=v[D.i[15]],q=D.i[16]/512,x=Math.pow(2,D.i[17]-9)/P,z=D.i[18],B=D.i[19],E=43.23529*D.i[20]*3.141592/44100,F=1-D.i[21]/255,G=1e-5*D.i[22],H=D.i[23]/32,J=D.i[24]/512,K=6.283184*Math.pow(2,D.i[25]-9)/P,N=D.i[26]/255,O=D.i[27]*P;for(A=(u*m+c)*P,s=0;4>s;++s)if(w=M?D.c[M-1].n[c+s*m]:0){b[w]||(b[w]=h(D,w,P));var Q=b[w];for(f=0,o=2*A;f<Q.length;f++,o+=2)d[o]+=Q[f]}for(f=0;P>f;f++)p=2*(A+f),g=d[p],g||W?(l=E,z&&(l*=k(x*p)*q+.5),l=1.5*Math.sin(l),C+=l*U,L=F*(g-U)-C,U+=l*L,g=3==B?U:1==B?L:C,G&&(g*=G,g=1>g?g>-1?e(.25*g):-1:1,g/=G),g*=H,W=g*g>1e-5,y=Math.sin(K*p)*J+.5,I=g*(1-y),g*=y):I=0,p>=O&&(I+=d[p-O+1]*N,g+=d[p-O]*N),d[p]=0|I,d[p+1]=0|g,a[p]+=0|I,a[p+1]+=0|g}return i++,i/8},this.createWave=function(){var r=2*t-8,n=r-36,i=44,e=new Uint8Array(i+2*t);e.set([82,73,70,70,255&r,r>>8&255,r>>16&255,r>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&n,n>>8&255,n>>16&255,n>>24&255]);for(var o=0,f=i;t>o;++o){var u=a[o];u=-32767>u?-32767:u>32767?32767:u,e[f++]=255&u,e[f++]=u>>8&255}return e},this.getData=function(r,n){for(var i=2*Math.floor(44100*r),t=new Array(n),e=0;2*n>e;e+=1){var o=i+e;t[e]=r>0&&o<a.length?a[o]/32768:0}return t}};
function SfxrParams(){this.setSettings=function(r){for(var a=0;24>a;a++)this[String.fromCharCode(97+a)]=r[a]||0;this.c<.01&&(this.c=.01);var t=this.b+this.c+this.e;if(.18>t){var e=.18/t;this.b*=e,this.c*=e,this.e*=e}}}function SfxrSynth(){this._params=new SfxrParams;var r,a,t,e,s,n,i,h,f,c,o,v;this.reset=function(){var r=this._params;e=100/(r.f*r.f+.001),s=100/(r.g*r.g+.001),n=1-r.h*r.h*r.h*.01,i=-r.i*r.i*r.i*1e-6,r.a||(o=.5-r.n/2,v=5e-5*-r.o),h=1+r.l*r.l*(r.l>0?-.9:10),f=0,c=1==r.m?0:(1-r.m)*(1-r.m)*2e4+32},this.totalReset=function(){this.reset();var e=this._params;return r=e.b*e.b*1e5,a=e.c*e.c*1e5,t=e.e*e.e*1e5+12,3*((r+a+t)/3|0)},this.synthWave=function(u,b){var w=this._params,m=1!=w.s||w.v,y=w.v*w.v*.1,g=1+3e-4*w.w,k=w.s*w.s*w.s*.1,S=1+1e-4*w.t,l=1!=w.s,p=w.x*w.x,d=w.g,x=w.q||w.r,A=w.r*w.r*w.r*.2,q=w.q*w.q*(w.q<0?-1020:1020),M=w.p?((1-w.p)*(1-w.p)*2e4|0)+32:0,_=w.d,U=w.j/2,j=w.k*w.k*.01,C=w.a,P=r,R=1/r,W=1/a,z=1/t,B=5/(1+w.u*w.u*20)*(.01+k);B>.8&&(B=.8),B=1-B;for(var D,E,F,G,H,I,J=!1,K=0,L=0,N=0,O=0,Q=0,T=0,V=0,X=0,Y=0,Z=0,$=new Array(1024),rr=new Array(32),ar=$.length;ar--;)$[ar]=0;for(var ar=rr.length;ar--;)rr[ar]=2*Math.random()-1;for(var ar=0;b>ar;ar++){if(J)return ar;if(M&&++Y>=M&&(Y=0,this.reset()),c&&++f>=c&&(c=0,e*=h),n+=i,e*=n,e>s&&(e=s,d>0&&(J=!0)),E=e,U>0&&(Z+=j,E*=1+Math.sin(Z)*U),E|=0,8>E&&(E=8),C||(o+=v,0>o?o=0:o>.5&&(o=.5)),++L>P)switch(L=0,++K){case 1:P=a;break;case 2:P=t}switch(K){case 0:N=L*R;break;case 1:N=1+2*(1-L*W)*_;break;case 2:N=1-L*z;break;case 3:N=0,J=!0}x&&(q+=A,F=0|q,0>F?F=-F:F>1023&&(F=1023)),m&&g&&(y*=g,1e-5>y?y=1e-5:y>.1&&(y=.1)),I=0;for(var tr=8;tr--;){if(V++,V>=E&&(V%=E,3==C))for(var er=rr.length;er--;)rr[er]=2*Math.random()-1;switch(C){case 0:H=o>V/E?.5:-.5;break;case 1:H=1-V/E*2;break;case 2:G=V/E,G=6.28318531*(G>.5?G-1:G),H=1.27323954*G+.405284735*G*G*(0>G?1:-1),H=.225*((0>H?-1:1)*H*H-H)+H;break;case 3:H=rr[Math.abs(32*V/E|0)]}m&&(D=T,k*=S,0>k?k=0:k>.1&&(k=.1),l?(Q+=(H-T)*k,Q*=B):(T=H,Q=0),T+=Q,O+=T-D,O*=1-y,H=O),x&&($[X%1024]=H,H+=$[(X-F+1024)%1024],X++),I+=H}I*=.125*N*p,u[ar]=I>=1?32767:-1>=I?-32768:32767*I|0}return b}}var synth=new SfxrSynth;window.jsfxr=function(r){synth._params.setSettings(r);var a=synth.totalReset(),t=new Uint8Array(4*((a+1)/2|0)+44),e=2*synth.synthWave(new Uint16Array(t.buffer,44),a),s=new Uint32Array(t.buffer,0,44);s[0]=1179011410,s[1]=e+36,s[2]=1163280727,s[3]=544501094,s[4]=16,s[5]=65537,s[6]=44100,s[7]=88200,s[8]=1048578,s[9]=1635017060,s[10]=e,e+=44;for(var n=0,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="data:audio/wav;base64,";e>n;n+=3){var f=t[n]<<16|t[n+1]<<8|t[n+2];h+=i[f>>18]+i[f>>12&63]+i[f>>6&63]+i[63&f]}return h};
var soundManager=function(){function n(n){return jsfxr([0,.0596,.7064,.0081,.36,n,,-4e-4,,,.2157,-.7315,,,.0199,.521,-.2162,-.0148,.31,-.0077,.7212,,,.5])}var a=new Audio,e=new CPlayer,r=[n(.18),n(.2),n(.1465),n(.2599),n(.14),n(.1264)],c=[jsfxr([0,,.7797,.0119,.4994,.1269,,-.0403,-.1117,,.7201,.3971,,.0417,-.0052,,-.2124,-.5039,.7312,.01,,.008,-7e-4,.5])],o=[jsfxr([0,.162,.5877,.1306,.0162,.174,,.0667,-.0124,.8225,,.0288,.3508,,-.9339,.5889,-.2865,-.0057,.6608,-.0142,.4854,.1261,.0351,.5])],p=[jsfxr([2,.1987,.01,.1879,.0546,.5352,,.001,-.0335,.0945,.7083,-.5801,,.2778,.0232,,-.89,-.1085,1,.103,.6283,.0205,.0992,.5])],t=[jsfxr([3,,.8322,8e-4,.1136,.5007,,-.0406,.0129,.5741,.0328,-.6105,.4488,.1968,-.0012,,.3845,.1591,.0584,.6495,.0575,.0154,.0053,.5])],i=[jsfxr([3,.0046,.6902,.425,.6979,.8763,,-.6451,-1e-4,.2544,,-.3907,.9039,,-.0802,.5166,-.0351,.3129,.6215,.0915,,.0011,.034,.5])],l=[jsfxr([1,.3132,.3794,.1442,.7257,.5797,,.0623,-.1481,.3722,,-.6773,,.7766,-.3999,,-.002,.6031,.9723,-.0185,.4156,.0439,-.4949,.5])],f=[jsfxr([0,.7909,.01,.2248,.8564,.5019,,.0552,-.0023,,.4751,.3358,-.7351,.467,-.3839,.6577,.0969,-.5708,.7606,-1e-4,,.3454,.027,.5])],s={songData:[{i:[1,192,128,0,1,191,116,9,0,0,6,22,34,0,0,0,69,3,1,1,23,167,0,32,77,6,25,6],p:[1,1,1],c:[{n:[159,158,152,161,152,156,158,147,149,151,151,151,152,158,159,147,161,158,151,156,152,159,147,161,158,152,156,147],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]}],rowLen:5513,patternLen:32,endPattern:4},u=0;for(e.init(s);(u=e.generate())&&!(u>=1););var y=new Audio(URL.createObjectURL(new Blob([e.createWave()],{type:"audio/wav"})));y.volume=.3,y.loop=!0;var d=function(){y.play()},j=function(){y.pause()},v=function(n){a.src=r[n],a.play()},x=function(){a.src=c,a.play()},w=function(){a.src=o,a.play()},g=function(){a.src=p,a.play()},L=function(){a.src=t,a.play(),a.onended=function(){a.src=i,a.play(),a.onended=null}},B=function(){a.src=l,a.play()},S=function(){a.src=f,a.play()};return{playGameOver:B,playFlashSound:v,playEntrance:x,playFail:w,playStartHover:g,playExplosion:L,playStory:S,playBg:d,stopBg:j}}();
var constants=function(){var r=["255,0,0","0,255,0","0,0,255","200,200,0","200,0,200","0,200,200"],s=[[0,0],[45,0],[90,0],[136,0],[181,0],[226,0]],n=[[0,1,2],[3,4,5]];return{colors:r,bossSpriteMap:s,bossSpriteSquence:n}}();
function ga(e,t,r,a,n){return GA.create(e,t,r,a,n)}var GA=GA||{};GA.plugins=void 0,GA.custom=void 0,GA.create=function(e,t,r,a,n){function i(){if(requestAnimationFrame(i,f.canvas),void 0===f._fps)s();else{var e=Date.now(),t=e-f._startTime;for(t>1e3&&(t=f._frameDuration),f._startTime=e,f._lag+=t;f._lag>=f._frameDuration;)o(),s(),f._lag-=f._frameDuration;var r=f._lag/f._frameDuration;f.render(f.canvas,r)}}function o(){function e(t){t._previousX=t.x,t._previousY=t.y,t.children&&t.children.length>0&&t.children.forEach(function(t){e(t)})}f.stage.children.forEach(function(t){e(t)})}function s(){if(f.buttons.length>0){f.canvas.style.cursor="auto";for(var e=f.buttons.length-1;e>=0;e--){var t=f.buttons[e];void 0!=t&&void 0!=t.update&&(t.update(f.pointer,f.canvas),("over"===t.state||"down"===t.state)&&(t.stage||(f.canvas.style.cursor="pointer")))}}if(f.state&&!f.paused&&f.state(),0!==f.updateFunctions.length)for(var r=0;r<f.updateFunctions.length;r++){var a=f.updateFunctions[r];a()}}function u(e){e.x=0,e.y=0,e.vx=0,e.vy=0,e.width=0,e.height=0,e.scaleX=1,e.scaleY=1,e.pivotX=.5,e.pivotY=.5,e.rotation=0,e.visible=!0,e.parent=void 0,e.stage=!1,e.shadow=!1,e.shadowColor="rgba(100, 100, 100, 0.5)",e.shadowOffsetX=3,e.shadowOffsetY=3,e.shadowBlur=3,e.blendMode=void 0,e._alpha=1,e._draggable=void 0,e._layer=0,e._circular=!1,e._interactive=!1,e._previousX=void 0,e._previousY=void 0,e.children=[],e.addChild=function(t){t.parent&&t.parent.removeChild(t),t.parent=e,e.children.push(t)},e.removeChild=function(t){if(t.parent!==e)throw new Error(t+"is not a child of "+e);e.children.splice(e.children.indexOf(t),1)},e.remove=function(t){var r=Array.prototype.slice.call(arguments);r.length>1?r.forEach(function(t){e.removeChild(t)}):e.removeChild(r[0])},e.setPosition=function(t,r){e.x=t,e.y=r};var t=e;e.putCenter=function(r,a,n){a=a||0,n=n||0,r.x=t.x+t.halfWidth-r.halfWidth+a,r.y=t.y+t.halfHeight-r.halfHeight+n,e.compensateForParentPosition(t,r)},e.putRight=function(r,a,n){a=a||0,n=n||0,r.x=t.x+t.width+a,r.y=t.y+t.halfHeight-r.halfHeight+n,e.compensateForParentPosition(t,r)},e.putLeft=function(r,a,n){a=a||0,n=n||0,r.x=t.x-r.width+a,r.y=t.y+t.halfHeight-r.halfHeight+n,e.compensateForParentPosition(t,r)},e.compensateForParentPosition=function(e,t){(0!==t.parent.gx||0!==t.parent.gy)&&(t.x-=e.gx,t.y-=e.gy)},Object.defineProperties(e,{gx:{get:function(){return this.parent?this.x+this.parent.gx:this.x},enumerable:!0,configurable:!0},gy:{get:function(){return this.parent?this.y+this.parent.gy:this.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:e.x,y:e.y}},enumerable:!0,configurable:!0},alpha:{get:function(){var t=e.parent._alpha*e._alpha;return t},set:function(t){e._alpha=t},enumerable:!0,configurable:!0},halfWidth:{get:function(){return e.width/2},enumerable:!0,configurable:!0},halfHeight:{get:function(){return e.height/2},enumerable:!0,configurable:!0},centerX:{get:function(){return e.x+e.halfWidth},enumerable:!0,configurable:!0},centerY:{get:function(){return e.y+e.halfHeight},enumerable:!0,configurable:!0},circular:{get:function(){return e._circular},set:function(t){t===!0&&e._circular===!1&&(l(e),e._circular=!0),t===!1&&e._circular===!0&&(delete e.diameter,delete e.radius,e._circular=!1)},enumerable:!0,configurable:!0},interactive:{get:function(){return e._interactive},set:function(t){t===!0&&(d(e),e._interactive=!0),t===!1&&(f.buttons.splice(f.buttons.indexOf(e),1),e._interactive=!1)},enumerable:!0,configurable:!0}})}function l(e){Object.defineProperties(e,{diameter:{get:function(){return e.width},set:function(t){e.width=t,e.height=t},enumerable:!0,configurable:!0},radius:{get:function(){return e.width/2},set:function(t){e.width=2*t,e.height=2*t},enumerable:!0,configurable:!0}})}function c(){var e={};return u(e),e.stage=!0,e.width=f.canvas.width,e.height=f.canvas.height,e.x=0,e.y=0,e.parent=void 0,e}function d(e){e.press=e.press||void 0,e.release=e.release||void 0,e.over=e.over||void 0,e.out=e.out||void 0,e.tap=e.tap||void 0,e.state="up",e.action="",e.pressed=!1,e.enabled=!0,e.hoverOver=!1,f.buttons.push(e),e.update=function(t,r){if(e.enabled){var a=f.pointer.hitTestSprite(e);t.isUp&&(e.state="up"),a&&(e.state="over",t.isDown&&(e.state="down")),"down"===e.state&&(e.pressed||(e.press&&e.press(),e.pressed=!0,e.action="pressed")),"over"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released",f.pointer.tapped&&e.tap&&e.tap()),e.hoverOver||(e.over&&e.over(),e.hoverOver=!0)),"up"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released"),e.hoverOver&&(e.out&&e.out(),e.hoverOver=!1))}}}function h(){var e={};return e._x=0,e._y=0,Object.defineProperties(e,{x:{get:function(){return e._x/f.scale},enumerable:!0,configurable:!0},y:{get:function(){return e._y/f.scale},enumerable:!0,configurable:!0},centerX:{get:function(){return e.x},enumerable:!0,configurable:!0},centerY:{get:function(){return e.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:e.x,y:e.y}},enumerable:!0,configurable:!0}}),e.isDown=!1,e.isUp=!0,e.tapped=!1,e.downTime=0,e.elapsedTime=0,e.press=void 0,e.release=void 0,e.tap=void 0,e.dragSprite=null,e.dragOffsetX=0,e.dragOffsetY=0,e.moveHandler=function(t){e._x=t.pageX-t.target.offsetLeft,e._y=t.pageY-t.target.offsetTop,t.preventDefault()},e.touchmoveHandler=function(t){e._x=t.targetTouches[0].pageX-f.canvas.offsetLeft,e._y=t.targetTouches[0].pageY-f.canvas.offsetTop,t.preventDefault()},e.downHandler=function(t){e._x=t.pageX-t.target.offsetLeft,e._y=t.pageY-t.target.offsetTop,e.isDown=!0,e.isUp=!1,e.tapped=!1,e.downTime=Date.now(),e.press&&e.press(),t.preventDefault()},e.touchstartHandler=function(t){e._x=t.targetTouches[0].pageX-f.canvas.offsetLeft,e._y=t.targetTouches[0].pageY-f.canvas.offsetTop,e.isDown=!0,e.isUp=!1,e.tapped=!1,e.downTime=Date.now(),e.press&&e.press(),t.preventDefault()},e.upHandler=function(t){e.elapsedTime=Math.abs(e.downTime-Date.now()),e.elapsedTime<=200&&(e.tapped=!0,e.tap&&e.tap()),e.isUp=!0,e.isDown=!1,e.release&&e.release(),t.preventDefault()},f.canvas.addEventListener("mousemove",e.moveHandler.bind(e),!1),f.canvas.addEventListener("mousedown",e.downHandler.bind(e),!1),window.addEventListener("mouseup",e.upHandler.bind(e),!1),f.canvas.addEventListener("touchmove",e.touchmoveHandler.bind(e),!1),f.canvas.addEventListener("touchstart",e.touchstartHandler.bind(e),!1),window.addEventListener("touchend",e.upHandler.bind(e),!1),f.canvas.style.touchAction="none",e.hitTestSprite=function(t){var r=!1;if(t.triangular)r=f.canvas.getContext("2d").isPointInPath(t.triangle,e.x,e.y);else if(t.circular){var a=e.x-(t.gx+t.halfWidth),n=e.y-(t.gy+t.halfHeight),i=Math.sqrt(a*a+n*n);r=i<t.radius}else{var o=t.gx,s=t.gx+t.width,u=t.gy,l=t.gy+t.height;r=e.x>o&&e.x<s&&e.y>u&&e.y<l}return r},e}var f={},g=1;if(f.canvas=document.getElementById("canvas"),f.canvas.setAttribute("width",e*g),f.canvas.setAttribute("height",t*g),f.canvas.style.backgroundColor="black",document.body.appendChild(f.canvas),f.canvas.ctx=f.canvas.getContext("2d"),f.stage=c(),f.pointer=h(),f.buttons=[],f.draggableSprites=[],f.tweens=[],f.state=void 0,f.load=n||void 0,f.setup=r||void 0,void 0===f.setup)throw new Error("Please supply the setup function in the constructor");return f.assetFilePaths=a||void 0,f.paused=!1,f._fps=60,f._startTime=Date.now(),f._frameDuration=1e3/f._fps,f._lag=0,f.interpolation=!0,f.updateFunctions=[],f.scale=1,f.start=function(){f.assetFilePaths?(f.assets.whenLoaded=function(){f.state=void 0,f.setup()},f.assets.load(f.assetFilePaths),f.load&&(f.state=f.load)):f.setup(),i()},f.hidePointer=function(){f.canvas.style.cursor="none"},f.showPointer=function(){f.canvas.style.cursor="auto"},Object.defineProperties(f,{fps:{get:function(){return f._fps},set:function(e){f._fps=e,f._startTime=Date.now(),f._frameDuration=1e3/f._fps},enumerable:!0,configurable:!0},backgroundColor:{set:function(e){f.canvas.style.backgroundColor=e},enumerable:!0,configurable:!0}}),f.remove=function(e){var t=Array.prototype.slice.call(arguments);if(t[0]instanceof Array){var r=t[0];if(r.length>0)for(var a=r.length-1;a>=0;a--){var n=r[a];n.parent.removeChild(n),r.splice(r.indexOf(n),1)}}else t.length>1?t.forEach(function(e){e.parent.removeChild(e)}):t[0].parent.removeChild(t[0])},f.circle=function(e,t,r,a,n,i){var o={};return u(o),o.mask=!1,o.width=e||32,o.height=e||32,o.fillStyle=t||"red",o.strokeStyle=r||"none",o.lineWidth=a||"none",o.x=n||0,o.y=i||0,o.flash=!1,f.complexShapes.push(o),f.stage.addChild(o),l(o),o.render=function(e){e.strokeStyle=o.strokeStyle,e.lineWidth=o.lineWidth,e.fillStyle=o.fillStyle,e.beginPath(),e.arc(o.radius+-o.diameter*o.pivotX,o.radius+-o.diameter*o.pivotY,o.radius,0,2*Math.PI,!1),o.mask===!0?e.clip():("none"!==o.strokeStyle&&e.stroke(),"none"!==o.fillStyle&&e.fill())},o.updateFlash=function(){o.flash?(o.alpha>=1?(o.interactive=!0,o.flash=!1):o.alpha+=.02,o.strokeStyle="rgba("+constants.colors[0]+","+o.alpha+")",o.fillStyle="rgba("+constants.colors[0]+","+o.alpha+")"):o.alpha=.5},o},f.text=function(e,t,r,a,n){var i={};return u(i),i.content=e||"Hello!",i.font=t||"12px sans-serif",i.fillStyle=r||"red",i.textBaseline="top",Object.defineProperties(i,{width:{get:function(){return f.canvas.ctx.measureText(i.content).width},enumerable:!0,configurable:!0},height:{get:function(){return f.canvas.ctx.measureText("M").width},enumerable:!0,configurable:!0}}),f.stage.addChild(i),i.x=a||0,i.y=n||0,i.render=function(e){e.strokeStyle=i.strokeStyle,e.lineWidth=i.lineWidth,e.fillStyle=i.fillStyle,0===i.width&&(i.width=e.measureText(i.content).width),0===i.height&&(i.height=e.measureText("M").width),e.translate(-i.width*i.pivotX,-i.height*i.pivotY),e.font=i.font,e.textBaseline=i.textBaseline,e.fillText(i.content,0,0)},i},f.frames=function(e,t,r,a){var n={};return n.image=e,n.data=t,n.width=r,n.height=a,n},f.sprite=function(e){var t={};if(void 0===e)throw new Error("Sprites require a source");return u(t),t.frames=[],t.loop=!0,t._currentFrame=0,t.setTexture=function(e){if(e.image)if(e.image&&!e.data){if(!(f.assets[e.image].source instanceof Image))throw new Error(e.image+" is not an image file");t.source=f.assets[e.image].source,t.sourceX=e.x,t.sourceY=e.y,t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height}else e.image&&e.data&&(t.source=f.assets[e.image].source,t.frames=e.data,t.sourceX=t.frames[0][0],t.sourceY=t.frames[0][1],t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height);else e instanceof Array?(t.frames=e,t.source=f.assets[e[0]].source,t.sourceX=f.assets[e[0]].frame.x,t.sourceY=f.assets[e[0]].frame.y,t.width=f.assets[e[0]].frame.w,t.height=f.assets[e[0]].frame.h,t.sourceWidth=f.assets[e[0]].frame.w,t.sourceHeight=f.assets[e[0]].frame.h):(t.tilesetFrame=f.assets[e],t.source=t.tilesetFrame.source,t.sourceX=t.tilesetFrame.frame.x,t.sourceY=t.tilesetFrame.frame.y,t.width=t.tilesetFrame.frame.w,t.height=t.tilesetFrame.frame.h,t.sourceWidth=t.tilesetFrame.frame.w,t.sourceHeight=t.tilesetFrame.frame.h)},t.setTexture(e),t.gotoAndStop=function(e){if(!(t.frames.length>0))throw new Error("Frame number "+e+"doesn't exist");t.frames[0]instanceof Array?(t.sourceX=t.frames[e][0],t.sourceY=t.frames[e][1]):f.assets[t.frames[e]].frame&&(t.source=f.assets[t.frames[e]].source,t.sourceX=f.assets[t.frames[e]].frame.x,t.sourceY=f.assets[t.frames[e]].frame.y,t.sourceWidth=f.assets[t.frames[e]].frame.w,t.sourceHeight=f.assets[t.frames[e]].frame.h,t.width=f.assets[t.frames[e]].frame.w,t.height=f.assets[t.frames[e]].frame.h),t._currentFrame=e},t.x=0,t.y=0,t.frames.length>0&&(f.addStatePlayer(t),Object.defineProperty(t,"currentFrame",{get:function(){return t._currentFrame},enumerable:!1,configurable:!1})),f.stage.addChild(t),t.render=function(e){e.drawImage(t.source,t.sourceX,t.sourceY,t.sourceWidth,t.sourceHeight,-t.width*t.pivotX,-t.height*t.pivotY,t.width,t.height)},t},f.addStatePlayer=function(e){function t(t){o(),"string"!=typeof t?e.gotoAndStop(t):e.gotoAndStop(e.frames.indexOf(t))}function r(){n([0,e.frames.length-1])}function a(){o(),e.gotoAndStop(e.currentFrame)}function n(t){o(),l=t[0],c=t[t.length-1],u=t.length-1,1===u&&(u=2,s+=1),e.fps||(e.fps=12);var r=1e3/e.fps;e.gotoAndStop(l),h||(d=setInterval(i.bind(this),r),h=!0)}function i(){u>s?(e.gotoAndStop(e.currentFrame+1),s+=1):e.loop&&(e.gotoAndStop(l),s=0)}function o(){void 0!==d&&h===!0&&(h=!1,s=0,l=0,c=0,u=0,clearInterval(d))}var s=0,u=0,l=0,c=0,d=void 0,h=!1;e.show=t,e.play=r,e.stop=a,e.playing=h,e.playSequence=n},f.render=function(e,t){function r(n){if(n.visible&&n.gx<e.width+n.width&&n.gx+n.width>=-n.width&&n.gy<e.height+n.height&&n.gy+n.height>=-n.height){if(a.save(),f.interpolate?(void 0!==n._previousX?n.renderX=(n.x-n._previousX)*t+n._previousX:n.renderX=n.x,void 0!==n._previousY?n.renderY=(n.y-n._previousY)*t+n._previousY:n.renderY=n.y):(n.renderX=n.x,n.renderY=n.y),a.translate(n.renderX+n.width*n.pivotX,n.renderY+n.height*n.pivotY),a.globalAlpha=n.alpha,a.rotate(n.rotation),a.scale(n.scaleX,n.scaleY),n.shadow&&(a.shadowColor=n.shadowColor,a.shadowOffsetX=n.shadowOffsetX,a.shadowOffsetY=n.shadowOffsetY,a.shadowBlur=n.shadowBlur),n.blendMode&&(a.globalCompositeOperation=n.blendMode),n.render&&n.render(a),n.children&&n.children.length>0){a.translate(-n.width*n.pivotX,-n.height*n.pivotY);for(var i=0;i<n.children.length;i++){var o=n.children[i];r(o)}}a.restore()}}var a=e.ctx;a.clearRect(0,0,e.width,e.height);for(var n=0;n<f.stage.children.length;n++){var i=f.stage.children[n];r(i)}},f.assets={toLoad:0,loaded:0,imageExtensions:["png","jpg","gif"],whenLoaded:void 0,load:function(e){var t=this;t.toLoad=e.length,e.forEach(function(e){var r=e.split(".").pop();if(-1!==t.imageExtensions.indexOf(r)){var a=new Image;a.addEventListener("load",function(){a.name=e,t[a.name]={source:a,frame:{x:0,y:0,w:a.width,h:a.height}},t.loadHandler()},!1),a.src=e}else console.log("File type not recognized: "+e)})},loadHandler:function(){var e=this;e.loaded+=1,e.toLoad===e.loaded&&(e.toLoad=0,e.loaded=0,e.whenLoaded())}},f.makeDisplayObject=u,void 0!==GA.plugins&&GA.plugins(f),void 0!==GA.custom&&GA.custom(f),f};
GA.custom=function(a){a.complexShapes=[],a.triangle=function(e,t,l,s,n,o){function h(a,e,t){return a*e-t}function r(a,e){var t=new Path2D;return t.moveTo(a,e),t.lineTo(a+Math.cos(o*l-n)*s,e+Math.sin(o*l-n)*s),t.lineTo(a+Math.cos((o+1)*l-n)*s,e+Math.sin((o+1)*l-n)*s),t.closePath(),t}var i={};return a.makeDisplayObject(i),i.mask=!1,i.fillStyle="rgba("+constants.colors[o%6]+",.5)",i.strokeStyle="rgba("+constants.colors[o%6]+",.8)",i.lineWidth=3,i.x=e||0,i.y=t||0,i.flash=!1,i.singleFlash=!1,i.triangular=!0,i.triangle=null,i.interactive=!1,a.complexShapes.push(i),a.stage.addChild(i),i.updateFlash=function(){i.flash?(i.alpha>=1?(i.flash=!1,i.alpha=.5,i.singleFlash?i.singleFlash=!1:null!=i.nextShape&&void 0!=i.nextShape&&(i.nextShape.alpha=0,i.nextShape.flash=!0,soundManager.playFlashSound(i.nextShape.soundIndex)),null!=i.lastShape&&void 0!=i.lastShape&&i.lastShape()):i.alpha+=.02,i.strokeStyle="rgba("+constants.colors[o%6]+","+i.alpha+")",i.fillStyle="rgba("+constants.colors[o%6]+","+i.alpha+")"):i.alpha=.5},i.render=function(a){var e=10;i.triangle=r(i.x+Math.cos(h(o+.5,l,n))*e,i.y+Math.sin(h(o+.5,l,n))*e);var t=r(Math.cos(h(o+.5,l,n))*e,Math.sin(h(o+.5,l,n))*e);a.strokeStyle=i.strokeStyle,a.lineWidth=i.lineWidth,a.fillStyle=i.fillStyle,a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowColor="rgb("+constants.colors[o%6]+")",a.shadowBlur=5,i.mask===!0?a.clip():("none"!==i.strokeStyle&&a.stroke(t),"none"!==i.fillStyle&&a.fill(t))},i},a.complexShape=function(e,t,l,s){var n={};n.x=l||0,n.y=s||0,n.boardShapes=[],a.stage.addChild(n);for(var o=0;e>o;o++){var h=2*Math.PI/e,r=e%2==0?0:Math.PI/2;n.boardShapes.push(a.triangle(n.x,n.y,h,t,r,o))}return n},a.updateComplexShapes=function(){if(a.complexShapes.length>0)for(var e=a.complexShapes.length-1;e>=0;e--){var t=a.complexShapes[e];t&&t.updateFlash()}},a.updateFunctions.push(a.updateComplexShapes),a.wait=function(a,e){setTimeout(e,a)}};
var levelManager=function(n,e){var t,a,o,s,r,u=function(){var e=n.sprite(n.frames("assets/spritemap.png",constants.bossSpriteMap,45.33,49));return e.fps=6,e.scaleX=2,e.scaleY=2,n.stage.putRight(e,-91,-120),e},c=function(){var e=n.text("Lives left: "+h,"24px Wawati SC","white");return n.stage.putLeft(e,e.width+10,200),e},i=e,l=[1,3+i,4+i,5+i,6+i],f=0,p=u(),h=1>=5-e?2:5-e,d=c(),g=function(n){for(var e=n.length-1;e>0;e--){var t=Math.floor(Math.random()*(e+1)),a=n[e];n[e]=n[t],n[t]=a}return n},v=function(e){M(),a=null,o=[],s=[],r=0,t=e,0==f?(a=n.circle(250,"rgba("+constants.colors[0]+",.5)","rgba("+constants.colors[0]+",.8)",3),n.stage.putCenter(a),o.push(a),a.soundIndex=0,a.release=function(){n.remove(a),b()}):(a=n.complexShape(l[f],150,0,0),a.boardShapes.forEach(function(e){n.stage.putCenter(e),o.push(e),e.soundIndex=o.length%6,e.press=function(){e.alpha=0,e.singleFlash=!0,e.flash=!0,soundManager.playFlashSound(e.soundIndex)},e.release=function(){r++,m(e,s,r)?r>=a.boardShapes.length&&(w(),b()):(soundManager.playFail(),a.boardShapes.forEach(function(n){n.interactive=!1}),document.getElementById("canvas").className="flash",r=0,h--,y(),M(),0==h?E():n.wait(2500,function(){document.getElementById("canvas").className="",S(o[0])}))}}),o=g(o));for(var u=0;u<o.length;u++){if(o[u].patternOrder=u,s[u]=u,u==o.length-1){o[u].lastShape=function(){a.boardShapes.forEach(function(n){n.interactive=!0})};break}o[u].nextShape=o[u+1]}s.reverse(),S(o[0])},S=function(e){n.wait(1e3,function(){e.alpha=0,e.flash=!0,soundManager.playFlashSound(void 0!=e.soundIndex?e.soundIndex:0)})},m=function(n,e,t){return e[t-1]==n.patternOrder},b=function(){x(),n.wait(3e3,function(){f++,f==l.length?E():v(t)})},x=function(){soundManager.playExplosion(),p.playSequence(constants.bossSpriteSquence[1])},M=function(){p.playSequence(constants.bossSpriteSquence[0]),n.wait(3e3*Math.random(),function(){p.stop()})},y=function(){d.content="Lives Left: "+h},w=function(){a.boardShapes.forEach(function(e){e.press=null,e.release=null,n.remove(e)}),n.remove(a)},E=function(){w(),n.remove(p),n.remove(d),t()};return{startLevels:v}};
var Nomis=function(){var e=!1,a=document.getElementById("storyText"),t=new ga(640,480,function(){t.state=n},["assets/spritemap.png"]),n=function(){t.stage.children.length>0||o("Welcome to nomiS!")},r=function(a){if(!e){var n=function(){e=!1,t.state=s};soundManager.playBg();var r=new levelManager(t,a);r.startLevels(n),e=!0}},s=function(){t.stage.children.length>0||(soundManager.stopBg(),soundManager.playGameOver(),o("Game Over!"))},o=function(e){var n=t.text(e,"40px Wawati SC","white"),r=t.text("easy","Wawati SC","rgba("+constants.colors[1]+",1)");r.scaleX=r.scaleY=2;var s=t.text("medium","Wawati SC","rgba("+constants.colors[3]+",1)");s.scaleX=s.scaleY=2;var o=t.text("hard","Wawati SC","rgba("+constants.colors[0]+",1)");o.scaleX=o.scaleY=2,t.stage.putCenter(n,-100),t.stage.putCenter(r,-75,100),t.stage.putCenter(s,0,100),t.stage.putCenter(o,75,100),o.interactive=s.interactive=r.interactive=!0,o.over=s.over=r.over=function(){soundManager.playStartHover()},o.release=function(){i(5),t.remove(n),t.remove(r),t.remove(s),t.remove(o),o.release=s.release=r.release=null,o.over=s.over=r.over=null,a.style.display="",a.className="story",soundManager.playStory()},s.release=function(){i(2),t.remove(n),t.remove(r),t.remove(s),t.remove(o),o.release=s.release=r.release=null,o.over=s.over=r.over=null,a.style.display="",a.className="story",soundManager.playStory()},r.release=function(){i(0),t.remove(n),t.remove(r),t.remove(s),t.remove(o),o.release=s.release=r.release=null,o.over=s.over=r.over=null,a.style.display="",a.className="story",soundManager.playStory()}},l=function(){t.start()},i=function(e){var n=t.text("Continue","Wawati SC","white");n.interactive=!0,t.stage.putCenter(n,0,50),n.release=function(){t.remove(n),n.release=null,a.style.display="none",a.className="",soundManager.playEntrance(),t.state=r(e)}};return{init:l}};document.addEventListener("DOMContentLoaded",function(e){var a=new Nomis;a.init()});</script></head><body style="margin: 0px; background-color: #000;"><div style="height: 0;"><canvas id=canvas style="margin-top: 10px; margin-left: auto; margin-right: auto; display: block; border: 1px solid #fff;"></canvas><p id=storyText style="display: none;">Near the end of the cold war, the Russians commissioned an engineer, code-named Simon, to make a brain-washing device in the form of a toy. The engineer was successful and deployed his device to millions of children the world over. We've recently uncovered this plot and are now trying to capture Simon. Our latest intel shows us that he built a mech-suit that can only be destroyed using various sounds.<br><br>Your job, Nomis, is to deprogram the mech-suit by working the sequence in reverse.<br><br>Good luck.</p></div></body></html>