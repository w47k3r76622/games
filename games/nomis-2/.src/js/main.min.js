"use strict";var CPlayer=function(){var t,e,i,r,n,s=function(t){return Math.sin(6.283184*t)},a=function(t){return 2*(t%1)-1},o=function(t){return t%1<.5?1:-1},h=function(t){var e=t%1*4;return e<2?e-1:3-e},c=function(t){return.003959503758*Math.pow(2,(t-128)/12)},u=function(t,e,i){var r,n,s,a,o,h,u,p=l[t.i[0]],m=t.i[1],d=t.i[3],f=l[t.i[4]],g=t.i[5],v=t.i[8],y=t.i[9],w=t.i[10]*t.i[10]*4,x=t.i[11]*t.i[11]*4,k=t.i[12]*t.i[12]*4,S=1/k,E=t.i[13],T=i*Math.pow(2,2-t.i[14]),b=new Int32Array(w+x+k),M=0,F=0;for(r=0,n=0;r<w+x+k;r++,n++)n>=0&&(E=E>>8|(255&E)<<4,n-=T,h=c(e+(15&E)+t.i[2]-128),u=c(e+(15&E)+t.i[6]-128)*(1+8e-4*t.i[7])),s=1,r<w?s=r/w:r>=w+x&&(s-=(r-w-x)*S),a=h,d&&(a*=s*s),M+=a,o=p(M)*m,a=u,v&&(a*=s*s),F+=a,o+=f(F)*g,y&&(o+=(2*Math.random()-1)*y),b[r]=80*o*s|0;return b},l=[s,o,a,h];this.init=function(s){t=s,e=s.endPattern-2,i=0,r=s.rowLen*s.patternLen*(e+1)*2,n=new Int32Array(r)},this.generate=function(){var a,o,h,c,p,m,d,f,g,v,y,w,x,k,S=new Int32Array(r),E=t.songData[i],T=t.rowLen,b=t.patternLen,M=0,F=0,L=!1,B=[];for(h=0;h<=e;++h)for(d=E.p[h],c=0;c<b;++c){var U=d?E.c[d-1].f[c]:0;U&&(E.i[U-1]=E.c[d-1].f[c+b]||0,U<15&&(B=[]));var R=l[E.i[15]],D=E.i[16]/512,C=Math.pow(2,E.i[17]-9)/T,P=E.i[18],I=E.i[19],N=43.23529*E.i[20]*3.141592/44100,A=1-E.i[21]/255,W=1e-5*E.i[22],O=E.i[23]/32,j=E.i[24]/512,q=6.283184*Math.pow(2,E.i[25]-9)/T,H=E.i[26]/255,Y=E.i[27]*T;for(y=(h*b+c)*T,p=0;p<4;++p)if(m=d?E.c[d-1].n[c+p*b]:0){B[m]||(B[m]=u(E,m,T));var _=B[m];for(o=0,a=2*y;o<_.length;o++,a+=2)S[a]+=_[o]}for(o=0;o<T;o++)f=2*(y+o),v=S[f],v||L?(w=N,P&&(w*=R(C*f)*D+.5),w=1.5*Math.sin(w),M+=w*F,x=A*(v-F)-M,F+=w*x,v=3==I?F:1==I?x:M,W&&(v*=W,v=v<1?v>-1?s(.25*v):-1:1,v/=W),v*=O,L=v*v>1e-5,g=Math.sin(q*f)*j+.5,k=v*(1-g),v*=g):k=0,f>=Y&&(k+=S[f-Y+1]*H,v+=S[f-Y]*H),S[f]=0|k,S[f+1]=0|v,n[f]+=0|k,n[f+1]+=0|v}return i++,i/8},this.createWave=function(){var t=2*r-8,e=t-36,i=44,s=new Uint8Array(i+2*r);s.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var a=0,o=i;a<r;++a){var h=n[a];h=h<-32767?-32767:h>32767?32767:h,s[o++]=255&h,s[o++]=h>>8&255}return s},this.getData=function(t,e){for(var i=2*Math.floor(44100*t),r=new Array(e),s=0;s<2*e;s+=1){var a=i+s;r[s]=t>0&&a<n.length?n[a]/32768:0}return r}},Engine;!function(t){!function(t){t[t.PowerUp=0]="PowerUp",t[t.Error=1]="Error"}(t.Sounds||(t.Sounds={}));var e=t.Sounds,i=function(){function t(){this.sounds=[],this.p=new Audio,this.cp=new CPlayer,this.setupBg(),this.p.volume=1,this.sounds[e.PowerUp]=this.setupSound(this.PowerUpSound()),this.sounds[e.Error]=this.setupSound(this.ErrorSound()),this.muted=!1}return t.prototype.playSound=function(t){this.p.src=this.sounds[t],this.p.play()},t.prototype.playBg=function(){this.bgMusic.play()},t.prototype.stopBg=function(){this.bgMusic.pause()},t.prototype.muteAll=function(){this.bgMusic.muted=!0,this.p.muted=!0,this.muted=!0},t.prototype.unMuteAll=function(){this.bgMusic.muted=!1,this.p.muted=!1,this.muted=!1},t.prototype.setupSound=function(t){var e=0;for(this.cp.init(t);(e=this.cp.generate())&&!(e>=1););return URL.createObjectURL(new Blob([this.cp.createWave()],{type:"audio/wav"}))},t.prototype.setupBg=function(){this.song={songData:[{i:[2,100,128,0,3,201,128,0,0,0,0,6,29,0,0,0,194,4,1,3,25,191,115,244,147,6,84,6],p:[1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,1,2,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[116,120,116,125,123,,123,118,118,120,118,116,116,116,,116,118,122,123,118,118,,,125,122,120,122,,122,122,,118],f:[21,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,48]},{n:[128,132,128,137,135,,135,130,130,132,130,128,128,128,,128,130,134,135,130,130,,,137,134,132,134,,134,134,,130],f:[,,,,,,,,,,,,,,,,,,,,,,,,,,,11,13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,31]}]},{i:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,0,0,0,0,2,14,1,1,39,76,5,0,0],p:[,1,1,1,1,1,1,2,2,,1,1,1,1,1,1,2,2,,1,1,1,1,1,1,2,2],c:[{n:[147,,,,,,147,,,,147,,,,,,147,,,,,,147,,,,147,,,,147],f:[]},{n:[147],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,60,4,10,68,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[,1,1,2,3,2,3,4,4,,1,1,2,3,2,3,4,4,,1,1,2,3,2,3,4,4],c:[{n:[,,,,147,,,,,,,,148,,,,,,,,147,,,,,,,,147],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]},{n:[,,,,147,,,147,,,,,148,,,,,,,,147,,,147,,,147,,,,147],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]},{n:[,,,,147,,,147,,,,,148,,,,,,,,147,,,147,,,147,,,147,147,147],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]},{n:[147],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,68]}]},{i:[2,192,128,0,2,192,140,18,0,0,107,115,138,0,0,0,136,5,1,2,8,92,21,56,148,5,85,8],p:[,1,2,1,2,1,2,1,2,1,1,2,1,2,1,2,1,2,1,1,2,1,2,1,2,1,2,1],c:[{n:[116,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,123],f:[]},{n:[120,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,127],f:[]}]},{i:[0,255,152,0,0,255,152,12,0,0,2,0,60,0,0,0,0,0,0,2,255,0,0,32,47,3,157,2],p:[,,,1,2,1,3,1,2,,,,1,4,1,5,1,2,,,,1,2,1,3,1,2],c:[{n:[120,,,,125,,,,123,,,,125,,123,,122,,123,,120,,120],f:[]},{n:[120,,,,125,,,,123,,,,125,,123,,122,,123,,132,,132],f:[]},{n:[120,,,,125,,,,123,,,,125,,123,,122,,123,,122,,122],f:[]},{n:[144,,,,137,,,,135,,,,137,,135,,134,,135,,144,,144],f:[]},{n:[132,,,,137,,,,135,,,,137,,135,,134,,135,,134,,134],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[0,0,140,0,0,0,140,0,0,255,158,158,158,0,0,0,51,2,1,2,58,239,0,32,88,1,157,2],p:[],c:[]},{i:[0,255,106,1,0,255,106,0,1,0,5,7,164,0,0,0,0,0,0,2,255,0,2,16,83,5,53,1],p:[,,,,,,,,,1,,,,,,,,,1,,,,,,,,,1],c:[{n:[147],f:[]}]}],rowLen:5513,patternLen:32,endPattern:29},this.bgMusic=new Audio(this.setupSound(this.song)),this.bgMusic.volume=.3,this.bgMusic.loop=!0},t.prototype.PowerUpSound=function(){return{songData:[{i:[2,100,128,0,3,201,128,0,0,0,0,6,29,0,0,0,91,4,1,3,50,184,119,69,147,6,84,2],p:[1],c:[{n:[152,156,159,164],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]}],rowLen:1470,patternLen:32,endPattern:2}},t.prototype.ErrorSound=function(){return{songData:[{i:[0,255,152,0,0,255,156,255,0,0,0,0,63,0,0,2,0,0,0,2,255,0,0,32,47,3,25,2],p:[1],c:[{n:[108],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]}],rowLen:5513,patternLen:32,endPattern:2}},t}();t.SoundManager=i}(Engine||(Engine={}));var Utils;!function(t){var e=function(){function t(t){this._keys=new Array,this._values=new Array;for(var e=0;e<t.length;e++)this[t[e].key]=t[e].value,this._keys.push(t[e].key),this._values.push(t[e].value)}return t.prototype.add=function(t,e){this[t]=e,this._keys.push(t),this._values.push(e)},t.prototype.remove=function(t){var e=this._keys.indexOf(t,0);this._keys.splice(e,1),this._values.splice(e,1),delete this[t]},t.prototype.keys=function(){return this._keys},t.prototype.values=function(){return this._values},t.prototype.containsKey=function(t){return"undefined"!=typeof this[t]},t}();t.Dictionary=e}(Utils||(Utils={}));var Engine;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"rectStyle",{get:function(){return"#ffffff"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"textStyle",{get:function(){return"#000000"},enumerable:!0,configurable:!0}),t.rect=function(t,e,i,r,n,s,a){t.lineWidth=2,s?(t.fillStyle=null!=a?a:this.rectStyle,t.fillRect(e,i,r,n)):(t.strokeStyle=null!=a?a:this.rectStyle,t.strokeRect(e,i,r,n))},t.text=function(t,e,i,r,n,s){t.font=(null!=n?n:16)+"px Wawati SC",t.fillStyle=null!=s?s:this.textStyle,t.fillText(e,i,r)},t.wrapText=function(t,e,i,r,n,s){for(var a=e.split(" "),o="",h=0;h<a.length;h++){var c=o+a[h]+" ",u=t.measureText(c),l=u.width;l>n&&h>0?(t.fillText(o,i,r),o=a[h]+" ",r+=s):o=c}t.fillText(o,i,r)},t.progressBar=function(t,e,i,r){var n=r,s=800-2*e,a=Math.random();if(null==n||0==n)n=55*a;else{var o=1*(a>.6?a>.9?3:a<.1?-5:-1:1);n+=o,n<0?n=0:n>.9*s&&(n=550*a)}return this.text(t,"Downloading the internet - "+Math.round(800-n)+" seconds remaining...",e+16,i-16),this.rect(t,e,i,n,25,!0,"#FF9842"),n},t}();t.Drawing=e}(Engine||(Engine={}));var Game=function(){function t(t,e,i){var r=this;this.context=t,this.width=e,this.height=i,this.context.canvas.addEventListener("click",function(t){r.click(t)}),this.sprites=[],this.renderer=new Engine.Renderer(t,e,i,function(t){r.renderWorld(t)}),this.canvasHeight=600,this.canvasWidth=800,this.levels=[new Engine.StartLevel(this),new Engine.FirstLevel(this),new Engine.MainLevel(this)],this.currentLevel=this.levels[0],this.currentLevel.start()}return t.prototype.start=function(){this.renderer.start()},t.prototype.stop=function(){this.renderer.stop()},t.prototype.renderWorld=function(t){this.currentLevel.render(this.context,t)},t.prototype.click=function(t){this.currentLevel.sprites.forEach(function(e){e.checkCollision(t.offsetX,t.offsetY)&&e.click(t)})},t}(),Engine;!function(t){var e=function(){function t(t,e,i,r){this.context=t,this.width=e,this.height=i,this.render=r}return t.prototype.start=function(){var t=this;this.running=!0,this.animationFrame=window.requestAnimationFrame(function(e){return t.renderLoop(e)})},t.prototype.renderLoop=function(t){var e=this;this.running&&(this.clear(),this.render(t),window.requestAnimationFrame(function(t){return e.renderLoop(t)}))},t.prototype.stop=function(){this.clear(),window.cancelAnimationFrame(this.animationFrame),this.running=!1},t.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},t}();t.Renderer=e}(Engine||(Engine={}));var Engine;!function(t){var e=function(){function t(t,e,i,r,n,s,a,o){this.x=t,this.y=e,this.frameWidth=i,this.frameHeight=r,this.callback=o,this.image=new Image,this.image.src=n,this.currentFrame=0,this.frames=s,this.fps=a,this.lastTimestamp=0,this.flip=!1}return t.prototype.render=function(t,e){null!=this.lastTimestamp&&void 0!=this.lastTimestamp||(this.lastTimestamp=e);var i=e-this.lastTimestamp;null!=this.frames&&i>1e3/this.fps&&(this.animate(t),this.lastTimestamp=e),this.flip===!0&&(t.save(),t.scale(-1,1)),t.drawImage(this.image,this.currentFrame*this.frameWidth,0,this.frameWidth,this.image.height,this.flip?this.x*-1:this.x,this.y,this.flip?this.frameWidth*-1:this.frameWidth,this.image.height),this.flip===!0&&t.restore()},t.prototype.animate=function(t){this.currentFrame++,this.currentFrame>=this.frames&&(this.currentFrame=0)},t.prototype.checkCollision=function(t,e){return e>=this.y&&e<=this.y+this.frameHeight&&t>=this.x&&t<=this.x+this.frameWidth},t.prototype.click=function(t){null!=this.callback&&this.callback()},t}();t.Sprite=e}(Engine||(Engine={}));var Engine;!function(t){var e=function(){function t(t,e,i,r,n,s){this.x=t,this.y=e,this.text=i,this.height=r,this.color=n,this.callback=s}return t.prototype.render=function(t,e){t.font="bold "+this.height+"px Wawati SC",t.fillStyle=this.color,t.fillText(this.text,this.x,this.y),this.width=t.measureText(this.text).width},t.prototype.checkCollision=function(t,e){return e>=this.y-this.height&&e<=this.y&&t>=this.x&&t<=this.x+this.width},t.prototype.click=function(t){null!=this.callback&&this.callback()},t}();t.Button=e}(Engine||(Engine={}));var Engine;!function(t){var e=function(){function e(e){var i=this;this.sprites=[],this.game=e;var r=30,n=this.game.canvasWidth/2-50,s=this.game.canvasHeight/2-r/2+60;this.sprites.push(new t.Button(n,s,"START",r,"#ffffff",function(){i.end()})),this.game.sprites=this.sprites}return e.prototype.start=function(){},e.prototype.end=function(){this.game.currentLevel=this.game.levels[1],this.game.currentLevel.start()},e.prototype.render=function(e,i){var r=80,n="Nomis2",s=e.measureText(n),a=e.canvas.clientWidth/2-s.width-30,o=e.canvas.clientHeight/2,h=5*Math.random()+5*(i%2===0?0:-1),c=5*Math.random();t.Drawing.text(e,n,a,o,r,"#fff"),t.Drawing.text(e,n,a+h,o+c,r),this.sprites.forEach(function(t){t.render(e,i)})},e}();t.StartLevel=e}(Engine||(Engine={}));var Engine;!function(t){var e=function(){function e(e){var i=this;this.sprites=[],this.game=e,this.text="After a hard fought battle, you were able to successfully decommission the mech-suit built by renegade Russian scientist Simon. But in the final moments of the battle, Simon slipped away and activated the base's backup defense protocols. Your primary mission remains: Capture Simon and bring him to justice. Now, armed with a malfunctioning mech suit, you have just 15 minutes to find Simon, capture him, and escape the base before it self destructs. Good luck Nomis. We're all counting on you.";var r=30,n=this.game.canvasWidth/2-50,s=550;this.sprites.push(new t.Button(n,s,"CONTINUE",r,"#ffffff",function(){i.end()})),this.game.sprites=this.sprites,this.characterIndex=0}return e.prototype.start=function(){},e.prototype.end=function(){this.game.currentLevel=this.game.levels[2],this.game.currentLevel.start()},e.prototype.render=function(e,i){isNaN(this.lastTimeStamp)&&(this.lastTimeStamp=i);var r=(this.text.split(" "),i-this.lastTimeStamp),n=50,s=n+40,a=25;if(r>75){if(this.characterIndex>=this.text.length+1)return t.Drawing.wrapText(e,this.text,a,s,775,n),void(r>100&&(this.sprites.forEach(function(t){t.render(e,i)}),this.lastTimeStamp=i));var o=this.text.substring(0,this.characterIndex+1);return this.characterIndex++,t.Drawing.wrapText(e,o,a,s,775,n),void(this.lastTimeStamp=i)}var h=this.text.substring(0,this.characterIndex+1);t.Drawing.wrapText(e,h,a,s,775,n),r>100&&this.characterIndex>=this.text.length+1&&(this.sprites.forEach(function(t){t.render(e,i)}),this.lastTimeStamp=i)},e}();t.FirstLevel=e}(Engine||(Engine={}));var Engine;!function(t){var e=function(){function e(e){var i=this;this.units=["k","M","B","T","q","Q","s","S"],this.targetLocation=null,this.lastTimeStoppedMoving=0,this.delayToMove=2e5,this.firingLaser=!1,this.lastShakeStart=0,this.lastShakeEnd=0,this.shaking=!1,this.shake=!1,this.blackBelt=!1,this.search=!1,this.searchRadius=0,this.searchX=0,this.searchY=0,this.progress=!1,this.width=0,this.fartBeam=!1,this.farting=!1,this.fartStartTime=0,this.fartColors=["#FF0000","#FF7F00","#FFFF00","#00FF00","#0000FF","#4B0082","#9400D3"],this.judge=!1,this.judgeBlink=!1,this.sprites=[],this.upgrades=this.getUpgrades(),this.sm=new t.SoundManager,this.muteButton=new t.Button(375,30,"Mute",24,"#FF9842",function(){i.sm.muted?(i.sm.unMuteAll(),i.muteButton.text="Mute"):(i.sm.muteAll(),i.muteButton.text="Unmute")}),this.sprites.push(this.muteButton);var r=30;this.upgrades.keys().forEach(function(e){i.sprites.push(new t.Button(10,r,"BUY",20,"#5BD95B",function(){var r=i.upgrades[e];if(i.bugsSquashed>=r.clicks&&(i.bugsSquashed-=r.clicks,i.fixesPerSecond+=r.improvementFactor,i.sm.playSound(t.Sounds.PowerUp),r.clicks+=Math.round(.1*r.clicks),r.owned+=1,null!=r.onFirstUpgrade&&1==r.owned&&r.onFirstUpgrade(),"Minor Text Fixes"===r.text)){for(var n="",s=r.name.length,a=0;a<s;a++){var o=Math.floor(Math.random()*r.name.length);n+=r.name[o],r.name=r.name.slice(0,o)+r.name.slice(o+1,r.name.length)}r.name=n}})),r+=35}),this.game=e,this.game.sprites=this.sprites}return e.prototype.start=function(){this.sm.playBg(),this.bugsSquashed=0,this.totalBugsSquashed=0,this.fixesPerSecond=0,this.lastTimestamp=0,this.secondTimestamp=0,this.judgeTimestamp=0,this.movingRight=!0,this.lastErrorTime=0,this.createError()},e.prototype.end=function(){this.sm.stopBg()},e.prototype.render=function(e,i){var r=this;i-this.lastErrorTime;this.startShake(e,i),this.lastTimestamp=i,i-this.judgeTimestamp>200&&(this.judgeBlink=!this.judgeBlink,this.judgeTimestamp=i),i-this.secondTimestamp>1e3&&(this.bugsSquashed+=this.fixesPerSecond,this.totalBugsSquashed+=this.fixesPerSecond,this.secondTimestamp=i),this.moveNomis(e),this.createError(),this.drawRadar(e),this.drawProgress(e),this.fartBeam&&null!=this.nomis&&(this.farting||null==this.targetLocation)&&(this.farting||(this.fartStartTime=i),this.farting=!0,this.drawFartBeam(e,i)),this.judge&&this.judgeBlink&&(t.Drawing.text(e,"YOU'RE WINNER",250,100,40,"#d3c906"),t.Drawing.text(e,"1th Place",300,150,40,"#d3c906")),this.sprites.forEach(function(t){t.render(e,i)}),t.Drawing.rect(e,0,0,300,23*this.upgrades.values().length,!1,"rgba(0,0,0,0)"),t.Drawing.rect(e,800,0,-300,60,!1,"rgba(0,0,0,0)"),t.Drawing.text(e,this.formatNum(this.bugsSquashed)+" Bug Bounty",550,30,20),t.Drawing.text(e,this.formatNum(this.fixesPerSecond)+" Fixes/Sec",550,52,20);var n=20;this.upgrades.keys().forEach(function(i){i/2>=r.totalBugsSquashed?(t.Drawing.text(e,"?? - ?????????????? - ?????",70,n),n+=15,t.Drawing.text(e,"?? - ?????????????? - ?????",70,n)):(t.Drawing.text(e,r.formatNum(r.upgrades[i].owned)+" - "+r.upgrades[i].name,70,n),n+=15,t.Drawing.text(e,r.formatNum(r.upgrades[i].improvementFactor)+" fixes/sec ea. - Cost: "+r.formatNum(r.upgrades[i].clicks),70,n)),n+=20}),null!=this.error&&null!=this.nomis&&this.upgrades[100].owned>0&&this.createLaser(e),this.shake&&this.shaking&&e.restore()},e.prototype.errorClicked=function(){this.bugsSquashed+=1,this.totalBugsSquashed+=1,this.lastErrorTime=this.lastTimestamp,this.sprites.splice(this.sprites.indexOf(this.error),1),this.error=null,this.nextErrorDelay=1e4*Math.random()},e.prototype.createError=function(){var e=this;(this.lastTimestamp-this.lastErrorTime>this.nextErrorDelay&&null==this.error||0==this.lastTimestamp&&null==this.error)&&(this.error=new t.ErrorBox(725,350,100,"#3fc56e",function(){e.errorClicked()}),this.sprites.push(this.error),this.sm.playSound(t.Sounds.Error))},e.prototype.createLaser=function(t){if(this.firingLaser){if(Math.random()<.01)return this.errorClicked(),void(this.firingLaser=!1);var e=20*Math.random(),i=this.nomis.x,r=this.nomis.y+this.nomis.frameHeight/2,n=this.error.x,s=this.error.y;n<i&&this.movingRight?this.nomis.flip=!0:(this.nomis.flip=!1,i+=this.nomis.frameWidth);var a=Math.sqrt(Math.abs((n-i)*(n-i))+Math.abs((s-r)*(s-r)))/10,o=-64/a,h=252/a,c=-122/a;t.globalCompositeOperation="overlay";for(var u=0;u<a;u++){var l=u+1,p=t.createRadialGradient(i,r,0,i,r,e+u);t.beginPath(),p.addColorStop(0,"white"),p.addColorStop(this.blackBelt?.75:1,"rgb("+Math.floor(110+o*l)+", \n                    "+Math.floor(0+h*l)+", "+Math.floor(191+c*l)+")"),this.blackBelt&&p.addColorStop(1,"black"),t.fillStyle=p,t.arc(i,r,e+u,2*Math.PI,360,!1),t.fill(),i+=(n-i)/(a-u),r+=(s-r)/(a-u)}t.globalCompositeOperation="source-over"}},e.prototype.drawFartBeam=function(t,e){if(this.farting){var i=e-this.fartStartTime;i>500&&(this.farting=!1,this.fartStartTime=e);for(var r=-3,n=this.nomis.y+this.nomis.frameHeight/2,s=0;s<this.fartColors.length-1;s++)t.beginPath(),t.strokeStyle=this.fartColors[s],this.nomis.flip?t.arc(this.nomis.x+this.nomis.frameWidth-20,n+this.nomis.frameHeight,60+r*s,1.5*Math.PI,(1.5+i/1e3)*Math.PI):t.arc(this.nomis.x+20,n+this.nomis.frameHeight,60+r*s,(1+(500-i)/1e3)*Math.PI,1.5*Math.PI),t.stroke()}},e.prototype.moveNomis=function(t){return null==this.nomis||null==this.targetLocation&&this.lastTimestamp-this.lastTimeStoppedMoving<Math.random()*this.delayToMove?void(this.firingLaser=!0):(null==this.targetLocation&&this.generateRandomLocationToMove(),this.dx>=0?(this.movingRight=!0,this.nomis.flip=!1):(this.movingRight=!1,this.nomis.flip=!0),this.nomis.x+=this.dx,this.nomis.y+=this.dy,void((this.movingRight&&this.nomis.x>=this.targetLocation.x||!this.movingRight&&this.nomis.x<=this.targetLocation.x)&&(this.lastTimeStoppedMoving=this.lastTimestamp,this.targetLocation=null)))},e.prototype.generateRandomLocationToMove=function(){var t=Math.random()*(800-this.nomis.frameWidth),e=Math.random()*(600-this.nomis.frameHeight);this.targetLocation={x:Math.round(t<0?0:t),y:Math.round(e<0?0:e)},this.dx=(this.targetLocation.x-this.nomis.x)/100,this.dy=(this.targetLocation.y-this.nomis.y)/100,this.firingLaser=!1},e.prototype.formatNum=function(t){for(var e,i=this.units.length-1;i>=0;i--)if(e=Math.pow(1e3,i+1),t<=-e||t>=e)return+(t/e).toFixed(3)+this.units[i];return t},e.prototype.startShake=function(t,e){if(this.shake)if(e-this.lastShakeEnd>15e3&&!this.shaking)this.lastShakeStart=e,this.shaking=!0;else if(this.shaking&&e-this.lastShakeStart>800)this.lastShakeEnd=e,this.shaking=!1,t.restore();else if(this.shaking){var i=e-this.lastShakeStart,r=15*(Math.cos(.102*i)+Math.cos(.289*i)),n=15*(Math.cos(.04*i)+Math.cos(.06192*i));t.save(),t.translate(r,n)}},e.prototype.drawProgress=function(e){this.progress&&(this.width=t.Drawing.progressBar(e,25,this.game.canvasHeight-50,this.width))},e.prototype.drawRadar=function(t){this.search&&null!=this.nomis&&(this.searchRadius>=250&&this.firingLaser&&(this.searchRadius=0,this.searchX=this.nomis.x+this.nomis.frameWidth/2,this.searchY=this.nomis.y+this.nomis.frameHeight/2),this.searchRadius+=2,t.beginPath(),t.arc(this.searchX,this.searchY,this.searchRadius,0,2*Math.PI),t.strokeStyle="#5BD95B",t.stroke())},e.prototype.getUpgrades=function(){var e=this;return new Utils.Dictionary([{key:10,value:{name:"Nomis",text:"Nomis AutoClick Bot",clicks:10,improvementFactor:1,owned:0,onFirstUpgrade:function(){e.nomis=new t.Sprite(400,500,69,69,"images/NomisSpriteSheet.png",3,10),e.sprites.push(e.nomis),e.generateRandomLocationToMove()}}},{key:100,value:{name:"NomisLaser",text:"Nomis Laser Beams",clicks:100,improvementFactor:10,owned:0}},{key:1e3,value:{name:"Refactored",text:"Refactored Circuitry",clicks:1e3,improvementFactor:100,owned:0,onFirstUpgrade:function(){e.shake=!0}}},{key:5e4,value:{name:"CertifiedQA",text:"Certified Software Quality Analyst (CSQA)",clicks:5e4,improvementFactor:1e3,owned:0}},{key:1e5,value:{name:"Download",text:"Download the whole internet",clicks:1e5,improvementFactor:5e3,owned:0,onFirstUpgrade:function(){e.progress=!0}}},{key:5e5,value:{name:"Manager",text:"Department Manager",clicks:5e5,improvementFactor:1e4,owned:0}},{key:1e6,value:{name:"PullRequest",text:"Pull Request",clicks:1e6,improvementFactor:5e4,owned:0}},{key:5e6,value:{name:"SixSigma",text:"Six Sigma Black Belt Certified",clicks:5e6,improvementFactor:1e5,owned:0,onFirstUpgrade:function(){e.blackBelt=!0;var t=document.createElement("canvas"),i=t.getContext("2d");i.drawImage(e.nomis.image,0,0);for(var r=i.getImageData(0,0,e.nomis.image.width,e.nomis.image.height),n=0;n<r.data.length;n+=4){var s=(r.data[n]+r.data[n+1]+r.data[n+2])/3;r.data[n]=s,r.data[n+1]=s,r.data[n+2]=s}i.putImageData(r,0,0),e.nomis.image.src=t.toDataURL()}}},{key:5e7,value:{name:"SearchEngineFu",text:"Search Engine-Fu Sensei",clicks:5e7,improvementFactor:25e4,owned:0,onFirstUpgrade:function(){e.search=!0,e.searchX=e.nomis.x,e.searchY=e.nomis.y}}},{key:1e8,value:{name:"MinorTextFixes",text:"Minor Text Fixes",clicks:1e8,improvementFactor:1e6,owned:0}},{key:5e8,value:{name:"UnicornFart",text:"Unicorn Fart Beam",clicks:5e8,improvementFactor:5e7,owned:0,onFirstUpgrade:function(){e.fartBeam=!0}}},{key:1e11,value:{name:"JS13kGamesJudge",text:"JS 13k Games Judge",clicks:1e11,improvementFactor:999999999,owned:0,onFirstUpgrade:function(){e.judge=!0}}}])},e}();t.MainLevel=e}(Engine||(Engine={}));var Engine;!function(t){var e=function(){function e(e,i,r,n,s){this.x=e,this.y=i,this.height=r,this.color=n,this.callback=s,this.errors=this.getErrors(),this.message=this.errors[Math.floor(Math.random()*this.errors.length)],this.width=200,this.headingHeight=32,this.buttons=[new t.Button(e-12,i," OK ",20,"#000"),new t.Button(e+14,i-(r+this.headingHeight/2),"X",20,"#000")]}return e.prototype.render=function(e,i){var r="#ccc",n="#bbb",s="#aac",a="#000",o="#a8a8a8",h=12,c=50,u=18,l=5,p=10,m=this.width+c+2*p+200,d=this.y-this.height-p,f=this.x+c-m-p;t.Drawing.rect(e,f,d-this.headingHeight,m,this.headingHeight,!0,s),t.Drawing.text(e,"Unexpected error has occurred",f+5,d-5,20),t.Drawing.rect(e,f,d,m,this.height+u,!0,r),t.Drawing.rect(e,f,d-this.headingHeight,m,this.height+u+this.headingHeight,!1,n),e.font="24px Wawati SC",e.fillStyle=a,t.Drawing.wrapText(e,this.message,f+p,d+h+p,m-20,24);var g=this.x-20,v=this.y-u;e.font=u+"px Wawati SC",t.Drawing.rect(e,g-l,v-l,c+2*l,u+2*l,!0,o),t.Drawing.rect(e,g-l,v-l,c+2*l,u+2*l,!1,n),this.buttons.forEach(function(t){t.render(e,i)})},e.prototype.checkCollision=function(t,e){var i=!1;return this.buttons.forEach(function(r){r.checkCollision(t,e)&&(i=!0)}),i},e.prototype.click=function(t){null!=this.callback&&this.callback()},e.prototype.getErrors=function(){return["ID 10 T error.","Disconnect between the keyboard and the seat.","Your TPS Report failed to print.","Object expected.","Nomis2 is undefined.","Unterminated string constant.","Expected ')' or missing ) after argument list.","Uncaught TypeError: undefined is not a function","'this' does not contain a property for 'Game'","'addClickHandler' is null","true == 1 is true","true === 'true' is false","Uncaught ReferenceError: Invalid left-hand side in assignment","Uncaught TypeError: Converting circular structure to JSON","Unexpected token ;","Uncaught exception: TypeError: JSON.stringify: Not an acyclic Object","TypeError: cyclic object value, Circular reference in value argument not supported","Uncaught SyntaxError: Unexpected token ILLEGAL","Uncaught TypeError: Cannot read property 'glitch' of null","Uncaught TypeError: Cannot read property 'fixit' of undefined","Uncaught TypeError: Cannot set property 'monkey' of null","Uncaught TypeError: Cannot set property 'poop' of undefined","Uncaught RangeError: Maximum call stack size exceeded","StackOverFlow: 0x0934503469906450620846","Uncaught URIError: URI malformed","XMLHttpRequest cannot load http://js13kgames.com/. No 'Access-Control-Allow-Origin' header is present on the requested resource","Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at http://js13kgames.com/","Uncaught exception: RangeError: Maximum recursion depth exceeded, too much recursion, Stack overflow","TypeError: someVal is undefined","Unable to set property 'goose' of undefined or null reference","URIError: malformed URI sequence","InvalidStateError: An attempt was made to use an object that is not, or is no longer, usable","InvalidStateError, DOMException code 42","To help protect your computer, OS has stopped working.","The mapped network drive could not be created because the following error has occurred:  An extended error has occurred.","Catastrophic failure.  Please continue.","The flux capacitor has gone caput","The dingo ate my baby!","Your mouse has stopped working.  Click OK to Continue.","The operation completed successfully.","No error occurred.","An error occurred while displaying the previous error.","User error - Replace User","This is not just a warning.","NET_SendPacket ERROR:  NO ERROR","You do not have permission to view errors about permissions","Cannot delete 4242:  There is not enough free disk space.  Delete one or more files to free disk space, and then try again.","Press the any key to return.","Surprise!  Your Meeting Software Client has stopped working.","It no worky."]},e}();t.ErrorBox=e}(Engine||(Engine={}));