window.onload=function(){function t(t){37==t.keyCode?(k.update("x",-50*m),d="left"):38==t.keyCode?(k.update("y",-50*m),d="up"):39==t.keyCode?(k.update("x",50*m),d="right"):40==t.keyCode&&(k.update("y",50*m),d="down")}function o(t){return t.w=50,t.h=50,t.colors={wall:"#848887",floor:"#BFEFFF",trigger:"#F7EF99","switch":"#43ADF5",goal:"#23CE6B"},t.draw=function(){g.fillStyle=this.colors[this.type],l(g,this.x+2,this.y+2,this.w-4,this.h-4,9)},t}function e(){v=!1,T.length=0,F.length=0,M.length=0,L.length=0,C[E].walls.forEach(function(t){T.push(o({x:t%8*50,y:50*Math.floor(t/8),type:"wall"}))}),C[E].triggers.forEach(function(t){M.push(o({x:t%8*50,y:50*Math.floor(t/8),type:"trigger"}))}),C[E].floors.forEach(function(t){F.push(o({x:t%8*50,y:50*Math.floor(t/8),type:"floor"}))}),C[E].switches.forEach(function(t){L.push(o({x:t%8*50,y:50*Math.floor(t/8),type:"switch"}))})}function n(){v=!0,T.length=0,F.length=0,M.length=0,L.length=0,C[E].walls.forEach(function(t){F.push(o({x:t%8*50,y:50*Math.floor(t/8),type:"floor"}))}),C[E].floors.forEach(function(t){T.push(o({x:t%8*50,y:50*Math.floor(t/8),type:"wall"}))}),C[E].triggers.forEach(function(t){M.push(o({x:t%8*50,y:50*Math.floor(t/8),type:"trigger"}))}),C[E].switches.forEach(function(t){L.push(o({x:t%8*50,y:50*Math.floor(t/8),type:"switch"}))})}function l(t,o,e,n,l,r){t.beginPath(),t.moveTo(o,e+r),t.lineTo(o,e+l-r),t.quadraticCurveTo(o,e+l,o+r,e+l),t.lineTo(o+n-r,e+l),t.quadraticCurveTo(o+n,e+l,o+n,e+l-r),t.lineTo(o+n,e+r),t.quadraticCurveTo(o+n,e,o+n-r,e),t.lineTo(o+r,e),t.quadraticCurveTo(o,e,o,e+r),t.fill()}function r(t,o){return t.x==o.x&&t.y==o.y}function a(){T.forEach(function(t){r(t,k)&&("left"==d?k.update("x",50*m):"up"==d?k.update("y",50*m):"right"==d?k.update("x",-50*m):"down"==d&&k.update("y",-50*m))}),M.forEach(function(t){r(t,k)&&!v&&n()}),L.forEach(function(t){r(t,k)&&1==m&&(m=-1)}),r(w,k)&&(E+=1,E>C.length&&s(),k.x=C[E].start%8*50,k.y=50*Math.floor(C[E].start/8),console.log(E),console.log("Level Complete"),c())}function i(){k.x=k.x.clamp(0,p-k.width),k.y=k.y.clamp(0,x-k.height),a()}function h(){u.width=u.width,M.forEach(function(t){t.draw()}),F.forEach(function(t){t.draw()}),L.forEach(function(t){t.draw()}),T.forEach(function(t){t.draw()}),w.draw(),k.draw()}function c(){m=1,e(),w=o({x:C[E].goal%8*50,y:50*Math.floor(C[E].goal/8),type:"goal"})}function f(){c(),y=setInterval(function(){i(),h()},1e3/q)}function s(){clearInterval(y),u.width=u.width,g.clearRect(0,0,p,x),g.fillStyle="#272D2D",g.font="30px Georgia",g.textAlign="center",g.fillText("Thanks for Playing!",p/2,x/2)}var u=document.getElementById("canvas"),g=u.getContext("2d");document.addEventListener("keydown",t,!0);var d,w,y,p=400,x=400,E=0,v=!1,m=1,C=[{name:"Level 1",walls:[],triggers:[],floors:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],switches:[],start:0,goal:63},{name:"Level 2",walls:[1,2,3,4,5,6,7,16,19,20,21,22,30,38,46,62,24,32,40,48,56,57,58,59,60,61,49,50,51,52,41,42,43,33,34,25,37,29,28,47,39,31,15,14,13,12,11,10,23],triggers:[],floors:[0,8,9,17,18,26,27,35,36,44,45,53,54,55],switches:[],start:0,goal:63},{name:"Level 3",walls:[8,9,10,11,12,13,14,15,23,31,39,47,55],triggers:[7],floors:[0,1,2,3,4,5,6,14,22,30,38,46,54,62],switches:[],start:0,goal:63},{name:"Level 4",walls:[1,9,17,25,26,27,28,29,30,3140,41,42,43,44,45,46,54,62,40,31],triggers:[],floors:[0,8,16,24,32,33,34,35,36,37,38,39,47,55],switches:[35],start:0,goal:63},{name:"Level 4",walls:[8,9,10,11,13,14,15,28,36,44,52,51,50,49],triggers:[12],floors:[0,1,2,3,4,5,6,7,16,17,18,19,21,22,23,27,35,43,42,41,40,56,57,58,59,60,61,53,45,37,29],switches:[20],start:0,goal:48}],T=[],M=[],F=[],L=[],k={color:"#A846A0",width:50,height:50,x:0,y:0,draw:function(){g.fillStyle=this.color,l(g,this.x+7,this.y+7,this.width-14,this.height-14,10)},update:function(t,o){"x"==t?this.x+=o:this.y+=o}},q=30;f()};