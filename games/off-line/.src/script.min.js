var gameScene,startScene,player,playerHit,obstacles,potions,line,wobble,scoreText,highScore,startScoreText,startHighScoreText,GA=GA||{};GA.VERSION="0.0.1",GA.plugins=void 0,GA.custom=void 0,GA.create=function(e,t,n,r,a){var i,o={};if(o.canvas=document.createElement("canvas"),o.canvas.setAttribute("width",1*e),o.canvas.setAttribute("height",1*t),o.canvas.style.backgroundColor="black",document.body.appendChild(o.canvas),o.canvas.ctx=o.canvas.getContext("2d"),o.stage=(d(i={}),i.stage=!0,i.width=o.canvas.width,i.height=o.canvas.height,i.x=0,i.y=0,i.parent=void 0,i),o.pointer=function(){var e={_x:0,_y:0};return Object.defineProperties(e,{x:{get:function(){return e._x/o.scale},enumerable:!0,configurable:!0},y:{get:function(){return e._y/o.scale},enumerable:!0,configurable:!0},centerX:{get:function(){return e.x},enumerable:!0,configurable:!0},centerY:{get:function(){return e.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:e.x,y:e.y}},enumerable:!0,configurable:!0}}),e.isDown=!1,e.isUp=!0,e.tapped=!1,e.downTime=0,e.elapsedTime=0,e.press=void 0,e.release=void 0,e.tap=void 0,e.dragSprite=null,e.dragOffsetX=0,e.dragOffsetY=0,e.moveHandler=function(t){e._x=t.pageX-t.target.offsetLeft,e._y=t.pageY-t.target.offsetTop,t.preventDefault()},e.touchmoveHandler=function(t){e._x=t.targetTouches[0].pageX-o.canvas.offsetLeft,e._y=t.targetTouches[0].pageY-o.canvas.offsetTop,t.preventDefault()},e.downHandler=function(t){e._x=t.pageX-t.target.offsetLeft,e._y=t.pageY-t.target.offsetTop,e.isDown=!0,e.isUp=!1,e.tapped=!1,e.downTime=Date.now(),e.press&&e.press(),t.preventDefault()},e.touchstartHandler=function(t){e._x=t.targetTouches[0].pageX-o.canvas.offsetLeft,e._y=t.targetTouches[0].pageY-o.canvas.offsetTop,e.isDown=!0,e.isUp=!1,e.tapped=!1,e.downTime=Date.now(),e.press&&e.press(),t.preventDefault()},e.upHandler=function(t){e.elapsedTime=Math.abs(e.downTime-Date.now()),e.elapsedTime<=200&&(e.tapped=!0,e.tap&&e.tap()),e.isUp=!0,e.isDown=!1,e.release&&e.release(),t.preventDefault()},o.canvas.addEventListener("mousemove",e.moveHandler.bind(e),!1),o.canvas.addEventListener("mousedown",e.downHandler.bind(e),!1),window.addEventListener("mouseup",e.upHandler.bind(e),!1),o.canvas.addEventListener("touchmove",e.touchmoveHandler.bind(e),!1),o.canvas.addEventListener("touchstart",e.touchstartHandler.bind(e),!1),window.addEventListener("touchend",e.upHandler.bind(e),!1),o.canvas.style.touchAction="none",e.hitTestSprite=function(t){var n=!1;if(t.circular){var r=e.x-(t.gx+t.halfWidth),a=e.y-(t.gy+t.halfHeight);n=Math.sqrt(r*r+a*a)<t.radius}else{var i=t.gx,o=t.gx+t.width,s=t.gy,l=t.gy+t.height;n=e.x>i&&e.x<o&&e.y>s&&e.y<l}return n},e.updateDragAndDrop=function(){if(e.isDown)if(null===e.dragSprite)for(var t=o.draggableSprites.length-1;t>-1;t--){var n=o.draggableSprites[t];if(n.draggable&&e.hitTestSprite(n)){e.dragOffsetX=e.x-n.gx,e.dragOffsetY=e.y-n.gy,e.dragSprite=n;var r=n.parent.children;r.splice(r.indexOf(n),1),r.push(n),o.draggableSprites.splice(o.draggableSprites.indexOf(n),1),o.draggableSprites.push(n);break}}else e.dragSprite.x=e.x-e.dragOffsetX,e.dragSprite.y=e.y-e.dragOffsetY;e.isUp&&(e.dragSprite=null),o.draggableSprites.some(function(t){return t.draggable&&e.hitTestSprite(t)?(o.canvas.style.cursor="pointer",!0):(o.canvas.style.cursor="auto",!1)})},e}(),o.key=function(){var e={};return e.leftArrow=f(37),e.upArrow=f(38),e.rightArrow=f(39),e.downArrow=f(40),e.space=f(32),e}(),o.buttons=[],o.dragAndDrop=!1,o.draggableSprites=[],o.tweens=[],o.state=void 0,o.load=a||void 0,o.setup=n||void 0,void 0===o.setup)throw new Error("Please supply the setup function in the constructor");function s(){if(requestAnimationFrame(s,o.canvas),void 0===o._fps)c(),o.render(o.canvas,0);else{var e=Date.now(),t=e-o._startTime;for(t>1e3&&(t=o._frameDuration),o._startTime=e,o._lag+=t;o._lag>=o._frameDuration;)l(),c(),o._lag-=o._frameDuration;var n=o._lag/o._frameDuration;o.render(o.canvas,n)}}function l(){o.stage.children.forEach(function(e){!function e(t){t._previousX=t.x;t._previousY=t.y;t.children&&t.children.length>0&&t.children.forEach(function(t){e(t)})}(e)})}function c(){if(o.buttons.length>0){o.canvas.style.cursor="auto";for(var e=o.buttons.length-1;e>=0;e--){var t=o.buttons[e];t.update(o.pointer,o.canvas),"over"!==t.state&&"down"!==t.state||t.stage||(o.canvas.style.cursor="pointer")}}if(o.dragAndDrop&&o.pointer.updateDragAndDrop(),o.state&&!o.paused&&o.state(),0!==o.updateFunctions.length)for(var n=0;n<o.updateFunctions.length;n++){(0,o.updateFunctions[n])()}}function d(e){e.x=0,e.y=0,e.vx=0,e.vy=0,e.width=0,e.height=0,e.scaleX=1,e.scaleY=1,e.pivotX=.5,e.pivotY=.5,e.rotation=0,e.visible=!0,e.parent=void 0,e.stage=!1,e.shadow=!1,e.shadowColor="rgba(100, 100, 100, 0.5)",e.shadowOffsetX=3,e.shadowOffsetY=3,e.shadowBlur=3,e.blendMode=void 0,e._alpha=1,e._draggable=void 0,e._layer=0,e._circular=!1,e._interactive=!1,e._previousX=void 0,e._previousY=void 0,e.children=[],e.addChild=function(t){t.parent&&t.parent.removeChild(t),t.parent=e,e.children.push(t)},e.removeChild=function(t){if(t.parent!==e)throw new Error(t+"is not a child of "+e);e.children.splice(e.children.indexOf(t),1)},e.swapChildren=function(t,n){var r=e.children.indexOf(t),a=e.children.indexOf(n);if(-1===r||-1===a)throw new Error(child+" Both objects must be a child of the caller "+e);t.childIndex=a,n.childIndex=r,e.children[r]=n,e.children[a]=t},e.add=function(t){var n=Array.prototype.slice.call(arguments);n.length>1?n.forEach(function(t){e.addChild(t)}):e.addChild(n[0])},e.remove=function(t){var n=Array.prototype.slice.call(arguments);n.length>1?n.forEach(function(t){e.removeChild(t)}):e.removeChild(n[0])},e.setPosition=function(t,n){e.x=t,e.y=n};var t=e;e.putCenter=function(n,r,a){r=r||0,a=a||0,n.x=t.x+t.halfWidth-n.halfWidth+r,n.y=t.y+t.halfHeight-n.halfHeight+a,e.compensateForParentPosition(t,n)},e.putTop=function(n,r,a){r=r||0,a=a||0,n.x=t.x+t.halfWidth-n.halfWidth+r,n.y=t.y-n.height+a,e.compensateForParentPosition(t,n)},e.putRight=function(n,r,a){r=r||0,a=a||0,n.x=t.x+t.width+r,n.y=t.y+t.halfHeight-n.halfHeight+a,e.compensateForParentPosition(t,n)},e.putBottom=function(n,r,a){r=r||0,a=a||0,n.x=t.x+t.halfWidth-n.halfWidth+r,n.y=t.y+t.height+a,e.compensateForParentPosition(t,n)},e.putLeft=function(n,r,a){r=r||0,a=a||0,n.x=t.x-n.width+r,n.y=t.y+t.halfHeight-n.halfHeight+a,e.compensateForParentPosition(t,n)},e.compensateForParentPosition=function(e,t){0===t.parent.gx&&0===t.parent.gy||(t.x-=e.gx,t.y-=e.gy)},Object.defineProperties(e,{gx:{get:function(){return this.parent?this.x+this.parent.gx:this.x},enumerable:!0,configurable:!0},gy:{get:function(){return this.parent?this.y+this.parent.gy:this.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:e.x,y:e.y}},enumerable:!0,configurable:!0},alpha:{get:function(){return e.parent._alpha*e._alpha},set:function(t){e._alpha=t},enumerable:!0,configurable:!0},halfWidth:{get:function(){return e.width/2},enumerable:!0,configurable:!0},halfHeight:{get:function(){return e.height/2},enumerable:!0,configurable:!0},centerX:{get:function(){return e.x+e.halfWidth},enumerable:!0,configurable:!0},centerY:{get:function(){return e.y+e.halfHeight},enumerable:!0,configurable:!0},layer:{get:function(){return e._layer},set:function(t){e._layer=t,e.parent.children.sort(g)},enumerable:!0,configurable:!0},circular:{get:function(){return e._circular},set:function(t){!0===t&&!1===e._circular&&(u(e),e._circular=!0),!1===t&&!0===e._circular&&(delete e.diameter,delete e.radius,e._circular=!1)},enumerable:!0,configurable:!0},draggable:{get:function(){return e._draggable},set:function(t){!0===t&&(o.draggableSprites.push(e),e._draggable=!0,!1===o.dragAndDrop&&(o.dragAndDrop=!0)),!1===t&&o.draggableSprites.splice(o.draggableSprites.indexOf(e),1)},enumerable:!0,configurable:!0},interactive:{get:function(){return e._interactive},set:function(t){!0===t&&(h(e),e._interactive=!0),!1===t&&(o.buttons.splice(o.buttons.indexOf(e),1),e._interactive=!1)},enumerable:!0,configurable:!0},localBounds:{get:function(){return{x:0,y:0,width:e.width,height:e.height}},enumerable:!0,configurable:!0},globalBounds:{get:function(){return rectangle={x:e.gx,y:e.gy,width:e.gx+e.width,height:e.gy+e.height},rectangle},enumerable:!0,configurable:!0},empty:{get:function(){return 0===e.children.length},enumerable:!0,configurable:!0}})}function u(e){Object.defineProperties(e,{diameter:{get:function(){return e.width},set:function(t){e.width=t,e.height=t},enumerable:!0,configurable:!0},radius:{get:function(){return e.width/2},set:function(t){e.width=2*t,e.height=2*t},enumerable:!0,configurable:!0}})}function h(e){e.press=e.press||void 0,e.release=e.release||void 0,e.over=e.over||void 0,e.out=e.out||void 0,e.tap=e.tap||void 0,e.state="up",e.action="",e.pressed=!1,e.enabled=!0,e.hoverOver=!1,o.buttons.push(e),e.update=function(t,n){if(e.enabled){var r=o.pointer.hitTestSprite(e);t.isUp&&(e.state="up","button"===e.subtype&&e.show(0)),r&&(e.state="over",e.frames&&3===e.frames.length&&"button"===e.subtype&&e.show(1),t.isDown&&(e.state="down","button"===e.subtype&&(3===e.frames.length?e.show(2):e.show(1)))),"down"===e.state&&(e.pressed||(e.press&&e.press(),e.pressed=!0,e.action="pressed")),"over"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released",o.pointer.tapped&&e.tap&&e.tap()),e.hoverOver||(e.over&&e.over(),e.hoverOver=!0)),"up"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released"),e.hoverOver&&(e.out&&e.out(),e.hoverOver=!1))}}}function f(e){var t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1),e.preventDefault()},t.upHandler=function(e){e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0),e.preventDefault()},window.addEventListener("keydown",t.downHandler.bind(t),!1),window.addEventListener("keyup",t.upHandler.bind(t),!1),t}function g(e,t){return e.layer<t.layer?-1:(e.layer,t.layer,1)}return o.assetFilePaths=r||void 0,o.paused=!1,o._fps=60,o._startTime=Date.now(),o._frameDuration=1e3/o._fps,o._lag=0,o.interpolate=!0,o.updateFunctions=[],o.scale=1,o.start=function(){o.assetFilePaths?(o.assets.whenLoaded=function(){o.state=void 0,o.setup()},o.assets.load(o.assetFilePaths),o.load&&(o.state=o.load)):o.setup(),s()},o.pause=function(){o.paused=!0},o.resume=function(){o.paused=!1},o.hidePointer=function(){o.canvas.style.cursor="none"},o.showPointer=function(){o.canvas.style.cursor="auto"},Object.defineProperties(o,{fps:{get:function(){return o._fps},set:function(e){o._fps=e,o._startTime=Date.now(),o._frameDuration=1e3/o._fps},enumerable:!0,configurable:!0},backgroundColor:{set:function(e){o.canvas.style.backgroundColor=e},enumerable:!0,configurable:!0}}),o.remove=function(e){var t=Array.prototype.slice.call(arguments);if(t[0]instanceof Array){var n=t[0];if(n.length>0)for(var r=n.length-1;r>=0;r--){var a=n[r];a.parent.removeChild(a),n.splice(n.indexOf(a),1)}}else t.length>1?t.forEach(function(e){e.parent.removeChild(e)}):t[0].parent.removeChild(t[0])},o.group=function(e){var t={};(d(t),t.addChild=function(e){e.parent&&e.parent.removeChild(e),e.parent=t,t.children.push(e),t.calculateSize()},t.removeChild=function(e){if(e.parent!==t)throw new Error(e+"is not a child of "+t);t.children.splice(t.children.indexOf(e),1),t.calculateSize()},t.calculateSize=function(){t.children.length>0&&(t._newWidth=0,t._newHeight=0,t.children.forEach(function(e){e.x+e.width>t._newWidth&&(t._newWidth=e.x+e.width),e.y+e.height>t._newHeight&&(t._newHeight=e.y+e.height)}),t.width=t._newWidth,t.height=t._newHeight)},o.stage.addChild(t),e)&&Array.prototype.slice.call(arguments).forEach(function(e){t.addChild(e)});return t},o.rectangle=function(e,t,n,r,a,i,s){var l={};return d(l),l.mask=!1,l.width=e||32,l.height=t||32,l.fillStyle=n||"red",l.strokeStyle=r||"none",l.lineWidth=a||0,l.x=i||0,l.y=s||0,o.stage.addChild(l),l.render=function(e){e.strokeStyle=l.strokeStyle,e.lineWidth=l.lineWidth,e.fillStyle=l.fillStyle,e.beginPath(),e.rect(-l.width*l.pivotX,-l.height*l.pivotY,l.width,l.height),!0===l.mask?e.clip():("none"!==l.strokeStyle&&e.stroke(),"none"!==l.fillStyle&&e.fill())},l},o.circle=function(e,t,n,r,a,i){var s={};return d(s),s.mask=!1,s.width=e||32,s.height=e||32,s.fillStyle=t||"red",s.strokeStyle=n||"none",s.lineWidth=r||"none",s.x=a||0,s.y=i||0,o.stage.addChild(s),u(s),s.render=function(e){e.strokeStyle=s.strokeStyle,e.lineWidth=s.lineWidth,e.fillStyle=s.fillStyle,e.beginPath(),e.arc(s.radius+-s.diameter*s.pivotX,s.radius+-s.diameter*s.pivotY,s.radius,0,2*Math.PI,!1),!0===s.mask?e.clip():("none"!==s.strokeStyle&&e.stroke(),"none"!==s.fillStyle&&e.fill())},s},o.line=function(e,t,n,r,a,i){var s={};return d(s),n||0===n||(n=0),r||0===r||(r=0),a||0===a||(a=32),i||0===i||(i=32),s.ax=n,s.ay=r,s.bx=a,s.by=i,s.strokeStyle=e||"red",s.lineWidth=t||1,s.lineJoin="round",o.stage.addChild(s),s.render=function(e){e.strokeStyle=s.strokeStyle,e.lineWidth=s.lineWidth,e.lineJoin=s.lineJoin,e.beginPath(),e.moveTo(s.ax,s.ay),e.lineTo(s.bx,s.by),"none"!==s.strokeStyle&&e.stroke(),"none"!==s.fillStyle&&e.fill()},s},o.text=function(e,t,n,r,a){var i={};return d(i),i.content=e||"Hello!",i.font=t||"12px sans-serif",i.fillStyle=n||"red",i.textBaseline="top",Object.defineProperties(i,{width:{get:function(){return o.canvas.ctx.measureText(i.content).width},enumerable:!0,configurable:!0},height:{get:function(){return o.canvas.ctx.measureText("M").width},enumerable:!0,configurable:!0}}),o.stage.addChild(i),i.x=r||0,i.y=a||0,i.render=function(e){e.strokeStyle=i.strokeStyle,e.lineWidth=i.lineWidth,e.fillStyle=i.fillStyle,0===i.width&&(i.width=e.measureText(i.content).width),0===i.height&&(i.height=e.measureText("M").width),e.translate(-i.width*i.pivotX,-i.height*i.pivotY),e.font=i.font,e.textBaseline=i.textBaseline,e.fillText(i.content,0,0)},i},o.frame=function(e,t,n,r,a){var i={};return i.image=e,i.x=t,i.y=n,i.width=r,i.height=a,i},o.frames=function(e,t,n,r){var a={};return a.image=e,a.data=t,a.width=n,a.height=r,a},o.filmstrip=function(e,t,n,r){for(var a=o.assets[e].source,i=[],s=a.width/t,l=s*(a.height/n),c=0;c<l;c++){var d,u;d=c%s*t,u=Math.floor(c/s)*n,r&&r>0&&(d+=r+r*c%s,u+=r+r*Math.floor(c/s)),i.push([d,u])}return o.frames(e,i,t,n)},o.sprite=function(e){var t={};if(void 0===e)throw new Error("Sprites require a source");return d(t),t.frames=[],t.loop=!0,t._currentFrame=0,t.setTexture=function(e){if(e.image)if(e.image&&!e.data){if(!(o.assets[e.image].source instanceof Image))throw new Error(e.image+" is not an image file");t.source=o.assets[e.image].source,t.sourceX=e.x,t.sourceY=e.y,t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height}else e.image&&e.data&&(t.source=o.assets[e.image].source,t.frames=e.data,t.sourceX=t.frames[0][0],t.sourceY=t.frames[0][1],t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height);else e instanceof Array?(t.frames=e,t.source=o.assets[e[0]].source,t.sourceX=o.assets[e[0]].frame.x,t.sourceY=o.assets[e[0]].frame.y,t.width=o.assets[e[0]].frame.w,t.height=o.assets[e[0]].frame.h,t.sourceWidth=o.assets[e[0]].frame.w,t.sourceHeight=o.assets[e[0]].frame.h):(t.tilesetFrame=o.assets[e],t.source=t.tilesetFrame.source,t.sourceX=t.tilesetFrame.frame.x,t.sourceY=t.tilesetFrame.frame.y,t.width=t.tilesetFrame.frame.w,t.height=t.tilesetFrame.frame.h,t.sourceWidth=t.tilesetFrame.frame.w,t.sourceHeight=t.tilesetFrame.frame.h)},t.setTexture(e),t.gotoAndStop=function(e){if(!(t.frames.length>0))throw new Error("Frame number "+e+"doesn't exist");t.frames[0]instanceof Array?(t.sourceX=t.frames[e][0],t.sourceY=t.frames[e][1]):o.assets[t.frames[e]].frame&&(t.source=o.assets[t.frames[e]].source,t.sourceX=o.assets[t.frames[e]].frame.x,t.sourceY=o.assets[t.frames[e]].frame.y,t.sourceWidth=o.assets[t.frames[e]].frame.w,t.sourceHeight=o.assets[t.frames[e]].frame.h,t.width=o.assets[t.frames[e]].frame.w,t.height=o.assets[t.frames[e]].frame.h),t._currentFrame=e},t.x=0,t.y=0,t.frames.length>0&&(o.addStatePlayer(t),Object.defineProperty(t,"currentFrame",{get:function(){return t._currentFrame},enumerable:!1,configurable:!1})),o.stage.addChild(t),t.render=function(e){e.drawImage(t.source,t.sourceX,t.sourceY,t.sourceWidth,t.sourceHeight,-t.width*t.pivotX,-t.height*t.pivotY,t.width,t.height)},t},o.button=function(e){var t=o.sprite(e);return t.subtype="button",h(t),t},o.image=function(e){return o.assets[e]},o.json=function(e){return o.assets[e]},o.addStatePlayer=function(e){var t=0,n=0,r=0,a=0,i=void 0,o=!1;function s(s){l(),r=s[0],a=s[1],n=a-r,0===r&&(n+=1,t+=1),1===n&&(n=2,t+=1),e.fps||(e.fps=12);var c=1e3/e.fps;e.gotoAndStop(r),o||(i=setInterval(function(){t<n?(e.gotoAndStop(e.currentFrame+1),t+=1):e.loop&&(e.gotoAndStop(r),t=1)}.bind(this),c),o=!0)}function l(){void 0!==i&&!0===o&&(o=!1,t=0,r=0,a=0,n=0,clearInterval(i))}e.show=function(t){l(),"string"!=typeof t?e.gotoAndStop(t):e.gotoAndStop(e.frames.indexOf(t))},e.play=function(){s([0,e.frames.length-1])},e.stop=function(){l(),e.gotoAndStop(e.currentFrame)},e.playing=o,e.playSequence=s},o.render=function(e,t){var n=e.ctx;n.clearRect(0,0,e.width,e.height);for(var r=0;r<o.stage.children.length;r++){a(o.stage.children[r])}function a(r){if(r.visible&&r.gx<e.width+r.width&&r.gx+r.width>=-r.width&&r.gy<e.height+r.height&&r.gy+r.height>=-r.height){if(n.save(),o.interpolate?(void 0!==r._previousX?r.renderX=(r.x-r._previousX)*t+r._previousX:r.renderX=r.x,void 0!==r._previousY?r.renderY=(r.y-r._previousY)*t+r._previousY:r.renderY=r.y):(r.renderX=r.x,r.renderY=r.y),n.translate(r.renderX+r.width*r.pivotX,r.renderY+r.height*r.pivotY),n.globalAlpha=r.alpha,n.rotate(r.rotation),n.scale(r.scaleX,r.scaleY),r.shadow&&(n.shadowColor=r.shadowColor,n.shadowOffsetX=r.shadowOffsetX,n.shadowOffsetY=r.shadowOffsetY,n.shadowBlur=r.shadowBlur),r.blendMode&&(n.globalCompositeOperation=r.blendMode),r.render&&r.render(n),r.children&&r.children.length>0){n.translate(-r.width*r.pivotX,-r.height*r.pivotY);for(var i=0;i<r.children.length;i++){a(r.children[i])}}n.restore()}}},o.assets={toLoad:0,loaded:0,imageExtensions:["png","jpg","gif","webp"],fontExtensions:["ttf","otf","ttc","woff"],audioExtensions:["mp3","ogg","wav","webm"],jsonExtensions:["json"],whenLoaded:void 0,load:function(e){console.log("Loading assets...");var t=this;t.toLoad=e.length,e.forEach(function(e){var n=e.split(".").pop();if(-1!==t.imageExtensions.indexOf(n)){var r=new Image;r.addEventListener("load",function(){r.name=e,t[r.name]={source:r,frame:{x:0,y:0,w:r.width,h:r.height}},t.loadHandler()},!1),r.src=e}else if(-1!==t.fontExtensions.indexOf(n)){var a=e.split("/").pop().split(".")[0],i=document.createElement("style"),s="@font-face {font-family: '"+a+"'; src: url('"+e+"');}";i.appendChild(document.createTextNode(s)),document.head.appendChild(i),t.loadHandler()}else if(-1!==t.audioExtensions.indexOf(n)){var l=o.makeSound(e,t.loadHandler.bind(t));l.name=e,t[l.name]=l}else if(-1!==t.jsonExtensions.indexOf(n)){var c=new XMLHttpRequest,d={};c.open("GET",e,!0),c.addEventListener("readystatechange",function(){200===c.status&&4===c.readyState&&((d=JSON.parse(c.responseText)).name=e,t[d.name]=d,d.frames?t.createTilesetFrames(d,e):t.loadHandler())}),c.send()}else console.log("File type not recognized: "+e)})},createTilesetFrames:function(e,t){var n=this,r=t.replace(/[^\/]*$/,""),a=new Image;a.addEventListener("load",function(){n[r+e.meta.image]={source:a,frame:{x:0,y:0,w:a.width,h:a.height}},Object.keys(e.frames).forEach(function(t){n[t]=e.frames[t],n[t].source=a}),n.loadHandler()},!1),a.src=r+e.meta.image},loadHandler:function(){this.loaded+=1,console.log(this.loaded),this.toLoad===this.loaded&&(this.toLoad=0,this.loaded=0,this.whenLoaded())}},o.keyboard=f,o.makeDisplayObject=d,void 0!==GA.plugins&&GA.plugins(o),void 0!==GA.custom&&GA.custom(o),o},window.ga=GA.create,(GA=GA||{}).plugins=function(e){function t(e){e.x+=0|e.vx,e.y+=0|e.vy}e.move=function(e){if(e instanceof Array==!1)t(e);else for(var n=0;n<e.length;n++)t(e[n])},e.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e.wait=function(e,t){return setTimeout(t,e)},e.tweens=[],e.updateTweens=function(){if(e.tweens.length>0)for(var t=e.tweens.length-1;t>=0;t--){var n=e.tweens[t];n&&n.update()}},e.updateFunctions.push(e.updateTweens),e.cubicBezier=function(e,t,n,r,a){var i=e*e;return t+(3*-t+e*(3*t-t*e))*e+(3*n+e*(-6*n+3*n*e))*e+(3*r-3*r*e)*i+a*(i*e)};var n={linear:function(e){return e},smoothstep:function(e){return e*e*(3-2*e)},smoothstepSquared:function(e){return Math.pow(e*e*(3-2*e),2)},smoothstepCubed:function(e){return Math.pow(e*e*(3-2*e),3)},acceleration:function(e){return e*e},accelerationCubed:function(e){return Math.pow(e*e,3)},deceleration:function(e){return 1-Math.pow(1-e,2)},decelerationCubed:function(e){return 1-Math.pow(1-e,3)},sine:function(e){return Math.sin(e*Math.PI/2)},sineSquared:function(e){return Math.pow(Math.sin(e*Math.PI/2),2)},sineCubed:function(e){return Math.pow(Math.sin(e*Math.PI/2),2)},inverseSine:function(e){return 1-Math.sin((1-e)*Math.PI/2)},inverseSineSquared:function(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),2)},inverseSineCubed:function(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),3)},spline:function(e,t,n,r,a){return.5*(2*n+(-t+r)*e+(2*t-5*n+4*r-a)*e*e+(3*n-t-3*r+a)*e*e*e)}};e.tweenProperty=function(t,r,a,i,o,s,l,c){void 0===o&&(o=60),void 0===s&&(s="smoothstep"),void 0===l&&(l=!1),void 0===c&&(c=0);var d={},u=s.split(" ");return"bounce"===u[0]&&(d.startMagnitude=parseInt(u[1]),d.endMagnitude=parseInt(u[2])),d.start=function(t,n){d.startValue=JSON.parse(JSON.stringify(t)),d.endValue=JSON.parse(JSON.stringify(n)),d.playing=!0,d.totalFrames=o,d.frameCounter=0,e.tweens.push(d)},d.start(a,i),d.update=function(){var e;if(d.playing)if(d.frameCounter<d.totalFrames){var a=d.frameCounter/d.totalFrames;e="bounce"!==u[0]?n[s](a):n.spline(a,d.startMagnitude,0,1,d.endMagnitude),t[r]=d.endValue*e+d.startValue*(1-e),d.frameCounter+=1}else d.end()},d.end=function(){d.playing=!1,d.onComplete&&d.onComplete(),e.tweens.splice(e.tweens.indexOf(d),1),l&&e.wait(c,function(){d.start(d.endValue,d.startValue)})},d.play=function(){d.playing=!0},d.pause=function(){d.playing=!1},d},e.makeTween=function(t){var n={tweens:[]};t.forEach(function(t){var r=e.tweenProperty(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);n.tweens.push(r)});var r=0;return n.completed=function(){(r+=1)===n.tweens.length&&(n.onComplete&&n.onComplete(),r=0)},n.tweens.forEach(function(e){e.onComplete=function(){n.completed()}}),n.pause=function(){n.tweens.forEach(function(e){e.playing=!1})},n.play=function(){n.tweens.forEach(function(e){e.playing=!0})},n},e.wobble=function(t,n,r,a,i,o,s,l,c,d,u){void 0===n&&(n=1.2),void 0===r&&(r=1.2),void 0===a&&(a=10),void 0===i&&(i=10),void 0===o&&(o=10),void 0===s&&(s=-10),void 0===l&&(l=-10),void 0===c&&(c=.98),void 0===d&&(d=!0),void 0===u&&(u=0);var h="bounce "+i+" "+o,f="bounce "+s+" "+l,g=e.makeTween([[t,"scaleX",t.scaleX,n,a,h,d,u],[t,"scaleY",t.scaleY,r,a,f,d,u]]);return g.tweens.forEach(function(t){t.onComplete=function(){t.endValue>1&&(t.endValue*=c,t.endValue<=1&&(t.endValue=1,e.removeTween(t)))}}),g},e.removeTween=function(t){t.tweens?(t.pause(),t.tweens.forEach(function(t){e.tweens.splice(e.tweens.indexOf(t),1)})):(t.pause(),e.tweens.splice(e.tweens.indexOf(t),1))},e.particles=[],e.particleEffect=function(t,n,r,a,i,o,s,l,c,d,u,h,f,g,p,v,m,y){void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=function(){return e.circle(10,"red")}),void 0===a&&(a=10),void 0===i&&(i=0),void 0===o&&(o=!0),void 0===s&&(s=0),void 0===l&&(l=6.28),void 0===c&&(c=4),void 0===d&&(d=16),void 0===u&&(u=.1),void 0===h&&(h=1),void 0===f&&(f=.01),void 0===g&&(g=.05),void 0===p&&(p=.02),void 0===v&&(v=.02),void 0===m&&(m=.01),void 0===y&&(y=.03);for(var w,x=function(e,t){return e+Math.random()*(t-e)},b=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},S=[],T=(l-s)/(a-1),A=0;A<a;A++)o?(w=x(s,l),S.push(w)):(void 0===w&&(w=s),S.push(w),w+=T);S.forEach(function(a){!function(a){var o=r();o.x=t-o.halfWidth,o.y=n-o.halfHeight;var s=b(c,d);o.width=s,o.height=s,o.scaleSpeed=x(f,g),o.alphaSpeed=x(p,v),o.rotationSpeed=x(m,y);var l=x(u,h);o.vx=l*Math.cos(a),o.vy=l*Math.sin(a),o.updateParticle=function(){o.vy+=i,o.x+=o.vx,o.y+=o.vy,o.scaleX-o.scaleSpeed>0&&(o.scaleX-=o.scaleSpeed),o.scaleY-o.scaleSpeed>0&&(o.scaleY-=o.scaleSpeed),o.rotation+=o.rotationSpeed,o.alpha-=o.alphaSpeed,o.alpha<=0&&(e.remove(o),e.particles.splice(e.particles.indexOf(o),1))},e.particles.push(o)}(a)})},e.updateParticles=function(){if(e.particles.length>0)for(var t=e.particles.length-1;t>=0;t--){e.particles[t].updateParticle()}},e.updateFunctions.push(e.updateParticles),e.emitter=function(e,t){var n={},r=void 0;return n.playing=!1,n.play=function(){n.playing||(t(),r=setInterval(function(){t()}.bind(this),e),n.playing=!0)},n.stop=function(){n.playing&&(clearInterval(r),n.playing=!1)},n},e.contain=function(e,t,n,r){var a,i=t.x,o=t.y,s=t.width,l=t.height;return n=n||!1,e.x<i&&(n&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=i,a="left"),e.y<o&&(n&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=o,a="top"),e.x+e.width>s&&(n&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=s-e.width,a="right"),e.y+e.height>l&&(n&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=l-e.height,a="bottom"),a&&r&&r(a),a},e.hitTestRectangle=function(e,t,n){var r,a,i,o;return void 0===n&&(n=!1),!1,n?(i=e.gx+e.halfWidth-(t.gx+t.halfWidth),o=e.gy+e.halfHeight-(t.gy+t.halfHeight)):(i=e.centerX-t.centerX,o=e.centerY-t.centerY),r=e.halfWidth+t.halfWidth,a=e.halfHeight+t.halfHeight,Math.abs(i)<r&&Math.abs(o)<a},e.fourKeyController=function(t,n,r,a,i,o){t.direction="",leftArrow=e.keyboard(o),upArrow=e.keyboard(r),rightArrow=e.keyboard(a),downArrow=e.keyboard(i),leftArrow.press=function(){t.vx=-n,t.vy=0,t.direction="left"},leftArrow.release=function(){rightArrow.isDown||0!==t.vy||(t.vx=0)},upArrow.press=function(){t.vy=-n,t.vx=0,t.direction="up"},upArrow.release=function(){downArrow.isDown||0!==t.vx||(t.vy=0)},rightArrow.press=function(){t.vx=n,t.vy=0,t.direction="right"},rightArrow.release=function(){leftArrow.isDown||0!==t.vy||(t.vx=0)},downArrow.press=function(){t.vy=n,t.vx=0,t.direction="down"},downArrow.release=function(){upArrow.isDown||0!==t.vx||(t.vy=0)}},e.actx=new AudioContext,e.soundEffect=function(t,n,r,a,i,o,s,l,c,d,u,h,f){void 0===t&&(t=200),void 0===n&&(n=0),void 0===r&&(r=1),void 0===a&&(a="sine"),void 0===i&&(i=1),void 0===o&&(o=0),void 0===s&&(s=0),void 0===l&&(l=0),void 0===c&&(c=!1),void 0===d&&(d=0),void 0===u&&(u=0),void 0===h&&(h=void 0),void 0===f&&(f=void 0);var g,p,v,m,y=e.actx;g=y.createOscillator(),p=y.createGain(),v=y.createStereoPanner?y.createStereoPanner():y.createPanner(),g.connect(p),p.connect(v),v.connect(y.destination),p.gain.value=i,y.createStereoPanner?v.pan.value=o:v.setPosition(o,0,1-Math.abs(o)),g.type=a;var w,x;function b(t){var n=y.createConvolver();n.buffer=e.impulseResponse(f[0],f[1],f[2],y),t.connect(n),n.connect(v)}function S(e){var t=y.createGain(),n=y.createDelay(),r=y.createBiquadFilter();n.delayTime.value=h[0],t.gain.value=h[1],h[2]&&(r.frequency.value=h[2]),n.connect(t),h[2]?(t.connect(r),r.connect(n)):t.connect(n),e.connect(n),n.connect(v)}function T(e){e.gain.value=0,e.gain.linearRampToValueAtTime(0,y.currentTime+s),e.gain.linearRampToValueAtTime(i,y.currentTime+s+n)}function A(e){e.gain.linearRampToValueAtTime(i,y.currentTime+n+s),e.gain.linearRampToValueAtTime(0,y.currentTime+s+n+r)}function H(e){var t=e.frequency.value;c?(e.frequency.linearRampToValueAtTime(t,y.currentTime+s),e.frequency.linearRampToValueAtTime(t+l,y.currentTime+s+n+r)):(e.frequency.linearRampToValueAtTime(t,y.currentTime+s),e.frequency.linearRampToValueAtTime(t-l,y.currentTime+s+n+r))}function _(e){e.start(y.currentTime+s)}d>0?(w=t-d/2,x=t+d/2,m=Math.floor(Math.random()*(x-w+1))+w):m=t,g.frequency.value=m,n>0&&T(p),A(p),l>0&&H(g),h&&S(p),f&&b(p),u>0&&function(){var e=y.createOscillator(),t=y.createOscillator(),a=y.createGain(),o=y.createGain();a.gain.value=i,o.gain.value=i,e.connect(a),a.connect(y.destination),t.connect(o),o.connect(y.destination),e.type="sawtooth",t.type="sawtooth",e.frequency.value=m+u,t.frequency.value=m-u,n>0&&(T(a),T(o));r>0&&(A(a),A(o));l>0&&(H(e),H(t));h&&(S(a),S(o));f&&(b(a),b(o));_(e),_(t)}(),_(g)},e.impulseResponse=function(e,t,n,r){for(var a=r.sampleRate*e,i=r.createBuffer(2,a,r.sampleRate),o=i.getChannelData(0),s=i.getChannelData(1),l=0;l<a;l++){var c;c=n?a-l:l,o[l]=(2*Math.random()-1)*Math.pow(1-c/a,t),s[l]=(2*Math.random()-1)*Math.pow(1-c/a,t)}return i}};const w=512,obstacleDamage=1,lineDamage=.2,potionHealth=8;var speed=4,score=0,g=ga(w,w,setup);function setup(){startScene=g.group(),(gameScene=g.group()).visible=!1,(highScore=localStorage.getItem("highScore"))||(highScore=0);var e=g.text("OFF LINE","bold 96px Arial","dodgerblue",20,20);g.canvas.ctx.font=e.font,e.width=g.canvas.ctx.measureText(e.content).width,e.x=(w-e.width)/2,startScene.addChild(e);var t=g.text("press space to start","bold 32px Arial","dodgerblue",20,20);g.canvas.ctx.font=t.font,t.width=g.canvas.ctx.measureText(t.content).width,t.x=(w-t.width)/2,t.y=128,startScene.addChild(t),startScoreText=g.text("Score: 0","32px Arial","dodgerblue",20,20),g.canvas.ctx.font=startScoreText.font,startScoreText.width=g.canvas.ctx.measureText(startScoreText.content).width,startScoreText.x=(w-startScoreText.width)/2,startScoreText.y=176,startScene.addChild(startScoreText),startHighScoreText=g.text("Highscore: "+highScore,"32px Arial","dodgerblue",20,20),g.canvas.ctx.font=startHighScoreText.font,startHighScoreText.width=g.canvas.ctx.measureText(startHighScoreText.content).width,startHighScoreText.x=(w-startHighScoreText.width)/2,startHighScoreText.y=208,startScene.addChild(startHighScoreText),startScene.addChild(g.text("Move around with WASD","16px Arial Black, Arial","slateblue",20,352)),startScene.addChild(g.text("Your score is the amount of time you spend on the line","16px Arial Black, Arial","slateblue",20,384)),startScene.addChild(g.text("Stay on the green line or else your health will drain","16px Arial Black, Arial","green",20,416)),startScene.addChild(g.text("Avoid the orange squares or else your health will drain very quickly","16px Arial","orangered",20,480)),startScene.addChild(g.text("Pick up the blue squares to increase your health","16px Arial Black, Arial","dodgerblue",20,448)),g.backgroundColor="navajowhite",(line=g.rectangle(5,g.canvas.height,"yellowgreen")).x=w/2-2.5,line.y=0,gameScene.addChild(line),obstacles=[];for(let e=0;e<5;e++){var n=g.rectangle(g.randomInt(16,32),g.randomInt(16,32),"orange");n.y=g.randomInt(20*-n.halfHeight,-n.halfHeight),n.x=g.randomInt(w/2.5,w-w/2.5),n.vy=speed,gameScene.addChild(n),obstacles.push(n)}potions=[];for(let e=0;e<2;e++){var r=g.rectangle(16,16,"dodgerblue");r.y=g.randomInt(20*-r.halfHeight,-r.halfHeight),r.x=g.randomInt(w/4,w-w/4),r.vy=speed,gameScene.addChild(r),potions.push(r)}var a=g.rectangle(32,32,"black"),i=g.rectangle(32,32,"dodgerblue");(player=g.group(a,i)).outer=a,player.inner=i,player.x=g.canvas.width/2-player.width/2,player.y=g.canvas.height-2*player.height,g.fourKeyController(player,speed,38,39,40,37),gameScene.addChild(player),scoreText=g.text("0","bolder 32px Arial","dodgerblue",20,20),gameScene.addChild(scoreText),g.key.space.press=function(){startScene.visible=!1,gameScene.visible=!0,g.state=play}}function play(){speed*=1.0001,g.move(player),g.contain(player,g.stage.localBounds),obstacles.forEach(e=>{e.y>g.canvas.height+e.height&&(e.x=g.randomInt(w/4,w-w/4),e.y=g.randomInt(20*-e.halfHeight,-e.halfHeight)),g.move(e),g.hitTestRectangle(player,e)&&(playerHit=!0),e.vy=speed}),potions.forEach(e=>{var t=g.canvas.width;e.y>g.canvas.height+e.height&&(e.x=g.randomInt(t/4,t-t/4),e.y=g.randomInt(20*-e.halfHeight,-e.halfHeight)),g.move(e),g.hitTestRectangle(player,e)&&(wobble&&(g.tweens=[],wobble.tweens=[],player.scaleX=1,player.scaleY=1),wobble=g.wobble(player,1.2,1.2,10,10,10,-10,-10,.9,!0),particles(e,"dodgerblue",20),playBubbles(),player.inner.height+potionHealth<=32?(player.inner.y-=potionHealth,player.inner.height+=potionHealth):(player.inner.y=0,player.inner.height=32),e.x=g.randomInt(t/4,t-t/4),e.y=g.randomInt(20*-e.halfHeight,-e.halfHeight)),e.vy=speed}),playerHit?(player.inner.fillStyle="slateblue",player.inner.y+=obstacleDamage,player.inner.height-=obstacleDamage,particles(player,"orange",5)):player.inner.fillStyle="dodgerblue",playerHit=!1,g.hitTestRectangle(player,line)?(line.fillStyle="yellowgreen",score++,scoreText.content=Math.floor(score/10)):(player.inner.y+=lineDamage,player.inner.height-=lineDamage,player.inner.fillStyle="slateblue",line.fillStyle="slateblue"),player.inner.height<=0&&(player.outer.fillStyle="tomato",particles(player,"tomato",20),Math.floor(score/10)>Number(highScore)&&(highScore=Math.floor(score/10),localStorage.setItem("highScore",highScore)),g.state=end)}function end(){gameScene.visible=!1,startScoreText.content="Score: "+Math.floor(score/10),startHighScoreText.content="Highscore: "+highScore,startScene.visible=!0,g.key.space.press=function(){g.state=reset,g.key.space.press=void 0}}function reset(){score=0,speed=4,obstacles.forEach(e=>{e.x=g.randomInt(w/4,w-w/4),e.y=g.randomInt(20*-e.halfHeight,-e.halfHeight)}),potions.forEach(e=>{e.x=g.randomInt(w/4,w-w/4),e.y=g.randomInt(20*-e.halfHeight,-e.halfHeight)}),player.x=g.canvas.width/2-player.width/2,player.y=g.canvas.height-2*player.height,player.inner.y=0,player.inner.height=32,player.outer.fillStyle="black",player.inner.fillStyle="dodgerblue",startScene.visible=!1,gameScene.visible=!0,g.state=play}function particles(e,t,n){g.particleEffect(e.x+16,e.y+16,function(){return g.rectangle(8,8,t)},n,.1,!0,0,6.28,4,8,1,2,.005,.01,.005,.01,.05,.1)}function playBubbles(){g.soundEffect(0,.05,.05,"sine",1,0,0,1e3,!0,1e3),g.soundEffect(250,.05,.05,"sine",1,0,.05,1e3,!0,1e3),g.soundEffect(500,.05,.05,"sine",1,0,.1,1e3,!0,500)}g.start();