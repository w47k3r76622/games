'use strict';function ka(a){for(;a>m;)a-=2*m;for(;a<-m;)a+=2*m;return a}function la(a,b){for(let c=0;c<a.entities.length;c++){let e=a.entities[c];if(e.s===b)return e}return null}function ma(){var a=r;return la(a,a.N)}function t(a,b,c){let e=new Float32Array(3);e[0]=a;e[1]=b;e[2]=c;return e}
function oa(a){var b=u,c=pa,e=w.g;let d=[],g=[];d[0]=a[0]-c[0];d[1]=a[1]-c[1];d[2]=a[2]-c[2];g[0]=d[2]*Math.sin(e)+d[0]*Math.cos(e);g[1]=d[1];g[2]=d[2]*Math.cos(e)-d[0]*Math.sin(e);b[0]=g[0]+c[0];b[1]=g[1]+c[1];b[2]=g[2]+c[2]};function qa(){var a=new Float32Array(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function ra(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1}
function sa(a,b,c){var e=Math.sin(c);c=Math.cos(c);var d=b[0],g=b[1],h=b[2],f=b[3],k=b[8],n=b[9],v=b[10],z=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=d*c-k*e;a[1]=g*c-n*e;a[2]=h*c-v*e;a[3]=f*c-z*e;a[8]=d*e+k*c;a[9]=g*e+n*c;a[10]=h*e+v*c;a[11]=f*e+z*c};function ta(a){this.usage=a;this.ra=new Float32Array(65536);this.B=new Float32Array(65536);this.F=new Uint16Array(65536);this.va()}l=ta.prototype;l.va=function(){this.G=this.D=this.Ta=this.Da=0};
l.C=function(a,b,c,e,d){const g=this.Da;for(var h=0;4>h;h++){for(var f=0;3>f;f++)this.ra[this.Ta++]=a[h][f];this.Da++}h=e||16;a=b/128;e=c/128;b=(b+h)/128;c=(c+(d||h))/128;this.B[this.D++]=a;this.B[this.D++]=e;this.B[this.D++]=b;this.B[this.D++]=e;this.B[this.D++]=b;this.B[this.D++]=c;this.B[this.D++]=a;this.B[this.D++]=c;this.F[this.G++]=g;this.F[this.G++]=g+1;this.F[this.G++]=g+2;this.F[this.G++]=g;this.F[this.G++]=g+2;this.F[this.G++]=g+3};
l.ma=function(){var a=x;this.qa=a.createBuffer();this.za=a.createBuffer();this.la=a.createBuffer();this.Ba(a)};l.Ba=function(a){a.bindBuffer(34962,this.qa);a.bufferData(34962,this.ra,this.usage);a.bindBuffer(34962,this.za);a.bufferData(34962,this.B,this.usage);a.bindBuffer(34963,this.la);a.bufferData(34963,this.F,this.usage)};
l.ua=function(){var a=x,b=ua,c=va;a.bindBuffer(34962,this.qa);a.vertexAttribPointer(b.W.Ea,3,5126,!1,0,0);a.enableVertexAttribArray(b.W.Ea);a.bindBuffer(34962,this.za);a.vertexAttribPointer(b.W.ya,2,5126,!1,0,0);a.enableVertexAttribArray(b.W.ya);a.bindBuffer(34963,this.la);a.useProgram(b.Ua);a.uniformMatrix4fv(b.Aa.Va,!1,wa);a.uniformMatrix4fv(b.Aa.Ra,!1,A);a.activeTexture(33984);a.bindTexture(3553,c);a.drawElements(4,this.G,5123,0)};function xa(){this.m=!1;this.O=0}const B=Array(256);for(let a=0;256>a;a++)B[a]=new xa;document.addEventListener("keydown",function(a){a=a.keyCode;0<=a&&256>a&&(B[a].m=!0)});document.addEventListener("keyup",function(a){a=a.keyCode;0<=a&&256>a&&(B[a].m=!1)});function ya(a,b,c){b=a.createShader(b);a.shaderSource(b,c);a.compileShader(b);return b};const C=new AudioContext,za=C.sampleRate,Ta=C.createBuffer(1,za,za),Ua=Ta.getChannelData(0);for(let a=0;a<za;a++)Ua[a]=2*Math.random()-1;
function Va(a,b){if(!(500<a)){var c=b||1;b=1-a/500;var e=b*b,d=1E3-a;b=5E3-10*a;a=Math.max(1,10-a/50);var g=C.currentTime,h=C.createGain();h.gain.value=0;h.gain.setValueAtTime(10*e,g);h.gain.exponentialRampToValueAtTime(.001,g+.7*c);h.gain.setValueAtTime(0,g+c);h.connect(C.destination);c=C.createBiquadFilter();c.type="lowpass";c.Q.value=1;c.frequency.value=d;c.connect(h);d=C.createBiquadFilter();d.type="lowshelf";d.frequency.value=b;d.gain.value=a;d.connect(c);b=C.createBufferSource();b.buffer=Ta;
b.connect(d);b.start()}}let Wa=0,Xa=0;const Ya=C.createGain();Ya.connect(C.destination);Ya.gain.setTargetAtTime(.04,0,.01);function Za(a){Ya.gain.setValueAtTime(a?.1:0,C.currentTime)}function $a(a,b){let c=C.createOscillator();c.connect(Ya);c.type="sawtooth";c.frequency.setTargetAtTime(a,Wa,.01);c.start(Wa);c.stop(Wa+.99*b)}
setInterval(function(){for(;Wa<C.currentTime+.1;){let a=(Xa/8|0)%4,b=Xa%8;0===b||3===b?$a(73,.5):$a(73,.25);0===b&&(1===a?$a(349,2):2===a?$a(392,2):3===a&&$a(415,2));Wa+=.25;Xa++}},100);let ab=null,bb=document.createElement("canvas");bb.width=1024;bb.height=1024;let D=bb.getContext("2d");
function cb(a,b,c,e){I.fillStyle="#323e30";I.fillRect(a,b,c,c);if(ab){D.drawImage(ab,0,0,1024,1024,0,0,1024,1024);const f=(w.x- -500)/1E3*1024,k=(500-w.z)/1E3*1024;var d=r.currentTime;if(0<d){var g=J.aa(d),h=g.u/1E3*1024;D.fillStyle=db(.66,1,1,.5);D.beginPath();D.arc((g.x- -500)/1E3*1024,(500-g.z)/1E3*1024,h,0,2*m);D.rect(1024,0,-1024,1024);D.fill();d=J.ka(d);g=d.u/1E3*1024;h=(d.x- -500)/1E3*1024;let a=(500-d.z)/1E3*1024;D.strokeStyle="#fff";D.beginPath();D.arc(h,a,g,0,2*m);D.rect(1024,0,-1024,1024);
D.lineWidth=2;D.stroke();ha(d,w)&&(D.lineWidth=1,D.strokeStyle="#fff",D.beginPath(),D.moveTo(f,k),D.lineTo(h,a),D.stroke())}D.beginPath();D.moveTo(f,k);D.arc(f,k,60,w.g-.16*m-.5*m,w.g+.16*m-.5*m);D.fillStyle=db(0,0,1,.5);D.fill();D.beginPath();D.arc(f,k,5,0,2*m);D.fillStyle="red";D.fill();D.lineWidth=2;D.strokeStyle="#fff";D.stroke();e?I.drawImage(bb,0,0,1024,1024,a,b,c,c):I.drawImage(bb,f-c/2,k-c/2,c,c,a,b,c,c)}I.strokeStyle="#fff";I.lineWidth=2;I.beginPath();I.rect(a,b,c,c);I.stroke()};const eb={0:"N",45:"NE",90:"E",135:"SE",180:"S",225:"SW",270:"W",315:"NW"};function fb(){P("center");var a=I.createLinearGradient(Q,R-100,Q,R-50);a.addColorStop(0,"#fffe37");a.addColorStop(1,"#fe9400");I.fillStyle=a;I.fillRect(Q-100,R-100,200,50);I.fillStyle="#000";I.font="bold 40px arial";I.fillText("#JS13K",Q,R-60);a=I.createLinearGradient(Q,R-50,Q,R+50);a.addColorStop(0,"#fffe37");a.addColorStop(1,"#fe9400");I.fillStyle=a;I.font="bold 50px arial";I.fillText("BATTLEGROUNDS",Q,R)}
function gb(a){return kb>Q-50&&kb<Q+50&&lb>R+a&&lb<R+a+40}function mb(a,b){I.fillStyle=gb(b)?"#fffe37":"#fe9400";I.fillRect(Q-50,R+b,100,40);S(a,Q,R+b+27)}function nb(a){I.fillStyle=db(0,0,0,.5);I.fillRect(0,0,T,U);P("left");V(40);S(a,50,100);(a=ma())&&S("Rank #"+(a.sa||1),50,150)}function S(a,b,c){I.fillStyle="#000";I.fillText(a,b+1,c+1);I.fillStyle="#fff";I.fillText(a,b,c)}
function ob(a,b,c,e){I.strokeStyle="#000";I.beginPath();I.moveTo(a,b);I.lineTo(c,e);I.stroke();I.strokeStyle="#fff";I.beginPath();I.moveTo(a,b);I.lineTo(c,e);I.stroke()}function V(a){I.font=a+"px sans-serif"}function P(a){I.textAlign=a}
function db(a,b,c,e){var d=6*a|0;var g=6*a-d;a=c*(1-b);var h=c*(1-g*b);b=c*(1-(1-g)*b);switch(d%6){case 0:var f=c;var k=b;var n=a;break;case 1:f=h;k=c;n=a;break;case 2:f=a;k=c;n=b;break;case 3:f=a;k=h;n=c;break;case 4:f=b;k=a;n=c;break;case 5:f=c,k=a,n=h}return"rgba("+(255*f|0)+","+(255*k|0)+","+(255*n|0)+","+(e||1)+")"};const pb=io({Xa:!1,transports:["websocket"]});let qb=0,rb=0,sb=0;
pb.on("update",function(a){var b=null===r||r.A!==a.A;r=a;if(b){J=new ia(r.T);b=x;var c=ya(b,b.VERTEX_SHADER,"\nattribute vec4 a;\nattribute vec2 b;\nuniform mat4 c;\nuniform mat4 d;\nvarying highp vec2 e;\nvoid main(void){\ngl_Position=d*c*a;\ne=b;\n}");var e=ya(b,b.FRAGMENT_SHADER,"\nvarying highp vec2 e;\nuniform sampler2D f;\nvoid main(void){\ngl_FragColor=texture2D(f,e);\nif(gl_FragColor.a<0.1)discard;\n}"),d=b.createProgram();b.attachShader(d,c);b.attachShader(d,e);b.linkProgram(d);c=d;ua={Ua:c,
W:{Ea:b.getAttribLocation(c,"a"),ya:b.getAttribLocation(c,"b")},Aa:{Ra:b.getUniformLocation(c,"c"),Va:b.getUniformLocation(c,"d")}};W=new ta(35044);tb=new ta(35048);for(b=0;64>b;b++){e=b/64*m*2;d=(b+1)/64*m*2;c=1E3*Math.cos(e);e=1E3*Math.sin(e);var g=1E3*Math.cos(d),h=1E3*Math.sin(d);d=t(c,1E3,e);var f=t(g,1E3,h);g=t(g,0,h);c=t(c,0,e);W.C([d,f,g,c],64,0)}b=t(-1E3,1E3,-1E3);c=t(1E3,1E3,-1E3);e=t(1E3,1E3,1E3);d=t(-1E3,1E3,1E3);W.C([b,c,e,d],64,0,1);b=t(-1E3,0,-1E3);c=t(1E3,0,-1E3);e=t(1E3,0,1E3);d=
t(-1E3,0,1E3);W.C([b,c,e,d],96,0);for(b=-400;400>b;b+=40)for(c=-400;400>c;c+=40)e=t(b,J.i(b,c),c),d=t(b+40,J.i(b+40,c),c),f=t(b+40,J.i(b+40,c+40),c+40),g=t(b,J.i(b,c+40),c+40),W.C([e,d,f,g],80,0);for(b=0;b<J.M.length;b++)ub(J.M[b].x,J.M[b].z,5,0,32);for(b=0;b<J.S.length;b++)ub(J.S[b].x,J.S[b].z,1,32,16);W.ma();tb.ma();ab=document.createElement("canvas");ab.width=1024;ab.height=1024;b=ab.getContext("2d");b.fillStyle="#163849";b.fillRect(0,0,1024,1024);c=1E4;e=0;for(d=-400;400>d;d+=40)for(f=-400;400>
f;f+=40)g=J.i(f,d),0<g&&(c=Math.min(c,g),e=Math.max(e,g));for(d=-400;400>d;d+=40)for(f=-400;400>f;f+=40){g=(J.i(f,d)+J.i(f+40,d)+J.i(f+40,d+40)+J.i(f,d+40))/4;if(0>=g)continue;h=(f- -500)/1E3*1024;const a=(500-d)/1E3*1024,n=(f+40- -500)/1E3*1024,v=(500-(d+40))/1E3*1024;b.fillStyle=db(110/360,.4,Math.min(1,.4+.7*(g-c)/(e-c)));b.beginPath();b.rect(h,a,n-h,v-a);b.fill()}Za(0===r.A)}if(b=a.K){for(c=0;c<b.length;c++)switch(d=b[c],d.v){case 13:d.o=8;vb.push(d);d.w!==a.N&&Va(Math.hypot(d.x-w.x,d.z-w.z));
break;case 14:d.o=16;vb.push(d);break;case 15:e=la(r,d.s);(d=la(r,d.w))?wb.push(d.name+" killed "+e.name):wb.push(e.name+" died outside the circle");break;case 16:d.w===a.N&&Va(0,.2)}b.length=0}a=Date.now();0<qb&&(rb=a-qb,sb=0<sb?.1*rb+.9*sb:rb);qb=a;pb.emit("update",w);w.actions=[]});const w=new q(2,0,200,0,0,0,0);var xb;{let a=localStorage.getItem("n");a||(a=ca(),localStorage.setItem("n",a));xb=a}w.name=xb;w.pitch=.1;w.g=.1;w.actions=[];const vb=[],wb=[];let ua=null,W=null,tb=null,yb=!1,zb=!1,T=2,U=2,Q=1,R=1,kb=0,lb=0,r=null,J=null;const Ab=document.querySelectorAll("canvas"),Bb=Ab[0],X=Ab[1],I=X.getContext("2d");let Cb=!1,Db=0;window.addEventListener("resize",Eb,!1);Eb();
X.addEventListener("click",function(a){if(0===a.button&&r)if(0===r.A){if(gb(40)&&(Fb(8),Va(0,.2)),gb(100)){Za(!1);if(a=prompt("Enter your name",w.name))localStorage.setItem("n",a),w.name=a;Za(!0)}}else zb||(yb?0<=r.currentTime&&(Fb(9),Va(0),w.pitch-=.02*Math.random(),w.g+=.02*Math.random()-.01):X.requestPointerLock())});
function Fb(a){{var b=u,c=Gb,e=pa,d=w.pitch;let a=[],h=[];a[0]=c[0]-e[0];a[1]=c[1]-e[1];a[2]=c[2]-e[2];h[0]=a[0];h[1]=a[1]*Math.cos(d)-a[2]*Math.sin(d);h[2]=a[1]*Math.sin(d)+a[2]*Math.cos(d);b[0]=h[0]+e[0];b[1]=h[1]+e[1];b[2]=h[2]+e[2]}oa(u);w.actions.push(new q(a,w.x,w.y,w.z,u[0],u[1],u[2]))}X.addEventListener("mousedown",function(a){2===a.button&&(Cb=!0)});X.addEventListener("mouseup",function(a){2===a.button&&(Cb=!1)});X.addEventListener("mousemove",function(a){kb=a.pageX;lb=a.pageY});
document.addEventListener("pointerlockchange",Hb);
function Ib(a){a*=.001;const b=a-Db;Db=a;if(J){for(let a=0;256>a;a++)B[a].m?B[a].O++:B[a].O=0;oa(Gb);w.c=0;w.f=0;if(B[38].m||B[87].m||B[90].m)w.c=8*u[0],w.f=8*u[2],w.a-=.02;if(B[40].m||B[83].m)w.c=-8*u[0],w.f=-8*u[2],w.a-=.02;if(B[37].m||B[65].m||B[81].m)w.c=-8*u[2],w.f=8*u[0],w.a-=.02;if(B[39].m||B[68].m)w.c=8*u[2],w.f=-8*u[0],w.a-=.02;if(1===B[77].O||zb&&1===B[27].O)zb=zb?!1:!0;w.x+=b*w.c;w.z+=b*w.f;w.a-=20*b;w.y+=b*w.a;var c=J.i(w.x,w.z);w.y<c+1&&(w.a=0,w.y=c+1,1===B[32].O&&(w.a=6))}if(r&&0!==
r.A){tb.va();r.entities&&Jb(r.entities);Jb(vb);if(0<=r.currentTime){{let a=r.currentTime,b=J.aa(a);for(let c=0;64>c;c++){const d=c/64*m*2,e=(c+1)/64*m*2,f=b.x+b.u*Math.cos(d),g=b.z+b.u*Math.sin(d),k=b.x+b.u*Math.cos(e),h=b.z+b.u*Math.sin(e),n=t(f,400,g),p=t(k,400,h),qc=t(k,0,h),v=t(f,0,g);tb.C([n,p,qc,v],((5*a|0)+c)%4*32,64,32,64)}}}tb.Ba(x);var e=x;e.clearColor(0,0,0,1);e.clearDepth(1);e.enable(2929);e.depthFunc(515);e.enable(3042);e.blendFunc(770,771);e.clear(16640);x.viewport(0,0,T,U);var d=wa,
g=1/Math.tan((Cb?10:60)*m/180/2),h=1/-3999.9;d[0]=g/(T/U);d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=g;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=4000.1*h;d[11]=-1;d[12]=0;d[13]=0;d[14]=800*h;d[15]=0;ra(Kb);var f=Kb,k=Kb,n=w.pitch,v=Math.sin(n),z=Math.cos(n),Lb=k[4],Mb=k[5],Nb=k[6],Ob=k[7],Pb=k[8],Qb=k[9],Rb=k[10],Sb=k[11];k!==f&&(f[0]=k[0],f[1]=k[1],f[2]=k[2],f[3]=k[3],f[12]=k[12],f[13]=k[13],f[14]=k[14],f[15]=k[15]);f[4]=Lb*z+Pb*v;f[5]=Mb*z+Qb*v;f[6]=Nb*z+Rb*v;f[7]=Ob*z+Sb*v;f[8]=Pb*z-Lb*v;f[9]=Qb*z-Mb*v;f[10]=Rb*
z-Nb*v;f[11]=Sb*z-Ob*v;ra(gc);sa(gc,gc,w.g);var K=A,L=Kb,M=gc,Aa=L[0],Ba=L[1],Ca=L[2],Da=L[3],Ea=L[4],Fa=L[5],Ga=L[6],Ha=L[7],Ia=L[8],Ja=L[9],Ka=L[10],La=L[11],Ma=L[12],Na=L[13],Oa=L[14],Pa=L[15],E=M[0],F=M[1],G=M[2],H=M[3];K[0]=E*Aa+F*Ea+G*Ia+H*Ma;K[1]=E*Ba+F*Fa+G*Ja+H*Na;K[2]=E*Ca+F*Ga+G*Ka+H*Oa;K[3]=E*Da+F*Ha+G*La+H*Pa;E=M[4];F=M[5];G=M[6];H=M[7];K[4]=E*Aa+F*Ea+G*Ia+H*Ma;K[5]=E*Ba+F*Fa+G*Ja+H*Na;K[6]=E*Ca+F*Ga+G*Ka+H*Oa;K[7]=E*Da+F*Ha+G*La+H*Pa;E=M[8];F=M[9];G=M[10];H=M[11];K[8]=E*Aa+F*Ea+G*Ia+
H*Ma;K[9]=E*Ba+F*Fa+G*Ja+H*Na;K[10]=E*Ca+F*Ga+G*Ka+H*Oa;K[11]=E*Da+F*Ha+G*La+H*Pa;E=M[12];F=M[13];G=M[14];H=M[15];K[12]=E*Aa+F*Ea+G*Ia+H*Ma;K[13]=E*Ba+F*Fa+G*Ja+H*Na;K[14]=E*Ca+F*Ga+G*Ka+H*Oa;K[15]=E*Da+F*Ha+G*La+H*Pa;sa(A,A,m);var N=A,O=A,hb=hc,Qa=hb[0],Ra=hb[1],Sa=hb[2];N[0]=O[0]*Qa;N[1]=O[1]*Qa;N[2]=O[2]*Qa;N[3]=O[3]*Qa;N[4]=O[4]*Ra;N[5]=O[5]*Ra;N[6]=O[6]*Ra;N[7]=O[7]*Ra;N[8]=O[8]*Sa;N[9]=O[9]*Sa;N[10]=O[10]*Sa;N[11]=O[11]*Sa;N[12]=O[12];N[13]=O[13];N[14]=O[14];N[15]=O[15];ic[0]=-w.x;ic[1]=-w.y-
.5;ic[2]=-w.z;var y=A,p=A,ib=ic,Y=ib[0],Z=ib[1],aa=ib[2];if(p===y)y[12]=p[0]*Y+p[4]*Z+p[8]*aa+p[12],y[13]=p[1]*Y+p[5]*Z+p[9]*aa+p[13],y[14]=p[2]*Y+p[6]*Z+p[10]*aa+p[14],y[15]=p[3]*Y+p[7]*Z+p[11]*aa+p[15];else{var Tb=p[0];var Ub=p[1];var Vb=p[2];var Wb=p[3];var Xb=p[4];var Yb=p[5];var Zb=p[6];var $b=p[7];var ac=p[8];var bc=p[9];var cc=p[10];var dc=p[11];y[0]=Tb;y[1]=Ub;y[2]=Vb;y[3]=Wb;y[4]=Xb;y[5]=Yb;y[6]=Zb;y[7]=$b;y[8]=ac;y[9]=bc;y[10]=cc;y[11]=dc;y[12]=Tb*Y+Xb*Z+ac*aa+p[12];y[13]=Ub*Y+Yb*Z+bc*aa+
p[13];y[14]=Vb*Y+Zb*Z+cc*aa+p[14];y[15]=Wb*Y+$b*Z+dc*aa+p[15]}W.ua();tb.ua()}I.clearRect(0,0,X.width,X.height);if(r)if(0===r.A)fb(),V(20),P("center"),mb("JOIN",40),mb("NAME",100);else{{let a=ma();var sc=a&&0<a.j}if(sc)if(1===ja(r))nb("WINNER WINNER CHICKEN DINNER");else{if(0<=r.currentTime){let a=J.aa(r.currentTime),b=ma();a&&b&&ha(a,b)&&(I.fillStyle=db(0,1,1,.5),I.fillRect(0,0,T,U))}if(zb){const a=.9*U|0;cb(Q-a/2|0,R-a/2|0,a,!0)}else{{const a=(180*w.g/m+.5|0)-90,b=T/3,c=T/3/180;P("center");for(let d=
0,e=a,f=b;180>=d;d++,e++,f+=c){const a=f+.5|0;for(var na=e;0>na;)na+=360;for(;360<=na;)na-=360;e=na;0===e%15&&(eb[e]?(V(14),I.lineWidth=2,ob(a,30,a,40),S(eb[e],a,60)):(V(11),I.lineWidth=1,ob(a,32,a,38),S(e.toString(),a,60)))}}V(18);I.fillStyle="#000";I.fillRect(T-130,20,40,30);P("center");var tc=ja(r),uc=T-110;I.fillStyle="#fff";I.fillText(tc,uc,42);I.fillStyle="#888";I.fillRect(T-90,20,80,30);P("left");var vc=T-85;I.fillStyle="#444";I.fillText("ALIVE",vc,42);{const a=ma();a&&(V(24),P("center"),S("Ammo: "+
a.I,Q,U-65))}{const a=ma();if(a){var ec=Q-200,fc=U-50,jb=a.j/100;I.fillStyle=db(0,1-jb,.5+.5*jb);I.fillRect(ec,fc,400*jb,25);I.strokeStyle="#fff";I.lineWidth=1;I.beginPath();I.rect(ec,fc,400,25);I.stroke()}}{const a=.15*X.width|0,b=X.width-a-20|0,c=X.height-a-20|0;cb(b,c,a,!1);if(r&&0<=r.currentTime){const a=c-10,d=30-(r.currentTime|0)%30;V(14);P("left");S(d,b,a)}}P("left");V(11);S("WASD - Move",20,U-140);S("Left click - Shoot",20,U-120);S("Right click - Zoom",20,U-100);S("M - Map",20,U-80);if(0<=
r.currentTime){I.lineWidth=2;ob(Q-30,R,Q+30,R);ob(Q,R-30,Q,R+30);{let a=(r.currentTime|0)%60,b=.25*U|0;V(40);P("center");5>a?S("New Play Area marked on map",Q,b):20<=a&&25>a?S("Old Play Area goes OFFLINE in 10s!",Q,b):30<=a&&35>a&&S("Old Play Area going OFFLINE!",Q,b)}}else!r||0<=r.currentTime||(P("center"),V(14),S("Starts in:",Q,R-60),V(60),S(-r.currentTime|0,Q,R));V(11);P("right");for(let a=0;a<wb.length;a++)S(wb[a],T-10,80+20*a)}V(11);P("center");S("Ping "+sb.toFixed(0)+" ms",Q,U-10)}else nb("YOU DIED")}else fb(),
V(11),P("center"),S("Connecting...",Q,R+50);requestAnimationFrame(Ib)}requestAnimationFrame(Ib);function Eb(){T=window.innerWidth;U=window.innerHeight;Q=T/2|0;R=U/2|0;Bb&&(Bb.width=T,Bb.height=U);X&&(X.width=T,X.height=U)}function Hb(){document.pointerLockElement===X||document.mozPointerLockElement===X?(document.addEventListener("mousemove",jc,!1),yb=!0):(document.removeEventListener("mousemove",jc,!1),yb=!1)}
function jc(a){const b=Cb?1E-4:.001;w.g=ka(w.g+b*a.movementX);w.pitch=ka(w.pitch+b*a.movementY)};const pa=new Float32Array(3),Gb=t(0,0,1),u=new Float32Array(3),ic=new Float32Array(3),hc=t(-1,1,1),wa=qa(),A=qa(),Kb=qa(),gc=qa(),x=Bb.getContext("webgl",{alpha:!1,antialias:!1,premultipliedAlpha:!1}),va=kc();
function kc(){const a=x.createTexture();x.bindTexture(3553,a);x.texImage2D(3553,0,6408,1,1,0,6408,5121,new Uint8Array([0,0,255,255]));const b=new Image;b.onload=function(){x.bindTexture(3553,a);x.texImage2D(3553,0,6408,6408,5121,b);x.texParameteri(3553,10240,9728);x.texParameteri(3553,10241,9728);x.generateMipmap(3553)};b.src="textures.png";return a}
function ub(a,b,c,e,d){var g=W;const h=J.i(a,b)+c;{var f=t(a-c,h+c,b),k=t(a+c,h+c,b),n=t(a+c,h-c,b);const v=t(a-c,h-c,b);g.C([f,k,n,v],e,0,d)}f=t(a,h+c,b-c);k=t(a,h+c,b+c);n=t(a,h-c,b+c);a=t(a,h-c,b-c);g.C([f,k,n,a],e,0,d)}
function Jb(a){for(let h=a.length-1;0<=h;h--){let f=a[h];if(!(0>=f.j||f.s===r.N)){switch(f.v){case 2:{var b=(5*(30+r.currentTime)|0)%4;3===b&&(b=1);var c=.001<Math.hypot(f.c,f.f),e=f.x-w.x;let a=f.z-w.z;var d=Math.hypot(e,a);let h=0;var g=0;0<d&&(e/=d,a/=d,g=Math.sin(f.g),d=Math.cos(f.g),h=e*g+a*d,g=e*d-a*g);e=!1;.7<h?c?(b=48+16*b,c=48):c=b=32:-.7>h?(b=c?48+16*b:0,c=32):(c?(b*=16,c=48):(b=16,c=32),e=0>g);lc(f,1,b,c,e)}break;case 3:lc(f,.05,48,0);break;case 13:lc(f,.04,112,16);f.o-=4;break;case 14:lc(f,
.5,32+16*Math.min(3,(16-f.o)/4|0),16);f.o--;break;case 6:lc(f,.5,96,16);break;case 7:lc(f,.5,112,0)}2!==f.v&&0===f.o&&a.splice(h,1)}}}function lc(a,b,c,e,d){var g=a.x,h=a.y;a=a.z;var f=g-w.x,k=a-w.z,n=Math.hypot(f,k);f/=n;k/=n;n=d?-1:1;d=g-n*b*k;k=g+n*b*k;g=a+n*b*f;a-=n*b*f;f=h+b;h-=b;b=t(d,f,g);f=t(k,f,a);a=t(k,h,a);h=t(d,h,g);tb.C([b,f,a,h],c,e)};
