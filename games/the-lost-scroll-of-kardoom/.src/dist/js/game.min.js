function _$(e){return e.indexOf(!1)?(e=e.replace(/#/,""),window[e]):__$(e)}function __$(e){return document.querySelector(e)}function _$$(e){return document.querySelectorAll(e)}function Floor(e){return e=e||{},this.name=e.name||"FLOOR",this.glyph=".",this.layer=e.layer||0,this.id=e.id||0,this.x=e.x||0,this.y=e.y||0,this.state=e.state||STATE_NORMAL,this.eventCell=prng.random()<.105,this.hasFired=!1,this}function Wall(e){return e=e||{},this.name=e.name||"WALL",this.glyph="#",this.layer=e.layer||0,this.id=e.id||0,this.x=e.x||0,this.y=e.y||0,this.state=e.state||STATE_NORMAL,this}function Door(e){return e=e||{},this.name=e.name||"DOOR",this.glyph="d",this.layer=e.layer||0,this.id=e.id||0,this.x=e.x||0,this.y=e.y||0,this.state=e.state||STATE_NORMAL,this.dest=e.dest||0,this}function Pickup(e){return e=e||{},this.name=e.name||"PICKUP",this.glyph="p",this.layer=e.layer||0,this.id=e.id||0,this.x=e.x||0,this.y=e.y||0,this.state=e.state||STATE_NORMAL,this}function Actor(e){e=e||{};var t=e.id||0;return this.name=e.name||"ACTOR",this.glyph="a",this.layer=e.layer||0,this.x=e.x||0,this.y=e.y||0,this.state=e.state||STATE_NORMAL,this.hp=1,0==t?(this.glyph="@",this.hp=3):this.hp=prng.getInt(2,1),this.id=t,this}function Card(e){return e=e||{},this.id=e.id||0,this.name=e.name||"CARD",this.cb=e.cb||function(){},this}function createEventsDeck(e){function t(){engine.player.addHealth(engine.player.hpMax),engine.log("You feel restored!")}function i(){engine.player.addHealth(1),engine.log("You feel refreshed!")}function n(){engine.lightning(),engine.actors.forEach(function(e){if(e){if(0==e.id)return;e.hit()}}),engine.log("Magical lightning strike!")}function r(){for(var e=0,t=!1;!t;)e=Math.floor(Math.random()*engine.actors.length),t=engine.actors[e];0!=e&&(t.hit(),engine.lightning(),engine.log("Lightning Strike!"))}function s(){engine.player.hp>1&&(engine.player.hit(),engine.log("You don't feel well"))}function o(){engine.dayNightCycle("day")}function h(){engine.dayNightCycle("night")}for(var a=[],c=[{id:0,name:"Restore",cb:t},{id:1,name:"Refresh",cb:i},{id:2,name:"Refresh",cb:i},{id:3,name:"Lightning Strike",cb:r},{id:4,name:"Lightning Strike",cb:r},{id:5,name:"Magical Lightning",cb:n},{id:6,name:"Sick",cb:s},{id:7,name:"Sick",cb:s},{id:8,name:"Daytime",cb:o},{id:9,name:"Nighttime",cb:h}],g=0;g<e;g++){var l=Math.floor(Math.random()*c.length),d=new Card(c[l]);a.push(d)}return a}function Layer(e){return e=e||{},this.width=e.W||10,this.height=e.H||10,this.id=e.id||this.uuid(),this.thing=!!e.T&&e.T||!1,this.numThings=e.N||10,this.probability=e.P||1,this.border=e.B||!1,this.map=[],this.things=[],this.dirty=!0,this.rendered="",this.empty(),this}function Player(e){return e=e||{},this.hp=e.hp||3,this.hpMax=e.hpMax||3,this.inventory=e.inventory||[],this.max_scroll=e.maxScroll||3,this.max_potion=e.maxPotion||3,this.max_gold=e.maxGold||10,this}function Engine(e){e=e||{};var t;if(this.mode="start",this.menu=[],this.menuSelection=0,this.layers=[],this.floors=[],this.walls=[],this.doors=[],this.pickups=[],this.actors=[],this.player=new Player,this.seed=e.seed||4242,this.width=e.W||10,this.height=e.H||10,this.numDoors=e.D||1,this.numPickups=e.P||3,this.numActors=e.A||10,this.renderMode="2d",this.cardDecks=[],this.storm=!1,this.effects=screen.availWidth>=800,this.clkFlicker,this.time=0,this.day=1,this.usingLantern=!1,window.addEventListener("keydown",this.handleInputs),this.setSeed(seed),!e.hasStarted){for(var i=0;i<this.height;i++)for(var n=0;n<this.width;n++)t=document.createElement("span"),t.id="B"+i+"_"+n,t.className="SP",t.style.top=20*i+"px",t.style.left=15*n+"px",_$("#stage2d").appendChild(t);for(var i=0;i<this.height;i++)for(var n=0;n<this.width;n++)t=document.createElement("span"),t.id="C"+i+"_"+n,t.className="SP",t.style.top=20*i+"px",t.style.left=15*n+"px",_$("#stage2d").appendChild(t)}return this.player.updateGameUI(),this.player.updateInventoryUI(),this.cardDecks[DECK_EVENTS]=createEventsDeck(10),this.shuffleDeck(DECK_EVENTS),this.cardDecks[DECK_EVENTS_DISCARDS]=[],this}function startNewGame(e){setSeed(4243),window.engine=new Engine({W:50,H:30,D:1,A:10,P:3,hasStarted:e}),engine.render(),engine.clock(),engine.centerView(),engine.player.updateGameUI(),e?engine.showScreen("intro"):setTimeout(function(){engine.showScreen("mainmenu")},3e3)}!function(){var e=function(){var e=function(e){this.x=0,this.w=0,this.s=e&&e.seed||1168985806,this.maxPrecision=e&&e.maxPrecision||10};return e.prototype.getSeed=function(){return this.s},e.prototype.setSeed=function(e){this.s=e},e.prototype.msws=function(e,t){var i=!!e,n=!1,r=0;for(e=e||1,t=t||0;!n;){r+=1,this.x*=this.x,this.x+=this.w+=this.s,this.x=this.x>>16|this.x<<16,this.x=this.x<0?this.x*-1:this.x;var s=i&&(this.x>e||t&&this.x<t);i?s||(n=!0):n=!0}return this.x},e.prototype.getInt=function(e,t){return this.msws(e,t)},e.prototype.getFloat=function(e,t){t=t||0,e=e||1;var i=1===e?0:this.getInt(e-1,t),n=this.getInt(1+"0".repeat(this.maxPrecision)),r=+i+"."+n;return r},e.prototype.getFixed=function(e,t,i){return e=e||2,i=i||0,t=t||1,e=e>=this.maxPrecision?this.maxPrecision:e,new Number(this.getFloat(t,i)).toFixed(e)},e.prototype.random=function(){return this.getFloat(1,0)},e}();"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:window.MSWS=e}(),window.setSeed=function(e){window.prng=new MSWS,window.seed=e,prng.setSeed(e)},setSeed(4242),LYR_FLOORS=0,LYR_WALLS=1,LYR_DOORS=2,LYR_PICKUPS=3,LYR_ACTORS=4,KEY_W=87,KEY_Z=90,KEY_UP=38,KEY_A=65,KEY_Q=81,KEY_LEFT=37,KEY_S=83,KEY_DOWN=40,KEY_D=68,KEY_RIGHT=39,KEY_SPACE=32,KEY_ENTER=13,DECK_EVENTS=0,DECK_EVENTS_DISCARDS=1,STATE_NORMAL=0,Floor.prototype.getName=function(e){var t=["Floor"];return t[0]},Floor.prototype.trigger=function(e){this.eventCell&&!this.hasFired&&(engine.drawCard(DECK_EVENTS),this.hasFired=!0)},STATE_NORMAL=0,Wall.prototype.getName=function(e){var t=["Wall"];return t[0]},Wall.prototype.trigger=function(){},STATE_NORMAL=0,Door.prototype.getName=function(e){var t=["Door"];return t[0]},Door.prototype.trigger=function(){var e=this.dest;setTimeout(function(){engine.setSeed(e),engine.player.updateGameUI()},0)},STATE_NORMAL=0,Pickup.prototype.getName=function(e){var t,i=["Potion","Scroll","Gold","Lantern","Axe"];return"undefined"!=typeof engine&&i.push("Kardoom"),t=prng.getInt(i.length,1)-1,i[t]},Pickup.prototype.trigger=function(){engine.player.addItem(this.name)&&(engine.layers[LYR_PICKUPS].map[this.y][this.x]=" ",engine.layers[LYR_PICKUPS].dirty=!0,engine.layers[LYR_PICKUPS].render(),engine.pickups[this.id]=void 0)},STATE_NORMAL=0,STATE_AGITATED=1,Actor.prototype.agitate=function(){0!=this.id&&(this.state=STATE_AGITATED,this.glyph="A",engine.layers[LYR_ACTORS].map[y][x]=this.glyph,engine.layers[LYR_ACTORS].dirty=!0,engine.layers[LYR_ACTORS].render())},Actor.prototype.calm=function(){0!=this.id&&(this.state=STATE_NORMAL,this.glyph="a",engine.layers[LYR_ACTORS].map[y][x]=this.glyph,engine.layers[LYR_ACTORS].dirty=!0,engine.layers[LYR_ACTORS].render())},Actor.prototype.move=function(e,t,i){var n=this.id,r=this.x+e,s=this.y+t;if(0==n&&!i)return!1;if(Math.abs(e)>1||Math.abs(t)>1)return console.warn("WARN: actor movement range is out of range, got: %s, %s",e,t),!1;r<0&&(r=0),r>engine.width&&(r=engine.width),s<0&&(s=0),s>engine.height&&(s=engine.height);var o=engine.layers[LYR_FLOORS].map[s][r],h=engine.layers[LYR_WALLS].map[s][r],a=engine.layers[LYR_DOORS].map[s][r],c=engine.layers[LYR_PICKUPS].map[s][r],g=engine.layers[LYR_ACTORS].map[s][r];if(i){if("."==o.toLowerCase()&&engine.floors.forEach(function(e){s==e.y&&r==e.x&&e.trigger(this)}),"d"==a.toLowerCase()&&engine.doors.forEach(function(e){s==e.y&&r==e.x&&e.trigger(this)}),"p"==c.toLowerCase()&&engine.pickups.forEach(function(e){e&&s==e.y&&r==e.x&&e.trigger(this)}),"a"==g.toLowerCase())return engine.actors.forEach(function(e){e&&s==e.y&&r==e.x&&e.hit(this)}),!0;"#"==h&&engine.player.has("axe")>-1&&(engine.log("Chop Chop"),s>0&&s<engine.height-1&&r>0&&r<engine.width-1&&Math.floor(8*Math.random())>5&&(engine.log("Timber!"),engine.layers[LYR_WALLS].map[s][r]=" ",engine.layers[LYR_WALLS].dirty=!0,engine.layers[LYR_WALLS].render()))}else{if("@"==g)return engine.player.hit(this),!0;if("a"==g.toLowerCase()){var l=this;return engine.actors.forEach(function(e){e&&s==e.y&&r==e.x&&e.hit(l)}),!0}}return"#"!=h&&(engine.layers[this.layer].map[this.y][this.x]=" ",this.x=r,this.y=s,engine.layers[this.layer].map[this.y][this.x]=this.glyph,engine.layers[this.layer].dirty=!0,engine.layers[this.layer].render()),!0},Actor.prototype.getName=function(e){var t=["Player","Actor1","Actor2","Actor3","Actor4","Actor5","Actor6","Actor7"];return this.id<t.length?t[this.id]:"Extra Actor"},Actor.prototype.hit=function(e){console.log("actor %s hit actor %s",e&&e.id,this.id),this.hp-=1,this.hp<=0&&(this.hp=0,this.die())},Actor.prototype.die=function(){console.log("actor %s died",this.id),engine.layers[LYR_ACTORS].map[this.y][this.x]=" ",engine.actors[this.id]=void 0},Card.prototype.play=function(){console.log("Card played: %s",this.name),this.cb()},Card.prototype.discard=function(){},Layer.prototype.uuid=function(){return 0},Layer.prototype.empty=function(){this.map=[];for(var e=0;e<this.height;e++){this.map.push([]);for(var t=0;t<this.width;t++)this.map[e][t]=" "}return this.id},Layer.prototype.from=function(e){switch(typeof e){case"string":console.warn("STUB: from(rendered)");break;case"object":console.warn("STUB: from(AoA)");break;default:console.warn("Layer.from(): Unsupported layer source")}},Layer.prototype.generate=function(e){var t=n=y=p=a=0;if("object"!=typeof e)for(e=[],y=0;y<this.height;y++){for(var i=[],n=0;n<this.width;n++)i.push(" ");e.push(i)}if(this.numThings<0){var r=0;for(y=0;y<this.height;y++)for(n=0;n<this.width;n++){var s=this.probability>=1||prng.random()<this.probability;if(this.border&&(y<this.border||y>=this.height-this.border-1||n<this.border||n>=this.width-this.border-1)&&(s=!0),s){var o=new this.thing({layer:this.id,id:r,x:n,y:y});o.name=o.getName(r),this.map[y][n]=o.glyph||"?",this.things.push(o)}r+=1}}else for(r=0;r<this.numThings;r++)for(t=!0,n=y=0;t;)if(n=prng.getInt(this.width-1,0),y=prng.getInt(this.height-1,0),"#"!=e[y][n]&&" "==this.map[y][n]){var o=new this.thing({layer:this.id,id:r,x:n,y:y});o.name=o.getName(r),this.map[y][n]=o.glyph||"?",this.things[r]=o,t=!1}return this.render()},Layer.prototype.render=function(){var e="";if(!this.dirty)return this.rendered;for(var t=0;t<this.height;t++){for(var i=0;i<this.width;i++)e+=this.map[t][i];e+="\n"}return this.rendered=e,this.dirty=!1,e},Player.prototype.hit=function(e){this.hp-=1,this.hp<=0&&(this.hp=0,this.die()),this.updateGameUI()},Player.prototype.canTake=function(e){var t=[],i=e&&"max_"+e.toLowerCase(),n=this[i]||1;return t=this.inventory.filter(function(t){return t==e}),!t.length||!!(n&&t.length<n)},Player.prototype.addItem=function(e,t){return this.canTake(e)?(this.inventory.push(e),t||engine.log("You found a "+e),this.updateGameUI(),this.updateInventoryUI(),!0):(t||engine.log("Can't take "+e),!1)},Player.prototype.updateGameUI=function(){var e=[],t=["Potion","Scroll","Gold"],i=this.inventory;t.forEach(function(t){e=i.filter(function(e){return e==t}),_$("#"+t.toLowerCase()).innerText=e.length}),_$("#hp").innerText=this.hp,"undefined"!=typeof engine&&(_$("#day").innerText=engine.day,_$("#room").innerText=engine.seed)},Player.prototype.updateInventoryUI=function(){var e=[],t=[];_$("#items").innerHTML="",this.inventory.forEach(function(t){"undefined"==typeof e[t]&&(e[t]={name:t,count:0}),e[t].count+=1}),t=Object.keys(e),t.forEach(function(t){var i=e[t];_$("#items").innerHTML+="<li>"+i.count+" x <button onclick=\"engine.player.use('"+i.name+"')\">"+i.name+"</button></li>"})},Player.prototype.addHealth=function(e){this.hp+=e,this.hp>this.hpMax&&(this.hp=this.hpMax),this.updateGameUI()},Player.prototype.die=function(){_$("#died_in_room").innerText=_$("#room").innerText,engine.showScreen("died")},Player.prototype.has=function(e){var t=-1;return this.inventory.forEach(function(i,n){i.toLowerCase()===e.toLowerCase()&&(t=n)}),t},Player.prototype.use=function(e){var t=this.has(e),i=!0;if(t>-1)switch(e.toLowerCase()){case"scroll":engine.log("You use a scroll"),engine.actors.forEach(function(e,t){0!=t&&void 0!=e&&e.hit(engine.actors[0])}),engine.render();break;case"potion":engine.log("You drink a potion"),this.addHealth(this.hpMax);break;case"lantern":engine.time>=36&&engine.time<108?(engine.log("You light your lantern"),engine.usingLantern=!0,engine.lightFlicker()):engine.log("It's not dark out"),i=!1;break;case"gold":default:engine.log("You can't use "+e+" right now."),i=!1}i&&this.inventory.splice(t,1)[0],this.updateGameUI(),this.updateInventoryUI(),engine.showScreen("game")},Engine.prototype.setSeed=function(e){this.seed=e,window.setSeed(e),this.generateLayers(),this.render(),this.centerView()},Engine.prototype.generateLayers=function(){this.layers=[],this.layers.push(new Layer({id:LYR_FLOORS,W:this.width,H:this.height,N:-1,T:Floor})),this.layers[LYR_FLOORS].generate(),this.floors=this.layers[LYR_FLOORS].things,this.layers.push(new Layer({id:LYR_WALLS,W:this.width,H:this.height,N:-1,P:.15,T:Wall,B:1})),this.layers[LYR_WALLS].generate(),this.walls=this.layers[LYR_WALLS].things,this.layers.push(new Layer({id:LYR_DOORS,W:this.width,H:this.height,N:this.numDoors,T:Door})),this.layers[LYR_DOORS].generate(this.layers[LYR_WALLS].map),this.doors=this.layers[LYR_DOORS].things,this.doors.forEach(function(e){e.dest=4242+prng.getInt(1e3,1)}),this.layers.push(new Layer({id:LYR_PICKUPS,W:this.width,H:this.height,N:this.numPickups,T:Pickup})),this.layers[LYR_PICKUPS].generate(this.layers[LYR_WALLS].map),this.pickups=this.layers[LYR_PICKUPS].things,this.layers.push(new Layer({id:LYR_ACTORS,W:this.width,H:this.height,N:this.numActors,T:Actor})),this.layers[LYR_ACTORS].generate(this.layers[LYR_WALLS].map),this.actors=this.layers[LYR_ACTORS].things},Engine.prototype.isMode=function(e){return e===this.mode},Engine.prototype.handleInputs=function(e){var t="game"===engine.mode;switch(isMenu=["mainmenu","intro","inventory","win","died"].includes(engine.mode),e.which){case KEY_W:case KEY_Z:case KEY_UP:t&&engine.actors[0].move(0,-1,!0),isMenu&&engine.selectPrevious();break;case KEY_A:case KEY_Q:case KEY_LEFT:t&&engine.actors[0].move(-1,0,!0),isMenu&&engine.selectPrevious();break;case KEY_S:case KEY_DOWN:t&&engine.actors[0].move(0,1,!0),isMenu&&engine.selectNext();break;case KEY_D:case KEY_RIGHT:t&&engine.actors[0].move(1,0,!0),isMenu&&engine.selectNext();break;case KEY_ENTER:t&&engine.showScreen("inventory"),isMenu&&engine.activateSelected()}t&&(engine.aiTurn(),engine.render(),engine.centerView(),engine.clock(),engine.winCondition())},Engine.prototype.centerView=function(){if("undefined"!=typeof engine&&engine.actors.length>1){var e=_$("#stage2d"),t=-1*(15*engine.actors[0].x-150),i=-1*(20*engine.actors[0].y-100);e.style.top=i+"px",e.style.left=t+"px"}},Engine.prototype.selectPrevious=function(){var e;this.menuSelection-=1,this.menuSelection<0&&(this.menuSelection=this.menu.length-1),e=_$$("#"+engine.mode+" button"),e.forEach(function(e){e.classList.remove("highlight")}),this.menu[this.menuSelection].classList.add("highlight")},Engine.prototype.selectNext=function(){var e;this.menuSelection+=1,this.menuSelection>=this.menu.length&&(this.menuSelection=0),e=_$$("#"+engine.mode+" button"),e.forEach(function(e){e.classList.remove("highlight")}),this.menu[this.menuSelection].classList.add("highlight")},Engine.prototype.activateSelected=function(){var el=this.menu[this.menuSelection],fn=el&&el.getAttribute("onclick");fn&&"string"==typeof fn&&eval(fn)},Engine.prototype.aiTurn=function(){this.actors.forEach(function(e){if(e&&0!=e.id){var t=prng.getInt(4,1)-1;0==t&&e.move(0,-1),1==t&&e.move(-1,0),2==t&&e.move(0,1),3==t&&e.move(1,0)}})},Engine.prototype.mergeLayers=function(){for(var e,t,i="",n=this.width,r=this.height,s=this.layers[LYR_FLOORS].map,o=this.layers[LYR_WALLS].map,h=this.layers[LYR_DOORS].map,a=this.layers[LYR_PICKUPS].map,c=this.layers[LYR_ACTORS].map,g=0;g<r;g++){for(var l=0;l<n;l++)e="",t="#"===o[g][l],e=t?o[g][l]:" "!=c[g][l]?c[g][l]:" "!=h[g][l]?h[g][l]:" "!=a[g][l]?a[g][l]:s[g][l],i+=e;i+="\n"}return"2d"===this.renderMode?[this.layers[LYR_FLOORS].render(),i]:i},Engine.prototype.render=function(){var e,t;if("2d"===this.renderMode){var i=this.mergeLayers();if(e=i[0],t=i[1],_$("#B0_0"))for(var n=0;n<this.height;n++)for(var r=0;r<this.width;r++)window["B"+n+"_"+r].className="SP grass"}else t=this.mergeLayers();if(stage.innerText=t,!_$("#C0_0"))return t;for(var s=t.split(/\n/),o={".":"GR","#":"TR","@":"PL",a:"AC",p:"GO",d:"ST"},n=0;n<this.height;n++)for(var h=s[n],a=h.split(""),r=0;r<this.width;r++){var c=a[r];_$("#C"+n+"_"+r).className="SP "+o[c]}return t},Engine.prototype.hideScreens=function(){var e=_$$(".screen");e.forEach(function(e){e.style.display="none"})},Engine.prototype.showScreen=function(e){this.hideScreens(),_$("#"+e).style.display="block",this.mode=e,this.menu=_$$("#"+e+" button"),this.menuSelection=0,"game"!==e&&this.menu[this.menuSelection].classList.add("highlight")},Engine.prototype.shuffleDeck=function(e){for(var t=Math.floor(5*Math.random())+5,i=[],n=0;n<t;n++)for(;this.cardDecks[e].length>0;){var r=Math.floor(Math.random()*this.cardDecks[e].length);i.push(this.cardDecks[e].splice(r,1)[0])}this.cardDecks[e]=i},Engine.prototype.drawCard=function(e){var t=this.cardDecks[e].shift(),i=this.getDiscards(e);if(t.play(),t.discard(),this.cardDecks[i].push(t),this.cardDecks[e].length<1)for(;this.cardDecks[i].length>0;)this.cardDecks[e].push(this.cardDecks[i].pop())},Engine.prototype.getDiscards=function(e){var t=!1;switch(e){case DECK_EVENTS:t=DECK_EVENTS_DISCARDS;break;default:console.warn("WARN: Deck %s not found")}return t},Engine.prototype.dayNightCycle=function(e){e||(e=this.time<36||this.time>108?"night":"day"),"night"==e?(this.time=36,this.lightFlicker()):this.time=108},Engine.prototype.lightFlicker=function(){if(clearTimeout(engine.clkFlicker),!(engine.player.has("lantern")<0)){var e=Math.floor(128*Math.random()),t=1.25+e/128*.25,i=Math.floor(200*Math.random())+50;t>1.5&&(t=1.5),engine.effects?(_$("#lightmask").style.transform="scale("+t+")",light.style.backgroundColor="rgba("+e+", "+e+", 0, 0.5)"):light.style.backgroundColor="rgba(64, 64, 0, 0.5)",engine.clkFlicker=setTimeout(engine.lightFlicker,i)}},Engine.prototype.lightning=function(){engine.effects&&(engine.lightFlicker(),(engine.time<36||engine.time>=108)&&setTimeout(function(){clearTimeout(engine.clkFlicker),_$("#light").style.backgroundColor="rgba(64,64,0,0.5)"},1e3))},Engine.prototype.clock=function(){var e,t,i,n=this.time+=1;if(n>144&&(n=0),36==n&&engine.log("It's going to get dark soon"),108==n&&(clearTimeout(engine.clkFlicker),engine.usingLantern=!1,engine.day+=1,engine.player.updateGameUI(),engine.log("It's morning")),n>60&&n<=72?_$("lightmask").style.opacity=1-(72-n)/12:n>96&&n<108?_$("lightmask").style.opacity=(108-n)/12:n>=108&&(_$("lightmask").style.opacity=0),!engine.usingLantern){if(n>36&&n<=108){var r=n<72?72-n:n-108;e=64+r}else e=128;if(n<36||n>=108){var r=n<36?36-n:n-108;t=64+2*r}else t=0;if(n>36&&n<108){var r=n<72?72-n:n-108;i=128-2*r}else i=0;_$("#light").style.backgroundColor="rgba("+e+","+t+","+i+",0.5)"}this.time=n},Engine.prototype.log=function(e){M.value+=e+"\n",M.scrollTop=M.scrollHeight},Engine.prototype.winCondition=function(){engine.player.has("kardoom")>-1&&engine.showScreen("win")},window.addEventListener("load",function(){_$("#btn_up").addEventListener("click",function(){engine.handleInputs({which:87})}),_$("#btn_lt").addEventListener("click",function(){engine.handleInputs({which:65})}),_$("#btn_dn").addEventListener("click",function(){engine.handleInputs({which:83})}),_$("#btn_rt").addEventListener("click",function(){engine.handleInputs({which:68})}),startNewGame(!1)});
