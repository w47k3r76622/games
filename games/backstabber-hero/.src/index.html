<head><meta name="monetization" content="$coil.xrptipbot.com/FpG5bRAeSVuJbdCJddtAgw"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><link rel="manifest" href="pwa.webmanifest"></head><body><div id="c"><div class="lc lan"><div id="l">&larr;</div><div id="r">&rarr;</div></div><canvas height="240px" width="256px"></canvas><div class="rc"><div class="arrows"><div id="l2">&larr;</div><div id="r2">&rarr;</div></div><div class="buttons"><div id="j">Jump</div><div id="s">Stab</div><div id="d">Duck</div></div></div></div><style>body { user-select: none; margin: 0; overflow: hidden; background: #000; font-weight: 700; font-size: 3vw; } body.p { font-size: 1.5em; } body:not(.m) .lc, body:not(.m) .rc { min-width: 0; } .lc, .rc .arrows { font-size: 1.5em; } body.m { color: #fff; } #c { height: 100vh; } body.p .lc { display: none; } body:not(.p) .arrows { display: none; } body div { display: flex; flex: 1; } body.p > div { flex-direction: column; } canvas { background-color: #aaa; } body.p canvas { height: 100vw; } body:not(.p) canvas { margin: auto; height: 100vh; } .rc { /* display: flex; */ /* flex-shrink: 1; */ } .lc div, .rc > div > div { align-items: center; justify-content: center; } .arrows div { flex-grow: 1; max-width: 100px; } .buttons { flex-direction: column; } .buttons div { width: 100%; min-width: 50%; margin-left: auto; } canvas { image-rendering: -moz-crisp-edges; image-rendering: -webkit-crisp-edges; image-rendering: pixelated; }</style><script src="gsw.js"></script><script type="text/javascript">!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);let s,n;function o(){return s}function a(){return n}function r(){return s=document.querySelector("canvas"),(n=s.getContext("2d")).imageSmoothingEnabled=!1,{canvas:s,context:n}}class h{constructor({spriteSheet:t,frames:e,frameRate:i,loop:s=!0,flipped:n}={}){this.flipped=n,this.spriteSheet=t,this.frames=e,this.frameRate=i,this.loop=s;let{width:o,height:a,margin:r=0}=t.frame;this.width=o,this.height=a,this.margin=r,this._f=0,this._a=0}clone(){return l(this)}reset(){this._f=0,this._a=0}update(t=1/60){if(this.loop||this._f!=this.frames.length-1)for(this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render({x:t,y:e,height:i=this.height,context:s=a()}={}){let n=this.frames[this._f]/this.spriteSheet._f|0,o=this.frames[this._f]%this.spriteSheet._f|0;this.flipped&&(s.scale(-1,1),t-=16),s.drawImage(this.spriteSheet.image,16*o,n*i,16,i,Math.round(t),Math.round(e),16,i)}}function l(t){return new h(t)}l.prototype=h.prototype,l.class=h;new WeakMap;const c=()=>{};function f(){let t=o();a().clearRect(0,0,t.width,t.height)}function d({fps:t=60,clearCanvas:e=!0,update:i,render:s}={}){let n,o,a,r,h,l=0,d=1e3/t,g=1/t,u=e?f:c;function p(){if(o=requestAnimationFrame(p),a=performance.now(),r=a-n,n=a,!(r>1e3)){for(l+=r;l>=d;)h.update(g),l-=d;u(),h.render()}}return h={update:i,render:s,isStopped:!0,start(){n=performance.now(),this.isStopped=!1,requestAnimationFrame(p)},stop(){this.isStopped=!0,cancelAnimationFrame(o)}}}class g{constructor({create:t,maxSize:e=1024}={}){let i;if(!t||!(i=t())||!(i.update&&i.init&&i.isAlive))throw Error("Must provide create() function which returns an object with init(), update(), and isAlive() functions");this._c=t,this._i=0,this.objects=[t()],this.size=1,this.maxSize=e}get(t={}){if(this.objects.length==this._i){if(this.size===this.maxSize)return;for(let t=0;t<this.size&&this.objects.length<this.maxSize;t++)this.objects.unshift(this._c());this.size=this.objects.length}let e=this.objects.shift();return e.init(t),this.objects.push(e),this._i++,e}getAliveObjects(){return this.objects.slice(this.objects.length-this._i)}clear(){this._i=this.objects.length=0,this.size=1,this.objects.push(this._c())}update(t){let e,i=this.size-1,s=Math.max(this.objects.length-this._i,0);for(;i>=s;)(e=this.objects[i]).update(t),e.isAlive()?i--:(this.objects=this.objects.splice(i,1).concat(this.objects),this._i--,s++)}render(){let t=Math.max(this.objects.length-this._i,0);for(let e=this.size-1;e>=t;e--)this.objects[e].render()}}function u(t){return new g(t)}function p(t,e){let i=[],s=e.x+e.width/2,n=e.y+e.height/2,o=t.y<n&&t.y+t.height>=e.y,a=t.y+t.height>=n&&t.y<e.y+e.height;return t.x<s&&t.x+t.width>=e.x&&(o&&i.push(0),a&&i.push(2)),t.x+t.width>=s&&t.x<e.x+e.width&&(o&&i.push(1),a&&i.push(3)),i}u.prototype=g.prototype,u.class=g;class m{constructor({maxDepth:t=3,maxObjects:e=25,bounds:i}={}){this.maxDepth=t,this.maxObjects=e;let s=o();this.bounds=i||{x:0,y:0,width:s.width,height:s.height},this._b=!1,this._d=0,this._o=[],this._s=[],this._p=null}clear(){this._s.map(function(t){t.clear()}),this._b=!1,this._o.length=0}get(t){let e,i,s=new Set;for(;this._s.length&&this._b;){for(e=p(t,this.bounds),i=0;i<e.length;i++)this._s[e[i]].get(t).forEach(t=>s.add(t));return Array.from(s)}return this._o.filter(e=>e!==t)}add(){let t,e,i,s;for(e=0;e<arguments.length;e++)if(i=arguments[e],Array.isArray(i))this.add.apply(this,i);else if(this._b)this._a(i);else if(this._o.push(i),this._o.length>this.maxObjects&&this._d<this.maxDepth){for(this._sp(),t=0;s=this._o[t];t++)this._a(s);this._o.length=0}}_a(t,e,i){for(e=p(t,this.bounds),i=0;i<e.length;i++)this._s[e[i]].add(t)}_sp(t,e,i){if(this._b=!0,!this._s.length)for(t=this.bounds.width/2|0,e=this.bounds.height/2|0,i=0;i<4;i++)this._s[i]=y({bounds:{x:this.bounds.x+(i%2==1?t:0),y:this.bounds.y+(i>=2?e:0),width:t,height:e},maxDepth:this.maxDepth,maxObjects:this.maxObjects}),this._s[i]._d=this._d+1,this._s[i]._p=this}}function y(t){return new m(t)}y.prototype=m.prototype,y.class=m;class A{constructor(t,e){this._x=t||0,this._y=e||0}clamp(t,e,i,s){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=s}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t}set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}}function b(t,e){return new A(t,e)}b.prototype=A.prototype,b.class=A;class x{constructor(t){this.init(t)}init(t={}){let{x:e,y:i,dx:s,dy:n,image:o}=t;this.position=b(e,i),this.velocity=b(s,n),this.height=16,this.context=a();for(let e in t)this[e]=t[e];o&&(this.width=void 0!==width?width:o.width,this.height=void 0!==height?height:o.height)}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get animations(){return this._a}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set animations(t){let e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=16,this.height=this.height||i.height}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){this.position={x:this.x+this.dx,y:this.y+this.dy},this.currentAnimation&&this.currentAnimation.update(t)}render(){this.context.save(),this.context.translate(this.x,this.y),this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.context.restore()}}function S(t){return new x(t)}S.prototype=x.prototype,S.class=x;class E{constructor({image:t,frameHeight:e,animations:i}={}){this.animations={},this.image=t,this.frame={width:16,height:e},this._f=99,this.createAnimations(i)}createAnimations(t){let e,i;for(i in t){let{frames:s,frameRate:n,loop:o,flipped:a}=t[i];e=[],e=+s==s?[s]:s,this.animations[i]=l({flipped:a,spriteSheet:this,frames:e,frameRate:n,loop:o})}}}function w(t){return new E(t)}w.prototype=E.prototype,w.class=E;var T;!function(t){t[t.Jump=0]="Jump",t[t.Up=1]="Up",t[t.Left=2]="Left",t[t.Right=3]="Right",t[t.Duck=4]="Duck",t[t.Stab=5]="Stab",t[t.Action=6]="Action",t[t.Any=7]="Any",t[t.Space=8]="Space"}(T||(T={}));let O={},k={},C=[];function I(t){let e=k[t.which];e&&(O[e]=!0),O[T.Jump]=e==T.Up||e==T.Space,O[T.Action]=e==T.Stab||e==T.Space,O[T.Any]=!0}function M(t){let e=k[t.which];e&&(O[e]=!1),O[T.Jump]=!1,O[T.Action]=!1,O[T.Any]=!1,O[T.Any]=!!Object.keys(O).find(t=>O[t])}function R(){O={}}function _(t){return!!O[t]}function B(){return C}const j=t=>Math.abs(Math.ceil(t))%2==0;var v=(t,e,i,s,n=1,o=0,r=0,h=a())=>{e=""+e,i=(i=-1===i?-128:i)<0?Math.abs(i)-8*e.length*n/2:i;let l=0;for(let a=0;a<e.length;a++){let c=e.charCodeAt(a)-65;if(-33!=c){if(-55===c){s+=10*n,c=-36,l=8*-(a+1)*n;continue}c<0&&(c+=46),h.drawImage(t,8*c,0,8,8,i+8*a*n+l,s+o*Math.sin(r/9+a/3),8*n,8*n)}}};const L=t=>{const e=document.getElementsByTagName("body")[0],i=window.s||{},s=a();let n="ontouchstart"in window;window.s=Object.assign({body:e},i,t,{context:s,mobile:n,press:(n?"TOUCH":"PRESS Z")+" TO CONTINUE"})},U=()=>window.s,J=t=>{const e=document.createElement("canvas");e.width=256,e.height=240;const i=e.getContext("2d");return i.imageSmoothingEnabled=!1,t(i),e},P=atob("J/N3VyGFUcZb4SQ4JiAn8ylYIUNsyFmGTCAn8yVsgKCBMiHPba5ZmiXTjiAl8yVsqHIhM22uMOFURyogJfM+W3KfqHIhiUVsJa0qdVIggF0lss5LJGAhQKKOMu9MqShHVCDAWEuNcpIkS1lAIS3X3jSUKq6UqVRrKCAl82drJUQocSGBOLgk43QzJV6sICbzJIOZhnJIIdVh0DFQrF0lICfgJvNnjSEy4oAkOVRrTCAkkoyPmYgkjCFpbpkwOlTalN9UM3QggDA+WyTzjYMhL1+jMJZsICTzJdU/3iXaIT+IK0BlTE9M1U7xlOslILNtKvMh3FC4J96UwSWdbJCMQiUgJ/NB3yHppmUxoFTOJsEmtCanJpomjSZzJoAmZiZZJkwmPypFJFIkXyRsJHkkhiSTJCCzbSrzIdxQuCfelJ1skIxCJSAkytpEwFemQlheJUBlWCExON5AzXQgszZyR8AxIYCdnjG3JMkkIIx8tGQkeIx2xEMkgT5UWTuaOyEsNN5oJky3TFJMvCbMKCAkaCXzgJmMkCRRITvJNYDs9ColoVBeUMXM7yU="),D=(t,e=13)=>{const i=(t-=35)%e;return[i,(t-i)/e]},F=(t,e)=>J(i=>{const{gfx:s}=U(),n=(t=>(t*=99,(e,i=0)=>{const s=1e4*Math.sin(t++);return Math.round(i+(s-Math.floor(s))*(e-i))}))(t),o=t%2;if(i.beginPath(),i.fillStyle=o?"#036":"#39F",i.fillRect(0,0,256,240),o){i.fillStyle="#FFF";for(let t=0;t<10+n(5);t++){const t=n(2,1);i.fillRect(n(256),n(120),t,t)}}else i.fillStyle="#FF0";const[a,r,h]=[n(16,6),9+n(245),4+n(20)];for(let t=3;--t;)i.globalAlpha=2/(3*t),i.arc(r,h+t,a*t,0,2*Math.PI,!1),i.lineWidth=0,i.fill(),i.beginPath();i.globalAlpha=1;for(let t=1;t>0;t--){let t=0;for(;t<256;){i.fillStyle=o?"#345":"#777";let e=36+Math.round(16*n(2)),s=n(100,48);i.fillRect(t,s,e,500),i.stroke(),i.globalAlpha=.2;for(let o=0;o<e-8;o+=8)for(let e=6;e<500;e+=16)i.fillStyle=n(2)?"#000":n(3)?"#fff":"#ff0",i.fillRect(t+o+2,s+e,6,8);i.stroke(),i.globalAlpha=1,t=Math.floor(t+e+n(3))}}e.platforms.forEach(t=>{for(let e=0;e<t.h;e+=16)for(let n=0;n<t.w;n+=16){const o=-16*(0===e?1:0);i.drawImage(s,128,16+o,16,16,t.x+n,t.y+e,16,16)}})}),N={top:!1,right:!1,bottom:!1,left:!1},H=(t,e)=>{let i=null;return e.forEach(e=>{e.dead||t.x<e.x+e.width&&t.x+16>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y&&(i=e)}),i},W=(t,e,i=null)=>{t.blocked=Object.assign({},N,{left:t.x<0,right:t.x>240});let s=i?t.height-i:0,n=t.y+s;i=i||t.height;const o=t.blocked;return e.forEach(e=>{const a={};if(a.left=e.x+e.w-t.x,a.right=16+t.x-e.x,a.top=e.y+e.h-n,a.bottom=i+n-e.y,a.top>=0&&a.right>=0&&a.bottom>=0&&a.left>=0){let e=99,i="";["left","right","top","bottom"].forEach(t=>{a[t]<e&&(e=a[t],i=t)}),o[i]=!0,o.any=!0,t.y=o.top||o.bottom?16*Math.round(t.y/16)+(o.top?s:0):t.y}t.x=o.left||o.right?16*Math.round(t.x/16):t.x,t.dx=o.left||o.right?0:t.dx,t.dy=o.top||o.bottom?0:t.dy}),o};var K,z,V,Y;!function(t){t[t.Left=-1]="Left",t[t.None=0]="None",t[t.Right=1]="Right"}(K||(K={})),function(t){t[t.Walker=0]="Walker",t[t.Stands=1]="Stands",t[t.Sleeper=2]="Sleeper"}(z||(z={})),function(t){t[t.Walk=0]="Walk",t[t.AboutToTurn=1]="AboutToTurn",t[t.Turn=2]="Turn",t[t.Watch=3]="Watch"}(V||(V={})),function(t){t[t.WalkTime=200]="WalkTime",t[t.TurnTime=50]="TurnTime"}(Y||(Y={}));const G=(t,e,i,s=1,n=.1,o=0,a=0,r=0,h=0)=>{let l=44100,c=Math.PI;i*=2*c/l,i*=1+e*(2*Math.random()-1),o*=1e3*c/l**2,n*=0|(s=0<s?l*(10<s?10:s)|0:1),r*=2*c/l,h*=c,e=[];for(var f=0,d=0,g=0;g<s;++g)e[g]=.5*t*Math.cos(f*i*Math.cos(d*r+h))*(g<n?g/n:1-(g-n)/(s-n)),f+=1+a*(2*Math.random()-1),d+=1+a*(2*Math.random()-1),i+=o;return t=zzfx_x.createBuffer(1,s,l),i=zzfx_x.createBufferSource(),t.getChannelData(0).set(e),i.buffer=t,i.connect(zzfx_x.destination),i.start(),i},Q=(t,{turnState:e,player:i,level:s,gameOver:n,tick:o})=>{const a=!((t,e)=>{const i=Object.assign({},t,{x:t.x+(1===t.facing?8:-8),y:t.y+8});return W(i,e),i.blocked})(t,s.platforms).bottom;let r="I";if(t.dy+=.2,!t.dead&&!t.gotPlayer){if(!(t.sleepTimer>0))return e=t.turns?e:V.Walk,t.dx=0,((t,e,i)=>{if(e.brl&&0===e.dx&&0===e.dy)return!1;let s=!1;return[1,16].forEach(n=>{let o,a=0;for(;a+=8;){const e=t.x+8+a*t.facing;if(o=e,W({x:e,y:t.y+n,height:14},i).any||e<0||e>232)break}s=s||!!H(e,[{x:t.x+8+(-1===t.facing?-a:0),y:t.y+n,height:14,width:a}])}),s})(t,i,s.platforms)?(t.gotPlayer=!0,i.facing=-t.facing,G(1,0,99,.7,1,1,.6,.7,.2),t.gotPlayer=!0):t.gotPlayer||(e===V.Turn&&(t.facing=-t.facing),t.walks&&e===V.Walk&&(t.dx=t.facing*t.speed,(t.blocked.left&&t.dx<0||t.blocked.right&&t.dx>0||t.blocked.bottom&&a)&&(t.facing=-t.facing)),t.sleeper&&0===t.sleepTimer&&(t.facing=j(o/20)?1:-1),r=t.walks&&e===V.Walk?"W":"I"),t.playAnimation("e"+r+(-1==t.facing?"L":"R")),n;t.playAnimation("sleepR")}},X=t=>{const e=(t=>{const e=P.split(" ")[t],[i,s]=e.split("!"),n={platforms:[],enemies:[],items:[]};for(let t=i.length-1;t>0;t-=2){let[e,s]=D(i.charCodeAt(t)),[o,a]=D(i.charCodeAt(t-1));e=15-o-e,n.platforms.push({x:16*a,y:16*e,w:16*s,h:16*o})}for(let t=3;t>0;t-=4){let[e,i]=D(s.charCodeAt(t-3)),[o,a]=D(s.charCodeAt(t-2)),[r,h]=D(s.charCodeAt(t-1)),[l,c]=D(s.charCodeAt(t));n.stars=[{x:a,y:o,t:l+1},{x:h,y:r,t:c+1}],n.player={x:16*i,y:16*e}}for(let t=s.length-1;t>3;t-=2){let[e,i]=D(s.charCodeAt(t-1));e++;let o=s.charCodeAt(t)-35;const a={};["isEnemy","facing","turns","walks","sleeper"].forEach(t=>{a[t]=!!(o%2),o=Math.floor(o/2)}),a.isEnemy?n.enemies.push(Object.assign({},a,{x:16*i,y:16*e,color:1+a.turns+(2*a.sleeper||4*a.walks),facing:a.facing?-1:1,data:o})):n.items.push({type:"berrel",x:i,y:e})}return n})(t),{spriteSheets:i,press:s,context:n,font:o,blip:a,pick:r,swish:h}=U();let l,c,f,g,u,p,m,y,A,b=99,x=0,E=[],w=0,O=1,k=!1;g=!1,u=!1,l=S({x:e.player.x,y:e.player.y,height:32,blocked:Object.assign({},N),standing:!0,facing:e.player.x>120?K.Left:K.Right,stabTimer:-1,gameOver:-1,animations:i[0].animations,brl:null}),c=S({height:32,animations:i[0].animations}),y=[],e.stars.forEach(t=>{const e=S({x:16*t.x,y:16*t.y,height:16,sleepTimer:5e3*t.t,animations:i[0].animations});y.push(e),e.playAnimation("starL")}),f=((t,e)=>{const i=[];return t.forEach(t=>{i.push(S(Object.assign({},t,{height:32,blocked:Object.assign({},N),speed:t.walks?(1+t.data)/4:0,animations:e[t.color].animations,sleepTimer:t.sleeper?t.walks?0:1e4*t.data:0})))}),i})(e.enemies,i),e.items.forEach(t=>{const e=S({x:16*t.x,y:16*t.y,height:32,animations:i[0].animations});E.push(e),e.playAnimation("brlL")});const C=t=>{const e=Math.ceil(t.sleepTimer/1e3-A);e<1&&(t.sleepTimer=0),t.sleepTimer>0&&!t.dead&&v(o,""+e,-(t.x+8),t.y-9,1)},I=t=>{let e=l.brl;E.push(e),e.x=l.x,e.y=l.y,e.dx=l.facing*t,e.dy=-2,l.brl=null},M=F(t,e);let R;const B=d({update:function(){R=b<290?V.Walk:b<310?V.AboutToTurn:310===b||350===b?V.Turn:V.Watch;const i={level:e,player:l,enemies:f,gameOver:u,tick:w,turnState:R},s=u;b+=350===b?-b:1,A=++w/60,m=j(w/20),l.stabTimer--,l.dy+=.2,l.dx=0;let n=g?"i":"d";if(l.y>400&&(u=!0),u){if(_(T.Action)&&k&&1===O)return O=2,B.stop(),void it(g?t:-1,x+1)}else l.standing||(l.standing=!0,l.y-=16,l.height=32),n="i",_(T.Left)&&(l.dx=-1,l.facing=K.Left,n="w"),_(T.Right)&&(l.dx=1,l.facing=K.Right,n="w"),p=p||!_(T.Jump),l.blocked.bottom&&(l.dy>0&&(l.dy=0),_(T.Duck)&&!l.brl?(n="d",l.standing=!1,l.y+=16,l.height=16,l.dx=0):_(T.Jump)&&p&&(G(1,0,200,.4,0,2,0,0,5),l.dy=-4.5,p=!1)),_(T.Stab)&&l.stabTimer<-7&&l.standing&&(h(),l.stabTimer=9,l.brl&&I(1)),l.dy<0&&l.blocked.top&&(l.dy=0),l.blocked.bottom||(n=l.dy>0?"jD":"jU");if(c.visible=!1,l.stabTimer>0){n="st",c.visible=!0,c.playAnimation("kn"+(-1===l.facing?"L":"R"));const t=H({height:16,x:l.x+16*l.facing,y:l.y},f);t&&(G(1,0,99,.4,0,1,7,15,0),t.dead=!0,t.dx=1.5*l.facing,t.dy=-2,t.playAnimation("de"+(1===l.facing?"L":"R")))}l.brl&&(n="brl"+("w"===n?"Pl":"")),l.playAnimation(n+(l.facing===K.Left?"L":"R")),l.advance(),W(l,e.platforms,24),c.x=l.x+16*l.facing,c.y=l.y,y.forEach((t,e)=>{H(l,[t])&&(r(),x++,y.splice(e,1))}),E.forEach((t,e)=>{!t.dx&&H(l,[t])&&(r(),l.brl=t,E.splice(e,1)),t.dx&&(t.dy+=.1,t.advance())});const o=H(l,f);o&&!l.brl&&(o.facing=o.x<l.x?K.Right:K.Left),g=!0,f.forEach(t=>{Q(t,i),t.advance(),t.dead||(g=!1,W(t,e.platforms),t.gotPlayer&&(u||(l.standing&&(l.y+=16,l.height=16),u=!0)))}),g&&(u=!0),u&&!s&&(l.brl&&I(-1),setTimeout(()=>{k=!0},1e3))},render:function(){n.drawImage(M,0,0),c.visible&&c.render(),l.render(),y.forEach((t,e)=>{C(t),t.render(),0==t.sleepTimer&&(a(),y.splice(e,1))}),f.forEach(t=>{t.gotPlayer&&v(o,"HEY/",-(t.x+8),t.y-9,1,2,2*w),C(t),t.turns&&R===V.AboutToTurn&&j(w)||t.render()}),E.forEach(t=>{t.render()}),u&&(y=[],v(o,g?["OK","GOOD","GREAT"][x]+" STABBING":"STAB OVER",-1,50,2),m&&k&&v(o,s,-1,70,1))}});B.start()},Z=t=>{const e=[];for(let i=0;i<3;i++)e[i]=11*parseInt(t.substr(i,1),16);return e},q=["fec","fea","ec9","fc8","b63","a86","731","210"],$=[["jU",2],["jD",0],["w",[1,0,2,0],4],["i",0],["d",5],["st",3],["kn",4],["de",11],["eI",12],["eW",[12,13],3],["star",6],["brlPl",[14,15],3],["brl",7],["sleep",[9,10],3]];var tt=(t,e)=>((t,e)=>{let i=[],s={};$.forEach(t=>{s[t[0]+"R"]={frames:t[1],frameRate:t[2],loop:t[3]},s[t[0]+"L"]=Object.assign({},s[t[0]+"R"],{flipped:!0})});let n=!1;return["9CF","F9F","0C0","60C","396","630","0CF"].forEach((o,a)=>{let r;r=a>0?Z(o):e;const h=document.createElement("canvas"),l=h.getContext("2d"),c=t;h.width=260,h.height=64,l.drawImage(c,0,0),l.drawImage(c,0,26,16,6,224,26,16,6),l.drawImage(c,112,5,16,27,224,0,16,27),l.drawImage(c,32,26,16,6,240,26,16,6),l.drawImage(c,112,5,16,27,240,1,16,27);let f=l.getImageData(0,0,260,64);const d=Z(q[Math.round(7*Math.random())]);for(let t=0;t<f.data.length;t+=4)0==f[t]||n||(n=!0),118===f.data[t]&&(f.data[t]=d[0],f.data[t+1]=d[1],f.data[t+2]=d[2]),148==f.data[t]&&(f.data[t]=r[0],f.data[t+1]=r[1],f.data[t+2]=r[2]);l.putImageData(f,0,0),i[a]=w({image:h,frameWidth:16,frameHeight:32,animations:s})}),i})(t,e);const et=t=>{localStorage.setItem("bkstb",JSON.stringify(t))},it=(t,e)=>{const{font:i,gfx:s,context:n,customColors:o,blip:a,swish:r}=U();let h,l=!1,c=0,f=!1;n.save();const g=localStorage.getItem("bkstb")?JSON.parse(localStorage.getItem("bkstb")):(()=>{const t=new Array(99).fill(-1);return et(t),t})();t>-1&&g[t]<e&&(g[t]=e,et(g));let u=tt(s,o);L({spriteSheets:u});const p=g.indexOf(-1);let m=p<20?p:0;const y=p,A=J(t=>{for(let e=0;e<20;e++){t.beginPath();const n=e%5,o=(e-n)/5;e>p&&1==t.globalAlpha&&(t.globalAlpha=.5);for(let i=0;i<g[e];i++){const n=e%5,o=(e-n)/5;t.drawImage(s,96,16,8,8,45*n+21+10*i,45*o+33,16,16)}t.rect(45*n+16,45*o+12,40,40),v(i,e+1,-(45*n+35),45*o+15,2,null,null,t),t.stroke()}t.globalAlpha=1,t.fillStyle="rgba(99,99,99,0.5)";for(let e=0;e<3;e++)t.beginPath(),t.rect(75*e+16,192,70,40),t.fill(),v(i,["TITLE","HELP","CUSTOM"][e],-(75*e+49),205,1,null,null,t),t.stroke()}),b=d({update:()=>{if(!h){if(l)return;const t=B();if(!(f=f||!_(T.Any))||!_(T.Any))return;f=!1;let e=m;if(_(T.Up)&&(m-=5),_(T.Duck)&&(m+=5),_(T.Left)&&m--,_(T.Right)&&m++,t[0]){const{x:e,y:i}=t[0];(m=Math.floor((e-16)/45)+5*Math.floor((i-12)/45))>19&&(m=e<88?20:e>160?22:21)}if(e!==(m=(m=m>22?22:m<0?0:m)<20&&m>y?e>m?y:20:m)&&r(),_(T.Action)){if(a(),l=!0,h=!0,m>19)return b.stop(),void(20===m?st():21===m?(()=>{const{font:t,press:e}=U();let i=0,s=0,n="THIS IS THE UNTOLD STORY OF THE\nBACKSTABBER HERO. ZE IS TAKING\nCARE OF THE WORLDS BACKSTABBING\nCHORES NEGLIGATED BY MOST\nPEOPLE LIVING CAREFREE LIVES.\nACTING AS A SHADOW NO ONE HAS\nSEEN HIRS FACE///",o=n.length;const a=d({render:()=>{v(t,"BACK     ",-1,16,2,5,i),v(t,"    STORY",-1,16,2),v(t,n.substring(0,s),4,40,1),s>o&&(v(t,"INSTRUCTIONS",-1,120,2),v(t,"USE ARROW KEYS TO MOVE JUMP\nAND DUCK. PRESS Z TO STAB.\nSTUDY YOUR ENEMIES TO TIME\nYOUR ATTACKS. AN IMMOBILE\nBARREL GOES UNNOTICED/".substring(0,s-o),4,144,1)),i>999&&j(i/9)&&v(t,e,-1,220,1)},update:()=>{s=++i/3,(_(T.Any)||U().touches[0])&&i>99&&(i=-1e9,a.stop(),st())}});a.start()})():(()=>{let{font:t,spriteSheets:e,context:i,customColors:s,gfx:n,press:o,mobile:a}=U();const r=[];let h=a||document.monetization&&"started"===document.monetization.state,l=0;i.fillStyle="#F00";let c=d({update:()=>{l++,i.closePath;let t=[...B()];if(0===t.length&&_(T.Any)&&(t[0]={x:0,y:121}),t[0]){let{x:i,y:o}=t[0];if(o>120&&l>99&&(l=-1e9,c.stop(),st()),h)for(let t=0;t<3;t++)for(let e=0;e<2;e++){let n=r[t]+(e>0?50:-12);i>n&&i<n+12&&o>60&&o<110&&(s[t]+=e>0?1:-1,s[t]=s[t]>255?255:s[t]<0?0:s[t])}e=tt(n,s),L({spriteSheets:e})}},render:()=>{v(t,"BACKSTABBER",-1,16,2),v(t,"CUSTOMIZATION",-1,32,2),j(l/9)&&l>99&&v(t,o,99,150,1),i.beginPath(),["RED","GREEN","BLUE"].forEach((e,n)=>{r[n]=13+90*n,i.rect(13+90*n,60,50,50),i.rect(1+90*n,84,8,2),i.rect(66+90*n,84,8,2),i.rect(66+90*n+3,81,2,8),v(t,e,-(36+90*n),69,1),v(t,Math.ceil(s[n]/255*99),-(36+90*n),82,2)}),i.stroke(),h||(i.beginPath(),i.rect(-9,70,265,11),i.fill(),v(t,"COIL SUBSCRIBERS ONLY",-1,72,1),i.stroke()),i.drawImage(e[0].image,48,0,32,32,0,120,120,120)}});c.start()})());setTimeout(()=>{n.stroke(),n.restore(),X(m),b.stop()},1e3)}}},render:()=>{h?v(i,"LEVEL "+(m+1),-1,50,3):(n.drawImage(A,0,0),n.beginPath(),n.strokeStyle="#fff",n.fillStyle="rgba(255,255,255,0.3)",j(++c/9)&&(m<20?n.rect(m%5*45+16,45*Math.floor(m/5)+12,40,40):n.rect(m%5*75+16,192,70,40)),n.fill(),n.stroke())}});b.start()},st=()=>{let t=0,e=100,i=0,s=-1,{context:n,spriteSheets:o,font:a,press:r,blip:h}=U();n.imageSmoothingEnabled=!1;let l=d({update:()=>{e>0?e--:i<100&&i++,_(T.Any)&&t>99?(h(),1==s&&(l.stop(),it(),s=2)):s=1},render:()=>{n.drawImage(o[0].image,48,0,32,32,0,120,120,120),v(a,"BACKSTABBER",-1,30,2,e,t++),n.globalAlpha=i/100,v(a,"HERO",-1,70-i/5,5.5),n.globalAlpha=.4*i/100,v(a,"HERO",-130,73-i/5,5),n.globalAlpha=1,100===i&&j(t/9)&&v(a,r,-1,100,1),v(a,"-2019 NIKLAS BERG",110,225)}});l.start()},nt=()=>{document.getElementById("c").style.setProperty("height",window.innerHeight+"px")},ot=()=>{let t=U().body.classList;t.add("m"),t.remove("p"),screen.width<screen.height&&t.add("p")};r(),(()=>{!function(){k={17:T.Stab,32:T.Space,37:T.Left,38:T.Up,39:T.Right,40:T.Duck,90:T.Stab,65:T.Left,87:T.Up,68:T.Right,83:T.Duck},window.addEventListener("keydown",I),window.addEventListener("keyup",M),window.addEventListener("blur",R),[{i:"l",k:37},{i:"r",k:39},{i:"l2",k:37},{i:"r2",k:39},{i:"j",k:32},{i:"s",k:90},{i:"d",k:40}].forEach(t=>{const e=document.getElementById(t.i),i={which:t.k};e.ontouchstart=()=>I(i),e.ontouchend=()=>M(i)});let t=a().canvas;const e=e=>{C=[];const i=256/t.offsetWidth;for(let s=0;s<e.touches.length;s++)C[s]={x:(e.touches[s].clientX-t.offsetLeft)*i,y:e.touches[s].clientY*i};O[T.Any]=C.length>0,O[T.Action]=C.length>0};t.ontouchstart=e,t.ontouchend=e;const i=t=>{e({touches:"mouseup"===t.type?[]:[t]})};t.onmousedown=i,t.onmouseup=i}();window.zzfx_x=new AudioContext;const t={},e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA",i=[e+"TgAAAAHAQMAAACm6sPlAAAABlBMVEVHcEz///7ok5LVAAAAAXRSTlMAQObYZgAAAOJJREFUGBkFgKFqw0AYgA8CNxPK5C9C5HSZGBHHFfokBz9ETVSOcaTPUbk3+dWnQmSZKGVqMkyNiOMobihhqzUy9STIJZePCWCswUnXxsNu6s8xunfG2Swhfk7rL8AswDruji68dOr7tFdVB4aZIf471X8AE7jmsbu4oO1T+zYlr+ooRilLFf+XagWWLKx1CMOXE237fmymNh5cxTADYUvXO+W+eSHXLKeLE21Dc25UtHEwzmYjwi2xYPMNYVhX+Tnu3Wt7Uq8q6h0lbNUiU14myPa5ZMnPIDXspTuco49RYngAcXeJFg24RkQAAAAASUVORK5CYII=",e+"OAAAAAgCAMAAAA8G4RnAAAAGFBMVEVHcEyUlAOGAQAAAAB2CFQ0NTQAAQD///9c2OnGAAAAAXRSTlMAQObYZgAABJhJREFUWMOlmQuW2yAMRYGHyf53PAYJ0A8nPsO06UCM0dUPQVNKqcyW3rXTvFfvg2npczf5gO7Jie41RzmhJHLyHQS2876N/wh4I6WvgPth9ZIDIBSBk+8IgvLb+FG1vV3QP5ZvE4RaibrWpEKgLpOT7wcQ9ZUbx+eB0PBdzkUj+VGrHKDfa0UKTar9w8t3AkGkuD5cx2Kfz1r/80AYuKixWPTtB4Jw0KGKVfQEVseHHwgXi3zczBOABWUIUGsNCJtoKeW7XesjX7ED1t7WQL1h7i4PMF/9bAG1SY3GndwHkOQsxcMZKOh/S2FARdjK/LnK1QJAY7ElLCowBZrA64E5lAKTGo17D4tBmrcU8d1tECo3G4txDCiHv0xzFqMefyiJVIwJQGNS0nhZGndyxyAtm3kKsLdWhEaGfgoBtlLa1T9a6S56KSMmaY8NuPtJQBsLeuBODNI4/XhePzDX0PMUIEH2v5KQH7vRBmBHjAGrcklvQfJSH6Qqx2yTgm3Rl3S8wQAlCrbUmicBGVIn7huLetOCD4DKYjMCq8qsogd2Sjg+dlHyqTKTKgMtueFAWtsQfRgtGcvSS6XKC8CE2oJRDPYMOf5gAsgkutYQb8/aWyDjiVXeB/LmHQZrKVDACL+8PbG0AghEcAgCyFCVIxOWvj+UHYPBNjEtdtjoaXFkVNV3Wl7Tx/ddSbkuARePUYDkW5RjPu9sMstnBPVxmyn0KgfArCyGvRRkmI/HFg8EIT8cAAJ1vg/zfVYBqYoogwTsRVaTCld+8/NGv1yABFC6hAReBNkBjoH9NYlSa+4qmTJ3nhwoYPyTd65sLEwFSbwIrd+sWrVJC7oYtECs67wY9gPLxMSDFAJzwJI5pv9OoBoooCIp38zw5b4671gLjuijrTDKokNWkBqxDHr3JzCzCpfVFvTAO5hYVMrxg8gpIEHuBQc3fDrPEd4DYBaJeEec6BPbDqIYMJ8AZyXSXbRW972OgtgLHwEpgz4B7uDGEkh0NyqlUUpn1mLQISmdTUgfKGDuBAsypf9YMNgHOf63C4L6e9uepuNaUicVDipZFeQsN04LZBQgp9C01xacMXg+LvXoEAJRX3jsXHRaMI8H9rZpTGjOXwZIKMAqRdcTx5upQxYtx31Qe7/u+x2WMiDyPmqA89TphmMD4XDlEZ3Cj4SnS7cz4CpVlMaRrY/ulFB1TjFXGLYSCo+cwZ0OgAZVif4CqDd6H4MyC4jCSwfhKP0AdUTT55nolup0C3IAbBPy3XWqLdVMFhVEurjeOYesiQzEtXb2uSH0wGTvpbxGBuVLQF3JRIBcXOqQ1/uASnABoK2DI4DkvFZcV8xua2/5frCgE9n0oXNEgotJIOevFtSAakJbnon3gF9q0b2eOf9YJxyH402k+OZneLWf11lH3Rwu7XIA8mHx/xZ0WXRVW1Jo04eIMl+YccVzMODc8jZShiLsv7UUOceP/2fTvgHardpt3cok9uywbib241x5yX2EpWdku+1AXK69JGz7YrSF96L+qhmHjSq8xpYFmTCaraXVO/BM+Hab+L4PHnYpkybijKjB0x/gLyth3ZF8gQAAAABJRU5ErkJggg=="];["font","gfx"].forEach((e,s)=>{t[e]=new Image,t[e].src=i[s]}),t.gfx.onload=()=>{let e=[153,204,255],i=tt(t.gfx,e);const s=Object.assign({},t,{spriteSheets:i,touches:{},keys:{},customColors:e,blip:()=>G(1,.1,648,.3,.5,0,0,7,.7),pick:()=>G(1,0,70,.2,.6,5,.1,8,.9),swish:()=>G(1,0,657,.1,.5,.2,3,3,.6)});L(s),U().mobile&&(window.onorientationchange=ot,window.onresize=nt,ot()),st()}})()}]);</script></body>