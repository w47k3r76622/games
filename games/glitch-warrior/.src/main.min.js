function randInt(e,t){return floor(rand()*(t-e+1))+e}function updateHero(){}function drawBackground(){ctx.fillStyle="#2B2B2B",ctx.fillRect(0,0,canvas.width,canvas.height)}function drawHero(){ctx.fillStyle="rgb(0,0,0)",ctx.fillRect(hero.x,hero.y,hero.w,hero.h)}function createEnemy(e){return{x:randInt(20,canvas.width-20),y:rand()>.5?20:canvas.height-40,w:20,h:20,color:["#AA3846","#E88E4F","#E3A922"][randInt(0,2)],index:enemies.length,speed:e}}function updateEnemy(e){e&&(e.x>hero.x?e.x-=.75*e.speed:e.x<hero.x&&(e.x+=.75*e.speed),e.y>hero.y?e.y-=e.speed:e.y<hero.y&&(e.y+=e.speed))}function drawEnemy(e){e&&(ctx.globalAlpha=.8,ctx.fillStyle=e.color,ctx.fillRect(e.x,e.y,e.w,e.h),ctx.globalAlpha=1)}function createProjectile(e,t){var n={x:e-2,y:t-2},c=canvas.width/2-2,o=canvas.height/2-2,a=c-n.x,r=o-n.y,i=Math.atan2(r,a),l=2,h=l*Math.cos(i),d=l*Math.sin(i);projectiles.push({x:c,y:o,w:4,h:4,xv:h,yv:d,index:projectiles.length})}function updateProjectile(e){e&&(e.x-=e.xv,e.y-=e.yv,e.x<-4||e.x>canvas.width?projectiles[e.index]=null:(e.y<-4||e.y>canvas.height)&&(projectiles[e.index]=null))}function drawProjectile(e){e&&(ctx.globalAlpha=.8,ctx.fillStyle="#9999aa",ctx.fillRect(e.x,e.y,e.w,e.h),ctx.globalAlpha=1)}function update(){updateHero(),enemies.forEach(updateEnemy),projectiles.forEach(updateProjectile),enemies.forEach(checkForHeroHit),enemies.forEach(checkForProjectileHit)}function colliding(e,t){return e.x<t.x+t.w&&e.x+e.w>t.x&&e.y<t.y+t.h&&e.h+e.y>t.y}function checkForHeroHit(e){e&&colliding(e,hero)&&lose()}function checkForProjectileHit(e){if(e){var t=!1;projectiles.forEach(function(n){n&&!t&&colliding(e,n)&&(t=!0,projectiles[n.index]=null,enemies[e.index]=null,incrementScore())})}}function draw(){ctx.clearRect(0,0,canvas.width,canvas.height),gameActive?(drawBackground(),drawHero(),enemies.forEach(drawEnemy),projectiles.forEach(drawProjectile)):(ctx.fillStyle="#2B2B2B",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="rgb(250, 250, 250)",ctx.font="24px Helvetica",ctx.textAlign="left",ctx.textBaseline="top",ctx.fillText("GOOD WORK!",32,32),ctx.font="14px Helvetica",ctx.textAlign="left",ctx.textBaseline="top",ctx.fillText("You stopped "+score+" glitches!",32,75))}function incrementScore(){score++,scoreValueEl.innerText=score}function startNewGame(){roundCount=0,enemies=[],projectiles=[],gameActive=!0,score=0,scoreValueEl.innerText="0",hero.x=canvas.width/2-10,hero.y=canvas.height/2-10}function loop(){var e=Date.now(),t=e-then;update(t/1e3),draw(),then=e,requestAnimationFrame(loop)}function lose(){gameActive=!1}var canvas=document.getElementById("c"),ctx=canvas.getContext("2d"),newGameEl=document.getElementById("new"),scoreValueEl=document.getElementById("score-value"),score,gameActive,roundCount,rand=Math.random,floor=Math.floor,ceil=Math.ceil,min=Math.min,max=Math.max,hero={x:0,y:0,w:20,h:20},enemies=[],projectiles=[];newGameEl.addEventListener("click",startNewGame),canvas.addEventListener("click",function(e){gameActive&&createProjectile(e.offsetX,e.offsetY),e.preventDefault()}),setInterval(function(){if(gameActive){var e,t;e=roundCount>2?floor(roundCount/2):3,t=roundCount>15?2:roundCount>10?1.5:roundCount>5?1:roundCount>2?.75:.5;for(var n=0;n<e;n++)enemies.push(createEnemy(t));roundCount++}},2e3);var then=Date.now();startNewGame(),loop();