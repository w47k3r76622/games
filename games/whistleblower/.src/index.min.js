!function t(e,i,n){function o(r,s){if(!i[r]){if(!e[r]){var h="function"==typeof require&&require;if(!s&&h)return h(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+r+"'")}var c=i[r]={exports:{}};e[r][0].call(c.exports,function(t){var i=e[r][1][t];return o(i?i:t)},c,c.exports,t,e,i,n)}return i[r].exports}for(var a="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(t){function e(t){return!t.alive&&!t.enemy}function i(t){return Math.sin((t-1)*Math.PI/2)+1}function n(t){return 1==t?t:1-Math.pow(2,-10*t)}function o(t,o,a,r){function c(){var t=P.filter(e).slice(0,1);steps=360;for(var i=0;steps>=i;i++){var n=i/(steps-1),r=steps/(2*C)*Math.PI/180,s=Math.max(r,n*m-r),h=~~(n*q.length)%q.length,c=q[h]/E[h];if(c>S)for(var l=0;l<t.length;l++)t[l].reset(o,a),t[l].shoot(0===h?r:s,o,a)}}function g(e,i,n,o,a,r,s){t.beginPath();for(var h=0;n>=h;h++){var c=h/(n-1),l=c*m+(r||0),f=~~(c*q.length)%q.length,d=q[f]/E[f],u=s?(o+5*q[0])*s.vizSize:Math.min(3*o,o+75*d),p=Math.cos(l)*u+e,y=Math.sin(l)*u+i;t.lineTo(p,y)}a?(t.lineTo(e,i),t.fill()):t.stroke()}function v(t){for(var e=P.length-1;e>=0;e--){var i=P[e],n=i.position[0],o=i.position[1];i.enemy&&!i.attacking||!i.alive&&!i.enemy||(t.fillStyle=e>y?"#be3131":"#fff",g(n,o,i.sides,w*i.size,i.fill,i.angle,i))}}F+=r;var x=t.createLinearGradient(o,0,o,a);x.addColorStop(0,"#e47431"),x.addColorStop(1,"#e88832"),t.fillStyle=x,t.fillRect(0,0,o,a);var _=~~(o/2),z=~~(a/2),R=1e3;if(d){t.fillStyle=t.strokeStyle="#fff",t.globalAlpha=1;var k=25,T=4;endless||(t.fillRect(k+5,a-k-T,100*M,T),t.fillRect(k,~~(a-k-1.5*T),2,8),t.fillRect(k+108,~~(a-k-1.5*T),2,8)),M=f?0:Math.max(0,Math.min(1,M+5e-4));for(var L=u.subarray(50,80),C=16,q=new Float32Array(C),E=new Float32Array(C),D=0;D<L.length;D++){var j=~~(D/L.length*C),W=i(L[D]/256);q[j]+=W,E[j]++}t.lineWidth=1;var H=f?1:R>F?n(F/R):1;if(s(r,o,a),v(t,o,a),t.fillStyle="#fff",t.globalAlpha=.2,g(_,z,360,(p+4)*H,!0),t.globalAlpha=1,g(_,z,360,p*H,!0),c(),!endless&&(.01>M||f)){if(!f){F=0,A.innerHTML="you died<br><font>click to replay</font>";var G=h();A.style.display="block",A.style.opacity="0.0",setTimeout(function(){A.style.opacity="1.0",setTimeout(function(){G&&(G.style.opacity="1.0")},700)},1e3)}f=!0,t.fillStyle="#e47431",R=l?b:2e3;var B=Math.min(1,R>F?n(F/R):1);l&&(B=1-Math.min(1,F/R)),t.globalAlpha=.75*B,t.fillRect(0,0,o,a)}}}function a(){return[2*Math.random()-1,2*Math.random()-1]}function r(t,e,i){this.enemy=i,this.reset(t,e),this.attacking=!1}function s(t,e,i){for(var o=e/2,a=i/2,r=0;r<P.length;r++){var s=.02,h=P[r],c=h.velocity,l=h.position,f=l[0]-o,d=l[1]-a,u=h.enemy,m=u?.15:1;if(acc=h.accel,nL=Math.sqrt(f*f+d*d),circX=o-l[0],circY=a-l[1],inside=Math.sqrt(circX*circX+circY*circY)<=p,r>y&&y+x>r&&(h.attacking=!0),!h.enemy||h.attacking){h.killing&&(h.killTime+=t,h.vizSize=1-(h.killTime>_?1:n(h.killTime/_)),h.killTime>_&&h.reset(e,i));for(var g=0;g<P.length;g++){var v=P[g],b=v.position,z=w*v.size,R=b[0]-l[0],k=b[1]-l[1],T=Math.sqrt(R*R+k*k),A=T<=w*h.size+z;!h.killing&&A&&r!==g&&h.enemy&&!v.enemy&&v.alive&&(h.killing=!0,h.killTime=0)}f/=nL?nL:1,d/=nL?nL:1,c[0]+=acc[0],c[1]+=acc[1],acc[0]*=.98,acc[1]*=.98,h.angle+=(f+d)*s/4*h.rot,h.enemy&&(c[0]-=f*s,c[1]-=d*s),l[0]+=c[0]*m*t*.03,l[1]+=c[1]*m*t*.03,l[0]<0||l[0]>e||l[1]<0||l[1]>i?h.enemy?h.reset(e,i):h.alive=!1:inside&&h.enemy&&!h.killing&&(h.attacking&&(M-=.05*h.size),h.reset(e,i))}}}function h(){var t=A.getElementsByTagName("font")[0];return t.style.cssText="font-weight: 500; font-size: 18px; opacity: 0.0;"+z,t}function c(t,e,i){t.canvas.style.border="15px solid #fff",t.canvas.style.boxSizing="border-box",window.addEventListener("click",function(){f&&!l&&(l=!0,F=0,A.style.opacity="0.0",setTimeout(function(){f=!1,M=1,F=0,x=v,l=!1,P.forEach(function(t){t.reset(e,i),t.attacking=!1,t.alive=!1}),A.style.display="none"},b))});for(var n=y+g;n-->=0;)P[n]=new r(e,i,n>y),P[n].alive=!1;A.innerHTML=L?"please allow microphone<br><font>whistle to shoot</font>":"requires Web Audio API<br><font>works best in Chrome</font>",A.style.cssText="position:fixed; opacity: 0.0; top:50%; width:100%; text-align:center; -webkit-font-smoothing: antialiased; font: 20px 'Source Sans Pro', sans-serif; color: white; line-height: 25px; font-weight: 700;"+z;var o=h();setTimeout(function(){d||(A.style.opacity="1.0",o&&(o.style.opacity="0.0")),setTimeout(function(){o&&(o.style.opacity="1.0")},700)},1e3),document.body.appendChild(A),setInterval(function(){x++},3e3)}"undefined"==typeof window.endless&&(window.endless=!1),WebFontConfig={google:{families:["Source+Sans+Pro:300,400,700:latin"]}},function(){var t=document.createElement("script");t.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",t.type="text/javascript",t.async="true";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}(),t("canvas-testbed")(o,c,{});var l,f,d,u,m=2*Math.PI,p=25,y=60,g=20,v=2,w=8,b=1e3,x=v,M=1,_=1e3,z="-moz-transition: opacity 1.0s;  -webkit-transition: opacity 1.0s;",R=window.webkitAudioContext||window.AudioContext||window.mozAudioContext,k=R&&new R,T=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,A=document.createElement("span"),F=0,S=.25,P=[],L=R&&T;T&&T.call(navigator,{audio:!0,video:!1},function(t){A.style.opacity="0.0",setTimeout(function(){d=k.createAnalyser(),d.fftSize=2048;var e=k.createMediaStreamSource(t);u=new Uint8Array(d.frequencyBinCount);var i=k.createScriptProcessor(1024,1,1);d.connect(i),i.onaudioprocess=window.audioProcess=function(){d.getByteFrequencyData(u)},e.connect(d),i.connect(k.destination),A.style.display="none"},1e3)},T);var C=r.prototype;C.reset=function(t,e){var i=Math.random()*m,n=this.enemy,o=t/2,r=e/2;return n&&(o+=Math.cos(i)*Math.max(4*p,Math.random()*t/2),r+=Math.sin(i)*Math.max(4*p,Math.random()*t/2)),this.angle=0,this.sides=this.enemy?6:~~(2*Math.random())+4,this.fill=this.enemy||Math.random()>.5,this.rot=Math.random(),this.position=[o,r],this.velocity=a(),this.accel=[0,0],this.size=this.enemy?2*Math.random():Math.random(),this.vizSize=1,this.killTime=0,this.killing=!1,this.alive=!1,this},C.shoot=function(t,e,i){var n=2*Math.random()-1,o=2*Math.random()-1,a=.3,r=Math.cos(t+n*a),s=Math.sin(t+o*a),h=.15*Math.random();this.velocity=[r,s],this.accel=[r*h,s*h],this.position=[e/2+r*p,i/2+s*p],this.alive=!0}},{"canvas-testbed":2}],2:[function(t,e){var i=t("domready");t("raf.js");var n=t("canvas-app");e.exports=function(t,e,o){i(function(){"object"==typeof t&&t?(o=t,t=null,e=null):"object"==typeof e&&e&&(o=e,e=null),o=o||{},"function"!=typeof o.onReady&&(o.onReady=e);var i=n(t,o);i.canvas.setAttribute("id","canvas"),document.body.appendChild(i.canvas),document.body.style.margin="0",document.body.style.overflow="hidden",i.start()})}},{"canvas-app":3,domready:5,"raf.js":6}],3:[function(t,e){function i(t,e){if(!(this instanceof i))return new i(t,e);"object"==typeof t&&t&&(e=t,t=null),t="function"==typeof t?t:e.onRender,e=e||{},e.retina="boolean"==typeof e.retina?e.retina:!0;var o="number"==typeof e.width,a="number"==typeof e.height;(o||a)&&(e.ignoreResize=!0),e.width=o?e.width:window.innerWidth,e.height=a?e.height:window.innerHeight;var r=e.retina?window.devicePixelRatio||1:1,s=e.canvas||document.createElement("canvas");s.width=e.width*r,s.height=e.height*r,e.retina&&(s.style.width=e.width+"px",s.style.height=e.height+"px");var h,c=e.contextAttributes||{};if(this.isWebGL=!1,"webgl"===e.context||"experimental-webgl"===e.context){if(h=n({canvas:s,attributes:c}),!h)throw"WebGL Context Not Supported -- try enabling it or using a different browser";this.isWebGL=!0}else h=s.getContext(e.context||"2d",c);this.running=!1,this.width=e.width,this.height=e.height,this.canvas=s,this.context=h,this.onResize=e.onResize,this._DPR=r,this._retina=e.retina,this._once=e.once,this._ignoreResize=e.ignoreResize,this._lastFrame=null,this._then=Date.now(),this.fps=60,this._frames=0,this._prevTime=this._then,this._ignoreResize||(window.addEventListener("resize",function(){this.resize(window.innerWidth,window.innerHeight)}.bind(this)),window.addEventListener("orientationchange",function(){this.resize(window.innerWidth,window.innerHeight)}.bind(this))),this.onRender="function"==typeof t?t.bind(this):function(){},this.renderOnce=function(){var t=Date.now(),e=t-this._then;this._frames++,t>this._prevTime+1e3&&(this.fps=Math.round(1e3*this._frames/(t-this._prevTime)),this._prevTime=t,this._frames=0),this.isWebGL||(this.context.save(),this.context.scale(this._DPR,this._DPR)),this.onRender(this.context,this.width,this.height,e),this.isWebGL||this.context.restore(),this._then=t},this._renderHandler=function(){this.running&&(this._once||(this._lastFrame=requestAnimationFrame(this._renderHandler)),this.renderOnce())}.bind(this),"function"==typeof e.onReady&&e.onReady.call(this,h,this.width,this.height)}var n=t("webgl-context");Object.defineProperty(i.prototype,"retinaEnabled",{set:function(t){this._retina=t,this._DPR=this._retina?window.devicePixelRatio||1:1,this.resize(this.width,this.height)},get:function(){return this._retina}}),i.prototype.resetFPS=function(){this._frames=0,this._prevTime=Date.now(),this._then=this._prevTime,this.fps=60},i.prototype.start=function(){this.running||(this._lastFrame&&cancelAnimationFrame(this._lastFrame),this.resetFPS(),this.running=!0,this._lastFrame=requestAnimationFrame(this._renderHandler))},i.prototype.stop=function(){this._lastFrame&&(cancelAnimationFrame(this._lastFrame),this._lastFrame=null),this.running=!1},i.prototype.resize=function(t,e){var i=this.canvas;this.width=t,this.height=e,i.width=this.width*this._DPR,i.height=this.height*this._DPR,this._retina&&(i.style.width=this.width+"px",i.style.height=this.height+"px"),this._once&&requestAnimationFrame(this._renderHandler),"function"==typeof this.onResize&&this.onResize(this.width,this.height)},e.exports=i},{"webgl-context":4}],4:[function(t,e){e.exports=function(t){t=t||{};var e=t.canvas||document.createElement("canvas");"number"==typeof t.width&&(e.width=t.width),"number"==typeof t.height&&(e.height=t.height);var i=t.attributes||t.attribs||{};try{gl=e.getContext("webgl",i)||e.getContext("experimental-webgl",i)}catch(n){gl=null}return gl}},{}],5:[function(t,e){!function(t,i){"undefined"!=typeof e?e.exports=i():"function"==typeof define&&"object"==typeof define.amd?define(i):this[t]=i()}("domready",function(){var t,e=[],i=document,n="DOMContentLoaded",o=/^loaded|^c/.test(i.readyState);return o||i.addEventListener(n,t=function(){for(i.removeEventListener(n,t),o=1;t=e.shift();)t()}),function(t){o?t():e.push(t)}})},{}],6:[function(){!function(t){for(var e=0,i=["webkit","moz"],n=t.requestAnimationFrame,o=t.cancelAnimationFrame,a=i.length;--a>=0&&!n;)n=t[i[a]+"RequestAnimationFrame"],o=t[i[a]+"CancelAnimationFrame"];n&&o||(n=function(t){var i=+new Date,n=Math.max(e+16,i);return setTimeout(function(){t(e=n)},n-i)},o=clearTimeout),t.requestAnimationFrame=n,t.cancelAnimationFrame=o}(window)},{}]},{},[1]);