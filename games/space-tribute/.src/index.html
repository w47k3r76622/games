<!DOCTYPE html>
<html>
	<head>
		<title>Space Tribute</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<script src="jsfxr.js"></script>
		<style type="text/css">
			html, body {
				height:100%;
			}
			body {
				background-color:#000;
				margin:0;
			}
			canvas {
				max-width:100%;
				max-height:100%;
				margin:0 auto;
				display:block;
			}
			</style>
		<script>function playMusic(){gainNode.gain.value=1,snd=!0}function stopMusic(){gainNode.gain.value=0,snd=!1}var g,rad=[],bonusList=[],imgs=[];bonusList[1]={letter:"X",name:"explosion"},bonusList[2]={letter:"P",name:"armor"},bonusList[3]={letter:"T",name:"armor"},EXPLOSION=function(a,b,c,d,e){this.x=a,this.y=b,this.color=c,this.size=d,this.opacity=1,this.pixels=[],this.gravity=e?e:0;for(var a=0;a<34;a+=3)for(var b=0;b<24;b+=3){var f={};f.x=this.x+a,f.y=this.y+b,f.tx=(a-17)*(Math.random()-.5),f.ty=(b-10)*(Math.random()-.5),f.r=Math.floor(256*Math.random()),f.g=Math.floor(256*Math.random()),f.b=Math.floor(256*Math.random()),this.pixels.push(f)}this.update=function(){if(this.opacity-=.01,this.opacity<=0)return!1;ctx.fillStyle="rgba("+this.color[0]+","+this.color[1]+","+this.color[2]+","+this.opacity+")";for(var a=0;a<this.pixels.length;a++){var b=this.pixels[a];ctx.fillStyle="rgba("+Math.floor(255-255*(1-this.opacity))+","+Math.floor(255-255*(1-this.opacity))+",255,"+this.opacity+")",b.ty+=this.gravity,b.x+=b.tx,b.y+=b.ty,ctx.fillRect(b.x,b.y,2*this.size,2*this.size)}return!0}},WEAPON_LASERPLAYER=function(){this.width=20,this.height=4,this.speed=40,this.fromPlayer=!0,this.draw=function(){ctx.beginPath(),ctx.lineWidth=4,ctx.moveTo(this.x,this.y),ctx.lineTo(this.x+Math.sin(this.angle)*this.width,this.y-Math.cos(this.angle)*this.width),ctx.strokeStyle="#00F",ctx.stroke()},WEAPON.apply(this,arguments)},WEAPON_FIREBALLPLAYER=function(){this.width=20,this.height=4,this.speed=40,this.fromPlayer=!0,this.draw=function(){ctx.beginPath(),ctx.arc(this.x+20,this.y,5,0,2*Math.PI,!1),ctx.fillStyle="#ED5615",ctx.fill()},WEAPON.apply(this,arguments)},WEAPON_LASER=function(){this.width=20,this.height=4,this.speed=10,this.aimToPlayer=!0,this.draw=function(){ctx.fillStyle="#F00",ctx.beginPath(),ctx.lineWidth=4,ctx.moveTo(this.x,this.y),ctx.lineTo(this.x+Math.sin(this.angle)*this.width,this.y-Math.cos(this.angle)*this.width),ctx.strokeStyle="#F00",ctx.stroke()},WEAPON.apply(this,arguments)},WEAPON_FIREBALL=function(){this.width=5,this.height=5,this.speed=15,this.aimToPlayer=!0,this.draw=function(){ctx.beginPath(),ctx.arc(this.x+20,this.y,5,0,2*Math.PI,!1),ctx.fillStyle="#EB1DEB",ctx.fill()},WEAPON.apply(this,arguments)},WEAPON_NUNCHUNK=function(){this.width=20,this.height=4,this.speed=15,this.aimToPlayer=!1,this.round=0,this.draw=function(){this.round-=.1,ctx.fillStyle="#FFF",ctx.beginPath(),ctx.lineWidth=4,ctx.moveTo(this.x+Math.sin(this.round)*-this.width,this.y-Math.cos(this.round)*-this.width),ctx.lineTo(this.x+Math.sin(this.round)*this.width,this.y-Math.cos(this.round)*this.width),ctx.strokeStyle="#FFF",ctx.stroke(),ctx.beginPath(),ctx.arc(this.x+Math.sin(this.round)*-this.width,this.y-Math.cos(this.round)*-this.width,5,0,2*Math.PI,!1),ctx.fillStyle="#EEE",ctx.fill(),ctx.beginPath(),ctx.arc(this.x+Math.sin(this.round)*this.width,this.y-Math.cos(this.round)*this.width,5,0,2*Math.PI,!1),ctx.fillStyle="#EEE",ctx.fill()},WEAPON.apply(this,arguments)},WEAPON_HARPOON=function(){this.width=20,this.height=10,this.speed=30,this.aimToPlayer=!0,this.draw=function(){this.round-=.1,ctx.fillStyle="#FFF",ctx.beginPath(),ctx.lineWidth=10,ctx.moveTo(this.x,this.y),ctx.lineTo(this.x+Math.sin(this.angle)*this.width,this.y-Math.cos(this.angle)*this.width),ctx.strokeStyle="#FFF",ctx.stroke()},WEAPON.apply(this,arguments)},WEAPON_BOSS=function(){this.width=20,this.height=4,this.speed=20,this.aimToPlayer=!1,this.homing=!0,this.draw=function(){ctx.fillStyle="#FF4F00",ctx.beginPath(),ctx.lineWidth=12,ctx.moveTo(this.x,this.y),ctx.lineTo(this.x+Math.sin(this.angle)*this.width,this.y-Math.cos(this.angle)*this.width),ctx.strokeStyle="#FF4F00",ctx.stroke()},WEAPON.apply(this,arguments)},WEAPON=function(a,b,c,d){this.x=a,this.y=b,this.type=d,this.angle=c,this.update=function(){if(this.homing){var a=bearing(GAME.player.x+50,GAME.player.y+30,this.x,this.y);this.angle>a?this.angle-a>.03&&(a=this.angle-.02):this.angle<a&&a-this.angle>.02&&(a=this.angle+.02),this.angle=a}if(this.x+=Math.sin(this.angle)*this.speed*GAME.speed,this.y-=Math.cos(this.angle)*this.speed*GAME.speed,this.x<-50)return!1;if(this.x>2e3)return!1;if(this.fromPlayer)for(var b=0;b<GAME.monsters.length;b++){var c=GAME.monsters[b];if(this.x>c.x&&this.x<c.x+c.trueWidth&&this.y>c.y&&this.y<c.y+c.trueHeight)return c.life--,c.life<=0?c.explode():(sound([3,,.1379,.4076,.35,.1342,,-.3958,,,,,,,,,.535,-.2877,1,,,,,.5]),GAME.addExplosion(c.x+50*Math.random(),c.y+70*Math.random(),[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],1)),!1}else if(GAME.player.armor){if(Math.hypot(this.x-(GAME.player.x+50),this.y-(GAME.player.y+30))<100)return sound([0,,.0967,.4264,.2902,.458,,-.3199,,,,.5693,.6278,,,,,,1,,,,,.5]),GAME.player.touch=10,GAME.player.armor-=20,!1}else if(this.x>GAME.player.x&&this.x<GAME.player.x+100&&this.y>GAME.player.y&&this.y<GAME.player.y+60)return GAME.player.life-=10,sound([3,,.2436,.5091,.252,.0334,,.2411,,,,,,,,,,,1,,,,,.5]),!1;return this.draw(),!0},this.init=function(){this.aimToPlayer&&(this.angle=bearing(GAME.player.x+50,GAME.player.y+30,this.x,this.y)),this.angle||(this.fromPlayer?this.angle=Math.PI/2:this.angle=-Math.PI/2)},this.init()},bearing=function(a,b,c,d){return Math.atan2(a-c,d-b)},monsters=[],monsters[1]={colors:[,"#EDED2D"],sprite:"11:011000001100001000100000111111100011011101101111111111111111111111011111111100101000101010011011001",factor:8,weapon:"FIREBALL",reloadingTime:80},monsters[2]={colors:[,"#EB1DEB"],sprite:"9:000111000001111100011111110011010110111111111111111111011111110001000100010000010001000100",factor:8,weapon:"FIREBALL",reloadingTime:80},monsters[3]={colors:[,"#30EDED"],sprite:"12:000011110000001111111100011111111110111001100111111111111111011111111110001111111100000110011000001001100100000100001000",factor:8,weapon:"FIREBALL",reloadingTime:80},monsters[4]={colors:[,"#FFF"],sprite:"20:0011000000000000110001100000000000000110011000000000000001101100000000000000001111000000000000000011110000011111100000111100001101101100001111000110011001100011111001001001001001111111110100001011111111111101000010111111111001001001001001111100011001100110001111000011011011000011110000011111100000111100000000000000001111000000000000000011011000000000000001100110000000000000011000110000000000001100",factor:3,weapon:"LASER",reloadingTime:80},monsters[5]={colors:[,"#FFA000"],sprite:"14:000001111000000001111111100000111111111100011111001111101111100001111011110000001110111101100011111111011000111111111000011111111111001111111111111111111111111111111111111111111111111101110011101110001100110001",factor:4,weapon:"LASER",reloadingTime:80},monsters[6]={colors:[,"#FF0"],sprite:"12:000111110000011111111100111111111110111111111110001111111111000001111111001111111111111111111110111111111110011111111100000111110000",factor:4,weapon:"NUNCHUNK",reloadingTime:80},monsters[7]={colors:[,"#0FF"],sprite:"4:1111",factor:30,weapon:"HARPOON",reloadingTime:80},monsters[8]={colors:[,"#FF0"],sprite:"2:1111",factor:30,weapon:"FIREBALL",reloadingTime:80},monsters[9]={colors:[,"#A0F"],sprite:"3:111010",factor:30,weapon:"FIREBALL",reloadingTime:80},monsters[10]={colors:[,"#FFA500"],sprite:"2:010111",factor:30,weapon:"FIREBALL",reloadingTime:80},monsters[11]={colors:[,"#F00"],sprite:"3:110011",factor:30,weapon:"FIREBALL",reloadingTime:80},monsters[12]={colors:[,"#444","#fac81b","#F00"],sprite:"30:000000001111100000000000000000000000112222211000000000000000000001222222222101100000000000000001222222222212100000000000000012211222222222100000000000000012211222222221000000000000333012211222222210000000000000333332222222222210000000000000033333222222222210000000000000033333322222222210000000000000033001222222222100000000000000000000122222222100000000000000000000012222221000000000000011000000012222222111000000000121000001122222222222110000001221000012222222222222221111112221000012222221112222222222222210000122222112221112212222222210000122221222222211121222222100000122221222222222221222222100000122221222222222221222221000000122221222222222212222221000000012222122222222122222210000000012222122222221222222100000000001122211111112222211000000000000011222222222211100000000000000000111111111100000000000",factor:2,weapon:"FIREBALL",reloadingTime:80},monsters[13]={colors:[,"#c84c0c","#444","#F4d4b4"],sprite:"16:00000011110000000000011111100000000011111111000000011111111110000011211111221100011132111231111001113222223111101111323132311111111133313331111111111111111111110111133333311110011113233331111000003322223330000022232332233000022222333333220002222220002222200022222000222200",factor:4,weapon:"FIREBALL",reloadingTime:80},monsters[14]={colors:[,"#FF0","#4040E0","#F0D0D0","#00B0B0"],sprite:"9:000111000011111110121212121000020000000020000000234440000034344000034330000022200000022230000022203003222000003222000000022000000003300",factor:4,weapon:"FIREBALL",reloadingTime:80},monsters[15]={colors:[,"#2c2b2c","#ea9783","#FFF"],sprite:"15:001110000000000012221000000000122222100000000132332210000000113132210000000113132210000000133322100000000012222100000000001122211100000012222222211110012222222222221001222221111221000111110000110",factor:4,weapon:"FIREBALL",reloadingTime:8},monsters[16]={weapon:"BOSS",reloadingTime:80,life:40},drawSpriteToImg=function(a){var b=monsters[a],d=b.sprite.split(":"),e=d[0],f=d[1],g=f.length/e,h=e*b.factor,i=g*b.factor,j=0,k=document.createElement("canvas");k.width=h,k.height=i;var l=k.getContext("2d");for(y=0;y<f.length/e;y++)for(x=0;x<e;x++)c=b.colors[f[j]],j++,l.fillStyle=c,c&&l.fillRect(x*b.factor,y*b.factor,b.factor,b.factor);imgs[a]=new Image,imgs[a].src=k.toDataURL("image/png")},PATH1={init:function(a){a.round=-Math.PI,a.tx=16==a.type?-2:Math.random()*-8-1},update:function(a){a.round+=.01*GAME.speed,a.x+=a.tx*GAME.speed,a.y+=Math.sin(a.round)*GAME.speed}},PATH2={init:function(a){a.round=-Math.PI},update:function(a){a.round+=.01,a.speed=2,a.x+=Math.cos(a.round)*a.speed*GAME.speed,a.y+=Math.sin(a.round)*a.speed*GAME.speed,a.x-=1*GAME.speed}},PATH3={init:function(a){a.round=-Math.PI,a.animStarted=!1,a.speed=2},update:function(a){a.x<800&&(a.animStarted=!0),a.animStarted?(a.speed=8,a.round+=a.speed/200*GAME.speed,a.round>=1*Math.PI&&(a.round=1*Math.PI),a.x+=Math.cos(a.round)*a.speed*GAME.speed,a.y+=Math.sin(a.round)*a.speed*GAME.speed,a.x-=1*GAME.speed):(a.speed=8,a.x-=a.speed*GAME.speed)}},PATH4={init:function(a){a.round=Math.PI,a.animStarted=!1,a.speed=2},update:function(a){a.x<800&&(a.animStarted=!0),a.animStarted?(a.speed=8,a.round-=a.speed/200*GAME.speed,a.round<=-Math.PI&&(a.round=-Math.PI),a.x+=Math.cos(a.round)*a.speed*GAME.speed,a.y+=Math.sin(a.round)*a.speed*GAME.speed,a.x-=1*GAME.speed):(a.speed=8,a.x-=a.speed*GAME.speed)}},PATH5={init:function(a){a.round=Math.PI,a.animStarted=!1,a.speed=2},update:function(a){a.x<800&&(a.animStarted=!0),a.animStarted?(a.x-=a.speed*GAME.speed,a.y+=a.speed*GAME.speed):(a.speed=8,a.x-=a.speed*GAME.speed)}},PATH6={init:function(a){a.round=Math.PI,a.animStarted=!1,a.speed=2},update:function(a){a.x<800&&(a.animStarted=!0),a.animStarted?(a.x-=a.speed*GAME.speed,a.y-=a.speed*GAME.speed):(a.speed=8,a.x-=a.speed*GAME.speed)}},PATH7={init:function(a){a.round=0,a.speed=2},update:function(a){a.round+=.05*GAME.speed,a.x-=a.speed*GAME.speed,a.y-=5*Math.sin(a.round)*GAME.speed}},MONSTER=function(a,b,c,d){if(this.x=a,this.y=b,this.type=c,this.weapon=monsters[c].weapon,this.reloadingTime=monsters[c].reloadingTime,this.life=monsters[c].life?monsters[c].life:1,this.path=window["PATH"+d],monsters[c].sprite){var e=monsters[c].sprite.split(":");this.width=e[0],this.pixels=e[1],this.colors=monsters[c].colors,this.height=this.pixels.length/this.width,this.factor=monsters[c].factor}else this.width=120,this.factor=1,this.height=150;this.trueWidth=this.width*this.factor,this.trueHeight=this.height*this.factor,this.glitchMode=16==this.type&&{x:500*Math.random()-250,y:500*Math.random()-250,active:0},this.reload=0,this.path.init(this),this.hit=function(a){return this.explode(),!1},this.explode=function(){score+=100,sound([3,,.3708,.5822,.3851,.0584,,-.0268,,,,-.0749,.7624,,,,,,1,,,,,.5]),GAME.addExplosion(this.x,this.y,[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],2);for(var a=0;a<GAME.monsters.length;a++)if(GAME.monsters[a]==this)return void GAME.monsters.splice(a,1)},this.update=function(){if(this.path.update(this),this.x<-50)return!1;if(GAME.player.armor){if(Math.hypot(this.x-(GAME.player.x+50),this.y-(GAME.player.y+30))<100||Math.hypot(this.x+this.trueWidth-(GAME.player.x+50),this.y+this.trueHeight-(GAME.player.y+30))<100)return sound([0,,.0967,.4264,.2902,.458,,-.3199,,,,.5693,.6278,,,,,,1,,,,,.5]),GAME.player.touch=10,GAME.player.armor-=20,this.explode(),!1}else if(this.x+this.trueWidth>GAME.player.x&&this.x<GAME.player.x+100&&this.y+this.trueHeight>GAME.player.y&&this.y<GAME.player.y+60)return GAME.player.life-=10,sound([3,,.2436,.5091,.252,.0334,,.2411,,,,,,,,,,,1,,,,,.5]),this.explode(),!1;if(this.glitchMode&&Math.random()>.95&&(this.glitchMode.active=1-this.glitchMode.active,this.glitchMode.active?(this.glitchMode={x:500*Math.random()-250,y:500*Math.random()-250,active:1},this.x+=this.glitchMode.x,this.y+=this.glitchMode.y):(this.x-=this.glitchMode.x,this.y-=this.glitchMode.y),this.x=Math.max(500,this.x),this.x=Math.min(1920,this.x),this.y=Math.max(0,this.y),this.y=Math.min(1e3,this.y)),ctx.drawImage(imgs[this.type],this.x,this.y),this.reload--,this.reload<1&&(this.reload=this.reloadingTime*Math.max(1,2/GAME.speed),GAME.player.life>0))if(16==this.type){var a=bearing(GAME.player.x+50,GAME.player.y+30,this.x,this.y),b=0;for(i=a-Math.PI/2;i<a+Math.PI/2;i+=.3)setTimeout(this.multipleShot.bind(this,i),100*b),b++}else GAME.addLaser(this.x,this.y+this.trueHeight/2,this.weapon);return!0},this.multipleShot=function(a){sound([3,,.1379,.4076,.35,.1342,,-.3958,,,,,,,,,.535,-.2877,1,,,,,.5]),GAME.addLaser(this.x,this.y+this.trueHeight/2,this.weapon,a)}},BONUS=function(a,b,c){this.x=a,this.y=b,this.type=c,this.time=bonusList[this.type].time?bonusList[this.type].time:0,this.round=0,this.update=function(){var d;if(this.x-=4,this.round+=.025,this.y+=2*Math.sin(this.round),this.x<0)return!1;if(d=GAME.player,this.x>d.x-30&&this.x<d.x+100&&this.y>d.y-30&&this.y<d.y+60){switch(this.type){case 2:sound([1,,.0854,,.78,.1,,.2148,,.1027,.2767,,,,,,,,1,,,,,.5]),GAME.player.armor=300;break;case 1:sound([1,,.01,,.6,.54,,.1799,.1999,.15,.02,-.0999,.52,,,.15,,,1,,,,,.5]),GAME.player.explodeAll={counter:50,x:d.x+50,y:d.y+30};break;case 3:sound([2,,.04,,.75,.43,.2,,.3999,.44,,-.7,.27,.7418,-.1559,.32,,-.02,.55,,,.1776,,.35]),GAME.player.weapon="triple",GAME.player.weaponTime=600}return!1}return a=this.x,b=this.y,g=ctx.createLinearGradient(a,b,a,b+20),g.addColorStop(0,"#466BA9"),g.addColorStop(.25,"#6FB5FF"),g.addColorStop(.5,"#6FB5FF"),g.addColorStop(.75,"#6FB5FF"),g.addColorStop(1,"#4772B8"),ctx.fillStyle=g,ctx.lineWidth=1,ctx.strokeStyle="rgba(37,60,99,0.5)",ctx.beginPath(),ctx.moveTo(a+6,b),ctx.lineTo(a+24,b),ctx.arcTo(a+30,b,a+30,b+6,6),ctx.lineTo(a+30,b+24),ctx.arcTo(a+30,b+30,a+24,b+30,6),ctx.lineTo(a+6,b+30),ctx.arcTo(a,b+30,a,b+24,6),ctx.lineTo(a,b+6),ctx.arcTo(a,b,a+6,b,6),ctx.stroke(),ctx.fill(),ctx.closePath(),drawText(a+10,b+6,bonusList[this.type].letter,.75,"#000"),!0}},drawStar=function(a,b,c,d){ctx=document.getElementById("bg").getContext("2d");var e=ctx.createRadialGradient(a,b,0,a,b,c);e.addColorStop(0,"rgba("+d[0]+","+d[1]+","+d[2]+",0.7)"),e.addColorStop(.1,"rgba("+d[0]+","+d[1]+","+d[2]+",0.7)"),e.addColorStop(.11,"rgba("+d[0]+","+d[1]+","+d[2]+",0.3)"),e.addColorStop(1,"rgba(127,127,127,0)"),ctx.fillStyle=e,ctx.fillRect(a-c,b-c,2*c,2*c)},drawStar2=function(a,b,c){ctx.drawImage(grd[c],a,b)},GAME={speed:.5,sprites:[],monsters:[],weapons:[],bonus:[],explodeAll:null,level:1,showLevel:120,monsterCount:0,player:{x:180,y:440,armor:null,touch:0,life:300,weapon:"laser",weaponTime:0,died:!1},addExplosion:function(a,b,c,d,e){this.sprites.push(new EXPLOSION(a,b,c,d,e))},addBonus:function(a,b,c){this.bonus.push(new BONUS(a,b,c))},addMonster:function(a,b,c,d){return!(this.monsterCount>=50||this.showLevel)&&(this.monsterCount++,void this.monsters.push(new MONSTER(a,b,c,d)))},addLaser:function(a,b,c,d){this.weapons.push(new window["WEAPON_"+c](a,b,d,c))}},frame=0,playeFireWait=0,fps=0,gameLoop=function(){if(auto){if(window.requestAnimationFrame(gameLoop),0==GAME.player.armor&&(sound([0,.09,.12,.3171,.61,.32,,-.12,,.23,.03,,,,,,,,1,,,,,.5]),GAME.player.armor=null),GAME.player.weaponTime-=.5,GAME.player.weaponTime<=0&&(GAME.player.weapon="laser",GAME.player.weaponTime=0),frame++%80==0){var a=Math.random();a=a>.66?7:a>.33?1:2,GAME.addMonster(1920,150+850*Math.random(),Math.floor(Math.random()*(monsters.length-2))+1,a)}if(50==GAME.monsterCount&&0==GAME.monsters.length&&(GAME.monsterCount=49,GAME.addMonster(1920,150+850*Math.random(),16,1),GAME.monsterCount=51),51==GAME.monsterCount&&0==GAME.monsters.length&&(GAME.level++,GAME.showLevel=120,GAME.monsterCount=0,GAME.speed*=1.1),frame%800==0)if(Math.random()>.5)for(Math.random()>.5?(y=600,a=3):(y=200,a=4),b=0;b<10;b++)GAME.addMonster(1920+100*b,y,1,a);else for(b=0;b<10;b++)GAME.addMonster(1920+200*b,200,2,5),GAME.addMonster(2020+200*b,600,2,6);frame%400==0,frame%500==0&&GAME.addBonus(1900,800*Math.random(),Math.floor(Math.random()*(bonusList.length-1))+1),ctx.clearRect(0,0,1920,1080);for(var b=0;b<stars.length*quality;b++)ctx.drawImage(grd[b],stars[b].x,stars[b].y),stars[b].x-=.01*stars[b].size*(velocity.x+15),stars[b].x<0&&(stars[b].x=2e3);for(ctx.lineWidth=1,ctx.fillStyle="rgba(255,255,255,0.5)",ctx.fillRect(0,980,1920,100),ctx.fillStyle="rgba(255,255,255,0.8)",ctx.rect(820,1005,280,50),ctx.stroke(),drawText(50,1020,"LIFE",1),drawText(1130,1020,"WEAPON",1),ctx.fillStyle="rgba(255,255,255,0.8)",ctx.strokeStyle="#000",ctx.rect(150,1016,600,30),ctx.fillStyle="rgba(255 ,255,255,0.8)",ctx.strokeStyle="#000",ctx.rect(1260,1016,600,30),ctx.fill(),ctx.lineWidth=0,ctx.fillStyle="rgba(55,55,255,0.8)",ctx.fillRect(152,1018,Math.max(GAME.player.life,0),26),ctx.lineWidth=0,ctx.fillStyle="#E5A96E",ctx.fillRect(152+Math.max(GAME.player.life,0),1018,GAME.player.armor,26),ctx.lineWidth=0,ctx.fillStyle="rgba(255,55,55,0.8)",ctx.fillRect(1262,1018,GAME.player.weaponTime,26),ctx.stroke(),drawText(862,1014,("0000000"+score).substring(score.toString().length),1.5),velocity.x-=10*velocity.x*delta,velocity.z-=10*velocity.z*delta,velocity.y-=10*velocity.y*delta,moveForward&&(velocity.y+=100*delta),moveBackward&&(velocity.y-=100*delta),moveLeft&&(velocity.x-=100*delta),moveRight&&(velocity.x+=100*delta),GAME.player.y+=velocity.y,GAME.player.x+=velocity.x,GAME.player.life&&(GAME.player.x=Math.max(GAME.player.x,0)),playeFireWait--,spaceKey&&playeFireWait<1&&("laser"==GAME.player.weapon?GAME.addLaser(GAME.player.x+30,GAME.player.y+(60-2*Math.abs(velocity.y))/2,"LASERPLAYER"):(GAME.addLaser(GAME.player.x+30,GAME.player.y+(60-2*Math.abs(velocity.y))/2,"FIREBALLPLAYER"),GAME.addLaser(GAME.player.x+30,GAME.player.y+(60-2*Math.abs(velocity.y))/2,"FIREBALLPLAYER",Math.PI/2-.25),GAME.addLaser(GAME.player.x+30,GAME.player.y+(60-2*Math.abs(velocity.y))/2,"FIREBALLPLAYER",Math.PI/2+.25)),playeFireWait=10,sound([0,,.1541,.0294,.3834,.6142,.2,-.2723,,,,,,.1888,.0421,,,,1,,,,,.5])),b=0;b<GAME.sprites.length;b++)GAME.sprites[b].update()||GAME.sprites.splice(b--,1);for(b=0;b<GAME.monsters.length;b++)GAME.monsters[b].update()||GAME.monsters.splice(b--,1);for(b=0;b<GAME.weapons.length;b++)GAME.weapons[b].update()||GAME.weapons.splice(b--,1);for(b=0;b<GAME.bonus.length;b++)GAME.bonus[b].update()||GAME.bonus.splice(b--,1);if(GAME.player.armor){x=GAME.player.x+35,y=GAME.player.y+30,size=100+10*Math.sin(frame/10);var c=ctx.createRadialGradient(x,y,0,x,y,size);GAME.player.touch--,GAME.player.touch>=0?(c.addColorStop(0,"rgba(255,255,255,0)"),c.addColorStop(.8,"rgba(63,112,255,0.4)"),c.addColorStop(.81,"rgba(63, 112, 255,0.4)"),c.addColorStop(.91,"rgba(191,243,255,0.7)"),c.addColorStop(.95,"rgba(127,187,255,1)"),c.addColorStop(1,"rgba(127,187,255,0)")):(c.addColorStop(0,"rgba(0,0,0,0)"),c.addColorStop(.8,"rgba(0,0,0,0)"),c.addColorStop(.81,"rgba(255, 0, 63,0)"),c.addColorStop(.91,"rgba(255,243,191,0.7)"),c.addColorStop(.95,"rgba(255,187,127,1)"),c.addColorStop(1,"rgba(255,187,127,0)")),ctx.fillStyle=c,ctx.fillRect(x-size,y-size,2*size,2*size)}if(GAME.player.explodeAll){var d=GAME.player.explodeAll;x=d.x,y=d.y,size=d.counter;var c=ctx.createRadialGradient(x,y,0,x,y,size);for(d.counter*=1.1,c.addColorStop(0,"rgba(0,0,0,0)"),c.addColorStop(.8,"rgba(0,0,0,0)"),c.addColorStop(.81,"rgba(255, 0, 23,0)"),c.addColorStop(.91,"rgba(255,143,91,0.7)"),c.addColorStop(.95,"rgba(255,87,27,1)"),c.addColorStop(1,"rgba(255,87,27,0)"),ctx.fillStyle=c,ctx.fillRect(x-size,y-size,2*size,2*size),b=0;b<GAME.monsters.length;b++){var e=GAME.monsters[b];16!=e.type&&Math.hypot(e.x-(GAME.player.x+50),e.y-(GAME.player.y+30))<d.counter&&(e.hit(1)||b--)}d.counter>2e3&&(GAME.player.explodeAll=null)}GAME.player.life<=0&&(GAME.player.died||(GAME.addExplosion(GAME.player.x-10,GAME.player.y-10,[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],4),GAME.addExplosion(GAME.player.x,GAME.player.y,[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],2),GAME.addExplosion(GAME.player.x+10,GAME.player.y+10,[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],4),GAME.player.died=!0,sound([3,,.3076,.6408,.97,.0108,,.2293,,,,,,,,,,,1,,,,,.51])),drawText(600,400,"GAME OVER",4,"#FFF"),GAME.player.x=-1e3,GAME.monsterCount=0),GAME.showLevel&&(drawText(700,400,"LEVEL "+GAME.level,4,"#FFF"),GAME.level>1&&drawText(860,560,"SPEED += 1",1,"#FFF"),GAME.showLevel--),ctx.drawImage(player,GAME.player.x,GAME.player.y,100,60-2*Math.abs(velocity.y))}},auto=!0,stars=[],grd=[];var canvas,ctx;velocity={x:0,y:0,z:0},delta=.01,moveForward=moveBackward=moveLeft=moveRight=spaceKey=!1,player=!1,score=0,font=[],font[0]="111101101101111",font[1]="010110010010111",font[2]="111001111100111",font[3]="111001111001111",font[4]="101101111001001",font[5]="111100111001111",font[6]="111100111101111",font[7]="111001010010010",font[8]="111101111101111",font[9]="111101111001111",font.A="111101111101101",font.B="110101110101110",font.C="111100100100111",font.D="110101101101110",font.E="111100111100111",font.F="111100111100100",font.G="111100101101111",font.H="101101111101101",font.I="111010010010111",font.J="011001001101010",font.K="101101110101101",font.L="100100100100111",font.M="101111111101101",font.N="101111111111101",font.O="010101101101010",font.P="110101110100100",font.R="110101111110101",font.S="111100111001111",font.T="111010010010010",font.U="101101101101111",font.V="101101101101010",font.W="101101111111010",font.X="101101010101101",font.Y="101101010010010",font["-"]="000000111000000",font[":"]="000010000010000",font["."]="000000000000010",font[","]="000000000010100",font["?"]="010101001010010",font["+"]="000010111010000",font["="]="000111000111000",sounds=[],drawText=function(a,b,c,d,e){ctx.fillStyle=e?e:"red",c=c.toString();for(var f=0;f<c.length;f++){var g=0;for(y=0;y<5;y++)for(x=0;x<3;x++)" "!=c[f]&&"1"==font[c[f]][g++]&&ctx.fillRect(a+5*x*d,b+5*y*d,4*d,4*d);a+=20*d}},initAudio=function(){var b=new CPlayer;for(b.init(song);b.generate()<1;);var c=b.createWave();context.decodeAudioData(c.buffer,function(b){musicBuffer=b,music.buffer=musicBuffer,music.connect(gainNode),music.start(0),music.loopEnd=56,music.loopStart=16,music.loop=!0;for(var c=1;c<monsters.length;c++)monsters[c].sprite&&drawSpriteToImg(c);player=new Image,player.src="life.png";for(var c=0;c<500;c++){ctx.clearRect(0,0,1920,1080);var d=1920*Math.random(),e=1080*Math.random(),f=5+10*Math.random();a=127+Math.floor(60*Math.random());var g=[2*a,a,127+Math.floor(127*Math.random())];stars.push({x:d,y:e,size:f,color:g});var h=document.createElement("canvas");h.width=2*f,h.height=2*f;var i=h.getContext("2d"),j=i.createRadialGradient(f/2,f/2,0,f/2,f/2,f/2);j.addColorStop(0,"rgba("+g[0]+","+g[1]+","+g[2]+",0.7)"),j.addColorStop(.1,"rgba("+g[0]+","+g[1]+","+g[2]+",0.7)"),j.addColorStop(.11,"rgba("+g[0]+","+g[1]+","+g[2]+",0.3)"),j.addColorStop(1,"rgba(127,127,127,0)"),i.fillStyle=j,i.fillRect(0,0,2*f,2*f),grd[c]=new Image,grd[c].src=h.toDataURL("image/png")}gameLoop()})},init=function(){canvas=document.getElementById("bg"),ctx=document.getElementById("bg").getContext("2d"),drawText(640,400,"LOADING",4,"#FFF"),setTimeout(initAudio,1),imgs[16]=new Image,imgs[16].src="boss.png"};var keys=[];document.onkeydown=function(a){switch(keys[a.keyCode]=!0,a.keyCode){case 38:moveBackward=!0;break;case 37:moveLeft=!0;break;case 40:moveForward=!0;break;case 39:moveRight=!0;break;case 32:spaceKey=!0}a.preventDefault()},document.onkeyup=function(a){switch(keys[a.keyCode]=!1,a.keyCode){case 83:snd=!snd,snd?playMusic():stopMusic();break;case 38:moveBackward=!1;break;case 37:moveLeft=!1;break;case 40:moveForward=!1;break;case 39:moveRight=!1;break;case 32:spaceKey=!1}};var song={songData:[{i:[1,130,128,0,1,25,128,9,0,0,7,5,52,0,0,0,0,0,0,2,255,0,0,32,47,3,17,2],p:[1,2,1,2,1,2,1,2,1,2,1,2,1,2],c:[{n:[125,125,,125,125,,125,,125,125,,125,125,125,,,125,125,,125,125,,125,,125,125,,125,125,125,,,,,132,,,132,,132,,,132,,,,132,130,,,133,,,133,,133,,,133,,,,133,130,,,137,,,137,,137,,,137,,,,137,134,,,137,,,137,,137,,,137,,,,137,134],f:[]},{n:[123,123,,123,123,,123,,123,123,,123,123,123,,,120,120,,120,120,,120,,120,120,,120,120,120,,,,,130,,,130,,130,,,130,,,,130,125,,,127,,,127,,127,,,127,,,,127,127,,,135,,,135,,135,,,135,,,,135,130,,,132,,,132,,132,,,132,,,,132,132],f:[]}]},{i:[1,28,128,0,1,28,140,18,0,0,0,60,178,0,0,0,0,0,0,2,13,0,0,32,0,0,0,0],p:[,,1,2,1,2,1,2,1,2,1,2,1,2],c:[{n:[113,,,,,,,,,,,,,,,,113,,,,,,,,,,,,,,,,120,,,,,,,,,,,,,,,,121,,,,,,,,,,,,,,,,125,,,,,,,,,,,,,,,,125],f:[]},{n:[111,,,,,,,,,,,,,,,,108,,,,,,,,,,,,,,,,118,,,,,,,,,,,,,,,,115,,,,,,,,,,,,,,,,123,,,,,,,,,,,,,,,,120],f:[]}]},{i:[1,124,128,0,1,125,140,18,0,0,0,29,52,0,0,0,0,0,0,2,13,0,0,32,0,0,0,0],p:[,,,,1,2,1,2,1,2,1,2,1,2],c:[{n:[113,,,,113,,,,113,,,,113,,,,113,,,,113,,,,113,,,,113,,,,,120,,120,,120,,120,,120,,120,,120,,120,,121,,121,,121,,121,,121,,121,,121,,121,,,125,,,,125,,,,125,,,,125,,,,125,,,,125,,,,125,,,,125],f:[]},{n:[111,,,,111,,,,111,,,,111,,,,108,,,,108,,,,108,,,,108,,,,,118,,118,,118,,118,,118,,118,,118,,118,,115,,115,,115,,115,,115,,115,,115,,115,,,123,,,,123,,,,123,,,,123,,,,120,,,,120,,,,120,,,,120],f:[]}]},{i:[0,160,128,1,0,160,128,0,1,210,4,7,41,0,0,0,60,4,1,2,33,0,0,32,61,5,0,6],p:[,,,,2,2,2,2,2,2,2,2,2,2],c:[{n:[120,,,,,,120,,120,,,,,,,,120,,,,,,120,,120,,,,,,,,120,,,,,,120,,120,,,,,,,,120,,,,,,120,,120],f:[]},{n:[120,,,,120,,,,120,,,,120,,,,120,,,,120,,,,120,,,,120,,120,,120,,,,120,,,,120,,,,120,,,,120,,,,120,,,,120,,,,120,,120],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,60,4,10,34,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[,,1,1,2,2,2,2,2,2,2,2,2,2],c:[{n:[,,118,,,,118,,,,118,,,,118,,,,118,,,,118,,,,118,,,,118],f:[]},{n:[118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118,,118],f:[]}]},{i:[0,160,128,1,0,160,128,0,1,210,4,7,41,0,0,0,60,4,1,2,255,0,0,32,61,0,0,0],p:[,,,2,1,1,1,1,1,1,1,1,1,1],c:[{n:[,,120,,,,120,,,,120,,,,120,120,,,120,,,,120,,,,120,,,,120,120],f:[]},{n:[,,,,,,,,,,,,,,,,120,,,,120,,,,120,,120,,120,,120,120],f:[]}]},{i:[1,192,128,0,1,191,116,9,0,0,6,22,40,0,0,0,69,3,1,1,0,167,0,32,77,6,25,6],p:[,,,1,6,7,2,3,2,3,4,5,4,5],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,149,151,152,154],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,53]},{n:[156,,,,,,,,,,,,149,151,152,154,157],f:[13,,,,,,,,,,,,13,,,,13,,,,,,,,,,,,,,,,130,,,,,,,,,,,,44,,,,130]},{n:[161,154,,156,159,,154,151,,151,152,,144,142,139,142,144,,,,147,,149,,151,,142,,149,151,152,154],f:[13,,,,,,,,,,,,,,,,13,,,,13,,,,,,,,13,,,,44,,,,,,,,,,,,,,,,81,,,,61,,,,,,,,44]},{n:[152,,149,,,149,,,149,,,,149,151,152,154,152,,149,,,149,,,149,,,,149,151,152,154],f:[]},{n:[151,,147,,,147,,,147,,,,149,151,152,154,151,,149,,,147,,,149,,,,151,151,152,154],f:[]},{n:[152,,156,,154,,151,,,,,152,156,,152,154,159,,161,,152,,152,,135,,137],f:[]},{n:[135,,,,135,,,,135,,,,135,,,,156,,,,159,,,,168,,,,171,,,,,142,,142,,142,,142,,142,,142,,142,,142,,,,,,,,,,,,,,,,,,,147,,,,147,,,,147,,,,147],f:[,,,,,,,,,,,,,,,,13,,,,,,,,,,,,,,,13,,,,,,,,,,,,,,,,,158,,,,,,,,,,,,,,,40]}]},{i:[0,0,128,0,0,0,128,0,0,125,0,52,109,0,0,0,0,0,0,1,193,171,0,29,39,3,88,3],p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[125,,,,,,,,,,,,,,,,125],f:[]}]}],rowLen:5513,patternLen:32,endPattern:15},CPlayer=function(){var h,i,j,k,l,a=function(a){return Math.sin(6.283184*a)},b=function(a){return 2*(a%1)-1},c=function(a){return a%1<.5?1:-1},d=function(a){var b=a%1*4;return b<2?b-1:3-b},e=function(a){return.003959503758*Math.pow(2,(a-128)/12)},f=function(a,b,c){var v,w,x,y,z,A,B,d=g[a.i[0]],f=a.i[1],h=a.i[3],i=g[a.i[4]],j=a.i[5],k=a.i[8],l=a.i[9],m=a.i[10]*a.i[10]*4,n=a.i[11]*a.i[11]*4,o=a.i[12]*a.i[12]*4,p=1/o,q=a.i[13],r=c*Math.pow(2,2-a.i[14]),s=new Int32Array(m+n+o),t=0,u=0;for(v=0,w=0;v<m+n+o;v++,w++)w>=0&&(q=q>>8|(255&q)<<4,w-=r,A=e(b+(15&q)+a.i[2]-128),B=e(b+(15&q)+a.i[6]-128)*(1+8e-4*a.i[7])),x=1,v<m?x=v/m:v>=m+n&&(x-=(v-m-n)*p),y=A,h&&(y*=x*x),t+=y,z=d(t)*f,y=B,k&&(y*=x*x),u+=y,z+=i(u)*j,l&&(z+=(2*Math.random()-1)*l),s[v]=80*z*x|0;return s},g=[a,c,b,d];this.init=function(a){h=a,i=a.endPattern-2,j=0,k=a.rowLen*a.patternLen*(i+1)*2,l=new Int32Array(k)},this.generate=function(){var b,c,e,m,n,o,p,q,r,v,w,x,F,G,z=new Int32Array(k),A=h.songData[j],B=h.rowLen,C=h.patternLen,D=0,E=0,H=!1,I=[];for(e=0;e<=i;++e)for(p=A.p[e],m=0;m<C;++m){var J=p?A.c[p-1].f[m]:0;J&&(A.i[J-1]=A.c[p-1].f[m+C]||0,J<15&&(I=[]));var K=g[A.i[15]],L=A.i[16]/512,M=Math.pow(2,A.i[17]-9)/B,N=A.i[18],O=A.i[19],P=43.23529*A.i[20]*3.141592/44100,Q=1-A.i[21]/255,R=1e-5*A.i[22],S=A.i[23]/32,T=A.i[24]/512,U=6.283184*Math.pow(2,A.i[25]-9)/B,V=A.i[26]/255,W=A.i[27]*B;for(w=(e*C+m)*B,n=0;n<4;++n)if(o=p?A.c[p-1].n[m+n*C]:0){I[o]||(I[o]=f(A,o,B));var X=I[o];for(c=0,b=2*w;c<X.length;c++,b+=2)z[b]+=X[c]}for(c=0;c<B;c++)q=2*(w+c),v=z[q],v||H?(x=P,N&&(x*=K(M*q)*L+.5),x=1.5*Math.sin(x),D+=x*E,F=Q*(v-E)-D,E+=x*F,v=3==O?E:1==O?F:D,R&&(v*=R,v=v<1?v>-1?a(.25*v):-1:1,v/=R),v*=S,H=v*v>1e-5,r=Math.sin(U*q)*T+.5,G=v*(1-r),v*=r):G=0,q>=W&&(G+=z[q-W+1]*V,v+=z[q-W]*V),z[q]=0|G,z[q+1]=0|v,l[q]+=0|G,l[q+1]+=0|v}return j++,j/8},this.createWave=function(){var a=2*k-8,b=a-36,c=44,d=new Uint8Array(c+2*k);d.set([82,73,70,70,255&a,a>>8&255,a>>16&255,a>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&b,b>>8&255,b>>16&255,b>>24&255]);for(var e=0,f=c;e<k;++e){var g=l[e];g=g<-32767?-32767:g>32767?32767:g,d[f++]=255&g,d[f++]=g>>8&255}return d},this.getData=function(a,b){for(var c=2*Math.floor(44100*a),d=new Array(b),e=0;e<2*b;e+=1){var f=c+e;d[e]=a>0&&f<l.length?l[f]/32768:0}return d}};musicBuffer=!1;var context=new AudioContext,gainNode=context.createGain(),music=context.createBufferSource();gainNode.connect(context.destination);var quality=1,snd=!0,player;sound=function(a){snd&&playSound(a)};</script>
	</head>
	<body onload="init()">
		<canvas id="bg" width="1920" height="1080"></canvas>
	</body>
</html>
