(()=>{var t={898:t=>{t.exports=function(t,e){if(e=e||t,!t.__attributes_imported&&e.attributes&&e.attributes.length)for(var i=0;i<e.attributes.length;i++){var s=e.attributes[i];t[s.name]||(t[s.name]=s.value)}t.__attributes_imported=!0}},115:(t,e,i)=>{const s=i(898);t.exports=function t(e,i){var n;if("function"==typeof i&&"function"==typeof i.getBindings){n=[];const s=i.getBindings();for(var r=0;r<s.length;r++)for(var o=t(e,s[r]),a=0;a<o.length;a++)n.push(o[a]);return n}for(i=i.replace(/:/g,"\\:"),n=e.querySelectorAll(i),r=0;r<n.length;r++)s(n[r]);return Array.prototype.slice.call(n,0)}},438:(t,e,i)=>{const{isa:s,getTypeId:r,setType:o,registerType:a}=i(695),h=i(115),c=i(898);function l(t,e){(e=e||function(){}).template=t,d(e);const i=function(t){return p(e,t)};return i.apply=function(t,i){e.apply(t,i)},i.call=function(){var t=Array.prototype.shift.apply(arguments);return e.call(t,arguments)},i.__constructor=e,i.name=e.name,i.getBindings=()=>d.getBindings(i),i}function d(t,e,i){if("function"==typeof t){var n=d.addBinding(e,t);t.binding=n;var r=h(s(i,Node)?i:document,n);return d.Apply(t,r),r.length}s(t,Node)&&d.BindExistingConstructors(t)}l.clear=function(){d.Classes={}},d.BindExistingConstructors=function(t,e){var i=[],s=e&&e.dependencies||d.Classes;for(var n in s)d(d.Classes[n],n,t)>0&&(i[n]=1);e&&!e.dependencies&&(e.dependencies=i)},d.Apply=function(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.__AlreadyBound||(d.importParameters(t,s),d.ApplyClone(t,s),d.ApplyConstructor(t,s),c(s),s.__AlreadyBound=!0)}},d.ApplyTemplate=function(t,e){var{compiled:i}=d.compile(t);i&&(e.innerHTML=i)},d.ApplyClone=function(t,e){if(d.compile(t)){for(;e.firstChild;)e.removeChild(e.firstChild);var i=d.getClone(t);for(0==i.childNodes.length&&(i=e.__holdingDiv);i.firstChild;)e.appendChild(i.removeChild(i.firstChild))}},d.ApplyConstructor=function(t,e){d.BindExistingConstructors(e,t),o(e,t),d.attachIdentifiedChildren(e),d.applyParameters(e),t.apply(e),"function"==typeof e.init&&e.init()},d.applyProperties=function(t,e){var i="object"==typeof e?e:{};for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s])},d.originalCreateElement=document.createElement,d.createNode=function(t,e){var{tag:e,className:i=""}=e?{tag:e}:d.compile(t),s=d.originalCreateElement.call(document,"div");0==e.indexOf(":")&&(e=e.substr(1)),s.innerHTML="<"+e+"></"+e+">";var n=s.firstChild;return n.className=i||"",n},d.Classes={},document.createElement=function(t,e){var i=d.getConstructor(t);if(i){var s=d.getClone(i);d.applyProperties(s,e),d.ApplyConstructor(i,s),s.__AlreadyBound=!0}else s=d.originalCreateElement.call(this,t),d.applyProperties(s,e);return s},d.getClone=function(t){return t.templateNode||(t.templateNode=d.createNode(t),d.ApplyTemplate(t,t.templateNode)),t.templateNode.cloneNode(!0)},d.addBinding=function(t,e){const i=d.compile(e,t);return d.Classes[i.tag]=e,i.tag},d.getConstructor=function(t){return d.Classes[t]},d.getBindings=function(t){var e=[];for(var i in d.Classes)d.Classes[i]!==t&&d.Classes[i]!==t.__constructor||e.push(i);return e},d.makeNodeFrom=function(t,e){if(s(t,Node)||s(t,Element))return t;if(s(t,Array)){var i=document.createElement("div");return d.addArrayAsChildren(i,t),i}if("object"!=typeof t)return(i=document.createElement("div")).innerHTML=t,i;var n=null;if(e&&(n=d.getConstructor(e)),"object"==typeof t.__types)for(var r=TG.getTypeArray(t),o=0;o<r.length;o++)n=d.getConstructor(r[o]);if(n)return p(n,t);var a=document.createElement("div");return a.innerHTML=t,a},d.addArrayAsChildren=function(t,e,i){for(;t.firstChild;)t.removeChild(t.firstChild);for(var s=0;s<e.length;s++)e[s]=d.makeNodeFrom(e[s],i),e[s].parentNode&&e[s].parentNode.removeChild(e[s]),t.appendChild(e[s])},d.childNodeArray=function(t){var e=[];e.events={};var i=t["data-collection"]||t.getAttribute("data-collection");e.render=function(){d.addArrayAsChildren(t,e)},e.loadFromDOM=function(i){i&&(t=i);var s=[],n=t["data-collection"]||t.getAttribute("data-collection");s=n?h(t,n):Array.prototype.slice.call(t.childNodes),e.length=0,s.forEach((function(t){e.push(t)}))},e.push=function(s){var n=d.makeNodeFrom(s,i);return t.appendChild(n),Array.prototype.push.call(e,n)},e.pop=function(){return t.removeChild(n),Array.prototype.pop.apply(e)},e.shift=function(){return t.removeChild(n),Array.prototype.shift.apply(e)},e.unshift=function(s){var n=d.makeNodeFrom(s,i);return t.insertBefore(n,t.firstChild),Array.prototype.unshift.call(e,n)},e.splice=function(){for(var i=Array.prototype.slice.call(arguments,0),s=i.shift(),n=i.shift()||e.length,r=i||[],o=s;o<s+n;o++){var a=e[o];t.removeChild(a)}var h=e[o];return r.forEach((function(e){t.insertBefore(e,h)})),Array.prototype.splice.apply(e,arguments)};for(var s=["reverse","sort"],r=0;r<s.length;r++)!function(){var t=s[r];e[t]=function(){var i=Array.prototype[t].apply(e,arguments);return e.render(),i}}();return e.loadFromDOM(),e},d.defineAccessors=function(t,e,i){var n=Object.getOwnPropertyDescriptor(e,i);if(!(n&&0==n.configurable||t.__accessorDefined)){Object.defineProperty(t,"__accessorDefined",{get:function(){return!0},enumerable:!1}),e[i];var r="innerHTML";"string"==typeof t.value&&(r="value");var o=t.getAttribute("data-property"),a=o,h=d.childNodeArray(t);e.__dom=e.__dom||{},Object.defineProperty(e.__dom,i,{get:function(){return t}}),Object.defineProperty(e,"__dom",{enumerable:!1});var c=!0;(t["data-ignore"]||t.getAttribute("data-ignore"))&&(c=!1),Object.defineProperty(e,i,{get:function(){return"children"==o||"children"==a||t["data-collection"]||t.getAttribute("data-collection")?h:o?t[o]:a?t[a]:t},set:function(e){var i=function(e){if(s(e,Array))d.addArrayAsChildren(t,e),a="children";else if(s(e,Node))t.parentNode&&t.parentNode.replaceChild(e,t),t=e,a=null;else if(s(e,Object)){for(var i in e)t[i]=e[i];a=null}else o?(t[o]=e,a=o):(t[r]=e,a=r)};e?"function"==typeof e.then?e.then((t=>i(t))).catch(console.error):"function"==typeof e.onto?e.onto(h.loadFromDOM(t)):(i(e),h.loadFromDOM(t)):i(e)},enumerable:c,configurable:!1})}},d.attachIdentifiedChildren=function(t,e){var i=(e||t).querySelectorAll("[data-id]");i=Array.prototype.slice.call(i,0);for(var s=0;s<i.length;s++){var n=i[s].getAttribute("data-id"),r=t[n];d.defineAccessors(i[s],t,n),r&&(t[n]=r)}},d.compile=function(t){if(!t.compilation){const e=d.buildSampleContainer(t.template),i=d.compileTemplate(e),{tag:s,className:n}=d.findBinding(e);t.compilation={template:t.template,compiled:i,tag:s,className:n}}return t.compilation},d.buildSampleContainer=function(t){const e=document.createElement("div");return e.innerHTML=t,e},d.compileTemplate=function(t){return 1===t.childNodes.length?t.firstChild.innerHTML:t.innerHTML},d.findBinding=function(t){return t.childNodes&&1===t.childNodes.length&&(t=t.firstChild),{tag:t.tagName,className:t.className}},d.importParameters=function(t,e,i){if(i=i||e,!e.__parameters_imported&&i.childNodes){e.parameters=[];for(var s=0;s<i.childNodes.length;s++){var n=i.childNodes[s];if(n.nodeType&&3==n.nodeType&&n.data&&n.data.replace(/\s/g,"")){var r=document.createElement("span");r.innerHTML=n.data,n=r}e.parameters.push(n)}if(null!=d.compile(t)){for(e.__holdingDiv=document.createElement("div"),e.__holdingDiv.style.display="none",document.body.appendChild(e.__holdingDiv),s=0;s<e.parameters.length;s++)e.__holdingDiv.appendChild(e.parameters[s]);d(e.__holdingDiv)}}e.__parameters_imported=!0},d.applyParameters=function(t){if(t.parameters&&s(t.parameters,Array)&&t.__holdingDiv){for(var e=t.parameters,i=e.length-1;i>=0;i--){var n=e[i]["data-id"];n||"function"!=typeof e[i].getAttribute||(n=e[i].getAttribute("data-id")),n&&(t[n]=e[i])}t.__holdingDiv.parentNode.removeChild(t.__holdingDiv),delete t.__holdingDiv}},d.copyDefaultAttributes=function(t,e){if(s(t,Node)&&s(e,Node))for(var i=0;i<t.attributes.length;i++){var n=t.attributes[i].name;e.hasAttribute(n)||(e.setAttribute(n,t.attributes[i].value),e[n]=t.attributes[i].value)}},d.getChildren=function(t,e){if(!t.childNodes)return[];for(var i=[],s=h(t,e),n=0;n<s.length;n++)s[n].parentNode===t&&i.push(s[n]);return i};const p=function(t,e){var i=e||{},s=null;for(var n in d.Classes)if(d.Classes[n]===t){s=document.createElement(n,i);break}return null===s&&(s=e,t.apply(s)),s};t.exports={DomClass:l,bless:d,isa:s,getTypeId:r,setType:o,registerType:a,getNodes:h}},695:(t,e,i)=>{function s(t){var e=t;if("function"==typeof t&&"function"==typeof t.getBindings){var i=t.getBindings();e=i.length>0?i[0]:t.name||t.toString()}return e}function n(t,e){t.__types=t.__types||{};var i=s(e);if(i&&null==t.__types[i]){var n=0;for(var r in t.__types)n=Math.max(n,t.__types[r]);n+=1,t.__types[i]=n}}Element=i.g.Element||function(){return!0},Node=i.g.Node||Element,t.exports={isa:function(t,e){var i=typeof t,n=typeof e;return"string"===i?e===String:"number"===i?e===Number:null==t?n===i:"boolean"===i?i===n:!("string"!==n&&"function"!==n||(t.__types=t.__types||{},!e||!t.__types[s(e)]))||(e===Element||e===Node||e===NodeList||"function"===n?t instanceof e:t===e)},getTypeId:s,setType:n,registerType:n}},292:(t,e,i)=>{class s{constructor(t,e,i,s,n,r,o,a){this.x=t||0,this.y=e||0,this.width=i||0,this.height=s||0,this.marginTop=n||0,this.marginRight=r||0,this.marginBottom=o||0,this.marginLeft=a||0}contains(t,e){var i=this.x-Math.ceil(this.marginLeft/2),s=this.y-Math.ceil(this.marginTop/2),n=this.x+this.width-Math.ceil(this.marginRight/2),r=this.y+this.height-Math.ceil(this.marginBottom/2);return t>=i&&t<=n&&e>=s&&e<=r}getBottom(){return this.y+this.height}getRight(){return this.x+this.width}rangeOverlaps(t,e,i,s){return t<=s&&i<=e}xOverlaps(t){return this.rangeOverlaps(this.x,this.getRight(),t.x,t.getRight())}yOverlaps(t){return this.rangeOverlaps(this.y,this.getBottom(),t.y,t.getBottom())}overlaps(t){return this.xOverlaps(t)&&this.yOverlaps(t)}}t.exports={Box:s,MouseCoords:class{constructor(t){var e=t||i.g.event;e.changedTouches?(this.x=e.changedTouches[0].pageX,this.y=e.changedTouches[0].pageY):e.pageX||e.pageY?(this.x=e.pageX,this.y=e.pageY):(e.clientX||e.clientY)&&(this.x=e.clientX+document.body.scrollLeft,this.y=e.clientY+document.body.scrollTop)}},NodeBox:class extends s{constructor(t){let e=t.offsetLeft,i=t.offsetTop;for(var s=t;s=s.offsetParent;)e+=s.offsetLeft,i+=s.offsetTop;let n=t.offsetWidth,r=t.offsetHeight;var o={marginLeft:"",marginRight:"",marginTop:"",marginBottom:""};let a=parseInt(o.marginLeft.replace(/[^0-9]/g,"")||"0"),h=parseInt(o.marginRight.replace(/[^0-9]/g,"")||"0");super(e,i,n,r,parseInt(o.marginTop.replace(/[^0-9]/g,"")||"0"),h,parseInt(o.marginBottom.replace(/[^0-9]/g,"")||"0"),a),this.left=this.x,this.top=this.y,this.right=this.x+this.width,this.bottom=this.x+this.height}}}},795:(t,e,i)=>{const{isa:s}=i(438),n=function(t){this.fns=[],this.fired=0,this.singleFire=t||!1,this.args=[],this.register=function(t){this.singleFire&&this.fired>0?t.apply(null,this.args):this.fns.push(t)},this.fire=function(t,e,i){this.fired+=1;var s=[];for(this.args=arguments;this.fns.length>0;){var n=this.fns.pop();n.apply(null,this.args),s.push(n)}this.singleFire||(this.fns=s)}},r=function(t,e,i,o){var a="__TGEvent_on"+e,h=o||!1;if(s(t,Array)||s(t,NodeList)){for(var c=[],l=0;l<t.length;l++)!s(t[l],Object)||!s(t[l],Element)&&s(t[l],Node)||c.push(t[l]);var d={objects:c,count:c.length,fired:0,fn:i,fire:function(){this.fired++,this.fired>=this.count&&i()}};if(c.length>0)for(l=0;l<c.length;l++)r(c[l],e,(function(){d.fire()}),h);else d.fire();return d}var p=[];if(void 0===t[a]?t[a]=new n(h):"function"==typeof t[a]&&!t[a]instanceof n?(p.push(t[a]),t[a]=new TG.Event(h)):s(t[a],Array)&&(p=p.concat(t[a])),t[a]instanceof n)for(i&&p.push(i),l=0;l<p.length;l++)t[a].register(p[l]);return t[a]};t.exports={on:r,onready:function(t,e){return r(t,"ready",e,!0)},Event:n}},441:t=>{function e(){const t=new Date,i=e.__lastTime?t-e.__lastTime:0,s=i/1e3;e.__lastTime=t;var n=e.objects.filter((t=>!t.dead));e.objects=n;for(var r=0;r<n.length;r++)n[r].step({now:t,elapsed:s,elapsed_ms:i});for(r=0;r<n.length;r++)n[r].draw();e.__interval&&requestAnimationFrame((()=>e()))}e.__fps=30,e.__interval=null,e.objects=[],e.functions=[],e.running=function(){return e.__interval},e.addObject=function(t){if("object"==typeof t&&t.step&&"function"==typeof t.step&&t.draw&&"function"==typeof t.draw){for(var i=e.objects,s=0;s<i.length;s++)if(t===i[s])return!0;return i.push(t),e.start(),!0}return!1},e.removeObject=function(t){const i=e.objects;for(var s=0;s<i.length;s++)if(i[s]===t)return void i.splice(s,1)},e.start=function(t){e.__interval||(e.__interval=!0,requestAnimationFrame((()=>e())))},e.stop=function(){e.__interval=null},e.pause=function(){return e.stop()},t.exports={MainLoop:e}}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var r=e[s]={exports:{}};return t[s](r,r.exports,i),r.exports}i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{const{DomClass:t,setType:e,isa:s,getNodes:n}=i(438),{MouseCoords:r,NodeBox:o}=i(292),{MainLoop:a}=i(441),{on:h}=i(795);i.g.MainLoop=a;let c="shooty-ship-tiny.highscore",l=["enemy"],d=["enemy"],p="Shooty Ship 13k";function u(t,e){t.style.transform=`rotate(${e}rad)`,t.style.webkitTransform=`rotate(${e}rad)`,t.style.mozTransform=`rotate(${e}rad)`,t.style.msTransform=`rotate(${e}rad)`}t("<ss:game>\n\t<ss:gameoversplash data-id='presplash'></ss:gameoversplash>\n\t<ss:ship data-id='ship' style='top: -100%; left: -100%;'></ss:ship>\n</ss:game>",(function(){var t=this;this.enabled=!1,this.minX=0,this.maxX=100,this.minY=0,this.maxY=100,this._enemies=[],this.presplash.heading=p,this.enable=function(){this.enabled||(this.register_event_proxies(),this.enabled=!0,a.addObject(t))},this.disable=function(){this.unregister_event_proxies(),this.enabled=!1},this.resize=function(){this.style.width="100%",this.style.height="100%",this.style.top="",this.style.left="",this.minX=0,this.maxX=100,this.minY=0,this.maxY=100;var t=new o(this),e=Math.max(t.width,t.height),i=100*e/Math.min(t.width,t.height),s=(i-100)/2,n=100*s/i;t.width==e?(this.style.height=i+"%",this.style.top=-1*s+"%",this.minY=n,this.maxY=100-n):(this.style.width=i+"%",this.style.left=-1*s+"%",this.minX=n,this.maxX=100-n)},this.getSpawnPoint=function(){var t,e;return Math.random()<.5?(t=Math.random()<.5?this.minX:this.maxX,e=Math.random()*this.maxY):(e=Math.random()<.5?this.minY:this.maxY,t=Math.random()*this.maxX),{x:t,y:e}},this.step=function(){if(this.enabled&&this._enemies.length<this.maxRocks){var e=this.getSpawnPoint(),i={x:this.ship.x+(20*Math.random()-10),y:this.ship.y+(20*Math.random()-10)},s=i.y-e.y,n=i.x-e.x,r=Math.atan2(s,n);const a=d||[];if(a.length<0)throw new Error("No enemy types registered!");var o=new _({x:e.x,y:e.y,direction:r,speed:6+10*Math.random()*t.maxRocks,game:t,subtype:a[Math.floor(Math.random()*a.length)]});this.addEnemy(o)}},this.addEnemy=function(e){h(e,"shot",(function(){t.score+=1,t.maxRocks=Math.max(1,Math.log(t.score)/Math.log(Math.E))})),h(e,"destroy",(function(){t._enemies.splice(t._enemies.indexOf(e),1)})),h(e,"shatter",(function(e){t.addEnemy(e)})),this.appendChild(e),this._enemies.push(e)},this.draw=function(){},this.gameover=function(){this.disable(),setTimeout((function(){var e=new N({board:t,score:t.score});h(e,"restartClick",(function(){t.start()})),t.appendChild(e)}),2e3)},this.start=function(){this._enemies.forEach((function(t){t.destroy()})),this.score=0,this.maxRocks=1,this.enable(),this.ship.respawn(),this.ship.leapTo(50-t.ship.width/2,50-t.ship.height/2)},this.interact=function(t){if(this.enabled){var e=new r(t),i=new o(this),s={x:100*(e.x-i.x)/i.width,y:100*(e.y-i.y)/i.height};return this.ship.pushTo(s),!1}},this.register_event_proxies=function(){this.ontouchstart=e(t,(function(e){t.interact(e)})),this.ontouchmove=function(){return!1},this.ontouchend=function(){return!1},this.ontouchleave=function(){return!1},this.ontouchcancel=function(){return!1},this.onmousedown=e(t,(function(e){t.interact(e)})),this.onclick=function(){return!1},this.onmouseup=function(){return!1}},this.unregister_event_proxies=function(){["touchstart","touchmove","touchend","touchleave","touchecancel","mousedown","click","mouseup"].forEach((function(e){t["on"+e]=null}))};var e=function(t,e){return function(i){var s=i||window.event;s.type.match(/touch/)&&(t.onmousedown=null,t.onmousemove=null,t.onmouseup=null);var n=e(s);return n||"function"!=typeof s.preventDefault||s.preventDefault(),n}};h(t.presplash,"restartClick",(function(){t.start()})),h(t.ship,"shoot",(function(e){t.appendChild(e)})),h(t.ship,"destroy",(function(){t.gameover()})),this.resize(),window.onresize=function(){t.resize()}}));const f={channels:{},play:function(t){void 0===this.channels[t]?this.prepare(t):this.channels[t].play()},prepare:function(t){var e=window.AudioContext||window.webkitAudioContext,i=this;i.context=i.context||new e;var s={buffer:null,play:function(){if(this.buffer){var t=i.context.createBufferSource();t.buffer=this.buffer,t.connect(i.context.destination),t.start?t.start(0):t.noteOn(0)}}},n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){i.context.decodeAudioData(n.response,(function(t){s.buffer=t}))},n.send(),this.channels[t]=s}},m=function(){this.onclick=function(){return h(this,"click").fire(),!1},this.ontouchend=this.onclick},g=(t("<ss:startbutton>Start</ss:startbutton>",(function(){m.apply(this)})),function(){var t=new o(this),e=new o(this.parentNode||document.body);this.width=100*t.width/e.width,this.height=100*t.height/e.height}),y=t("<ss:ship></ss:ship>",(function(){var t=this;this.x=this.x||0,this.y=this.y||0,this.style.backgroundImage="url(./img/shooty-ship.svg)",g.apply(this),this.direction=this.direction||Math.PI/-2,this.target={x:t.x,y:t.y,direction:t.direction},this.enabled=!1,this.enable=function(){this.enabled||(a.addObject(this),this.enabled=!0)},this.disable=function(){this.enabled&&(a.removeObject(this),this.enabled=!1)},this.leapTo=function(e,i,s){this.x=e,this.y=i,this.direction=s||Math.PI/-2,this.target={x:t.x,y:t.y,direction:t.direction}},this.step=function({elapsed:t}){if(!t)return;this.target.direction,this.direction,this.direction=this.direction+30*t*Math.atan2(Math.sin(this.target.direction-this.direction),Math.cos(this.target.direction-this.direction))/4;const e=30*(this.target.x-this.x)/12,i=30*(this.target.y-this.y)/12;this.x+=e*t,this.y+=i*t},this.draw=function(){u(this,Number(this.direction)+Math.PI/2),this.style.left=this.x+"%",this.style.top=this.y+"%"},this.destroy=function(){if(!this.dead&&!this.disabled){this.dead=!0,this.disable();for(var t=this.parentNode,e=this.x,i=this.y,s=0;s<8;s++)setTimeout((function(){t.appendChild(new C({x:e+10*Math.random()-5,y:i+10*Math.random()-5,duration:100*s}))}),100*s);h(this,"destroy").fire(),this.style.display="none"}},this.respawn=function(){this.dead=!1,this.style.display="",this.enable()},this.pushTo=function(t){if(this.dead)return!1;this.shoot(),this.target.x=t.x-this.width/2,this.target.y=t.y-this.height/2;var e=this.target.y-this.y,i=this.target.x-this.x;this.target.direction=Math.atan2(e,i)},this.shoot=function(){var e=new b({x:t.x+this.width/2,y:t.y+this.height/2,direction:t.direction});h(this,"shoot").fire(e)},h(this,"collide",(function(e){s(e,"SS.Enemy")&&t.destroy()})),e(this,"SS.Ship")})),v=function(){this.x=Number(this.x||0),this.y=Number(this.y||0),this.width=Number(this.width||1),this.height=Number(this.height||1),this.ix=this.x,this.iy=this.y,this.direction=this.direction||0,this.speed=this.speed||75,this.range=this.range||130,this.dead=!1,this.conflicts=this.conflicts||[],this.destroy=function(){h(this,"destroy").fire(),this.dead=!0,!this.parentNode||this.parentNode.removeChild(this)},this.step=function({elapsed:t}){var e=this.x-this.ix,i=this.y-this.iy;if(Math.sqrt(e*e+i*i)>=this.range)this.destroy();else{const e=this.speed*t;this.x+=Math.cos(this.direction)*e,this.y+=Math.sin(this.direction)*e,this.findCollisions()}},this.draw=function(){this.style.top=this.y-this.height/2+"%",this.style.left=this.x-this.width/2+"%"},this.findCollisions=function(){for(var t=0;t<this.conflicts.length;t++)this.findCollisionsWith(this.conflicts[t])},this.findCollisionsWith=function(t){if(!this.dead)for(var e=new o(this),i=n(document,t),s=0;s<i.length;s++){var r=i[s];!r.dead&&e.overlaps(new o(r))&&(h(this,"collide").fire(i[s]),h(i[s],"collide").fire(this))}}},b=t("<ss:bullet></ss:bullet>",(function(){var t=this;this.speed=this.speed||60,this.conflicts=[x,_,w],h(this,"collide",(function(e){s(e,"SS.Enemy")&&t.destroy()})),this.init=function(){f.play(b.sound),a.addObject(this)},v.apply(this),e(this,"SS.Bullet")}));b.sound="audio/pew.mp3",f.prepare(b.sound);const x=t("<ss:enemy></ss:enemy>",(function(){v.apply(this);var t=this;this.speed=this.speed||30,this.width=11.7,this.height=11.7,this.visibleDirection=this.visibleDirection||0,this.rotationSpeed=30*(.4*Math.random()-.2),this.conflicts=[y],this._step=this.step,this.step=function({now:t,elapsed:e,elapsed_ms:i}){const s=e*this.rotationSpeed;this.visibleDirection=this.visibleDirection+s,this._step({now:t,elapsed:e,elapsed_ms:i})};var i=this.draw;this.draw=function(){u(this,Number(this.visibleDirection)+Math.PI/2),i.call(this)},this.explode=function(e,i){h(t,"shot").fire(),t.parentNode.appendChild(new C({x:t.x,y:t.y,text:void 0===e?t.game.score:e})),t.destroy()},h(this,"collide",(function(e){s(e,"SS.Bullet")&&t.explode(t.game.score+1,new M({direction:e.direction,speed:e.speed,mass:1}))})),this.init=function(){a.addObject(this)},e(this,"SS.Enemy")})),_=t("<ss:bigenemy></ss:bigenemy>",(function(){var t=this;if(x.apply(this),this.mass=5,this.scale=.09,this.subtype){var i=new Image;i.onload=function(){t.style.width=(i.width||100)*t.scale+"vmin",t.style.height=(i.height||100)*t.scale+"vmin"},i.src="img/"+this.subtype+".svg",this.style.backgroundImage="url('"+i.src+"')"}var s=this.explode;this.explode=function(t,e){if(s.call(this,t),!e)return;var i=new M({direction:this.direction,speed:this.speed,mass:this.mass});i.impactBy(e);const n=Math.floor(5*Math.random());i.speed=.75*i.speed/n;for(var r=0;r<n;r++)this.emitRandomShrapnel(i)},this.emitRandomShrapnel=function(t){const e=l;if(e.length>0){var i=e[Math.floor(Math.random()*e.length)];this.emitShrapnel(t,i)}},this.emitShrapnel=function(e,i){var s=new M({direction:Math.random()*Math.PI*2-Math.PI,speed:7.5,mass:1.5});s.impactBy(e);var n=new w({x:t.x,y:t.y,direction:s.direction,speed:s.speed,game:t.game,subtype:i});h(this,"shatter").fire(n)},e(this,"SS.BigEnemy")})),w=t("<ss:shrapnel></ss:shrapnel>",(function(){x.apply(this);var t=this;if(this.scale=.05,this.subtype){var i=new Image;i.onload=function(){t.style.width=(i.width||100)*t.scale+"vmin",t.style.height=(i.height||100)*t.scale+"vmin"},i.src="img/"+this.subtype+".svg",this.style.backgroundImage="url('"+i.src+"')"}e(this,"SS.Shrapnel")})),C=t("<ss:explosion>\n\t<table><tr><td data-id='text'></td></tr></table>\n</ss:explosion>",(function(){this.dead=!1,this.duration=this.duration||500,this.radius=this.radius||15,this.startTime=new Date,this.x=this.x||50,this.y=this.y||50,this.pct=0,this.destroy=function(){this.dead=!0,this.parentNode.removeChild(this),h(this,"destroy").fire()},this.step=function({now:t}){this.pct=Math.min(1,(t.getTime()-this.startTime.getTime())/this.duration),this.pct>.98&&this.destroy()},this.draw=function(){var t=this.pct*this.radius;this.style.width=t+"%",this.style.height=this.offsetWidth-30+"px",this.style.left=this.x-t/2+"%",this.style.top=this.y-t/2+"%",this.style.opacity=1-this.pct,this.style.filter="alpha(opacity="+100*(1-this.pct)+")",this.style.fontSize=.5*this.offsetWidth+"px"},this.init=function(){a.addObject(this),f.play(C.sound)}}));C.sound="audio/pkewh.mp3",f.prepare(C.sound);const M=function({direction:t,speed:e,mass:i}){this.direction=t||0,this.speed=e||0,this.mass=i||1,this.impactBy=function(t){var e=this.getXMomentum()+t.getXMomentum(),i=this.getYMomentum()+t.getYMomentum();this.direction=Math.atan2(i,e),this.speed=Math.sqrt(e*e+i*i)/this.mass},this.getXMomentum=function(){return Math.cos(this.direction)*this.speed*this.mass},this.getYMomentum=function(){return Math.sin(this.direction)*this.speed*this.mass}},N=t("<ss:gameoversplash>\n\t<div class='background'></div>\n\t<div class='foreground'>\n\t\t<h1 data-id='heading'>Game Over</h1>\n\t\t<div class='scoreline'>Your score: <span data-id='score' class='score'>...?</span></div>\n\t\t<div data-id='maxScoreLine' class='max-scoreline'>Your best: <span data-id='maxScore' class='score'>...?</span></div>\n\t\t<p><img src='img/shooty-ship.svg' style='width: 5em;' /></p>\n\t\t<p><i>\"The world is thy ship; not thy home.\"</i></p>\n\t\t<p>&ndash; St. Therese of Lisieux</p>\n\t\t<p>(And what better ship than a <b>shooty</b> ship.)</p>\n\t\t<ss:startbutton data-id='restart'>Restart</ss:startbutton>\n\t\t<tpdc:share data-id='share'></tpdc:share>\n\t\t<div class='copyright'><a target='_blank' href='https://www.thepointless.com'>www.thepointless.com</a></div>\n\t</div>\n</ss:gameoversplash>",(function(){var t=this;this.delay=this.delay||1e3;const e=parseInt(this.score)||0;0==e?this.share.parentNode.removeChild(this.share):this.share.object={text:`I scored ${e} in ${p}!`,category:"game"};let i=0;localStorage?(i=Math.max(parseInt(localStorage.getItem(c))||0,e),localStorage.setItem(c,i),t.maxScore=i):t.maxScoreLine.parentNode.removeChild(this.maxScoreLine),h(t.restart,"click",(function(){h(t,"restartClick").fire(),t.parentNode.removeChild(t)})),this.init=function(){setTimeout((function(){t.classList.add("visible")}),this.delay)}}))})()})();
//# sourceMappingURL=game.js.map