!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=19)}([function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){var i=n(13),o=n(14),r=n(15);t.exports=function(t){return i(t)||o(t)||r()}},function(t,e,n){var i=n(17),o=n(8);t.exports=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?o(t):e}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){var i=n(18);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}},function(t,e,n){var i=n(10),o=n(11),r=n(12);t.exports=function(t,e){return i(t)||o(t,e)||r()}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t){t.exports=JSON.parse('{"format":"BeepBox","version":7,"scale":"easy :)","key":"C","introBars":0,"loopBars":16,"beatsPerBar":8,"ticksPerBeat":4,"beatsPerMinute":180,"reverb":0,"channels":[{"type":"pitch","octaveScrollBar":3,"instruments":[{"type":"chip","volume":100,"effects":"none","preset":64,"transition":"seamless","chord":"arpeggio","filterCutoffHz":4000,"filterResonance":0,"filterEnvelope":"steady","wave":"square","interval":"union","vibrato":"none"}],"patterns":[{"instrument":1,"notes":[{"pitches":[55,57],"points":[{"tick":0,"pitchBend":0,"volume":100},{"tick":1,"pitchBend":0,"volume":100}]},{"pitches":[52,57],"points":[{"tick":2,"pitchBend":0,"volume":100},{"tick":3,"pitchBend":0,"volume":100}]},{"pitches":[52,57],"points":[{"tick":3,"pitchBend":0,"volume":100},{"tick":4,"pitchBend":0,"volume":100}]},{"pitches":[50,45],"points":[{"tick":4,"pitchBend":0,"volume":100},{"tick":5,"pitchBend":0,"volume":100}]},{"pitches":[57,52],"points":[{"tick":5,"pitchBend":0,"volume":100},{"tick":6,"pitchBend":0,"volume":100}]},{"pitches":[52,55],"points":[{"tick":8,"pitchBend":0,"volume":100},{"tick":11,"pitchBend":0,"volume":100},{"tick":12,"pitchBend":-3,"volume":100}]},{"pitches":[52,50],"points":[{"tick":12,"pitchBend":0,"volume":100},{"tick":16,"pitchBend":0,"volume":100}]},{"pitches":[57,50],"points":[{"tick":16,"pitchBend":0,"volume":100},{"tick":20,"pitchBend":0,"volume":100}]},{"pitches":[57,60],"points":[{"tick":20,"pitchBend":0,"volume":100},{"tick":24,"pitchBend":0,"volume":100}]},{"pitches":[60,57],"points":[{"tick":24,"pitchBend":0,"volume":100},{"tick":27,"pitchBend":0,"volume":100},{"tick":28,"pitchBend":-2,"volume":100}]},{"pitches":[62],"points":[{"tick":28,"pitchBend":0,"volume":100},{"tick":31,"pitchBend":0,"volume":100},{"tick":32,"pitchBend":-2,"volume":100}]}]},{"instrument":1,"notes":[{"pitches":[38],"points":[{"tick":0,"pitchBend":0,"volume":100},{"tick":2,"pitchBend":0,"volume":100}]},{"pitches":[40],"points":[{"tick":2,"pitchBend":0,"volume":100},{"tick":4,"pitchBend":0,"volume":100}]},{"pitches":[43],"points":[{"tick":4,"pitchBend":0,"volume":100},{"tick":6,"pitchBend":0,"volume":100}]},{"pitches":[52],"points":[{"tick":6,"pitchBend":0,"volume":100},{"tick":8,"pitchBend":0,"volume":100}]},{"pitches":[55],"points":[{"tick":8,"pitchBend":0,"volume":100},{"tick":12,"pitchBend":0,"volume":100}]},{"pitches":[50],"points":[{"tick":12,"pitchBend":0,"volume":100},{"tick":14,"pitchBend":0,"volume":100}]},{"pitches":[55],"points":[{"tick":14,"pitchBend":0,"volume":100},{"tick":15,"pitchBend":0,"volume":100}]},{"pitches":[52],"points":[{"tick":15,"pitchBend":0,"volume":100},{"tick":16,"pitchBend":0,"volume":100}]},{"pitches":[48],"points":[{"tick":16,"pitchBend":0,"volume":100},{"tick":20,"pitchBend":0,"volume":100}]},{"pitches":[45,50],"points":[{"tick":20,"pitchBend":0,"volume":100},{"tick":23,"pitchBend":0,"volume":100},{"tick":24,"pitchBend":5,"volume":100}]},{"pitches":[43,55],"points":[{"tick":24,"pitchBend":0,"volume":100},{"tick":28,"pitchBend":0,"volume":100}]},{"pitches":[52,40],"points":[{"tick":28,"pitchBend":0,"volume":100},{"tick":32,"pitchBend":0,"volume":100}]}]},{"instrument":1,"notes":[{"pitches":[52],"points":[{"tick":0,"pitchBend":0,"volume":100},{"tick":7,"pitchBend":0,"volume":100},{"tick":8,"pitchBend":3,"volume":100}]},{"pitches":[55],"points":[{"tick":8,"pitchBend":0,"volume":100},{"tick":16,"pitchBend":0,"volume":100}]},{"pitches":[52],"points":[{"tick":16,"pitchBend":0,"volume":100},{"tick":24,"pitchBend":0,"volume":100}]},{"pitches":[43],"points":[{"tick":24,"pitchBend":0,"volume":100},{"tick":28,"pitchBend":0,"volume":100}]},{"pitches":[45],"points":[{"tick":28,"pitchBend":0,"volume":100},{"tick":32,"pitchBend":0,"volume":100}]}]},{"instrument":1,"notes":[{"pitches":[64],"points":[{"tick":0,"pitchBend":0,"volume":100},{"tick":4,"pitchBend":0,"volume":100}]},{"pitches":[50],"points":[{"tick":4,"pitchBend":0,"volume":100},{"tick":8,"pitchBend":0,"volume":100}]},{"pitches":[62],"points":[{"tick":8,"pitchBend":0,"volume":100},{"tick":12,"pitchBend":0,"volume":100}]},{"pitches":[48],"points":[{"tick":12,"pitchBend":0,"volume":100},{"tick":16,"pitchBend":0,"volume":100}]},{"pitches":[55],"points":[{"tick":16,"pitchBend":0,"volume":100},{"tick":20,"pitchBend":0,"volume":100}]},{"pitches":[43],"points":[{"tick":20,"pitchBend":0,"volume":100},{"tick":24,"pitchBend":0,"volume":100}]},{"pitches":[55],"points":[{"tick":24,"pitchBend":0,"volume":100},{"tick":26,"pitchBend":0,"volume":100}]},{"pitches":[52],"points":[{"tick":26,"pitchBend":0,"volume":100},{"tick":30,"pitchBend":0,"volume":100}]},{"pitches":[50],"points":[{"tick":30,"pitchBend":0,"volume":100},{"tick":32,"pitchBend":0,"volume":100}]}]},{"instrument":1,"notes":[{"pitches":[69],"points":[{"tick":0,"pitchBend":0,"volume":100},{"tick":1,"pitchBend":0,"volume":100}]},{"pitches":[67],"points":[{"tick":1,"pitchBend":0,"volume":100},{"tick":2,"pitchBend":0,"volume":100}]},{"pitches":[69],"points":[{"tick":2,"pitchBend":0,"volume":100},{"tick":3,"pitchBend":0,"volume":100}]},{"pitches":[67],"points":[{"tick":3,"pitchBend":0,"volume":100},{"tick":4,"pitchBend":0,"volume":100}]},{"pitches":[45],"points":[{"tick":4,"pitchBend":0,"volume":100},{"tick":5,"pitchBend":0,"volume":100}]},{"pitches":[43],"points":[{"tick":5,"pitchBend":0,"volume":100},{"tick":6,"pitchBend":0,"volume":100}]},{"pitches":[40],"points":[{"tick":6,"pitchBend":0,"volume":100},{"tick":7,"pitchBend":0,"volume":100}]},{"pitches":[43],"points":[{"tick":7,"pitchBend":0,"volume":100},{"tick":8,"pitchBend":0,"volume":100}]},{"pitches":[57],"points":[{"tick":8,"pitchBend":0,"volume":100},{"tick":9,"pitchBend":0,"volume":100}]},{"pitches":[55],"points":[{"tick":9,"pitchBend":0,"volume":100},{"tick":11,"pitchBend":0,"volume":100},{"tick":12,"pitchBend":-3,"volume":100}]},{"pitches":[52],"points":[{"tick":12,"pitchBend":0,"volume":100},{"tick":13,"pitchBend":0,"volume":100}]},{"pitches":[55],"points":[{"tick":13,"pitchBend":0,"volume":100},{"tick":14,"pitchBend":0,"volume":100}]},{"pitches":[57],"points":[{"tick":14,"pitchBend":0,"volume":100},{"tick":15,"pitchBend":0,"volume":100}]},{"pitches":[60],"points":[{"tick":15,"pitchBend":0,"volume":100},{"tick":16,"pitchBend":0,"volume":100}]},{"pitches":[52],"points":[{"tick":16,"pitchBend":0,"volume":100},{"tick":17,"pitchBend":0,"volume":100}]},{"pitches":[55],"points":[{"tick":17,"pitchBend":0,"volume":100},{"tick":18,"pitchBend":0,"volume":100}]},{"pitches":[50],"points":[{"tick":18,"pitchBend":0,"volume":100},{"tick":19,"pitchBend":0,"volume":100}]},{"pitches":[52],"points":[{"tick":19,"pitchBend":0,"volume":100},{"tick":20,"pitchBend":0,"volume":100}]},{"pitches":[45],"points":[{"tick":20,"pitchBend":0,"volume":100},{"tick":21,"pitchBend":0,"volume":100}]},{"pitches":[43],"points":[{"tick":21,"pitchBend":0,"volume":100},{"tick":22,"pitchBend":0,"volume":100}]},{"pitches":[40],"points":[{"tick":22,"pitchBend":0,"volume":100},{"tick":23,"pitchBend":0,"volume":100}]},{"pitches":[38],"points":[{"tick":23,"pitchBend":0,"volume":100},{"tick":24,"pitchBend":0,"volume":100}]},{"pitches":[43],"points":[{"tick":24,"pitchBend":0,"volume":100},{"tick":25,"pitchBend":0,"volume":100}]},{"pitches":[45],"points":[{"tick":25,"pitchBend":0,"volume":100},{"tick":26,"pitchBend":0,"volume":100}]},{"pitches":[50],"points":[{"tick":26,"pitchBend":0,"volume":100},{"tick":27,"pitchBend":0,"volume":100}]},{"pitches":[52],"points":[{"tick":27,"pitchBend":0,"volume":100},{"tick":28,"pitchBend":0,"volume":100}]},{"pitches":[55],"points":[{"tick":28,"pitchBend":0,"volume":100},{"tick":31,"pitchBend":0,"volume":100},{"tick":32,"pitchBend":2,"volume":100}]}]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]}],"sequence":[2,1,1,2,3,2,3,2,4,2,1,5,5,1,5,4]},{"type":"pitch","octaveScrollBar":2,"instruments":[{"type":"harmonics","volume":40,"effects":"reverb","preset":644,"transition":"cross fade","chord":"harmony","filterCutoffHz":2828,"filterResonance":86,"filterEnvelope":"steady","interval":"union","vibrato":"shaky","harmonics":[86,100,100,86,71,57,29,14,14,14,29,43,43,43,29,14,14,14,0,0,0,0,0,0,0,0,0,0]}],"patterns":[{"instrument":1,"notes":[{"pitches":[40],"points":[{"tick":0,"pitchBend":0,"volume":100},{"tick":8,"pitchBend":0,"volume":100}]},{"pitches":[52],"points":[{"tick":8,"pitchBend":0,"volume":100},{"tick":16,"pitchBend":0,"volume":100}]},{"pitches":[45],"points":[{"tick":16,"pitchBend":0,"volume":100},{"tick":17,"pitchBend":0,"volume":100},{"tick":19,"pitchBend":-2,"volume":100},{"tick":24,"pitchBend":-2,"volume":100}]},{"pitches":[38],"points":[{"tick":24,"pitchBend":0,"volume":100},{"tick":32,"pitchBend":0,"volume":100}]}]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]}],"sequence":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},{"type":"pitch","octaveScrollBar":1,"instruments":[{"type":"harmonics","volume":80,"effects":"reverb","preset":320,"transition":"hard fade","chord":"strum","filterCutoffHz":4000,"filterResonance":14,"filterEnvelope":"twang 1","interval":"union","vibrato":"none","harmonics":[100,86,71,71,71,71,57,57,57,57,43,43,43,43,43,29,29,29,29,29,29,14,14,14,14,14,14,14]}],"patterns":[{"instrument":1,"notes":[{"pitches":[16],"points":[{"tick":0,"pitchBend":0,"volume":100},{"tick":3,"pitchBend":0,"volume":100}]},{"pitches":[16],"points":[{"tick":8,"pitchBend":0,"volume":100},{"tick":11,"pitchBend":0,"volume":100}]},{"pitches":[16],"points":[{"tick":12,"pitchBend":0,"volume":100},{"tick":13,"pitchBend":0,"volume":100}]},{"pitches":[16],"points":[{"tick":14,"pitchBend":0,"volume":100},{"tick":15,"pitchBend":0,"volume":100}]},{"pitches":[16],"points":[{"tick":16,"pitchBend":0,"volume":100},{"tick":17,"pitchBend":0,"volume":100}]},{"pitches":[16],"points":[{"tick":18,"pitchBend":0,"volume":100},{"tick":19,"pitchBend":0,"volume":100}]},{"pitches":[21],"points":[{"tick":20,"pitchBend":0,"volume":100},{"tick":21,"pitchBend":0,"volume":100}]},{"pitches":[21],"points":[{"tick":21,"pitchBend":0,"volume":100},{"tick":22,"pitchBend":0,"volume":100}]},{"pitches":[19],"points":[{"tick":24,"pitchBend":0,"volume":100},{"tick":25,"pitchBend":0,"volume":100}]},{"pitches":[19],"points":[{"tick":25,"pitchBend":0,"volume":100},{"tick":26,"pitchBend":0,"volume":100}]},{"pitches":[16],"points":[{"tick":28,"pitchBend":0,"volume":100},{"tick":29,"pitchBend":0,"volume":100}]},{"pitches":[16],"points":[{"tick":29,"pitchBend":0,"volume":100},{"tick":30,"pitchBend":0,"volume":100}]}]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]}],"sequence":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},{"type":"drum","octaveScrollBar":0,"instruments":[{"type":"drumset","volume":60,"effects":"reverb","preset":960,"drums":[{"filterEnvelope":"twang 1","spectrum":[57,71,71,86,86,86,71,71,71,71,57,57,57,57,43,43,43,43,29,29,29,29,29,29,29,29,29,29,29,29]},{"filterEnvelope":"twang 1","spectrum":[0,0,0,100,71,71,57,86,57,57,57,71,43,43,57,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43]},{"filterEnvelope":"twang 1","spectrum":[0,0,0,0,100,57,43,43,29,57,43,29,71,43,43,43,43,57,43,43,43,43,43,43,43,43,29,43,43,43]},{"filterEnvelope":"twang 1","spectrum":[0,0,0,0,0,71,57,43,43,43,57,57,43,29,57,43,43,43,29,43,57,43,43,43,43,43,43,29,43,43]},{"filterEnvelope":"decay 2","spectrum":[0,14,29,43,86,71,29,43,43,43,43,29,71,29,71,29,43,43,43,43,57,43,43,57,43,43,43,57,57,57]},{"filterEnvelope":"decay 1","spectrum":[0,0,14,14,14,14,29,29,29,43,43,43,57,57,57,71,71,71,71,71,71,71,71,57,57,57,57,43,43,43]},{"filterEnvelope":"twang 3","spectrum":[43,43,43,71,29,29,43,43,43,29,43,43,43,29,29,43,43,29,29,29,57,14,57,43,43,57,43,43,57,57]},{"filterEnvelope":"decay 3","spectrum":[29,43,43,43,43,29,29,43,29,29,43,29,14,29,43,29,43,29,57,29,43,57,43,71,43,71,57,57,71,71]},{"filterEnvelope":"twang 3","spectrum":[43,29,29,43,29,29,29,57,29,29,29,57,43,43,29,29,57,43,43,43,71,43,43,71,57,71,71,71,71,71]},{"filterEnvelope":"decay 3","spectrum":[57,57,57,43,57,57,43,43,57,43,43,43,71,57,43,57,86,71,57,86,71,57,86,100,71,86,86,86,86,86]},{"filterEnvelope":"flare 1","spectrum":[0,0,14,14,14,14,29,29,29,43,43,43,57,57,71,71,86,86,100,100,100,100,100,100,100,100,86,57,29,0]},{"filterEnvelope":"decay 2","spectrum":[14,14,14,14,29,14,14,29,14,43,14,43,57,86,57,57,100,57,43,43,57,100,57,43,29,14,0,0,0,0]}]}],"patterns":[{"instrument":1,"notes":[{"pitches":[0],"points":[{"tick":2,"pitchBend":0,"volume":100},{"tick":4,"pitchBend":0,"volume":0}]},{"pitches":[1],"points":[{"tick":4,"pitchBend":0,"volume":100},{"tick":6,"pitchBend":0,"volume":0}]},{"pitches":[0],"points":[{"tick":6,"pitchBend":0,"volume":100},{"tick":8,"pitchBend":0,"volume":0}]},{"pitches":[1],"points":[{"tick":10,"pitchBend":0,"volume":100},{"tick":12,"pitchBend":0,"volume":0}]},{"pitches":[0],"points":[{"tick":16,"pitchBend":0,"volume":100},{"tick":18,"pitchBend":0,"volume":0}]},{"pitches":[1],"points":[{"tick":20,"pitchBend":0,"volume":100},{"tick":22,"pitchBend":0,"volume":0}]},{"pitches":[1],"points":[{"tick":22,"pitchBend":0,"volume":100},{"tick":24,"pitchBend":0,"volume":0}]},{"pitches":[3],"points":[{"tick":24,"pitchBend":0,"volume":100},{"tick":26,"pitchBend":0,"volume":0}]},{"pitches":[1],"points":[{"tick":26,"pitchBend":0,"volume":100},{"tick":28,"pitchBend":0,"volume":0}]},{"pitches":[4],"points":[{"tick":28,"pitchBend":0,"volume":100},{"tick":30,"pitchBend":0,"volume":0}]},{"pitches":[3],"points":[{"tick":30,"pitchBend":0,"volume":100},{"tick":32,"pitchBend":0,"volume":0}]}]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]},{"instrument":1,"notes":[]}],"sequence":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}]}')},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var c,a=t[Symbol.iterator]();!(i=(c=a.next()).done)&&(n.push(c.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return n}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e,n){},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=i=function(t){return n(t)}:t.exports=i=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},i(e)}t.exports=i},function(t,e){function n(e,i){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,i)}t.exports=n},function(t,e,n){"use strict";n.r(e);var i=n(6),o=n.n(i),r=n(5),c=n.n(r),a=n(1),s=n.n(a),u=(n(16),n(0)),p=n.n(u),l=function t(){return p()(this,t),{_count:20,_last:[],get:function(){return this._last.reduce((function(t,e){return t+e}),0)/this._count},add:function(t){this._last.unshift(t),this._last=this._last.slice(0,this._count)}}},h=n(2),m=n.n(h),d=n(3),v=n.n(d),f=n(8),B=n.n(f),k=n(4),y=n.n(k),b=n(7),g=n.n(b),x={identity:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},perspective:function(t,e,n,i){var o=Math.tan(.5*Math.PI-.5*t),r=1/(n-i);return[o/e,0,0,0,0,o,0,0,0,0,(n+i)*r,-1,0,0,n*i*r*2,0]},addVectors:function(t,e){var n=new Float32Array(3);return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n},subtractVectors:function(t,e){var n=new Float32Array(3);return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n},normalize:function(t){var e=new Float32Array(3),n=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return n>1e-5&&(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n),e},cross:function(t,e){var n=new Float32Array(3);return n[0]=t[1]*e[2]-t[2]*e[1],n[1]=t[2]*e[0]-t[0]*e[2],n[2]=t[0]*e[1]-t[1]*e[0],n},multiply:function(t,e){var n=t[0],i=t[1],o=t[2],r=t[3],c=t[4],a=t[5],s=t[6],u=t[7],p=t[8],l=t[9],h=t[10],m=t[11],d=t[12],v=t[13],f=t[14],B=t[15],k=e[0],y=e[1],b=e[2],g=e[3],x=e[4],_=e[5],w=e[6],M=e[7],A=e[8],O=e[9],E=e[10],P=e[11],R=e[12],S=e[13],j=e[14],T=e[15];return[k*n+y*c+b*p+g*d,k*i+y*a+b*l+g*v,k*o+y*s+b*h+g*f,k*r+y*u+b*m+g*B,x*n+_*c+w*p+M*d,x*i+_*a+w*l+M*v,x*o+_*s+w*h+M*f,x*r+_*u+w*m+M*B,A*n+O*c+E*p+P*d,A*i+O*a+E*l+P*v,A*o+O*s+E*h+P*f,A*r+O*u+E*m+P*B,R*n+S*c+j*p+T*d,R*i+S*a+j*l+T*v,R*o+S*s+j*h+T*f,R*r+S*u+j*m+T*B]},copy:function(t){var e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},translation:function(t,e,n){return[1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1]},xRotation:function(t){var e=Math.cos(t),n=Math.sin(t);return[1,0,0,0,0,e,n,0,0,-n,e,0,0,0,0,1]},yRotation:function(t){var e=Math.cos(t),n=Math.sin(t);return[e,0,-n,0,0,1,0,0,n,0,e,0,0,0,0,1]},zRotation:function(t){var e=Math.cos(t),n=Math.sin(t);return[e,n,0,0,-n,e,0,0,0,0,1,0,0,0,0,1]},scaling:function(t,e,n){return[t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1]},translate:function(t,e,n,i,o){o=o||new Float32Array(16);var r=t[0],c=t[1],a=t[2],s=t[3],u=t[4],p=t[5],l=t[6],h=t[7],m=t[8],d=t[9],v=t[10],f=t[11],B=t[12],k=t[13],y=t[14],b=t[15];return t!==o&&(o[0]=r,o[1]=c,o[2]=a,o[3]=s,o[4]=u,o[5]=p,o[6]=l,o[7]=h,o[8]=m,o[9]=d,o[10]=v,o[11]=f),o[12]=r*e+u*n+m*i+B,o[13]=c*e+p*n+d*i+k,o[14]=a*e+l*n+v*i+y,o[15]=s*e+h*n+f*i+b,o},xRotate:function(t,e){return this.multiply(t,this.xRotation(e))},yRotate:function(t,e){return this.multiply(t,this.yRotation(e))},zRotate:function(t,e){return this.multiply(t,this.zRotation(e))},scale:function(t,e,n,i){return this.multiply(t,this.scaling(e,n,i))},getScale:function(t){return[t[0],t[5],t[10]]},getTranslation:function(t){return[t[12],t[13],t[14]]}};function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(n,!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.parent,i=e.translation,o=void 0===i?[0,0,0]:i,r=e.rotation,c=void 0===r?[0,0,0]:r,a=e.scale,s=void 0===a?[1,1,1]:a,u=e.components,l=void 0===u?[]:u,h=e.data,m=void 0===h?[]:h,d=e.normals,v=void 0===d?[]:d;p()(this,t),this.id="".concat(parseInt(1e7*Math.random())).concat(parseInt(1e7*Math.random())),this.localMatrix=x.identity(),this.worldMatrix=x.identity(),this.components=l,this.translation=o,this.rotation=c,this.scale=s,this.data=m,this.normals=v,n&&this.setParent(n),this.setMatrix(),this._localMatrix=this.localMatrix,this._worldMatrix=this.worldMatrix,this._boundingbox=this.getBoundingBox(),this.boundingbox=Object.assign({},this._boundingbox)}return g()(t,[{key:"intersects",value:function(t){var e=this.boundingbox,n=t.boundingbox,i=e.min.x<=n.max.x&&e.max.x>=n.min.x,o=e.min.y<=n.max.y&&e.max.y>=n.min.y,r=e.min.z<=n.max.z&&e.max.z>=n.min.z;return i&&o&&r}},{key:"getBoundingBox",value:function(){if(this.data){for(var t,e=this.data.slice(0),n=[];0!==(t=e.splice(0,3)).length;)n.push([t[0],t[1],t[2]]);var i=[0,0,0],o=[0,0,0];return n.forEach((function(t){var e=c()(t,3),n=e[0],r=e[1],a=e[2];i[0]=Math.min(i[0],n),i[1]=Math.min(i[1],r),i[2]=Math.min(i[2],a),o[0]=Math.max(o[0],n),o[1]=Math.max(o[1],r),o[2]=Math.max(o[2],a)})),{min:{x:i[0],y:i[1],z:i[2]},max:{x:o[0],y:o[1],z:o[2]}}}}},{key:"updateBoundingBox",value:function(t){var e=c()(t,3),n=e[0],i=e[1],o=e[2],r=Object.assign({},this._boundingbox);return{min:{x:n+r.min.x,y:i+r.min.y,z:o+r.min.z},max:{x:n+r.max.x,y:i+r.max.y,z:o+r.max.z}}}},{key:"physics",value:function(t,e){}},{key:"setParent",value:function(t){this.parent&&this.parent.removeComponent(this),this.parent=t,this.parent.addComponent(this)}},{key:"removeComponent",value:function(t){var e=this.components.indexOf(t);-1!==e&&this.components.splice(e,1)}},{key:"addComponent",value:function(t){this.components.push(t)}},{key:"render",value:function(t){var e=t.camera;this.shader&&this.shader.render(this,{camera:e}),this.components.forEach((function(t){return t.render&&t.render({camera:e})}))}},{key:"update",value:function(t){}},{key:"updateWorldMatrix",value:function(t){var e=this;this.worldMatrix=t?x.multiply(t,this.localMatrix):this.localMatrix.slice(0),this.components.forEach((function(t){return t.updateWorldMatrix(e.worldMatrix)}))}},{key:"setMatrix",value:function(){this.localMatrix=x.translation.apply(x,s()(this.translation)),this.localMatrix=x.scale.apply(x,[this.localMatrix].concat(s()(this.scale))),this.localMatrix=x.xRotate(this.localMatrix,this.rotation[0]),this.localMatrix=x.yRotate(this.localMatrix,this.rotation[1]),this.localMatrix=x.zRotate(this.localMatrix,this.rotation[2])}}]),t}(),A=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.speed,o=void 0===i?5:i,r=n.translation,c=n.rotation,a=n.scale,s=n.parent,u=n.components;return p()(this,e),(t=m()(this,v()(e).call(this,{translation:r,rotation:c,scale:a,parent:s,components:u}))).speed=o,t}return y()(e,t),e}(M),O=function(t){return{createShader:function(e,n){var i=t.createShader(e);if(t.shaderSource(i,n),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))return i;console.log(t.getShaderInfoLog(i)),t.deleteShader(i)},createProgram:function(e,n){var i=t.createProgram();if(t.attachShader(i,e),t.attachShader(i,n),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS))return i;console.log(t.getProgramInfoLog(i)),t.deleteProgram(i)},getAttributes:function(e,n){var i={};return n.forEach((function(n){n.startsWith("a_")?i[n]=t.getAttribLocation(e,n):n.startsWith("u_")&&(i[n]=t.getUniformLocation(e,n))})),i}}};function E(t){return t=t.toString(),"".concat(1===t.length?"0".concat(t):t)}function P(){try{return localStorage.getItem("score")||0}catch(t){return 0}}function R(t,e){for(var n=[],i=0;i<e;i++)n=n.concat(t);return n.flat()}function S(t,e){if((Math.random(),Math.random())<t)return e()}function j(t){t._worldMatrix!=t.worldMatrix&&(t._worldMatrix=t.worldMatrix,t.boundingbox=t.updateBoundingBox(x.getTranslation(t.worldMatrix)))}function T(t){return document.querySelector(t)}var F=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.up,o=void 0===i?[0,1,0]:i,r=n.target,c=void 0===r?[0,0,-1]:r,a=n.aspect,s=void 0===a?1:a,u=n.fieldOfViewRadians,l=void 0===u?60*Math.PI/180:u,h=n.zNear,d=void 0===h?1:h,f=n.zFar,B=void 0===f?2e3:f,k=n.speed,y=void 0===k?.1:k,b=n.translation,g=n.rotation,x=n.scale;return p()(this,e),(t=m()(this,v()(e).call(this,{translation:b,rotation:g,scale:x}))).up=o,t.target=c,t.fieldOfViewRadians=l,t.aspect=s,t.zNear=d,t.zFar=B,t.speed=y,t}return y()(e,t),g()(e,[{key:"getProjectionMatrix",value:function(){return x.perspective(this.fieldOfViewRadians,this.aspect,this.zNear,this.zFar)}}]),e}(M),C={107:7902.13,106:7458.62,105:7040,104:6644.88,103:6271.93,102:5919.91,101:5587.65,100:5274.04,99:4978.03,98:4698.63,97:4434.92,96:4186.01,95:3951.07,94:3729.31,93:3520,92:3322.44,91:3135.96,90:2959.96,89:2793.83,88:2637.02,87:2489.02,86:2349.32,85:2217.46,84:2093,83:1975.53,82:1864.66,81:1760,80:1661.22,79:1567.98,78:1479.98,77:1396.91,76:1318.51,75:1244.51,74:1174.66,73:1108.73,72:1046.5,71:987.77,70:932.33,69:880,68:830.61,67:783.99,66:739.99,65:698.46,64:659.25,63:622.25,62:587.33,61:554.37,60:523.25,59:493.88,58:466.16,57:440,56:415.3,55:392,54:369.99,53:349.23,52:329.63,51:311.13,50:293.66,49:277.18,48:261.63,47:246.94,46:233.08,45:220,44:207.65,43:196,42:185,41:174.61,40:164.81,39:155.56,38:146.83,37:138.59,36:130.81,35:123.47,34:116.54,33:110,32:103.83,31:98,30:92.5,29:87.31,28:82.41,27:77.78,26:73.42,25:69.3,24:65.41,23:61.74,22:58.27,21:55,20:51.91,19:49,18:46.25,17:43.65,16:41.2,15:38.89,14:36.71,13:34.65,12:32.7,11:30.87,10:29.14,9:27.5,8:25.96,7:24.5,6:23.12,5:21.83,4:20.6,3:19.45,2:18.35,1:17.32,0:16.35};class I{constructor(t,e=.2){this.song=t,this.volume=e,this.context=new(window.AudioContext||window.webkitAudioContext),this._volume=this.context.createGain(),this._volume.connect(this.context.destination),this._volume.gain.value=this.volume}static generateNode(t,e){const n={notes:t,stop:()=>t.forEach(t=>t.stop())};let i={};return e&&(i.last=e),Object.assign({},i,n)}play(){let t,e,n=[],i=1e3/(this.song.beatsPerMinute/60)/1e3/4;this.song.channels.forEach(o=>{let[r]=o.instruments;o.sequence.forEach((c,a)=>{[].concat({instrument:1,notes:[]},o.patterns)[c].notes.forEach(o=>{o.pitches.forEach(c=>{let[s,u]=o.points;if(!C[c])return;let p=(u.tick-s.tick)*i,l=i*s.tick+32*a*i,h=l+p,m=this.note(C[c],p,l,r.wave,.1);e||(e=h),t||(t=m),h>=e&&(e=h,t=m),n.push(m)})})})});const[o]=t.notes;return I.generateNode(n,o)}loop(){let t=this.play();return t.last&&(t.last.onended=()=>Object.assign(t,this.play())),t}note(t=440,e=.1,n=0,i="sine",o=.2){let r=this.context.createGain();r.connect(this.context.destination),r.gain.value=o;let c=this.context.createOscillator();c.frequency.value=t,c.type=i;let a=this.context.currentTime;return c.connect(r),c.start(a+n),c.stop(a+n+e),I.generateNode([c])}}var z=n(9);function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}var D,V,W,N,U,q,H,Y,G=new l,K=new l,X=1,J=new I,Q=0,Z=T("canvas"),$=T("#debug"),tt=T("#time"),et=T("#old"),nt=T("#new"),it=T(".popup"),ot=T("#replay"),rt=T("#music"),ct=Z.getContext("webgl2");ct||alert("Webgl2 is required to view this page. Please use another browser!");var at,st={Basic:function(t){var e=O(t),n=e.createShader,i=e.createProgram,o=e.getAttributes,r=i(n(t.VERTEX_SHADER,"#version 300 es\nin vec4 a_position;\nuniform mat4 u_model;\nuniform mat4 u_view;\nuniform mat4 u_projection;\nvoid main() {\n  gl_Position = u_projection * inverse(u_view) * u_model * a_position;\n}\n"),n(t.FRAGMENT_SHADER,"#version 300 es\nprecision mediump float;\nuniform vec4 u_color;\nout vec4 outColor;\nvoid main() {\n  outColor = u_color;\n}\n")),c=o(r,["a_position","u_color","u_model","u_view","u_projection"]),a=t.FLOAT;return{program:r,attributes:c,init:function(e){var n=t.createVertexArray(),i=t.createBuffer();return t.bindVertexArray(n),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.data),t.STATIC_DRAW),t.vertexAttribPointer(c.a_position,3,a,!1,0,0),t.enableVertexAttribArray(c.a_position),{vao:n,vbo:i}},render:function(e,n){var i=n.camera;t.useProgram(r),t.bindVertexArray(e.vao),t.uniform4f.apply(t,[c.u_color].concat(s()(e.color))),t.uniformMatrix4fv(c.u_model,!1,e.worldMatrix),t.uniformMatrix4fv(c.u_view,!1,i.worldMatrix),t.uniformMatrix4fv(c.u_projection,!1,i.getProjectionMatrix()),t.drawArrays(t.TRIANGLES,0,e.data.length/3)}}}(at=ct),Lighted:function(t){var e=O(t),n=e.createShader,i=e.createProgram,o=e.getAttributes,r=i(n(t.VERTEX_SHADER,"#version 300 es\nin vec4 a_position;\nin vec4 a_color;\nin vec3 a_normal;\nuniform mat4 u_model;\nuniform mat4 u_view;\nuniform mat4 u_projection;\nout vec4 v_color;\nout vec3 v_normal;\nvoid main() {\n  gl_Position = u_projection * inverse(u_view) * u_model * a_position;\n  v_color = a_color;\n  v_normal = mat3(u_model) * a_normal;\n}\n"),n(t.FRAGMENT_SHADER,"#version 300 es\nprecision mediump float;\nin vec4 v_color;\nin vec3 v_normal;\nuniform vec3 u_light;\nuniform vec3 u_ambient_light;\nout vec4 outColor;\nvoid main() {\n  float light = dot(normalize(u_light), normalize(v_normal));\n  outColor = v_color;\n  outColor.rgb *= light + u_ambient_light;\n}\n")),c=o(r,["a_position","a_color","a_normal","u_ambient_light","u_light","u_model","u_view","u_projection"]),a=t.FLOAT;return{program:r,attributes:c,init:function(e){var n=t.createVertexArray(),i=t.createBuffer(),o=t.createBuffer(),r=t.createBuffer();return t.bindVertexArray(n),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.data),t.STATIC_DRAW),t.vertexAttribPointer(c.a_position,3,a,!1,0,0),t.enableVertexAttribArray(c.a_position),t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.color),t.STATIC_DRAW),t.vertexAttribPointer(c.a_color,4,a,!1,0,0),t.enableVertexAttribArray(c.a_color),t.bindBuffer(t.ARRAY_BUFFER,r),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e.normals),t.STATIC_DRAW),t.vertexAttribPointer(c.a_normal,3,a,!1,0,0),t.enableVertexAttribArray(c.a_normal),{vao:n,vbo:i,vbo_color:o,vbo_normals:r}},render:function(e,n){var i=n.camera;t.useProgram(r),t.bindVertexArray(e.vao),t.uniform3fv(c.u_ambient_light,[.4,.4,.4]),t.uniform3fv(c.u_light,[0,1,0]),t.uniformMatrix4fv(c.u_model,!1,e.worldMatrix),t.uniformMatrix4fv(c.u_view,!1,i.worldMatrix),t.uniformMatrix4fv(c.u_projection,!1,i.getProjectionMatrix()),t.drawArrays(t.TRIANGLES,0,e.data.length/3)}}}(at)},ut=st.Lighted,pt=function(t){t.gl;var e=t.Basic,n=function(t){function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=i.translation,r=i.rotation,c=i.scale,a=i.data,u=i.color,l=void 0===u?[Math.random(),Math.random(),Math.random(),1]:u,h=i.update,d=void 0===h?function(){}:h,f=i.shader,k=void 0===f?e:f,y=i.parent,b=i.normals,g=i.components;if(p()(this,n),(t=m()(this,v()(n).call(this,{parent:y,components:g,translation:o,rotation:r,scale:c,data:a,normals:b}))).color=l,3===t.color.length&&(t.color.push(1),k!=e)){var x=parseInt(t.data.length/3),_=t.color.slice(0);t.color=[];for(var w=0;w<x;w++){var M;t.color=(M=t.color).concat.apply(M,s()(_))}}t.update=d,t.shader=k;var A=t.shader.init(B()(t)),O=A.vao,E=A.vbo,P=A.vbo_color,R=A.vbo_normals;return t.vao=O,t.vbo=E,t.vbo_color=P,t.vbo_normals=R,t}return y()(n,t),n}(M);return{Node:M,Primitive:n,Cube:function(t){function e(t){return p()(this,e),m()(this,v()(e).call(this,w({data:[-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],normals:[-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]},t)))}return y()(e,t),e}(n),Plane:function(t){function e(t){return p()(this,e),m()(this,v()(e).call(this,w({data:[-.5,0,.5,.5,0,-.5,-.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5],normals:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]},t)))}return y()(e,t),e}(n)}}({Basic:st.Basic}),lt=pt.Node,ht=pt.Cube,mt=pt.Plane,dt=(pt.Axis,new lt),vt=new F({translation:[0,2,4],rotation:[0,0,0],aspect:ct.canvas.clientWidth/ct.canvas.clientHeight}),ft=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.right,n=void 0===e?"ArrowRight":e,i=t.left,o=void 0===i?"ArrowLeft":i,r=t.canvas,c={};return document.addEventListener("keydown",(function(t){c[t.code]=!0})),document.addEventListener("keyup",(function(t){c[t.code]=!1})),{right:n,left:o,keys:c,canvas:r,getKeys:function(){return c},getMovement:function(){var t=0;return c[n]&&(t=1),c[o]&&(t=-1),[t,0,0]},updateWorldMatrix:function(){}}}({canvas:Z}),Bt=new A({parent:dt,components:[vt,ft],translation:[0,.5,0],rotation:[0,0,0]}),kt=new ht({parent:Bt,shader:ut,translation:[0,0,0],color:R([.3,.1,.2,1],36)});kt.tag="player",kt.physics=function(t,e){var n=kt;j(n),e.filter((function(t){return t.id!==n.id&&t.hasOwnProperty("boundingbox")})).forEach((function(t){t.rigid&&["obstacles","pickups","boosts"].includes(t.tag)&&(j(t),n.intersects(t)&&(t.tag.startsWith("obstacle")?(V=!1,J.note(440,.1),J.note(311.13,.1,.1),J.note(220,.4,.2)):t.tag.startsWith("pickup")?(q+=.1,U=200,N=parseInt(N+100*q*(H>0?2:1)),dt.removeComponent(t.parent),J.note(440,.2)):t.tag.startsWith("boosts")&&(H+=200,dt.removeComponent(t.parent),J.note(523.25,.3))))}))},ft.update=function(t){var e=Bt.speed*(t/1e3),n=ft.getMovement().map((function(t){return t*e})),i=x.translate.apply(x,[Bt.localMatrix].concat(s()(n))),o=x.getTranslation(i),r=c()(o,3),a=r[0];r[1],r[2];a<4&&a>-4&&(Bt.localMatrix=x.translate.apply(x,[Bt.localMatrix].concat(s()(n))));var u=ft.getKeys().Escape;Q<0&&u&&(Q=250,T("#debug").classList.toggle("hide")),Q-=t};var yt={obstacles:[],pickups:[],boosts:[]},bt=[],gt=[],xt=[];function _t(t,e,n){var i=n<1e4?n/1e4*-80-20:-100,r=new lt({parent:dt,translation:[9*Math.random()-4.5,.5,i]}),c=X?50+50*Math.random():100;r.update=function(t){r.localMatrix=x.translate(r.localMatrix,0,0,t/(H>0?c/2:c))};var a=new ht(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(n,!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({parent:r,translation:[0,0,0],shader:ut},e));return a.rigid=!0,a.tag=t,yt[t].push(r),r}function wt(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;return yt[t].filter((function(t){return!(!n||e)||(x.getTranslation(t.localMatrix)[2]<=10&&!e?(n=!0,t):(dt.removeComponent(t),!1))}))}function Mt(){return new I(z)}function At(){"running"===D.context.state?D.context.suspend():D.context.resume(),rt.classList.toggle("off")}function Ot(t){t>P()&&function(t){try{localStorage.setItem("score",t)}catch(e){return t}}(t),"running"===D.context.state&&(D.context.suspend(),D=Mt()),it.classList.toggle("hide")}function Et(){it.classList.toggle("hide"),Pt(),Vt()}function Pt(){rt.onclick=rt.onclick||At,ot.onclick=ot.onclick||Et,D&&D.context.close(),(D=Mt()).loop(),rt.classList.contains("off")&&D.context.suspend(),Bt.setMatrix(),yt[bt]=wt("obstacles",!0),yt[gt]=wt("pickups",!0),yt[xt]=wt("boosts",!0),H=0,q=0,U=0,W=P(),N=0,Y=void 0,V=!0}var Rt={color:R([1,0,0,1],36)},St={color:R([0,1,0,1],36),scale:[.5,.5,.5]},jt={color:R([1,1,0,1],36),scale:[.3,.3,.3]},Tt=0,Ft=0,Ct=1;new mt({parent:dt,translation:[0,0,-220],scale:[10,1,500],color:[.7,.7,.7]}),new mt({parent:dt,translation:[-5,1,-220],rotation:[0,0,-1],scale:[2,3,500],color:[.3,.3,.3]}),new mt({parent:dt,translation:[5,1,-220],rotation:[0,0,1],scale:[2,3,500],color:[.3,.3,.3]});var It,zt,Lt=0,Dt=0;function Vt(){var t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return V?(void 0===Y&&0!==n&&(Y=n),Dt=n-Y||0,t=(It=n-Lt)/10,H>0?H-=t:H=0,function(t){U>0?U-=t:q=1}(It/10),ct.viewport(0,0,ct.canvas.width,ct.canvas.height),ct.enable(ct.CULL_FACE),ct.enable(ct.DEPTH_TEST),ct.clearColor(0,0,0,1),ct.clear(ct.COLOR_BUFFER_BIT|ct.DEPTH_BUFFER_BIT),dt.updateWorldMatrix(),(zt=function t(e){return(e.components||[]).concat((e.components||[]).map((function(e){return t(e)})).flat())}(dt)).forEach((function(t){t.update&&t.update(It),t.physics&&t.physics(It,zt),t.render&&t.render({camera:vt})})),yt[bt]=wt("obstacles"),yt[gt]=wt("pickups"),yt[xt]=wt("boosts"),Tt=.002*(Ct=(H>0?2:1)+(e=Dt)/15e3*.5),Ft=.004*Ct,S(.006*Ct,(function(){return _t("pickups",St,e)}))||S(Ft,(function(){return _t("obstacles",Rt,e)}))||S(Tt,(function(){return _t("boosts",jt,e)})),$&&(G.add(1e3/It),K.add(It),$.innerText="frame ms: ".concat(K.get(),"\n    fps: ").concat(G.get(),"\n    obstacles: ").concat(yt[bt].length,"\n    pickups: ").concat(yt[gt].length,"\n    boosts: ").concat(yt[xt].length,"\n    running: ").concat(V,"\n    time: ").concat(parseInt(n/1e3),"\n    sessionTime: ").concat(parseInt(Dt/1e3),"\n    startOffset: ").concat(Y,"\n    boost: ").concat(parseInt(H),"\n    multiplier: ").concat(Ct,"\n    pickup multiplier: ").concat(q,"\n    pickup countdown: ").concat(U,"\n    highscore: ").concat(W,"\n    points: ").concat(N,"\n    "),tt.innerText="".concat(E(parseInt(Dt/6e4)),":").concat(E(parseInt(Dt/1e3)%60),":").concat(E(parseInt(Dt)%100)),et.innerText="Top: ".concat(N>W?N:W),nt.innerText="Score: ".concat(N)),Lt=n,requestAnimationFrame(Vt)):Ot(N)}Pt(),Vt(),V=!1}]);