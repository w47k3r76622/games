let a,e=()=>Math.atan2(a[0][0]-a[1][0],a[0][1]-a[1][1]),l=0,t=(a,e)=>{if(!l)return 0;let t=[a,e].map(a=>l10(0,512,Math.round(512*a/100)));return 10*l[t[0]+512*t[1]]},b=(a,e)=>{if(!l)return[0,1,0];let b=t(a,e),n=t(a+100/512,e),i=t(a,e+100/512);return l19(l16([0,i-b,100/512],[100/512,n-b,0]))},n=(a,e,l)=>{let n=0;return a[1]>9.3&&(a[1]=9.3,l&&l()),t(a[0],a[2])>a[1]-.7&&(n=b(a[0],a[2])),[.707,1].map(e=>{for(let l=0;6>l;l+=Math.PI/4){let i=a[0]+.7*e*Math.cos(l),r=a[2]+.7*e*Math.sin(l);t(i,r)>a[1]-.7*(e>.8?0:e)&&(n=b(i,r))}}),n&&0>=l15(e,n)?(a[0]+=.2*n[0],a[1]+=.2*n[1],a[2]+=.2*n[2],l17(e,n,1.5)):0},i=0,r={},c=a=>{let e={a2:a.a2,a4:a.a4,aw:a.aw};a.a4.forEach(l=>{e.bx=l.cb,e.ba=a.ba.concat(l.ba),r[l.cb].emit(0,e)})},h=a=>{a.ba=[],a.a2>0&&a.a4.length>1&&a.a2--,a.a4.forEach(e=>{f(a,e,a.a2)}),a.aw.forEach(a=>{a.aj=l11(a.aj,a.ai)}),a.aw=a.aw.filter(a=>{let e=0,l=n(a.aj,a.ai,()=>e=1);return!e&&!l}),a.a4.sort((a,e)=>e.c3+e.a7-(a.c3+a.a7)),a.a4.map((a,e)=>a.bl=e+1)},f=(e,l,t)=>{let b,r;l.ba=[],l.c9&&(l.ae=[]),l.bd>0&&l.bd--;let c=l.ae.indexOf(32)>=0;c&&!l.af&&l.ba.push(2),l.af=c;let h=()=>Math.random()-.5;if(1>t){c?l.ah=.32:l.ah>.15&&(l.ah-=.03);let a=(a,e,t,b,n,i,r,c)=>{0>l.ae.indexOf(t)?0>l.ae.indexOf(b)?c?l[e]=l[a]*(.93-1):l[e]*=.9:(l[e]>0&&(l[e]=0),l[e]-=r):(0>l[e]&&(l[e]=0),l[e]+=r),l[e]=Math.max(Math.min(l[e],i),-i),l[a]+=l[e],l[a]=Math.max(Math.min(l[a],n),-n)};a("bn","ag",40,38,1,.03,.003,0),a("br","av",37,39,1.3,.06,.004,1),l.c5+=.04*l.br;let t=l1g(l.c5,l.bn,l.br),f=l1eVec3(t,[0,0,-.01]);if(l.ai=l11(l.ai,f),l18(l.ai)>l.ah&&(l.ai=l19(l.ai).map(a=>a*l.ah)),l.aj=l11(l.aj,l.ai),l.c9).5>l.bn&&(l.bn+=.05);else{let a=n(l.aj,l.ai,()=>l.bn=-.1);a&&(l.ai=a.map(a=>.4*a),l.ba.push(0),l.ad=1)}if(b=l12(l.aj,l19(l.ai).map(a=>a*(c?1.5:1))),r=l1g(l.c5,l.bn,0),l.a6>0)l.a6--;else if(l.ae.indexOf(90)>=0){l.a6=3;let a=l1g(l.c5+.05*h(),l.bn+.05*h(),0);e.aw.push({cb:"b"+i++,b1:l.cb,aj:l.aj.map(a=>a),ak:a.map(a=>a),ai:l1eVec3(a,[0,0,-1])}),l.ba.push(1)}e.aw.forEach(a=>{a.b1!=l.cb&&1>l18(l12(a.aj,l.aj))&&(l.ai=l.ai.map(a=>.6*a),l.ba.push(0),l.ad=1,l.bd=10)})}else 0>l.ae.indexOf(40)||(l.am+=.1),0>l.ae.indexOf(38)||(l.am-=.1),0>l.ae.indexOf(39)||(l.b7-=.1),0>l.ae.indexOf(37)||(l.b7+=.1),r=l1g(l.b7,l.am,0),b=l11(l.aj,l1eVec3(r,[0,0,1]));b[1]+=.5,l.bc=l13(l.bc,b,.3),l.b6=l1e(l1g(.2*h()*l.ad,.2*h()*l.ad,.2*h()*l.ad),l13(l.b6,r,.3)),l.ad*=.9,l.a7=(e=>a.map((a,l,t,b)=>(t=e[0]-100*a[0],b=e[2]-100*a[1],[t*t+b*b,l])).sort((a,e)=>e[0]-a[0]).pop()[1]/a.length)(l.aj);for(let a=0;3>a;++a)l.ab==a&&l.a7>(a+1)/4&&(a+2)/4>l.a7&&(l.ab=a+1);3==l.ab&&.25>l.a7&&l.a7>=0&&(l.ab=0,3>++l.c3||(l.c3=3,l.c9=l.bl))},d={},o=1,m=0,p=0,s=()=>{let a=0,e=[];for(let l in d)1>d[l].a4.length?e.push(l):a++;e.forEach(a=>{delete d[a]}),1>a&&p&&(clearInterval(p),p=0),a>0&&!p&&(p=setInterval(()=>{if(m)for(let a in d)h(d[a]),c(d[a])},33))};var u,x;module.exports=(t=>{let b=a=>{m?a():setTimeout(()=>b(a),100)};b(()=>{t.on(6,l=>{if(d[l]||(d[l]={bx:0,a2:990,a4:[],aw:[]}),1>d[l].a2)return void t.emit(7);let b=((l,t,b)=>{let n={ae:[],cb:b,aj:(l=>l1eVec3(l1d([0,1,0],e()),[.8*(l%2*2-1),8-1.6*(l/2|0),0]).map((e,l)=>e+100*(1==l?0:a[0][l/2])))(l.a4.length),c5:e(),bn:0,br:0,bc:[0,0,0],b6:[0,0,0,1],ad:0,av:0,ag:0,ai:[0,0,0],a6:0,ah:.15,bl:0,ab:0,c3:0,bd:0,b7:e(),am:0};return r[b]=t,l.a4.push(n),l.a2=990,n})(d[l],t,o++);s(),t.on(1,a=>{0>b.ae.indexOf(a)&&b.ae.push(a)}),t.on(2,a=>{let e=b.ae.indexOf(a);0>e||b.ae.splice(e,1)}),t.on("disconnect",()=>{(u=d[l]).a4.splice(u.a4.indexOf(x=b),1),delete r[x.cb],s()})}),t.emit(5)}),m||(t.on(4,e=>{m||(m=1,(a=>{l=[];let e=Buffer.from(a,"base64");for(let a=0;e.length>a;a+=4)l.push(e.readFloatLE(a))})(e.b0),(e=>{a=[];let l,t,b,n=(a,e,l,t,b,n)=>n*n*n*a+3*n*n*b*e+3*n*b*b*l+b*b*b*t;for(b=0;e.length>b;b+=6)for(t=(b+6)%e.length,l=0;1>l;l+=.05)a.push([n(e[b],e[b+2],e[b+4],e[t],l,1-l),n(e[b+1],e[b+3],e[b+5],e[t+1],l,1-l)])})(e.a9))}),t.emit(3))});