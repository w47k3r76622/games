<body style=margin:0;cursor:none><canvas><script>!function(){let t,i,s={};function h(t,...i){s[t]&&s[t].map(t=>t(...i))}function e(){return i}const n=()=>{};function r(){let i=t;e().clearRect(0,0,i.width,i.height)}function o({t:t=60,i:i=1,s:s,h:e}={}){let o,a,l,c,u,f=0,d=1e3/t,x=1/t,M=i?r:n;function y(){if(a=requestAnimationFrame(y),l=performance.now(),c=l-o,o=l,1e3>=c){for(h("tick"),f+=c;f>=d;)u.s(x),f-=d;M(),u.h()}}return u={s:s,h:e,o:1,start(){o=performance.now(),this.o=0,requestAnimationFrame(y)},stop(){this.o=1,cancelAnimationFrame(a)}}}let a={},l={},c={13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};function u(t){let i=c[t.which];l[i]=1,a[i]&&a[i](t)}function f(t){l[c[t.which]]=0}function d(){l={}}function x(t,i){[].concat(t).map(t=>a[t]=i)}function M(t){return!!l[t]}class w{constructor(t,i){this.u=t||0,this.M=i||0}add(t,i){return p(this.x+(t.x||0)*(i||1),this.y+(t.y||0)*(i||1))}p(t,i,s,h){this.g=1,this.m=t,this.v=i,this.R=s,this.A=h}get x(){return this.u}get y(){return this.M}set x(t){this.u=this.g?Math.min(Math.max(this.m,t),this.R):t}set y(t){this.M=this.g?Math.min(Math.max(this.v,t),this.A):t}}function p(t,i){return new w(t,i)}function g(t){t.size=t.size||1,t.width=720*t.size,t.scale=window.innerWidth/t.width,t.height=window.innerHeight/t.scale,t.canvas.width=window.innerWidth,t.canvas.height=window.innerHeight}p.prototype=w.prototype,p.O=w;let m=[];function v(t,i){return window.gamepads[t]?!!window.gamepads[t].S[i]:0}function b(t,i){return window.gamepads[t]?window.gamepads[t].axes[i]:0}function z(t,i){return Object.keys(t).find(s=>t[s]===i)}function R(t){m=navigator.getGamepads(),Array.prototype.forEach.call(m,t=>{if(t){var i=window.gamepads[t.index];t.buttons.forEach((t,s)=>{let h=z(i.k,s);t.pressed?h&&(i.S[h]=1):h&&(i.S[h]=0)}),t.axes.forEach((t,s)=>{let h=z(i.B,s);h&&(i.axes[h]=t)})}})}const A=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","5 0 5 9M5 12 5 14","","","","1 5 1 2 4 2 4 5ZM2 15 9 0M7 10 10 10 10 13 7 13Z","","","8 0 4 0 4 14 8 14","3 0 7 0 7 14 3 14","","","6 12 4 15","3 6 8 6","","2 15 8 0","6 0 11 7 6 14 1 7ZM6 6 6 8","2 4 6 1 6 14","0 4 6 0 10 4 1 13 11 13","2 0 10 3 6 7 10 11 2 13","6 1 1 11 10 11M6 7 6 15","10 1 3 1 1 7 10 7 8 13 0 13","11 1 6 1 1 13 10 13 10 7 4 7","3 1 11 1 6 14","2 4 6 0 10 4 2 10 6 14 10 10Z","1 13 6 13 11 1 2 1 2 7 9 7","","","","","2 4 10 8 2 12","","","1 14 5 2 10 14M3 9 8 9","3 13 3 0 10 3 4 7 10 10Z","9 1 5 1 3 3 3 11 5 13 9 13","3 13 3 1 7 1 9 4 9 10 7 13Z","9 13 3 13 3 1 9 1M3 7 7 7","3 14 3 1 9 1M3 7 7 7","7 1 2 4 2 11 6 13 9 9 5 9","2 14 2 0M9 14 9 0M2 8 9 8","3 13 9 13M3 1 9 1M6 13 6 1","2 11 6 14 9 11 9 1 4 1","3 14 3 0M9 2 4 8 9 14","4 0 4 13 9 13","2 14 2 2 6 6 10 2 10 14","2 14 2 2 9 12 9 0","6 0 11 7 6 14 1 7Z","3 14 3 1 10 1 9 7 3 7","5 1 10 7 5 13 0 7ZM9 13 5 8","3 14 3 1 10 1 9 7 4 7 10 13","10 1 3 1 1 7 10 7 8 13 0 13","6 14 6 1M2 1 10 1","3 0 3 12 6 14 9 12 9 0","3 1 3 7 6 13 9 7 9 1","1 0 3 12 6 5 9 12 11 0","2 0 10 14M10 0 2 14","6 14 6 8M2 0 6 8 10 0","1 1 9 1 2 13 10 13"].map(t=>new Path2D("M"+t));function O(t){[...t.text.toString().toUpperCase()].forEach((i,s)=>{var h=A[i.charCodeAt(0)];s&&t.context.translate(13,0),h&&t.context.stroke(h)})}function S(t){let i=t.size||1;t.context.save(),t.context.scale(t.scale,t.scale);var s=yAlign=0;t.C&&(yAlign=-7*i,s=6.5*-t.text.toString().length*i),t.j&&(yAlign=-17*i),t.q&&(s=13*-t.text.toString().length*i),t.context.translate(t.x+s,t.y+yAlign),t.context.scale(i,i),t.context.strokeStyle=t.Z||"#fff",t.context.lineWidth=1.5,O(t),t.context.restore()}class k{constructor(t){this.context=t.context,this.Z=t.Z||"#fff",this.F=[],this.x=t.x,this.y=t.y,t.F.forEach((t,i)=>{this.F.push({text:t.text,y:24*i})}),this.F[0].P=1,this.P=0}next(){++this.P===this.F.length&&(this.P=0),this.F.forEach((t,i)=>{t.P=i===this.P?1:0})}T(){0>--this.P&&(this.P=this.F.length-1),this.F.forEach((t,i)=>{t.P=i===this.P?1:0})}h(t){this.F.forEach(i=>{this.context.save(),this.context.scale(t,t),this.context.translate(this.x,this.y+i.y),this.context.lineWidth=1.5,i.P?(this.context.strokeStyle=this.Z,O({text:"> "+i.text,context:this.context})):(this.context.strokeStyle=this.Z+"9",O({text:"  "+i.text,context:this.context})),this.context.restore()})}}class B{constructor(t){this.init(t)}init(t={}){let{x:i,y:s,dx:h,dy:n,J:r,N:o}=t;this.X=p(i,s),this.D=p(h,n),this.H=p(r,o),this.I=0,this.L=1/0,this.context=e(),this.Z=t.Z||"#fff";for(let i in t)this[i]=t[i]}get x(){return this.X.x}get y(){return this.X.y}get dx(){return this.D.x}get dy(){return this.D.y}get J(){return this.H.x}get N(){return this.H.y}set x(t){this.X.x=t}set y(t){this.X.y=t}set dx(t){this.D.x=t}set dy(t){this.D.y=t}set J(t){this.H.x=t}set N(t){this.H.y=t}U(){return this.L>0}}function C(t){return new B(t)}function j(t){return t*Math.PI/180}function q(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function Z(t,i){let s=Object.keys(t),h=Object.values(t).indexOf(i);return 0>--h?t[s[s.length-1]]:t[s[h]]}function F(t,i){let s=Object.keys(t),h=Object.values(t).indexOf(i);return h++==s.length-1?t[s[0]]:t[s[h]]}function P(t,i){return t.some(t=>t!==i&&t.Z===i.Z)}function T(t,i,s){const h=Math.cos(j(i.I)),e=Math.sin(j(i.I));let n=(t[0]+t[2])/2,r=(t[1]+t[3])/2,o=C({type:"sh",x:i.x+(n*h-r*e),y:i.y+(r*h+n*e),rotation:i.I,Z:i.Z,p1:{x:t[0]-n,y:t[1]-r},p2:{x:t[2]-n,y:t[3]-r},V:i.game.G._(i.x+(n*h-r*e),i.y+(r*h+n*e),[[t[0]-n,t[1]-r],[t[2]-n,t[3]-r]]),dx:i.dx+Math.random()-.5,dy:i.dy+Math.random()-.5,L:"s"===i.type?120+60*Math.random():60*Math.random(),K:20*Math.random()-10,s(t){this.dx*=.999,this.dy*=.999,this.I+=this.K,this.X=this.X.add(this.D,t),this.L--,this.V.x=this.x,this.V.y=this.y,this.V.W=j(this.I)},h(t){this.context.save(),this.context.scale(t,t),this.context.translate(this.x,this.y),this.context.rotate(j(this.I)),this.context.beginPath(),this.context.strokeStyle=this.Z,this.context.moveTo(this.p1.x,this.p1.y),this.context.lineTo(this.p2.x,this.p2.y),this.context.stroke(),this.context.restore()}});o.V.Y=o,s.push(o)}function J(t){for(var i=Math.round(4+2*Math.random()+Math.sqrt(t)),s=[],h=1;i>=h;h++){var e=1+.1*Math.random(),n=Math.cos(2*Math.PI*h/i)*t*e,r=Math.sin(2*Math.PI*h/i)*t*e;h>1&&s[s.length-1].push(n,r),s.push([n,r]),h===i&&s[s.length-1].push(s[0][0],s[0][1])}return s}function N(t){let i=C({type:"m",x:t.x,y:t.y,dx:void 0!==t.dx?t.dx:Math.random()-.5,dy:void 0!==t.dy?t.dy:Math.random()-.5,$:t.$,tt:t.tt||Math.PI*t.$*t.$,it:J(t.$),game:t.game,K:t.K||0,rotation:360*Math.random(),h(t){this.context.save(),this.context.scale(t,t),this.context.translate(this.x,this.y),this.context.rotate(j(this.I)),this.context.beginPath(),this.context.strokeStyle="#fff",this.it.forEach((t,i)=>{i||this.context.moveTo(t[0],t[1]),this.context.lineTo(t[2],t[3])}),this.context.closePath(),this.context.stroke(),this.context.restore()},s(t){this.I+=this.K,this.D=this.D.add(this.H,t),this.X=this.X.add(this.D,t),this.V&&(this.V.x=this.x,this.V.y=this.y,this.V.W=j(this.I))},st(){this.L=0,this.it.forEach(t=>{T(t,this,this.game.ht)})}});t.et||(i.$>12?(i.nt=[],i.it.forEach((t,s)=>{i.nt.push([t[0],t[1]])}),i.V=i.game.G._(i.x,i.y,i.nt)):i.V=i.game.G.rt(i.x,i.y,i.$),i.V.Y=i),t.game.ht.push(i),t.game.ot.push(i)}C.prototype=B.prototype,C.O=B;var X=[{at:7,tt:3,lt:9,ct:3,ut:6,it:{body:[[-6,-5,7,0],[7,0,-6,5],[-6,5,-4,0],[-4,0,-6,-5]],lt:[[-5,-2,-8,0],[-8,0,-5,2]],V:[[-6,-5],[8,0],[-6,5]]}},{at:8,tt:4,lt:8,ct:5,ut:8,it:{body:[[-5,-2,1,-2],[1,-2,2,-1],[2,-1,2,1],[2,1,1,2],[1,2,-5,2],[-5,2,-6,1],[-6,1,-6,-1],[-6,-1,-5,2]],ft:[[-9,-3,-5,-8],[-5,-8,1,-8],[1,-8,9,-3],[9,-3,-9,-3],[-5,-8,-3,-2],[1,-8,-1,-2],[-9,3,-5,8],[-5,8,1,8],[1,8,9,3],[9,3,-9,3],[-5,8,-3,2],[1,8,-1,2]],lt:[[-7,-1,-8,0],[-8,0,-7,1]],V:[[-9,-3],[-5,-8],[1,-8],[9,-3],[9,3],[1,8],[-5,8],[-9,3]]}},{at:4,tt:9,lt:9,ct:8,ut:4,it:{body:[[-4,-9,-1,-9],[-1,-9,5,-3],[5,-3,5,3],[5,3,-1,9],[-1,9,-4,9],[-4,9,-4,-9]],ft:[[-1,-9,-4,-5],[-4,-5,5,-3],[5,-3,2,0],[-4,-5,2,0],[2,0,-4,5],[2,0,5,3],[-4,5,5,3],[-4,5,-1,9]],lt:[[-4,-3,-6,-2],[-6,-2,-4,-1],[-4,3,-6,2],[-6,2,-4,1]]}},{at:6,tt:4,lt:8,ct:4,ut:8,it:{body:[[-6,-7,-2,-6],[-2,-6,2,-2],[2,-2,7,-2],[7,-2,9,0],[9,0,7,2],[7,2,2,2],[2,2,-2,6],[-2,6,-6,7],[-6,7,-3,2],[-3,2,-5,2],[-5,2,-5,-2],[-5,-2,-3,-2],[-3,-2,-6,-7]],ft:[[-4,-2,2,-2],[-4,2,2,2]],lt:[[-6,-1,-8,0],[-8,0,-6,1]],V:[[6,-2],[8,0],[6,2],[3,2],[-7,7],[-7,-7],[3,-2]]}}];function D(t,i,s,h=1,e=.1,n=0,r=0,o=0,a=0){let l=44100,c=Math.PI;s*=2*c/l,s*=1+i*(2*Math.random()-1),n*=1e3*c/l**2,e*=0|(h=h>0?l*(h>10?10:h)|0:1),o*=2*c/l,a*=c,i=[];for(var u=0,f=0,d=0;h>d;++d)i[d]=t*zv*Math.cos(u*s*Math.cos(f*o+a))*(e>d?d/e:1-(d-e)/(h-e)),u+=1+r*(2*Math.random()-1),f+=1+r*(2*Math.random()-1),s+=n;return t=zx.createBuffer(1,h,l),s=zx.createBufferSource(),t.getChannelData(0).set(i),s.buffer=t,s.connect(zx.destination),s.start(),s}zv=.5,zx=new AudioContext;class H extends C.O{constructor(t){super(t),this.game=t.game;var i=JSON.parse(JSON.stringify(X[t.dt]));this.xt=i,this.Mt=i.ct,this.yt=0,this.it={},this.it.random=[],this.wt=[],this.pt=0,this.gt=0,this.vt=0,this.bt=5,this.type="s",this.I=360*Math.random(),this.K=t.K||0,this.zt=i.zt,this.Rt=4,this.ct=i.ct,this.tt=i.tt+11,this.$=7,this.zt=.2,this.lt=i.lt+6,this.at=(i.at+11)/4,this.ut=(this.xt.ut+6)/12,this.At=t.At,this.it.body=i.it.body||[],this.it.ft=i.it.ft||[],this.it.lt=i.it.lt||[],this.it.V=i.it.V||[],this.it.Ot=this.it.body.concat(this.it.ft),t.St||(this.it.V.length||(this.it.V=[],this.it.body.forEach(t=>{this.it.V.push([t[0],t[1]])})),this.V=this.game.G._(this.x,this.y,this.it.V),this.V.scale=this.scale,this.V.Y=this)}kt(){this.V.remove(),this.Bt=1,this.Ct=0,this.V=this.game.G.rt(this.x,this.y,this.$+4),this.V.Y=this}jt(){this.V.remove(),this.Bt=0,this.V=this.game.G._(this.x,this.y,this.it.V),this.V.scale=this.scale,this.V.Y=this}qt(){if(this.yt<this.zt||1>this.Mt||this.vt)return 0;const t=Math.cos(j(this.I)),i=Math.sin(j(this.I));D(.4,0,1300,.1,.3,6.1,0,15.9,.88),this.yt=0,this.Mt--,this.At.Zt++,this.dx-=t/(this.tt/2),this.dy-=i/(this.tt/2),function(t){const i=Math.cos(j(t.I)),s=Math.sin(j(t.I));let h=C({type:"b",parent:t,x:t.x+i*t.$,y:t.y+s*t.$,dx:t.dx+8*i,dy:t.dy+8*s,L:50,Z:t.Z,V:t.game.G.rt(t.x,t.y,1),s(t){this.D=this.D.add(this.H,t),this.X=this.X.add(this.D,t),this.L--,this.V.x=this.x,this.V.y=this.y},h(t){this.context.save(),this.context.scale(t,t),this.context.translate(this.x,this.y),this.context.fillStyle=this.Z,this.context.beginPath(),this.context.arc(0,0,1,0,2*Math.PI),this.context.fill(),this.context.restore()}});h.V.Y=h,h.Y=t,t.game.ht.push(h)}(this)}Ft(){this.I-=this.at}Pt(){this.I+=this.at}Tt(){if(this.vt)return 0;const t=Math.cos(j(this.I)),i=Math.sin(j(this.I));.05>Math.random()&&D(.3,.1,68,1,.07,0,3.6,0,.7),this.J=.1*t*this.lt/this.tt,this.N=.1*i*this.lt/this.tt}Jt(){this.J=this.N=0}Nt(){if(this.gt<=this.Rt)return 0;D(1,.1,11,.9,.5,2.5,.9,.4,.88),this.gt=0,this.vt=this.wt.length}Xt(){if(this.I>360&&(this.I-=360),0>this.I&&(this.I+=360),this.Ct&&(this.Ct--,0===this.Ct&&(D(.5,0,134,.1,.2,.1,0,11.6,.13),this.jt())),this.gt<this.Rt&&(this.gt+=1/60),this.yt+=1/60,this.Dt>0?this.Dt-=1/60:this.Dt=0,this.pt>0&&(this.pt-=1/60,Math.floor(12*this.pt)%2&&D(.2,.8,900,.1,.1,1.4,0,0,.7),this.pt>0||(this.ut=(this.xt.ut+6)/12,this.pt=0)),this.vt>0)return this.vt=this.vt-this.bt,this.wt[this.vt]?(this.vt<this.wt.length&&(this.x=this.wt[this.vt].x,this.y=this.wt[this.vt].y),0===this.vt&&(this.dx*=.8,this.dy*=.8,this.Dt=.2,this.Mt=this.wt[0].ct,this.pt=this.wt[0].pt),1):(this.vt=0,0);this.Mt<this.ct&&(this.Mt+=1/60*.5),this.D=this.D.add(this.H),function(t,i=10,s=3){const h=q(t);var[e,n]=[t.x,t.y];h>s?(e=e/h*s,n=n/h*s):(e=Math.abs(e)>.01?e*Math.min(.99,.83+i/99):0,n=Math.abs(n)>.01?n*Math.min(.99,.83+i/99):0),[t.x,t.y]=[e,n]}(this.D,this.tt,this.ut),this.X=this.X.add(this.D),this.wt.push({x:this.x,y:this.y,ct:this.Mt,pt:this.pt}),this.wt.length>120&&this.wt.shift(),this.V.x=this.x,this.V.y=this.y,this.V.W=j(this.I)}st(){this.Ht=1,this.At&&this.At.It++,D(.5,.1,1100,.9,0,0,4,0,.4),this.it.Ot.forEach(t=>{T(t,this,this.game.ht)})}Lt(t,i,s){this.context.save(),this.context.scale(t,t),this.context.translate(i,s),this.context.rotate(j(this.I)),this.context.strokeStyle=this.Z,this.context.scale(3,3),this.context.beginPath(),this.context.lineWidth=.8,this.context.moveTo(this.it.body[0][0],this.it.body[0][1]);for(var h=0;h<this.it.body.length-1;h++)this.context.lineTo(this.it.body[h][2],this.it.body[h][3]);this.context.closePath(),this.it.ft.forEach(t=>{this.context.moveTo(t[0],t[1]),this.context.lineTo(t[2],t[3])}),this.context.stroke(),this.context.restore()}Ut(t){this.context.strokeStyle="#0ef";var i=.2*Math.PI/this.ct;for(let t=0;t<Math.floor(this.Mt);t++)this.context.beginPath(),this.context.arc(0,0,this.$+6,2.5132741228718345+i*t*2,Math.PI+(2*i-.05)-.2*Math.PI+i*t*2),this.context.stroke();this.gt>this.Rt||(this.context.strokeStyle="#0ef9"),this.context.beginPath(),this.context.arc(0,0,this.$+6,-.2*Math.PI*1/this.Rt*this.gt,.2*Math.PI/this.Rt*this.gt),this.context.stroke()}h(t){if(this.context.save(),this.context.scale(t,t),this.context.translate(this.x,this.y),this.Ut(t),this.context.rotate(j(this.I)),this.context.strokeStyle=this.Z,this.Dt&&Math.floor(4*this.Dt+.1)%2&&(this.context.lineWidth=.5),this.pt&&(this.Vt=this.Vt||"",Math.floor(12*this.pt)%2&&(this.Vt="hsl("+360*Math.random()+",100%,60%)"),this.context.strokeStyle=this.Vt),this.context.beginPath(),this.vt)this._t=this._t||1,1===this._t&&(this.it.random=[],this.it.Ot.forEach(t=>{this.it.random.push([t[0]*Math.random(),t[1]*Math.random(),t[2]*Math.random(),t[3]*Math.random()])})),this._t=4>this._t?this._t+1:1,this.it.random.forEach(t=>{this.context.moveTo(t[0],t[1]),this.context.lineTo(t[2],t[3])}),this.context.stroke();else{this.context.moveTo(this.it.body[0][0],this.it.body[0][1]);for(var i=0;i<this.it.body.length-1;i++)this.context.lineTo(this.it.body[i][2],this.it.body[i][3]);this.context.closePath(),this.it.ft.forEach(t=>{this.context.moveTo(t[0],t[1]),this.context.lineTo(t[2],t[3])}),(this.J||this.N)&&this.it.lt.forEach((t,i)=>{i>0&&this.it.lt[i-1][2]===t[0]&&this.it.lt[i-1][3]===t[1]?this.context.lineTo(t[2],t[3]):(this.context.moveTo(t[0],t[1]),this.context.lineTo(t[2],t[3]))}),this.context.stroke(),1===this.Bt&&(this.context.beginPath(),this.context.arc(0,0,this.$+4,0,2*Math.PI),this.Ct&&Math.floor(this.Ct/15)%2&&(this.context.lineWidth=.5),this.context.strokeStyle="#fff",this.context.stroke())}this.context.restore()}}function I(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function L(t,i){return t.x*i.x+t.y*i.y}function U(t,i){return Math.abs(I({x:t.Ot.x-i.x,y:t.Ot.y-i.y}))}function V(t,i,s){let h=j(t.Ot.I)-(e={x:t.Ot.x-i.x,y:t.Ot.y-i.y},Math.atan2(e.y,e.x))+Math.PI;var e;return h=h%(2*Math.PI)-Math.PI,s&&(h>0?h-=Math.PI:h+=Math.PI),h}var _=(t,i)=>{if("string"==typeof t)switch(t.toLowerCase()){case"arrows":return{lt:()=>M("up"),qt:()=>M("space"),left:()=>M("left"),right:()=>M("right"),Nt:()=>M("down"),Gt:()=>M("up"),Kt:()=>M("down"),Et:()=>M("space"),back:()=>M("esc")};case"wasd/zqsd":return{lt:()=>M("w")||M("z"),qt:()=>M("e"),left:()=>M("a")||M("q"),right:()=>M("d"),Nt:()=>M("s"),Gt:()=>M("w"),Kt:()=>M("s"),Et:()=>M("e"),back:()=>M("x")};case"gamepad":return{lt:()=>v(i,"a"),qt:()=>v(i,"r"),left:()=>-.5>b(i,"x"),right:()=>b(i,"x")>.5,Nt:()=>v(i,"l"),Gt:()=>-.5>b(i,"y"),Kt:()=>b(i,"y")>.5,Et:()=>v(i,"a"),back:()=>v(i,"b")}}};let G=0;class K{constructor(t){this.Z=t.Z,this.controls=t.controls,this.game=t.game,this.context=t.context,this.dt=t.dt,this.reset(),"ai"!==this.controls?("gamepad"===this.controls?(this.keys=_(this.controls,G++),this.Qt=t.Qt.replace(/.*(?=Joy-)/g,""),this.Qt.indexOf("Xbox")>-1&&(this.Qt="Xbox Controller")):this.controls&&(this.keys=_(this.controls)),this.Wt={Gt:15,Kt:15,left:15,right:15,Et:15,back:15}):this.Yt=1}reset(){this.$t=0,this.It=0,this.Yt=0,this.ti=0,this.Zt=0,this.ii=0}si(){this.Ot&&this.Ot.U&&!this.game.hi&&(this.keys.Nt()&&this.Ot.Nt(),this.keys.lt()?this.Ot.Tt():this.Ot.Jt(),this.keys.left()&&this.Ot.Ft(),this.keys.right()&&this.Ot.Pt(),this.keys.qt()&&this.Ot.qt())}s(){"ai"===this.controls?function(t){var i,s,h,e,n=game.ei[0].Ot,r=game.ni[0];if(t.Ot&&t.Ot.U&&!t.game.hi&&!function(t){var i=0;return t.Ot.ri?0:t.Ot.gt>t.Ot.Rt?(1>t.Ot.Mt&&t.Ot.wt[0].ct>=t.Ot.ct&&(i+=4),t.Ot.pt&&4>t.Ot.pt&&i++,60*Math.random()<i?(t.Ot.Nt(),1):void 0):0}(t)){var o=0;game.ot.forEach((i,s)=>{var h=U(t,i);if(h<=i.$+40){var e=V(t,i);t.Ot.pt>1&&0===s?(o=1,t.Ot.Tt(),-1.8>e?t.Ot.Pt():e>1.8&&t.Ot.Ft()):0===s&&h>25?(o=1,t.Ot.Tt(),-Math.PI/2>e?t.Ot.Pt():e>Math.PI/2&&t.Ot.Ft()):1>t.Ot.pt&&(o=1,-1>e?(t.Ot.Pt(),t.Ot.Jt()):e>1?(t.Ot.Ft(),t.Ot.Jt()):t.Ot.Tt())}}),o||(i=n&&n.U?U(t,n):null,s=r?U(t,r):null,(h=null!==i&&null!==s?s>i?n:r:n&&n.U?n:r||null)&&(-.05>(e=V(t,h,!h.pt))?t.Ot.Pt():e>.05&&t.Ot.Ft(),e>-.1&&.1>e&&(h.pt||t.Ot.pt?t.Ot.Tt():h===n&&180>i?(.1>Math.random()&&t.Ot.qt(),.02>Math.random()&&t.Ot.Jt(),.01>Math.random()&&t.Ot.Tt()):t.Ot.Tt())))}}(this):this.controls&&this.si()}oi(t,i){if(this.game.ht){var s=this.game.ht.indexOf(this.Ot);s>-1&&this.game.ht.splice(s,1)}this.Ot=new H({St:1,x:t,y:i,Z:this.Z,dt:this.dt,game:this.game,At:this,K:1,scale:2,s(){this.I+=this.K}})}ai(){this.Ot=new H({x:20+Math.random()*(this.game.width-40),y:20+Math.random()*(this.game.height-40),Z:this.Z,dt:this.dt,game:this.game,At:this,s(){this.Xt()}}),this.game.ht.push(this.Ot),D(.2,0,250,1,.7,0,0,38,.5),this.Ot.Dt=3}li(t){var i={Z:this.Z,C:1,context:this.context,text:this.ti,scale:this.game.scale};this.ti>8&&(i.size=1.4),0===t?(i.x=this.game.width/2-15,i.y=this.game.height/2-15):1===t?(i.x=this.game.width/2+15,i.y=this.game.height/2-15):2===t?(i.x=this.game.width/2-15,i.y=this.game.height/2+15):3===t&&(i.x=this.game.width/2+15,i.y=this.game.height/2+15),S(i)}}const E={red:"#f43",ci:"#f72",ui:"#ff0",blue:"#0bf",green:"#2e1",fi:"#f3b",di:"#93f"};function Q(t){var i,s=Object.values(E);do{i=s[s.length*Math.random()<<0]}while(game.ei.some(t=>t.Z===i));return i}function W(t,i){if(!i)return Q();if(i.indexOf("-Con (L)")>-1){if(!t.some(t=>t.Z===E.blue))return E.blue;if(!t.some(t=>t.Z===E.green))return E.green}if(i.indexOf("-Con (R)")>-1){if(!t.some(t=>t.Z===E.red))return E.red;if(!t.some(t=>t.Z===E.fi))return E.fi}return i.indexOf("Xbox")>-1&&!t.some(t=>t.Z===E.green)?E.green:Q()}function Y(t,i,s){4!==t.ei.length&&(D(.2,0,1e3,.2,.03,.1,.1,0,.86),t.ei.push(new K({Z:W(t.ei,s),dt:Math.floor(4*Math.random()),controls:i,Qt:s,context:t.context,game:t})))}function $(t){let i=t.gamepad;window.gamepads[i.index]={id:i.id,S:{},axes:{}},i.id.indexOf("-Con")>-1?(window.gamepads[i.index].k={a:1,b:0,x:3,y:2,l:4,r:5},window.gamepads[i.index].B={x:4,y:5}):(window.gamepads[i.index].k={a:0,b:1,x:3,y:2,l:6,r:7},window.gamepads[i.index].B={x:0,y:1}),Y(window.game,"gamepad",i.id)}function tt(t){window.game.ei.some(i=>i.controls===t)||(Y(window.game,t),window.game.xi=window.game.xi.replace("("+t+")",""))}var it,st,ht;window.gamepads=[];let et=o({s(){R(),it.ht[0].I+=it.ht[0].K,it.ei.forEach((t,i)=>{if("ai"!==t.controls){if(t.keys.back()&&"gamepad"!==t.controls){if(t.Wt.back--,0>=t.Wt.back)return"gamepad"!==t.controls&&(it.xi+="("+t.controls+")"),void it.ei.splice(i,1)}else t.Wt.back=0;if(t.keys.Gt()){if(t.Wt.Gt>0)return void t.Wt.Gt--;st.T(),D(.2,0,1e3,.2,.03,.1,.1,0,.86),t.Wt.Gt=15}else t.Wt.Gt=0;if(t.keys.Kt()){if(t.Wt.Kt>0)return void t.Wt.Kt--;st.next(),D(.2,0,1e3,.2,.03,.1,.1,0,.86),t.Wt.Kt=15}else t.Wt.Kt=0;if(t.keys.Et()){if(t.Wt.Et>0)return void t.Wt.Et--;D(.2,0,1e3,.2,.03,.1,.1,0,.86),"p"===st.F[st.P].text[0]?(et.stop(),ht.Mi(it,ht)):"s"===st.F[st.P].text[0]?(it.size+=.25,1.5===it.size&&(it.size=.75),g(it),st.F[st.P].text="scale "+100*it.size+"%",it.ht.splice(0,1),N({x:.4*it.width,y:.8*it.height,$:Math.min(it.width/2,it.height/2),dx:0,dy:0,K:.05,et:1,game:it})):st.F[st.P].text="credits - no room!",t.Wt.Et=15}else t.Wt.Et=0}})},h(){it.ht[0].h(2*it.scale),it.ei.length?(st.h(it.scale),it.ei.forEach((t,i)=>{S({j:1,text:"P"+(i+1)+" "+t.controls,Z:t.Z,size:.8,x:30,y:it.height-30-20*(it.ei.length-1)+20*i,scale:it.scale,context:it.context})})):(S({q:1,j:1,text:"Press arrow keys,",size:.8,x:it.width-30,y:it.height-50,scale:it.scale,context:it.context}),S({q:1,j:1,text:"gamepad, or wasd/qzsd",size:.8,x:it.width-30,y:it.height-30,scale:it.scale,context:it.context})),S({q:1,text:"20461 Dioretsa",size:2*it.size,x:it.width-30,y:30,scale:it.scale,context:it.context})}});function nt(t,i){it=t,ht=i,window.addEventListener("gamepadconnected",$),x(["space","up","right","down","left"],function(t){tt("arrows")}),x(["w","a","s","d","z","q"],function(t){tt("wasd/zqsd")}),x(["n"],function(t){Y(window.game,"ai")}),x(["m"],function(t){var i=null;window.game.ei.forEach((t,s)=>{"ai"===t.controls&&(i=s)}),null!==i&&window.game.ei.splice(i,1)}),it.ot=[],it.ni=[],it.ht=[],st=new k({context:it.context,x:30,y:30,F:[{text:"play"},{text:"scale "+100*it.size+"%"},{text:"credits"}]}),N({x:.4*it.width,y:.8*it.height,$:Math.min(it.width/2,it.height/2),dx:0,dy:0,K:.05,et:1,game:it}),et.start(it,ht)}var rt,ot;const at=o({s(){R(),rt.ei.forEach((t,i)=>{if(t.Ot||t.oi(),"ai"!==t.controls){if(t.keys.Et()?(t.Wt.Et--,t.Wt.Et>0||(t.Yt=!t.Yt,D(.2,0,1e3,.2,.03,.1,.1,0,.86),t.Wt.Et=15)):t.Wt.Et=0,t.keys.back()?(t.Wt.back--,t.Wt.back>0||(at.stop(),ot.yi(rt,ot),D(.2,0,1e3,.2,.03,.1,.1,0,.86),t.Wt.back=15)):t.Wt.back=0,!t.Yt){if(t.Ot.I+=t.Ot.K,t.keys.Gt()){if(t.Wt.Gt>0)return void t.Wt.Gt--;for(t.Z=Z(E,t.Z);P(rt.ei,t);)t.Z=Z(E,t.Z);rt.ei[i].Ot.Z=t.Z,D(.2,0,1e3,.2,.03,.1,.1,0,.86),t.Wt.Gt=15}else t.Wt.Gt=0;if(t.keys.Kt()){if(t.Wt.Kt>0)return void t.Wt.Kt--;for(t.Z=F(E,t.Z);P(rt.ei,t);)t.Z=F(E,t.Z);rt.ei[i].Ot.Z=t.Z,D(.2,0,1e3,.2,.03,.1,.1,0,.86),t.Wt.Kt=15}else t.Wt.Kt=0;if(t.keys.left()){if(t.Wt.left>0)return void t.Wt.left--;t.dt=function(t,i){Object.values(t);let s=Object.keys(t),h=s.indexOf(i);return 0>--h?s[s.length-1]:s[h]}(X,t.dt),t.oi(),D(.2,0,1e3,.2,.03,.1,.1,0,.86),t.Wt.left=15}else t.Wt.left=0;if(t.keys.right()){if(t.Wt.right>0)return void t.Wt.right--;t.dt=function(t,i){Object.values(t);let s=Object.keys(t),h=s.indexOf(i);return h++==s.length-1?s[0]:s[h]}(X,t.dt),t.oi(),D(.2,0,1e3,.2,.03,.1,.1,0,.86),t.Wt.right=15}else t.Wt.right=0}}else t.Yt=1}),rt.ei.length>1&&rt.ei.every(t=>t.Yt)&&(at.stop(),ot.wi(rt,ot))},h(){rt.ei.forEach((t,i)=>{let s=y=0;s=1===i||3==i?4+rt.width/2:8,y=2===i||3===i?4+rt.height/2:8,rt.context.save(),rt.context.scale(rt.scale,rt.scale),rt.context.clearRect(s,y,rt.width/2-12,rt.height/2-12),rt.context.strokeStyle=t.Z,rt.context.strokeRect(s,y,rt.width/2-12,rt.height/2-12),rt.context.restore(),S({text:"player "+(i+1),Z:t.Z,size:.8,x:s+12,y:y+12,scale:rt.scale,context:rt.context}),S({j:1,text:t.Qt?t.Qt:t.controls,Z:t.Z,size:.5,x:s+12,y:y+rt.height/2-20,scale:rt.scale,context:rt.context}),"ai"===t.controls&&S({j:1,text:"(m) remove",Z:t.Z,size:.5,x:s+30,y:y+rt.height/2-20,scale:rt.scale,context:rt.context}),S({q:1,j:1,text:t.Yt?"ready!":"selecting",Z:t.Z,size:.8,x:s+rt.width/2-22,y:y+rt.height/2-20,scale:rt.scale,context:rt.context}),t.Ot&&t.Ot.Lt(rt.scale,s+rt.width/2-80,y+(rt.height/2-12)/2)});for(let t=rt.ei.length;4>t;t++){let i=y=0;i=1===t||3==t?4+rt.width/2:8,y=2===t||3===t?4+rt.height/2:8,S({text:"(n) add ai player",C:1,size:.5,x:i+rt.width/4,y:y+rt.height/4-8,scale:rt.scale,context:rt.context}),S({text:rt.xi+" add player",C:1,size:.5,x:i+rt.width/4,y:y+rt.height/4+8,scale:rt.scale,context:rt.context})}}}),lt=[];class ct{constructor(){this.pi=null,this.gi=1,this.mi=null,this.vi=null,this.bi=0,this.zi=0,this.Ri=0,this.Ai=0,this.Oi=0}static Si(){return lt.length?lt.pop():new ct}static ki(t){lt.push(t)}static Bi(t,i){return t.sort>i.sort?-1:1}}class ut{constructor(){this.Ci=null,this.ji=[],this.qi=[]}Zi(t,i=0){i||(t.Fi,t.Fi=this,this.ji.push(t));const s=t.Pi,h=t.x,e=t.y;s&&(t.Ti||t.x!==t.u||t.y!==t.M||t.W!==t.Ji||t.Ni!==t.Xi||t.Di!==t.Hi)&&t.Ii();const n=t.Li,r=s?0:t.$*t.scale,o=(s?t.Ui:h-r)-n,a=(s?t.Vi:e-r)-n,l=(s?t._i:h+r)+n,c=(s?t.Gi:e+r)+n;t.zi=o,t.Ri=a,t.Ai=l,t.Oi=c;let u=this.Ci,f=0;if(u)for(;;){if(!u.gi){const i=u.pi,s=u.zi,h=u.Ri,e=u.Ai,n=u.Oi,r=u.pi=t.pi=ct.Si();r.pi=i,r.mi=u,r.vi=t,r.bi=f++,r.zi=s>o?o:s,r.Ri=h>a?a:h,r.Ai=l>e?l:e,r.Oi=c>n?c:n,i?i.mi===u?i.mi=r:i.vi=r:this.Ci=r;break}{const t=u.mi,i=t.Ri,s=t.Ai,h=t.Oi,e=o<t.zi?o:t.zi,n=i>a?a:i,r=l>s?l:s,d=c>h?c:h,x=(r-e)*(d-n)-(s-t.zi)*(h-i),M=u.vi,y=M.zi,w=M.Ri,p=M.Ai,g=M.Oi,m=y>o?o:y,v=w>a?a:w,b=l>p?l:p,z=c>g?c:g,R=(b-m)*(z-v)-(p-y)*(g-w);u.bi=f++,u.zi=m>e?e:m,u.Ri=v>n?n:v,u.Ai=r>b?r:b,u.Oi=d>z?d:z,u=x>R?M:t}}else this.Ci=t}remove(t,i=0){if(i||(t.Fi,t.Fi=null,this.ji.splice(this.ji.indexOf(t),1)),this.Ci===t)return void(this.Ci=null);const s=t.pi,h=s.pi,e=s.mi,n=e===t?s.vi:e;if(n.pi=h,n.gi&&(n.bi=s.bi),h){h.mi===s?h.mi=n:h.vi=n;let t=h;for(;t;){const i=t.mi,s=i.zi,h=i.Ri,e=i.Ai,n=i.Oi,r=t.vi,o=r.zi,a=r.Ri,l=r.Ai,c=r.Oi;t.zi=o>s?s:o,t.Ri=a>h?h:a,t.Ai=e>l?e:l,t.Oi=n>c?n:c,t=t.pi}}else this.Ci=n;ct.ki(s)}s(){const t=this.ji,i=t.length;for(let s=0;i>s;++s){const i=t[s];let h=0;if(h||i.pad===i.Li||(i.Li=i.pad,h=1),!h){const t=i.Pi;t&&(i.Ti||i.x!==i.u||i.y!==i.M||i.W!==i.Ji||i.Ni!==i.Xi||i.Di!==i.Hi)&&i.Ii();const s=i.x,e=i.y,n=t?0:i.$*i.scale,r=t?i.Ui:s-n,o=t?i.Vi:e-n,a=t?i._i:s+n,l=t?i.Gi:e+n;h=r<i.zi||o<i.Ri||a>i.Ai||l>i.Oi}h&&(this.remove(i,1),this.Zi(i,1))}}Ki(t){const i=[],s=t.zi,h=t.Ri,e=t.Ai,n=t.Oi;let r=this.Ci,o=1;if(!r||!r.gi)return i;for(;r;){if(o){o=0;let t=r.gi?r.mi:null;for(;t&&t.Ai>=s&&t.Oi>=h&&t.zi<=e&&t.Ri<=n;)t=(r=t).gi?r.mi:null}const a=r.gi,l=a?r.vi:null;if(l&&l.Ai>s&&l.Oi>h&&l.zi<e&&l.Ri<n)r=l,o=1;else{a||r===t||i.push(r);let s=r.pi;if(!s)break;for(;s&&s.vi===r;)s=(r=s).pi;r=s}}return i}Ei(t){const i=this.ji,s=i.length;for(let h=0;s>h;++h)i[h].Ei(t)}Qi(t){let i=this.Ci,s=1;for(;i;){if(s){s=0;let t=i.gi?i.mi:null;for(;t;)t=(i=t).gi?i.mi:null}const h=i.gi,e=i.zi,n=i.Ri,r=i.Ai,o=i.Oi,a=h?i.vi:null;if(t.moveTo(e,n),t.lineTo(r,n),t.lineTo(r,o),t.lineTo(e,o),t.lineTo(e,n),a)i=a,s=1;else{let t=i.pi;if(!t)break;for(;t&&t.vi===i;)t=(i=t).pi;i=t}}}}class ft{constructor(){this.Wi=0,this.a=null,this.b=null,this.Yi=0,this.Yi=0,this.$i=0,this.ts=0,this.ss=0}}function dt(t,i,s=null,h=1){const e=t.Pi,n=i.Pi;let r=0;return s&&(s.a=t,s.b=i,s.Yi=1,s.hs=1,s.$i=null,s.ts=0,s.ss=0),e&&(t.Ti||t.x!==t.u||t.y!==t.M||t.W!==t.Ji||t.Ni!==t.Xi||t.Di!==t.Hi)&&t.Ii(),n&&(i.Ti||i.x!==i.u||i.y!==i.M||i.W!==i.Ji||i.Ni!==i.Xi||i.Di!==i.Hi)&&i.Ii(),h&&!function(t,i){const s=t.Pi,h=s?0:t.x,e=s?0:t.y,n=s?0:t.$*t.scale,r=s?t.Ui:h-n,o=s?t.Vi:e-n,a=s?t._i:h+n,l=s?t.Gi:e+n,c=i.Pi,u=c?0:i.x,f=c?0:i.y,d=c?0:i.$*i.scale,x=c?i.Ui:u-d,M=c?i.Vi:f-d,y=c?i._i:u+d,w=c?i.Gi:f+d;return y>r&&w>o&&a>x&&l>M}(t,i)||(e&&t.es&&t.ns(),n&&i.es&&i.ns(),r=e&&n?function(t,i,s=null){const h=t.rs.length,e=i.rs.length;if(2===h&&2===e){const h=t.rs,e=i.rs;return s&&(s.$i=0),h[0]===e[0]&&h[1]===e[1]}const n=t.rs,r=i.rs,o=t.os,a=i.os;if(h>2)for(let t=0,i=1;h>t;t+=2,i+=2)if(Mt(n,r,o[t],o[i],s))return 0;if(e>2)for(let t=0,i=1;e>t;t+=2,i+=2)if(Mt(n,r,a[t],a[i],s))return 0;return 1}(t,i,s):e?xt(t,i,s,0):n?xt(i,t,s,1):function(t,i,s=null){const h=t.$*t.scale,e=i.$*i.scale,n=i.x-t.x,r=i.y-t.y,o=h+e,a=n*n+r*r;if(a>o*o)return 0;if(s){const t=Math.sqrt(a);s.Yi=e>=h&&e-h>=t,s.hs=h>=e&&h-e>=t,s.$i=o-t,s.ts=n/t,s.ss=r/t}return 1}(t,i,s)),s&&(s.Wi=r),r}function xt(t,i,s=null,h=0){const e=t.rs,n=t.as,r=t.os,o=i.x,a=i.y,l=i.$*i.scale,c=2*l,u=l*l,f=e.length;let d=1,x=1,M=null,y=0,w=0;if(2===f){const t=o-e[0],i=a-e[1],h=t*t+i*i;if(h>u)return 0;if(s){const s=Math.sqrt(h);M=l-s,y=t/s,w=i/s,x=0}}else for(let t=0,i=1;f>t;t+=2,i+=2){const h=o-e[t],p=a-e[i],g=n[t],m=n[i],v=h*g+p*m,b=0>v?-1:v>g*g+m*m?1:0;let z=0,R=0,A=0,O=0;if(s&&d&&h*h+p*p>u&&(d=0),b){const i=-1===b,r=i?0===t?f-2:t-2:t===f-2?0:t+2,c=r+1,d=o-e[r],M=a-e[c],y=n[r],w=n[c],g=d*y+M*w;if((0>g?-1:g>y*y+w*w?1:0)==-b){const t=i?h:d,e=i?p:M,n=t*t+e*e;if(n>u)return 0;if(s){const i=Math.sqrt(n);z=1,R=l-i,A=t/i,O=e/i,x=0}}}else{const e=r[t],n=r[i],o=h*e+p*n,a=0>o?-o:o;if(o>0&&a>l)return 0;s&&(z=1,R=l-o,A=e,O=n,(x&&o>=0||c>R)&&(x=0))}z&&(null===M||M>R)&&(M=R,y=A,w=O)}return s&&(s.Yi=h?x:d,s.hs=h?d:x,s.$i=M,s.ts=h?-y:y,s.ss=h?-w:w),1}function Mt(t,i,s,h,e=null){const n=t.length,r=i.length;if(!n||!r)return 1;let o=null,a=null,l=null,c=null;for(let i=0,e=1;n>i;i+=2,e+=2){const n=t[i]*s+t[e]*h;(null===o||o>n)&&(o=n),(null===a||n>a)&&(a=n)}for(let t=0,e=1;r>t;t+=2,e+=2){const n=i[t]*s+i[e]*h;(null===l||l>n)&&(l=n),(null===c||n>c)&&(c=n)}if(o>c||l>a)return 1;if(e){let t=0;if(l>o)if(e.Yi=0,c>a)t=a-l,e.hs=0;else{const i=a-l,s=c-o;t=s>i?i:-s}else if(e.hs=0,a>c)t=o-c,e.Yi=0;else{const i=a-l,s=c-o;t=s>i?i:-s}const i=e.$i,n=0>t?-t:t;if(null===i||i>n){const i=0>t?-1:1;e.$i=n,e.ts=s*i,e.ss=h*i}}return 0}class yt{constructor(t=0,i=0,s=0){this.x=t,this.y=i,this.pad=s,this.ls=0,this.Pi=0,this.cs=0,this.Fi=null,this.pi=null,this.gi=0,this.Li=s,this.zi=0,this.Ri=0,this.Ai=0,this.Oi=0}us(t,i=null,s=1){return dt(this,t,i,s)}Ki(){return this.Fi.Ki(this)}remove(){const t=this.Fi;t&&t.remove(this,0)}fs(){return new ft}static fs(){return new ft}}class wt extends yt{constructor(t=0,i=0,s=0,h=1,e=0){super(t,i,e),this.$=s,this.scale=h}Ei(t){const i=this.x,s=this.y,h=this.$*this.scale;t.moveTo(i+h,s),t.arc(i,s,h,0,2*Math.PI)}}class pt extends yt{constructor(t=0,i=0,s=[],h=0,e=1,n=1,r=0){super(t,i,r),this.W=h,this.Ni=e,this.Di=n,this.Pi=1,this.u=t,this.M=i,this.Ji=h,this.Xi=e,this.Hi=n,this.Ui=0,this.Vi=0,this._i=0,this.Gi=0,this.ds=null,this.rs=null,this.as=null,this.os=null,this.Ti=1,this.es=1,pt.prototype.xs.call(this,s)}Ei(t){(this.Ti||this.x!==this.u||this.y!==this.M||this.W!==this.Ji||this.Ni!==this.Xi||this.Di!==this.Hi)&&this.Ii();const i=this.rs;if(2===i.length)t.moveTo(i[0],i[1]),t.arc(i[0],i[1],1,0,2*Math.PI);else{t.moveTo(i[0],i[1]);for(let s=2;s<i.length;s+=2)t.lineTo(i[s],i[s+1]);i.length>4&&t.lineTo(i[0],i[1])}}xs(t){const i=t.length;this.ds=new Float64Array(2*i),this.rs=new Float64Array(2*i),this.as=new Float64Array(2*i),this.os=new Float64Array(2*i);const s=this.ds;for(let h=0,e=0,n=1;i>h;++h,e+=2,n+=2){const i=t[h];s[e]=i[0],s[n]=i[1]}this.Ti=1}Ii(){const t=this.x,i=this.y,s=this.W,h=this.Ni,e=this.Di,n=this.ds,r=this.rs,o=n.length;let a,l,c,u;for(let f=0,d=1;o>f;f+=2,d+=2){let o=n[f]*h,x=n[d]*e;if(s){const t=Math.cos(s),i=Math.sin(s),h=o;o=h*t-x*i,x=h*i+x*t}o+=t,x+=i,r[f]=o,r[d]=x,0===f?(a=l=o,c=u=x):(a>o?a=o:o>l&&(l=o),c>x?c=x:x>u&&(u=x))}this.u=t,this.M=i,this.Ji=s,this.Xi=h,this.Hi=e,this.Ui=a,this.Vi=c,this._i=l,this.Gi=u,this.Ti=0,this.es=1}ns(){const t=this.rs,i=this.as,s=this.os,h=t.length;for(let e=0,n=1;h>e;e+=2,n+=2){const r=h>e+2?e+2:0,o=t[r]-t[e],a=t[r+1]-t[n],l=o||a?Math.sqrt(o*o+a*a):0;i[e]=o,i[n]=a,s[e]=l?a/l:0,s[n]=l?-o/l:0}this.es=0}}class gt extends pt{constructor(t=0,i=0,s=0){super(t,i,[[0,0]],0,1,1,s),this.cs=1}}gt.prototype.xs=void 0;class mt{constructor(){this.Fi=new ut}rt(t=0,i=0,s=0,h=1,e=0){const n=new wt(t,i,s,h,e);return this.Fi.Zi(n),n}_(t=0,i=0,s=[[0,0]],h=0,e=1,n=1,r=0){const o=new pt(t,i,s,h,e,n,r);return this.Fi.Zi(o),o}Ms(t=0,i=0,s=0){const h=new gt(t,i,s);return this.Fi.Zi(h),h}fs(){return new ft}static fs(){return new ft}Zi(...t){for(const i of t)this.Fi.Zi(i,0);return this}remove(...t){for(const i of t)this.Fi.remove(i,0);return this}s(){return this.Fi.s(),this}Ei(t){return this.Fi.Ei(t)}Qi(t){return this.Fi.Qi(t)}Ki(t){return this.Fi.Ki(t)}us(t,i,s=null,h=1){return dt(t,i,s,h)}}function vt(t,i,s){t.tt>1e4?(i.x+=s.$i*s.ts,i.y+=s.$i*s.ss):i.tt>1e4?(t.x-=s.$i*s.ts,t.y-=s.$i*s.ss):(t.x-=s.$i*s.ts/2,t.y-=s.$i*s.ss/2,i.x+=s.$i*s.ts/2,i.y+=s.$i*s.ss/2);var h=function(t){const i=I(t);return{x:t.x/i,y:t.y/i}}({x:s.ts,y:s.ss}),e={x:-h.y,y:h.x},n=L(t.D,e),r=L(i.D,e),o=L(t.D,h),a=L(i.D,h),l=(o*(t.tt-i.tt)+2*i.tt*a)/(t.tt+i.tt),c=(a*(i.tt-t.tt)+2*t.tt*o)/(t.tt+i.tt);1e4>t.tt&&(t.dx=e.x*n+h.x*l,t.dy=e.y*n+h.y*l),1e4>i.tt&&(i.dx=e.x*r+h.x*c,i.dy=e.y*r+h.y*c),t.ys=i.ys=1}function bt(t,i,s,h){if("sh"!==i.type){if("m"===t.type){if("b"===i.type){if(t.V.us(i.V,s))if(i.L=0,D(.4,0,1e3,.1,.1,.4,3,0,.55),1e4>t.tt&&t.$>8){for(var e=0;3>e;e++)N({x:t.x,y:t.y,$:t.$/1.8,game:t.game});t.L=0,D(.2,.1,1100,.9,0,0,4,0,.4)}else t.tt>1e4||(t.st(h),D(.2,.1,1100,.9,0,0,4,0,.4));return}if("m"===i.type){if(t.ys||i.ys)return;return void(t.V.us(i.V,s)&&vt(t,i,s))}if("p"===i.type){if(t.ys||i.ys)return;return void(t.V.us(i.V,s)&&vt(t,i,s))}}if("p"!==t.type||"p"!==i.type){if("s"===t.type){if("b"===i.type){if(i.Y===t)return;if(t.V.us(i.V,s)){if(i.Y.At.ii++,i.L=0,t.pt)return;if(t.Dt)return;if(t.Bt)return void(t.Ct=t.Ct||60);t.st(h),i.Y.At.ti++,D(.3,0,1993,.3,.1,.1,0,0,.8)}return}if("m"===i.type){if(t.V.us(i.V,s)){if(t.Dt)return t.x-=s.$i*s.ts,void(t.y-=s.$i*s.ss);if(t.Bt)return t.Ct=t.Ct||60,t.x-=s.$i*s.ts,void(t.y-=s.$i*s.ss);if(t.pt){if(60>i.$&&i.$>8){for(e=0;3>e;e++)N({x:i.x,y:i.y,$:i.$/1.8,ot:i,game:i.game});i.L=0,D(.2,.1,1100,.9,0,0,4,0,.4)}else i.$>60?(t.x-=s.$i*s.ts,t.y-=s.$i*s.ss):(i.st(h),D(.2,.1,1100,.9,0,0,4,0,.4));return}if(.3>q(t.D)&&.3>q(i.D))return t.x-=s.$i*s.ts,void(t.y-=s.$i*s.ss);t.st(h),t.At.$t++}return}if("p"===i.type)return void(t.V.us(i.V,s)&&(i.ws(t),D(.3,0,51,.1,.6,2,.3,19,1),i.L=0));if("s"===i.type){if(i.vt)return;if(t.V.us(i.V,s)){if(t.pt&&!i.Dt)return t.Bt?(i.x+=s.$i*s.ts,void(i.y+=s.$i*s.ss)):i.Bt?(i.Ct=i.Ct||60,i.x+=s.$i*s.ts,void(i.y+=s.$i*s.ss)):(i.st(),t.At.ti++,void D(.3,0,1993,.3,.1,.1,0,0,.8));i.x+=s.$i*s.ts,i.y+=s.$i*s.ss}return}}}else{if(t.ys||i.ys)return;t.V.us(i.V,s)&&vt(t,i,s)}}else t.V.us(i.V,s)&&(i.x+=s.$i*s.ts,i.y+=s.$i*s.ss)}class zt extends C.O{constructor(t){super(t),this.Z=t.Z||"#fff",this.type="p",this.$=5,this.tt=3e3,this.x=t.x,this.y=t.y,this.dx=Math.random()-.5,this.dy=Math.random()-.5,this.K=.5>Math.random()?-1:1,this.V=t.game.G.rt(t.x,t.y,this.$),this.V.Y=this,this.ps=0}s(t){this.I+=this.K,this.X=this.X.add(this.D),this.V.x=this.x,this.V.y=this.y,this.ps%10&&(this.Z="hsl("+this.ps+",100%,60%)"),this.ps++}h(t){this.context.save(),this.context.scale(t,t),this.context.translate(this.x,this.y),this.context.rotate(j(this.I)),this.context.beginPath(),this.context.strokeStyle=this.Z,this.context.arc(0,0,this.$,0,2*Math.PI),this.context.stroke(),this.context.restore()}}class Rt extends zt{constructor(t){super(t)}s(){super.s()}ws(t){t.Mt=2*t.ct}h(t){this.context.save(),this.context.scale(t,t),this.context.translate(this.x,this.y),this.context.rotate(j(this.I)),this.context.beginPath(),this.context.strokeStyle="#fff",this.context.rect(Math.sqrt(.4*Math.pow(this.$,2)),Math.sqrt(.4*Math.pow(this.$,2)),-2*Math.sqrt(.4*Math.pow(this.$,2)),-2*Math.sqrt(.4*Math.pow(this.$,2))),this.context.stroke(),this.context.beginPath(),this.context.strokeStyle="#0ef",this.context.rect(-1.35,-1.35,.45,.45),this.context.rect(.9,-1.35,.45,.45),this.context.rect(-1.35,.9,.45,.45),this.context.rect(.9,.9,.45,.45),this.context.stroke(),this.context.restore(),super.h(t)}}class At extends zt{constructor(t){super(t)}s(){super.s()}ws(t){t.kt()}h(t){this.context.save(),this.context.scale(t,t),this.context.translate(this.x,this.y),this.context.rotate(j(this.I)),this.context.beginPath(),this.context.strokeStyle="#fff",this.context.rect(Math.sqrt(.4*Math.pow(this.$,2)),Math.sqrt(.4*Math.pow(this.$,2)),-2*Math.sqrt(.4*Math.pow(this.$,2)),-2*Math.sqrt(.4*Math.pow(this.$,2))),this.context.stroke(),this.context.beginPath(),this.context.arc(0,0,this.$/2-1,0,2*Math.PI),this.context.stroke(),this.context.restore(),super.h(t)}}class Ot extends zt{constructor(t){super(t)}s(){super.s()}ws(t){t.pt+=8,t.ut=(t.xt.ut+6)/9}h(t){this.context.save(),this.context.scale(t,t),this.context.translate(this.x,this.y),this.context.rotate(j(this.I)),this.context.beginPath(),this.context.strokeStyle="#fff";var i=Math.PI/2*3,s=Math.PI/5;this.context.moveTo(0,0-.75*this.$);for(let t=0;5>t;t++)this.context.lineTo(Math.cos(i)*this.$*.75,Math.sin(i)*this.$*.75),i+=s,this.context.lineTo(Math.cos(i)*this.$*.35,Math.sin(i)*this.$*.35),i+=s;this.context.lineTo(0,0-.75*this.$),this.context.closePath(),this.context.stroke(),this.context.restore(),super.h(t)}}var St;const kt=o({s(){if(R(),Bt.hi&&(Bt.hi++,Bt.ei.forEach(t=>{"ai"!==t.controls?t.keys.Et()&&Bt.hi>60?(t.Wt.Et--,t.Wt.Et>0||(t.Yt=!t.Yt,t.Wt.Et=15)):t.Wt.Et=0:t.Yt=0}),Bt.ei.every(t=>!t.Yt)&&(kt.stop(),St.yi(Bt,St))),Bt.ei.forEach(t=>{t.s()}),Bt.ht.map(t=>{t.s(),"b"!==t.type&&(t.x>Bt.width?t.x=0:0>t.x&&(t.x=Bt.width),t.y>Bt.height?t.y=0:0>t.y&&(t.y=Bt.height))}),function({ht:t,G:i,gs:s}){var h={};i.s(),t.forEach(i=>{if(i.V&&!i.vt&&(h=i.V.Ki()))for(const e of h)bt(i,e.Y,s,t)}),t.forEach(t=>{t.ys=0})}(Bt),Bt.ht.forEach(t=>{t.U()&&!t.Ht||t.V&&t.V.remove()}),Bt.ht=Bt.ht.filter(t=>t.U()),Bt.ot=Bt.ot.filter(t=>t.U()),Bt.ni=Bt.ni.filter(t=>t.U()),Bt.ht=Bt.ht.filter(t=>!t.Ht),Bt.hi||Bt.ei.forEach(t=>{t.Ot.Ht&&t.Ot.L&&(t.Ot={},setTimeout(()=>{t.ai()},3e3)),10===t.ti&&(Bt.hi=1,Bt.ms=[],Bt.ei.forEach(t=>{Bt.ms.push(t)}),Bt.ms.sort((t,i)=>t.ti>i.ti?-1:t.ti<i.ti?1:t.It<i.It?-1:t.It>i.It?1:Math.round(.5>Math.random()?-1:1)),Bt.ms.forEach((t,i)=>{t.vs=i}))}),5>Bt.ot.length&&.005>Math.random()&&N({x:Math.random()*Bt.width,y:Math.random()*Bt.height,$:20,game:Bt}),1>Bt.ni.length){let t=Math.random(),i=null;t>0&&.001>t&&(i=new Rt({x:Math.random()*Bt.width,y:Math.random()*Bt.height,game:Bt})),t>.001&&.002>t&&(i=new At({x:Math.random()*Bt.width,y:Math.random()*Bt.height,game:Bt})),t>.002&&.0027>t&&(i=new Ot({x:Math.random()*Bt.width,y:Math.random()*Bt.height,game:Bt})),i&&(Bt.ht.push(i),Bt.ni.push(i))}},h(){Bt.ht.map(t=>t.h(Bt.scale)),Bt.hi?function(t){var i=t.size*t.size*t.size*t.size*32,s=(t.width-2*i)/t.ei.length-14,h=t.height-2*(i+7),e=i+7;t.ei.forEach((n,r)=>{var o=i+(s+14)*r+7;t.context.save(),t.context.scale(t.scale,t.scale),t.context.clearRect(o,e,s,h),t.context.strokeStyle=n.Z,t.context.strokeRect(o,e,s,h),t.context.restore(),0===n.vs?(S({text:"winner!",Z:n.Z,x:o+7,y:e+7+1,size:1.35*t.size,scale:t.scale,context:t.context}),t.context.save(),t.context.scale(t.scale,t.scale),t.context.strokeStyle=n.Z,t.context.strokeRect(o-6,e-6,s+12,h+12),t.context.strokeRect(o-3,e-3,s+6,h+6),t.context.restore()):(S({text:n.vs+1,Z:n.Z,x:o+7,y:e+7+1,size:1.3*t.size,scale:t.scale,context:t.context}),1===n.vs?S({text:"nd",Z:n.Z,x:o+7+17*t.size,y:e+7+12*t.size,size:.5,scale:t.scale,context:t.context}):2===n.vs?S({text:"rd",Z:n.Z,x:o+7+17*t.size,y:e+7+11*t.size,size:.5,scale:t.scale,context:t.context}):S({text:"th",Z:n.Z,x:o+7+16*t.size,y:e+7+12*t.size,size:.5,scale:t.scale,context:t.context})),S({text:"player "+(r+1),Z:n.Z,size:.8,x:o+7,y:e+50,scale:t.scale,context:t.context}),S({text:"score",Z:n.Z,size:.5,x:o+7,y:e+85,scale:t.scale,context:t.context}),S({text:n.ti,Z:n.Z,q:1,x:o+s-7,y:e+80,scale:t.scale,context:t.context}),S({text:"deaths",Z:n.Z,size:.5,x:o+7,y:e+115,scale:t.scale,context:t.context}),S({text:n.It,Z:n.Z,q:1,x:o+s-7,y:e+110,scale:t.scale,context:t.context}),S({text:"accuracy",Z:n.Z,size:.5,x:o+7,y:e+145,scale:t.scale,context:t.context}),S({text:(n.Zt&&n.ii?Math.round(100/n.Zt*n.ii):0)+"%",Z:n.Z,q:1,x:o+s-7,y:e+140,scale:t.scale,context:t.context}),S({text:"crashes",Z:n.Z,size:.5,x:o+7,y:e+175,scale:t.scale,context:t.context}),S({text:n.$t,Z:n.Z,q:1,x:o+s-7,y:e+170,scale:t.scale,context:t.context}),S({text:n.Yt?"next>":"ready!",Z:n.Z,size:1.3*t.size,q:1,j:1,x:o+s-7,y:e+h-7,scale:t.scale,context:t.context})})}(Bt):Bt.ei.map((t,i)=>t.li(i))}});var Bt;let{canvas:Ct,context:jt}=(t=document.querySelector("canvas"),(i=t.getContext("2d")).bs=0,h("init"),{canvas:t,context:i});const qt={canvas:Ct,context:jt,ei:[]},Zt={yi:nt,Mi:function(t,i){ot=i,(rt=t).ei.forEach(t=>{t.Ot=null,t.reset()}),at.start()},wi:function(t,i){Bt=t,St=i,window.removeEventListener("gamepadconnected",$),[].concat(["space","up","right","down","left","w","a","s","d"]).map(t=>a[t]=0),Bt.ot=[],Bt.ni=[],Bt.ht=[],Bt.hi=0,Bt.G=new mt,Bt.gs=Bt.G.fs(),N({x:Bt.width/2,y:Bt.height/2,$:Math.min(Bt.width/5,Bt.height/5),tt:1e5,dx:0,dy:0,K:.1,game:Bt}),Bt.ei.forEach(t=>{t.ai()}),kt.start()}};window.game=qt,function(){let t;for(t=0;26>t;t++)c[65+t]=(10+t).toString(36);for(t=0;10>t;t++)c[48+t]=""+t;window.addEventListener("keydown",u),window.addEventListener("keyup",f),window.addEventListener("blur",d)}(),Ct.style="width:100%;background:#000",g(qt),window.onresize=()=>{g(qt)},qt.xi="(gamepad)(wasd/zqsd)(arrows)",nt(qt,Zt)}()</script>