var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,c,b){if(d){c=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var e=a[b];e in c||(c[e]={});c=c[e]}a=a[a.length-1];b=c[a];d=d(b);d!=b&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,b){var d=this.length||0;0>c&&(c=Math.max(0,d+c));if(null==b||b>d)b=d;b=Number(b);0>b&&(b=Math.max(0,d+b));for(c=Number(c||0);c<b;c++)this[c]=a;return this}},"es6","es3");
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(d){return $jscomp.SYMBOL_PREFIX+(d||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(a){var d=0;return $jscomp.iteratorPrototype(function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,b={next:function(){if(c<a.length){var e=c++;return{value:d(e,a[e]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var WIDTH=600,HEIGHT=400,MIN_SPEED=4,MAX_SPEED_UP=6,LEVEL_THRESHOLD=15,BGN=Number(window.getComputedStyle(document.getElementById("main-div"),null).getPropertyValue("background-color").slice(4,6)),LOW_FUEL_TRESHOLD=200,FUEL_CELL_TRESHOLD=100,FUEL_CELL_SPEED=5,DEFAULT="Going againts incoming traffic. Drive safe!",LOW_FUEL="Running out of fuel!",TWEET='<a href="https://twitter.com/intent/tweet?text=I scored <SCORE> on 13kars&url=https://13kars.fq.nz">Share on Twitter</a>',GAME_OVER="Press [SPACE] to restart. "+
TWEET,GAME_OVER_COLLISION="Collision! "+GAME_OVER,GAME_OVER_NOFUEL="Ran out of fuel! "+GAME_OVER,audio_fuel_cell=new Audio("audio/fuel_cell.wav"),audio_no_fuel=new Audio("audio/no_fuel.wav"),audio_low_fuel=new Audio("audio/low_fuel.wav"),audio_collision=new Audio("audio/collision.wav"),audio_pass=new Audio("audio/pass.wav"),audio_level_up=new Audio("audio/level_up.wav");kontra.init();kontra.canvas.width=WIDTH;kontra.canvas.height=HEIGHT;var score=0,fuel=1E3,fuel_cell_gauge=0,level=1;
function getRandomInt(a){return Math.floor(Math.random()*Math.floor(a))}function getRandomcolor(){var a=getRandomInt(256);a>BGN-20&&a<BGN+10&&(a+=40);a=a.toString(16);return"#"+a+a+a}function getCar(){return kontra.sprite({color:"#000000",width:40,height:40})}function getEnemyCar(){var a=getCar();a.x=WIDTH;a.y=getRandomInt(HEIGHT-a.height);a.dx=-MIN_SPEED-getRandomInt(MAX_SPEED_UP);return a}
function getFuelCell(){return kontra.sprite({dx:-FUEL_CELL_SPEED,width:40,height:40,radius:20,color_index:255,color_asc:!1,fuel:200,active:!1,render:function(){1==this.color_asc?(this.color_index++,255<this.color_index&&(this.color_index=255,this.color_asc=!1)):(this.color_index--,0>this.color_index&&(this.color_index=0,this.color_asc=!0));var a=this.color_index.toString(16);this.context.fillStyle="#"+a+a+a;this.context.beginPath();this.context.arc(this.x,this.y,this.radius,0,2*Math.PI);this.context.fill()}})}
function updateScore(a){element=document.getElementById("score");element.innerText=a}function updateFuel(a){element=document.getElementById("fuel");0>a&&(a=0);element.innerText=a}function updateHud(a){element=document.getElementById("hud");element.innerHTML=a.replace("<SCORE>",score)}function updateLevel(a){element=document.getElementById("level");element.innerText=level}
function pauseAnimation(){document.querySelector(".gutter-top").classList.add("paused");document.querySelector(".gutter-bottom").classList.add("paused")}var car=getCar();car.x=10;car.y=60;var enemies=[];enemies.push(getEnemyCar());var fuel_cell=getFuelCell();kontra.keys.bind("space",function(){window.location.reload()});updateScore(score);updateFuel(fuel);updateHud(DEFAULT);
var loop=kontra.gameLoop({update:function(){updateScore(score);if(0<score&&0==score%(LEVEL_THRESHOLD+LEVEL_THRESHOLD*(enemies.length-1))){audio_level_up.play();score++;level++;var a=getEnemyCar();enemies.push(a)}updateLevel(level);if(kontra.keys.pressed("up")||kontra.keys.pressed("k")||kontra.keys.pressed("w"))car.y--,fuel--;if(kontra.keys.pressed("down")||kontra.keys.pressed("j")||kontra.keys.pressed("s"))car.y++,fuel--;updateFuel(fuel);car.update();for(i in enemies)a=enemies[i],a.update(),!0===
fuel_cell.active&&fuel_cell.update(),car.collidesWith(a)&&(audio_collision.play(),loop.stop(),pauseAnimation(),updateHud(GAME_OVER_COLLISION)),0>a.x+a.width&&(audio_pass.play(),a.x=WIDTH,a.y=getRandomInt(HEIGHT-a.height),a.color=getRandomcolor(),a.dx=-MIN_SPEED-getRandomInt(MAX_SPEED_UP),score+=1);!0===fuel_cell.active&&car.collidesWith(fuel_cell)&&(audio_fuel_cell.play(),fuel+=fuel_cell.fuel,fuel_cell.active=!1,fuel_cell.update(),updateHud(DEFAULT));0>fuel?(audio_no_fuel.play(),updateHud(GAME_OVER_NOFUEL),
loop.stop(),pauseAnimation()):fuel<=LOW_FUEL_TRESHOLD&&(audio_low_fuel.play(),updateHud(LOW_FUEL));fuel_cell_gauge>=FUEL_CELL_TRESHOLD&&!1===fuel_cell.active?(fuel_cell.x=WIDTH,fuel_cell.y=getRandomInt(HEIGHT-fuel_cell.radius),fuel_cell.active=!0,fuel_cell_gauge=0):fuel_cell_gauge+=getRandomInt(2);0>car.y&&(car.y=0);car.y>HEIGHT-car.height&&(car.y=HEIGHT-car.height);!0===fuel_cell.active&&0>fuel_cell.x+fuel_cell.radius&&(fuel_cell.active=!1)},render:function(){car.render();for(i in enemies)enemies[i].render();
!0===fuel_cell.active&&fuel_cell.render()}});loop.start();
