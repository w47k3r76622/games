!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t){const o=document.getElementById("canvas"),n=o.getContext("2d");let r,i=0,l=0;const a=window.innerWidth,c=window.innerHeight,f=window.devicePixelRatio/["webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio"].reduce((function(e,t){return Object.prototype.hasOwnProperty.call(n,t)?n[t]:1}));function s(e,t){const o=t.matrix,n=t.pos;for(let t=0;t<o.length;++t)for(let r=0;r<o[t].length;++r)if(0!==o[t][r]&&0!==(e[t+n.y]&&e[t+n.y][r+n.x]))return!0;return!1}function u(e){return"I"===e?[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]:"L"===e?[[0,2,0],[0,2,0],[0,2,2]]:"J"===e?[[0,3,0],[0,3,0],[3,3,0]]:"O"===e?[[4,4],[4,4]]:"Z"===e?[[5,5,0],[0,5,5],[0,0,0]]:"S"===e?[[0,6,6],[6,6,0],[0,0,0]]:"T"===e?[[0,7,0],[7,7,7],[0,0,0]]:void 0}function d(e,t){e.forEach((e,o)=>{e.forEach((e,r)=>{0!==e&&(n.beginPath(),n.fillStyle="rgba(67,77,67, 0.75)",n.fillRect(r+t.x,o+t.y,1,1),n.closePath())})})}function h(e,t){for(let t=0;t<e.length;++t)for(let o=0;o<t;++o)[e[o][t],e[t][o]]=[e[t][o],e[o][t]];t>0?e.forEach(e=>e.reverse()):e.reverse()}function p(){v.pos.y++,s(S,v)&&(v.pos.y--,function(e,t){t.matrix.forEach((o,n)=>{o.forEach((o,r)=>{0!==o&&(e[n+t.pos.y][r+t.pos.x]=o)})})}(S,v),y(),function(){let e=1;e:for(let t=S.length-1;t>0;--t){for(let e=0;e<S[t].length;++e)if(0===S[t][e])continue e;const o=S.splice(t,1)[0].fill(0);S.unshift(o),++t,v.score+=10*e,e*=2}}()),m=0}function x(e){v.pos.x+=e,s(S,v)&&(v.pos.x-=e)}function y(){r||(r=u("TJLOSZI"["TJLOSZI".length*Math.random()|0])),v.matrix=r,r=u("TJLOSZI"["TJLOSZI".length*Math.random()|0]),v.pos.y=0,v.pos.x=(S[0].length/2|0)-(v.matrix[0].length/2|0),s(S,v)&&(S.forEach(e=>e.fill(0)),v.score=0)}function g(e){const t=v.pos.x;let o=1;for(h(v.matrix,e);s(S,v);)if(v.pos.x+=o,o=-(o+(o>0?1:-1)),o>v.matrix[0].length)return h(v.matrix,-e),void(v.pos.x=t)}o.width=Math.round(a*f),o.height=Math.round(c*f),o.style.width=a+"px",o.style.height=c+"px",n.setTransform(f,0,0,f,0,0);let m=0,b=0;document.addEventListener("keydown",e=>{37===e.keyCode?x(-1):39===e.keyCode?x(1):40===e.keyCode?p():81===e.keyCode?g(-1):87===e.keyCode&&g(1)}),document.addEventListener("click",e=>{const{pageX:t,pageY:o}=e,n=t,r=o,i=20*v.pos.x+a/4,l=20*v.pos.y+c/6-r,f=i-n;Math.abs(l)>Math.abs(f)?g(l>0?-1:1):x(f>0?-1:1)});const S=function(e,t){const o=[];for(;t--;)o.push(new Array(e).fill(0));return o}(12,20),v={pos:{x:0,y:0},matrix:null,score:0};y(),function e(t=0){m+=t-b,m>1e3&&(p(),i++,60==i&&(l++,i-=60)),b=t,function(){n.fillStyle="#acbeac",n.fillRect(0,0,o.width,o.height);const e="Score: "+v.score;n.measureText(e),n.save(),n.beginPath(),n.font="0.85em Tetris",n.fillStyle="rgba(67,77,67, 1)",n.fillText("Score: "+v.score,0,c/6+9),n.fillText("Time: "+Math.floor(l)+":"+(Math.floor(i)>9?Math.floor(i):"0"+Math.floor(i)),0,c/6+27),n.closePath(),n.restore(),n.save();const t=a/2/12;n.translate(a/4,c/6),n.scale(t,t),n.strokeStyle="rgba(67,77,67, 1)",n.lineWidth=.0625,n.strokeRect(0,0,12,20),n.lineWidth=1,d(S,{x:0,y:0}),d(r,{x:13,y:0}),d(v.matrix,v.pos),n.restore()}(),requestAnimationFrame(e)}()}]);