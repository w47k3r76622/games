var Hero=function(i,t,o,s,e,h){this.ctx=i,this.image=t,this.width=o,this.height=s,this.x=e,this.y=h,this.collisionGroup=[],this.eggCollisionGroup=[],this.doorCollisionGroup=[],this.chestToCollide=null,this.rocksCollisionGroup=[],this.knightCollisionGroup=[],this.walkAnimation=[28,29,28,30],this.animationIndex=0,this.tileId=this.walkAnimation[this.animationIndex],this.tickCount=0,this.ticksPerFrame=8,this.completedLevel=!1,this.dead=!1};Hero.prototype=new Sprite,Hero.prototype.constructor=Hero,Hero.prototype.addCollisionGroup=function(i){this.collisionGroup=i},Hero.prototype.addEggCollisionGroup=function(i){this.eggCollisionGroup=i},Hero.prototype.addChest=function(i){this.chestToCollide=i},Hero.prototype.addRocksCollisionGroup=function(i){this.rocksCollisionGroup=i},Hero.prototype.update=function(i){this.tickCount++;var t=this.x,o=this.y,s=0,e=0,h=Math.round(i*MAXSPEED);this.right&&(t=this.x+h,s+=h),this.left&&(t=this.x-h,s-=h),this.up&&(o=this.y-h,e-=h),this.down&&(o=this.y+h,e+=h);var n=this.newCollisionMask(t+10,o+10,this.width-20,this.height-20),l=this.collided(this.collisionGroup,n);l||(l=this.collided(this.knightCollisionGroup,n),l||(l=this.exitDoor(this.doorCollisionGroup,n),l||(l=this.collidedWithMovable(this.rocksCollisionGroup,n,s,e),l||(this.x==t&&this.y==o?this.animationIndex=0:this.tickCount>this.ticksPerFrame&&(this.animationIndex++,this.animationIndex=this.animationIndex%this.walkAnimation.length,this.tickCount=0),this.tileId=this.walkAnimation[this.animationIndex],this.x=t,this.y=o,this.collectEgg(this.eggCollisionGroup,n),this.collideWithChest(n)))))},Hero.prototype.collideWithChest=function(i){this.intersects(i,this.chestToCollide.bounds())&&this.chestToCollide.isOpen&&this.chestToCollide.hasKey&&this.chestToCollide.pickKey()},Hero.prototype.collidedWithMovable=function(i,t,o,s){for(var e=!1,h=0;h<i.length;h++){var n=i[h];if(this.intersects(t,n.bounds())){e=n.canMove(o,s)?!1:!0;break}}return e},Hero.prototype.collectEgg=function(i,t){for(var o=!1,s=0;s<i.length;s++){var e=i[s];if(this.intersects(t,e.bounds())){o=!0,e.collected(),i.splice(s,1);break}}return o},Hero.prototype.exitDoor=function(i,t){for(var o=!1,s=0;s<i.length;s++){var e=i[s];if(this.intersects(t,e.bounds())){e.isOpen?(o=!1,this.win()):o=!0;break}}return o},Hero.prototype.win=function(){console.log("win"),this.completedLevel=!0},Hero.prototype.fail=function(){console.log("killed"),this.dead=!0},Hero.prototype.bounds=function(){var i={};return i.left=this.x+5,i.top=this.y+5,i.right=this.x+this.width-10,i.bottom=this.y+this.height-10,i};