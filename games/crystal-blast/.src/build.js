(function t(e,i,l){function n(r,s){if(!i[r]){if(!e[r]){var a="function"==typeof require&&require;if(!s&&a)return a(r,!0);if(o)return o(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var f=i[r]={t:{}};e[r][0].call(f.t,(function(t){var i;return n(e[r][1][t]||t)}),f,f.t,t,e,i,l)}return i[r].t}for(var o="function"==typeof require&&require,r=0;r<l.length;r++)n(l[r]);return n})({1:[function(e,l,n){(function(){function t(t,e,i){this.x=t,this.y=e,this.z=i}l=window.noise={},t.prototype.i=function(t,e){return this.x*t+this.y*e},g3=[new t(1,1,0),new t(-1,1,0),new t(1,-1,0),new t(-1,-1,0),new t(1,0,1),new t(-1,0,1),new t(1,0,-1),new t(-1,0,-1),new t(0,1,1),new t(0,-1,1),new t(0,1,-1),new t(0,-1,-1)];let e=[];for(;e.length<300;)e.push(kt(0,255));function n(t){return t*t*t*(t*(6*t-15)+10)}function o(t,e,i){return(1-i)*t+i*e}e=[...new Set(e)],perm=new Array(512),gP=new Array(512),l.seed=function(t){for(t>0&&t<1&&(t*=65536),(t=Math.floor(t))<256&&(t|=t<<8),i=0;i<256;i++)v=0,1&i?v=e[i]^255&t:v=e[i]^t>>8&255,perm[i]=perm[i+256]=v,gP[i]=gP[i+256]=g3[v%12]},l.seed(0),l.l=function(t,e){return X=Math.floor(t),Y=Math.floor(e),t-=X,e-=Y,X&=255,Y&=255,n00=gP[X+perm[Y]].i(t,e),n01=gP[X+perm[Y+1]].i(t,e-1),n10=gP[X+1+perm[Y]].i(t-1,e),n11=gP[X+1+perm[Y+1]].i(t-1,e-1),u=n(t),o(o(n00,n10,u),o(n01,n11,u),n(e))}})(this),function(){Cam=function(t,e){e=e||{};let i=this;i.d=1e3,i.o=[0,0],i.context=t,i.s=e.s||Math.PI/4,i.u={h:0,p:0,m:0,bottom:0,w:0,g:0,scale:[1,1]},i.M()},Cam.prototype={v:function(){let t=this;t.context.save(),t.k(),t.X()},end:function(){this.context.restore()},k:function(){this.context.scale(this.u.scale[0],this.u.scale[1])},X:function(){this.context.translate(-this.u.h,-this.u.m)},M:function(){let t=this;t.Y=t.context.canvas.width/t.context.canvas.height,t.u.w=t.d*Math.tan(t.s),t.u.g=t.u.w/t.Y,t.u.h=t.o[0]-t.u.w/2,t.u.m=t.o[1]-t.u.g/2,t.u.p=t.u.h+t.u.w,t.u.bottom=t.u.m+t.u.g,t.u.scale[0]=t.context.canvas.width/t.u.w,t.u.scale[1]=t.context.canvas.height/t.u.g},L:function(t){this.d=t,this.M()},moveTo:function(t,e){let i=this;i.o[0]=t,i.o[1]=e,i.M()}},this.D=Cam}.call(this);let o=document.getElementById("a"),r=o.width,s=o.height,a=40*2,f=32*3+6,h=o.getContext("2d"),p=new Cam(h),w=[],m=.2,b=1,x=[],g=Ht(a,f,null),M=Ht(a,f,null),k=Ht(a,f,null),L=32,D=.25,F=null,A=!1,R=[],C=[],P=[],S=[],T=300,I=0,q=60,_=0,E=!1,G=0,O=!1,H=noise,U=kt(0,6e3),W=[];for(i=0;i<10;i++)W.push(kt(0,6e3));noise.seed(U);let B="images/",N=Ut("log"),z=Ut("leaves"),J=Ut("cactus"),Z=Ut("grass"),K=Ut("dirt"),Q=Ut("rock",4),V=Ut("rockblue"),$=Ut("oiron"),tt=Ut("lavarock"),et=Ut("bedrock"),it=Ut("ladder"),lt=Ut("lava"),nt=Ut("ecrystal"),ot=Ut("bg_rock",4),rt=Ut("bg_lavarock"),st=Ut("bg_stars"),at=Ut("hit"),ct=Ut("spcship"),ft=Ut("player",".gif"),ut=Ut("playerdown"),ht=Ut("plasmaball"),pt=Ut("oortbug"),dt=Ut("slugger"),wt=Ut("heart"),yt=Ut("heartempty"),mt=Ut("lifecanister"),bt=Ut("cloud",1),xt=[{name:"grass",F:0,j:!0,A:!0,R:!0},{name:"blue",F:1,j:!kt(0,1),A:!kt(0,1),R:!0},{name:"sand",F:2,j:!1,A:!1,R:!0},{name:"wasteland",F:3,j:!1,R:!0}];function gt(){let t=[1,2,3,4,5,6,7,8,9,"A","B","C","D","E","F"],e="#";for(i=0;i<6;i++)e+=t[kt(0,t.length-1)];return e}function Mt(t,e,i,l){let n=t-i,o=e-l;return Math.hypot(n,o)}function vt(t,e,i){return t<e?e:t>i?i:t}function kt(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}function Xt(t,e){for(xp=t.h-2;xp<t.h+t.w+2;xp++)for(yp=t.m-2;yp<t.m+t.g+2;yp++)Yt(xp,yp)&&e(xp,yp)}function Yt(t,e){return t>=0&&t<a&&e>=0&&e<f}function Lt(t,e){return vX=t.x+t.w/2-(e.x+e.w/2),vY=t.y+t.g/2-(e.y+e.g/2),hWidths=t.w/2+e.w/2,hHeights=t.g/2+e.g/2,cold=null,Math.abs(vX)<hWidths&&Math.abs(vY)<hHeights&&(oX=hWidths-Math.abs(vX),oY=hHeights-Math.abs(vY),oX>=oY?vY>0?t.C<10?(cold="t",t.y+=oY):vX>0?(cold="l",t.x+=oX):(cold="r",t.x-=oX):(cold="bs",t.y-=oY):vX>0?(cold="l",t.x+=oX):(cold="r",t.x-=oX)),cold}function Dt(t,e){return t.x<e.x+e.w&&t.x+t.w>e.x&&t.y<e.y+e.g&&t.y+t.g>e.y}function Ft(t,e){return Math.floor(t/e)*e}function jt(t,e){for(y=e-1;y>0;y--)if(M[t][y])return!0;return!1}function At(t){let e=null;for(i=0;i<Q.length;i++)t.P==Q[i]&&(e="rock");return e}function Rt(t,e,i,l,n,o){let r=e-l,s=kt(3,5);for(ly=e;ly>r;ly--)if(Yt(t,ly)&&(M[t][ly]=new Pt(t*L,ly*L,i,o),ly==r+1&&n))for(xp=-s;xp<s;xp++)for(yp=-s;yp<s;yp++)xp*xp+yp*yp<Math.pow(s,2)&&Yt(t+xp,e+yp)&&(M[t+xp][ly+yp]=new Pt((t+xp)*L,(ly+yp)*L,z,o))}wldt=xt[kt(0,xt.length-1)],wldt.skyColor=gt();class Ct{constructor(t,e,i){let l=this;l.S=t,l.f=e,l.T=0,l.d=i,l.I=!0}q(){let t=this;t.I&&(t.T<t.d?t.T++:(t.f<t.S-1?t.f++:t.f=0,t.T=0))}}class Pt{constructor(t,e,i,l){l=l||{_:!0,G:!0,O:!0,H:null};let n=this;n.x=t,n.y=e,n.P=i,n.w=L,n.g=L,n.U=0,n.W=0,n.O=l.O,n.G=l.G,n.H=l.H,n.B=1,l._&&(n.U=kt(0,1),n.W=kt(0,1)),n.N=!0,n.J=!1,n.Z="#000",n.K=0}V(t,e){let i=this;if(i.K<1&&i.G){i.K+=t;let l=kt(i.y-2,i.y+i.g+2),n=0;if("bs"==e&&(l=i.y-2,n=-kt(1,3)),kt(0,100)>80){let t=new It(kt(i.x-2,i.x+i.w+2),l,4,4,this.P);t.C=n,P.push(t)}}}q(){let t;this.B++}$(t){let e=this;e.N&&!e.J&&(t.save(),t.translate(e.x,e.y),t.scale(e.U?-1:1,e.W?-1:1),t.drawImage(e.P,-Math.sign(e.U)*e.w,-Math.sign(e.W)*e.g,e.w,e.g),t.restore()),e.J&&!e.tt&&(t.save(),t.fillStyle=e.Z,t.fillRect(e.x,e.y,e.w,e.g),t.strokeStyle=e.Z,t.strokeRect(e.x,e.y,e.w,e.g),t.restore()),e.K>0&&(t.save(),t.fillStyle=e.Z,t.globalAlpha=.65*e.K,t.fillRect(e.x,e.y,e.w,e.g),t.strokeStyle=e.Z,t.strokeRect(e.x,e.y,e.w,e.g),t.restore())}}class St{constructor(t,e){let i=this;i.x=t,i.y=e,i.et=0,i.it=0,i.lt=0,i.C=0,i.nt=1,i.ot=60*10,i.rt=0}st(t){let e=null,i=Ft(this.x,L)/L,l=Ft(this.y,L)/L;return Yt(i,l)&&(e=t[i][l]),e}at(){let t,e;return{x:Ft(this.x,L)/L,y:Ft(this.y,L)/L}}}class Tt extends St{constructor(t,e,i,l,n){super(t,e);let o=this;o.P=n,o.w=i,o.g=l,o.lt=-kt(.1,2),o.ct=!1}q(){let t=this;t.x+=t.lt,t.y+=t.C}$(t){let e=this;t.drawImage(e.P,e.x,e.y,e.w,e.g)}}class It extends St{constructor(t,e,i,l,n,o){super(t,e);let r=this;r.P=n,r.ft=o,r.w=i,r.g=l,r.ut=90,r.ht=0,r.pt=!1,r.dt=!0,r.ct=!1}wt(t){}q(){let t=this;t.ht<t.ut?t.ht++:t.ct=!0,t.pt&&(t.C=0),t.dt&&t.C<10&&(t.C+=m),t.x+=t.lt,t.y+=t.C}$(t){let e=this;e.ft?(t.save(),t.fillStyle=e.ft,t.fillRect(e.x,e.y,e.w,e.g),t.restore()):t.drawImage(e.P,e.x,e.y,e.w,e.g)}}class qt extends St{constructor(t,e,i){super(t,e);let l=this;l.P=i,l.w=10,l.g=14,l.yt=1,l.lt=0,l.C=0,l.bt=.8,l.xt=!1,l.pt=!1,l.gt=!1,l.Mt=!1,l.vt="R",l.kt=1,l.Xt=99999,l.Yt=0,l.Lt=0,l.Dt=0,l.Ft=0,l.jt=3,l.nt=3,l.At=!1,l.Rt=!1,l.Ct=0,l.Pt=120,l.visible=!0,l.St=!1,l.Tt=new Ct(2,0,8)}H(t){let e=this;e.Rt||A||(e.nt-t>0?e.nt-=t:(e.nt=0,e.At=!0),e.Ct=0,e.Rt=!0)}q(){let t=this;t.St?(t.lt*=t.bt,t.C*=t.bt):(t.pt&&(t.C=0),t.gt?(t.kt=2,t.Tt.d=4):(t.kt=1,t.Tt.d=8),t.lt*=t.bt,t.C<10&&(t.C+=m),Math.abs(t.lt)<.1?t.Tt.I=!1:(t.lt>=.5||t.lt<=-.5)&&(t.Tt.I=!0)),A&&(t.lt=0,t.C=0),t.x+=t.lt,t.y+=t.C,t.Tt.q(),t.Rt&&(t.Ct<t.Pt?(t.Ct++,t.visible=!t.visible):(t.Rt=!1,t.visible=!0,t.Ct=0)),t.At&&(t.visible=!1)}$(t){let e=this;t.save();let i=!1;e.Mt&&(i=!0),!i&&e.visible?"L"==e.vt?(t.translate(e.x,e.y),t.scale(-1,1),t.drawImage(e.P,10*e.Tt.f,0,10,16,-10,0,10,16)):"R"==e.vt&&t.drawImage(e.P,10*e.Tt.f,0,10,16,e.x,e.y,10,16):e.Mt&&void 0!==e.It&&!A&&t.drawImage(e.It,e.x,e.y),t.restore()}}class _t extends St{constructor(t,e,i,l,n,o){super(t,e);let r=this;r.P=i,r.w=i.width,r.g=i.height,r.lt=l,r.C=n,r.qt=o}q(){let t=this;t.x+=t.lt,t.y+=t.C}$(t){let e=this;t.drawImage(e.P,e.x,e.y)}}class Et extends St{constructor(t,e,i,l,n){super(t,e);let o=this;o.w=i,o.g=l,o.P=n}q(){let t=this;t.lt+=t.et,t.C+=t.it,t.x+=t.lt,t.y+=t.C}$(t){let e=this;t.drawImage(e.P,e.x,e.y,e.w,e.g)}}class Gt extends St{constructor(t,e,i,l,n,o,r,s=30){super(t,e);let a=this;a.P=n,a.w=i,a.g=l,a._t=o,a.frame=0,a.Et=r,a.Gt=s,a.Ot=0,a.vt="R",a.pt=!1,a.xt=!1,a.lt=0,a.C=0,a.fr=0}Ht(){let t=this;t.pt&&(t.C=0),t.C<10&&(t.C+=m),t.x+=t.lt,t.y+=t.C,t.Ot<t.Gt?t.Ot++:(t.frame<t.Et-1?t.frame++:t.frame=0,t.Ot=0)}$(t){let e=this;t.save(),e.fr&&(t.filter=e.fr),"R"==e.vt?(t.translate(e.x,e.y),t.scale(-1,1),e._t?t.drawImage(e.P,e.frame*e.w,0,e.w,e.g,-16,0,e.w,e.g):t.drawImage(e.P,-10,0,e.w,e.g)):"L"==e.vt&&(e._t?t.drawImage(e.P,e.frame*e.w,0,e.w,e.g,e.x,e.y,e.w,e.g):t.drawImage(e.P,e.x,e.y,e.w,e.g)),t.restore()}}class Ot extends Gt{constructor(t,e,i,l,n){super(t,e,i,l,n,!0,2,4);let o=this;o.lt=kt(0,10)>1?-1:1,1==Math.sign(this.lt)?o.vt="R":o.vt="L",o.fr=kt(0,1)?"hue-rotate("+kt(0,360)+"deg)":0}q(){this.Ht()}wt(t){let e=this;e.lt=-e.lt,e.C=-4,e.xt=!0,e.pt=!1,e.vt="l"==t?"R":"L"}}function Ht(t,e,l){for(arr=[],i=0;i<t;++i){for(columns=[],j=0;j<e;++j)columns[j]=l;arr[i]=columns}return arr}function Ut(t,e=0){if(c=0,e>0){for(c=[],i=0;i<e;i++)im=new Image,im.src=B+t+i+".gif",c.push(im);return c}return c=new Image,c.src=B+t+".gif",c}function Wt(){switch(h.msImageSmoothingEnabled=!1,h.mozImageSmoothingEnabled=!1,h.webkitImageSmoothingEnabled=!1,h.imageSmoothingEnabled=!1,b){case 0:break;case 1:{O?(p.L(5e3),p.moveTo(a*L/2,f*L/2)):p.L(300);let t=[],e=[],l=kt(10,200),n=kt(50,500);for(xp=0;xp<g.length;xp++){let t=Math.floor(.25*f+Math.pow(noise.l(xp/l,0),2)*n);for(yp=t;yp<f;yp++)canAdd=!0,texture=ot[wldt.F],yp>f-f/4&&(texture=rt),canAdd&&(g[xp][yp]=new Pt(xp*L,yp*L,texture,0))}for(let i=0;i<a;i++){let o=Math.floor(.25*f+Math.pow(noise.l(i/l,0),2)*n);for(let l=o;l<f+6;l++){let n=!0,r=10,s=20,a=20,c=Q[wldt.F],u={_:!0,G:!0,O:!0,H:null};l<o+6&&(wldt.A&&(c=K),l==o&&wldt.j&&(c=Z,u._=!1,kt(0,100)>80&&Rt(i,l,N,kt(8,12),!0)),l==o&&c==Q[2]&&kt(0,100)>80&&Rt(i,l,J,kt(2,6),!1),l==o&&Yt(i,l-1)&&(M[i][l-1]||t.push({x:i,y:l-1}))),l>f-f/4&&(c=tt),noise.seed(W[0]),p2=noise.l(i/s,l/s),p2>.05&&p2<.2&&(c=V,l>f-f/4&&(c=lt,u.G=!1,u.O=!1,u.H=3)),noise.seed(W[1]),p3=noise.l(i/a,l/a),p3>.025&&p3<.3&&(c=$,u.O=!0,u.G=!0),noise.seed(U),l>o+5*Math.random()+3&&noise.l(i/r,l/r)>.1&&(n=!1),n&&(tl=new Pt(i*L,l*L,c,u),M[i][l]=tl,Yt(i,l-1)&&(M[i][l-1]||e.push({x:i,y:l-1}))),l>f-kt(6,8)&&(M[i][l]=new Pt(i*L,l*L,et,{_:!0,G:!1,O:!0}))}}let o={_:!1,G:!0,O:!0};for(i=0;i<9;i++){let t=kt(0,e.length-1),i=e[t];e.splice(t,1),M[i.x][i.y]=new Pt(i.x*L,i.y*L,nt,o)}for(i=0;i<5;i++){let t=e[kt(0,e.length-1)];M[t.x][t.y]=new Pt(t.x*L,t.y*L,mt,o)}let r=Math.floor(a/2);O||((ft=new qt(r*L,128,ft)).It=ut,w.push(ft));let s=t[kt(0,t.length-1)];M[s.x][s.y]=new Pt(s.x*L,s.y*L,ct,o),ft.x=s.x*L,ft.y=s.y*L,M[s.x][s.y].G=!1,M[s.x][s.y+1].G=!1;break}}}function Bt(){if(F&&F.q(),w.length>0){wcam={x:p.u.h,y:p.u.m},snc={h:Ft(wcam.x,L)/L,m:Ft(wcam.y,L)/L,w:Ft(p.u.w,L)/L+2,g:Ft(p.u.g,L)/L+2};let e=w[0];if(!e.At){if(x[90]&&(G++,e.St||!e.xt&&e.pt&&(e.xt=!0,e.pt=!1,e.C=-4),e.St&&e.C>-e.yt&&e.C--),x[40]?(e.Mt=!0,G++,e.St&&e.C<e.yt&&e.C++):e.Mt=!1,x[39]&&(G++,e.lt<e.yt*e.kt&&(e.lt++,e.vt="R")),x[37]&&(G++,e.lt>-e.yt*e.kt&&(e.lt--,e.vt="L")),x[88]){if(e.gt=!0,G++,e.Yt<e.Xt)e.Yt++;else if(e.Dt>0&&!e.Mt){let t=0;t="L"==e.vt?-5:5;let i=new _t(e.x,e.y+7,ht,t,0,!0);S.push(i),e.Dt--,e.Yt=0}}else e.gt=!1,e.Yt=e.Xt-1;if(x[38]){let t=e.st(k),i=e.at();t&&t.P==it&&(e.C=-2);let l=null;for(y=i.y;y>0;y--)Yt(i.x,i.y)&&(null!=M[i.x][y]||l||(l=y));l&&e.Ft>0&&(k[i.x][l]||(k[i.x][l]=new Pt(i.x*L,l*L,it,{_:!1}),e.Ft--))}}for(i=0;i<w.length;i++)e.q();if(e.pt=!1,_<q)_++;else{let t=new Tt(r,kt(0,s),kt(64,256),kt(32,64),bt[kt(0,bt.length-1)]);R.push(t),_=0}if(I<T)I++;else{let t=[];if(Xt(snc,(function(e,i){if(Yt(e,i)){let l;null!=M[e][i]&&i-1>=0&&null==M[e][i-1]&&t.push({x:e,y:i-1})}})),C.length<50){let i=t[kt(0,t.length-1)];if(i&&Mt(e.x,e.y,i.x*L,i.y*L)>70){let t=pt,e=16,l=12;kt(0,10)>=5&&(t=dt,l=8);let n=new Ot(i.x*L,i.y*L,e,l,t);C.push(n)}}I=0}for(R=R.filter(t=>!t.ct),i=0;i<R.length;i++){let t=R[i];t.x<-t.w&&(t.ct=!0),t.C=-w[0].C*D,t.q()}for(P=P.filter(t=>!t.ct),i=0;i<P.length;i++){let e=P[i];e.q();let l=e.at();for(xp=l.x-3;xp<l.x+3;xp++)for(yp=l.y-3;yp<l.y+3;yp++)Yt(xp,yp)&&(t=M[xp][yp],null!==t&&t.O&&(d=Lt(e,t),"bs"===d&&(e.pt=!0),d||(e.pt=!1)))}for(i=0;i<C.length;i++){if(mob=C[i],mob.q(),mob.pt=!1,e.x+e.w>mob.x&&e.x<mob.x+mob.w&&e.y+e.g>mob.y&&e.y<mob.y+mob.g)if(e.C>=0&&e.y+e.g<mob.y+mob.g/2)e.xt=!0,e.pt=!1,e.xt?e.C=4*-e.yt:e.C=2*-e.yt,C.splice(i,1);else{let t;Dt(e,mob)&&e.H(1)}for(tp=mob.at(),xp=tp.x-3;xp<tp.x+3;xp++)for(yp=tp.y-3;yp<tp.y+3;yp++)Yt(xp,yp)&&(t=M[xp][yp],null!==t&&t.O&&(d=Lt(mob,t),"l"===d||"r"===d?(mob.wt(d),mob.xt=!1):"bs"===d&&(mob.pt=!0,mob.xt=!1,mob.C*=-1)));for(mob.x<snc.h*L||mob.x>(snc.h+snc.w)*L||mob.y<snc.m*L||mob.y>(snc.m+snc.g)*L?mob.rt<mob.ot?mob.rt++:C.splice(i,1):mob.rt=0,j=0;j<S.length;j++)if(Dt(S[j],mob)){let t=new It(S[j].x,S[j].y,8,8,at);t.ut=2,t.dt=!1,P.push(t),C.splice(i,1),S.splice(j,1)}}for(i=0;i<S.length;i++)S[i].q();if(Xt(snc,(t,i)=>{if(tl=M[t][i],null!==tl){if(tl.q(),tl.P==Z){let e={_:!1,G:!0,O:!0};if(t-1>=0){let l=M[t-1][i];l&&l.P==K&&(jt(t-1,i)||M[t-1][i-1]||kt(0,1e4)>9950&&(M[t-1][i]=new Pt((t-1)*L,i*L,Z,e)))}if(t+1<a){let l=M[t+1][i];l&&l.P==K&&(jt(t+1,i)||M[t+1][i-1]||kt(0,1e4)>9950&&(M[t+1][i]=new Pt((t+1)*L,i*L,Z,e)))}}else if(tl.P==lt&&tl.B%120==0){let e={_:!0,G:!1,O:!1};if(i+1<f){let l;M[t][i+1]||(M[t][i+1]=new Pt(t*L,(i+1)*L,lt,e))}}if(i+1<f){if("rock"==At(tl)&&tl.P!==Q[2]&&!M[t][i+1]&&kt(0,1e4)>9990){let t=new It(kt(tl.x-2,tl.x+tl.w+2),tl.y+tl.g+2,4,4,null,"#4444FF");P.push(t)}if(tl.P==Q[2]&&!M[t][i+1]&&kt(0,1e4)>kt(9800,9990)){let t=new It(kt(tl.x-2,tl.x+tl.w+2),tl.y+tl.g,4,4,null,"#ffe3a6");t.dt=!1,t.C=.1,t.ut=kt(120,1200),P.push(t)}}if(tl.P==ct&&e.Lt>=9&&Mt(e.x,e.y,tl.x,tl.y)<32&&(tl.K=100,(F=new Et(t*L,i*L,L,L,ct)).it=-.01,e.visible=!1,p.moveTo(F.x,F.y),A=!0),tl.O){d=Lt(e,tl);let t=.05;tl.P==V&&(t=.5),"l"===d||"r"===d?(e.lt=0,e.xt=!1,e.Tt.d=9999,tl.V(t,d)):"bs"===d?(e.pt=!0,e.xt=!1,e.Mt&&tl.V(t,d),e.C>8&&e.H(Math.round(.1*e.C))):"t"===d&&(e.C*=-1)}if(null!=tl.H&&Dt(e,tl)&&e.H(tl.H),tl.K>0&&(tl.K-=.001),tl.K>=1){if(tl.P==V)e.Dt+=1;else if(tl.P==$){let t=1;t=kt(0,100)>80?kt(2,3):t,e.Ft+=t}else tl.P==mt?(e.jt+=1,e.nt=e.jt):tl.P==nt&&(e.Lt+=1);M[t][i]=null}}}),w[0].x=vt(w[0].x,0,a*L-w[0].w),w[0].y=vt(w[0].y,0,f*L-w[0].g+128),w[0].y>f*L&&w[0].H(50),A){if(F){p.moveTo(F.x,F.y);let t=["#ffb012","#ffb012","#ffffff"],e=t[kt(0,t.length-1)],l=kt(2,16);for(i=0;i<4;i++){let t=new It(kt(F.x-4,F.x+F.w-8),kt(F.y+F.g,F.y+F.g+32),l,l,null,e);t.ut=15,t.C=kt(0,5),P.push(t)}}}else O?p.moveTo(a*L/2,f*L/2):(ppos={x:w[0].x,y:w[0].y},p.moveTo(Math.round(ppos.x),Math.round(ppos.y)));p.u.h=vt(p.u.h,0,a*L-p.u.w),p.u.m=vt(p.u.m,0,f*L-p.u.g)}}function Nt(t){for(t.clearRect(0,0,r,s-4),wldt.R&&(t.save(),t.fillStyle=wldt.skyColor,t.fillRect(0,0,r,s),grd=t.createLinearGradient(r,0,r,s),grd.addColorStop(0,"rgba(0, 0, 0, 0.500)"),grd.addColorStop(1,"rgba(0, 0, 0, 0.000)"),t.fillStyle=grd,t.fillRect(0,0,r,s),t.restore()),i=0;i<R.length;i++){let e;R[i].$(t)}for(p.v(),wcam={x:p.u.h,y:p.u.m,w:p.u.w,g:p.u.g},snc={h:Ft(wcam.x,L)/L,m:Ft(wcam.y,L)/L,w:Ft(p.u.w,L)/L,g:Ft(p.u.g,L)/L},Xt(snc,(function(e,i){let l=g[e][i],n=k[e][i],o=M[e][i];l&&(M[e][i]&&M[e][i].P!=nt||l.$(t)),n&&n.$(t),o&&o.$(t)})),F&&F.$(t),i=0;i<P.length;i++)P[i].$(t);for(i=0;i<w.length;i++)w[i].$(t);for(i=0;i<C.length;i++)C[i].$(t);for(i=0;i<S.length;i++)S[i].$(t);if(p.end(),w.length>0){for(G>2e3&&(E=!0),i=0;i<w[0].jt;i++)t.drawImage(yt,32+32*i,32,32,32),i<w[0].nt&&t.drawImage(wt,32+32*i,32,32,32);let e=[{Ut:nt,T:ft.Lt+"/9"},{Ut:ht,T:ft.Dt},{Ut:$,T:ft.Ft}];for(i=0;i<e.length;i++){let l=e[i];t.drawImage(l.Ut,32,80+48*i,32,32),t.save(),t.font="bold 24px monospace",t.fillStyle="#fff",t.fillText(l.T,72,106+48*i),t.restore()}let l=[],n="",o=280;if(E||O||w[0].At||A||(l[0]="CRYSTAL BLAST",l[1]="",l[2]="You're stranded!",l[3]="Collect nine energy crystals to get back to orbit.",l[4]="Z=Jump; X=Dash/Shoot; Left/Right Arrow=Move and Drill; Drill Down=Down Arrow; Ladders=Up Arrow",o=64),w[0].At&&(l[0]="You broke. :c",n="Please reload your browser to restart."),A&&F.y<0&&(l[0]="You're on your way to orbit!",n="Reload to run out of fuel and crash again."),""!=l){t.save(),t.fillStyle="#111",t.fillRect(0,o-32,r,128),t.fillStyle="#fff";let e=32-4*l.length;for(t.font=e+"px monospace",i=0;i<l.length;i++)t.fillText(l[i],r/2-t.measureText(l[i]).width/2,o+e+i*(e+4));t.font="14px monospace",t.fillText(n,r/2-t.measureText(n).width/2,340),t.restore()}}}function zt(){Bt(),Nt(h),requestAnimationFrame(zt)}ael=addEventListener,ael("DOMContentLoaded",t=>{Wt(),zt()}),ael("keydown",t=>{c=t.keyCode||t.which,x[c]=1}),ael("keyup",t=>{c=t.keyCode||t.which,x[c]=0})},{}]},{},[1]);