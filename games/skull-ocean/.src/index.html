<!doctype html><html><title>ðŸ’€</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta property="og:image" content="https://platane.github.io/skull-ocean/images/800x800.jpg"><meta name="description" content="A grim wave simulation. It was made for the 2022 js13kGames.com competition."><meta name="title" content="Skull Ocean"><meta name="viewport" content="width=device-width,initial-scale=1"><style>html{font-family:monospace,sans-serif;background-color:#ede5d2;color:#42372b}canvas{position:fixed;top:0;left:0;width:100%;height:100%;background-image:linear-gradient(#ede5d2,#d7c69f);touch-action:none}footer{position:fixed;bottom:0;right:0;padding:0 4px;font-size:16px}div{position:fixed;top:10px;left:10px}h1{margin-top:0}</style><body><canvas></canvas><div><h1>Skull Ocean</h1><span>Tap to create waves<br>Slide to rotate</span></div><footer><a href="https://github.com/platane/skull-ocean">source</a></footer></body><script>let t=document.getElementsByTagName("canvas")[0],a=t.getContext("webgl2"),r=Math.min(window.devicePixelRatio??1,2),n=()=>{const n=window.innerWidth*r,o=window.innerHeight*r;t.width=n,t.height=o,a.viewport(0,0,n,o)};n(),window.addEventListener("resize",n);var o,e="undefined"!=typeof Float32Array?Float32Array:Array;function l(){var t=new e(9);return e!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function i(t,a){t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[4],t[4]=a[5],t[5]=a[6],t[6]=a[8],t[7]=a[9],t[8]=a[10]}function h(t,a){var r=a[0],n=a[1],o=a[2],e=a[3],l=a[4],i=a[5],h=a[6],M=a[7],v=a[8],c=a[9],u=a[10],s=a[11],f=a[12],w=a[13],m=a[14],y=r*i-n*l,p=r*h-o*l,g=r*M-e*l,A=n*h-o*i,_=n*M-e*i,d=o*M-e*h,F=v*w-c*f,x=v*m-u*f,X=c*m-u*w;(s=y*(u=u*(a=a[15])-s*m)-p*(c=c*a-s*w)+g*X+A*(v=v*a-s*f)-_*x+d*F)&&(t[0]=(i*u-h*c+M*X)*(s=1/s),t[1]=(h*v-l*u-M*x)*s,t[2]=(l*c-i*v+M*F)*s,t[3]=(o*c-n*u-e*X)*s,t[4]=(r*u-o*v+e*x)*s,t[5]=(n*v-r*c-e*F)*s,t[6]=(w*d-m*_+a*A)*s,t[7]=(m*g-f*d-a*p)*s,t[8]=(f*_-w*g+a*y)*s)}function M(){var t=new e(16);return e!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function v(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}function c(t,a,r){var n=a[0],o=a[1],e=a[2],l=a[3],i=a[4],h=a[5],M=a[6],v=a[7],c=a[8],u=a[9],s=a[10],f=a[11],w=a[12],m=a[13],y=a[14];a=a[15];var p=r[0],g=r[1],A=r[2],_=r[3];t[0]=p*n+g*i+A*c+_*w,t[1]=p*o+g*h+A*u+_*m,t[2]=p*e+g*M+A*s+_*y,t[3]=p*l+g*v+A*f+_*a,t[4]=(p=r[4])*n+(g=r[5])*i+(A=r[6])*c+(_=r[7])*w,t[5]=p*o+g*h+A*u+_*m,t[6]=p*e+g*M+A*s+_*y,t[7]=p*l+g*v+A*f+_*a,t[8]=(p=r[8])*n+(g=r[9])*i+(A=r[10])*c+(_=r[11])*w,t[9]=p*o+g*h+A*u+_*m,t[10]=p*e+g*M+A*s+_*y,t[11]=p*l+g*v+A*f+_*a,t[12]=(p=r[12])*n+(g=r[13])*i+(A=r[14])*c+(_=r[15])*w,t[13]=p*o+g*h+A*u+_*m,t[14]=p*e+g*M+A*s+_*y,t[15]=p*l+g*v+A*f+_*a}function u(t,a,r){var n=a[0],o=a[1],e=a[2],l=a[3],i=n+n,h=o+o,M=e+e;a=n*i;var v=n*h;n*=M;var c=o*h;o*=M,i*=l,h*=l,l*=M,t[0]=1-(c+(e*=M)),t[1]=v+l,t[2]=n-h,t[3]=0,t[4]=v-l,t[5]=1-(a+e),t[6]=o+i,t[7]=0,t[8]=n+h,t[9]=o-i,t[10]=1-(a+c),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1}function s(){var t=L,a=1/Math.tan(S/2);t[0]=a/z,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,t[10]=2000.005*(a=1/-1999.995),t[14]=20*a}function f(){var t=new e(3);return e!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function w(t,a){var r=new e(3);return r[0]=t,r[1]=a,r[2]=0,r}function m(t,a,r,n){return t[0]=a,t[1]=r,t[2]=n,t}function y(t,a,r){t[0]=a[0]-r[0],t[1]=a[1]-r[1],t[2]=a[2]-r[2]}function p(t,a,r,n){t[0]=a[0]+r[0]*n,t[1]=a[1]+r[1]*n,t[2]=a[2]+r[2]*n}function g(t,a){var r=a[0],n=a[1],o=a[2];0<(r=r*r+n*n+o*o)&&(r=1/Math.sqrt(r)),t[0]=a[0]*r,t[1]=a[1]*r,t[2]=a[2]*r}function A(t,a){return t[0]*a[0]+t[1]*a[1]+t[2]*a[2]}function _(t,a,r){var n=a[0],o=a[1],e=r[0],l=r[1];t[0]=o*(r=r[2])-(a=a[2])*l,t[1]=a*e-n*r,t[2]=n*l-o*e}function d(t,a,r){var n=a[0],o=a[1],e=r[3]*n+r[7]*o+r[11]*(a=a[2])+r[15];t[0]=(r[0]*n+r[4]*o+r[8]*a+r[12])/(e=e||1),t[1]=(r[1]*n+r[5]*o+r[9]*a+r[13])/e,t[2]=(r[2]*n+r[6]*o+r[10]*a+r[14])/e}function F(){var t=new e(4);return e!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function x(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function X(t,a,r){r*=.5;var n=a[0],o=a[1],e=a[2];a=a[3];var l=Math.sin(r);r=Math.cos(r),t[0]=n*r+a*l,t[1]=o*r+e*l,t[2]=e*r-o*l,t[3]=a*r-n*l}function Y(t,a,r){r*=.5;var n=a[0],o=a[1],e=a[2];a=a[3];var l=Math.sin(r);r=Math.cos(r),t[0]=n*r-e*l,t[1]=o*r+a*l,t[2]=e*r+n*l,t[3]=a*r-o*l}function C(t,a,r,n){var o=a[0],e=a[1],l=a[2],i=r[0],h=r[1],M=r[2],v=o*i+e*h+l*M+(a=a[3])*(r=r[3]);if(0>v&&(v=-v,i=-i,h=-h,M=-M,r=-r),1e-6<1-v){var c=Math.acos(v),u=Math.sin(c);v=Math.sin((1-n)*c)/u,n=Math.sin(n*c)/u}else v=1-n;t[0]=v*o+n*i,t[1]=v*e+n*h,t[2]=v*l+n*M,t[3]=v*a+n*r}function D(t){var a=360*Math.random(),r=360*Math.random(),n=360*Math.random(),o=.5*Math.PI/180;a*=o,r*=o,n*=o,o=Math.sin(a),a=Math.cos(a);var e=Math.sin(r);r=Math.cos(r);var l=Math.sin(n);n=Math.cos(n),t[0]=o*r*n-a*e*l,t[1]=a*e*n+o*r*l,t[2]=a*r*l-o*e*n,t[3]=a*r*n+o*e*l}Math.hypot||(Math.hypot=function(){for(var t=0,a=arguments.length;a--;)t+=arguments[a]*arguments[a];return Math.sqrt(t)}),f(),o=new e(4),e!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[3]=0);var P=(()=>{var t=f(),a=w(1,0),r=w(0,1);return(n,o,e)=>{var l=A(o,e);return-.999999>l?(_(t,a,o),1e-6>Math.hypot(t[0],t[1],t[2])&&_(t,r,o),g(t,t),o=Math.PI,o*=.5,e=Math.sin(o),n[0]=e*t[0],n[1]=e*t[1],n[2]=e*t[2],n[3]=Math.cos(o),n):.999999<l?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(_(t,o,e),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+l,((t,a)=>{var r=a[0],n=a[1],o=a[2],e=r*r+n*n+o*o+(a=a[3])*a;return 0<e&&(e=1/Math.sqrt(e)),t[0]=r*e,t[1]=n*e,t[2]=o*e,t[3]=a*e,t})(n,n))}})();function b(){var t=new e(2);return e!=Float32Array&&(t[0]=0,t[1]=0),t}F(),F(),l(),b();let j=new Float32Array(36),I=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,I),a.bufferData(a.ARRAY_BUFFER,j,a.DYNAMIC_DRAW);let L=new Float32Array(16),S=Math.PI/3,z=window.innerWidth/window.innerHeight;s();let k=1.2,q=1,U=5,B=[0,0,0],E=[0,0,1],G=[0,1,0],H=M(),J=l(),K=M(),N=l(),O=()=>{var t=12+U*U*.18,r=Math.sin(k)*t;E[0]=r*Math.sin(q),E[1]=Math.cos(k)*t,E[2]=r*Math.cos(q),t=E[0],r=E[1];var n=E[2],o=G[0],e=G[1],l=G[2],M=B[0],u=B[1],s=B[2];if(1e-6>Math.abs(t-M)&&1e-6>Math.abs(r-u)&&1e-6>Math.abs(n-s))v(H);else{M=t-M,u=r-u;var f=n-s,w=1/Math.hypot(M,u,f);s=e*(f*=w)-l*(u*=w),l=l*(M*=w)-o*f,o=o*u-e*M,(w=Math.hypot(s,l,o))?(s*=w=1/w,l*=w,o*=w):o=l=s=0,e=u*o-f*l;var m=f*s-M*o,y=M*l-u*s;(w=Math.hypot(e,m,y))?(e*=w=1/w,m*=w,y*=w):y=m=e=0,H[0]=s,H[1]=e,H[2]=M,H[3]=0,H[4]=l,H[5]=m,H[6]=u,H[7]=0,H[8]=o,H[9]=y,H[10]=f,H[11]=0,H[12]=-(s*t+l*r+o*n),H[13]=-(e*t+m*r+y*n),H[14]=-(M*t+u*r+f*n),H[15]=1}for(c(K,L,H),i(J,H),h(N,H),r=Math.hypot(E[0],E[2]),t=9999,.81<E[1]&&(t=(17*1.4+r)/((E[1]-.8)/(E[1]- -4))-r),r=0;4>r;r++)n=2*Math.PI*r/4+Math.PI/4,M=2*Math.PI*(r+1)/4+Math.PI/4,j[9*r]=0,j[9*r+1]=-4,j[9*r+2]=0,j[9*r+3]=Math.sin(n)*t,j[9*r+4]=-4,j[9*r+5]=Math.cos(n)*t,j[9*r+6]=Math.sin(M)*t,j[9*r+7]=-4,j[9*r+8]=Math.cos(M)*t;a.bindBuffer(a.ARRAY_BUFFER,I),a.bufferSubData(a.ARRAY_BUFFER,0,j)};O();let Q=0,R=null,T=null,V=null,W=t=>{1===t.length?(R=null,(([{pageX:t,pageY:a}])=>{T=t,V=a})(t)):1<t.length&&(T=null,(([{pageX:t,pageY:a},{pageX:r,pageY:n}])=>{Q=U,R=Math.sqrt((t-r)**2+(a-n)**2)})(t))};t.addEventListener("wheel",t=>{U=Math.min(Math.max(U+(0>t.deltaY?-1:1),0),10),O()},{passive:1}),window.addEventListener("resize",()=>{z=window.innerWidth/window.innerHeight,s(),O()},{passive:1});let Z=[],$=(t,a,r,n)=>{var o=K[0],e=K[1],l=K[2],i=K[3],h=K[4],M=K[5],v=K[6],c=K[7],u=K[8],s=K[9],f=K[10],w=K[11],m=K[12],p=K[13],A=K[14],_=K[15],F=o*M-e*h,x=o*v-l*h,X=o*c-i*h,Y=e*v-l*M,C=e*c-i*M,D=l*c-i*v,P=u*p-s*m,b=u*A-f*m,j=u*_-w*m,I=s*A-f*p,L=s*_-w*p,S=f*_-w*A,z=F*S-x*L+X*I+Y*j-C*b+D*P;z&&(Z[0]=(M*S-v*L+c*I)*(z=1/z),Z[1]=(l*L-e*S-i*I)*z,Z[2]=(p*D-A*C+_*Y)*z,Z[3]=(f*C-s*D-w*Y)*z,Z[4]=(v*j-h*S-c*b)*z,Z[5]=(o*S-l*j+i*b)*z,Z[6]=(A*X-m*D-_*x)*z,Z[7]=(u*D-f*X+w*x)*z,Z[8]=(h*L-M*j+c*P)*z,Z[9]=(e*j-o*L-i*P)*z,Z[10]=(m*C-p*X+_*F)*z,Z[11]=(s*X-u*C-w*F)*z,Z[12]=(M*b-h*I-v*P)*z,Z[13]=(o*I-e*b+l*P)*z,Z[14]=(p*x-m*Y-A*F)*z,Z[15]=(u*Y-s*x+f*F)*z),d(a,[r,n,.5],Z),y(a,a,E),g(a,a),t[0]=E[0],t[1]=E[1],t[2]=E[2]},tt=f(),at=f(),rt=(t,a)=>{var r=lt;t[0]=r[3*a],t[1]=r[3*a+1],t[2]=r[3*a+2]},nt=(t,a,r)=>{t[0]=a[4*r],t[1]=a[4*r+1],t[2]=a[4*r+2],t[3]=a[4*r+3]},ot=(t,a)=>{var r=va;t[3*a]=r[0],t[3*a+1]=r[1],t[3*a+2]=r[2]},et=(t,a,r)=>{t[4*a]=r[0],t[4*a+1]=r[1],t[4*a+2]=r[2],t[4*a+3]=r[3]},lt=new Float32Array(7500),it=new Float32Array(1e4),ht=f(),Mt=f(),vt=f(),ct=0,ut=0,st=0,ft=f(),wt=f(),mt=f(),yt=F();x(yt),mt[1]=2;let pt=f();pt[2]=1;let gt=[],At=b(),_t=f(),dt=17*1.6,Ft=Array.from({length:2}).map((t,a,{length:r})=>{t=a/r,(a=b())[1]=1;var n=(Math.random()-.5)*Math.PI*.1;r=a[0]-At[0];var o=a[1]-At[1],e=Math.sin(n);return n=Math.cos(n),a[0]=r*n-o*e+At[0],a[1]=r*e+o*n+At[1],r=f(),o=Math.random(),{n:a,t:25.5,o:t*dt*2-dt,l:3,i:0,h:4,force:m(r,0,-(.5*(1-o)+.6*o),0)}});gt.push(...Ft);let xt={n:b(),t:0,o:1,i:1,l:1,h:0,force:m(f(),0,0,0),s:0,M:Infinity};gt.push(xt);let Xt,Yt=f(),Ct=f(),Dt=b(),Pt=0,bt=null,jt=t=>{t[0]&&(bt={pageX:t[0].pageX,pageY:t[0].pageY,timeStamp:Date.now()}),W(t)},It=t=>{if(bt&&40<Math.hypot(t[0].pageX-bt.pageX,t[0].pageY-bt.pageY)&&(bt=null),null!==R){const[{pageX:a,pageY:r},{pageX:n,pageY:o}]=t;U=Math.min(Math.max(Q/Math.sqrt((a-n)**2+(r-o)**2)*R,0),10),O()}(([{pageX:t,pageY:a}])=>{null!==T&&(q-=(t-T)/window.innerHeight*4,k-=(a-V)/window.innerHeight*4,k=Math.min(Math.max(k,.14*Math.PI),.45*Math.PI),document.getElementsByTagName("div")[0].style.opacity=""+Math.min(Math.max(4*k-3.4,0),1),T=t,V=a,O())})(t);const{pageX:a,pageY:r}=t[0];$(Mt,vt,a/window.innerWidth*2-1,-(r/window.innerHeight*2-1)),p(ht,Mt,vt,(0-Mt[1])/vt[1]),Xt=t;let n=0,o=0;for(const{pageX:a,pageY:r}of t)n+=a,o+=r;n/=t.length,o/=t.length,$(tt,at,n/window.innerWidth*2-1,-(o/window.innerHeight*2-1)),p(_t,tt,at,(1-tt[1])/at[1])},Lt=t=>{T=R=null,W(t),bt&&Date.now()<bt.timeStamp+300&&(0<ut?st=1:(st=0,ct=1,ut=.2,console.log("acc")),(()=>{if(!(Pt+3>Date.now()/1e3)){Pt=Date.now()/1e3;var[{pageX:t,pageY:a}]=Xt;$(Yt,Ct,t/window.innerWidth*2-1,-(a/window.innerHeight*2-1)),p(_t,Yt,Ct,(1-Yt[1])/Ct[1]);var r=b();r[0]=-Ct[0],r[1]=-Ct[2],((t,a)=>{var r=a[0],n=a[1];0<(r=r*r+n*n)&&(r=1/Math.sqrt(r)),t[0]=a[0]*r,t[1]=a[1]*r})(r,r),Dt[0]=_t[0],Dt[1]=_t[2];var n=Math.max(...[(17-Dt[0])/r[0],(17-Dt[1])/r[1],(-17-Dt[1])/r[1],(-17-Dt[0])/r[0]].filter(t=>0>t));((t,a)=>{var r=Dt,n=Dt;r[0]=n[0]+t[0]*a,r[1]=n[1]+t[1]*a})(r,n),n=4+6*Math.random();var o=1.3+.5*Math.random(),e={n:r,t:.5,v:n,u:o,h:5,o:r[0]*Dt[0]+r[1]*Dt[1],i:-r[1]*Dt[0]+r[0]*Dt[1],l:1,force:f(),s:0,M:Infinity};e.force[1]=.2*Math.random()-1.2,gt.push(e),(n={n:r,t:1.5,v:n+2,u:o,h:5,o:r[0]*Dt[0]+r[1]*Dt[1]-3.5,i:-r[1]*Dt[0]+r[0]*Dt[1],l:1,force:f(),s:0,M:Infinity}).force[0]=.2*r[0],n.force[1]=.8,n.force[2]=.2*r[1],gt.push(n)}})())};t.addEventListener("mousedown",t=>jt([t])),t.addEventListener("mousemove",t=>It([t])),t.addEventListener("mouseup",()=>Lt([])),t.addEventListener("touchstart",t=>jt(Array.from(t.touches)),{passive:1}),t.addEventListener("touchmove",t=>It(Array.from(t.touches)),{passive:1}),t.addEventListener("touchend",t=>Lt(Array.from(t.touches)),{passive:1});let St=(t,a,r)=>(0>r&&(r+=1),1<r&&--r,r<1/6?t+6*(a-t)*r:.5>r?a:r<2/3?t+(a-t)*(2/3-r)*6:t),zt=a.createBuffer(),kt=a.createBuffer(),qt=a.createBuffer(),Ut=new Float32Array(1e4);Ut.fill(1);let Bt=new Float32Array(4e4),Et=Array.from({length:2500},(t,a)=>new Float32Array(Bt.buffer,64*a,16)),Gt=new Float32Array(4e4),Ht=Array.from({length:2500},(t,a)=>(v(t=new Float32Array(Gt.buffer,64*a,16)),t)),Jt=l();a.bindBuffer(a.ARRAY_BUFFER,zt),a.bufferData(a.ARRAY_BUFFER,Bt,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,kt),a.bufferData(a.ARRAY_BUFFER,Gt,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,qt),a.bufferData(a.ARRAY_BUFFER,Ut,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null);let Kt=f(),Nt=F(),Ot=[0,0,0],Qt=[0,0,0],Rt=[0,0,0],Tt=[0,0,0],Vt=[0,0,0],Wt=[0,0,0],Zt=[0,0,0],$t=t=>{const a=new Float32Array(t.length);for(let r=0;r<t.length/3;r+=3){const n=3*(r+0),o=3*(r+1),e=3*(r+2);m(Tt,t[n+0],t[n+1],t[n+2]),m(Vt,t[o+0],t[o+1],t[o+2]),m(Wt,t[e+0],t[e+1],t[e+2]),y(Qt,Tt,Vt),y(Rt,Tt,Wt),_(Zt,Qt,Rt),g(Zt,Zt),a[n+0]=a[o+0]=a[e+0]=Zt[0],a[n+1]=a[o+1]=a[e+1]=Zt[1],a[n+2]=a[o+2]=a[e+2]=Zt[2]}return a},ta=a.createBuffer(),aa=a.createBuffer(),ra=a.createBuffer(),na=[[0,0,1.5],[.6,0,.5],[-.6,0,.5],[-.6,0,.5],[.6,0,.5],[.4,0,-1.5],[-.6,0,.5],[.4,0,-1.5],[-.4,0,-1.5]],oa=$t(na.flat()),ea=Array.from({length:na.length},(t,a)=>[oa[3*a],oa[3*a+1],oa[3*a+2]]),la=new Float32Array(Array.from({length:100},()=>[.2,.78,.85]).flat()),ia=M(),ha=M(),Ma=l(),va=f(),ca=new Float32Array(3*na.length),ua=new Float32Array(3*na.length);a.bindBuffer(a.ARRAY_BUFFER,ta),a.bufferData(a.ARRAY_BUFFER,ca,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,aa),a.bufferData(a.ARRAY_BUFFER,ca,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,ra),a.bufferData(a.ARRAY_BUFFER,la,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null);let sa,fa=(t,r)=>{t=wa(t,a.VERTEX_SHADER),r=wa(r,a.FRAGMENT_SHADER);const n=a.createProgram();return a.attachShader(n,t),a.attachShader(n,r),a.linkProgram(n),n},wa=(t,r)=>(r=a.createShader(r),a.shaderSource(r,t),a.compileShader(r),r),ma=t=>{for(let r=0;4>r;++r){const n=t+r;a.enableVertexAttribArray(n),a.vertexAttribPointer(n,4,a.FLOAT,0,64,16*r),a.vertexAttribDivisor(n,1)}},ya=async()=>{const t=await fetch("skull-vertices.bin").then(t=>t.arrayBuffer()),a=new Uint16Array(t);return new Float32Array(Array.from({length:a.length},(t,r)=>.95*(a[r]/65536-.5)))},pa=fa("#version 300 es\nin vec4 a_position;in vec4 a_normal;in vec4 a_color;in mat4 a_matrix;in mat4 a_normalMatrix;uniform mat4 u_matrix;out vec3 v_color;out vec3 v_normal;void main(){gl_Position=u_matrix*a_matrix*a_position;v_normal=vec3(a_normalMatrix*a_normal);v_color=a_color.rgb;}","#version 300 es\nprecision highp float;in vec3 v_color;in vec3 v_normal;out vec4 outColor;void main(){vec3 staticLightDirection=vec3(0.615457,0.492365,0.615457);float staticLightPower=dot(v_normal,staticLightDirection);outColor=vec4(v_color,1.0);outColor.rgb*=0.6+clamp(staticLightPower,-0.47,10.0)*0.45;}"),ga=a.getUniformLocation(pa,"u_matrix"),Aa=a.createVertexArray();a.bindVertexArray(Aa);var _a=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,_a),a.bufferData(a.ARRAY_BUFFER,new Float32Array,a.STATIC_DRAW);let da=a.getAttribLocation(pa,"a_position");a.enableVertexAttribArray(da),a.vertexAttribPointer(da,3,a.FLOAT,0,0,0);var Fa=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,Fa),a.bufferData(a.ARRAY_BUFFER,new Float32Array,a.STATIC_DRAW);let xa=a.getAttribLocation(pa,"a_normal");a.enableVertexAttribArray(xa),a.vertexAttribPointer(xa,3,a.FLOAT,0,0,0),a.bindBuffer(a.ARRAY_BUFFER,qt);let Xa=a.getAttribLocation(pa,"a_color");a.enableVertexAttribArray(Xa),a.vertexAttribPointer(Xa,4,a.FLOAT,0,0,0),a.vertexAttribDivisor(Xa,1),a.bindBuffer(a.ARRAY_BUFFER,zt),ma(a.getAttribLocation(pa,"a_matrix")),a.bindBuffer(a.ARRAY_BUFFER,kt),ma(a.getAttribLocation(pa,"a_normalMatrix")),a.bindVertexArray(null);let Ya=0;(async()=>{var t=await(sa||(sa=ya()));return{m:t=new Float32Array(t.buffer,0,1314),p:$t(t)}})().then(({m:t,p:r})=>{a.bindBuffer(a.ARRAY_BUFFER,_a),a.bufferData(a.ARRAY_BUFFER,t,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,Fa),a.bufferData(a.ARRAY_BUFFER,r,a.DYNAMIC_DRAW),Ya=t.length/3});let Ca=fa("#version 300 es\nin vec4 a_position;in mat4 a_matrix;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*a_matrix*a_position;}","#version 300 es\nprecision highp float;out vec4 outColor;void main(){outColor=vec4(0.18,0.09,0.08,1);}"),Da=a.getUniformLocation(Ca,"u_matrix"),Pa=a.createVertexArray();a.bindVertexArray(Pa);var ba=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,ba),a.bufferData(a.ARRAY_BUFFER,new Float32Array,a.STATIC_DRAW);let ja=a.getAttribLocation(Ca,"a_position");a.enableVertexAttribArray(ja),a.vertexAttribPointer(ja,3,a.FLOAT,0,0,0),a.bindBuffer(a.ARRAY_BUFFER,zt),ma(a.getAttribLocation(Ca,"a_matrix")),a.bindVertexArray(null);let Ia=0;(async()=>{var t=await(sa||(sa=ya())),a=(t=>Array.from({length:t.length/9},(a,r)=>[[t[9*r],t[9*r+1],t[9*r+2]],[t[9*r+3],t[9*r+4],t[9*r+5]],[t[9*r+6],t[9*r+7],t[9*r+8]]]))(t=new Float32Array(t.buffer,1188,1134));t=Float32Array,a=(t=>{const a=(t=>{const a=f(),r=f();for(var n of(m(a,9999,9999,9999),m(r,-9999,-9999,-9999),t))for(var o of n){var e=t=a,l=o;t[0]=Math.min(e[0],l[0]),t[1]=Math.min(e[1],l[1]),t[2]=Math.min(e[2],l[2]),e=t=r,l=o,t[0]=Math.max(e[0],l[0]),t[1]=Math.max(e[1],l[1]),t[2]=Math.max(e[2],l[2])}return o=a[1],t=a[2],a[0]=(n=a[0])+.5*(r[0]-n),a[1]=o+.5*(r[1]-o),a[2]=t+.5*(r[2]-t),a})(t);return t.map(t=>t.map(t=>{const r=f();return y(r,t,a),g(r,r),p(r,t,r,.1),r}).reverse())})(a).flat();var r=[];for(let t=0;t<a.length;t++)for(let n=0;n<a[t].length;n++)r.push(a[t][n]);return{m:new t(r)}})().then(({m:t})=>{a.bindBuffer(a.ARRAY_BUFFER,ba),a.bufferData(a.ARRAY_BUFFER,t,a.DYNAMIC_DRAW),Ia=t.length/3});let La=fa("#version 300 es\nin vec4 a_position;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*a_position;}","#version 300 es\nprecision highp float;out vec4 outColor;void main(){outColor=vec4(0.258,0.215,0.168,1);}"),Sa=a.getUniformLocation(La,"u_matrix"),za=a.createVertexArray();a.bindVertexArray(za),a.bindBuffer(a.ARRAY_BUFFER,I);let ka=a.getAttribLocation(La,"a_position");a.enableVertexAttribArray(ka),a.vertexAttribPointer(ka,3,a.FLOAT,0,0,0),a.bindVertexArray(null),a.clearColor(0,0,0,0),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.enable(a.DEPTH_TEST),a.depthFunc(a.LESS);let qa=Math.floor(34/1.2)+2,Ua=Array.from({length:qa**2},()=>new Set),Ba=(t,a,r)=>{const n=Math.floor((a- -18)/1.2),o=Math.floor((r- -18)/1.2);t.pop(),t.pop(),t.pop(),t.pop(),0>n||n>=qa||0>o||o>=qa||(t.push(Ua[n*qa+o]),r=.6<1-(r-1.2*o)&&o+1<qa,(a=.6<1-(a-1.2*n)&&n+1<qa)&&t.push(Ua[(n+1)*qa+o]),r&&(t.push(Ua[n*qa+(o+1)]),a&&t.push(Ua[(n+1)*qa+(o+1)])))},Ea=[],Ga=[],Ha=F(),Ja=F(),Ka=F(),Na=f(),Oa=f(),Qa=f(),Ra=x(F()),Ta=new Float32Array(4800),Va=new Float32Array(6400);x(Ha);for(let t=1600;t--;)et(Va,t,Ha);for(let t=1600;t--;)x(Ha),X(Ha,Ha,.1*Math.random()),Y(Ha,Ha,.1*Math.random()),et(Va,t,Ha);let Wa=new Float32Array(4800),Za=[{n:m(f(),0,0,1),d:0,g:m(f(),0,0,-17)},{n:m(f(),0,0,-1),d:0,g:m(f(),0,0,17)},{n:m(f(),-1,0,0),d:0,g:m(f(),17,0,0)},{n:m(f(),1,0,0),d:0,g:m(f(),-17,0,0)}];for(let t of Za)t.d=-A(t.n,t.g);let $a=[],tr=new Set,ar=(t,a,r)=>{Wa[3*t]+=a[0]*r,Wa[3*t+1]+=a[1]*r,Wa[3*t+2]+=a[2]*r},rr=0,nr=[],or=Math.floor(1156/.81),er=1600;for(;0<er;){let t=Math.min(er,or);nr.push(Math.sqrt(1156/t)),er-=t}for(let t=1600;t--;){D(Ha),et(it,t,Ha);let a=Math.floor(t/or),r=nr[a],n=Math.ceil(34/r),o=Math.floor(t%or/n);lt[3*t]=t%or%n*r-17+.5,lt[3*t+1]=a*r+.8*Math.random(),lt[3*t+2]=o*r-17+.5,Ba($a,lt[3*t],lt[3*t+2]);for(let a=$a.length;a--;)$a[a].add(t)}let lr=F(),ir=0,hr=Math.ceil(34/1.05)**2,Mr=[],vr=900;for(;0<vr;){let t=Math.min(vr,hr);Mr.push(Math.sqrt(1156/t)),vr-=t}for(let t=1600;2500>t;t++){D(lr),et(it,t,lr);let a=t-1600,r=Math.floor(a/hr),n=Mr[r],o=Math.ceil(34/n),e=a%hr%o,l=Math.floor(a%hr/o);lt[3*t]=(e+.5)*n+.36+Math.random()*(n-.72)-17,lt[3*t+2]=(l+(e%2?.5:0))*n+.36+Math.random()*(n-.72)-17,lt[3*t+1]=-(2.2+1.5*r)+.6*Math.random()}for(let t=1600;2500>t;t++){let a=1600+Math.floor(900*Math.random()),r=lt[3*t],n=lt[3*t+1],o=lt[3*t+2];lt[3*t]=lt[3*a],lt[3*t+1]=lt[3*a+1],lt[3*t+2]=lt[3*a+2],lt[3*a]=r,lt[3*a+1]=n,lt[3*a+2]=o}let cr=1/60,ur=()=>{rr=(rr+1)%1024;const t=(rr%37)**2+rr%19*7;Wa.fill(0);for(let a=0;1600>a;a++){rt(Na,a),Wa[3*a]+=.018*-Ta[3*a]/cr,Wa[3*a+1]+=.018*-Ta[3*a+1]/cr,Wa[3*a+2]+=.018*-Ta[3*a+2]/cr,nt(Ka,Va,a),C(Ka,Ka,Ra,.06),.7<Math.abs(Ta[3*a+1])&&a%47==t%47&&(X(Ka,Ka,.1*(Math.random()-.5)),Y(Ka,Ka,.1*(Math.random()-.5))),et(Va,a,Ka),Wa[3*a+1]-=7,0>Na[1]&&(Wa[3*a+1]+=30*-Na[1]);for(let t=gt.length;t--;){const r=gt[t];ar(a,r.force,1/Math.max(.2,Math.abs(r.n[0]*Na[0]+r.n[1]*Na[2]-r.o))/Math.max(Math.abs(-r.n[1]*Na[0]+r.n[0]*Na[2]-r.i)-r.t,.2))}for(let t=Za.length;t--;){const r=Za[t],n=A(Na,r.n)+r.d-.5;0>n&&ar(a,r.n,20*(Math.min(-n,.16)/.16)**2)}tr.clear(),Ba($a,Na[0],Na[2]);for(let t=$a.length;t--;)for(const i of $a[t])if(i<a&&!tr.has(i)){rt(Oa,i),tr.add(i),y(Qa,Na,Oa);var r=Qa[0],n=Qa[1],o=Qa[2];const t=r*r+n*n+o*o;if(1>t){const r=Math.sqrt(t);if(1e-4<r){var e=1/r,l=Qa,M=Qa;l[0]=M[0]*e,l[1]=M[1]*e,l[2]=M[2]*e}else m(Qa,0,1,0);const n=60*Math.min(.25,1/(1-r/1));ar(a,Qa,n),ar(i,Qa,-n),Na[1]>Oa[1]?Wa[3*a+1]+=.7*n:Wa[3*i+1]+=.7*n}}}for(let t=1600;t--;){const a=lt[3*t],r=lt[3*t+2];Ta[3*t]+=cr*Wa[3*t],Ta[3*t+1]+=cr*Wa[3*t+1],Ta[3*t+2]+=cr*Wa[3*t+2],lt[3*t]+=cr*Ta[3*t],lt[3*t+1]+=cr*Ta[3*t+1],lt[3*t+2]+=cr*Ta[3*t+2],nt(Ja,it,t),nt(Ka,Va,t);var v=Ja,s=Ja[0],f=Ja[1],w=Ja[2],_=Ja[3],F=Ka[0],D=Ka[1],b=Ka[2],j=Ka[3];v[0]=s*j+_*F+f*b-w*D,v[1]=f*j+_*D+w*F-s*b,v[2]=w*j+_*b+s*D-f*F,v[3]=_*j-s*F-f*D-w*b,et(it,t,Ja);var I=t,S=lt[3*t],z=lt[3*t+2];if(Ba(Ea,a,r),Ba(Ga,S,z),Ea[0]!==Ga[0]||Ea[1]!==Ga[1]||Ea[2]!==Ga[2]){for(let t=Ea.length;t--;)Ea[t].delete(I);for(let t=Ga.length;t--;)Ga[t].add(I)}}y(vt,ht,mt),vt[1]=0,g(vt,vt),x(yt),P(yt,pt,vt),wt.fill(0),p(wt,wt,ft,-7.2),ut=Math.max(0,ut-cr),0===ut&&st&&(st=0,ct=1,ut=.2,console.log("acc")),p(wt,wt,vt,100*ct),ct*=.85,p(ft,ft,wt,cr),p(mt,mt,ft,cr),mt[1]=(()=>{var t=mt[0],a=mt[2];const r=[];for(let n=0;1600>n;n++)4>(lt[3*n]-t)**2+(lt[3*n+2]-a)**2&&r.push(n);return 0===r.length?1.5:r.map(t=>lt[3*t+1]).sort().slice(-2).reduce((t,a,r,{length:n})=>t+a/n,0)+.5})();const k=ir;ir+=cr;for(let t=1600;2500>t;t++){const a=733*t%17/17*Math.PI*2;var q=619*t%13/13;const r=2.8*(1-q)+3.8*q;var U=157*t%7/7;const n=.1*(1-U)+.2*U;lt[3*t+1]+=Math.sin(r*ir+a)*n-Math.sin(r*k+a)*n}for(let t=gt.length;t--;){const a=gt[t];a.o+=a.h*cr,a.u&&(a.t=Math.min(a.t+a.u*cr,a.v??Infinity)),a!==xt&&25.5<Math.abs(a.o)&&gt.splice(t,1)}for(const t of Ft)t.o>17*1.15&&(t.o-=1.15*34);a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);for(let t=2500;t--;){rt(Kt,t),nt(Nt,it,t);var B=1.088+t%37/37*.05,E=.25+79*t%23/23*.1,G=.4+.55*Math.min(Math.max((lt[3*t+1]- -1)/3.2,0),1),N=Ot,O=.5>G?G*(1+E):G+E-G*E,Q=2*G-O;N[0]=St(Q,O,B+1/3),N[1]=St(Q,O,B),N[2]=St(Q,O,B-1/3),u(Et[t],Nt,Kt),i(Jt,Et[t]);var R=Jt,T=J[0],V=J[1],W=J[2],Z=J[3],$=J[4],tt=J[5],at=J[6],Mt=J[7],At=J[8],_t=Jt[0],dt=Jt[1],Xt=Jt[2],Yt=Jt[3],Ct=Jt[4],Dt=Jt[5],Pt=Jt[6],bt=Jt[7],jt=Jt[8];R[0]=_t*T+dt*Z+Xt*at,R[1]=_t*V+dt*$+Xt*Mt,R[2]=_t*W+dt*tt+Xt*At,R[3]=Yt*T+Ct*Z+Dt*at,R[4]=Yt*V+Ct*$+Dt*Mt,R[5]=Yt*W+Ct*tt+Dt*At,R[6]=Pt*T+bt*Z+jt*at,R[7]=Pt*V+bt*$+jt*Mt,R[8]=Pt*W+bt*tt+jt*At;var It=Jt,Lt=Jt[0],Qt=Jt[1],Rt=Jt[2],Tt=Jt[3],Vt=Jt[4],Wt=Jt[5],Zt=Jt[6],$t=Jt[7],ra=Jt[8],oa=ra*Vt-Wt*$t,la=-ra*Tt+Wt*Zt,sa=$t*Tt-Vt*Zt,fa=Lt*oa+Qt*la+Rt*sa;fa&&(It[0]=oa*(fa=1/fa),It[1]=(-ra*Qt+Rt*$t)*fa,It[2]=(Wt*Qt-Rt*Vt)*fa,It[3]=la*fa,It[4]=(ra*Lt-Rt*Zt)*fa,It[5]=(-Wt*Lt+Rt*Tt)*fa,It[6]=sa*fa,It[7]=(-$t*Lt+Qt*Zt)*fa,It[8]=(Vt*Lt-Qt*Tt)*fa);var wa=Jt,ma=Jt;if(wa===ma){var ya=ma[1],_a=ma[2],da=ma[5];wa[1]=ma[3],wa[2]=ma[6],wa[3]=ya,wa[5]=ma[7],wa[6]=_a,wa[7]=da}else wa[0]=ma[0],wa[1]=ma[3],wa[2]=ma[6],wa[3]=ma[1],wa[4]=ma[4],wa[5]=ma[7],wa[6]=ma[2],wa[7]=ma[5],wa[8]=ma[8];Ht[t][0]=Jt[0],Ht[t][1]=Jt[1],Ht[t][2]=Jt[2],Ht[t][4]=Jt[3],Ht[t][5]=Jt[4],Ht[t][6]=Jt[5],Ht[t][8]=Jt[6],Ht[t][9]=Jt[7],Ht[t][10]=Jt[8],Ut[4*t]=Ot[0],Ut[4*t+1]=Ot[1],Ut[4*t+2]=Ot[2]}a.bindBuffer(a.ARRAY_BUFFER,zt),a.bufferSubData(a.ARRAY_BUFFER,0,Bt),a.bindBuffer(a.ARRAY_BUFFER,kt),a.bufferSubData(a.ARRAY_BUFFER,0,Gt),a.bindBuffer(a.ARRAY_BUFFER,qt),a.bufferSubData(a.ARRAY_BUFFER,0,Ut),u(ia,yt,mt),c(ia,H,ia),c(ha,L,ia),h(Ma,ia);for(let t=0;t<na.length;t++){d(va,na[t],ha),ot(ca,t);var Fa=ea[t],xa=va,Xa=Ma,ba=Fa[0],ja=Fa[1],ka=Fa[2];xa[0]=ba*Xa[0]+ja*Xa[3]+ka*Xa[6],xa[1]=ba*Xa[1]+ja*Xa[4]+ka*Xa[7],xa[2]=ba*Xa[2]+ja*Xa[5]+ka*Xa[8],ot(ua,t)}a.bindBuffer(a.ARRAY_BUFFER,ta),a.bufferSubData(a.ARRAY_BUFFER,0,ca),a.bindBuffer(a.ARRAY_BUFFER,aa),a.bufferSubData(a.ARRAY_BUFFER,0,ua),a.useProgram(La),a.uniformMatrix4fv(Sa,0,K),a.bindVertexArray(za),a.enable(a.CULL_FACE),a.cullFace(a.BACK),a.drawArrays(a.TRIANGLES,0,12),a.bindVertexArray(null),a.useProgram(pa),a.uniformMatrix4fv(ga,0,K),a.bindVertexArray(Aa),a.enable(a.CULL_FACE),a.cullFace(a.BACK),a.drawArraysInstanced(a.TRIANGLES,0,Ya,2500),a.bindVertexArray(null),a.useProgram(Ca),a.uniformMatrix4fv(Da,0,K),a.bindVertexArray(Pa),a.enable(a.CULL_FACE),a.cullFace(a.BACK),a.drawArraysInstanced(a.TRIANGLES,0,Ia,2500),a.bindVertexArray(null),requestAnimationFrame(ur)};ur();</script></html>