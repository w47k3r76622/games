<!DOCTYPE html>
<html> <head> <style> *{ font-family:Courier; user-select: none;} .hov{ background-color:white; cursor:pointer; } .hov:hover{ background-color:#aaa; } .abel{ background-color:white;border-radius:8px; padding:0px 20px; } </style> <title>js13k 2020</title>

  <script> const t2p=2*Math.PI;let aCon,smra,sst=!1,sts=()=>{window.AudioContext=window.AudioContext||window.webkitAudioContext,aCon=new AudioContext,smra=aCon.sampleRate,sst=!0,startBeatMachine()},pres=(e,t,a,s,i)=>{let l=[],n=[],r=smra*(t.a+t.d+t.r),o=smra/e,h=flo(o)*a,c=o/t2p;if(null==i){for(let e=0;e<h;e++)n.push(s(e,c));for(let e=0;e<r;e++)l[e]=.4*t.level(e)*n[e%h]}else for(let e=0;e<r;e++)l[e]=.4*t.level(e)*s(e,c+e*i);return l},playSound=(e,t,a,s,i)=>{let l=new Float32Array(e.length);for(var n=0;n<e.length;n++)l[n]=t*e[n];let r=aCon.createBuffer(1,l.length,smra);r.copyToChannel(l,0);let o=aCon.createBufferSource();o.buffer=r;let h=aCon.createBiquadFilter();o.connect(h),h.connect(aCon.destination),o.start(0),h.type=a,h.frequency.value=s,h.gain.value=i};class Envelope{constructor(e,t,a,s){this.a=e,this.d=t,this.r=s,this.s=a,this.aS=e*smra,this.dS=t*smra,this.rS=s*smra,this.rT=this.aS+this.dS}level(e){return e<this.aS?e/this.aS:e<this.rT?1-(1-this.s)*(e-this.aS)/this.dS:this.s*(1-(e-this.rT)/this.rS)}}let c2t,lastp,s4cun=0,s4fact=.1,cSIB=(e,t)=>cns(Math.round(Math.sin(e/(t+e/100))),0,.1),cSIB2=(e,t)=>cns(Math.round(Math.sin(e/(t+e/1e3))),0,.1),noisey=(e,t)=>.02*Math.random(),noisey2=(e,t)=>Math.random()*cns(Math.round(Math.sin(e/(e+t))),0,.13),cSI=(e,t)=>cns(Math.sin(e/t),-.8,.8),wubfact2=200,cSI2=(e,t)=>cns(.5*(Math.sin(e/t)+Math.sin(e/(wubfact2+t))),0,.1),cSI3=(e,t)=>cns(.2*Math.random()*(Math.sin(e/t)+Math.sin(e/(100+t))),0,.1),cSI5=(e,t)=>cns(.2*Math.random()*(Math.sin(e/t)+Math.sin(e/(1e3+t))),0,.1),cSI4=(e,t)=>cns(Math.random()*s4fact+.3*(Math.sin(e/t)+.3*Math.sin(e/(2+t))),0,.1),snarerelease=.3,playSnare=()=>play(10,.02,.01,.4,snarerelease,4,noisey2,5,"highpass",1200,4),playCash=()=>{play(1600,.01,.02,.3,.6,2,cSI2,4,"lowpass",1200,2),clearTimeout(c2t),c2t=setTimeout(function(){play(2400,.01,.02,.3,.6,2,cSI2,4,"lowpass",1800,2)},260)},play=(e,t,a,s,i,l,n,r,o,h,c,p)=>{playSound(pres(e,new Envelope(t,a,s,i),l,n,p),r,o,h,c)},playHats=()=>play(40,.01,.01,.5,.8,40,noisey,14,"highpass",6400,6),cSIZ=(e,t)=>cns(.1*Math.random()+.8*Math.sin(e/(.2*e+t)),0,.6),playHop=e=>play(e,.01,.11,.3,.31,10,cSI2,8,"highpass",500,2,-.001),playHop2=()=>play(200,.01,.11,.3,.31,200,cSIZ,9,"highshelf",1500,2),wubfactor=250,pwb=e=>play(e,.05,.51,.8,1.41,4,cSI,3.6,"lowpass",wubfactor,10),playNoiseySynth=e=>{play(e,.01,.11,.3,1.45,50,cSI4,8.5,"lowpass",1500,8),++s4cun%12==0&&(s4fact=1-s4fact)},playHardHat=()=>play(8,.01,.01,.11,.13,1,cSI3,6,"lowshelf",2240,12),playKick=e=>play(e,.01,.11,.3,.35,500,cSIB,16,"lowpass",180,12),playBlaster=(e,t)=>play(e,.01,.11,.3,.25,100,cSIB2,t,"highpass",1080,8),playSine=e=>{if("home"!=cRRL){let t=.35;lLd&&lLd.a1&&(t=.8),play(e,.01,.11,.3,t,1,cSI,.7,"highpass",600,1)}},pdsfx=()=>play(20,.01,.11,.3,.31,60+rI(20),cSI3,14,"highshelf",1500,2),playtun=()=>play(15+rI(85),.3,.61,.3,2.81,20+rI(50),cSI5,4,"lowpass",300+rI(2200),2),bar=1800,maxbars=16,startBeatMachine=()=>setInterval(newbar,bar),bassnote="0",mel2="HJMOMPOPOJMOP",mel1="POMJHHHJMHH",mel=mel1,bEA=[{vals:" x x x x",beatval:8,f:playHats,p:!0},{vals:"x x",beatval:16,f:playKick,v:600,p:!0},{vals:"     x",beatval:8,f:playSnare,p:!0},{vals:" 5",beatval:8,f:pwb,v:2e3,p:!0},{vals:"  ",beatval:8,f:playNoiseySynth,v:0,p:!0},{vals:"  M  K  R  P  M  P",beatval:16,f:playSine,v:0,p:!0},{vals:"  P  P  T  R  P  R",beatval:16,f:playSine,v:0,p:!0},{vals:"  R  T  W  T  R  T",beatval:17,f:playSine,v:0,p:!0}],bars=0,section=0,ntf=e=>13.75*2**((e-9)/12),mcoer=0,mco2=1,newbar=()=>{bars%4==0&&(wubfact2=100+rI(200),bEA[7].beatval=16+rI(2),bEA[6].beatval=16+rI(3)),"home"!=cRRL&&lLd&&!lLd.a1?(bars%8==0&&(mel!=mel1?(mel=mel1,bEA[3].vals=" 5"):(mel=mel2,bEA[3].vals=" 0"),mco2=1,mcoer=0),bEA[4].vals="   "+mel[mcoer]+" "+mel[mcoer],(mcoer=(mcoer+1)%mel.length)==mco2&&(mco2=(mco2+1)%mel.length,mcoer=0)):(bEA[4].vals="",bEA[3].vals="");for(let e=0;e<bEA.length;e++)if(bEA[e].p)for(let t=0;t<bEA[e].vals.length;t++)"x"==bEA[e].vals[t]?null!=bEA[e].v?setTimeout(function(e,t){e(t)},t*bar/bEA[e].beatval,bEA[e].f,bEA[e].v):setTimeout(function(e){e()},t*bar/bEA[e].beatval,bEA[e].f):null!=bEA[e].v&&" "!=bEA[e].vals[t]&&setTimeout(function(e,t){e(t)},t*bar/bEA[e].beatval,bEA[e].f,ntf(bEA[e].vals.charCodeAt(t)-20));++bars==maxbars&&(bars=0,section++)},ns1=58,ns2=93;class Coo{constructor(e,t,a,s){this.x=e,this.y=t,this.cmess,this.scale=1.5,null!=s&&(this.scale*=s),this.colors=[];for(let e=0;e<a.c.length;e++)this.colors[e]=a.c[e];this.model=a.m,this.rig=a.r,this.ants=a.a;for(let e=0;e<this.rig.length;e++)this.rig[e].isRoot&&(this.fRI=new RigShape(e,this.scale,this.model,this.rig,this.ants,this.colors));this.sni(1),this.cun=0}sni(e){this.pose=e,this.fRI.sni(e)}update(e,t){this.fRI.urv(),ctx.translate(this.x,this.y),t&&ctx.scale(-1,1),this.fRI.display(ctx),ctx.resetTransform(),this.cun++,this.cun>this.ants[this.pose].alen&&(this.cun=0)}}class RigShape{constructor(e,t,a,s,i,l){this.colors=l,this.rig=s,this.ants=i,this.sIndex=e,this.origin={x:s[e].origin.x*t,y:s[e].origin.y*t},this.rotation=0,this.paths=[],this.cun=0;for(let s=0;s<a.length;s++)if(a[s].shape==e){let e=a[s].origin,i=e.x*t,l=e.y*t,n=`M ${i} ${l} `,r=a[s].segments;for(let e=0;e<r.length;e++){n+=r[e].type+" ";let a=r[e].points;for(let e=0;e<a.length;e++)n+=`${i=a[e].x*t} ${l=a[e].y*t} `}this.paths.push({path:new Path2D(n),stroke:a[s].stroke,fill:a[s].fill})}this.pins=[];for(let n=0;n<s[e].pins.length;n++){let r=s[e].pins[n];this.pins.push({shape:new RigShape(r.shape,t,a,s,i,l),x:r.x*t,y:r.y*t})}}sni(e){this.pose=e;for(let t=0;t<this.pins.length;t++)this.pins[t].shape.sni(e)}urv(){0==this.cun?this.rotation=this.ants[this.pose].initVals[this.sIndex]:this.rotation=this.grft();for(let e=0;e<this.pins.length;e++)this.pins[e].shape.urv();this.cun++,this.cun>this.ants[this.pose].alen&&(this.cun=0)}display(e){e.save(),e.rotate(rad(this.rotation)),e.translate(-this.origin.x,-this.origin.y);for(let t=0;t<this.paths.length;t++)e.strokeStyle=this.colors[this.paths[t].stroke],e.lineWidth="2",e.stroke(this.paths[t].path);for(let t=0;t<this.pins.length;t++)e.save(),e.translate(this.pins[t].x,this.pins[t].y),this.pins[t].shape.display(e),e.restore();e.restore()}grft(){let e=this.ants[this.pose],t=e.timeStamps[this.sIndex];if(t.length>0){for(let a=0;a<t.length;a++)if(this.cun<=t[a].time){setlast(0,0);let s=t[a-1];return a>0?setlast(s.time,s.rot):setlast(0,e.initVals[this.sIndex]),this.lerprot(t[a].time,t[a].rot)}let a=last(t);return setlast(a.time,a.rot),this.lerprot(e.alen,e.initVals[this.sIndex])}return this.ants[this.pose].initVals[this.sIndex]}lerprot(e,t){return lastp.r+(this.cun-lastp.t)/(e-lastp.t)*(t-lastp.r)}}let riglength,pmO,monsterModel,amoe,pl,setlast=(e,t)=>lastp={t:e,r:t},cmess="",segments=[],newSeg=(e,t,a)=>segments.push({type:e,points:[{x:toNum(t,a),y:toNum(t+1,a)}]}),toNum=(e,t)=>cmess.charCodeAt(e)-t,isns1=(e,t)=>e.charCodeAt(t)<ns2,toAngle=e=>180*toNum(e,ns2)/30,uMM=e=>{let t=e.split("*"),a=[];segments=[];for(let e=0;e<t.length;e++){cmess=t[e],segments=[];for(let a=5;a<t[e].length;a+=2)if(toNum(a,0)<ns2)newSeg("L",a,ns1);else{let e=segments.length-1;if(e>=0){let t=segments[e],s=t.points;"L"==t.type?newSeg("C",a,ns2):s.length<3?s.push({x:toNum(a,ns2),y:toNum(a+1,ns2)}):newSeg("C",a,ns2)}else newSeg("C",a,ns2)}let s=toNum(2,ns1);s>99&&(s/=100),a.push({shape:toNum(0,ns1),fill:toNum(1,ns1),stroke:s,origin:{x:toNum(3,ns1),y:toNum(4,ns1)},segments:segments})}return a},uRM=e=>{let t=[],a=e;cmess=a;let s=0;for(let e=0;e<a.length;e++){let i=t[t.length-1];if(0==s)t.push({origin:{x:toNum(e,ns1)},pins:[],isRoot:!1});else if(1==s)i.origin.y=toNum(e,ns1);else if(s>2){let t=i.pins[i.pins.length-1];s%3==0?i.pins.push({x:toNum(e,ns2)}):s%3==1?i.pins[i.pins.length-1].y=toNum(e,ns2):t.shape=toNum(e,ns2)}else 2==s&&"1"==a[e]&&(i.isRoot=!0);++s>2&&isns1(a,e+1)&&(s=0)}return riglength=t.length,t},uAN=e=>{let t=[];cmess=e;let a=e,s=!1,i=0;for(;!s;){let e=a.indexOf("*",i+1),l={name:a.substring(i+1,e)};l.alen=toNum(e+1,ns1);let n=e+1+riglength;l.initVals=[],l.timeStamps=[];for(let t=e+2;t<n+1;t++)l.initVals.push(toAngle(t));i=n+1;for(let e=0;e<riglength;e++){l.timeStamps.push([]);let e=a.indexOf("*",i+1);-1==e&&(e=a.length,s=!0);let t=0;for(let a=i+1;a<e;a++){let e=l.timeStamps[l.timeStamps.length-1];t%2==0?e.push({rot:toAngle(a)}):e[e.length-1].time=toNum(a,ns1),t++}i=e}t.push(l)}return t},nocolor="#0000",edata={m:uMM(":;:HVDOhgkaskooniqikklinf*;;:AETMQOQL*<;:AGOMOKML*=;:FAHJEOIP*>;:FAHJEOIP"),r:uRM("GQ1im^in_jx`kxaAE0AG0FA0FA0"),a:uAN("*run*F^]]hQ*\\@*[@*[@*R@*j@*eat*F]]]iS*W<\\@*X<]@TB*c<]@eB*Q@*j@*fall*PbZ^QP*_C*YC*ZC*QC*TC"),c:["#eccf",nocolor]},abdata={m:uMM(":;:GRKPCI*;;:LAJEJIHI*<;:LAJEJIHI*=;:AOLK*>;:BBMI*?;:OHBDechdghidkeji*@;:BEOI"),r:uRM("GR1ku^iu_fl`LA0LA0AO0onaMI0eebeecBD0BD0"),a:uAN("*still*PVcgd]WX*[D*]D*dD*YD*eD*QD*YD*talk*FZadcZXX*XC*aC*fC*a>c@eC*]>Z@\\C*R>W@SC*\\>W@[C"),c:["#ada",nocolor]},s1data={m:uMM(":;:SDH<>CHKSDSPHX>P>JHRSKNNNGC?M@CGCT>P>C*;;:HDHL*<;:KJFE*<;<GDibbhhi*<;<LItmosmn"),r:uRM("HL0HE1ki]kg_HH0"),a:uAN("*ya*J]]]*[D**yB*"),c:["#dcd",nocolor,"rgba(174,44,0,1.0)"]},pdata={m:uMM(":;ŦBALDnjijlfhifhhe*;;<FGJH*<;<FHJI*:;>GJfoblfe*=;>GOFJGB*>;>EFH@*?;ĂEFGM*@;>EFH@*A;ĂEFGM*B;ĂHEJLIOMO*C;ĂHEJLIOMO*D;ŦFNJLHNHKNS"),r:uRM("DH0ij^ik_FG0FH0FJ1kc]geamfchpekpfH@0hibEF0H@0hidEF0jpgHE0HE0GM0"),a:uAN("*still*PZ]]]X]XS]]W*]E*YH*^H**ZE*YE*ZE*****shoot*B]]]]a[N_]]`*_<*W>*`>*[<*j<*]<*N<*[<*e<*`<*V<*run*D\\]]]e]TPhW_*Y?***^?*O?*T?*e?*`?*T?*i?*R?*runshot*D]]]]h]LdiU]****Y?*N?**P?*S?*W?*m?**gethit*JS]]bd^mdmH]*I=*W=*b=**M=*Y=*@=WA*U=JA*p=MA*a=_A**jump*V]]]`_a`V[Z]*[?***c?*M?*W?*G?**M?*L?*\\?"),c:["rgba(0,0,0,1.0)",nocolor,"rgba(249,79,0,1.0)","rgba(138,131,248,1.0)","rgba(247,185,0,1.0)"]},loadModelData=()=>{(pmO=new Coo(0,0,pdata,1.5)).sni(1),(amoe=new Coo(0,0,abdata,2)).sni(0)},sDaaHeader="sams404gameforjs13kof2020",saveGame=()=>localStorage.setItem(sDaaHeader,JSON.stringify(sDaa)),sDaa=null,loadSave=()=>{null==(sDaa=JSON.parse(localStorage.getItem(sDaaHeader)))&&nGAv()},nGAv=()=>{sDaa={levels:[],expro:0,dieP:0,bSpS:0,gPRO:[],lvlCount:0}};window.onbeforeunload=saveGame;class DOb{constructor(e,t,a,s){this.x=e,this.y=t,this.w=a,this.h=s,this.w2=this.w/2,this.h2=this.h/2}position(){return ckco(gbo(this),c8)?this.seep=gsp(this):this.seep=!1,this.seep}limitX(){this.x=Math.min(Math.max(this.x,-sW/2),sW/2)}shoot(e,t,a,s){e<this.seep.x?this.fcI="left":this.fcI="right",projectiles.push(new Projectile(this.x,this.y,6,"green",a,e,t,s))}}class Moo extends DOb{constructor(e,t,a,s){super(e,t,a,a),this.fill=s,this.hagr=!0,this.fallAcc=2,this.lrms=12,this.lrAcc=1,this.iJF=25,this.fri=2,this.moL=!1,this.moR=!1,this.juF=0,this.juD=2.2,this.fEE=0,this.lrSpeed=0,this.ipafo={x:0,y:0},this.hP=100,this.jpk=!1}goLeft(){this.moR=!1,this.moL=!0,this.fcI="left"}goRight(){this.moR=!0,this.moL=!1,this.fcI="right"}display(){this.moveLeftRight(),this.appp();let e=this.position();return this.hP<100&&this.diHB(),e}diHB(){proB(this.seep.x,this.seep.y-20-this.h/2,30,10,this.hP,"red","white")}jump(){this.juF=this.iJF}moveLeftRight(){this.moL&&!this.moR?(this.lrSpeed-=this.lrAcc,this.lrSpeed=Math.max(this.lrSpeed,-this.lrms)):this.moR&&!this.moL?(this.lrSpeed+=this.lrAcc,this.lrSpeed=Math.min(this.lrSpeed,this.lrms)):this.lrSpeed+this.fri<0?this.lrSpeed+=this.fri:this.lrSpeed-this.fri>0?this.lrSpeed-=this.fri:this.lrSpeed=0,this.ipafo.x-1>0?this.ipafo.x--:this.ipafo.x+1<0?this.ipafo.x++:this.ipafo.x=0,this.x+=this.lrSpeed+this.ipafo.x}appp(){this.udFS(),this.juF-this.juD>0?this.juF-=this.juD:this.juF=0,this.jpk&&(this.fEE=0),this.y+=this.fEE-this.juF}udFS(){let e=l1.pFO,t=kli;for(let a=0;a<e.length;a++)this.x>e[a].x-e[a].w2&&this.x<e[a].x+e[a].w2&&e[a].y>=this.y+this.h/2&&e[a].y<t&&(t=e[a].y);this.y+this.h/2+this.fEE<t?this.fEE+=this.fallAcc:(this.y=t-this.h/2,this.ipafo.y=this.fEE,this.fEE=0)}}let plamO,fU,aM,abou,agTalkTimeout,createpl=()=>{let e=l1.pFO[l1.pFO.length-1];isHome()?e=l1.pFO[0]:e.x-=130,(pl=new Moo(e.x,e.y-100,50,"#2a20")).iJF=40,pl.fcI="left",pl.jetFuel=100,pl.gPO=100,sME(),pl.display()},l4=!1,pJu=!1,f9=7,s9=38,mcun=0,wcun=0,dY=0,updatepl=()=>{if(pl.limitX(),pl.hP<40?(pl.lrms=7,pl.iJF=29):(pl.lrms=12,pl.iJF=40),pl.jpk&&pl.juF<10?pl.jetFuel>=f9?(pl.jetFuel-=f9,pl.juF=10):(cajpk=!0,setTimeout(function(){cajpk=!1},500),pl.jpk=!1):pl.juF>0?pl.juF-=4:pl.juF=0,pl.display(),plamO=!1,(pl.moL||pl.moR)&&(plamO=!0),dY=0,plamO&&0==pl.juF&&0==pl.fEE){let e=Math.cos(mcun);dY=2+e*e*7,mcun+=.2*Math.PI,wcun++}(plamO||wcun%5!=0)&&++wcun%5==0&&0==pl.juF&&0==pl.fEE&&playHop2(),pmO.x=pl.seep.x+20,pmO.y=pl.seep.y+14-dY,(pl.juF>0||pl.fEE>0)&&!pJu?(pJu=!0,pmO.fRI.sni(5)):0==pl.juF&&0==pl.fEE&&pJu?(pJu=!1,rePA()):plamO&&!l4?rePA():!plamO&&l4&&(rePA(),playHop2()),l4=plamO,pmO.update(ctx,"left"==pl.fcI),pl.hP<100&&(pl.hP+=.1),pl.hP<=0&&(lHOo(),fade(60,"ouchies")),aM=awwd("r3")?3:2,pl.gPO=Math.min(pl.gPO+aM,100),fU=awwd("r2")?3:2,cajpk||(pl.jetFuel=Math.min(pl.jetFuel+fU,100))},rePA=()=>{pl.juF>0||pl.fEE>0?pmO.fRI.sni(4):plamO?pmO.fRI.sni(2):pmO.fRI.sni(0)},damagepl=e=>{e+=4*lLd.difficulty,awwd("r4")&&(e*=.6),pl.hP-=e,pdsfx(),pmO.sni(4),setTimeout(function(){rePA()},400)},crfnp=()=>{let e=l1.pFO[l1.pFO.length-1];abou=new Moo(e.x+150,e.y-30,20,nocolor)},lAbs=!1,abgt=!1,runFriendlyNPCs=()=>{abou.display(),eIT(abou,"press E",80),0!=abou.seep&&(amoe.x=abou.seep.x+8,amoe.y=abou.seep.y-4,amoe.update(ctx,!1),!dUI.open&&lAbs?abgt=!1:dUI.open&&!lAbs&&(abgt=!0,aGT())),lAbs=dUI.open},agTalkcun=8,aGT=()=>{let e=60+rI(140),t=void 0,a=1200,s=400+rI(50);Math.random()<.8&&(t=-1e-4*rI(50),a=200),Math.random()<.8&&play(s,.01*rI(3),.11,.3,e/1100,10,cSI3,4,"highpass",a,3,t),agTalkcun--,abgt&&agTalkcun>0?(amoe.fRI.sni(1),agTalkTimeout=setTimeout(aGT,e)):amoe.fRI.sni(0)},eIT=(e,t,a)=>{if(0!=e.seep){if(distance(pl.x,pl.y,e.x,e.y).d<a){e.ieai=!0;let a=e.seep;ctx.fillText(t,a.x+25,a.y-40,"black",10)}else e.ieai=!1}else e.ieai=!1};const sooDamage=19,attackDamage=26;let tsgu,updateenn=()=>{if(!isHome()&&!isStart())for(let e=enn.length-1;e>=0;e--)enn[e].update(),enn[e].limitX(),enn[e].hP<=0&&(dLl.includes(cRRL)?1==enn.length?lLd.sections<lLd.difficulty?(lLd.sections++,coiel(!0)):l1.a1||(lLd.a1=!0,l1.clle(),l1.aDw2(),upfA()):l1.a1&&!l1.a2&&geel(enn[e]):(l1.clle(),lLd.a1=!0,sDaa.bSpS++,upfA()),poof(enn[e].x,enn[e].y,[enn[e].model.colors[0]]),enn.splice(e,1))},poof=(e,t,a)=>geel({x:e,y:t},!0,a);let l1,plahe=10,plfi="#fdcf";class Ptf extends DOb{constructor(e,t,a,s){super(e,t,a,plahe),this.fill=plfi,this.ptext=s}display(){let e=this.position();if(0!=this.seep){ctx.strokeStyle="#fdc8",ctx.strokeRect(e.x,e.y,this.w,20);let t="#a438";(l1.a1||isHome())&&(t="#fdc8"),cRect(e.x,e.y,this.w,20,t);let a=this.ptext.length;cText(this.ptext.substring(0,a/2),e.x,e.y+8,this.fill,10),cText(this.ptext.substring(a/2,a),e.x,e.y+18,this.fill,10)}}}let kli=500,sW=0,fadeIn=0,enn=[],bgurl="index.html",bale=e=>{sW=canvas.w,l1=new Level([[50,kli-100,100],[-60,kli-60,100],[0,kli,canvas.w]],sW,100,e)},coiel=e=>{let t=[[0,kli+=500,1.02*sW]],a=flo(5+3*random()),s=flo(1+3*random());for(let i=0;i<s;i++){let l=-s/3*canvas.w+i*sW/s+155,n=kli;for(let s=0;s<a-i;s++){let r=80;n-=60,s==a-i-1&&(r=280,e&&enn.push(new Enemy(l,n-80,"spawner"))),t.push([l,n,r+80*random()]),l+=120*random()-60}}for(let a=0;a<t.length;a++){let s=l1.gplatf(t[a][2]);l1.pFO.push(new Ptf(t[a][0],t[a][1],t[a][2],s)),e&&Math.random()>.63&&enn.push(new Enemy(t[a][0],t[a][1]-80,"mii"))}if(e)for(let e=0;e<1+2*lLd.difficulty;e++)enn.push(new Enemy(-300+rI(600),t[0][1]-80,"mii"));l1.moou(2)},ceL=()=>{if(enn=[],items=[],kli=500,ncount=0,dUI.open=!1,isHome())bale(),crfnp();else if(dLl.includes(cRRL)){sW=2*canvas.w;let e=(l1=new Level([[0,kli,1.02*sW]],sW,400,!0)).pFO[0],t=lLd.sections;if(lLd.a1&&l1.clle(),0==t)enn.push(new Enemy(e.x,e.y-80,"spawner"));else for(let e=0;e<t;e++)coiel(e==t-1&&!lLd.a1);lLd.a2?l1.clle2():lLd.a1&&l1.aDw2(),upfA()}else{bale(!0);let e=l1.pFO[0];lLd.a1?l1.clle():enn.push(new Enemy(e.x,e.y-80,"boss"))}};class Level{constructor(e,t,a,s){let i=e[0];this.text404=new DOb(i[0]-150,i[1]-10,300,300),this.pFO=[],this.bgFill="#333F",this.txtcun=0;for(let t=0;t<e.length;t++){let a=this.gplatf(e[t][2]);this.pFO.push(new Ptf(e[t][0],e[t][1],e[t][2],a))}this.clouds=[],this.moou(3),this.bgTxt=new DOb(t/2,this.pFO[0].y+a,2*t,4*a),this.bgcun=0,this.tun=100,this.drops=[],this.a1=!1,this.a2=!1}moou(e){for(let t=0;t<e;t++){let e=3+rI(4),a=[];for(let t=0;t<e;t++)a.push(this.gplatf(30+rI(100)));let s=1;t%2==0&&(s=-1),this.clouds.push({o:new DOb(0+200*t+rI(100),kli+rI(450),1e3,1e3),t:a,n:rI(200),dir:s})}}gplatf(e){let t="";for(let a=0;a<e/3;a++)t+=bgText[this.txtcun],this.txtcun++,this.txtcun==bgText.length&&(this.txtcun=0);return t}aDw2(){let e=this.pFO[1+rI(this.pFO.length-1)];enn.push(new Enemy(e.x,e.y-80,"spawner2")),tsgu=last(enn)}clle(){this.a1=!0,this.bgFill="#966"}clle2(){this.a2=!0,this.bgFill="#ccc"}dBG(){if(cRect(0,0,canvas.w,canvas.h,this.bgFill),this.bgcun>this.tun&&!l1.a2){let e=10-(this.bgcun-this.tun);if(e>=0)cRect(0,0,canvas.w,canvas.h,"#FFF"+e);else if(Math.random()<.3)this.tun+=50+rI(100),playtun();else{let e=200;l1.a1&&(e=20),this.tun+=e+rI(e),playtun()}}for(let e=0;e<this.clouds.length;e++){let t=this.clouds[e];if(t.o.position(),0!=t.o.seep)for(let e=0;e<t.t.length;e++)cText(t.t[e],t.o.seep.x*(.7+.03*e),.8*t.o.seep.y+15*e,"#bbb3",30);t.o.x+=.2*t.dir,this.bgcun%150==0&&Math.random()>.5&&(t.dir*=-1)}let e=this.bgTxt.position();for(let t=this.drops.length-1;t>=0;t--){let a=this.drops[t];a.y+=20,cText(bgText[a.c],e.x+a.x,e.y+a.y,"#bbba",12),a.y>pl.y&&this.drops.splice(t,1)}this.bgcun%4==0&&this.drops.push({x:pl.x+rI(canvas.w),y:pl.y-800,c:35+rI(88)}),this.bgcun++}d4Bg(){let e=this.text404.position();l1.a2||isHome()?cText(cRRL+".html",e.x,e.y,"#666",100):(cText("404",e.x,e.y,"#c99",100),cText("return to last page...",e.x,e.y+50,"#c99",30))}dPL(){for(let e=0;e<this.pFO.length;e++)this.pFO[e].display()}}let ctx,canvas={},c8={},sME=()=>{c8.target={x:pl.x,y:pl.y},c8.w=canvas.w2,c8.h=canvas.h2,c8.speed=24},cflw=(e,t)=>{t-=50,reach(c8.target,{x:e,y:t},c8.speed),c8.left=c8.target.x-c8.w,c8.right=c8.target.x+c8.w,c8.top=c8.target.y-c8.h,c8.bottom=c8.target.y+c8.h},cgdo=!1,cajpk=!1,jkPr=!1,keypress=()=>{if(!tfSE)switch(event.keyCode){case 65:pl.goLeft();break;case 68:pl.goRight();break;case 32:jkPr||(jkPr=!0,!pl.jpk&&pl.juF<8&&pl.fEE<4&&(playHop(300),pl.jump()),cajpk||(pl.jpk=!0));break;case 83:pl.y<kli&&!cgdo&&pl.y++;break;case 69:abtt();break;case 27:dUI.open=!1}},keyrelease=()=>{if(!tfSE)switch(event.keyCode){case 65:pl.moL=!1;break;case 68:pl.moR=!1;break;case 32:pl.jpk=!1,jkPr=!1}},mouseIsPressed=!1,mouseX=0,mouseY=0,cHo=!1,mousePressed=()=>{sst||sts(),mouseIsPressed=!0,mouseX=event.clientX-canvas.x,mouseY=event.clientY-canvas.y,!isStart()&&!cHo&&pl.gPO>=s9&&(pl.gPO-=s9,playBlaster(1800,3),pl.shoot(mouseX,mouseY,25,!1),pl.moR||pl.moL?pmO.sni(3):pmO.sni(1),cHo=!0,setTimeout(function(){rePA(),cHo=!1},250))},mouseReleased=()=>mouseIsPressed=!1,abtt=()=>{isHome()&&abou.ieai&&(dUI.open?cDLO():(dUI.open=!0,dUI.t=abou,pDLO(),dUI.line=texts[sDaa.expro].split(" "),cuDL()),agTalkcun=6+rI(9),clearTimeout(agTalkTimeout),aGT())},pDLO=()=>{let e=sDaa.gPRO,t=sDaa.dieP,a=sDaa.bSpS,s=!1,i=0;awwd("start")&&(0==a&&0==a?i=1+rI(3):a>0&&(awwd("r4")?a>1?i=10:1==a?s=!0:i=11:(e.push("r4"),i=9)),(t>0&&0==a||s)&&(1!=t||awwd("r3")?t>2&&!awwd("r1")?(e.push("r1"),i=6):t>5&&!awwd("r2")?(e.push("r2"),i=7):i=7==t?8:12+rI(4):(e.push("r3"),i=4))),sDaa.expro=i},awwd=e=>sDaa.gPRO.includes(e),createCanvas=()=>{canvas.w=800,canvas.h=600,canvas.w2=canvas.w/2,canvas.h2=canvas.h/2,canvas.c=document.createElement("canvas"),canvas.c.setAttribute("width",canvas.w),canvas.c.setAttribute("height",canvas.h),(ctx=canvas.c.getContext("2d")).filter="contrast(1.5) drop-shadow(1px 1px 2px #000)"},seedL=100,maxchar=100,charStart=128,ncount=0,random=()=>{let e=noiz(flo(ncount+=.7),cRRL);return ncount%1*(noiz(Math.ceil(ncount),cRRL)-e)+e},noiz=(e,t)=>(lLd.seedData.charCodeAt(e%seedL)-charStart)/maxchar,sRE=e=>{let t="";for(let e=0;e<seedL;e++)t+=String.fromCharCode(charStart+rI(maxchar));return t},cns=(e,t,a)=>Math.min(Math.max(e,t),a),ckco=(e,t)=>o1i(e.left,e.right,t.left,t.right)&&o1i(e.top,e.bottom,t.top,t.bottom),o1i=(e,t,a,s)=>t>=a&&t<=s||e>=a&&e<=s||e<=a&&t>=s,gsp=e=>({x:canvas.w2+e.x-c8.target.x-e.w2,y:canvas.h2+e.y-c8.target.y-e.h2}),proB=(e,t,a,s,i,l,n)=>{cFill(n),cRect(e,t,a,s),cFill(l),cRect(e,t,a*i/100,s)},distance=(e,t,a,s)=>{let i=a-e,l=s-t;return{d:Math.sqrt(i*i+l*l),adj:i,opp:l}},gbo=e=>({left:e.x-e.w2,right:e.x+e.w2,top:e.y-e.h2,bottom:e.y+e.h2}),isHome=()=>"home"==cRRL,isStart=()=>"start"==cRRL,div=(e,t)=>{let a=document.createElement("div");return document.body.appendChild(a),null!=e&&setStyle(a,e,t),a},setStyle=(e,t,a)=>e.setAttribute("style",`position:fixed; left:${t.x}px;top:${t.y}px;width:${t.w}px;height:${t.h}px;background-color:${a};`),rad=e=>e*Math.PI/180,l=e=>e.length,rI=e=>flo(Math.random()*e),flo=e=>Math.floor(e),reach=(e,t,a)=>{let s=!1,i=!1;return e.x+a<t.x?e.x+=a:e.x-a>t.x?e.x-=a:(e.x=t.x,s=!0),e.y+a<t.y?e.y+=a:e.y-a>t.y?e.y-=a:(e.y=t.y,i=!0),!(!s||!i)},last=e=>e[e.length-1],isLevel=e=>{let t=sDaa.levels;for(let a=0;a<t.length;a++)if(t[a].name==e)return a;return-1},pointTo=e=>document.getElementById(e),cFill=e=>{ctx.fillStyle=e},cText=(e,t,a,s,i)=>{s&&cFill(s),i&&cFont(i),ctx.fillText(e,t,a)},cFont=e=>{ctx.font=e+"px Courier New"},cRect=(e,t,a,s,i)=>{i&&cFill(i),ctx.fillRect(e,t,a,s)},dUI={open:!1,t:0,cun:0,line:[],lineI:0,ditx:""},dialogDone=!1,macha=20,ruDi=()=>{if(dUI.open){if(0!=dUI.t){let e=gsp({x:dUI.t.x,y:dUI.t.y,w2:50,h2:50});dUI.x=e.x-50,dUI.y=e.y-110}cFill("white"),cRect(dUI.x,dUI.y,250,50),cFill("black"),cFont(20),cText(dUI.ditx[0],dUI.x+5,dUI.y+20),cText(dUI.ditx[1],dUI.x+5,dUI.y+40)}abou.ieai||(dUI.open=!1)},cDLO=()=>{if(dialogDone){dUI.open=!1,dialogDone=!1;let e=sDaa.gPRO;if(0==sDaa.expro){for(let e=0;e<2;e++)newLevel(allLinkNames[e]);upfA(),e.push("start"),sDaa.expro=1,setTimeout(function(){dUI.open=!0,dUI.line=texts[1].split(" "),cuDL()},200)}}else cuDL()},cuDL=()=>{let e=makeLine(),t={t:""};e.stop||(t=makeLine()),dUI.ditx=[e.t,t.t]},makeLine=()=>{let e="",t=!1,a=!1;for(;!t&&!a&&e.length+dUI.line[0].length<macha;)"#"==dUI.line[0]?a=!0:e+=dUI.line[0]+" ",dUI.line.shift(),0==dUI.line.length&&(t=!0,dialogDone=!0);return{t:e,stop:t}},instru="Visit all the URLS you find, and destroy any baddies. We must recover the rest of my site and find the source of this madness!",bgear="Better gear? Sure. # But not now.",texts=["Hm? # Oh hi! # This is a disaster! My website is full of monsters and all the pages return 404s! Please, help me recover my site!!! I can only access 2 pages, here let me add them to your favorites.",instru,"Halp! 404 no more!",bgear,"Omg you recovered a lost PAGE! Good job. It's been added to your favorites. Let me also give you a faster weapon. Now get cleaning!","","Here you go, better bullets. Thank god! lol","You know what? # Now you can jump higher.","Almost there buddy! Keep rekking stuff!","Zomg you killed a boss.. Tada! More defense for you!!","Dude... # # dude! You finished the game! *happy dance*","","haha yaa go champ","you want a tip # ... # ???",instru,bgear],items=[],geel=(e,t,a)=>{let s=5+rI(15),i="gold";for(let l=0;l<s;l++){null!=a&&(i=a[rI(a.length)]),null!=t?items.push(new Item(e.x,e.y-50,8,i,!0)):items.push(new Item(e.x,e.y-50,10,i));let s=items[items.length-1];s.ipafo.x=6+rI(12),Math.random()>.5&&(s.ipafo.x*=-1),s.iJF=11,s.jump()}},updateItems=()=>{for(let e=items.length-1;e>=0;e--)items[e].update(),(items[e].ltd||items[e].poofy&&items[e].pfact>20)&&items.splice(e,1)};class Item extends Moo{constructor(e,t,a,s,i){super(e,t,a,s),this.size=a,this.ltd=!1,this.v=1,null!=i&&(this.poofy=!0,this.pfact=0)}update(){if(this.poofy)this.pfact++;else if(!this.ltd){let e=distance(this.x,this.y,pl.x,pl.y);if(e.d<10)this.ltd=!0,addLoot();else{this.v++;let t=this.v/e.d;this.x+=t*e.adj,this.y+=t*e.opp,this.fEE=0}}let e=this.display();0!=e&&cRect(e.x,e.y,this.size,this.size,this.fill)}}let addbar,textform,listform,lLd,blingInt,fav,daip=0,addLoot=()=>{tsgu.dSPA||(uII(++daip),playCash(),daip>daao&&(daip-=daao,pds(),uII(daip)))},uII=e=>{tsgu.s2xx=rlli},addressbar=()=>{let e=(addbar=div()).style;e.width=canvas.w+"px",e.backgroundColor="#768",e.display="flex",e.flexDirection="row",e.justifyContent="space-around",upfA(),document.body.appendChild(canvas.c);let t=canvas.c.getBoundingClientRect();canvas.x=Math.round(t.x),canvas.y=Math.round(t.y)},seL=()=>{let e=isLevel(cRRL);-1!=e?lLd=sDaa.levels[e]:(newLevel(),lLd=last(sDaa.levels))},newLevel=e=>{blifa(),sDaa.lvlCount++,null==e&&(e=cRRL),sDaa.levels.push({name:e,seedData:sRE(),difficulty:1+flo(sDaa.lvlCount/3),a1:!1,a2:!1,sections:0})},saLD=()=>{if(!isHome()&&!isStart()){let e=isLevel(cRRL);sDaa.levels[e].a1=lLd.a1,sDaa.levels[e].a2=lLd.a2,sDaa.levels[e].sections=lLd.sections}},goToLink=()=>{let e=listform.value;return"home"==e?(lHOo(),void upfA()):isStart()&&"new"==e?(nGAv(),lHOo(),void upfA()):void(0!=sDaa.levels.length&&(null!=lLd&&saLD(),cRRL=e.substring(0,e.indexOf(".")),fade(24),seL(),ceL(),createpl()))},lHOo=()=>{cRRL="home",ceL(),createpl(),fade(8)},dLl=["submit","entries","partners","experts","prizes","rules","blog"],allLinkNames=["submit","blog","entries","evilbot","partners","experts","prizes","rules","invaderz"],nxli="",rlli="",revealedChars=0,daao=6,pds=()=>{let e=rlli.length,t=rI(e);for(;"_"!=rlli[t];)t=rI(e);rlli=t<nxli.length-1?rSub(0,t)+nxli[t]+rSub(t+1,e):rSub(0,t)+nxli[t],++revealedChars==e&&(newLevel(nxli),enn[0].uok=!0,l1.clle2(),lLd.a2=!0,sDaa.dieP++,tsgu.dSPA=!0,upfA())},rSub=(e,t)=>rlli.substring(e,t),picknxliAward=()=>{nxli=allLinkNames[sDaa.lvlCount],rlli="",revealedChars=0;for(let e=0;e<nxli.length;e++)rlli+="_"},wtt=5,runFadeIn=()=>{let e=1;fadeIn>wtt&&(e=1-(fadeIn-wtt)/30),e>0&&(cRect(0,0,canvas.w,canvas.h,"rgba(0,0,0,"+e+")"),cText(fadetxt,canvas.w/2-30,canvas.h/2-2,"white",20)),fadeIn++},fadetxt="",fade=(e,t)=>{fadeIn=0,wtt=e,fadetxt=null!=t?t:""},startTxt=["sam's js13k","2020 game","pick 'home'","to continue","or pick 'new'","to start a new game.","then press go!!","CONTROLS","Left: A. Right: D. Down: S.","Jump: Space.","Shoot: Click. ","Talk to the home page guy: E."],sCol=["#eee","#88b","#ec1","#e32","#6a7"],scI=[0,0,1,1,2,2,3,4,4,4,4,4],sframe=0,dsui=()=>{if(sframe%30==0){cRect(0,0,canvas.w,canvas.h,"#333");let e,t,a,s,i=0;for(t=0;t<startTxt.length;t++){for(s=3+rI(4),e=50-5*t,a=0;a<s;a++)cText(startTxt[t],50-a,100+i-a,sCol[scI[t]],90-6*t);i+=.7*(90-6*t)}}sframe++},tfSE=!1,haClass='class="hov abel"',aClass="class='abel'",upfA=()=>{eType="option";let e=sDaa.levels,t="favorites",a=el("home");if(isStart())a+=el("new");else for(let t=0;t<e.length;t++)a+=el(`${e[t].name}.html`);eType="span",addbar.innerHTML=el(el("<",haClass)+el(">",haClass))+el(`www.js13kgames.com/${cRRL}`,aClass)+el(`${t}:<select id="${t}" style='cursor:pointer;'> ${a} </select>`+el("go",haClass+" onclick='goToLink()'"),aClass+" id='favs'"),listform=pointTo(t),fav=pointTo("favs"),saveGame()},eType="option",el=(e,t)=>(null==t&&(t=""),`<${eType} ${t}>${e}</${eType}>`),favBling=0,blinging=!1,blifa=()=>{blinging||(blinging=!0,playCash(),blingInt=setInterval(function(){fav=pointTo("favs"),favBG(favBling%2==0?"blue":"white"),favBling++},400),setTimeout(function(){favBG("white"),clearInterval(blingInt),blinging=!1},5e3))},favBG=e=>fav.style.backgroundColor=e;class Projectile extends Moo{constructor(e,t,a,s,i,l,n,r){super(e,t,a,s),this.hitspl=r,this.destroyed=!1,this.y-=20;let o=this.position(),h=distance(o.x,o.y,l,n),c=i/h.d;this.speedVect={y:c*h.opp,x:c*h.adj},this.hagr=!1,this.lifeTimer=0}uppro(){if(this.lifeTimer++,this.destroyed){let e=this.display();0!=e&&cRect(e.x,e.y,this.size,this.size,"white")}else{this.x+=this.speedVect.x,this.y+=this.speedVect.y;let e=this.position();if(0!=e){this.hitspl?(this.fs("#b66f",10),ckco(gbo(this),gbo(pl))&&(this.sppo(),this.bump(pl,15),poof(pl.x,pl.y,["orange"]),pdsfx(),damagepl(sooDamage))):(this.ckFll(l1.pFO,!1),this.ckFll(enn,28),sDaa.gPRO.includes("r1")?this.fs("#bb1",10):this.fs(this.fill,4)),this.ckWc();let t=this.lifeTimer%6;cRect(e.x-t,e.y-t,this.size+2*t,this.size+2*t),cRect(e.x,e.y,this.size,this.size,"white")}}}fs(e,t){cFill(e),this.size=t}ckWc(){(this.x<-sW/2||this.x>sW/2)&&this.sppo()}ckFll(e,t){for(let a=0;a<e.length;a++)ckco(gbo(e[a]),gbo(this))&&(this.sppo(),0!=t&&(awwd("r1")&&(t*=2),t-=3*(lLd.difficulty-1),"spawner"==e[a].type?e[a].sM():"mii"==e[a].type?e[a].hP=0:"boss"==e[a].type?e[a].hP-=t/6:"spawner2"!=e[a].type&&(this.bump(e[a],3),e[a].hP-=t),playBlaster(200,6)))}bump(e,t){e.ipafo.x+=Math.min(Math.max(e.x-this.x,-t),t)}sppo(){this.speedVect.x=0,this.speedVect.y=0,this.destroyed=!0}}let bgText,projectiles=[],uppros=()=>{for(let e=projectiles.length-1;e>=0;e--)projectiles[e].uppro(),projectiles[e].lifeTimer>50&&projectiles.splice(e,1)},start=()=>{loadSave(),fadeIn=0,createCanvas(),addressbar(),loadModelData(),fetch(bgurl).then(e=>e.text()).then(e=>bgText=e.replace(" ","")),setInterval(run,33)};window.onload=start;let cRRL="start",run=()=>{isStart()?dsui():(cflw(pl.x,pl.y),l1.dBG(),l1.dPL(),l1.d4Bg(),isHome()&&runFriendlyNPCs(),updateenn(),updatepl(),uppros(),ruDi(),updateItems(),runFadeIn(),proB(10,canvas.h-40,100,30,pl.gPO,"orange","grey"),proB(canvas.w-110,canvas.h-40,100,30,pl.jetFuel,"blue","grey"))};class Enemy extends Moo{constructor(e,t,a){let s=1.4,i=60;"boss"==a&&(s=3,i=100),super(e,t,i,"#cc30"),this.type=a,this.fri=.4,this.cun=35,this.diin=!1,this.natk=0,this.attii=25,"boss"==a&&(this.attii=12),this.fcI,this.fcI="left",this.attackTimeout,this.dSPA=!1,"spawner2"==a&&picknxliAward(),this.model="spawner"==a||"spawner2"==a?new Coo(0,0,s1data,2):"mii"==a?new Coo(0,0,s1data,1.3):new Coo(0,0,edata,s),"soo"==a&&(this.model.colors[0]="#8a8f"),"fig"==a&&(this.model.colors[0]="#88af"),this.swtee=200,this.nspa=0,this.unLOd=0,this.uok=!1,this.s2ii=130-25*lLd.difficulty,this.s2xx="",this.lastp=!1,this.animate(0)}update(){this.cun++;let e=this.display();if(0!=e){0==this.lastp&&(this.lrms=4);let t=distance(pl.x,pl.y,this.x,this.y);switch(this.type){case"fig":this.roam(t),this.fight(t);break;case"soo":this.roam(t),this.soo(t);break;case"boss":this.roam(t),this.fight(t),this.soo(t),this.diin=!0;break;case"mii":t.d<20&&this.pspw();break;case"spawner2":this.upsp2(e)}"spawner2"!=this.type&&(this.model.x=e.x+20,this.model.y=e.y+20,this.model.update(ctx,"left"==this.fcI))}else this.lrms=0;this.lastp=e}pspw(){this.sOn(),this.hP=0}upsp2(e){let t,a;this.uok&&this.unLOd<20&&(this.unLOd+=2),ctx.save(),ctx.strokeStyle="#444",ctx.lineWidth="10",ctx.translate(e.x,e.y),ctx.beginPath(),cRect(0,0,10,-this.unLOd,"#444"),ctx.arc(30,0-this.unLOd,25,Math.PI,0),ctx.stroke(),cRect(0,0,60,40,"#88d"),cRect(3,12,54,20,"#bbb");for(let e=0;e<rlli.length;e++)a="#444","_"==(t=rlli[e])&&(t=String.fromCharCode(48+rI(74)),a="grey"),cText(t,6*e+4,25,a,12);for(let e=0;e<daao;e++)cFill(e<daip%daao?"#f26":"#444"),cRect(10+7*e,35,4,4);ctx.restore(),this.dSPA||this.cun%this.s2ii!=0||this.sOn()}sM(){this.hP=0;for(let e=0;e<lLd.sections+1;e++)this.sOn(e)}sOn(e){let t="fig";lLd.difficulty>1&&(lLd.difficulty>2&&Math.random()>.3?t="soo":Math.random()>.6&&(t="soo")),null==e&&(e=0),enn.push(new Enemy(this.x-50+rI(50)+50*e,this.y-80,t))}regen(){this.hP<100&&(this.hP+=.2)}soo(e){this.canAttack(200,100,e)&&(playBlaster(800,1),this.shoot(pl.seep.x,pl.seep.y,10,!0),this.aool()),this.regen()}canAttack(e,t,a){return this.natk<this.cun&&a.d<e&&pl.y>this.y-t&&pl.y<this.y+t}aool(){this.animate(1),this.natk=this.cun+this.attii,this.attackTimeout=setTimeout(function(e){e.animate(0)},400,this)}fight(e){this.canAttack(30,50,e)&&(damagepl(attackDamage),pl.ipafo.x+=Math.min(Math.max(this.x-pl.x,-e),e),this.aool()),this.regen()}dash(){this.diin=!0,this.lrms=9,this.animate(1),setTimeout(function(e){e.lrms=4,e.animate(0)},3e3,this),setTimeout(function(e){e.diin=!1},3500,this)}roam(e){this.cun%50==0&&(pl.x<this.x?this.goLeft():this.goRight(),pl.y<this.y&&e.d<150&&this.jump(),!this.diin&&e.d<260&&this.dash())}animate(e){clearTimeout(this.attackTimeout),this.model.sni(e)}}
 </script> </head> <body onmousedown='mousePressed()' onmouseup='mouseReleased()' onkeydown='keypress()' onkeyup='keyrelease()'> </body> </html>
