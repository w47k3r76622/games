!function(){"use strict";function e(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);e.length>t;t++)r[t]=e[t];return r}return Array.from(e)}var t=["assets/hole.svg","assets/tree.svg","assets/eye.svg","assets/stamp2.svg","assets/eye_closed.svg","assets/heart.svg","assets/projectile.svg"],r=0,o=t.reduce(function(e,t){var o=document.createElement("img");return o.src=t,o.addEventListener("load",function(){r++}),e[/(\w*)\.svg/g.exec(t)[1]]=o,e},{}),s=function(){return r===t.length},i=function(){function e(e,t){var r=[],o=!0,s=!1,i=void 0;try{for(var n,a=e[Symbol.iterator]();!(o=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{!o&&a.return&&a.return()}finally{if(s)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=function(e){return Array(e).fill()},a=function(e,t,r){e.globalAlpha=1,e.globalCompositeOperation="source-over",e.fillStyle="#2c5b1e",e.fillRect(0,0,t,r)},l=function(e,t){e.save(),e.strokeStyle="#fff",e.lineWidth=5,e.shadowColor="#000",e.shadowOffsetX=1,e.shadowOffsetY=1,e.shadowBlur=1,e.setLineDash([10,5]),e.strokeRect(0,0,t.width,t.height),e.restore()},h=function(e,t){e.save(),e.setLineDash([10,5]),t.forEach(function(t){var r=t.x,s=t.y,i=t.r,n=2*i/o.tree.width,a=o.tree.width*n,l=o.tree.height*n;e.drawImage(o.tree,r-i,s-i-(l-2*i),a,l)}),e.restore()},f=function(e,t){e.save(),t.forEach(function(t){var r=t.x,s=t.y,i=t.r,n=2*i/o.hole.width,a=2*i/o.hole.height,l=o.hole.width*n,h=o.hole.height*a;e.drawImage(o.hole,r-i,s-i,l,h)}),e.restore()},d=[o.eye,o.eye,o.eye,o.eye,o.eye_closed],c=function(e,t,r,o){var s=d[Math.round(o/500)%5];e.save(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="bold 12px sans-serif",e.textAlign="center",e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowOffsetX=1,e.shadowOffsetY=1,e.shadowBlur=2,e.drawImage(s,t-s.width/2,r-s.height/2),e.restore()},u=function(e,t){e.save(),e.fillStyle="rgba(255, 255, 255, 0.7)",e.font="bold 12px sans-serif",e.textAlign="center",e.textBaseline="top",e.shadowColor="rgba(0, 0, 0, 1)",e.shadowOffsetX=1,e.shadowOffsetY=1,e.shadowBlur=1,t.forEach(function(t){var r=t.x,s=t.y,i=t.username;e.drawImage(o.eye,r-o.eye.width/2,s-o.eye.height/2),e.fillText(i,r,s+15)}),e.restore()},p=function(e,t){e.save(),e.fillStyle="rgba(255, 255, 255, 1)",e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowOffsetX=1,e.shadowOffsetY=1,e.shadowBlur=1,t.forEach(function(t){var r=t.x,o=t.y;e.beginPath(),e.arc(r,o,3,0,2*Math.PI,!1),e.fill()}),e.restore()},y=function(e,t,r){e.save(),e.fillStyle="rgba(255, 255, 255, 0.5)",e.lineWidth=3,e.strokeStyle="#fff",e.shadowColor="rgba(0, 0, 0, 0.5)",e.shadowOffsetX=1,e.shadowOffsetY=1,e.shadowBlur=2,e.beginPath(),e.arc(t,r,5,0,2*Math.PI,!1),e.stroke(),e.restore()},w=function(e,t,r,s){e.save(),n(s).forEach(function(s,i){var n=o.heart,a=n.width,l=n.height;e.drawImage(o.heart,t+.7*a*i,r,.7*a,.7*l)}),e.restore()},g=function(e,t,r,s){e.save(),n(s).forEach(function(s,i){var n=o.projectile,a=n.width,l=n.height;e.drawImage(o.projectile,t+.7*a*i,r,.7*a,.7*l)}),e.restore()},v=function(e,t,r,o){e.save(),e.fillStyle="rgba(255, 255, 255, 0.4)",e.lineWidth=3,e.strokeStyle="#fff",e.shadowColor="rgba(0, 0, 0, 1)",e.shadowOffsetX=1,e.shadowOffsetY=1,e.shadowBlur=2,e.font="bold 11px sans-serif",e.textAlign="start",e.textBaseline="top",Object.entries(o).forEach(function(o,s){var n=i(o,2),a=n[0],l=n[1];e.fillText(a+": "+l,t,r+12*s)}),e.restore()},m=function(e,t,r,o){e.save(),e.fillStyle="rgba(255, 255, 255, 0.9)",e.lineWidth=3,e.strokeStyle="#fff",e.shadowColor="rgba(0, 0, 0, 1)",e.shadowOffsetX=1,e.shadowOffsetY=1,e.shadowBlur=1,e.font="bold 14px sans-serif",e.textAlign="end",e.textBaseline="top",Object.entries(o).forEach(function(o,s){var n=i(o,2),a=n[0],l=n[1];e.fillText(a+": "+l,t,r+14*s)}),e.restore()},x=function(){function e(e,t){var r=[],o=!0,s=!1,i=void 0;try{for(var n,a=e[Symbol.iterator]();!(o=(n=a.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{!o&&a.return&&a.return()}finally{if(s)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),b=document.getElementById("canvas"),j=b.getContext("2d"),E={x:b.width/2,y:b.height/2},O=function(){b.width=b.clientWidth,b.height=b.clientHeight,E.x=0,E.y=0};window.addEventListener("resize",O),O();var S=void 0,k={ping:0,fps:0,players:1,projectiles:0,trees:0,holes:0};(S="8080"===window.location.port?io(window.location.hostname+":3000",{upgrade:!1,transports:["websocket"],query:""+new URL(window.location).searchParams}):io({upgrade:!1,transports:["websocket"],query:""+new URL(window.location).searchParams})).on("pong",function(e){k.ping=e});var A=function(e){var t=e.id,r=e.username,o=void 0===r?"":r,s=e.kills,i=void 0===s?0:s,n=e.deaths,a=void 0===n?0:n,l=e.points,h=void 0===l?0:l,f=e.position,d=void 0===f?0:f,c=e.health,u=void 0===c?0:c,p=e.projectiles;return{id:t,username:o,x:0,y:0,sx:0,sy:0,kills:i,deaths:a,points:h,position:d,health:u,projectiles:void 0===p?0:p}},L=function(e){return{id:e.id,x:e.x,y:e.y,sx:0,sy:0}},B={me:A("me"),others:new Map},I=new Map,C={width:0,height:0,holes:new Set,trees:new Set},X={pointer:E,players:B,projectiles:I,world:C},Y=function(e,t,r){a(j,b.width,b.height),s()&&(j.save(),j.translate(b.width/2-e.players.me.x,b.height/2-e.players.me.y),f(j,e.world.holes),p(j,e.projectiles),u(j,e.players.others),l(j,e.world),j.restore(),c(j,b.width/2,b.height/2,r),j.save(),j.translate(b.width/2-e.players.me.x,b.height/2-e.players.me.y),h(j,e.world.trees),j.restore(),y(j,e.pointer.x+b.width/2,e.pointer.y+b.height/2),w(j,10,b.height-50,e.players.me.health),g(j,10,b.height-30,e.players.me.projectiles),v(j,10,10,k),m(j,b.width-10,10,{"#":e.players.me.position,points:e.players.me.points,kills:e.players.me.kills,deaths:e.players.me.deaths}))},M=0,P=0,T=function(e,t){var r=e.players,o=e.projectiles;r.me.x+=(r.me.sx-r.me.x)/2,r.me.y+=(r.me.sy-r.me.y)/2,r.others.forEach(function(e){e.x+=(e.sx-e.x)/2,e.y+=(e.sy-e.y)/2}),o.forEach(function(e){e.x+=(e.sx-e.x)/2,e.y+=(e.sy-e.y)/2}),M++,(P+=t)>1e3&&(k.fps=M/P*1e3|0,M=0,P=0),k.players=e.players.others.size+1,k.projectiles=e.projectiles.size},W=0,R=!1,q=!0,z=function(e){R||(null===e.beta&&(b.classList.add("desktop"),q=!1,O()),R=!0)},D=void 0;window.addEventListener("deviceorientation",function(e){z(e),D||(D={beta:e.beta,gamma:e.gamma});var t=e.beta-D.beta,r=e.gamma-D.gamma;t>90&&(t=90),-90>t&&(t=-90),E.x=b.width/2*r/90*1.5,E.y=b.height/2*t/90*1.5,S.emit("c:pointer:update",E)}),b.addEventListener("mousemove",function(e){q||(E.x=e.clientX-b.offsetLeft-b.width/2,E.y=e.clientY-b.offsetTop-b.height/2,S.emit("c:pointer:update",E))}),document.addEventListener("mousedown",function(){q||S.emit("c:fire:pressed")}),document.addEventListener("touchstart",function(e){var t=e.touches[0],r=t.clientX,o=t.clientY;90>r&&90>o?D=null:S.emit("c:fire:pressed")}),S.on("s:players:update",function(t){var r=t.me,o=t.others;X.players.others=new Map([].concat(e(X.players.others)).filter(function(e){var t=x(e,1)[0];return null!=o.find(function(e){return e.id===t})})),o.forEach(function(e){var t=X.players.others.get(e.id);t||(t=A(e),X.players.others.set(e.id,t)),t.sx=e.x,t.sy=e.y,t.kills=e.kills,t.deaths=e.deaths,t.points=e.points,t.position=e.position,t.health=e.health,t.projectiles=e.projectiles}),X.players.me.sx=r.x,X.players.me.sy=r.y,X.players.me.kills=r.kills,X.players.me.deaths=r.deaths,X.players.me.points=r.points,X.players.me.position=r.position,X.players.me.health=r.health,X.players.me.projectiles=r.projectiles}),S.on("s:projectiles:update",function(t){X.projectiles=new Map([].concat(e(X.projectiles)).filter(function(e){var r=x(e,1)[0];return null!=t.find(function(e){return e.id===r})})),t.forEach(function(e){var t=X.projectiles.get(e.id);t||(t=L(e),X.projectiles.set(e.id,t)),t.sx=e.x,t.sy=e.y})}),S.on("s:world:create",function(e){var t=e.width,r=e.height,o=e.trees,s=e.holes;X.world.width=t,X.world.height=r,X.world.trees=new Set(o),X.world.holes=new Set(s),k.trees=o.length,k.holes=s.length}),function e(t){requestAnimationFrame(e);var r=t-W;T(X,r),Y(X,0,t),W=t}(0)}();
