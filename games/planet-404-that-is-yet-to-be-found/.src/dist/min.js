'use strict';function toRadians$$module$src$angles(a){return a*Math.PI/180}function toDegrees$$module$src$angles(a){return 180*a/Math.PI}var module$src$angles={};module$src$angles.toDegrees=toDegrees$$module$src$angles;module$src$angles.toRadians=toRadians$$module$src$angles;class Animation$$module$src$engine$animation{constructor(a,b,c,d=null){this.target=a;this.properties=b instanceof Array?b:[b];this.duration=c;this.onCompleted=d;this.time=0;this.completed=!1}update(){this.time+=1/60;let a=Math.min(this.time/this.duration,1);for(let b of this.properties)this.target[b.name]=b.start*(1-a)+b.end*a;if(this.time>=this.duration&&(this.completed=!0,this.onCompleted))this.onCompleted()}}var module$src$engine$animation={};module$src$engine$animation.Animation=Animation$$module$src$engine$animation;class Scene$$module$src$engine$scene{constructor(a){this.game=a;this.background=null;this.objects=[];this.texts=[];this.buttons=[];this.animations=[];this.timers=[]}addObject(a){this.objects.push(a)}addText(a){this.texts.push(a)}addButton(a){this.buttons.push(a)}addAnimation(a){this.animations.push(a)}addTimer(a){this.timers.push(a)}clear(){this.background=null;this.objects=[];this.texts=[];this.buttons=[];this.animations=[];this.timers=[]}create(){}updateObjects(){for(let a of this.objects)a.visible&&
a.update()}updateAnimations(){for(var a of this.animations)a.update();for(a=0;a<this.animations.length;)this.animations[a].completed?this.animations.splice(a,1):a++}updateTimers(){for(var a of this.timers)a.update();for(a=0;a<this.timers.length;)this.timers[a].completed?this.timers.splice(a,1):a++}update(){}draw(){this.background&&this.background.draw();for(let a of this.objects)a.visible&&a.draw();for(let a of this.texts)a.visible&&a.draw();for(let a of this.buttons)a.visible&&a.draw()}onMouseDown(a){for(let b of this.buttons)if(b.visible)b.onMouseDown(a)}onMouseUp(a){for(let b of this.buttons)if(b.visible)b.onMouseUp(a)}}
var module$src$engine$scene={};module$src$engine$scene.Scene=Scene$$module$src$engine$scene;class GameObject$$module$src$engine$game_object{constructor(a,b,c){this.scene=a;this.x=b;this.y=c;this.rotation=0;this.scale=1;this.visible=!0}update(){}draw(){}}var module$src$engine$game_object={};module$src$engine$game_object.GameObject=GameObject$$module$src$engine$game_object;function random$$module$src$random(a,b){return a+Math.random()*(b-a)}function randomInteger$$module$src$random(a,b){return Math.round(random$$module$src$random(a,b))}var module$src$random={};module$src$random.random=random$$module$src$random;module$src$random.randomInteger=randomInteger$$module$src$random;let PlanetType$$module$src$planet_type={GREEN:0,DESERT:1,ICE:2};var module$src$planet_type={};module$src$planet_type.PlanetType=PlanetType$$module$src$planet_type;class Palette$$module$src$planet_palettes{constructor(a,b){this.mainColor=a;this.accentColor=b}}let PlanetPalettes$$module$src$planet_palettes=new Map([[PlanetType$$module$src$planet_type.GREEN,new Palette$$module$src$planet_palettes("#23e93c","#beff55")],[PlanetType$$module$src$planet_type.DESERT,new Palette$$module$src$planet_palettes("#ffa03f","#e9ca44")],[PlanetType$$module$src$planet_type.ICE,new Palette$$module$src$planet_palettes("#70bdff","#befaff")]]);var module$src$planet_palettes={};
module$src$planet_palettes.PlanetPalettes=PlanetPalettes$$module$src$planet_palettes;class Planet$$module$src$planet extends GameObject$$module$src$engine$game_object{constructor(a,b,c,d){super(a,b,c);this.type=d;this.palette=PlanetPalettes$$module$src$planet_palettes.get(this.type);this.r=100;this.h=this.r/8;this.n=5;this.step=2*this.r/this.n;this.stripes=[];for(a=0;3>a;a++){b=[];b.push(-this.h,-this.h);for(c=0;c<this.n-1;c++)b.push(-this.h+random$$module$src$random(-this.h/2,this.h/2));b.push(-this.h,-this.h,this.h,this.h);for(c=0;c<this.n-1;c++)b.push(this.h+random$$module$src$random(-this.h/
2,this.h/2));b.push(this.h,this.h);this.stripes.push(b)}}draw(){let a=this.scene.game.context;a.save();a.translate(this.x,this.y);a.scale(this.scale,this.scale);a.beginPath();a.arc(0,0,this.r,0,2*Math.PI);a.clip();this.drawPlanet();this.drawPole();a.scale(1,-1);this.drawPole();a.scale(1,-1);a.translate(0,4*-this.h);for(let b of this.stripes)this.drawStripe(b),a.translate(0,4*this.h);a.restore()}drawPlanet(){let a=this.scene.game.context;a.fillStyle=this.palette.mainColor;a.fillRect(-this.r,-this.r,
2*this.r,2*this.r)}drawPole(){let a=this.scene.game.context;a.fillStyle="#ffffff";a.beginPath();a.arc(0,2.75*-this.r,2*this.r,0,Math.PI);a.fill()}drawStripe(a){let b=this.scene.game.context;b.fillStyle=this.palette.accentColor;let c=-this.r;b.beginPath();b.moveTo(c,a[1]);for(var d=1;d<this.n+1;d++)b.bezierCurveTo(c-this.step,a[d-1],c+2*this.step,a[d+2],c+this.step,a[d+1]),c+=this.step;b.lineTo(c,a[this.n+4]);for(d=this.n+4;d<2*this.n+4;d++)b.bezierCurveTo(c+this.step,a[d-1],c-2*this.step,a[d+2],c-
this.step,a[d+1]),c-=this.step;b.fill()}}var module$src$planet={};module$src$planet.Planet=Planet$$module$src$planet;class Background$$module$src$engine$background{constructor(a){this.scene=a}draw(){}}var module$src$engine$background={};module$src$engine$background.Background=Background$$module$src$engine$background;const STARS_NUMBER$$module$src$space_background=100,OVERLAP$$module$src$space_background=10,MAX_STAR_R$$module$src$space_background=2,MIN_STAR_P$$module$src$space_background=.5;
class SpaceBackground$$module$src$space_background extends Background$$module$src$engine$background{constructor(a){super(a);this.canvas=document.createElement("canvas");this.canvas.width=this.scene.game.width;this.canvas.height=this.scene.game.height;this.context=this.canvas.getContext("2d");this.context.strokeStyle="#ffffff";this.context.lineCap="round";this.stars=[];for(a=0;a<STARS_NUMBER$$module$src$space_background;a++){let b=random$$module$src$random(-OVERLAP$$module$src$space_background,this.scene.game.width+
OVERLAP$$module$src$space_background),c=random$$module$src$random(-OVERLAP$$module$src$space_background,this.scene.game.height+OVERLAP$$module$src$space_background),d=random$$module$src$random(0,MAX_STAR_R$$module$src$space_background),e=random$$module$src$random(MIN_STAR_P$$module$src$space_background,1);this.stars.push({x:b,y:c,r:d,p:e,px:b,py:c})}this.jump=!1}draw(){this.context.fillStyle="#000000";if(this.jump){this.context.globalAlpha=.05;this.context.fillRect(0,0,this.canvas.width,this.canvas.height);
this.context.globalAlpha=1;for(let a of this.stars)this.context.lineWidth=2*a.r,this.context.beginPath(),this.context.moveTo(a.px,a.py),this.context.lineTo(a.x,a.y),this.context.stroke()}else{this.context.fillRect(0,0,this.canvas.width,this.canvas.height);this.context.fillStyle="#ffffff";for(let a of this.stars)this.context.beginPath(),this.context.arc(a.x,a.y,a.r,0,2*Math.PI),this.context.fill()}this.scene.game.context.drawImage(this.canvas,0,0);for(let a of this.stars)a.px=a.x,a.py=a.y}move(a,b){for(let c of this.stars){c.x+=
a*c.p;c.y+=b*c.p;let d=!1,e=-OVERLAP$$module$src$space_background,f=this.scene.game.width+OVERLAP$$module$src$space_background,g=-OVERLAP$$module$src$space_background,h=this.scene.game.height+OVERLAP$$module$src$space_background;c.x<-OVERLAP$$module$src$space_background?(d=!0,e=this.scene.game.width):c.x>this.scene.game.width+OVERLAP$$module$src$space_background&&(d=!0,f=0);c.y<-OVERLAP$$module$src$space_background?(d=!0,g=this.scene.game.height):c.y>this.scene.game.height+OVERLAP$$module$src$space_background&&
(d=!0,h=0);d&&(c.x=random$$module$src$random(e,f),c.y=random$$module$src$random(g,h),c.r=random$$module$src$random(0,MAX_STAR_R$$module$src$space_background),c.p=random$$module$src$random(MIN_STAR_P$$module$src$space_background,1),c.px=c.x,c.py=c.y)}}}var module$src$space_background={};module$src$space_background.SpaceBackground=SpaceBackground$$module$src$space_background;class Target$$module$src$target extends GameObject$$module$src$engine$game_object{constructor(a,b,c,d,e,f){super(a,b,c);this.r=d;this.start=e;this.end=f;this.spacecraftAngle=this.duration=this.time=this.width=this.angle=0;this.satisfied=this.active=!1;this.onCompleted=null}update(){this.satisfied=!1;if(this.active&&Math.abs(this.angle-this.spacecraftAngle)<this.width/2&&(this.satisfied=!0,this.time+=1/60,this.time>=this.duration&&(this.active=!1,this.onCompleted)))this.onCompleted()}draw(){let a=
this.scene.game.context;a.save();a.strokeStyle="#ffffff";a.globalAlpha=.25;a.lineWidth=5;a.beginPath();a.arc(this.x,this.y,this.r,this.start*Math.PI/180,this.end*Math.PI/180);a.stroke();this.active&&(this.satisfied&&(a.strokeStyle="#00ffff"),a.globalAlpha=1,a.beginPath(),a.arc(this.x,this.y,this.r,(this.angle-this.width/2)*Math.PI/180,(this.angle+this.width/2)*Math.PI/180),a.stroke());a.restore()}restart(){this.time=0;this.active=!0}}var module$src$target={};module$src$target.Target=Target$$module$src$target;const ROCKET_COLOR$$module$src$spacecraft="#b0cdb4",WINDOW_COLOR$$module$src$spacecraft="#00adff",ENGINE_COLOR$$module$src$spacecraft="#cdb380",NORMAL_FLAME_COLOR$$module$src$spacecraft="#ffd800",JUMP_FLAME_COLOR$$module$src$spacecraft="#00ffff";let Engine$$module$src$spacecraft={OFF:0,ON:1,JUMP:2};
class Spacecraft$$module$src$spacecraft extends GameObject$$module$src$engine$game_object{constructor(a,b,c){super(a,b,c);this.engine=Engine$$module$src$spacecraft.ON;this.flameLength=50;this.flameOffset=0;this.flameColor=NORMAL_FLAME_COLOR$$module$src$spacecraft}update(){this.engine===Engine$$module$src$spacecraft.OFF?(0<this.flameLength&&(this.flameLength-=2),this.flameColor=NORMAL_FLAME_COLOR$$module$src$spacecraft):this.engine===Engine$$module$src$spacecraft.ON?(50>this.flameLength?this.flameLength+=
2:50<this.flameLength&&(this.flameLength-=2),this.flameColor=NORMAL_FLAME_COLOR$$module$src$spacecraft):(100>this.flameLength&&(this.flameLength+=2),this.flameColor=JUMP_FLAME_COLOR$$module$src$spacecraft)}draw(){let a=this.scene.game.context;a.save();a.strokeStyle="#ffffff";a.lineJoin="round";a.translate(this.x,this.y);a.rotate(this.rotation*Math.PI/180);a.scale(this.scale,this.scale);0<this.flameLength&&this.drawRocketFlame();this.drawRocket();a.translate(-25,0);0<this.flameLength&&this.drawEngineFlame();
this.drawEngine();a.translate(50,0);0<this.flameLength&&this.drawEngineFlame();this.drawEngine();a.restore()}drawRocketFlame(){let a=this.scene.game.context;a.fillStyle=this.flameColor;a.beginPath();a.moveTo(-15,30);a.lineTo(this.flameOffset+random$$module$src$random(-2,2),30+this.flameLength+random$$module$src$random(-10,10));a.lineTo(15,30);a.fill()}drawEngineFlame(){let a=this.scene.game.context;a.fillStyle=this.flameColor;a.beginPath();a.moveTo(-5,30);a.lineTo(this.flameOffset+random$$module$src$random(-2,
2),30+.6*this.flameLength+random$$module$src$random(-5,5));a.lineTo(5,30);a.fill()}drawRocket(){let a=this.scene.game.context;a.fillStyle=ROCKET_COLOR$$module$src$spacecraft;a.lineWidth=2;a.beginPath();a.moveTo(-20,30);a.bezierCurveTo(-20,-10,-10,-30,0,-30);a.bezierCurveTo(10,-30,20,-10,20,30);a.closePath();a.fill();a.stroke();a.fillStyle=WINDOW_COLOR$$module$src$spacecraft;a.lineWidth=4;a.beginPath();a.arc(0,0,10,0,2*Math.PI);a.fill();a.stroke()}drawEngine(){let a=this.scene.game.context;a.fillStyle=
ENGINE_COLOR$$module$src$spacecraft;a.lineWidth=2;a.beginPath();a.moveTo(-5,30);a.lineTo(-5,10);a.arc(0,10,5,Math.PI,2*Math.PI);a.lineTo(5,30);a.closePath();a.fill();a.stroke()}flyStraight(){this.flameOffset=0}flyLeft(){this.flameOffset=-5}flyRight(){this.flameOffset=5}}var module$src$spacecraft={};module$src$spacecraft.Engine=Engine$$module$src$spacecraft;module$src$spacecraft.Spacecraft=Spacecraft$$module$src$spacecraft;const FONT$$module$src$engine$font={A:[[0,1,0],[1,0,1],[1,0,1],[1,1,1],[1,0,1]],B:[[1,1,0],[1,0,1],[1,1,1],[1,0,1],[1,1,0]],C:[[1,1,1],[1,0,0],[1,0,0],[1,0,0],[1,1,1]],D:[[1,1,0],[1,0,1],[1,0,1],[1,0,1],[1,1,0]],E:[[1,1,1],[1,0,0],[1,1,1],[1,0,0],[1,1,1]],F:[[1,1,1],[1,0,0],[1,1,0],[1,0,0],[1,0,0]],G:[[0,1,1,0],[1,0,0,0],[1,0,1,1],[1,0,0,1],[0,1,1,0]],H:[[1,0,1],[1,0,1],[1,1,1],[1,0,1],[1,0,1]],I:[[1,1,1],[0,1,0],[0,1,0],[0,1,0],[1,1,1]],J:[[1,1,1],[0,0,1],[0,0,1],[1,0,1],[1,1,1]],K:[[1,0,0,1],[1,
0,1,0],[1,1,0,0],[1,0,1,0],[1,0,0,1]],L:[[1,0,0],[1,0,0],[1,0,0],[1,0,0],[1,1,1]],M:[[1,1,1,1,1],[1,0,1,0,1],[1,0,1,0,1],[1,0,0,0,1],[1,0,0,0,1]],N:[[1,0,0,1],[1,1,0,1],[1,0,1,1],[1,0,0,1],[1,0,0,1]],O:[[1,1,1],[1,0,1],[1,0,1],[1,0,1],[1,1,1]],P:[[1,1,1],[1,0,1],[1,1,1],[1,0,0],[1,0,0]],Q:[[0,1,1,0],[1,0,0,1],[1,0,0,1],[1,0,1,1],[1,1,1,1]],R:[[1,1,0],[1,0,1],[1,0,1],[1,1,0],[1,0,1]],S:[[1,1,1],[1,0,0],[1,1,1],[0,0,1],[1,1,1]],T:[[1,1,1],[0,1,0],[0,1,0],[0,1,0],[0,1,0]],U:[[1,0,1],[1,0,1],[1,0,1],
[1,0,1],[1,1,1]],V:[[1,0,0,0,1],[1,0,0,0,1],[0,1,0,1,0],[0,1,0,1,0],[0,0,1,0,0]],W:[[1,0,0,0,1],[1,0,0,0,1],[1,0,0,0,1],[1,0,1,0,1],[1,1,1,1,1]],X:[[1,0,0,0,1],[0,1,0,1,0],[0,0,1,0,0],[0,1,0,1,0],[1,0,0,0,1]],Y:[[1,0,1],[1,0,1],[0,1,0],[0,1,0],[0,1,0]],Z:[[1,1,1,1,1],[0,0,0,1,0],[0,0,1,0,0],[0,1,0,0,0],[1,1,1,1,1]],0:[[1,1,1],[1,0,1],[1,0,1],[1,0,1],[1,1,1]],1:[[1],[1],[1],[1],[1]],2:[[1,1,1],[0,0,1],[1,1,1],[1,0,0],[1,1,1]],3:[[1,1,1],[0,0,1],[1,1,1],[0,0,1],[1,1,1]],4:[[1,0,1],[1,0,1],[1,1,1],[0,
0,1],[0,0,1]],5:[[1,1,1],[1,0,0],[1,1,1],[0,0,1],[1,1,1]],6:[[1,1,1],[1,0,0],[1,1,1],[1,0,1],[1,1,1]],7:[[1,1,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1]],8:[[1,1,1],[1,0,1],[1,1,1],[1,0,1],[1,1,1]],9:[[1,1,1],[1,0,1],[1,1,1],[0,0,1],[1,1,1]]," ":[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],",":[[0],[0],[0],[1],[1]],"!":[[1],[1],[1],[0],[1]],"'":[[1],[1],[0],[0],[0]]};var module$src$engine$font={};module$src$engine$font.FONT=FONT$$module$src$engine$font;let Align$$module$src$engine$text={LEFT:0,CENTER:-1,RIGHT:-2},Baseline$$module$src$engine$text={TOP:0,MIDDLE:-1,BOTTOM:-2};
class Text$$module$src$engine$text{constructor(a,b,c,d,e,f=Align$$module$src$engine$text.CENTER,g=Baseline$$module$src$engine$text.MIDDLE){this.scene=a;this.content=b;this.x=c;this.y=d;this.size=e;this.align=f;this.baseline=g;this.visible=!0;this.alpha=1;this.pixelSize=Math.round(this.size/5)}get content(){return this._content}set content(a){this._content=a.toUpperCase()}get width(){let a=this.content.length-1;for(let b of this.content)a+=FONT$$module$src$engine$font[b][0].length;return a*=this.pixelSize}draw(){let a=
this.scene.game.context;a.save();a.fillStyle="#ffffff";a.globalAlpha=this.alpha;let b=Math.round(this.x+this.align*this.width/2),c=Math.round(this.y+5*this.baseline*this.pixelSize/2);for(let d of this.content){let e=FONT$$module$src$engine$font[d];for(let f=0;f<e.length;f++)for(let g=0;g<e[f].length;g++)e[f][g]&&a.fillRect(b+g*this.pixelSize,c+f*this.pixelSize,this.pixelSize,this.pixelSize);b+=(e[0].length+1)*this.pixelSize}a.restore()}}var module$src$engine$text={};module$src$engine$text.Align=Align$$module$src$engine$text;
module$src$engine$text.Baseline=Baseline$$module$src$engine$text;module$src$engine$text.Text=Text$$module$src$engine$text;class Timer$$module$src$engine$timer{constructor(a,b){this.duration=a;this.onCompleted=b;this.time=0;this.completed=!1}update(){this.time+=1/60;this.time>=this.duration&&(this.completed=!0,this.onCompleted())}}var module$src$engine$timer={};module$src$engine$timer.Timer=Timer$$module$src$engine$timer;const PLANET_POSITION_SPEED$$module$src$approach_scene=.125,PLANET_SCALE_SPEED$$module$src$approach_scene=.1/60;let PlanetDescriptions$$module$src$approach_scene=new Map([[PlanetType$$module$src$planet_type.GREEN,"It is quite green!"],[PlanetType$$module$src$planet_type.DESERT,"It has many deserts!"],[PlanetType$$module$src$planet_type.ICE,"It is covered with ice!"]]);
class ApproachScene$$module$src$approach_scene extends Scene$$module$src$engine$scene{create(){this.background=new SpaceBackground$$module$src$space_background(this);this.backgroundVX=0;this.backgroundVY=2;this.spacecraft=new Spacecraft$$module$src$spacecraft(this,400,225);this.addObject(this.spacecraft);this.target=new Target$$module$src$target(this,400,225,60,0,360);this.target.visible=!1;this.target.width=60;this.target.duration=5;this.target.onCompleted=()=>{this.taskIndex++;4>this.taskIndex?
this.target.angle=this.tasks[this.taskIndex]:(this.hint.content="Finally, we need to slow down",this.backgroundVX=0,this.target.angle=90,this.target.onCompleted=()=>{this.hint.content="Prepare for a landing";this.backgroundVY=0;this.target.visible=!1;this.addAnimation(new Animation$$module$src$engine$animation(this.spacecraft,{name:"y",start:225,end:-112.5},6,()=>this.game.startScene("LandingScene")));this.addTimer(new Timer$$module$src$engine$timer(2,()=>this.spacecraft.engine=Engine$$module$src$spacecraft.OFF))});
this.target.restart()};this.addObject(this.target);this.planet=new Planet$$module$src$planet(this,650,-100,this.game.planetType);this.planet.scale=0;this.addObject(this.planet);this.hint=new Text$$module$src$engine$text(this,"We are almost where",400,440,10,Align$$module$src$engine$text.CENTER,Baseline$$module$src$engine$text.BOTTOM);this.addText(this.hint);this.addAnimation(new Animation$$module$src$engine$animation(this.planet,[{name:"y",start:-150,end:150},{name:"scale",start:0,end:1}],6));this.addTimer(new Timer$$module$src$engine$timer(3,
()=>this.hint.content="Look, there is a new planet!"));this.addTimer(new Timer$$module$src$engine$timer(6,()=>this.hint.content=PlanetDescriptions$$module$src$approach_scene.get(this.game.planetType)));this.addTimer(new Timer$$module$src$engine$timer(9,()=>{this.hint.content="Let's correct our path before landing";this.target.visible=!0}));this.addTimer(new Timer$$module$src$engine$timer(12,()=>{this.hint.content="Follow the target using the left and right arrows";this.target.angle=this.tasks[this.taskIndex];
this.target.active=!0}));this.taskIndex=0;this.tasks=[30,150,210,330];for(let a=0;4>a;a++){let b=randomInteger$$module$src$random(a,3),c=this.tasks[a];this.tasks[a]=this.tasks[b];this.tasks[b]=c}}update(){this.background.move(this.backgroundVX,this.backgroundVY);if(this.target.active){let a=this.game.input;a.left?(this.spacecraft.flyLeft(),this.spacecraft.rotation-=2,0>this.spacecraft.rotation&&(this.spacecraft.rotation+=360)):a.right?(this.spacecraft.flyRight(),this.spacecraft.rotation+=2,360<this.spacecraft.rotation&&
(this.spacecraft.rotation-=360)):this.spacecraft.flyStraight();this.target.spacecraftAngle=(this.spacecraft.rotation+270)%360;4>this.taskIndex&&(this.target.satisfied?(this.backgroundVX=-1,this.backgroundVY=1,this.planet.x+=PLANET_POSITION_SPEED$$module$src$approach_scene,this.planet.y-=PLANET_POSITION_SPEED$$module$src$approach_scene,this.planet.scale+=PLANET_SCALE_SPEED$$module$src$approach_scene):(this.backgroundVX=-.5,this.backgroundVY=.5))}}}var module$src$approach_scene={};
module$src$approach_scene.ApproachScene=ApproachScene$$module$src$approach_scene;class Cloud$$module$src$cloud extends GameObject$$module$src$engine$game_object{constructor(a){super(a,0,0);this.p=this.size=0;this.alpha=1;this.reset()}update(){this.y-=Cloud$$module$src$cloud.vY*this.p;this.y<-this.size&&this.reset()}draw(){let a=this.scene.game.context;a.save();a.fillStyle="#ffffff";a.globalAlpha=this.alpha;a.fillRect(this.x,this.y,this.size,this.size);a.restore()}reset(){this.size=random$$module$src$random(30,60);this.x=random$$module$src$random(this.size,this.scene.game.width-
this.size);this.y=random$$module$src$random(this.scene.game.height,2*this.scene.game.height);this.p=random$$module$src$random(.5,1);this.alpha=random$$module$src$random(.4,.8)}}Cloud$$module$src$cloud.vY=0;var module$src$cloud={};module$src$cloud.Cloud=Cloud$$module$src$cloud;class DepartureScene$$module$src$departure_scene extends Scene$$module$src$engine$scene{create(){this.background=new SpaceBackground$$module$src$space_background(this);this.backgroundVY=0;this.spacecraft=new Spacecraft$$module$src$spacecraft(this,400,675);this.addObject(this.spacecraft);this.hint=new Text$$module$src$engine$text(this,"We are heading out on an adventure",400,440,10,Align$$module$src$engine$text.CENTER,Baseline$$module$src$engine$text.BOTTOM);this.addText(this.hint);this.addAnimation(new Animation$$module$src$engine$animation(this.spacecraft,
{name:"y",start:675,end:225},4,()=>this.backgroundVY=2));this.addTimer(new Timer$$module$src$engine$timer(3,()=>this.hint.content="To find new planets in our galaxy"));this.addTimer(new Timer$$module$src$engine$timer(6,()=>this.hint.content="First, let's decide where to go"));this.addTimer(new Timer$$module$src$engine$timer(9,()=>this.game.startScene("MapScene")))}update(){this.background.move(0,this.backgroundVY)}}var module$src$departure_scene={};module$src$departure_scene.DepartureScene=DepartureScene$$module$src$departure_scene;class JumpScene$$module$src$jump_scene extends Scene$$module$src$engine$scene{create(){this.background=new SpaceBackground$$module$src$space_background(this);this.backgroundVY=2;this.spacecraft=new Spacecraft$$module$src$spacecraft(this,400,225);this.addObject(this.spacecraft);this.hint=new Text$$module$src$engine$text(this,"Prepare for a jump",400,440,10,Align$$module$src$engine$text.CENTER,Baseline$$module$src$engine$text.BOTTOM);this.addText(this.hint);this.addTimer(new Timer$$module$src$engine$timer(1,
()=>this.hint.content="In 3"));this.addTimer(new Timer$$module$src$engine$timer(2,()=>this.hint.content="In 2"));this.addTimer(new Timer$$module$src$engine$timer(3,()=>this.hint.content="In 1"));this.addTimer(new Timer$$module$src$engine$timer(4,()=>{this.background.jump=!0;this.backgroundVY=4;this.spacecraft.engine=Engine$$module$src$spacecraft.JUMP;this.hint.content="Let's go!"}));this.addTimer(new Timer$$module$src$engine$timer(8,()=>this.game.startScene("ApproachScene")))}update(){this.background.move(0,
this.backgroundVY)}}var module$src$jump_scene={};module$src$jump_scene.JumpScene=JumpScene$$module$src$jump_scene;const SKY_COLOR$$module$src$sky_background="#95dfff",STARS_NUMBER$$module$src$sky_background=100,MAX_STAR_R$$module$src$sky_background=2;
class SkyBackground$$module$src$sky_background extends Background$$module$src$engine$background{constructor(a){super(a);this.y=0;this.gradient=this.scene.game.context.createLinearGradient(0,0,0,3*this.scene.game.height);this.gradient.addColorStop(0,"#000000");this.gradient.addColorStop(1/3,SKY_COLOR$$module$src$sky_background);this.gradient.addColorStop(1,SKY_COLOR$$module$src$sky_background);this.stars=[];for(a=0;a<STARS_NUMBER$$module$src$sky_background;a++){let b=random$$module$src$random(0,this.scene.game.width),
c=random$$module$src$random(0,this.scene.game.height),d=random$$module$src$random(0,MAX_STAR_R$$module$src$sky_background);this.stars.push({x:b,y:c,r:d})}}draw(){let a=this.scene.game.context;a.save();a.fillStyle=this.gradient;a.translate(0,this.y);a.fillRect(0,0,this.scene.game.width,3*this.scene.game.height);a.fillStyle="#ffffff";for(let b of this.stars)a.beginPath(),a.arc(b.x,b.y,b.r,0,2*Math.PI),a.fill();a.restore()}}var module$src$sky_background={};module$src$sky_background.SkyBackground=SkyBackground$$module$src$sky_background;class Parachute$$module$src$parachute extends GameObject$$module$src$engine$game_object{constructor(a,b,c){super(a,b,c);this.attachmentY=this.attachmentX=0}draw(){let a=this.scene.game.context;a.save();a.strokeStyle="#ffffff";a.lineWidth=2;for(let b=0;4>b;b++)a.beginPath(),a.moveTo(this.x-270+180*b,this.y),a.lineTo(this.attachmentX,this.attachmentY),a.stroke();a.restore()}}var module$src$parachute={};module$src$parachute.Parachute=Parachute$$module$src$parachute;class LandingScene$$module$src$landing_scene extends Scene$$module$src$engine$scene{create(){this.background=new SkyBackground$$module$src$sky_background(this);this.parachute=new Parachute$$module$src$parachute(this,400,-787.5);this.addObject(this.parachute);this.spacecraft=new Spacecraft$$module$src$spacecraft(this,400,-337.5);this.spacecraft.engine=Engine$$module$src$spacecraft.OFF;this.spacecraft.flameLength=0;this.addObject(this.spacecraft);this.target=new Target$$module$src$target(this,400,0,
300,30,150);this.target.visible=!1;this.target.angle=90;this.target.width=30;this.target.duration=2;this.addObject(this.target);for(var a=0;20>a;a++)this.addObject(new Cloud$$module$src$cloud(this));this.hint=new Text$$module$src$engine$text(this,"We need to prevent the spacecraft from tilting",400,440,10,Align$$module$src$engine$text.CENTER,Baseline$$module$src$engine$text.BOTTOM);this.hint.visible=!1;this.addText(this.hint);this.addAnimation(new Animation$$module$src$engine$animation(this.background,
{name:"y",start:0,end:-450},3,()=>{Cloud$$module$src$cloud.vY=1;this.addAnimation(new Animation$$module$src$engine$animation(this.background,{name:"y",start:-450,end:-900},3))}));this.addAnimation(new Animation$$module$src$engine$animation(this.parachute,{name:"y",start:-787.5,end:-450},6));this.addAnimation(new Animation$$module$src$engine$animation(this.spacecraft,{name:"y",start:-337.5,end:225},6));this.addTimer(new Timer$$module$src$engine$timer(6,()=>{this.hint.visible=!0;this.target.visible=
!0}));this.addTimer(new Timer$$module$src$engine$timer(9,()=>{this.taskActive=!0}));this.taskActive=!1;this.taskIndex=0;this.tasks=[-40,-30,-20,20,30,40];for(a=0;6>a;a++){let b=randomInteger$$module$src$random(a,5),c=this.tasks[a];this.tasks[a]=this.tasks[b];this.tasks[b]=c}}update(){if(this.taskActive){if(this.target.active){var a=this.game.input;a.left&&60>this.spacecraft.rotation?this.spacecraft.rotation+=.5:a.right&&-60<this.spacecraft.rotation&&(this.spacecraft.rotation-=.5);this.target.spacecraftAngle=
this.spacecraft.rotation+90;Cloud$$module$src$cloud.vY=this.target.satisfied?1:.5}else a=this.tasks[this.taskIndex],0>a&&this.spacecraft.rotation>a?this.spacecraft.rotation-=.25:0<a&&this.spacecraft.rotation<a?this.spacecraft.rotation+=.25:(this.taskIndex++,this.hint.content="Follow the target using the left and right arrows",6===this.taskIndex&&(this.target.onCompleted=()=>{this.hint.content="Hold on tight!";this.taskActive=this.target.visible=!1;this.addAnimation(new Animation$$module$src$engine$animation(this.parachute,
{name:"y",start:-450,end:0},4));this.addAnimation(new Animation$$module$src$engine$animation(this.spacecraft,{name:"y",start:225,end:675},4));this.addTimer(new Timer$$module$src$engine$timer(4,()=>this.game.startScene("LandscapeScene")))}),this.target.restart());this.spacecraft.x=400-225*Math.sin(toRadians$$module$src$angles(this.spacecraft.rotation));this.spacecraft.y=225*Math.cos(toRadians$$module$src$angles(this.spacecraft.rotation))}this.parachute.attachmentX=this.spacecraft.x+30*Math.sin(toRadians$$module$src$angles(this.spacecraft.rotation));
this.parachute.attachmentY=this.spacecraft.y-30*Math.cos(toRadians$$module$src$angles(this.spacecraft.rotation))}}var module$src$landing_scene={};module$src$landing_scene.LandingScene=LandingScene$$module$src$landing_scene;class LandscapeBackground$$module$src$landscape_background extends Background$$module$src$engine$background{constructor(a){super(a);this.gradient=this.scene.game.context.createLinearGradient(0,0,0,this.scene.game.height);this.gradient.addColorStop(0,"#95dfff");this.gradient.addColorStop(1,"#ffc8bb");this.sunX=600;this.sunY=200;this.sunR=50}draw(){let a=this.scene.game.context;a.save();a.fillStyle=this.gradient;a.fillRect(0,0,this.scene.game.width,this.scene.game.height);a.fillStyle="#ff8579";a.beginPath();
a.arc(this.sunX,this.sunY,this.sunR,0,2*Math.PI);a.fill();a.restore()}}var module$src$landscape_background={};module$src$landscape_background.LandscapeBackground=LandscapeBackground$$module$src$landscape_background;class Landscape$$module$src$landscape extends GameObject$$module$src$engine$game_object{constructor(a,b,c,d){super(a,b,c);c=PlanetPalettes$$module$src$planet_palettes.get(d);a=document.createElement("canvas");a.width=this.scene.game.width;a.height=this.scene.game.height;b=a.getContext("2d");b.fillStyle=c.mainColor;b.beginPath();b.arc(a.width/2,4.75*a.height,4*a.height,Math.PI,2*Math.PI);b.fill();b.fillStyle=c.accentColor;if(d===PlanetType$$module$src$planet_type.GREEN){var e=[{x:100,y:380},{x:420,
y:400},{x:500,y:350},{x:700,y:380}];for(var f of e)for(e=random$$module$src$random(60,120),c=0;c<=e;c+=10)for(let g=0;20>g;g++){let h=f.x+random$$module$src$random(-e/4,e/4)*(1-c/e),k=f.y-c;random$$module$src$random(e/8,e/4);b.beginPath();b.arc(h,k,10,0,2*Math.PI);b.fill()}}else if(d===PlanetType$$module$src$planet_type.DESERT){f=[{x:150,y:400},{x:250,y:425},{x:350,y:375},{x:500,y:400},{x:600,y:375},{x:700,y:400}];for(e of f)f=random$$module$src$random(10,20),b.beginPath(),b.arc(e.x,e.y,f,0,2*Math.PI),
b.fill()}if(d===PlanetType$$module$src$planet_type.ICE){d=[{x:100,y:380},{x:420,y:400},{x:500,y:350},{x:700,y:380}];for(let g of d)for(d=randomInteger$$module$src$random(2,4),f=0;f<d;f++)e=random$$module$src$random(30,120),c=random$$module$src$random(-60,60),b.beginPath(),b.moveTo(g.x+e/8,g.y),b.lineTo(g.x+c,g.y-e),b.lineTo(g.x-e/8,g.y),b.fill()}this.image=a}draw(){let a=this.scene.game.context;a.save();a.translate(this.x-this.scene.game.width/2,this.y-this.scene.game.height/2);a.drawImage(this.image,
0,0);a.restore()}}var module$src$landscape={};module$src$landscape.Landscape=Landscape$$module$src$landscape;class Button$$module$src$engine$button{constructor(a,b,c,d=0,e=0){this.scene=a;this.x=b;this.y=c;this.width=d;this.height=e;this.visible=!0}draw(){}containsPoint(a){return a.x>=this.x-this.width/2&&a.x<=this.x+this.width/2&&a.y>=this.y-this.height/2&&a.y<=this.y+this.height/2}onMouseDown(a){this.pressed=this.containsPoint(a)}onMouseUp(a){if(this.pressed&&this.containsPoint(a))this.onClick();this.pressed=!1}onClick(){}}var module$src$engine$button={};module$src$engine$button.Button=Button$$module$src$engine$button;const ENABLED_COLOR$$module$src$engine$text_button="#00adff",DISABLED_COLOR$$module$src$engine$text_button="#9b9b9b",PRESSED_COLOR$$module$src$engine$text_button="#006a9b";
class TextButton$$module$src$engine$text_button extends Button$$module$src$engine$button{constructor(a,b,c,d){super(a,c,d);this.text=new Text$$module$src$engine$text(a,b,0,0,20);this.rectWidth=this.text.width+10;this.rectHeight=this.text.size+10;this.width=this.rectWidth+10;this.height=this.rectHeight+10;this.enabled=!0}draw(){let a=this.scene.game.context;a.save();this.enabled?this.pressed?(a.fillStyle=PRESSED_COLOR$$module$src$engine$text_button,a.strokeStyle=PRESSED_COLOR$$module$src$engine$text_button):
(a.fillStyle=ENABLED_COLOR$$module$src$engine$text_button,a.strokeStyle=ENABLED_COLOR$$module$src$engine$text_button):(a.fillStyle=DISABLED_COLOR$$module$src$engine$text_button,a.strokeStyle=DISABLED_COLOR$$module$src$engine$text_button);a.lineWidth=10;a.lineJoin="round";a.fillRect(this.x-this.rectWidth/2,this.y-this.rectHeight/2,this.rectWidth,this.rectHeight);a.strokeRect(this.x-this.rectWidth/2,this.y-this.rectHeight/2,this.rectWidth,this.rectHeight);a.translate(this.x,this.y);this.text.draw();
a.restore()}}var module$src$engine$text_button={};module$src$engine$text_button.TextButton=TextButton$$module$src$engine$text_button;class LandscapeScene$$module$src$lanscape_scene extends Scene$$module$src$engine$scene{create(){this.background=new LandscapeBackground$$module$src$landscape_background(this);this.landscape=new Landscape$$module$src$landscape(this,400,450,this.game.planetType);this.addObject(this.landscape);this.spacecraft=new Spacecraft$$module$src$spacecraft(this,300,545);this.spacecraft.engine=Engine$$module$src$spacecraft.OFF;this.spacecraft.flameLength=0;this.addObject(this.spacecraft);this.title=new Text$$module$src$engine$text(this,
"Planet 404",400,-100,50);this.addText(this.title);this.hint=new Text$$module$src$engine$text(this,"What a beautiful view!",400,440,10,Align$$module$src$engine$text.CENTER,Baseline$$module$src$engine$text.BOTTOM);this.hint.visible=!1;this.addText(this.hint);this.homeButton=new TextButton$$module$src$engine$text_button(this,"Home",400,225);this.homeButton.visible=!1;this.homeButton.onClick=()=>this.game.startScene("TitleScene");this.addButton(this.homeButton);this.addAnimation(new Animation$$module$src$engine$animation(this.landscape,
{name:"y",start:450,end:225},4));this.addAnimation(new Animation$$module$src$engine$animation(this.spacecraft,{name:"y",start:545,end:320},4));this.addTimer(new Timer$$module$src$engine$timer(6,()=>this.hint.visible=!0));this.addTimer(new Timer$$module$src$engine$timer(9,()=>{this.hint.content="Let's call this planet";this.addAnimation(new Animation$$module$src$engine$animation(this.title,{name:"y",start:-100,end:100},3))}));this.addTimer(new Timer$$module$src$engine$timer(12,()=>this.hint.content=
"Thanks for playing!"));this.addTimer(new Timer$$module$src$engine$timer(15,()=>{this.hint.content="Play again to find planets of a different type";this.homeButton.visible=!0}))}update(){}}var module$src$lanscape_scene={};module$src$lanscape_scene.LandscapeScene=LandscapeScene$$module$src$lanscape_scene;const ARROW_LEFT$$module$src$engine$input="ArrowLeft",ARROW_RIGHT$$module$src$engine$input="ArrowRight";class Input$$module$src$engine$input{constructor(){this.right=this.left=!1;document.addEventListener("keydown",a=>{this.updateKey(a.key,!0)});document.addEventListener("keyup",a=>{this.updateKey(a.key,!1)})}updateKey(a,b){a===ARROW_LEFT$$module$src$engine$input?this.left=b:a===ARROW_RIGHT$$module$src$engine$input&&(this.right=b)}}var module$src$engine$input={};module$src$engine$input.Input=Input$$module$src$engine$input;const TIME_STEP$$module$src$engine$game=1/60,MAX_FRAME$$module$src$engine$game=6*TIME_STEP$$module$src$engine$game;
class Game$$module$src$engine$game{constructor(a){this.canvas=a;this.canvas.addEventListener("mousedown",b=>this.onMouseDown(b));this.canvas.addEventListener("mouseup",b=>this.onMouseUp(b));this.context=a.getContext("2d");this.width=a.width;this.height=a.height;this.input=new Input$$module$src$engine$input;this.scenes=new Map;this.activeScene=null;this.accumulatedTime=this.previousTime=0;this.animationCallback=b=>this.animate(b)}addScene(a,b){this.scenes.set(a,b)}startScene(a){this.activeScene=this.scenes.get(a);
this.activeScene.clear();this.activeScene.create()}start(){requestAnimationFrame(this.animationCallback)}resize(){let a=window.innerWidth,b=window.innerHeight;if(!(this.canvas.clientWidth===a&&this.canvas.height<=b||this.canvas.clientHeight===b&&this.canvas.width<=a)){let c=this.width/this.height;a/b<c?(this.canvas.style.width=a+"px",this.canvas.style.height=a/c+"px"):(this.canvas.style.width=b*c+"px",this.canvas.style.height=b+"px")}}animate(a){a/=1E3;0===this.previousTime&&(this.previousTime=a);
this.accumulatedTime+=Math.min(a-this.previousTime,MAX_FRAME$$module$src$engine$game);this.previousTime=a;for(this.resize();this.accumulatedTime>=TIME_STEP$$module$src$engine$game;)this.activeScene.updateObjects(),this.activeScene.updateAnimations(),this.activeScene.updateTimers(),this.activeScene.update(),this.accumulatedTime-=TIME_STEP$$module$src$engine$game;this.context.clearRect(0,0,this.width,this.height);this.activeScene.draw();requestAnimationFrame(this.animationCallback)}calculatePoint(a){let b=
this.canvas.clientWidth/this.canvas.width,c=this.canvas.getBoundingClientRect();return{x:(a.clientX-c.x)/b,y:(a.clientY-c.y)/b}}onMouseDown(a){this.activeScene.onMouseDown(this.calculatePoint(a))}onMouseUp(a){this.activeScene.onMouseUp(this.calculatePoint(a))}}var module$src$engine$game={};module$src$engine$game.Game=Game$$module$src$engine$game;class TitleScene$$module$src$title_scene extends Scene$$module$src$engine$scene{create(){this.background=new SpaceBackground$$module$src$space_background(this);this.title=new Text$$module$src$engine$text(this,"Planet 404",400,-100,50);this.addText(this.title);this.subtitle=new Text$$module$src$engine$text(this,"that is yet to be found",508,140,10);this.subtitle.visible=!1;this.addText(this.subtitle);this.credits=new Text$$module$src$engine$text(this,"Nikita Zaytsev js13kGames 2020",400,440,10,Align$$module$src$engine$text.CENTER,
Baseline$$module$src$engine$text.BOTTOM);this.credits.visible=!1;this.addText(this.credits);this.startButton=new TextButton$$module$src$engine$text_button(this,"Start",400,225);this.startButton.visible=!1;this.startButton.onClick=()=>this.game.startScene("DepartureScene");this.addButton(this.startButton);this.addAnimation(new Animation$$module$src$engine$animation(this.title,{name:"y",start:-100,end:100},2,()=>{this.subtitle.visible=!0;this.credits.visible=!0;this.startButton.visible=!0;this.addAnimation(new Animation$$module$src$engine$animation(this.subtitle,
{name:"alpha",start:0,end:1},1));this.addAnimation(new Animation$$module$src$engine$animation(this.credits,{name:"alpha",start:0,end:1},1))}))}update(){this.background.move(0,2)}}var module$src$title_scene={};module$src$title_scene.TitleScene=TitleScene$$module$src$title_scene;const MAX_STAR_R$$module$src$map_background=2;function drawStars$$module$src$map_background(a){for(let b=0;400>b;b++){let c=random$$module$src$random(0,a.canvas.width),d=random$$module$src$random(0,a.canvas.height),e=random$$module$src$random(0,MAX_STAR_R$$module$src$map_background);a.beginPath();a.arc(c,d,e,0,2*Math.PI);a.fill()}}
function drawSpiral$$module$src$map_background(a){for(let c=0;c<2*Math.PI;c+=.1){var b=400/(2*Math.PI)*c;let d=b*Math.cos(c);b*=Math.sin(c);for(let e=0;10>e;e++){let f=random$$module$src$random(-40,40),g=random$$module$src$random(-40,40),h=random$$module$src$random(0,MAX_STAR_R$$module$src$map_background);a.beginPath();a.arc(d+f,b+g,h,0,2*Math.PI);a.fill()}}}
function drawCenter$$module$src$map_background(a){for(let d=0;100>d;d++){var b=random$$module$src$random(0,2*Math.PI),c=random$$module$src$random(0,100);let e=c*Math.cos(b);b=c*Math.sin(b);c=random$$module$src$random(0,MAX_STAR_R$$module$src$map_background);a.beginPath();a.arc(e,b,c,0,2*Math.PI);a.fill()}}
class MapBackground$$module$src$map_background extends Background$$module$src$engine$background{constructor(a){super(a);a=document.createElement("canvas");a.width=this.scene.game.width;a.height=this.scene.game.height;let b=a.getContext("2d");b.fillRect(0,0,a.width,a.height);b.fillStyle="#ffffff";drawStars$$module$src$map_background(b);b.translate(a.width/2,a.height/2);drawSpiral$$module$src$map_background(b);b.save();b.rotate(Math.PI);drawSpiral$$module$src$map_background(b);b.restore();drawCenter$$module$src$map_background(b);
this.image=a;this.place=null}draw(){let a=this.scene.game.context;a.save();a.drawImage(this.image,0,0);a.strokeStyle="#00ffff";a.globalAlpha=.5;let b=this.scene.game.width,c=this.scene.game.height,d=b/4,e=c/3;for(var f=e;f<c;f+=e)a.beginPath(),a.moveTo(0,f),a.lineTo(b,f),a.stroke();for(f=d;f<b;f+=d)a.beginPath(),a.moveTo(f,0),a.lineTo(f,c),a.stroke();this.place&&(a.strokeStyle="#ffffff",a.globalAlpha=1,a.lineWidth=4,a.strokeRect(this.place.x*d,this.place.y*e,d,e));a.restore()}}
var module$src$map_background={};module$src$map_background.MapBackground=MapBackground$$module$src$map_background;class MapScene$$module$src$map_scene extends Scene$$module$src$engine$scene{create(){this.background=new MapBackground$$module$src$map_background(this);this.hint=new Text$$module$src$engine$text(this,"Select a place in the galaxy to explore",400,440,10,Align$$module$src$engine$text.CENTER,Baseline$$module$src$engine$text.BOTTOM);this.addText(this.hint);this.goButton=new TextButton$$module$src$engine$text_button(this,"Go!",760,420);this.goButton.visible=!1;this.goButton.onClick=()=>{this.game.planetType=
randomInteger$$module$src$random(0,2);this.game.startScene("JumpScene")};this.addButton(this.goButton);this.place={x:0,y:0}}update(){}onMouseDown(a){super.onMouseDown(a);this.goButton.pressed||(this.place.x=Math.floor(a.x/200),this.place.y=Math.floor(a.y/150),this.background.place=this.place,this.goButton.visible=!0)}}var module$src$map_scene={};module$src$map_scene.MapScene=MapScene$$module$src$map_scene;let canvas$$module$src$main=document.getElementById("canvas"),game$$module$src$main=new Game$$module$src$engine$game(canvas$$module$src$main);game$$module$src$main.addScene("TitleScene",new TitleScene$$module$src$title_scene(game$$module$src$main));game$$module$src$main.addScene("DepartureScene",new DepartureScene$$module$src$departure_scene(game$$module$src$main));game$$module$src$main.addScene("MapScene",new MapScene$$module$src$map_scene(game$$module$src$main));
game$$module$src$main.addScene("JumpScene",new JumpScene$$module$src$jump_scene(game$$module$src$main));game$$module$src$main.addScene("ApproachScene",new ApproachScene$$module$src$approach_scene(game$$module$src$main));game$$module$src$main.addScene("LandingScene",new LandingScene$$module$src$landing_scene(game$$module$src$main));game$$module$src$main.addScene("LandscapeScene",new LandscapeScene$$module$src$lanscape_scene(game$$module$src$main));game$$module$src$main.startScene("TitleScene");game$$module$src$main.start();
var module$src$main={};
