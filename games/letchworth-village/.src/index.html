<style>body,html{margin:0;padding:0;background-color:#000}div{position:absolute;top:0;bottom:0;left:0;right:0}#canvas{width:100%;height:100%}</style><div><canvas id="canvas"></canvas></div><script>const i=3,t=36;class s{static i(i,t,s,h){i.drawImage(t.t,s-t.anchor.x,h-t.anchor.y)}static s(i,t,s,h){i.strokeStyle="rgba(0, 255, 0, 0.5)",i.strokeRect(s-t.anchor.x+t.h[0].x,h-t.anchor.y+t.h[0].y,t.h[1].x-t.h[0].x,t.h[1].y-t.h[0].y)}static o(i,t,s,h){t.v&&(i.strokeStyle="rgba(255, 0, 0, 0.7)",i.strokeRect(s-t.anchor.x+t.v[0].x,h-t.anchor.y+t.v[0].y,t.v[1].x-t.v[0].x,t.v[1].y-t.v[0].y))}static l(i,t,s){let h=i.h[1].x-i.h[0].x,e=i.h[1].y-i.h[0].y,r=(h>e?h:e)/2;return{x:t-i.anchor.x+(i.h[0].x+i.h[1].x)/2,y:s-i.anchor.y+(i.h[0].y+i.h[1].y)/2,r:r}}static p(i,t,s){return this.u(i.anchor,i.h,t,s)}static m(i,t,s){return this.u(i.anchor,i.v,t,s)}static u(i,t,s,h){return{x:s,y:h,g:[{x:t[0].x-i.x,y:t[0].y-i.y},{x:t[1].x-i.x,y:t[0].y-i.y},{x:t[1].x-i.x,y:t[1].y-i.y},{x:t[0].x-i.x,y:t[1].y-i.y}]}}}s.M={},s.k={},s.A={},s.S={},s.O={},s.T={},s.B={},s.C={},s.R={},s.P={},s.N={},s.H={},s.I={},s.L={},s.D={},s.U={},s.F={},s.X={},s.G={},s.K={},s.W={},s.Y={},s.q={},s.$={},s.V={},s.Z={},s.j={},s.J={},s._={},s.ii={},s.ti={},s.si=[{},{},{},{},{},{},{},{},{}],s.hi={},s.ei={},s.ri={},s.ai={},s.ni={};class h{}h.M={frames:[{behavior:1,oi:s.M}]},h.vi={frames:[{behavior:1,oi:s.k},{behavior:1,oi:s.k},{behavior:1,oi:s.k},{behavior:1,oi:s.k},{behavior:1,oi:s.k},{behavior:1,oi:s.k},{behavior:1,oi:s.k},{behavior:1,oi:s.k},{behavior:1,oi:s.A},{behavior:1,oi:s.A},{behavior:1,oi:s.A},{behavior:1,oi:s.A},{behavior:1,oi:s.A},{behavior:1,oi:s.A},{behavior:1,oi:s.A},{behavior:1,oi:s.A}]},h.li={frames:[{behavior:5,oi:s.T,pi:i},{behavior:5,oi:s.T,pi:i},{behavior:6,oi:s.B,pi:i},{behavior:6,oi:s.B,pi:3*i},{behavior:6,oi:s.B,pi:2*i,bi:!0},{behavior:6,oi:s.B,pi:2*i},{behavior:6,oi:s.B,pi:i},{behavior:7,oi:s.S,pi:i/3},{behavior:7,oi:s.S,pi:i/3},{behavior:7,oi:s.S,pi:i/3}]},h.ui={frames:[{behavior:5,oi:s.S,pi:i},{behavior:5,oi:s.S,pi:i},{behavior:6,oi:s.C,pi:i},{behavior:6,oi:s.C,pi:3*i},{behavior:6,oi:s.C,pi:2*i,bi:!0},{behavior:6,oi:s.C,pi:2*i},{behavior:6,oi:s.C,pi:i},{behavior:7,oi:s.O,pi:i/3},{behavior:7,oi:s.O,pi:i/3},{behavior:7,oi:s.O,pi:i/3}]},h.P={frames:[{behavior:8,oi:s.k,pi:4,ci:!0},{behavior:8,oi:s.P,pi:7,ci:!0},{behavior:8,oi:s.P,pi:8,ci:!0},{behavior:8,oi:s.P,pi:9,ci:!0},{behavior:8,oi:s.P,pi:9,ci:!0},{behavior:8,oi:s.P,pi:9,ci:!0},{behavior:8,oi:s.P,pi:8,ci:!0},{behavior:8,oi:s.P,pi:7,ci:!0},{behavior:8,oi:s.k,pi:2,ci:!0},{behavior:8,oi:s.k,pi:1,ci:!0}]},h.R={frames:[{behavior:9,oi:s.R,ci:!0,pi:3*i},{behavior:9,oi:s.R,ci:!0,pi:3*i},{behavior:9,oi:s.R,ci:!0,pi:3*i},{behavior:9,oi:s.R,ci:!0,pi:3*i},{behavior:9,oi:s.R,ci:!0},{behavior:9,oi:s.R,ci:!0},{behavior:9,oi:s.R,ci:!0}]},h.N={frames:[{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:10,oi:s.N,ci:!0,pi:0},{behavior:11,oi:s.N,pi:0},{behavior:7,oi:s.N,pi:0},{behavior:7,oi:s.N,pi:0},{behavior:7,oi:s.N,pi:0},{behavior:7,oi:s.N,pi:0},{behavior:7,oi:s.N,pi:0},{behavior:7,oi:s.N,pi:0},{behavior:7,oi:s.N,pi:0}]},h.mi={frames:[{behavior:6,oi:s.I,ci:!0,pi:0},{behavior:6,oi:s.I,ci:!0,pi:0},{behavior:6,oi:s.I,ci:!0,pi:0},{behavior:6,oi:s.H,ci:!0,pi:0},{behavior:6,oi:s.H,ci:!0,pi:0},{behavior:6,oi:s.H,ci:!0,pi:0,bi:!0},{behavior:6,oi:s.L,ci:!0,pi:0},{behavior:6,oi:s.L,ci:!0,pi:0},{behavior:6,oi:s.I,ci:!0,pi:0},{behavior:6,oi:s.I,ci:!0,pi:0},{behavior:6,oi:s.H,ci:!0,pi:0},{behavior:1,oi:s.H,ci:!0},{behavior:1,oi:s.L,ci:!0},{behavior:1,oi:s.L,ci:!0},{behavior:1,oi:s.I,ci:!0},{behavior:1,oi:s.I,ci:!0},{behavior:1,oi:s.H,ci:!0},{behavior:1,oi:s.k,ci:!0},{behavior:1,oi:s.k,ci:!0},{behavior:1,oi:s.k,ci:!0},{behavior:1,oi:s.k,ci:!0},{behavior:1,oi:s.k,ci:!0},{behavior:1,oi:s.k,ci:!0},{behavior:1,oi:s.A,ci:!0},{behavior:1,oi:s.A,ci:!0},{behavior:1,oi:s.A,ci:!0},{behavior:1,oi:s.A,ci:!0},{behavior:1,oi:s.A,ci:!0},{behavior:1,oi:s.A,ci:!0}]},h.yi={frames:[{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:13,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:12,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0},{behavior:7,oi:s.R,ci:!0}]},h.wi={frames:[{behavior:1,oi:s.U},{behavior:1,oi:s.U},{behavior:1,oi:s.U},{behavior:1,oi:s.U},{behavior:1,oi:s.F},{behavior:1,oi:s.F},{behavior:1,oi:s.F},{behavior:1,oi:s.F},{behavior:1,oi:s.X},{behavior:1,oi:s.X},{behavior:1,oi:s.X},{behavior:1,oi:s.X}]},h.xi={frames:[{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.K,bi:!0},{behavior:6,oi:s.K},{behavior:6,oi:s.K},{behavior:6,oi:s.K},{behavior:7,oi:s.K},{behavior:7,oi:s.K},{behavior:7,oi:s.K},{behavior:7,oi:s.K}]},h.fi={frames:[{behavior:14,oi:s.U,ci:!0},{behavior:14,oi:s.U,ci:!0},{behavior:14,oi:s.U,ci:!0},{behavior:14,oi:s.U,ci:!0},{behavior:15,oi:s.U,ci:!0}]},h.W={frames:[{behavior:9,oi:s.W,ci:!0,pi:7.5},{behavior:9,oi:s.W,ci:!0,pi:7.5},{behavior:9,oi:s.W,ci:!0,pi:7.5},{behavior:9,oi:s.W,ci:!0,pi:7.5},{behavior:9,oi:s.W,ci:!0,pi:5},{behavior:9,oi:s.W,ci:!0,pi:2.5},{behavior:9,oi:s.W,ci:!0,pi:2.5},{behavior:9,oi:s.W,ci:!0,pi:2.5},{behavior:9,oi:s.W,ci:!0,pi:2.5},{behavior:9,oi:s.W,ci:!0},{behavior:9,oi:s.W,ci:!0},{behavior:9,oi:s.W,ci:!0},{behavior:9,oi:s.W,ci:!0},{behavior:9,oi:s.W},{behavior:9,oi:s.W},{behavior:9,oi:s.W},{behavior:9,oi:s.W}]};class e{static async init(){await this.di(s.M,"player.png",0,0,64,64,{h:[{x:21,y:25},{x:42,y:38}]}),await this.di(s.k,"player.png",64,0,64,64,{h:[{x:21,y:25},{x:42,y:38}]}),await this.di(s.A,"player.png",128,0,64,64,{h:[{x:21,y:25},{x:42,y:38}]}),await this.di(s.T,"player.png",192,0,64,64,{h:[{x:21,y:25},{x:42,y:38}]}),await this.di(s.B,"player.png",256,0,64,64,{h:[{x:21,y:25},{x:42,y:38}],v:[{x:14,y:8},{x:50,y:35}]}),await this.di(s.S,"player.png",320,0,64,64,{h:[{x:21,y:25},{x:42,y:38}]}),await this.di(s.C,"player.png",384,0,64,64,{h:[{x:21,y:25},{x:42,y:38}],v:[{x:14,y:8},{x:50,y:35}]}),await this.di(s.O,"player.png",128,0,64,64,{h:[{x:21,y:25},{x:42,y:38}]}),await this.di(s.N,"player.png",448,0,64,64,{h:[{x:13,y:17},{x:50,y:46}]}),await this.di(s.H,"player.png",512,0,64,64,{h:[{x:21,y:25},{x:42,y:38}],v:[{x:-12,y:-12},{x:76,y:76}]}),await this.di(s.I,"player.png",512,0,64,64,{h:[{x:21,y:25},{x:42,y:38}],v:[{x:-12,y:-12},{x:76,y:76}]}),await this.di(s.L,"player.png",512,0,64,64,{h:[{x:21,y:25},{x:42,y:38}],v:[{x:-12,y:-12},{x:76,y:76}]}),await this.di(s.U,"demon1.png",0,0,16,22),await this.di(s.F,"demon1.png",16,0,16,22),await this.di(s.X,"demon1.png",32,0,16,22),await this.di(s.G,"demon1.png",48,0,16,22,{h:[{x:0,y:7},{x:16,y:22}]}),await this.di(s.K,"demon1.png",64,0,16,22,{h:[{x:0,y:7},{x:16,y:22}],v:[{x:0,y:0},{x:16,y:10}]}),await this.di(s.Y,"demon1.png",80,0,16,22),await this.di(s.q,"demon1.png",96,0,16,22),await this.di(s.$,"demon1.png",112,0,16,22),await this.di(s.V,"demon1.png",128,0,16,22),await this.di(s.Z,"demon1.png",144,0,16,22),await this.gi(s.R,this.Mi(s.k.t,255,255,255,.6)),await this.gi(s.P,this.Mi(s.T.t,96,96,255,.8)),await this.gi(s.W,this.Mi(s.U.t,255,255,255,.6));let i=[s.M,s.k,s.A,s.S,s.O,s.T,s.B,s.C,s.R,s.P,s.N,s.H,s.I,s.L];for(let t of i)t.ki={},await this.gi(t.ki,this.Mi(t.t,0,0,0,1));s.D.anchor=s.B.anchor,s.D.v=[{x:4,y:2},{x:60,y:38}],await this.gi(s.j,this.Ei(2)),await this.gi(s.J,this.Ei(3)),await this.gi(s._,this.Ai(2)),await this.gi(s.ii,this.Ai(3)),await this.di(s.si[0],"tiles.png",0,0,32,32),await this.di(s.si[1],"tiles.png",32,0,32,32),await this.di(s.si[2],"tiles.png",64,0,32,32),await this.di(s.si[3],"tiles.png",96,0,32,32),await this.di(s.si[4],"tiles.png",128,0,32,32),await this.di(s.si[5],"tiles.png",160,0,32,32),await this.di(s.si[6],"tiles.png",192,0,32,32),await this.di(s.si[7],"tiles.png",224,0,32,32),await this.di(s.si[8],"tiles.png",256,0,32,32),await this.di(s.hi,"swordmeter.png",0,0,32,116),await this.di(s.ei,"swordmeter.png",48,0,32,116),await this.di(s.ri,"swordmeter.png",96,0,32,116),await this.di(s.ai,"swordmeter.png",144,0,32,116),await this.di(s.ti,"player.png",512,0,11,11),await this.di(s.ni,"portal.png",0,0,32,32)}static async di(i,t,s,h,e,r,a){await this.gi(i,await this.Si(t,s,h,e,r),a)}static async gi(i,t,s){let h=t.width,e=t.height;i.t=t,i.anchor=s&&s.anchor||{x:Math.floor(h/2),y:Math.floor(e/2)},i.h=s&&s.h||[{x:0,y:0},{x:h,y:e}],i.v=s&&s.v}static async Si(i,t,s,h,e){const r=await this.Oi(i),a=new l(h,e);return a.Ti.drawImage(r,t,s,h,e,0,0,h,e),a.canvas}static async Oi(i){return this.images[i]?this.images[i]:await new Promise((t,s)=>{let h=new Image;h.onload=()=>t(h),h.onerror=i=>s(i),h.src=i,this.images[i]=h})}static Mi(i,t,s,h,e){const r=new l(i.width,i.height),a=r.Ti;return a.drawImage(i,0,0),a.globalCompositeOperation="source-atop",a.globalAlpha=e,a.fillStyle=V(t,s,h,1),a.fillRect(0,0,i.width,i.height),r.canvas}static Ei(i){const t=new l(i,i),s=t.Ti;return s.fillStyle="rgba(255, 0, 0, 0.9)",s.fillRect(0,0,i,i),t.canvas}static Ai(i){const t=new l(i,i),s=t.Ti;return s.fillStyle="rgba(128, 250, 255, 0.8)",s.fillRect(0,0,i,i),s.fillStyle="rgba(255, 255, 255, 0.8)",s.fillRect(0,0,1,1),t.canvas}static Bi(i,t){const s=new l(i,t);for(let h=0;h<t;h++)for(let t=0;t<i;t++){let i=Math.floor(256*Math.random());s.Ti.fillStyle=V(i,i,i,1),s.Ti.fillRect(t,h,1,1)}return s}}e.images={};class r{constructor(){this.Ci=!1,this.muted=!1}init(){if(this.Ci)return;this.Ci=!0;const i=window.AudioContext||window.webkitAudioContext;this.Ti=new i,this.Ri=new o(this.Ti,.8),this.Pi=new n(this.Ti,.7),this.Ni=new v(this.Ti,.9),this.Hi=this.Ii(),this.Li=-1,this.Ri.play(1,this.Ti.currentTime)}Ii(){let i=[],t=[[[1],[],[1],[]],[[],[],[2],[]],[[1],[],[1],[]],[[],[],[2],[]],[[],[1],[1],[]],[[],[],[2],[]],[[1],[],[1],[]],[[],[],[2],[]],[[1],[],[1],[]],[[],[],[2],[]],[[],[],[1],[]],[[],[],[2],[]],[[],[1],[1],[]],[[],[],[2],[]],[[],[],[1],[]],[[],[],[2],[]]];for(let s of t){i.push(s);for(let t=0;t<7;t++)i.push(void 0)}return i}Di(){if(!this.Ci)return;if(this.muted)return;this.Li=(this.Li+1)%this.Hi.length;let i=this.Hi[this.Li];if(i&&(void 0!==i[0][0]&&this.Ri.play(i[0][0],this.Ti.currentTime),void 0!==i[1][0]&&this.Pi.play(i[1][0],this.Ti.currentTime),void 0!==i[2][0]&&0===z.Ui.length)){let t=-45;1===i[2][0]?(this.Fi&&this.z(2307),this.Fi=!1,this.Xi=!1):2===i[2][0]&&(this.Gi&&this.z(25520),this.Ki?(this.z(12377),t=void 0):this.Wi?t+=6:t=void this.Gi,this.Gi=!1,this.Wi=!1,this.Ki=!1),void 0!==t&&this.Ni.play(t,this.Ti.currentTime)}}Yi(){this.Xi=!0}qi(){this.z(55574,{length:.2})}$i(){this.Fi=!0}Qi(){this.z(71914,{volume:.7,length:.1,attack:.79,Vi:5.1,Zi:1.2,ji:9})}zi(){this.Wi=!0}Ji(){this.z(2756,{volume:.7,frequency:850,length:.5})}z(...i){this.muted||ZZFX.z(...i)}}class a{constructor(i,t){this.Ti=i,this._i=this.Ti.createGain(),this._i.connect(this.Ti.destination),this._i.gain.value=t||1}}class n extends a{play(i,t){var s=this.Ti.createBiquadFilter();s.type="bandpass",s.frequency.value=1e4;var h=this.Ti.createBiquadFilter();h.type="highpass",h.frequency.value=7e3;var e=this.Ti.createGain();e.gain.setValueAtTime(0,t),e.gain.linearRampToValueAtTime(1,t+.01),e.gain.linearRampToValueAtTime(0,t+.05),[2,3,4.16,5.43,6.79,8.21].forEach(i=>{var h=this.Ti.createOscillator();h.type="square",h.frequency.value=40*i,h.connect(s),h.start(t),h.stop(t+.05),h.connect(s)}),s.connect(h),h.connect(e),e.connect(this._i)}}class o extends a{play(i,t){let s=this.Ti.createOscillator(),h=this.Ti.createOscillator(),e=this.Ti.createGain(),r=this.Ti.createGain();s.type="triangle",s.frequency.setValueAtTime(120,t),s.frequency.exponentialRampToValueAtTime(.001,t+.5),e.gain.setValueAtTime(0,t),e.gain.linearRampToValueAtTime(1,t+.016),e.gain.linearRampToValueAtTime(0,t+.5),s.connect(e),e.connect(this._i),h.type="sine",h.frequency.setValueAtTime(50,t),r.gain.setValueAtTime(0,t),r.gain.linearRampToValueAtTime(1,t+.016),r.gain.exponentialRampToValueAtTime(.001,t+.5),h.connect(r),r.connect(this._i),s.start(t),s.stop(t+.51),h.start(t),h.stop(t+.51)}}class v extends a{play(i,t){this.it||this.tt(),this.it.frequency.value=240*Math.sin(z.frame*m[360]/240)+420;let s=this.Ti.createOscillator(),h=this.Ti.createGain();h.gain.setValueAtTime(0,t),h.gain.linearRampToValueAtTime(1,t+.0105),h.gain.setValueAtTime(1,t+.105),h.gain.linearRampToValueAtTime(0,t+.189),h.connect(this.it),s.connect(h),s.type="triangle",s.frequency.value=440,s.detune.value=100*i,s.start(t),s.stop(t+.21)}tt(){this.it=this.Ti.createBiquadFilter(),this.it.type="lowpass",this.it.frequency.setValueAtTime(220,0),this.it.Q.value=9,this.it.connect(this._i),this.st=this.Ti.createOscillator(),this.st.frequency.value=200,this.st.connect(this.it.detune),this.st.start()}}class l{constructor(i,t){this.canvas=document.createElement("canvas"),this.canvas.width=i,this.canvas.height=t,this.Ti=this.canvas.getContext("2d")}}class p{constructor(i,t){this.x=i,this.y=t,this.ht={x:0,y:-1,pi:0},this.et=m[45],this.rt=0,this.mode="hover",this.at=19,this.nt=[];for(let i=0;i<28;i++)this.nt.push({behavior:2,oi:s.U})}ot(i){this.nt=i.frames.slice(),this.frame=this.nt.shift()}vt(i){0===this.nt.length?this.ot(i):this.frame=this.nt.shift()}update(){if(this.vt(h.wi),14!==this.frame.behavior&&15!==this.frame.behavior&&this.at<=0&&(this.ot(h.fi),z.lt.zi()),2===this.frame.behavior)this.next={x:this.x,y:this.y};else if(14===this.frame.behavior)this.next={x:this.x,y:this.y};else{if(15===this.frame.behavior){let i=Math.random()<.4?3:2;for(let t=0;t<i;t++){let i=g(this.pt,Math.random()*m[90]-m[45]),t=Math.floor(5*Math.random())+16,h=65*Math.random()+30,e=[s.Y,s.q,s.$,s.V,s.Z][Math.floor(5*Math.random())];z.bt.push(new X(this,{x:this.x+i.x*h,y:this.y+i.y*h},Q.ut,e,t))}return z.ct.push(new q(15,3,3)),z.wt.yt++,!1}if(1===this.frame.behavior){this.frame.oi=[s.U,s.F,s.X][Math.floor(z.frame/5)%3];let i=x(this,z.xt);this.et=f(i);let t=x(this,{x:z.xt.x-i.x*z.dt.ft,y:z.xt.y-i.y*z.dt.ft}),e=d(t.pi,0,20)/5;i.pi<z.dt.ft&&(e/=2),this.next={x:this.x+t.x*e,y:this.y+t.y*e};let r,a=z.frame-p.gt;r=a<5?.005:a<15?.01:a<30?.02:.05,(k(this,z.xt)<=60&&Math.random()<r||Math.random()<r/4)&&(this.nt=h.xi.frames.slice())}else if(5===this.frame.behavior){let i=x(this,z.xt),t=-.5;this.et=f(i),this.next={x:this.x+i.x*t,y:this.y+i.y*t}}else if(6===this.frame.behavior){let i=w(this.et),t=5;this.next={x:this.x+i.x*t,y:this.y+i.y*t}}else if(7===this.frame.behavior){let i=w(this.et),t=1;this.next={x:this.x+i.x*t,y:this.y+i.y*t}}else 9===this.frame.behavior&&(this.next={x:this.x+this.pt.x*(this.frame.pi||0),y:this.y+this.pt.y*(this.frame.pi||0)})}return!0}Mt(){let i=t+8-26;return k(this,z.xt)<=60&&z.frame%i==0}attack(){this.nt=[{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:5,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G},{behavior:6,oi:s.G}]}kt(i){2!==this.frame.behavior&&(i.Et=!1,i.save(),i.translate(this.x,this.y),i.rotate(this.et+m[90]),s.i(i,this.frame.oi,0,0),i.restore())}At(i){if(this.frame.ci)return;z.lt.Qi(),this.at-=z.xt.St();let t=x(i,this);this.pt=t,this.nt=h.W.frames.slice(),j(this,t,10,4,20),z.xt.Ot>=4&&j(this,t,5,3,40),z.xt.Ot>=8&&j(this,t,5,5,29),z.xt.Ot>=12&&j(this,t,5,4,35)}Tt(){return M(s.p(this.frame.oi,this.x,this.y),this.et+m[90])}l(){return s.l(this.frame.oi,this.x,this.y)}Bt(){if(this.frame.oi.v)return M(s.m(this.frame.oi,this.x,this.y),this.et+m[90])}Ct(){return!1}}p.gt=0;const b=.15,u=.9;class c{constructor(i){this.Rt=i,this.Pt={},this.map=[],this.map[2]=5,this.map[3]=6,this.map[0]=7,this.map[1]=8,this.map[12]=1,this.map[13]=2,this.map[14]=3,this.map[15]=4,this.map[9]=9,this.reset()}async init(){window.addEventListener("gamepadconnected",i=>{this.Nt=i.gamepad.index;this.Ht();this.reset(),z.lt.init()}),window.addEventListener("gamepaddisconnected",i=>{this.Nt===i.gamepad.index&&(this.Nt=void 0),this.reset()})}update(){if(this.connected()){let i=this.Ht();this.direction=y({x:i.axes[0],y:i.axes[1]}),this.direction.pi<b?this.direction.pi=0:this.direction.pi>u&&(this.direction.pi=1);for(let t=0;t<i.buttons.length;t++)if(this.map[t]){let s=this.Pt[this.map[t]],h=i.buttons[t].pressed;h&&!s?this.Rt.It(this.map[t]):!h&&s&&this.Rt.Lt(this.map[t]),this.Pt[this.map[t]]=h}}}connected(){return void 0!==this.Nt}Ht(){return navigator.getGamepads()[this.Nt]}reset(){this.direction={x:0,y:0,pi:0};for(let i of C.Dt)this.Pt[i]=!1}}const m=(()=>{let i=[];for(let t=0;t<=360;t++)i[t]=2*Math.PI*t/360;return i})();function y(i){let t=Math.sqrt(i.x*i.x+i.y*i.y);return{x:i.x/t,y:i.y/t,pi:t}}function w(i){return{x:Math.cos(i),y:Math.sin(i),pi:1}}function x(i,t){return y({x:t.x-i.x,y:t.y-i.y})}function f(i){return Math.atan2(i.y,i.x)}function d(i,t,s){return i<t?t:i>s?s:i}function g(i,t){return t+=Math.atan2(i.y,i.x),{x:Math.cos(t),y:Math.sin(t),pi:i.pi}}function M(i,t){return{x:i.x,y:i.y,g:i.g.map(i=>(function(i,t){let s=Math.sqrt(i.x*i.x+i.y*i.y);return t+=Math.atan2(i.y,i.x),{x:Math.cos(t)*s,y:Math.sin(t)*s}})(i,t))}}function k(i,t){return Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y))}function E(i,t){let s,h,e,r=1/0,a=-1/0;for(let n of i.g)s=i.x+n.x,h=i.y+n.y,r=(e=s*t.x+h*t.y)<r?e:r,a=e>a?e:a;return[r,a]}function A(i){let t,s,h,e,r,a=[];for(let n=0;n<i.g.length;n++)t=i.g[n],h=(s=i.g[(n+1)%i.g.length]).y-t.y,e=-(s.x-t.x),r=Math.sqrt(h*h+e*e),a[n]={x:h/r,y:e/r,pi:1},a[n+i.g.length]={x:-h/r,y:-e/r,pi:1};return a}function S(i,t){let s=A(i).concat(A(t));for(let h of s){let s=E(i,h),e=E(t,h);if(!(s[0]<=e[1]&&s[1]>=e[0]||e[0]>=s[1]&&e[1]>=s[0]))return!1}return!0}function O(i,t){return k(i,t)<=i.r+t.r}class T{constructor(){this.frame=0,this.Ut=0,this.ft=64}update(){this.frame++,this.Ut=this.frame*m[1]%m[360]}kt(i){}Ft(){let i=[];for(let t=0;t<8;t++)i.push({x:Math.cos(t*m[45]+this.Ut),y:Math.sin(t*m[45]+this.Ut),pi:1});return i}}class B{constructor(){this.ct=[],this.Xt=120,this.Gt=120,this.Kt=new l(32,116)}update(){this.frame=this.frame||0,this.frame++,this.ct=this.ct.filter(i=>i.update()),this.Xt++}kt(i){this.Kt.Ti.globalCompositeOperation="copy",this.Kt.Ti.drawImage(s.hi.t,0,0),this.Kt.Ti.globalCompositeOperation="source-atop";let t=Math.floor(95*z.xt.Wt/9e3),h=111-t;this.Kt.Ti.fillStyle="red",this.Kt.Ti.fillRect(0,h,32,t),this.Kt.Ti.globalCompositeOperation="source-over",z.xt.Yt()?this.Kt.Ti.drawImage(s.ri.t,0,0):this.Kt.Ti.drawImage(s.ei.t,0,0),z.xt.Wt>=9e3&&this.Kt.Ti.drawImage(s.ai.t,0,0),i.save();let e=0,r=0;this.ct.forEach(i=>{e+=i.x,r+=i.y}),i.translate(e,r),i.drawImage(this.Kt.canvas,0,0),i.restore();let a=Math.min(1,1-this.Xt/this.Gt);if(a>0){i.globalAlpha=a;let t=String(z.xt.Ot)+"x",s=i.measureText(t).width;i.font="20px monospace",i.fillStyle="rgba(240, 32, 32, 0.75)",i.fillText(t,464-s,24),i.globalAlpha=1}}}class C{async init(){this.pressed={},this.qt={},this.Pt={},this.$t={},this.Qt=new H(this),await this.Qt.init(),this.gamepad=new c(this),await this.gamepad.init()}update(){this.Qt.update(),this.gamepad.update();for(let i of C.Dt){let t=this.gamepad.Pt[i]||this.Qt.Pt[i];this.pressed[i]=!this.Pt[i]&&t,this.qt[i]=this.Pt[i]&&!t,this.pressed[i]?this.$t[i]=1:this.Pt[i]&&t&&this.$t[i]++,this.Pt[i]=t}this.direction=this.gamepad.direction.pi>0?this.gamepad.direction:this.Qt.direction}It(i){}Lt(i){}}!function(i){i.Dt=[1,2,3,4,5,6,7,8,9,10,11]}(C||(C={}));const R=0,P=.7071067811865475,N=1;class H{constructor(i){this.Rt=i,this.Pt={},this.map=[],this.map[88]=5,this.map[90]=6,this.map[67]=7,this.map[32]=8,this.map[38]=1,this.map[40]=2,this.map[37]=3,this.map[39]=4,this.map[27]=9,this.map[77]=10,this.map[70]=11,this.map[80]=11,this.reset()}async init(){window.addEventListener("keydown",i=>{let t=this.map[i.keyCode];t&&(this.Pt[t]=!0),z.lt.init()}),window.addEventListener("keyup",i=>{let t=this.map[i.keyCode];t&&(this.Pt[t]=!1)})}update(){switch((this.Pt[1]?1:0)+(this.Pt[2]?2:0)+(this.Pt[3]?4:0)+(this.Pt[4]?8:0)){case 0:this.direction={x:R,y:R,pi:0};break;case 1:this.direction={x:R,y:-N,pi:1};break;case 2:this.direction={x:R,y:N,pi:1};break;case 3:this.direction={x:R,y:R,pi:0};break;case 4:this.direction={x:-N,y:R,pi:1};break;case 5:this.direction={x:-P,y:-P,pi:1};break;case 6:this.direction={x:-P,y:P,pi:1};break;case 7:this.direction={x:-N,y:R,pi:1};break;case 8:this.direction={x:N,y:R,pi:1};break;case 9:this.direction={x:P,y:-P,pi:1};break;case 10:this.direction={x:P,y:P,pi:1};break;case 11:this.direction={x:N,y:R,pi:1};break;case 12:this.direction={x:R,y:R,pi:0};break;case 13:this.direction={x:R,y:-N,pi:1};break;case 14:this.direction={x:R,y:N,pi:1};break;case 15:this.direction={x:R,y:R,pi:0}}}reset(){this.direction={x:0,y:0,pi:0};for(let i of C.Dt)this.Pt[i]=!1}}class I{constructor(i){this.state=1,i&&i.Vt&&(this.Vt=i.Vt)}Zt(){return 3!=this.state}}class L extends I{constructor(i){super(i),this.frames=0}update(){switch(this.state){case 1:this.frames++,this.frames>=70&&(this.state=2);break;case 2:z.input.pressed[5]&&(this.state=3,this.frames=10);break;case 3:if(this.frames--,this.frames<0)return!1}return!0}kt(i){let t,s;1===this.state||2===this.state?(s=70,t=1-.66*Math.min(this.frames/s,1)):(s=10,t=.33*Math.min(this.frames/s,1)),i.fillStyle=V(0,0,0,t),i.fillRect(0,0,z.canvas.width,z.canvas.height),i.font="12px monospace",i.fillStyle="white";let h=["Awake again. Why?","The smell of demons fills the air. Send them...","","                      BACK TO HELL!","","Drink until you are full, then banish them for good.","","             Welcome to Letchworth Village.","","         PRESS [X] / (X) / (SQUARE) TO CONTINUE"];i.save(),i.scale(Math.min(this.frames,10)/10,1),i.rotate(Math.max(10-this.frames,0)*-m[5]);for(let t=0;t<h.length;t++)i.fillText(h[t].toUpperCase(),30,50+20*t);i.restore()}}class D extends I{constructor(i){super(i),this.frames=0}update(){switch(this.state){case 1:this.frames++,this.frames>=10&&(this.state=2);break;case 2:z.input.pressed[5]&&(this.state=3);break;case 3:if(this.frames--,this.frames<0)return!1}return!0}kt(i){let t=.33*Math.min(this.frames/10,1);i.fillStyle=V(0,0,0,t),i.fillRect(0,0,z.canvas.width,z.canvas.height),i.font="12px monospace",i.fillStyle="white";let s=["CONTROLS                     [KEYBOARD]   (GAMEPAD)","","ATTACK                       [X]        / (X) / (SQUARE)","COUNTER                      [Z]        / (Y) / (TRIANGLE)","DASH                         [C]        / (A) / (CROSS)","FINISHER (W/FULL CHARGE)     [SPACEBAR] / (B) / (CIRCLE)","CONSUME                      AUTOMATIC","","         PRESS [X] / (X) / (SQUARE) TO CONTINUE"];i.save(),i.scale(this.frames/10,1),i.rotate((10-this.frames)*m[5]);for(let t=0;t<s.length;t++)i.fillText(s[t].toUpperCase(),30,50+20*t);i.restore()}}class U extends I{constructor(i){super(i),this.frames=0}update(){switch(this.state){case 1:this.frames++,this.frames>=10&&(this.state=2);break;case 2:break;case 3:if(this.frames--,this.frames<0)return!1}return!0}kt(i){let t=.33*Math.min(this.frames/10,1);i.fillStyle=V(0,0,0,t),i.fillRect(0,0,z.canvas.width,z.canvas.height),i.font="12px monospace",i.fillStyle="white";let s=["","       CONGRATULATIONS. YOU HAVE CLOSED THE PORTAL.","","     THOSE DEMONS ARE BACK IN HELL WHERE THEY BELONG!","","                    Your Score: "+z.jt(),"","","The game is now over, but you can reload your browser to","play again. Thanks for playing!"];i.save(),i.scale(this.frames/10,1),i.rotate((10-this.frames)*m[5]);for(let t=0;t<s.length;t++)i.fillText(s[t].toUpperCase(),30,50+20*t);i.restore()}}class F{constructor(i,t,s,h,e,r){this.p1={x:i.x,y:i.y},this.p2={x:t.x,y:t.y},this.zt=s,this.oi=h,this.Jt=-1,this.d=e,this.complete=r,this._t=!1}update(){return++this.Jt>this.d?!(this instanceof K)&&(this.update=G.prototype.update,this.d=this.Jt+280,!0):(this.x=this.zt(this.Jt,this.p1.x,this.p2.x,this.d),this.y=this.zt(this.Jt,this.p1.y,this.p2.y,this.d),!0)}kt(i){s.i(i,this.oi,this.x,this.y)}}F.ts=[];class X extends F{constructor(i,t,s,h,e,r){super(i,t,s,h,e,r),this.r=Math.random()*m[360],this.ss=(Math.random()*m[4]+m[2])*(Math.random()<.5?1:-1)}update(){return!!super.update()&&(this.r+=this.ss,j(this,g({x:1,y:0,pi:1},this.r),1,1,16),!0)}kt(i){i.save(),i.translate(this.x,this.y),i.rotate(this.r),s.i(i,this.oi,0,0),i.restore()}}class G extends F{update(){if(z.xt.Yt()&&(this.Jt=this.d+45),this.Jt>this.d){this.Jt++;let i=d((this.Jt-this.d)/30+2,0,5.5),t=x(this,z.xt);if(t=g(t,this.Jt>this.d+150?m[20]:m[45]),this.x=this.x+t.x*i,this.y=this.y+t.y*i,k(this,z.xt)<5.5)return z.xt.hs(this.oi.t.width>4?3:2),!1}return!0}}class K extends F{constructor(i,t,s,h,e,r){super(i,t,s,h,e),this.r=Math.random()*m[360],this.ss=m[6],this._t=!0}update(){return!!super.update()&&(this.r+=this.ss,!0)}kt(i){i.save(),i.translate(this.x,this.y),i.rotate(this.r);let t=1-2*Math.abs(this.Jt/this.d-.5);i.scale(t,t),s.i(i,this.oi,0,0),i.restore()}es(){let i=1-2*Math.abs(this.Jt/this.d-.5);return Math.floor(18*i)}}class W extends F{constructor(i,t,s,h,e,r){super(i,t,s,h,e),this._t=!0,this.x=i.x,this.y=i.y}update(){return!(++this.Jt>this.d)||(z.bt=[],z.rs=[],!1)}kt(i){i.save();let t=this.Jt/this.d*450;i.strokeStyle="red",i.lineWidth=150,i.beginPath(),i.arc(this.x,this.y,t,0,2*Math.PI),i.stroke(),i.restore()}es(){return this.Jt/this.d*450}}class Y{constructor(){this.x=240,this.y=165,this.ht={x:0,y:-1,pi:0},this.et=Math.atan2(this.ht.y,this.ht.x),this.nt=[],this.Wt=2e3,this.as=0,this.ns=[],this.os=[],this.Ot=0,this.vs={ls:void 0,attack:void 0,ps:void 0}}ot(i){this.nt=i.frames.slice(),this.frame=this.nt.shift()}vt(i){0===this.nt.length?this.ot(i):this.frame=this.nt.shift()}update(){if(this.ns.unshift({x:this.x,y:this.y}),this.ns=this.ns.slice(0,10),this.Wt<0&&(this.Wt=0),this.Wt<2e3&&(this.Wt+=4),this.Ot>=4&&(this.os.length<1||z.frame%5==0)&&(this.os=[],this.os.push({x:4*Math.random()-2,y:4*Math.random()-2+2,bs:.25*Math.random()+1,a:.3}),this.Ot>=8&&(this.os.length<2||z.frame%5==0)&&this.os.push({x:6*Math.random()-3,y:6*Math.random()-3+3,bs:.75*Math.random()+1,a:.3})),this.as=(this.as+1)%600,480===this.as&&(z.ct.push(new q(28,9,15)),z.us.ct.push(new q(16,9,1)),z.lt.z(2914,{length:1.5,attack:.35,ji:1})),this.vt(h.vi),z.input.pressed[7]&&(this.vs.ls=z.frame),z.input.pressed[5]&&(this.vs.attack=z.frame),z.input.pressed[6]&&(this.vs.ps=z.frame),1===this.frame.behavior)z.input.direction.pi>0?(this.ht=z.input.direction,this.et=Math.atan2(this.ht.y,this.ht.x)):this.frame=h.M.frames[0],this.vs.ls&&this.vs.ls>z.frame-30?(this.vs.ls=void 0,this.ot(h.P),z.lt.qi()):this.vs.attack&&this.vs.attack>z.frame-30?(this.vs.attack=void 0,this.ot(Math.random()<.4?h.ui:h.li),z.lt.Yi()):z.input.pressed[8]&&this.Wt>=9e3?(this.ot(h.yi),z.lt.z(57066,{length:1.8})):this.vs.ps&&this.vs.ps>z.frame-30&&(this.vs.ps=void 0,this.ot(h.N),z.lt.Ji());else if(9===this.frame.behavior)return void(this.next={x:this.x+this.pt.x*(this.frame.pi||0),y:this.y+this.pt.y*(this.frame.pi||0)});11===this.frame.behavior&&this.cs(0),12===this.frame.behavior&&j(this,w(Math.random()*m[360]),10,5,40),13===this.frame.behavior&&(z.ms=!0,z.bt=[],z.bt.push(new W(this,this,Q.ys,s.j,38)),z.ct.push(new q(35,18,18)),z.wt.ws=z.frame);let t=void 0===this.frame.pi?z.input.direction.pi*i:this.frame.pi;this.Ot>=8?t*=1.4:this.Ot>=4&&(t*=1.2),this.next={x:this.x+this.ht.x*t,y:this.y+this.ht.y*t}}kt(i){i.Et=!1,i.save(),i.translate(this.x,this.y),i.rotate(this.et+m[90]),6!==this.frame.behavior||this.frame.oi!==s.H&&this.frame.oi!==s.I&&this.frame.oi!==s.L?(i.globalAlpha=8===this.frame.behavior?.9:1,s.i(i,this.frame.oi,0,0),i.globalAlpha=1):(i.save(),i.rotate(Math.random()*m[360]),s.i(i,Math.random()<.5?s.C:s.B,0,0),i.rotate(Math.random()*m[360]),i.globalAlpha=.3,i.scale(1.9,1.9),s.i(i,Math.random()<.5?s.C:s.B,0,0),i.restore()),10===this.frame.behavior&&(i.save(),i.translate(0,-9),i.rotate(z.frame/6%m[360]),i.scale(3,3),s.i(i,s.ti,0,0),i.restore());for(let t of this.os)i.save(),i.scale(t.bs,t.bs),i.globalAlpha=t.a,s.i(i,this.frame.oi.ki,t.x,t.y),i.restore();i.restore(),8===this.frame.behavior&&(i.save(),i.translate(this.ns[2].x,this.ns[2].y),i.rotate(this.et+m[90]),i.globalAlpha=.7,s.i(i,this.frame.oi,0,0),i.restore(),i.save(),i.translate(this.ns[4].x,this.ns[4].y),i.rotate(this.et+m[90]),i.globalAlpha=.5,s.i(i,this.frame.oi,0,0),i.restore(),i.save(),i.translate(this.ns[6].x,this.ns[6].y),i.rotate(this.et+m[90]),i.globalAlpha=.3,s.i(i,this.frame.oi,0,0),i.restore())}At(i){if(10===this.frame.behavior)return this.ot(h.mi),void z.ct.push(new q(16,8,8));if(this.frame.ci)return;z.lt.$i(),z.us.ct.push(new q(16,8,8)),this.cs(0),this.Wt-=750;let t=x(i,this);this.pt=t,this.nt=h.R.frames.slice(),j(this,t,9,5,32)}Ct(){return 8===this.frame.behavior}Tt(){return M(s.p(this.frame.oi,this.x,this.y),this.et+m[90])}l(){return s.l(this.frame.oi,this.x,this.y)}Bt(){if(this.frame.oi.v&&this.frame.bi){let i=this.frame.oi;return this.Ot>=8&&(i=s.D),M(s.m(i,this.x,this.y),this.et+m[90])}}hs(i){this.Wt+=i,z.wt.xs+=i}Yt(){return this.as>480}cs(i){let t=this.Ot;0===i?(this.Ot=0,this.os=[]):(this.Ot+=i,this.Ot>z.wt.fs&&(z.wt.fs=this.Ot)),this.Ot!==t&&t>=2&&(z.us.Xt=-30)}St(){return this.Ot>=8?20:this.Ot>=4?15:10}}class q{constructor(i,t,s){this.frames=i,this.ds=t,this.gs=s;var h=i/2;this.Ms=[],this.ks=[];for(let i=0;i<h;i++)this.Ms.push(2*Math.random()-1),this.ks.push(2*Math.random()-1);this.frame=-1}update(){if(this.frame++,this.frame>=this.frames)return!1;let i=this.frame/2,t=Math.floor(i),s=t+1,h=1-this.frame/this.frames;return this.x=this.ds*h*(this.Ms[t]+(i-t)*(this.Ms[s]-this.Ms[t])),this.y=this.gs*h*(this.ks[t]+(i-t)*(this.ks[s]-this.ks[t])),!0}}class ${static ys(i,t){return i/t}static Es(i,t){return Math.pow(i/t,2)}static As(i,t){return Math.pow(i/t,3)}static ut(i,t){return 1-Math.pow(1-i/t,2)}static Ss(i,t){return 1-Math.pow(1-i/t,3)}static Os(i,t){return 1-Math.pow(1-i/t,4)}}class Q{static zt(i){return(t,s,h,e)=>s+(h-s)*i(t,e)}}function V(i,t,s,h){return`rgba(${i=Math.floor(i)},${t=Math.floor(t)},${s=Math.floor(s)},${h=Math.floor(100*h)/100})`}function Z(i){s.i(z.Ts[0][0].Ti,i.oi,i.x,i.y)}function j(i,t,h,e,r){for(let a=0;a<h;a++){let h=2*Math.random()-1,a={x:i.x+t.y*e*h,y:i.y+t.x*e*h},n=g(t,h*m[90]),o=Math.random()<.3?s.J:s.j,v=12+4*Math.random(),l=(Math.random()+.5)*r;z.bt.push(new F(a,{x:a.x+n.x*l,y:a.y+n.y*l},Q.Os,o,v,Z))}}Q.ys=Q.zt($.ys),Q.Es=Q.zt($.Es),Q.ut=Q.zt($.ut),Q.As=Q.zt($.As),Q.Ss=Q.zt($.Ss),Q.Os=Q.zt($.Os);let z=new class{async init(){this.canvas=document.getElementById("canvas"),this.canvas.width=480,this.canvas.height=270,this.Ti=this.canvas.getContext("2d"),this.wt={yt:0,xs:0,fs:0,ws:0},this.Ts=[[new l(this.canvas.width,this.canvas.height),0,240],[new l(this.canvas.width,this.canvas.height),120,240],[new l(this.canvas.width,this.canvas.height),240,240]],this.ki=new l(this.canvas.width,this.canvas.height),await e.init(),this.Bs=[await e.Bi(this.canvas.width,this.canvas.height),await e.Bi(this.canvas.width,this.canvas.height),await e.Bi(this.canvas.width,this.canvas.height)],this.input=new C,await this.input.init(),this.xt=new Y,this.us=new B,this.bt=[],this.ct=[],this.Ui=[],this.rs=[],this.lt=new r,this.Cs=0,this.dt=new T}start(){this.frame=0,this.Rs=!0,this.update(),this.Rs=!1,this.Ui.push(new L({Vt:()=>{this.Ui.push(new D({}))}})),window.requestAnimationFrame(()=>this.Ps(1))}Ps(i){this.frame++,this.update(),this.resize(),this.kt(this.Ti),window.requestAnimationFrame(()=>this.Ps(i))}update(){if(this.input.update(),this.lt.Di(),this.Ui.length>0){if(!this.Ui[this.Ui.length-1].update()){let i=this.Ui.pop();i.Vt&&i.Vt()}}else this.Rs=!0;if(this.input.pressed[10]&&(this.lt.muted=!this.lt.muted),this.input.pressed[11]&&(this.Ns=!this.Ns),this.Ns)return;if(!this.Rs)return;this.dt.update(),this.Hs(),this.xt.update(),this.rs=this.rs.filter(i=>i.update()),this.Is();let i=this.xt.Bt();if(i){let t=0;this.rs.forEach(s=>{S(i,s.Tt())&&(s.frame.ci||t++,s.At(this.xt))}),this.xt.cs(t)}this.rs.forEach(i=>{let t=i.Bt();t&&S(t,this.xt.Tt())&&this.xt.At(i)});for(let i=0;i<this.bt.length;i++)this.bt[i].update()||this.bt.splice(i--,1);this.ct=this.ct.filter(i=>i.update()),this.us.update();for(let i of this.bt.filter(i=>i instanceof W)){let t=i.es();for(let i=0;i<this.rs.length;i++){let s=k(this.xt,this.rs[i]);s>t-50&&s<t+50&&(this.rs.splice(i,1),i--)}}0===this.bt.length&&0===this.rs.length&&this.ms&&0===this.Ui.length&&this.Ui.push(new U({}))}kt(i){i.fillStyle="rgba(150, 128, 128, 1)",i.fillRect(0,0,this.canvas.width,this.canvas.height),this.ki.Ti.globalCompositeOperation="copy",this.ki.Ti.fillStyle="rgba(0, 0, 0, 0.99)",this.ki.Ti.fillRect(0,0,this.canvas.width,this.canvas.height),this.ki.Ti.globalCompositeOperation="destination-out";let t=this.ki.Ti.createRadialGradient(z.xt.x,z.xt.y,0,z.xt.x,z.xt.y,200);t.addColorStop(0,"rgba(0, 0, 0, 1)"),t.addColorStop(.5,"rgba(0, 0, 0, 0.95)"),t.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ki.Ti.fillStyle=t,this.ki.Ti.beginPath(),this.ki.Ti.arc(z.xt.x,z.xt.y,200,0,2*Math.PI),this.ki.Ti.fill();for(let i of this.bt.filter(i=>i instanceof K)){let t=i.es();this.ki.Ti.globalCompositeOperation="destination-out";let s=this.ki.Ti.createRadialGradient(i.x,i.y,0,i.x,i.y,t);s.addColorStop(0,"rgba(0, 0, 0, 0.7)"),s.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ki.Ti.fillStyle=s,this.ki.Ti.beginPath(),this.ki.Ti.arc(i.x,i.y,t,0,2*Math.PI),this.ki.Ti.fill()}this.ki.Ti.globalCompositeOperation="source-atop";for(let i of this.rs)this.ki.Ti.beginPath(),this.ki.Ti.arc(i.x,i.y,200,0,2*Math.PI);i.save();let h=0,e=0;this.ct.forEach(i=>{h+=i.x,e+=i.y}),i.translate(h,e);for(let t=0;t<16;t++)for(let h=0;h<10;h++){let e=(t*t*13+17*h)%9;s.i(i,s.si[e],32*t-16,32*h-8)}for(let t of this.bt)t._t||z.ms||t.kt(i);this.xt.kt(i);for(let t of this.rs)t.kt(i);for(let t of this.bt)t._t&&t.kt(i);i.drawImage(this.ki.canvas,0,0);let r=Math.floor(this.frame/8)%3;i.globalAlpha=.06,i.drawImage(this.Bs[r].canvas,0,0),i.globalAlpha=1,this.us.kt(i),this.dt.kt(i),i.restore();for(let t of this.Ui)t.kt(i)}resize(){this.canvas.clientWidth,this.canvas.clientHeight}Hs(){this.ms||(this.rs.length<10&&Math.random()<.01&&this.Ls(),this.rs.length<1&&this.Ls())}Ls(){let i=w(Math.random()*m[360]),t=100*Math.random()+100,h=new p(this.xt.x+i.x*t,this.xt.y+i.y*t);this.rs.push(h);let e={x:h.x,y:h.y};this.bt.push(new K(e,e,Q.ys,s.ni,68))}Is(){let i=this.rs.concat([this.xt]);for(let t=0;t<i.length;t++){for(let s=0;s<i.length;s++){if(t===s)continue;if(i[t].Ct())continue;let h=i[t].l(),e=i[s].l();if(Object.assign(h,i[t].next),O(h,e))if(h.x=i[t].x,O(h,e))if(h.x=i[t].next.x,h.y=i[t].y,O(h,e)){if(h.x=i[t].x,h.y=i[t].y,!O(h,e)){i[t].next={x:i[t].x,y:i[t].y};break}}else i[t].next={x:h.x,y:h.y};else i[t].next={x:h.x,y:h.y}}Object.assign(i[t],i[t].next)}}jt(){let i=1e4;i-=this.wt.ws/60,i+=(1+this.wt.fs/10)*this.wt.yt,i+=this.wt.xs/5,i=Math.floor(i);let t=String(i);return t.length>3&&(t=t.substring(0,t.length-3)+","+t.substring(t.length-3)),t}};z.init().then(()=>z.start());
//# sourceMappingURL=app.prod.js.map</script><script>// Generated using https://zzfx.3d2k.com/
if (typeof AudioContext === 'undefined') { AudioContext = webkitAudioContext }
// ZzFX - Zuper Zmall Zound Zynth - Minified Version - MIT License - Copyright 2019 Frank Force
function ZZFXLib(){this.x=new AudioContext;this.r=Date.now();this.buffer=0;this.volume=.5;this.randomness=.1}ZZFXLib.prototype.z=function(b,d){var a=this.Generate(b),c;for(c in d)a[c]=d[c];return this.Z(a.volume,a.randomness,a.frequency,a.length,a.attack,a.slide,a.noise,a.modulation,a.modulationPhase)};
ZZFXLib.prototype.Z=function(b,d,a,c,e,g,h,k,l){c=void 0===c?1:c;e=void 0===e?.1:e;g=void 0===g?0:g;h=void 0===h?0:h;k=void 0===k?0:k;l=void 0===l?0:l;b*=this.volume;a*=2*Math.PI/44100;a*=1+d*(2*this.R()-1);g*=1E3*Math.PI/Math.pow(44100,2);c=0<c?44100*(10<c?10:c)|0:1;e*=c|0;k*=2*Math.PI/44100;l*=Math.PI;d=[];for(var m=0,n=0,f=0;f<c;++f)d[f]=b*Math.cos(m*a*Math.cos(n*k+l))*(f<e?f/e:1-(f-e)/(c-e)),m+=1+h*(2*this.R()-1),n+=1+h*(2*this.R()-1),a+=g;this.buffer=d;b=this.x.createBuffer(1,d.length,44100);
a=this.x.createBufferSource();b.getChannelData(0).set(d);a.buffer=b;a.connect(this.x.destination);a.start();return a};
ZZFXLib.prototype.Generate=function(b){var d=this.r;this.r=b;for(var a=9;a--;)this.R();a={};a.seed=b;a.volume=1;a.randomness=b?this.randomness:0;a.frequency=b?2E3*Math.pow(this.R(),2)|0:220;a.slide=b?parseFloat((10*Math.pow(this.R(),3)).toFixed(1)):0;a.length=b?parseFloat((.1+this.R()).toFixed(1)):1;a.attack=b?parseFloat(this.R().toFixed(2)):.1;a.noise=b?parseFloat((5*Math.pow(this.R(),3)).toFixed(1)):0;a.modulation=b?parseFloat((99*Math.pow(this.R(),5)).toFixed(1)):0;a.modulationPhase=b?parseFloat(this.R().toFixed(2)):
0;this.r=d;return a};ZZFXLib.prototype.Note=function(b,d){return b*Math.pow(2,d/12)};ZZFXLib.prototype.R=function(){this.r^=this.r<<13;this.r^=this.r>>7;this.r^=this.r<<17;return Math.abs(this.r)%1E9/1E9};var ZZFX=new ZZFXLib;</script>