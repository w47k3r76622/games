kontra.init();var scoreboard=document.getElementById("scoreboard");scoreboard.innerHTML=0;let sprites=[],marks=[];var player_image=new Image;player_image.src="img/player.png";var bullet_image=new Image;function createEnemy(t,e,r,s,i){let o=kontra.Sprite({type:"enemy",x:t,y:e,dx:s,dy:i,radius:r,render(){this.context.fillStyle="black",this.context.beginPath(),this.context.arc(this.x,this.y,this.radius,0,2*Math.PI),this.context.fill()}});sprites.push(o)}bullet_image.src="img/bullet.png";var score=-1;function deg2Rad(t){return t*Math.PI/180}kontra.initKeys();let player=kontra.Sprite({type:"player",x:460,y:280,width:4,dt:0,render(){this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(deg2Rad(this.rotation)),this.context.drawImage(player_image,-14,-25),this.context.restore()},update(){kontra.keyPressed("left")?this.rotation+=-4:kontra.keyPressed("right")&&(this.rotation+=4);const t=Math.cos(deg2Rad(this.rotation)),e=Math.sin(deg2Rad(this.rotation));if(this.dt+=1/60,kontra.keyPressed("space")&&this.dt>.25){sht.play(),this.dt=0;let r=kontra.Sprite({type:"bullet",x:this.x+12*t,y:this.y+12*e,dx:this.dx+5*t,dy:this.dy+5*e,ttl:60,width:12,height:12,image:bullet_image});sprites.push(r)}}}),light=kontra.Sprite({type:"light",x:460,y:280,width:6,dt:0,color:"rgba(225,225,225,0.2)",render(){this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(deg2Rad(this.rotation)),this.context.beginPath(),this.context.fillStyle=this.color,this.context.moveTo(0,0),this.context.lineTo(4e3,-5e3),this.context.lineTo(6e3,8e3),this.context.closePath(),this.context.fill(),this.context.restore()},update(){kontra.keyPressed("left")?this.rotation+=-4:kontra.keyPressed("right")&&(this.rotation+=4)}});sprites.push(player);let loop=kontra.GameLoop({update(){kontra.getCanvas();sprites.map(t=>{t.update()}),light.update();for(let t=0;t<sprites.length;t++)if("enemy"===sprites[t].type)for(let e=0;e<sprites.length;e++)if("enemy"!==sprites[e].type){let r=sprites[t],s=sprites[e],i=r.x-s.x,o=r.y-s.y;if(Math.sqrt(i*i+o*o)<r.radius+s.width){r.ttl=0,des.play(),score+=1,scoreboard.innerHTML=score,s.ttl=0,sprites.forEach(t=>{"player"!==t.type||t.isAlive()||over(score)});break}}sprites=sprites.filter(t=>t.isAlive())},render(){if(win(score),light.render(),sprites.map(t=>t.render()),marks.map(t=>t.render()),-1==score){window.setInterval(function(){createEnemy(950,290,40,-4,0)},3e3);let t=kontra.Sprite({x:950,y:270,width:5,height:30,color:"red"});marks.push(t),score+=1}if(10==score){window.setInterval(function(){createEnemy(465,5,30,0,2)},4e3);let t=kontra.Sprite({x:465,y:5,width:30,height:5,color:"red"});marks.push(t),score+=1}if(20==score){window.setInterval(function(){createEnemy(465,595,25,0,-2)},5e3);let t=kontra.Sprite({x:465,y:595,width:30,height:5,color:"red"});marks.push(t),score+=1}if(40==score){window.setInterval(function(){createEnemy(5,290,25,4,0)},6e3);let t=kontra.Sprite({x:5,y:290,width:30,height:5,color:"red"});marks.push(t),score+=1}}});function startt(){loop.start(),document.getElementById("startt").style.display="none"}function win(t){t>=60&&(loop.stop(),scoreboard.style.display="none",document.getElementById("won").style.display="inline-block")}function over(t){loop.stop(),scoreboard.style.display="none",document.getElementById("go-main").style.display="inline-block",document.getElementById("game_over").innerHTML=t-1}marks=marks.filter(t=>t.isAlive());des=document.getElementById("des"),sht=document.getElementById("shoot");