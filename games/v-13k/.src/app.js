const _M=[439,1104],cg=[32,800],br=[80,528],cf=[320,240,192,304,256,16,32],ce=[13,0,,6,6,2,5,,0,2,5,,25,2,,10,3,2,,10,25,2,15,,12,2,3,,25,6,2,,28,6,6,,34,6,,1,29,6,,3,16,9,,5,13,9,,5,34,10,,3,16,12,1,,12,12,3,,2,12,2,,5,12,6,,24,12,1,,28,12,5,,0,12,1,,25,12,2,,29,15,,8,25,15,,10,34,16,,7,29,17,5,,0,18,5,,24,18,4,,8,18,9,,4,29,36,,0,29,3,,29,35,6.3333125,,0,35,27,,23,35,,3,11,38,,10,28,38,,7,36,40,4,,16,40,3,,28,40,4,,11,40,3,,23,41,,4,19,44,4,,14,44,3,,23,48,,10,0,48,7,,32,48,,2,4,48,,3,8,48,32,,11,51,,7,32,53,,3,34,54,6,,0,54,4,,23,54,8,,32,54,1,,2,57,2,,7,57,4,,32,59,,2,11,61,,6,15,61,25,,2,62,9,,29,64,,8,29,64,9,,26,66,,6,21,66,5,,15,66,,6,15,66,4,,11,70,,2],cc=[80,288,3,,64,912,3,,512,640,4,,272,192,7,,272,288,7,,],cb=[80,296,48,,15,,240,304,32,32,1,1,528,688,32,32,7,1,480,304,64,,13,1,48,368,,48,13,1,128,1040,,32,13,1,32,1056,,48,13,1,32,1104,80,,13,1,64,920,48,,15,,384,1024,32,32,1,1,240,992,32,32,1,1,320,800,32,32,1,1,128,1072,,,13,1,32,800,,,4,,512,649,64,,15,,304,224,32,32,7,1,272,200,112,,15,,272,297,112,,15,,336,672,32,32,1,1,512,1088,80,,13,1,544,832,80,,13,1,384,800,,32,13,1,384,832,,,13,1,32,704,64,,13,1,48,656,,48,13,1,64,624,64,,13,1,432,800,32,32,7,1,80,144,48,,13,1,112,96,,48,13,1,128,96,32,,13,1,480,128,32,,13,1,32,144,,,13,1,32,176,,,3,2,560,160,32,32,1,1,560,288,32,32,1,1],ca=[23,11,21,11,19,11,28,5,1,59,7,60,30,38,38,58,35,59,36,67,38,70,20,70,23,70,21,57,21,41,37,5,38,15,38,21,2,22,2,25,6,6,10,9],c_=[544,704,128,448,816,128],c$=[512,299,96,1099,608,827,32,139,496,123,64,619],bZ=[0,37,10,10,1,20,10,7,4,4,8,7,30,66,9,5,16,68,10,4,1,64,10,7,5,50,6,7,24,50,7,3,33,50,7,3,33,56,7,4,24,56,7,4,29,42,11,5,14,21,10,7,16,2,8,7,30,21,9,7];var _o,aG,canvas=document.getElementById("game"),$=canvas.getContext("2d"),keys={},aF={},images={},bq={x:0,y:0},H=[_M[0],_M[1],1,1,1,0,[],1];const _d=canvas.width,_c=canvas.height,cQ=40,dj=72,cP=13,aE=27,cO=16,W=87,A=65,S=83,D=68,F=70,Q=81,ae=200,bY={idledown:[0],idleleft:[1],idleup:[2],walkdown:[3,0,6,0],walkleft:[4,1,7,1],walkup:[5,2,8,2]};window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame;let bX=[],cN=["t","t8x8","c","e","m","z"];cN.map(e=>{bX.push(new Promise((t,a)=>{images[e]=new Image,images[e].src=e+".png",images[e].addEventListener("load",()=>t(1))}))}),Promise.all(bX).then(e=>{images.cM=images.t,images.cL=images.t8x8,images._b=bp(images.c,images.e),images._n=bp(images.c,images.m),images.cK=bp(images.c,images.z),bW(),_A(bV)});var M,C,P,_z=1e3/60,bU=0,_s=0;function bW(e){requestAnimationFrame(bW);let t=e-bU;if(bU=e,!(isNaN(t)||t>1e3)){for(_s+=t;_s>=_z;)cJ(1/60),_s-=_z;cI()}}function cJ(e){aG&&(_o=new aG,aG=0),_o&&_o.update(e)}function cI(){_o&&($.clearRect(0,0,_d,_c),_o.G())}function _A(e){aG=e}class bV{constructor(){this.bn=0}update(){_y(cP)&&_A(aD)}G(){for(let e=0;e<Math.floor(_c/4);e++)for(let t=0;t<Math.floor(_d/4);t++)fr(4*t,4*e,4,4,T()>=.5?"#fff":"#000");this.bn?(fr(0,320,_d,70,"rgba(0, 0, 0, .5)"),_L(()=>{bm("Press Enter",_d/2,355,{font:{size:32,font:"32px Arial Black"},R:"#F23A52"})})):T()>=.95&&(this.bn=1,setTimeout(()=>{this.bn=0},1e3));for(let e=0;e<10;e++)T()>=.9&&fr(0,T()*_c,_d,70*T(),"rgba(0, 0, 0, "+T()+")")}}class aD{constructor(){(M=this)._m=0,M.Z=new Path2D,M.bl=0,M._a=[],M.aC=[],M.V=H[5],M.ac=M.V?14640:-1,M._K=[[0,8,8,1136],[632,8,8,1136],[0,0,640,8],[0,1144,640,8]],M._x=[];for(let e=0;e<ce.length;e+=4){let t=ce.slice(e,e+4),a=16*t[0],n=16*t[1],i=t[2]?16*t[2]:8,s=t[3]?16*t[3]+8:8;M._K.push([a,n,i,s]),M._x.push([a,n+s,i,24])}M.bk=[],M.bj=[];for(let e=0;e<cc.length;e+=4){let t=cc.slice(e,e+4),a=t[2]?16*t[2]:8,n=t[3]?16*t[3]:8;M.bk.push([t[0],t[1],a,n]),M.bj.push([t[0],t[1]+n,a,24])}M.__=[];for(let e=0;e<cb.length;e+=6)M.__.push(new ab(cb.slice(e,e+6)));M._w=new aa(H[0],H[1],0),M.entities=[],M.entities.push(P);for(let e=0;e<ca.length;e+=2)M.entities.push(new aB(ca.slice(e,e+2)));document.cG&&"started"===document.cG.state&&(P.bi=1),M.a_=[],M.dc=[];for(let e=0;e<c_.length;e+=3)M.a_.push(new bh(c_.slice(e,e+3)));M.aA=[];for(let e=0;e<c$.length;e+=2){let t=c$.slice(e,e+2),a=new cF(t,32==t[0]&&139==t[1]);M.__.push(a),M.aA.push(a),H[6].includes(M.aA.indexOf(a))&&(a.bg=1)}for(let e=0;e<bZ.length;e+=4){let t=bZ.slice(e,e+4),a=[[3,2],[5,2],[6,2],[8,0],[10,0],[11,0],[12,0]],n=[];for(let e=t[1];e<t[1]+t[3];e++)for(let i=t[0];i<t[0]+t[2];i++){let t=[16*i,16*e,16,16,0,0];if((i!=M._w.x||e!=M._w.y)&&(!M.a$(t)&&T()<.1)){let e=a[Math.floor(T()*a.length)];n.includes(e[0])||(t[4]=e[0],t[5]=e[1],e[0]<10?n.push(e[0]):t[3]=t[2]=_i(8,16),M.__.push(new ab(t)))}}}M.bf=H[2],M.be=H[3],M.cE=Date.now(),M.bd=0,M.bc=H[4],M._l=new bh(cf.slice(0,3)),M._l.pattern=[120,5,5,5,60,5,5,360,5,5],M.a_.push(M._l),M._v=0,M._J=0,M._Y=H[7],M._n=new _X(1),M._n.play("idleup"),M._I=new bh([448,1136,64]),M._I.K=0,M._h=0,M.p=[],bind(aE,()=>M.pause=!M.pause)}update(e){M._m=Math.round(Math.min(Math.max(P.y-_c/2,0),672)),M._W?M._W.update():M.pause||M._v||([...M.entities,...M.__].map(t=>t.update(e)),M.V||M.a_.map(t=>t.update(e))),M._Y&&M._n.update(e),M.V&&N(P,{x:_M[0],y:_M[1]})<32&&_A(cD)}G(){if(_L(()=>{if(!M.V){if(P._a){if(!M.pause){let e=az({x:P.x,y:P.k()},bq),t=bR(90),a=P.bi?144:128;M.bl=_i(a-6,a),M.Z=new Path2D,M.Z.moveTo(P.x,P.y),M._a.length=0,M._a.push([P.x,P.y]);for(let a=0;a<40;a++){let n=e-t/2+t/40*a,i=M.ax(P.x,P.y,n,M.bQ,M.bl);M.Z.lineTo(i.x,i.y),M._a.push([i.x,i.y])}M.Z.closePath()}bP(P.x,P.y,M.bl,M.Z)}else M._a.length=0;M._I.K&&M._I.G(),M.a_.map(e=>{e.K&&e.G()}),$.globalCompositeOperation="source-atop"}let e=Math.floor(M._m/16);for(let t=e;t<e+31;t++)for(let e=0;e<cQ;e++)fr(16*e,k(16*t),16,16,"#e0e0e0"),fr(16*e,k(16*t),15,15,"#eee");let t=[...M._x,...M.bj];for(let e=0;e<t.length;e++){let a=t[e];bb(a)&&(fr(a[0],k(a[1]),a[2],a[3],"#bdbdbd"),fr(a[0],k(a[1]),a[2],a[3]-3,"#fff"))}M._K.map(e=>{bb(e)&&fr(e[0],k(e[1]),e[2],e[3],"#000")}),M.bk.map(e=>fr(e[0],k(e[1]),e[2],e[3],"#000")),M.__.map(e=>{bb(e.u())&&e.G()});let a=[...M.entities,...M.aA];a.sort(function(e,t){return e.y-t.y}),a.map(e=>{M._v&&e instanceof aB||e.G()})}),bN(M.p),M._Y){M._h++;let e=448,t=k(1136);M._I.K&&M._n.G(e,t),M._h<120||(M._h<150?M._I.K=1:M._h<300?_g("Dad, what are we\ngoing to do?",e,t-24):M._h<600?_g("The quarantine\nprotocol was\nactivated",P.x,P.k()-24):M._h<900?_g("and the front door\nhas been locked.",P.x,P.k()-24):M._h<1350?_g("I'm going to find\na computer that has\naccess to the central\nand open it again",P.x,P.k()-24):M._h<1600?_g("Stay here and\nwait for me",P.x,P.k()-24):M._h<2e3?_g("dad be careful with\nthe infected.",e,t-24):M._h<2300&&(M._Y=0,H[7]=0,M._I.K=0))}M._v&&(M._J++,M._J<120?M._J%10==0&&(M._l.K=!M._l.K):M._J<180?M._l.K=0:M._J<270?(M._l.K=1,bM(4,300,k(258),16,16),_u(2,0,290,k(245)),_u(2,1,280,k(254),1),_u(2,1,273,k(270),1),_u(2,0,340,k(245)),_u(2,1,350,k(254)),_u(2,1,370,k(270))):M._J<320?M._l.K=0:(M._l.reset(),M._v=M.bc=0,setTimeout(()=>P.aw("I'm going crazy, I need\nto open the gate soon.",5e3),1500))),M.V||M._Y||P.G();let e=M.aC.length;for(;e--;){let t=M.aC[e],a=t._.bL(),n=t._.bK(),i=Math.floor((Date.now()-t.time)/100);M.V||bJ(a,n,i),i>=3&&(t._.ba=0,M.aC.splice(e,1))}if(P._t!=ae){let e=8,t=24,a=100,n=12;fr(e,t,a,n,"white"),fr(e+2,t+2,a-4,n-4,"black"),fr(e+2,t+2,(a-4)*P._t/ae,n-4,"blue")}if(M.V&&M.ac>=0){let e=Math.floor(M.ac/60)+1,t=Math.floor(e/60),a="0"+t+":"+("0"+(e-60*t)).slice(-2),n=e>60?"yellow":"red";_L(()=>{$.shadowBlur=20,$.shadowColor="black",$.strokeStyle="black",av(a,50,8,{font:font(18,1),R:n})}),M.pause||M.ac--,0==M.ac&&_A(aD)}if(M.entities.map(e=>{""!=e.au&&_g(e.au,e.bL(),e.bK()-24)}),!M.V){if(M.bf){let e=cg[0],t=cg[1],a={x:e-8,y:t-8,width:16,height:16},n=N({x:e,y:t},P),i=n<144?"Dr. Elliot, please\nhelp me!":"HELP ME!";n<220&&_g(i,e,k(t),"red"),M.at(a)&&(M.bf=0,setTimeout(()=>P.aw("My god, Rachel...\nI would swear that\ni heard something.",5e3),1500))}if(M.be&&Math.abs(P.y-br[1])<32){let e=br[0]+M.bd,t=br[1],a={x:e-8,y:t-8,width:16,height:16},n=N(P,{x:e,y:t});if(n<480){let a=Math.floor((Date.now()-M.cE)/100)%4;cC(e,k(t)),bJ(e,k(t),a)}n<225&&(M.bd+=2),(M.bd>225||M.at(a)||n<32)&&(M.be=0,setTimeout(()=>P.aw("What?\ni'm sure that \ni saw someone.",5e3),1e3))}M.bc&&!M._v&&_r(cf.slice(3,7),P.u())&&(M._v=1,M._l.K=1,P._a=0)}M.pause&&(fr(0,_c/2-18,_d,36,"rgba(255,255,255,.7)"),bm("Game Paused",_d/2,_c/2,{font:font(24,1)})),M._W&&M._W.G()}ax(e,t,a,n,i=0,s=[1,1]){let r=Date.now(),o=0;for(;;){if(0!=i&&o>=i)return{x:e,y:t,b_:0};if(Date.now()-r>=200)break;if(e+=offsetX(a,1),t+=offsetY(a,1),o++,n([e-s[0]/2,t-s[1]/2,s[0],s[1]]))return{x:e,y:t,b_:1}}}bQ(e){for(let t=0;t<M._K.length;t++)if(_r(e,M._K[t]))return 1;return 0}bH(e,t=0){let a=M.a$(e,t);if(a)return a;for(let a=0;a<M.entities.length;a++){let n=M.entities[a];if((!t||n!==t)&&_r(e,n.u()))return n}return 0}a$(e,t=0){let a=[...M._K,...M._x,...M.bj,...M.bk];for(let t=0;t<a.length;t++)if(_r(e,a[t]))return 1;for(let a=0;a<M.__.length;a++){let n=M.__[a];if((!t||n!==t)&&([1,2].includes(n.type)&&_r(e,n.u())))return n}return 0}cz(e){let t=[...M._K,...M._x];for(let a=0;a<t.length;a++)if(_r(e,t[a]))return 1;return 0}at(e){if(M.V)return 1;if(e instanceof aa&&e._a)return 1;let t=e.x,a=e.y,n=[M._a];M.a_.map(e=>{e.K&&n.push(e.bF)});for(let e=0;e<n.length;e++){let i=0;for(let s=0,r=n[e].length-1;s<n[e].length;r=s++){let o=n[e][s][0],l=n[e][s][1],_=n[e][r][0],h=n[e][r][1];l>a!=h>a&&t<(_-o)*(a-l)/(h-l)+o&&(i=!i)}if(i)return 1}return 0}ar(e,t){if(!(e.ba||(N(e,P)<=t&&(M.aC.push({_:e,time:Date.now()}),e.ba=1),e instanceof aB)))for(let a=0;a<M.entities.length;a++){let n=M.entities[a];n instanceof aB&&N(e,n)<=t&&(n.O||n.aq(e))}}}class cD{constructor(){(C=this)._m=0,C._b=new _X(0),C._b.play("walkdown"),C._n=new _X(1),C._n.play("idleup"),C._H=320,C._G=150,C.ap="",C._F=0,C.bB=250,C.ao="",C.step=1,C.J=8,C.aY=0,C.R="black",C.transition=0,C.p=[],C.aX=0,C.aW="",C.aV=["Thanks for playing","Special thanks to Sophya Zamora (Sprites)","In memory of Angel David (Pacheco)","His body is still alive but his soul is not","Created by","Andres Costa"],setInterval(()=>{Math.random()<.5&&C.bA(288,160,50),Math.random()<.5&&C.bA(352,160,50)},3e3)}update(e){switch(C.aY?C.J<32&&C.J++:C.J>8&&C.J--,C._b.update(e),C._n.update(e),C.step){case 1:C._G++,C._G>=200&&(C._b.play("walkleft"),C.step=2);break;case 2:C._H--,C._H<304&&(C._b.play("idleleft"),C.step=0,setTimeout(()=>{C.step=3},1e3));break;case 3:C._b.play("idledown"),C.an("The door is damaged.\nI can't close it.",4);break;case 4:C.am("What! how?\nare you sure dad?",5);break;case 5:C.an("Yes, we need to\nkeep it closed manually.",6);break;case 6:C.an("I will close it\nby quarantine protocol.",7);break;case 7:C.am("No dad, you need to be\non the other side for that",8);break;case 8:C._b.play("walkleft"),C._F=1,C._H++,C._H>=320&&(C._b.play("idledown"),C.step=9);break;case 9:C.an("I know.\nThey're coming, we don't\nhave time, just go!",10);break;case 10:C._b.play("walkup"),setInterval(()=>C._G--,16),C.am("Wait father!\ndon't go.",11);break;case 11:C._G<150&&(C.step=12);break;case 12:C.R=[[43,"red"],[48,"black"]],C.am("Please come back.\nI haven't told you that\nI love you.",13);break;case 13:C.aY=1,setTimeout(()=>C.step=14,1e3);break;case 14:C.J>=32&&(C.transition=100,C.step=0);break;case 15:C.aX++,C.aX>=300&&(0==C.aV.length?(H=[_M[0],_M[1],1,1,1,0,[],1],_A(bV)):(C.aX=0,C.aW=C.aV.shift()))}}G(){if(C.step>=15){let e="rgba(255,255,255,"+C.aX/100+")",t=_d/2,a=_c/2;bm(C.aW,t,a,{font:font(18),R:e})}else{for(let e=0;e<39;e++)for(let t=18;t<22;t++)fr(16*t,16*e,16,16,"#e0e0e0"),fr(16*t,16*e,15,15,"#eee");let e=C.aY?"green":"red",t=288,a=160;fr(t,a,C.J,32,"#9e9e9e"),fr(t+1,a+1,C.J-2,30,"#e0e0e0"),fr(t+1,a+2,C.J-2,4,"#bdbdbd"),fr(t+1,a+26,C.J-2,4,"#bdbdbd"),fr(t+C.J-6,a+14,4,6,"#616161"),fr(t+C.J-5,a+16,2,2,e),t=320;let n=32-C.J;fr(t+n,a,C.J,32,"#9e9e9e"),fr(t+1+n,a+1,C.J-2,30,"#e0e0e0"),fr(t+1+n,a+2,C.J-2,4,"#bdbdbd"),fr(t+1+n,a+26,C.J-2,4,"#bdbdbd"),fr(t+n+2,a+14,4,6,"#616161"),fr(t+n+3,a+16,2,2,e),bN(C.p),C._b.G(C._H,C._G,C._F),C._n.G(320,C.bB),fr(288,0,64,160,"#000"),fr(256,144,32,80,"#000"),fr(352,144,32,80,"#000"),""!=C.ap&&_g(C.ap,C._H,C._G-24),""!=C.ao&&_g(C.ao,320,C.bB-24,C.R),C.transition>0&&(C.transition--,fr(0,0,_d,_c,"rgba(0, 0, 0, "+(1-C.transition/100)+")"),C.transition<=0&&(C.step=15,C.aW=C.aV.shift()))}}an(e,t){C.ap=e,C.step=0,setTimeout(()=>{C.ap="",t&&(C.step=t)},5e3)}am(e,t){C.ao=e,C.step=0,setTimeout(()=>{C.ao="",t&&(C.step=t)},5e3)}bA(e,t,a){for(let n=0;n<a;n++)C.p.push([e,t,2*T()-1,2*T()-.5,_i(30,80),t+32])}}class Entity{constructor(){let e=this;e.x=0,e.y=0,e.speed=1,e.bz={x:0,y:0},e.dir="down",e.aU=0,e.path=[],e.O=0,e.ba=0,e.au=""}_T(e){}_E(e){}behavior(){}update(e){let t=this;if(t.behavior(),t.path.length>0){if(!t.aT()){let e=t.path.shift();void 0!==e&&(t.moveTo=[16*e[0]+8,16*e[1]+8])}}else t.O&&(M.at(t.O)?t.bx(t.O)?t.moveTo=[t.O.x,t.O.y]:t.aq(t.O):(t.aq(t.O),t.O=0));if(t.aT()){let e=t.bw(t.moveTo);if(e.target&&(t._T(e.target),e.target._E(t)),e.move){t.x+=e.x,t.y+=e.y;let a=e.x>0?"right":e.x<0?"left":"",n=e.y>0?"down":e.y<0?"up":"";t.dir=Math.abs(e.x)>Math.abs(e.y)?a:n,t.aS("walk")}else t.aS(t.aU?"walk":"idle"),t.moveTo=0;let a={x:t.x,y:t.y};setTimeout(()=>{N(a,t)<4&&(t.moveTo=0)},1e3),t.bv()}else t.aS("idle");t.aU=0,t.animation&&t.animation.update(e)}G(){let e=this;e.animation&&e.animation.G(e.x,e.k(),"right"==e.dir)}aS(e){let t=this;if(t.animation){let a="right"==t.dir?"left":t.dir;t.animation.play(e+a)}}u(e=this.x,t=this.y){return[e-6,t-6,12,12]}cs(e){return _r(this.u(),e.u())}aT(){let e=this;return e.moveTo&&(e.moveTo[0]!=e.x||e.moveTo[1]!=e.y)}bw(e){let t={},a=this,n=az(a,{x:e[0],y:e[1]}),i=offsetX(n,a.speed),s=offsetY(n,a.speed);a.x<e[0]?a.x+i>e[0]&&(i=e[0]-a.x):a.x>e[0]?a.x+i<e[0]&&(i=e[0]-a.x):i=0,a.y<e[1]?a.y+s>e[1]&&(s=e[1]-a.y):a.y>e[1]?a.y+s<e[1]&&(s=e[1]-a.y):s=0;let r=_o.bH(a.u(a.x+i,a.y),a),o=_o.bH(a.u(a.x,a.y+s),a);return t.x=r?0:i,t.y=o?0:s,t.move=0!=t.x||0!=t.y,t.target=r instanceof Entity?r:o instanceof Entity?o:0,t}bv(){[...M.__].map(e=>{e!==this&&e.cs(this)&&(this._T(e),e._E(this))})}k(){return k(this.y)}aP(){return _S(this.x)}aO(){return _S(this.y)}bL(){let e=this;return e instanceof ab?e.x+e.width/2:e.x}bK(){let e=this;return e instanceof ab?e.k()+e.height/2:e.k()}push(e){let t=this,a=[t.x,t.y],n=t.u(),i=e.u(),s=.5*e.speed;i[0]>=n[0]+n[2]?a[0]-=s:i[0]<=n[0]-i[2]&&(a[0]+=s),i[1]>=n[1]+n[3]?a[1]-=s:i[1]<=n[1]-i[3]&&(a[1]+=s);let r=t.bw(a);r.target&&(t._T(r.target),r.target._E(t)),r.move&&(e.aU=1,t.x+=r.x,t.y+=r.y),t.bv()}cr(e,t){let a=this,n=[a.aP(),a.aO()],i=[n],s={};s[n]=0;let r=0,o=[100];for(M.a$(a.u(16*e+8,16*t+8))&&(r=1);i.length>0&&i.length<=100;){let n=i.shift();if(n[0]==e&&n[1]==t||r&&1==o[0])break;let l=[[n[0],n[1]-1],[n[0]-1,n[1]],[n[0],n[1]+1],[n[0]+1,n[1]]];for(let _=0;_<l.length;_++)if(!(M.a$(a.u(16*l[_][0]+8,16*l[_][1]+8))||l[_]in s)){i.push(l[_]),s[l[_]]=n;let a=N({x:e,y:t},{x:l[_][0],y:l[_][1]});r&&a<o[0]&&(o=[a,l[_]])}}if(r){if(!o[1])return[];e=o[1][0],t=o[1][1]}let l=[e,t],_=[];if(void 0!==s[l])for(;l[0]!=n[0]||l[1]!=n[1];)_.push(l),l=s[l];_.reverse();let h=[];for(let e=0;e<_.length;e++){let t={x:a.x,y:a.y};h.length>0&&(t.x=16*h[h.length-1][0]+8,t.y=16*h[h.length-1][1]+8);let n={x:16*_[e][0]+8,y:16*_[e][1]+8},i=a.u();M.ax(t.x,t.y,az(t,n),M.a$,N(t,n),[i[2],i[3]]).b_&&null!=_[e-1]&&h.push(_[e-1])}return _[_.length-1]&&h.push(_[_.length-1]),h}aq(e){this.path=this.cr(e.aP(),e.aO())}bx(e){let t=this,a=az(t,e);return!M.ax(t.x,t.y,a,M.cz,N(t,e)).b_}aw(e,t=2e3){this.au=e,setTimeout(()=>{this.au=""},t)}}class aa extends Entity{constructor(e,t,a){super(),(P=this).bi=0,P.x=e,P.y=t,P._a=0,P.animation=new _X(a),P._O=0,P._t=ae,bind(F,()=>{M._v||(P._a=!P._a)}),bind(Q,()=>{M.V||P._t!=ae||(P._O=1)})}_T(e){2==e.type&&e.push(P)}behavior(){if(!M._Y){let e=[P.x,P.y];e[1]+=_y(S)?4:_y(W)?-4:0,e[0]+=_y(D)?4:_y(A)?-4:0,P._O?(P._t-=1,0==P._t&&(P._O=0)):P._t=Math.min(P._t+1,ae),_y(cO)&&!P._O?(P.speed=P.bi?1.3:1.12,P.animation._z=8,M.ar(P,128)):(P.speed=.6,P.animation._z=4,P._O||M.ar(P,32)),P.moveTo=e}}}class aB extends Entity{constructor(e){super();let t=this;t.x=16*e[0]+8,t.y=16*e[1]+8,t.speed=.85,t.animation=new _X(2),t.aM=0,t.cq=_i(0,30)}_T(e){e instanceof aa&&_A(aD)}_E(e){e instanceof aa&&_A(aD)}behavior(){let e=this;M.ar(e,e.aT()?128:48),e.aM==e.cq&&(e.O?N(e,e.O)>128&&(e.moveTo=0,e.aq(e.O),e.O=0):N(e,M._w)<=160&&M.at(M._w)&&e.bx(M._w)&&(e.O=M._w,e.path.length=0,e.moveTo=0)),e.aM=(e.aM+1)%30}}class ab extends Entity{constructor(e){super();let t=this;t.x=e[0],t.y=e[1],t.width=e[2]?e[2]:16,t.height=e[3]?e[3]:16,t.ai=e[4],t.type=e[5],t.angle=0,2==t.type&&(t.angle=90*_i(0,3))}_E(e){(2==this.type||[8,10].includes(this.ai))&&M.ar(this,208)}G(){let e=this;e.ai>0&&($.setTransform(1,0,0,1,e.x+e.width/2,e.k()+e.height/2),$.rotate(bR(e.angle)),bM(e.ai,-e.width/2,-e.height/2,e.width,e.height),$.setTransform(1,0,0,1,0,0))}u(e=this.x,t=this.y){let a=this;return 1==a.ai?[e,t+a.height/2,a.width,a.height/2]:[e,t,a.width,a.height]}}class cF extends ab{constructor(e,t){super([e[0],e[1],16,16,2,0]);let a=this;a._B=t,a.ah=0,a.text="> localhost:3000/",a.aL=0,a.aK=0,a.bg=0;let n="white",i="green",s="blue";a.R=a._B?[[0,n],[35,"yellow"],[42,n],[87,s],[93,n],[97,i],[99,n],[121,s],[131,n],[135,i],[141,n],[189,"red"],[206,n],[210,i],[220,n]]:[[0,n],[39,"red"],[55,n]]}_E(e){let t=this;if(e instanceof aa&&!M.V&&"up"==e.dir){if(!t.ah){let e="\tsuperuser/cli\n\t.\t.\t.\t\n";t._B?t._N(e+"Welcome.\n> \trestart energy\n\tAre you sure? (Y/N)\n\ty\t\n.\t.\t.\t\n",()=>{t._N("Energy is ON.\n",()=>{M.V=1,bu(Q),t._N("> \topen maingate\t\n\t.\t.\t.\t\nMain Gate was opened.\t\n> \t\tselfdestruction on\t\t\nAre you sure? (Y/N)\n\ty\t\t\n\t.\t.\t.\t\n",()=>{t._N("Self-Destruction was activated, 4:04 minutes left.\n\nPress Esc to exit."),M.ac=14640,t.ah=1})})}):t._N(e+"404 Page not found.\n\nPress Esc to exit.",()=>t.ah=1)}bu(aE),M._W={update:()=>{if(t.ah&&_y(aE)){let e=M.aA.indexOf(t);H[6].includes(e)||(H[0]=16*t.aP()+8,H[1]=16*t.aO()+32+8,H[2]=M.bf,H[3]=M.be,H[4]=M.bc,H[5]=t._B,H[6].push(e)),clearInterval(t.aL),M._W=0,bind(aE,()=>M.pause=!M.pause),t._B&&M._w.aw("I'll go back to Mary.",3e3)}},G:()=>{_L(()=>{$.globalCompositeOperation="source-over",fr(50,50,_d-100,_c-100,"white"),fr(55,55,_d-110,_c-110,"black"),av(t.text,60,60,{font:font(12,1),R:t.R})})}}}}_N(e,t=0){let a=this;a.aL=setInterval(()=>{""!=e?"\t"==e.charAt(0)?(a.aK>=(a.bg?0:10)&&(a.aK=0,e=e.substring(1)),a.aK++):(a.text+=e.charAt(0),e=e.substring(1)):(clearInterval(a.aL),t&&t())},a.bg?1:100)}u(e=this.x,t=this.y){return[e,t+10,this.width,this.height]}}av=((e,t,a,n={})=>{n.font=n.font||font(16,1),n.R=n.R||"black","string"==typeof n.R&&(n.R=[[0,n.R]]);let i,s=0,r=0;for(let o=0;o<e.length;o++){n.R.map(e=>{e[0]==o&&(i=e[1])});let l=e[o];"\n"!=l?(cp(l,t+s,a+r,n.font,i),s+=$.measureText(l).width):(s=0,r+=n.font.size)}}),cp=((e,t,a,n,i)=>{$.textBaseline="top",$.fillStyle=i,$.font=n.font,$.fillText(e,t,a)}),bm=((e,t,a,n={})=>{n.font=n.font||font(16,1);let i=bt(e,n.font);av(e,t-i.width/2,a-i.height/2,n)}),fr=((e,t,a,n,i)=>{$.fillStyle=i,$.fillRect(e,t,a,n)}),bM=((e,t,a,n,i)=>{$.imageSmoothingEnabled=0,13==e?(fr(t,a,n,i,"#607d8b"),n>=i&&(fr(t,a+10,n,1,"#263238"),fr(t,a+11,n,5,"#e0e0e0"))):15==e?(fr(t,a+3,n,10,"#283593"),fr(t+1,a+4,n-2,8,"#81d4fa")):e>8?$.drawImage(images.cL,8*(e-9),0,8,8,t,a,n,i):$.drawImage(images.cM,16*(e-1),0,16,16,t,a,n,i)}),_u=((e,t,a,n,i=0)=>{$.imageSmoothingEnabled=0;let s=0==e?images._b:1==e?images._n:images.cK;i?($.translate(a,n),$.scale(-1,1),$.drawImage(s,16*t,0,16,32,-8,-24,16,32),$.setTransform(1,0,0,1,0,0)):$.drawImage(s,16*t,0,16,32,a-8,n-24,16,32)}),bP=((e,t,a,n)=>{$.translate(0,-M._m);let i=$.createRadialGradient(e,t,0,e,t,a);i.addColorStop(0,"rgba(0, 0, 0, 1)"),i.addColorStop(1,"rgba(0, 0, 0, 0)"),$.fillStyle=i,$.fill(n),$.translate(0,M._m)}),bJ=((e,t,a)=>{$.strokeStyle="gray",$.beginPath(),$.arc(e,t,2*a,0,2*Math.PI),$.closePath(),$.stroke()}),_g=((e,t,a,n="black")=>{let i=font(12,1),s=bt(e,i),r=20+s.width,o=8+s.height;_L(()=>{$.fillStyle="white",$.shadowBlur=20,$.shadowColor="black",$.beginPath(),$.moveTo(t,a),$.quadraticCurveTo(t+10+10,a,t+10+10,a-10),$.lineTo(t+r-10,a-10),$.quadraticCurveTo(t+r,a-10,t+r,a-10-o/2),$.quadraticCurveTo(t+r,a-10-o,t+r-10,a-10-o),$.lineTo(t+10,a-10-o),$.quadraticCurveTo(t,a-10-o,t,a-10-o/2),$.quadraticCurveTo(t,a-10,t+10,a-10),$.lineTo(t+10,a-10),$.quadraticCurveTo(t+10,a,t,a),$.fill()}),av(e,t+10,a-10-4-s.height,{font:i,R:n})}),cC=((e,t)=>{fr(e-1,t-3,2,2,"red"),fr(e-1,t+1,2,2,"red")});class _X{constructor(e){let t=this;t.face=e,t._z=4,t.frame=0,t._s=0}play(e){let t=this;t.name!=e&&(t.frame=0,t._s=0),t.name=e}update(e){let t=this;for(t._s+=e;t._s*t._z>=1;)t.frame=(t.frame+1)%bY[t.name].length,t._s-=1/t._z}G(e,t,a=0){_u(this.face,bY[this.name][this.frame],e,t,a)}}class bh{constructor(e){let t=this;t.x=e[0],t.y=e[1],t.size=e[2],t.Z=new Path2D,t.bF=[];for(let e=0;e<360;e++){let a=0+2*Math.PI/360*e,n=M.ax(t.x,t.y,a,M.bQ,t.size);0==e?t.Z.moveTo(n.x,n.y):t.Z.lineTo(n.x,n.y),t.bF.push([n.x,n.y])}t.Z.closePath(),t.K=1,t.pattern=[];for(let e=0;e<_i(1,5);e++)t.pattern.push(_i(20,120)),t.pattern.push(_i(1,120));t.index=0,t.time=0,t.p=[]}update(){let e=this;if(e.pattern.length>0&&(e.time++,e.time>=e.pattern[e.index]&&(e.index=(e.index+1)%e.pattern.length,e.K=!e.K,e.time=0,T()<.5)))for(let t=0;t<6;t++){let a=t<3?13:-11,n=t<3?1:13;M.p.push([e.x+a,e.y+n,2*T()-1,2*T()-.5,_i(30,80),e.y+n+5])}}G(){let e=this;bP(e.x,e.y,_i(.95*e.size,e.size),e.Z)}reset(){this.K=1,this.index=0,this.time=0}}co=(e=>{let t=e.which||e.keyCode;aF[t]&&!keys[t]&&aF[t](),keys[t]=1}),cn=(e=>{keys[e.which||e.keyCode]=0}),cm=(()=>{keys={}}),_y=(e=>keys[e]),bind=((e,t)=>{aF[e]=t}),bu=(e=>{aF[e]=0}),canvas.onmousemove=(e=>{let t=canvas.height/canvas.offsetHeight,a=canvas.getBoundingClientRect();bq.x=(e.clientX-a.left)*t,bq.y=(e.clientY-a.top)*t}),window.addEventListener("keydown",co,0),window.addEventListener("keyup",cn,0),window.addEventListener("blur",cm,0),_L=(e=>{$.save(),e(),$.restore()}),font=((e,t=0)=>({size:e,font:(t?"bold":"")+" "+e+"px Fixedsys, Lucida Console"})),T=(()=>Math.random()),bt=((e,t)=>{let a={width:0,height:0},n=$.font;return _L(()=>{$.font=t.font,a.height=e.split("\n").length*t.size,e.split("\n").map(e=>{$.measureText(e).width>a.width&&(a.width=$.measureText(e).width)})}),$.font=n,a}),k=(e=>e-(_o?_o._m:0)),offsetX=((e,t)=>Math.sin(e)*t),offsetY=((e,t)=>-Math.cos(e)*t),N=((e,t)=>Math.hypot(e.x-t.x,e.y-t.y)),_S=(e=>Math.floor(e/16)),az=((e,t)=>Math.atan2(t.y-e.y,t.x-e.x)+Math.PI/2),bR=(e=>e*Math.PI/180),cR=(e=>180*e/Math.PI),_i=((e,t)=>Math.round(T()*(t-e)+e)),_r=((e,t)=>e[0]<t[0]+t[2]&&e[0]+e[2]>t[0]&&e[1]<t[1]+t[3]&&e[3]+e[1]>t[1]),bp=((e,t)=>{let a=document.createElement("canvas"),n=a.getContext("2d");return n.drawImage(e,0,0,144,32),n.drawImage(t,0,0,48,t.height),n.drawImage(t,48,1,48,t.height),n.drawImage(t,96,1,48,t.height),a}),bb=(e=>_r([e[0],k(e[1]),e[2],e[3]],[0,0,_d,_c])),bN=(e=>{let t=e.length;for(;t--;){let a=e[t];a[1]+2<a[5]&&(a[0]+=a[2],a[1]+=a[3],a[3]+=.1),a[4]++,fr(a[0],k(a[1]),2,2,"#ffeb3b"),a[4]>=80&&e.splice(t,1)}});