(()=>{var o;function S(s){s==null&&(s=Math.random()),0<s&&s<1&&(s=~~(s*2147483648));let d=F=>(s=s*16807%2147483647)%F;return o=F=>F==-1?s:F==null?d(2147483648)/2147483648:d(F),o}function v(s,d=o){if(!s)return null;let F=d(s.length);return s[F]}function M(s,d){s=[...s];let F=s.length;for(let c=1;c<F;c++){let A=d(F);A!=c&&([s[c],s[A]]=[s[A],s[c]])}return s}var tD=/([\uD800-\uDBFF][\uDC00-\uDFFF](?:[\u200D\uFE0F][\uD800-\uDBFF][\uDC00-\uDFFF]){2,}|\uD83D\uDC69(?:\u200D(?:(?:\uD83D\uDC69\u200D)?\uD83D\uDC67|(?:\uD83D\uDC69\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]\uFE0F|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC6F\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3C-\uDD3E\uDDD6-\uDDDF])\u200D[\u2640\u2642]\uFE0F|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F\u200D[\u2640\u2642]|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\uD83D\uDC69\u200D[\u2695\u2696\u2708]|\uD83D\uDC68(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708]))\uFE0F|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83D\uDC69\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]))|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\u200D(?:(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F)/;var eD=`1301
*
So, Detective, what will be my first task as your Assistant?
Hmm hmm hmm yes! See this board? It's so called Evidence Board, also known as the MURDER MAP!
Eeek!
Do not fret. It's mostly harmless. It just helps me to visualise evidence I have and connections between the pieces of it.
Looks messy.
Indeed! And this is where you come into picture. You will help me to untangle it. Move pieces around, so strings stop crossing over cards.
Hmm, I guess I can do that. Anything else?
Also, in the end, all cards should be on the board. But you can temporarily move them to the sides. That's it.
OK, I think I can do it.
Note to the player - drag and drop cards to slots on the map (or any point outside of the map).
With the Space key you can skip all these talks at once, or restart the whole dialog anew.
=160
You was a great help last time.
I have just moved some paper around.
And did it splendidly! Now I have another task for you.
Let me guess...
Yes! Another tangled board to untangle.
Will it teach me how to solve cases?
It will teach you how to untangle strings!
Sigh... OK.
=26560
Aaaand... another board!
At least this time I actually have helped to add some pieces to it.
Yes! Pieces that have added a lot of new strings to untangle!
Yay, I guess.
=265801
*
So. Many. Strings.
Yes. It's all connected. 
Will it make solving it harder or easier?
We'll see. Will it make placing it easier?
We'll see. I'm not sure it's even possible.
=37070645
Are you sure it's them?
Yes. A little African country in the centre of EVERYTHING.
It will be hard to prove it.
Fitting this all on board will be hard too. Maybe we need a bigger board?
Do not slack. This one is enough.
=100
So, this is it. Sorry, no big final.
You can use numbers 1-5 to jump to level. 
Or press 6 to get here and then input numbers up there \u2196 to enter any number to generate a custom level.
Digits 2-3 set density of cards (in percents)
If the first digit is 2, it uses different generation, that (hopefully) guarantees solvability. 
Also in that case digits 4-5 define density of links.
First digit 3 is like 2, but then digits 6-7 are coords of the "hub" cell that will have a lot of connections, if it is a landmark.
That's it! Thanks for playing. 
Please leave feedback. Maybe ideas for beter plots or gameplay variations.
`;{let B=function(){return Object.values(p)},O=function(t,D){let u=(D.at.x>t.at.x+10?1:0)+(D.at.y>t.at.y+10?2:0);return t.point(u)},G=function(t){return t.split(tD).filter(D=>D&&D!=" ")},z=function(t){return t-~~t},oD=function(t){let D=t.split(" "),u=[],l=3;for(let e=0;e<D.length;e+=l)u.push({icon:D[e],x:D[e+1]-8,y:D[e+2]-12});let n="<div id=WorldIcon>\u{1F5FA}</div>";for(let e of u)e.cell=~~(e.x/100*r)+~~((e.y+3)/100*k)*r,w[e.cell]=e,n+=`<div class="lmi" id=${e.icon} style="left:${e.x}%;top:${e.y}%;">${e.icon}</div>`;return document.getElementById("World").innerHTML=n,u},J=function(t=0){return t?[...new Array(t)].map(D=>v(aD)).join(" "):""},CD=function(){let t=document.createElement("div");t.classList.add("slot"),t.id=nD++,b[t.id]=t,q(t),Board.appendChild(t)},q=function(t){t.ondragover=D=>D.preventDefault(),t.ondrop=D=>{if(D.preventDefault(),N){N=!1;return}let u=D.dataTransfer.getData("text"),l=t.id=="Table"?null:t.id;l!=null&&(N=!0),p[u].move(l,D.clientX,D.clientY),L()}},ED=function(t){return m.map(u=>u.a==t?u.b:u.b==t?u.a:null).filter(u=>u)},hD=function(t){return m.filter(D=>D.a==t||D.b==t)},Q=function(t){let D=p[t?.id];for(let u of B())u.slot&&b[u.slot].classList.remove("hl");if(D)for(let u of ED(D))u.slot&&b[u.slot].classList.add("hl");L(hD(D))},L=function(t=[]){for(let u of B())u.recalculate();m.forEach(u=>u.update(O(u.a,u.b),O(u.b,u.a))),Pins.innerHTML=m.map(u=>[u.ap,u.bp]).flat().map(u=>`<div class="pin" style="left:${u.x-3}px;top:${u.y-7}px">\u{1F4CD}</div>`).join(" ");let D=m.map(u=>u.toPath());y=(E<5||f!="100")&&D.every(u=>!u[0])&&B().every(u=>u.slot!=null),StringsPath.setAttribute("d",D.filter(u=>!u[0]).map(u=>u[1]).join(" ")),StringsWrongPath.setAttribute("d",D.filter(u=>u[0]).map(u=>u[1]).join(" ")),HighlightPath.setAttribute("d",D.filter(u=>t.includes(u[2])).map(u=>u[1]).join(" ")),Z(),T()},U=function(t){for(let D of t){if(D.type=="lm")continue;let u=v(t);if(u.type=="lm")continue;let l=u.slot;u.slot=D.slot,D.slot=l}return t},X=function(t){S(t);let D=new lD().generate(t.toString());_(D)},dD=function(t){return[t.style.left,t.style.top]},Z=function(){let t={seed:f,leveln:h,line:C,maxLevel:W,cards:B().map(D=>({id:D.id,type:D.type,slot:D.slot,at:dD(D.div)})),links:m.map(D=>[D.a.id,D.b.id])};localStorage.mumamo=JSON.stringify(t)},_=function(t){for(let D of B())D.div.remove();p={},m=[],g=[],t.line!=null&&(C=t.line),t.maxLevel!=null&&(W=t.maxLevel),t.leveln!=null&&(h=t.leveln),t.seed!=null&&(f=t.seed),E=H[h];for(let D of b)D.innerHTML="";S(f),console.log("R",t.seed,o(10));for(let D of t.cards)new sD(D);for(let D of cD(t.links))new iD(D[0],D[1]);L(),Input.value=f},P=function(t){t>x||(h=t,E=H[t],C=1,f=Number(E[0]),X(f))},T=function(t=!1){t&&C++,E[C]=="*"&&C++,Char.innerHTML=C%2?"\u{1F575}\uFE0F":"\u{1F575}\uFE0F\u200D\u2640\uFE0F",CST.innerHTML=y?"<div class='WD'>Well done!</div>":E[C],Talk.style.display=C>=E.length&&!y?"none":"flex",Z(),Input.style.pointerEvents=h==x?"all":"none",Input.style.border=h==x?"":"none"},cD=function(t){let D={};for(let u of t)D[u[0]+u[1]]=u;return Object.values(D)},$=function(t){return{x:t%r,y:~~(t/r)}},mD=function(t,D){return c($(t),$(D))},s=(t,D)=>({x:t,y:D}),d=(t,D)=>({x:t.x+D.x,y:t.y+D.y}),F=(t,D)=>({x:t.x-D.x,y:t.y-D.y}),c=(t,D)=>A(F(t,D)),A=t=>(t.x**2+t.y**2)**.5,H=eD.split("=").map(t=>t.trim().split(`
`)),f,E,C=1,h=0,W=0,y=!1,x=5,b=[],p={},m=[],g=[],nD=0,r=12,k=6,V=r*k;class iD{constructor(D,u){this.a=p[D],this.b=p[u],m.push(this)}update(D,u){this.ap=D,this.bp=u,this.length=this.a.slot!=null&&this.b.slot!=null?c($(this.a.slot),$(this.b.slot)):0,this.cp=s(D.x/2+u.x/2,D.y/2+u.y/2+Math.min(100,Math.abs(D.x-u.x)*.3))}curve(D){let{ap:u,bp:l,cp:n}=this,e=(1-D)**2,i=D**2;return s(n.x+e*(u.x-n.x)+i*(l.x-n.x),n.y+e*(u.y-n.y)+i*(l.y-n.y))}toPath(){let{ap:D,bp:u,cp:l}=this;return[this.overlapping(),`M${D.x} ${D.y} Q${l.x} ${l.y} ${u.x} ${u.y}`,this]}overlapping(){if(mD(this.a.slot,this.b.slot)<2)return null;let D=this.length*2;for(let u=1;u<D-1;u++){let l=this.curve(u/D);for(let n of B())if(!(n==this.a||n==this.b)&&n.contains(l))return n}return null}}class lD{constructor(){this.shuffled=M(rD,o);this.shuffledEvidence=M(K,o)}nextCard(D,u){let l;return D!=null&&w[D]&&o(3)==0||u=="lm"?(l=w[D].icon,u="lm"):(u=u||v(["ev","po","np","nt","st"]),l=(u=="ev"?this.shuffledEvidence:this.shuffled).pop()),{type:u,id:l}}simpleCards(D,u){let l=[],n=M([...new Array(V)].map((e,i)=>i),o);n=n.slice(0,~~(V*D)),u&&!n.includes(u)&&n.push(u),n=n.sort();for(let e of n){let{type:i,id:a}=this.nextCard(e,e==u&&w[e]&&"lm");a&&l.push({id:a,type:i,slot:e})}return l}neighborLinks(D,u,l){let n=[],e=[];for(let i of D)n[i.slot]=i.id;for(let i=0;i<V-r;i++)if(!!n[i]&&(i+1)%r!=0){for(let a of[1,r,1+r])n[i]&&n[i+a]&&a&&(l==i||l==i+a)&&e.push([n[i],n[i+a]]);o()<u&&n[i+1]&&e.push([n[i],n[i+1]]),o()<u&&n[i+r]&&e.push([n[i],n[i+r]]),o()<u&&n[i+r+1]&&e.push([n[i],n[i+r+1]]),i%r>0&&o()<u&&n[i+r-1]&&e.push([n[i],n[i+r-1]])}return e}randomLinks(D){let u=[];for(let l of D.map(n=>n.id)){let n=v(D).id;l!=n&&!u.find(e=>e[0]==l&&e[1]==n||e[1]==l&&e[0]==n)&&u.push([l,n])}return u}generate(D){S(Number(D)),console.log({seed:D});let u=Number(D.substring(1,3))/100||0,l=Number(D.substring(3,5))/100,n=Number(D[5])-1+(Number(D[6])-1)*r,e,i;switch(D[0]){case"2":e=this.simpleCards(u),i=this.neighborLinks(e,l),e=U(e);break;case"3":e=this.simpleCards(u,n),i=this.neighborLinks(e,l,n),e=U(e);break;default:e=this.simpleCards(u),i=this.randomLinks(e);break}return{cards:e,links:i,seed:D}}}class sD{constructor({id:D,type:u,slot:l,at:n}){this.points=[];let e;if(u=u||"po",this.type=u,this.id=D,e=document.createElement("div"),u=="lm"){let i=FD.find(a=>a.icon==D);e.style.marginLeft=`calc(-2rem + ${z(i.x/100*r)*100}%)`,e.style.marginTop=`calc(-1.5rem + ${z(i.y/100*k)*100}%)`,e.innerHTML="O",e.style.fontSize=`${o(4)+3}rem;`,e.classList.add("lm",u)}else{e.classList.add("card",u),o(4)||e.classList.add("warp");let i=o()*6-3;e.style.transform=`translate(${o()*10-5}px, ${o()*10-5}px) rotate(${i}deg)`,e.style.width=u=="nt"?`${o()*.5+1}em`:"",e.draggable=!0,e.ondragstart=I=>I.dataTransfer.setData("text",D);let a={po:3,np:150,nt:3}[u]||0,j={np:1,st:3}[u]||0,fD={np:o(2)+1}[u],DD=u=="np"&&v(["left","right","center"]),R=u!="ev"&&u!="do",uD=`background:hsla(${o(360)}, 50%, 10%, ${R?100:0}%); 
        float: ${DD}; ${DD=="center"?"width:100%;":""};`;if(u=="ev"){let I=K.indexOf(D);uD+=`transform: rotateZ(${I<4?-45:I<7?45:0}deg);`}let pD=R&&o(8)==0;e.innerHTML=`
        <div class="note" style="columns: ${fD};">
          ${j>0?`<h1>${J(o(j)+j)}</h1>`:""}
          <div class="${u=="nt"&&["invert","green","gray"][o(10)]} photo" style="${uD}">
            ${D}
          </div>
          <span style="transform:rotate(${-i+o()*3-1.5}deg)">${J(o(~~(a/3))+a)}</span>
        </div>
        <div class="overlay">${pD?"\u2718\u2718!?"[o(4)]:(u=="do","")}</div>`,R&&(e.style.background=`hsl(${o(360)}, ${u=="st"?100:20}%, 90%)`)}this.div=e,e.id=D,e.onmouseenter=()=>Q(e),e.onmouseleave=()=>Q(null),e.setAttribute("type",u),p[D]=this,this.addToSlot(l),this.setAt(n),this.recalculate()}recalculate(){let D=this.div.getBoundingClientRect();this.at=s(D.left,D.top),this.r=D;for(let u=0;u<4;u++){let l=10,n;this.type=="lm"?n=s(D.width/2,D.height/2):n=s(u%2==1?D.width-l:l,u<2?l:D.height-(this.type=="nt"?0:l)),this.type=="ev"&&(n[4]=s(D.width/2,20)),this.points[u]=n}}setAt(D){D&&(this.div.style.left=D[0],this.div.style.top=D[1])}move(D,u,l){if(this.type!="lm"){if(D!=null&&g[D]!=null){let n=g[D];if(n.type=="lm")return;n.addToSlot(this.slot),n.div.style.left=this.div.style.left,n.div.style.top=this.div.style.top}this.addToSlot(D),this.div.style.left=`${u-this.div.getBoundingClientRect().width/2}px`,this.div.style.top=`${l-this.div.getBoundingClientRect().height/2}px`}}addToSlot(D){(D==null?Table:b[D]).appendChild(this.div),this.slot!=null&&g[this.slot]==this&&delete g[this.slot],this.slot=D,D!=null&&(g[D]=this)}point(D){return d(this.points[D],this.at)}contains(D){return this.at.x<=D.x&&this.at.y<=D.y&&this.at.x+this.r.width>=D.x&&this.at.y+this.r.height>=D.y}}let Y=t=>{window.requestAnimationFrame(Y)};Y(0),window.onmousemove=t=>{},window.onwheel=t=>{};for(let t=0;t<r*k;t++)CD();let rD=G("\u{1F935}\u{1F470}\u{1F931}\u{1F468}\u200D\u2695\uFE0F\u{1F469}\u200D\u2695\uFE0F\u{1F468}\u200D\u{1F393}\u{1F469}\u200D\u{1F393}\u{1F468}\u200D\u2696\uFE0F\u{1F469}\u200D\u2696\uFE0F\u{1F468}\u200D\u{1F33E}\u{1F469}\u200D\u{1F33E}\u{1F468}\u200D\u{1F373}\u{1F469}\u200D\u{1F373}\u{1F468}\u200D\u{1F527}\u{1F469}\u200D\u{1F527}\u{1F468}\u200D\u{1F3ED}\u{1F469}\u200D\u{1F3ED}\u{1F468}\u200D\u{1F4BC}\u{1F469}\u200D\u{1F4BC}\u{1F468}\u200D\u{1F52C}\u{1F469}\u200D\u{1F52C}\u{1F468}\u200D\u{1F4BB}\u{1F469}\u200D\u{1F4BB}\u{1F468}\u200D\u{1F3A4}\u{1F469}\u200D\u{1F3A4}\u{1F468}\u200D\u{1F3A8}\u{1F469}\u200D\u{1F3A8}\u{1F468}\u200D\u2708\uFE0F\u{1F469}\u200D\u2708\uFE0F\u{1F468}\u200D\u{1F680}\u{1F469}\u200D\u{1F680}\u{1F468}\u200D\u{1F692}\u{1F469}\u200D\u{1F692}\u{1F46E}\u200D\u2642\uFE0F\u{1F46E}\u200D\u2640\uFE0F\u{1F575}\uFE0F\u200D\u2642\uFE0F\u{1F575}\uFE0F\u200D\u2640\uFE0F\u{1F482}\u200D\u2642\uFE0F\u{1F482}\u200D\u2640\uFE0F\u{1F477}\u200D\u2642\uFE0F\u{1F477}\u200D\u2640\uFE0F\u{1F9D9}\u200D\u2640\uFE0F\u{1F9D9}\u200D\u2642\uFE0F\u{1F9DA}\u200D\u2640\uFE0F\u{1F9DA}\u200D\u2642\uFE0F\u{1F9DB}\u200D\u2640\uFE0F\u{1F9DB}\u200D\u2642\uFE0F\u{1F9DC}\u200D\u2640\uFE0F\u{1F9DC}\u200D\u2642\uFE0F\u{1F9DD}\u200D\u2640\uFE0F\u{1F9DD}\u200D\u2642\uFE0F\u{1F9DE}\u200D\u2640\uFE0F\u{1F9DE}\u200D\u2642\uFE0F\u{1F9DF}\u200D\u2640\uFE0F\u{1F9DF}\u200D\u2642\uFE0F"),K=G("\u{1F52A}\u{1F5E1}\uFE0F\u{1F511}\u{1F5DD}\uFE0F\u{1F527}\u270F\uFE0F\u{1F58B}\uFE0F\u{1F380}\u{1F4FF}\u{1F4F1}\u{1F4BE}\u{1F4C0}\u{1F4FC}\u{1F4D3}\u{1F4D2}\u{1F4B5}\u2702\uFE0F\u2699\uFE0F\u{1FA92}\u{1F4F0}\u2709\uFE0F\u{1F5C2}\uFE0F\u{1F9E7}"),w={},FD=oD("\u{1F5FD} 38 52 \u{1F30B} 79 74 \u{1F3EF} 86 54 \u{1F54B} 63 58 \u{1F6D5} 71 65 \u{1F301} 61 40 \u{1F54C} 68 51 \u26EA 43 85 \u{1F54D} 80 52 \u{1F6A2} 96 70 \u{1F309} 27 52 \u26F2 54 66 \u{1F98F} 60 85 \u{1F998} 87 86 \u{1F9CA} 45 23"),aD=Object.keys(window).filter(t=>t.length<10),N=!1;window.onresize=()=>L(),window.onkeydown=t=>{if(t.target==Input){if(h!=x){t.preventDefault();return}setTimeout(()=>{Input.value=Input.value.replace(/[^0-9.]/g,"").replace(/(\..*?)\..*/g,"$1"),Input.value.length>=3&&X(Number(Input.value))},1)}else t.code.substring(0,5)=="Digit"&&P(Number(t.key)-1),t.key==" "&&(C=C==E.length?1:E.length,T())},Talk.onclick=()=>{y&&h<H.length-1?P(h+1):T(!0)},q(Table),localStorage.mumamo?(_(JSON.parse(localStorage.mumamo)),T()):P(0)}})();
//# sourceMappingURL=bundle.js.map
