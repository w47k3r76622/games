var Synth,AudioSynth,AudioSynthInstrument;!function(){var t=window.URL||window.webkitURL,n=window.Blob;if(!t||!n)throw new Error("This browser does not support AudioSynth");var e=!1,a=null,i=function(t,n){return[new Uint8Array([n,n>>8]),new Uint8Array([n,n>>8,n>>16,n>>24])][t]},r=function(t,n,e,a){Object.defineProperty(this,t,{value:n,writable:!!e,enumerable:!!a})},u=function(t,n,e){r.call(this,t,n,e,!0)};AudioSynthInstrument=function(){this.__init__.apply(this,arguments)};var h=r.bind(AudioSynthInstrument.prototype),s=u.bind(AudioSynthInstrument.prototype);h("__init__",function(t,n,a){if(!e)throw new Error("AudioSynthInstrument can only be instantiated from the createInstrument method of the AudioSynth object.");r.call(this,"_parent",t),u.call(this,"name",n),r.call(this,"_soundID",a)}),s("play",function(t,n,e){return this._parent.play(this._soundID,t,n,e)}),s("generate",function(t,n,e){return this._parent.generate(this._soundID,t,n,e)}),AudioSynth=function l(){return a instanceof l?a:(this.__init__(),this)},h=r.bind(AudioSynth.prototype),s=u.bind(AudioSynth.prototype),h("_debug",!1,!0),h("_bitsPerSample",16),h("_channels",1),h("_sampleRate",44100,!0),s("setSampleRate",function(t){return this._sampleRate=Math.max(Math.min(0|t,44100),4e3),this._clearCache(),this._sampleRate}),s("getSampleRate",function(){return this._sampleRate}),h("_volume",32768,!0),s("setVolume",function(t){return t=parseFloat(t),isNaN(t)&&(t=0),t=Math.round(32768*t),this._volume=Math.max(Math.min(0|t,32768),0),this._clearCache(),this._volume}),s("getVolume",function(){return Math.round(this._volume/32768*1e4)/1e4}),h("_notes",{C:261.63,"C#":277.18,D:293.66,"D#":311.13,E:329.63,F:346.23,"F#":369.99,G:392,"G#":415.3,A:440,"A#":466.16,B:493.88}),h("_fileCache",[],!0),h("_temp",{},!0),h("_sounds",[],!0),h("_mod",[function(t,n,e,a){return Math.sin(2*Math.PI*(t/n)*e+a)}]),h("_resizeCache",function(){for(var t=this._fileCache,n=this._sounds.length;t.length<n;){for(var e=[],a=0;8>a;a++){var i={};for(var o in this._notes)i[o]={};e.push(i)}t.push(e)}}),h("_clearCache",function(){this._fileCache=[],this._resizeCache()}),s("generate",function(e,a,o,r){var u=this._sounds[e];if(!u)for(var h=0;h<this._sounds.length;h++)if(this._sounds[h].name==e){u=this._sounds[h],e=h;break}if(!u)throw new Error("Invalid sound or sound ID: "+e);var s=(new Date).valueOf();this._temp={},o|=0,o=Math.min(8,Math.max(1,o));var l=r?parseFloat(r):2;if("undefined"==typeof this._notes[a])throw new Error(a+" is not a valid note.");if("undefined"!=typeof this._fileCache[e][o-1][a][l])return this._debug&&console.log((new Date).valueOf()-s,"ms to retrieve (cached)"),this._fileCache[e][o-1][a][l];for(var f=this._notes[a]*Math.pow(2,o-4),d=this._sampleRate,c=this._volume,_=this._channels,m=this._bitsPerSample,p=u.attack(d,f,c),v=u.dampen(d,f,c),M=u.wave,w={modulate:this._mod,vars:this._temp},y=0,g=new Uint8Array(new ArrayBuffer(Math.ceil(d*l*2))),I=d*p|0,b=d*l|0,h=0;h!==I;h++)y=c*(h/(d*p))*M.call(w,h,d,f,c),g[h<<1]=y,g[(h<<1)+1]=y>>8;for(;h!==b;h++)y=c*Math.pow(1-(h-d*p)/(d*(l-p)),v)*M.call(w,h,d,f,c),g[h<<1]=y,g[(h<<1)+1]=y>>8;var S=["RIFF",i(1,52),"WAVE","fmt ",i(1,16),i(0,1),i(0,_),i(1,d),i(1,d*_*m/8),i(0,_*m/8),i(0,m),"data",i(1,g.length*_*m/8),g],A=new n(S,{type:"audio/wav"}),C=t.createObjectURL(A);return this._fileCache[e][o-1][a][l]=C,this._debug&&console.log((new Date).valueOf()-s,"ms to generate"),C}),s("play",function(t,n,e,a){var i=this.generate(t,n,e,a),o=new Audio(i);return o.play(),!0}),s("debug",function(){this._debug=!0}),s("createInstrument",function(t){var n=0,a=!1;if("string"==typeof t){for(var i=0;i<this._sounds.length;i++)if(this._sounds[i].name==t){a=!0,n=i;break}}else this._sounds[t]&&(n=t,t=this._sounds[n].name,a=!0);if(!a)throw new Error("Invalid sound or sound ID: "+t);e=!0;var o=new AudioSynthInstrument(this,t,n);return e=!1,o}),s("listSounds",function(){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n].name);return t}),h("__init__",function(){this._resizeCache()}),s("loadSoundProfile",function(){for(var t=0,n=arguments.length;n>t;t++){if(o=arguments[t],!(o instanceof Object))throw new Error("Invalid sound profile.");this._sounds.push(o)}return this._resizeCache(),!0}),s("loadModulationFunction",function(){for(var t=0,n=arguments.length;n>t;t++){if(f=arguments[t],"function"!=typeof f)throw new Error("Invalid modulation function.");this._mod.push(f)}return!0}),a=new AudioSynth,Synth=a}(),Synth.loadModulationFunction(function(t,n,e,a){return 1*Math.sin(2*Math.PI*(t/n)*e+a)},function(t,n,e,a){return 1*Math.sin(4*Math.PI*(t/n)*e+a)},function(t,n,e,a){return 1*Math.sin(8*Math.PI*(t/n)*e+a)},function(t,n,e,a){return 1*Math.sin(.5*Math.PI*(t/n)*e+a)},function(t,n,e,a){return 1*Math.sin(.25*Math.PI*(t/n)*e+a)},function(t,n,e,a){return.5*Math.sin(2*Math.PI*(t/n)*e+a)},function(t,n,e,a){return.5*Math.sin(4*Math.PI*(t/n)*e+a)},function(t,n,e,a){return.5*Math.sin(8*Math.PI*(t/n)*e+a)},function(t,n,e,a){return.5*Math.sin(.5*Math.PI*(t/n)*e+a)},function(t,n,e,a){return.5*Math.sin(.25*Math.PI*(t/n)*e+a)}),Synth.loadSoundProfile({name:"piano",attack:function(){return.002},dampen:function(t,n,e){return Math.pow(.5*Math.log(n*e/t),2)},wave:function(t,n,e,a){var i=this.modulate[0];return this.modulate[1](t,n,e,Math.pow(i(t,n,e,0),2)+.75*i(t,n,e,.25)+.1*i(t,n,e,.5))}},{name:"organ",attack:function(){return.3},dampen:function(t,n){return 1+.01*n},wave:function(t,n,e){var a=this.modulate[0];return this.modulate[1](t,n,e,a(t,n,e,0)+.5*a(t,n,e,.25)+.25*a(t,n,e,.5))}},{name:"acoustic",attack:function(){return.002},dampen:function(){return 1},wave:function(t,n,e){var a=this.vars;a.valueTable=a.valueTable?a.valueTable:[],"undefined"==typeof a.playVal&&(a.playVal=0),"undefined"==typeof a.periodCount&&(a.periodCount=0);var i=a.valueTable,o=a.playVal,r=a.periodCount,u=n/e,h=Math.floor(100*(u-Math.floor(u))),s=!1;if(i.length<=Math.ceil(u))return i.push(2*Math.round(Math.random())-1),i[i.length-1];i[o]=.5*(i[o>=i.length-1?0:o+1]+i[o]),o>=Math.floor(u)&&(o<Math.ceil(u)?r%100>=h&&(s=!0,i[o+1]=.5*(i[0]+i[o+1]),a.periodCount++):s=!0);var l=i[o];return s?a.playVal=0:a.playVal++,l}},{name:"edm",attack:function(){return.002},dampen:function(){return 1},wave:function(t,n,e){var a=this.modulate[0],i=this.modulate.slice(1);return i[0](t,n,e,i[9](t,n,e,i[2](t,n,e,Math.pow(a(t,n,e,0),3)+Math.pow(a(t,n,e,.5),5)+Math.pow(a(t,n,e,1),7)))+i[8](t,n,e,a(t,n,e,1.75)))}});
function Convergame(t){this.canvas=t,this.ctx=this.canvas.getContext("2d");this.scene=null,this.controlsMap={},this.loadedImages={},this.then=null,this.sanityCheck=function(){return"object"!=typeof this.scene?(console.log("You must set a scene using the convergame.changeScene method."),!1):!0},this.mainGameLoop=function(){var t=Date.now(),e=t-this.then,i=e/1e3;this.scene.updateFunction(i),this.scene.renderFunction(),this.then=t,this.controlsPressed=[],requestAnimationFrame(this.mainGameLoop.bind(this))},this.startMainGameLoop=function(){this.sanityCheck()&&(this.then=Date.now(),this.mainGameLoop())},this.getCanvasWidth=function(){return t.width},this.getCanvasHeight=function(){return t.height},this.setCanvasTo16By9Ratio=function(){for(t.width=window.innerWidth,t.height=.5625*t.width;t.width>=window.innerWidth||t.height>=window.innerHeight;)t.width-=1,t.height-=1},this.getControlNameFromKeyCode=function(t){var e=null;switch(t){case 37:case 65:e="left";break;case 38:case 87:e="up";break;case 39:case 68:e="right";break;case 40:case 83:e="down";break;case 13:e="enter";break;case 32:e="space"}return e},this.isControlPressed=function(t){return"undefined"==typeof this.controlsMap[t]?!1:this.controlsMap[t]},this.drawImage=function(t,e,i,n,s){if("undefined"!=typeof this.loadedImages[t])this.ctx.drawImage(this.loadedImages[t],e*this.getXScale(),i*this.getYScale(),n*this.getXScale(),s*this.getYScale());else{var a=new Image,h=this;a.onload=function(){h.loadedImages[t]=a},a.src=t}},this.drawCircle=function(t,e,i,n){this.ctx.strokeStyle=n,this.ctx.beginPath(),this.ctx.arc(t*this.getXScale(),e*this.getYScale(),i*this.getXScale(),0,2*Math.PI),this.ctx.stroke()},this.drawFilledCircle=function(t,e,i,n,s){this.ctx.strokeStyle=n,this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.arc(t*this.getXScale(),e*this.getYScale(),i*this.getXScale(),0,2*Math.PI),this.ctx.stroke(),this.ctx.fill()},this.drawRect=function(t,e,i,n,s){this.ctx.strokeStyle=s,this.ctx.strokeRect(t*this.getXScale(),e*this.getYScale(),i*this.getXScale(),n*this.getYScale())},this.drawFilledRect=function(t,e,i,n,s,a){this.ctx.strokeStyle=s,this.ctx.fillStyle=a,this.ctx.fillRect(t*this.getXScale(),e*this.getYScale(),i*this.getXScale(),n*this.getYScale())},this.drawText=function(t,e,i,n,s,a,h,o,c,r,l){o="undefined"!=typeof o?o:!1,this.ctx.font=n*this.getXScale()+"px "+s,this.ctx.textAlign=a,o===!0&&(this.ctx.fillStyle=l,this.ctx.fillText(h,(t+c)*this.getXScale(),(e+r)*this.getYScale())),this.ctx.fillStyle=i,this.ctx.fillText(h,t*this.getXScale(),e*this.getYScale())},this.getTextWidth=function(t){var e=this.ctx.measureText(t);return e.width},this.getTextHeight=function(t){var e=this.ctx.measureText(t);return e.height},this.blankCanvas=function(t){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.getCanvasWidth(),this.getCanvasHeight())},this.init=function(){this.setCanvasTo16By9Ratio(),document.getElementById("body").style.padding="0",document.getElementById("body").style.margin="0",window.addEventListener("resize",function(t){this.setCanvasTo16By9Ratio()}.bind(this)),window.addEventListener("keydown",function(t){var e=this.getControlNameFromKeyCode(t.keyCode);this.controlsMap[e]=!0,[32,37,38,39,40].indexOf(t.keyCode)>-1&&t.preventDefault()}.bind(this)),window.addEventListener("keyup",function(t){var e=this.getControlNameFromKeyCode(t.keyCode);this.controlsMap[e]=!1}.bind(this)),this.canvas.ondragstart=function(t){return t&&t.preventDefault?t.preventDefault():t&&t.stopPropagation&&t.stopPropagation(),!1},this.canvas.onselectstart=function(t){return t&&t.preventDefault?t.preventDefault():t&&t.stopPropagation&&t.stopPropagation(),!1}},this.fullscreen=function(){t.requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():alert("Fullscreen not supported by your browser.")},this.setPixelGame=function(t){t?(this.ctx.webkitImageSmoothingEnabled=!1,this.ctx.mozImageSmoothingEnabled=!1,this.ctx.imageSmoothingEnabled=!1):(this.ctx.webkitImageSmoothingEnabled=!0,this.ctx.mozImageSmoothingEnabled=!0,this.ctx.imageSmoothingEnabled=!0)},this.getXScale=function(){return convergame.getCanvasWidth()/1920},this.getYScale=function(){return convergame.getCanvasHeight()/1080},this.random=function(t,e){return Math.floor(Math.random()*(1+e-t))+t},this.isCollide=function(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y?!0:!1},this.changeScene=function(t){this.controlsMap={},this.scene=t,this.scene.init(this)},this.preShake=function(){ctx.save();var t=8*Math.random(),e=8*Math.random();ctx.translate(t,e)},this.postShake=function(){ctx.restore()}}var canvas=document.getElementById("game");
function AboutScene(){this.convergame=null,this.updateFunction=function(e){(this.convergame.isControlPressed("up")||this.convergame.isControlPressed("down")||this.convergame.isControlPressed("left")||this.convergame.isControlPressed("right")||this.convergame.isControlPressed("enter")||this.convergame.isControlPressed(null))&&this.convergame.changeScene(mainMenu)},this.renderFunction=function(){var e=1920,n=1080,t="sans-serif",r="#ecf0f1";this.convergame.blankCanvas("#e74c3c"),this.convergame.drawText(960,75,r,64,t,"center","About Drawbacks",!0,0,2,"#c0392b"),this.convergame.drawText(100,150,r,32,t,"left","Drawbacks is a mini-game challenge, where all instructions are reversed. Sound confusing? That's the point.",!0,0,2,"#c0392b"),this.convergame.drawText(100,200,r,32,t,"left","It's quite deceiving... ",!0,0,2,"#c0392b"),this.convergame.drawText(100,300,r,32,t,"left","The game requires some quick thinking, a non-conforming attitude and a desire to not do what you're told.",!0,0,2,"#c0392b"),this.convergame.drawText(e/2,n/2,r,64,t,"center","Developers",!0,0,2,"#c0392b"),this.convergame.drawText(e/2,n/2+64,r,32,t,"center","Jordan Hall (@DivineOmega)",!0,0,2,"#c0392b"),this.convergame.drawText(e/2,n/2+128,r,32,t,"center","Ollie Reardon (@ojdon)",!0,0,2,"#c0392b"),this.convergame.drawText(e/2,n/2+n/4,r,48,t,"center","Special Thanks",!0,0,2,"#c0392b"),this.convergame.drawText(e/2,n/2+n/4+64,r,32,t,"center","Kerry (Animal Vectors, design tweaks, more!)",!0,0,2,"#c0392b"),this.convergame.drawText(e/2,n/2+n/4+128,r,32,t,"center","Everyone behind and who took part in js13kgames",!0,0,2,"#c0392b")},this.init=function(e){this.convergame=e}}
function Fail(){this.convergame=null,this.message=null,this.timer=0,this.updateFunction=function(e){this.convergame.isControlPressed("enter")&&this.convergame.changeScene(mainMenu)},this.renderFunction=function(){var e="sans-serif",s="#ecf0f1";this.convergame.blankCanvas("#CC3300"),this.convergame.drawText(960,150,s,128,e,"center","Final score: "+minigameSwitcher.score,!0,0,2,"#c0392b"),this.convergame.drawText(960,500,s,64,e,"center",this.message,!0,0,2,"#c0392b"),this.convergame.drawText(960,650,s,64,e,"center","Don't press enter to return to the Main Menu...",!0,0,2,"#c0392b")},this.init=function(e){this.convergame=e,this.timer=0;var s=this.convergame.random(1,11);switch(s){case 1:this.message="Failed!";break;case 2:this.message="Nope.";break;case 3:this.message="Not what we were after.";break;case 4:this.message="Nuh uh.";break;case 5:this.message="Epic fail.";break;case 6:this.message="Better luck next time.";break;case 7:this.message="Have you considering playing better?";break;case 8:this.message="Try harder.";break;case 9:this.message="Suck less. :/";break;case 10:this.message="A for effort.";break;case 11:this.message="Good, but not the one."}var t=Synth.createInstrument("organ");setTimeout(function(){t.play("G",4,2)},0),setTimeout(function(){t.play("D",4,2)},250),setTimeout(function(){t.play("G",3,2)},1e3),setTimeout(function(){t.play("D",3,2)},1250)}}
var canvas=document.getElementById("game"),mainMenu=new MainMenu,aboutScene=new AboutScene,minigameSwitcher=new MinigameSwitcher,success=new Success,fail=new Fail,timeout=new Timeout,minigameUpOrDown=new MinigameUpOrDown,minigameLeftOrRight=new MinigameLeftOrRight,minigameButton=new MinigameButton,minigameTrafficLights=new MinigameTrafficLights,minigameDoNothing=new MinigameDoNothing,minigameMorality=new MinigameMorality,minigameCol=new MinigameCol,minigameAnimals=new MinigameAnimals,minigameSpelling=new MinigameSpelling,convergame=new Convergame(canvas);convergame.init(),convergame.changeScene(mainMenu),convergame.startMainGameLoop();
function MainMenu(){this.convergame=null,this.currentMenuIndex=0,this.updateFunction=function(e){this.convergame.isControlPressed("down")&&this.currentMenuIndex<1&&this.currentMenuIndex++,this.convergame.isControlPressed("up")&&this.currentMenuIndex>0&&this.currentMenuIndex--,this.convergame.isControlPressed("enter")&&0===this.currentMenuIndex?(minigameSwitcher.resetScore(),minigameSwitcher.resetTimeMultiplier(),minigameSwitcher.resetGamesPlayedCount(),timeout.resetTimeouts(),this.convergame.changeScene(minigameSwitcher)):this.convergame.isControlPressed("enter")&&1===this.currentMenuIndex&&this.convergame.changeScene(aboutScene)},this.renderFunction=function(){this.convergame.blankCanvas("#27ae60");var e="sans-serif",t=96,n="#ecf0f1",r=1920,i=1080,c=500,s=100,a="#ecf0f1",o="#2ecc71";switch(this.convergame.drawText(r/2,i/4,n,t,e,"center","DRAWBACKS",!0,0,2,"#16a085"),this.convergame.drawText(r/2,i/4+100,n,48,e,"center","A Reversed Game for JS13K",!0,0,2,"#16a085"),this.convergame.drawText(r/2,i/4+200,n,32,e,"center","Don't press 'Start' to continue...",!0,0,2,"#16a085"),this.convergame.drawRect(r/2-c/2,i/2,c,s,500,90,a),this.convergame.drawRect(r/2-c/2,i/2+(s+16),c,s,500,90,a),this.currentMenuIndex){case 0:this.convergame.drawFilledRect(r/2-c/2,i/2,c,s,a,o);break;case 1:this.convergame.drawFilledRect(r/2-c/2,i/2+(s+16),c,s,a,o)}this.convergame.drawText(r/2,i/2+60,n,42,e,"center","Start",!1,0,2,"#16a085"),this.convergame.drawText(r/2,i/2+(s+16)+60,n,42,e,"center","About",!1,0,2,"#16a085")},this.init=function(e){this.convergame=e}}
function MinigameAnimals(){this.convergame=null,this.controls="Press left or right to select a choice.",this.instruction=null,this.correctControl=null,this.correctChoice=null,this.ani1=null,this.ani2=null,this.ani2Img=new Image,this.leftChoice=null,this.rightChoice=null,this.timer=0,this.gameTime=3,this.updateFunction=function(e){this.timer+=e,this.convergame.isControlPressed(this.correctControl)?(minigameSwitcher.score++,this.convergame.changeScene(success)):(this.convergame.isControlPressed("up")||this.convergame.isControlPressed("down")||this.convergame.isControlPressed("left")||this.convergame.isControlPressed("right"))&&this.convergame.changeScene(fail),this.timer>=this.gameTime&&this.convergame.changeScene(timeout)},this.renderFunction=function(){var e=1920,i=1080,t="sans-serif",s="#ecf0f1",n="./assets/sprites/animals/";this.convergame.blankCanvas("#3498db"),this.convergame.drawText(e/2,150,s,32,t,"center",(this.gameTime-this.timer).toFixed(2),!0,0,2,"#2980b9"),this.convergame.drawText(e/2,250,s,64,t,"center",this.instruction,!0,0,2,"#2980b9"),this.convergame.drawImage(n+this.leftChoice+".svg",e/4-90,i/2,256,256),this.convergame.drawImage(n+this.rightChoice+".svg",e/2+e/4-90,i/2,256,256)},this.getAni=function(e){switch(e){case 1:this.label="Duck";break;case 2:this.label="Mouse";break;case 3:this.label="Owl";break;case 4:this.label="Pig";break;case 5:this.label="Rabbit"}return this.label},this.init=function(e){this.convergame=e,this.timer=0,this.gameTime=minigameSwitcher.getGameTime(5);var i,t;i=this.convergame.random(1,5),t=this.convergame.random(1,5),i==t&&(5==t?t-=1:t+=1),this.ani1=this.getAni(i),this.ani2=this.getAni(t),random=this.convergame.random(1,2),1===random?(this.leftChoice=this.ani1,this.rightChoice=this.ani2,this.correctControl="left"):2===random&&(this.leftChoice=this.ani2,this.rightChoice=this.ani1,this.correctControl="right"),this.instruction="Select the "+this.ani2+"."}}
function MinigameButton(){this.convergame=null,this.controls="Use the spacebar to press the button!",this.instruction=null,this.correctControl="space",this.col=null,thiscolShadow=null,this.timer=0,this.gameTime=3,this.canPress=!1,this.canPressTimer=null,this.updateFunction=function(e){this.timer+=e,this.timer>this.canPressTimer&&(this.canPress=!0,this.instruction="Don't Press!"),this.timer>=this.gameTime&&this.convergame.changeScene(timeout),this.canPress===!0&&this.convergame.isControlPressed(this.correctControl)?(minigameSwitcher.score++,this.convergame.changeScene(success)):this.canPress===!1&&this.convergame.isControlPressed(this.correctControl)&&this.convergame.changeScene(fail)},this.renderFunction=function(){var e=1920,i=1080,t="sans-serif",s="#ecf0f1",c=256;this.convergame.blankCanvas("#1abc9c"),this.convergame.drawFilledCircle(e/2,i/2+110,c,"#2c3e50","#2c3e50"),this.convergame.drawFilledCircle(e/2,i/2+100,c,this.colShadow,this.colShadow),this.convergame.drawFilledCircle(e/2,i/2+100,c-2,this.colShadow,this.col),this.convergame.drawText(e/2,150,s,32,t,"center",(this.gameTime-this.timer).toFixed(2),!0,0,2,"#16a085"),this.convergame.drawText(e/2,i/2+110,s,64,t,"center",this.instruction,!0,0,-2,"#2c3e50")},this.init=function(e){this.convergame=e,this.timer=0,this.gameTime=minigameSwitcher.getGameTime(3),this.canPressTimer=this.convergame.random(.05*this.gameTime,.65*this.gameTime);var i=this.convergame.random(1,2);switch(i){case 1:this.col="#2ecc71",this.colShadow="#2cc16a";break;case 2:this.col="#e74c3c",this.colShadow="#c0392b"}this.instruction="Press Me!"}}
function MinigameCol(){this.convergame=null,this.controls="Press left or right to select a choice.",this.instruction=null,this.correctControl=null,this.correctChoice=null,this.col1=null,this.col2=null,this.leftChoice=null,this.rightChoice=null,this.timer=0,this.gameTime=5,this.updateFunction=function(e){this.timer+=e,this.convergame.isControlPressed(this.correctControl)?(minigameSwitcher.score++,this.convergame.changeScene(success)):(this.convergame.isControlPressed("up")||this.convergame.isControlPressed("down")||this.convergame.isControlPressed("left")||this.convergame.isControlPressed("right"))&&this.convergame.changeScene(fail),this.timer>=this.gameTime&&this.convergame.changeScene(timeout)},this.renderFunction=function(){var e=1920,t=1080,i="sans-serif",h="#ecf0f1";this.convergame.blankCanvas("#333"),this.convergame.drawFilledRect(0,0,e/2,t,this.leftChoice[0],this.leftChoice[0]),this.convergame.drawFilledRect(e/2,0,e/2,t,this.rightChoice[0],this.rightChoice[0]),this.convergame.drawText(e/4,t/2,h,40,i,"left",this.leftChoice[1],!0,0,2,"#2c3e50"),this.convergame.drawText(e/2+e/4,t/2,h,40,i,"right",this.rightChoice[1],!0,0,2,"#2c3e50"),this.convergame.drawText(e/2,150,h,32,i,"center",(this.gameTime-this.timer).toFixed(2),!0,0,2,"#2c3e50"),this.convergame.drawText(e/2,250,h,64,i,"center",this.instruction,!0,0,2,"#2c3e50")},this.getCol=function(e){switch(e){case 1:this.hex="#2ecc71",this.label="Green";break;case 2:this.hex="#3498db",this.label="Blue";break;case 3:this.hex="#9b59b6",this.label="Purple";break;case 4:this.hex="#f1c40f",this.label="Yellow";break;case 5:this.hex="#e67e22",this.label="Orange";break;case 6:this.hex="#e74c3c",this.label="Red"}var t=[this.hex,this.label];return t},this.init=function(e){this.convergame=e,this.timer=0,this.gameTime=minigameSwitcher.getGameTime(5);var t,i;t=this.convergame.random(1,6),i=this.convergame.random(1,6),t==i&&(6==i?i-=1:i+=1),this.col1=this.getCol(t),this.col2=this.getCol(i),random=this.convergame.random(1,2),1===random?(this.leftChoice=this.col1,this.rightChoice=this.col2,this.correctControl="left"):2===random&&(this.leftChoice=this.col2,this.rightChoice=this.col1,this.correctControl="right"),this.instruction="Select the "+this.col2[1].toLowerCase()+" colour."}}
function MinigameDoNothing(){this.convergame=null,this.controls="",this.instruction=null,this.correctControl=null,this.timer=0,this.gameTime=3,this.updateFunction=function(e){this.timer+=e,(this.convergame.isControlPressed("up")||this.convergame.isControlPressed("down")||this.convergame.isControlPressed("left")||this.convergame.isControlPressed("right")||this.convergame.isControlPressed("space")||this.convergame.isControlPressed("enter")||this.convergame.isControlPressed(null))&&this.convergame.changeScene(fail),this.timer>=this.gameTime&&(minigameSwitcher.score++,this.convergame.changeScene(success))},this.renderFunction=function(){var e=(this.convergame.getCanvasWidth(),this.convergame.getCanvasHeight(),"sans-serif"),i="#ecf0f1";this.convergame.blankCanvas("#1abc9c"),this.convergame.drawFilledRect(100,275,1600,200,"#FFF","rgba(255, 255, 255, 0.1)"),this.convergame.drawText(960,150,i,32,e,"center",(this.gameTime-this.timer).toFixed(2),!0,0,2,"#16a085"),this.convergame.drawText(960,400,i,64,e,"center",this.instruction,!0,0,2,"#16a085")},this.init=function(e){this.convergame=e,this.timer=0,this.gameTime=minigameSwitcher.getGameTime(3);var i=this.convergame.random(1,5);switch(i){case 1:this.instruction="Press something!";break;case 2:this.instruction="Press any key!";break;case 3:this.instruction="Press any key to continue.";break;case 4:this.instruction="To continue, press any key.";break;case 5:this.instruction="Free points - hit any key!"}}}
function MinigameLeftOrRight(){this.convergame=null,this.controls="Press either the left or right arrow key.",this.instruction=null,this.correctControl=null,this.timer=0,this.gameTime=3,this.updateFunction=function(e){this.timer+=e,this.convergame.isControlPressed(this.correctControl)?(minigameSwitcher.score++,this.convergame.changeScene(success)):(this.convergame.isControlPressed("up")||this.convergame.isControlPressed("down")||this.convergame.isControlPressed("left")||this.convergame.isControlPressed("right"))&&this.convergame.changeScene(fail),this.timer>=this.gameTime&&this.convergame.changeScene(timeout)},this.renderFunction=function(){var e="sans-serif",t="#ecf0f1";this.convergame.blankCanvas("#1abc9c"),this.convergame.drawFilledRect(100,275,1600,200,"#FFF","rgba(255, 255, 255, 0.1)"),this.convergame.drawText(960,150,t,32,e,"center",(this.gameTime-this.timer).toFixed(2),!0,0,2,"#16a085"),this.convergame.drawText(960,400,t,64,e,"center",this.instruction,!0,0,2,"#16a085")},this.init=function(e){this.convergame=e,this.timer=0,this.gameTime=minigameSwitcher.getGameTime(3);var t=this.convergame.random(1,4);switch(t){case 1:this.instruction="Press left...",this.correctControl="right";break;case 2:this.instruction="Press right...",this.correctControl="left";break;case 3:this.instruction="Don't press left...",this.correctControl="left";break;case 4:this.instruction="Don't press right...",this.correctControl="right"}}}
function MinigameMorality(){this.convergame=null,this.controls="Press left or right to select a choice.",this.instruction=null,this.correctControl=null,this.correctChoice=null,this.choice1=null,this.choice2=null,this.leftChoice=null,this.rightChoice=null,this.timer=0,this.gameTime=5,this.updateFunction=function(i){this.timer+=i,this.convergame.isControlPressed(this.correctControl)?(minigameSwitcher.score++,this.convergame.changeScene(success)):(this.convergame.isControlPressed("up")||this.convergame.isControlPressed("down")||this.convergame.isControlPressed("left")||this.convergame.isControlPressed("right"))&&this.convergame.changeScene(fail),this.timer>=this.gameTime&&this.convergame.changeScene(timeout)},this.renderFunction=function(){var i="sans-serif",e="#ecf0f1";this.convergame.blankCanvas("#333"),this.convergame.drawFilledRect(0,0,960,1080,"#2ecc71","#2ecc71"),this.convergame.drawFilledRect(960,0,960,1080,"#e74c3c","#e74c3c"),this.convergame.drawText(960,150,e,32,i,"center",(this.gameTime-this.timer).toFixed(2),!0,0,2,"#2c3e50"),this.convergame.drawText(960,250,e,64,i,"center",this.instruction,!0,0,2,"#2c3e50"),this.convergame.drawText(288,550,e,40,i,"left",this.leftChoice,!0,0,2,"#27ae60"),this.convergame.drawText(1632,550,e,40,i,"right",this.rightChoice,!0,0,2,"#c0392b")},this.init=function(i){this.convergame=i,this.timer=0,this.gameTime=minigameSwitcher.getGameTime(5);var e=this.convergame.random(1,14);switch(e){case 1:this.instruction="Should you put a child in a cage with a lion?",this.correctChoice=1,this.choice1="Yup",this.choice2="Nope";break;case 2:this.instruction="Which of these is the best snack?",this.correctChoice=1,this.choice1="Human Flesh",this.choice2="A Big Cake";break;case 3:this.instruction="How should you drive?",this.correctChoice=2,this.choice1="Calmly",this.choice2="Agressively";break;case 4:this.instruction="You're a student, you must...",this.correctChoice=1,this.choice1="Play games",this.choice2="Study hard";break;case 5:this.instruction="You're in love. What time is it?",this.correctChoice=1,this.choice1="Affair time",this.choice2="Romance time";break;case 6:this.instruction="As a doctor, you should...",this.correctChoice=1,this.choice1="Prescribe poison",this.choice2="Cure illness";break;case 7:this.instruction="Someone wronged you. What should you do?",this.correctChoice=1,this.choice1="Fight them",this.choice2="Talk to them";break;case 8:this.instruction="Should you burn down a building?",this.correctChoice=1,this.choice1="Great idea",this.choice2="Probably not";break;case 9:this.instruction="What should you use a fire extinguisher on?",this.correctChoice=1,this.choice1="People",this.choice2="Fires";break;case 10:this.instruction="Police officers should stop...",this.correctChoice=1,this.choice1="Balloon Animals",this.choice2="Crimes";break;case 11:this.instruction="Toys should be given to...",this.correctChoice=1,this.choice1="Maniacs",this.choice2="Children";break;case 12:this.instruction="Who does Santa give presents to?",this.correctChoice=1,this.choice1="The Naughty",this.choice2="The Good";break;case 13:this.instruction="How do you calm a crying child?",this.correctChoice=2,this.choice1="Ice Cream",this.choice2="Eye Cream";break;case 14:this.instruction="Where do children belong?",this.correctChoice=1,this.choice1="In space",this.choice2="In school";break;case 15:this.instruction="What is a great treat for children?",this.correctChoice=2,this.choice1="Ice cream",this.choice2="Poop"}e=this.convergame.random(1,2),1===e?(this.leftChoice=this.choice1,this.rightChoice=this.choice2,1===this.correctChoice?this.correctControl="left":2===this.correctChoice&&(this.correctControl="right")):2===e&&(this.leftChoice=this.choice2,this.rightChoice=this.choice1,1===this.correctChoice?this.correctControl="right":2===this.correctChoice&&(this.correctControl="left"))}}
function MinigameSpelling(){this.convergame=null,this.controls="Press left or right to select a choice.",this.instruction=null,this.correctControl=null,this.correctChoice=null,this.choice1=null,this.choice2=null,this.leftChoice=null,this.rightChoice=null,this.timer=0,this.gameTime=5,this.updateFunction=function(e){this.timer+=e,this.convergame.isControlPressed(this.correctControl)?(minigameSwitcher.score++,this.convergame.changeScene(success)):(this.convergame.isControlPressed("up")||this.convergame.isControlPressed("down")||this.convergame.isControlPressed("left")||this.convergame.isControlPressed("right"))&&this.convergame.changeScene(fail),this.timer>=this.gameTime&&this.convergame.changeScene(timeout)},this.renderFunction=function(){var e="sans-serif",i="#ecf0f1";this.convergame.blankCanvas("#9b59b6"),this.convergame.drawText(960,150,i,32,e,"center",(this.gameTime-this.timer).toFixed(2),!0,0,2,"#8e44ad"),this.convergame.drawText(960,250,i,64,e,"center",this.instruction,!0,0,2,"#8e44ad"),this.convergame.drawText(288,550,i,40,e,"left",this.leftChoice,!0,0,2,"#8e44ad"),this.convergame.drawText(1632,550,i,40,e,"right",this.rightChoice,!0,0,2,"#8e44ad")},this.init=function(e){this.convergame=e,this.timer=0,this.gameTime=minigameSwitcher.getGameTime(5),this.instruction="Select the correct spelling.";var i=this.convergame.random(1,15);switch(i){case 1:this.correctChoice=2,this.choice1="amateur",this.choice2="amerture";break;case 2:this.correctChoice=2,this.choice1="believe",this.choice2="beleive";break;case 3:this.correctChoice=2,this.choice1="calendar",this.choice2="calender";break;case 4:this.correctChoice=2,this.choice1="discipline",this.choice2="disipline";break;case 5:this.correctChoice=2,this.choice1="equipment",this.choice2="equiptment";break;case 6:this.correctChoice=2,this.choice1="foreign",this.choice2="foriegn";break;case 7:this.correctChoice=2,this.choice1="grateful",this.choice2="greatful";break;case 8:this.correctChoice=2,this.choice1="harass",this.choice2="harrass";break;case 9:this.correctChoice=2,this.choice1="independent",this.choice2="independant";break;case 10:this.correctChoice=2,this.choice1="questionnaire",this.choice2="questionaire";break;case 11:this.correctChoice=2,this.choice1="recommend",this.choice2="recomend";break;case 12:this.correctChoice=2,this.choice1="separate",this.choice2="seperate";break;case 13:this.correctChoice=2,this.choice1="twelfth",this.choice2="twelth";break;case 14:this.correctChoice=2,this.choice1="until",this.choice2="untill";break;case 15:this.correctChoice=2,this.choice1="vacuum",this.choice2="vacume"}i=this.convergame.random(1,2),1===i?(this.leftChoice=this.choice1,this.rightChoice=this.choice2,1===this.correctChoice?this.correctControl="left":2===this.correctChoice&&(this.correctControl="right")):2===i&&(this.leftChoice=this.choice2,this.rightChoice=this.choice1,1===this.correctChoice?this.correctControl="right":2===this.correctChoice&&(this.correctControl="left"))}}
function MinigameSwitcher(){this.convergame=null,this.score=0,this.timeMultiplier=1,this.timeMultiplierDecay=.1,this.gamesPlayedCount=0,this.gameTime=4,this.getReadyMessage=null,this.nextMinigame=null,this.startMinigameTimer=0,this.gameBag=[],this.updateFunction=function(e){this.startMinigameTimer+=e,this.startMinigameTimer>=this.gameTime&&(this.startMinigameTimer=0,this.gamesPlayedCount++,this.gamesPlayedCount%5===0&&0!==this.gamesPlayedCount&&(this.timeMultiplier=this.timeMultiplier-this.timeMultiplierDecay),this.convergame.changeScene(this.nextMinigame))},this.renderFunction=function(){var e="sans-serif",i="#ecf0f1";this.convergame.blankCanvas("#f39c12"),this.convergame.drawText(960,150,i,64,e,"center","Score: "+this.score,!0,0,2,"#e67e22"),this.convergame.drawText(960,400,i,48,e,"center",this.getReadyMessage,!0,0,2,"#e67e22"),this.convergame.drawText(960,500,i,64,e,"center",this.nextMinigame.controls,!0,0,2,"#e67e22")},this.init=function(e){this.convergame=e,this.startMinigameTimer=0,this.gameTime=this.getGameTime(4);var i=this.convergame.random(1,11);switch(i){case 1:this.getReadyMessage="Don't get ready...";break;case 2:this.getReadyMessage="Be unprepared...";break;case 3:this.getReadyMessage="Get distracted...";break;case 4:this.getReadyMessage="Fail to pay attention...";break;case 5:this.getReadyMessage="Ready, set, stop.";break;case 6:this.getReadyMessage="Ydaer Teg!";break;case 7:this.getReadyMessage="Just ignore this next minigame.";break;case 8:this.getReadyMessage="Transverse the reverse.";break;case 9:this.getReadyMessage="Incoming confusion (or not).";break;case 10:this.getReadyMessage="Do what we say, backwards.";break;case 11:this.getReadyMessage="Incoming reversed minigame..."}var t=[minigameSpelling,minigameCol,minigameUpOrDown,minigameButton,minigameLeftOrRight,minigameDoNothing,minigameTrafficLights,minigameMorality,minigameAnimals];0===this.gameBag.length&&(this.gameBag=t),i=this.convergame.random(0,this.gameBag.length-1),this.nextMinigame=this.gameBag[i],this.gameBag.splice(i,1);var a=Synth.createInstrument("piano");setTimeout(function(){a.play("C",5,1)},0),setTimeout(function(){a.play("C",5,1)},.33*this.gameTime*1e3),setTimeout(function(){a.play("C",5,1)},.66*this.gameTime*1e3),setTimeout(function(){a.play("E",5,1)},1e3*this.gameTime)},this.resetScore=function(){this.score=0},this.resetTimeMultiplier=function(){this.timeMultiplier=1},this.resetGamesPlayedCount=function(){this.gamesPlayedCount=-1},this.getGameTime=function(e){return e*this.timeMultiplier}}
function MinigameTrafficLights(){this.convergame=null,this.controls="Press spacebar to go on the correct light",this.instruction=null,this.correctControl="space",this.correctCol=null,this.col=null,this.timer=0,this.gameTime=3,this.lights=[],this.trafficLight=null,this.currentCol=null,this.updateFunction=function(t){this.timer+=t,this.timer>=this.gameTime&&this.convergame.changeScene(timeout),this.timer>=0&&this.timer<=.5*this.gameTime?(this.lights[0].updateCol("#e74c3c"),this.lights[1].updateCol("#2c3e50"),this.lights[2].updateCol("#2c3e50"),this.currentCol="red"):this.timer>=.5*this.gameTime&&this.timer<=.75*this.gameTime?(this.lights[0].updateCol("#2c3e50"),this.lights[1].updateCol("#f39c12"),this.lights[2].updateCol("#2c3e50"),this.currentCol="amber"):this.timer>=.75*this.gameTime&&(this.lights[0].updateCol("#2c3e50"),this.lights[1].updateCol("#2c3e50"),this.lights[2].updateCol("#2ecc71"),this.currentCol="green"),this.correctCol===this.currentCol&&this.convergame.isControlPressed("space")?(minigameSwitcher.score++,this.lights=[],this.convergame.changeScene(success)):this.correctCol!=this.currentCol&&this.convergame.isControlPressed("space")&&(this.lights=[],this.convergame.changeScene(fail))},this.renderFunction=function(){for(this.convergame.blankCanvas("#1abc9c"),this.trafficLight.draw(),l=0;l<this.lights.length;l++)this.lights[l].draw();this.convergame.drawText(this.width/2,150,this.white,32,this.font,"center",(this.gameTime-this.timer).toFixed(2),!0,0,2,"#16a085"),this.convergame.drawText(this.width/2,400,this.white,64,this.font,"center",this.instruction,!0,0,2,"#16a085")},this.init=function(t){this.convergame=t,this.timer=0,this.gameTime=minigameSwitcher.getGameTime(3),this.width=1920,this.height=1080,this.font="sans-serif",this.white="#ecf0f1",this.trafficLight=new TrafficLightBackground(this.width/2+this.width/4,this.height/4,this.width/4-100,this.height/2+100,"#34495e");for(var i=this.convergame.random(1,3),e=0;3>e;e++)light=new TrafficLight(this.trafficLight.x+this.trafficLight.width/2,this.trafficLight.y+this.trafficLight.height/4+150*e,64,"#2c3e50"),this.lights.push(light);switch(i){case 1:this.col="#2ecc71",this.correctCol="green";break;case 2:this.col="#f39c12",this.correctCol="amber";break;case 3:this.col="#e74c3c",this.correctCol="red"}this.instruction="Never go on a "+this.correctCol+" light"}}
function MinigameUpOrDown(){this.convergame=null,this.controls="Press either the up or down arrow key.",this.instruction=null,this.correctControl=null,this.timer=0,this.gameTime=3,this.updateFunction=function(e){this.timer+=e,this.convergame.isControlPressed(this.correctControl)?(minigameSwitcher.score++,this.convergame.changeScene(success)):(this.convergame.isControlPressed("up")||this.convergame.isControlPressed("down")||this.convergame.isControlPressed("left")||this.convergame.isControlPressed("right"))&&this.convergame.changeScene(fail),this.timer>=this.gameTime&&this.convergame.changeScene(timeout)},this.renderFunction=function(){var e="sans-serif",t="#ecf0f1";this.convergame.blankCanvas("#1abc9c"),this.convergame.drawFilledRect(100,275,1600,200,"#FFFFFF","rgba(255, 255, 255, 0.1)"),this.convergame.drawText(960,150,t,32,e,"center",(this.gameTime-this.timer).toFixed(2),!0,0,2,"#16a085"),this.convergame.drawText(960,400,t,64,e,"center",this.instruction,!0,0,2,"#16a085")},this.init=function(e){this.convergame=e,this.timer=0,this.gameTime=minigameSwitcher.getGameTime(3);var t=this.convergame.random(1,4);switch(t){case 1:this.instruction="Press up...",this.correctControl="down";break;case 2:this.instruction="Press down...",this.correctControl="up";break;case 3:this.instruction="Don't press up...",this.correctControl="up";break;case 4:this.instruction="Don't press down...",this.correctControl="down"}}}
function Success(){this.convergame=null,this.message=null,this.timer=0,this.updateFunction=function(e){this.timer+=e,this.timer>=minigameSwitcher.getGameTime(3)&&this.convergame.changeScene(minigameSwitcher)},this.renderFunction=function(){var e="sans-serif",s="#ecf0f1";this.convergame.blankCanvas("#32cd32"),this.convergame.drawText(960,150,s,64,e,"center","Score: "+minigameSwitcher.score,!0,0,2,"#27ae60"),this.convergame.drawText(960,400,s,64,e,"center",this.message,!0,0,2,"#27ae60")},this.init=function(e){this.convergame=e,this.timer=0;var s=this.convergame.random(1,9);switch(s){case 1:this.message="Good stuff!";break;case 2:this.message="You got it.";break;case 3:this.message="That's it.";break;case 4:this.message="Well done.";break;case 5:this.message="Yay! Points.";break;case 6:this.message="Congratz.";break;case 7:this.message="The points go to you!";break;case 8:this.message="Player gets points.";break;case 9:this.message="Points up!"}var t=Synth.createInstrument("organ");setTimeout(function(){t.play("D",5,2)},0),setTimeout(function(){t.play("G",5,2)},250)}}
function Timeout(){this.convergame=null,this.message=null,this.timer=0,this.timeouts=4,this.updateFunction=function(e){this.timer+=e,this.timer>=minigameSwitcher.getGameTime(3)&&this.convergame.changeScene(0===this.timeouts?fail:minigameSwitcher)},this.renderFunction=function(){var e="sans-serif",t="#ecf0f1";this.convergame.blankCanvas("#95a5a6");var s="";s=1===this.timeouts?"1 timeout remains!":0===this.timeouts?"You're out of timeouts!":this.timeouts+" timeouts remain!",this.convergame.drawText(960,150,t,64,e,"center","Score: "+minigameSwitcher.score,!0,0,2,"#7f8c8d"),this.convergame.drawText(960,400,t,48,e,"center",this.message,!0,0,2,"#7f8c8d"),this.convergame.drawText(960,550,t,48,e,"center",s,!0,0,2,"#7f8c8d")},this.init=function(e){this.convergame=e,this.timer=0,minigameSwitcher.score>0&&minigameSwitcher.score--;var t=this.convergame.random(1,12);switch(this.timeouts--,t){case 1:this.message="Too slow!";break;case 2:this.message="Faster next time, eh?";break;case 3:this.message="Slooooow.";break;case 4:this.message="You timed out!";break;case 5:this.message="Yawn. Slow.";break;case 6:this.message="You took a bit too long.";break;case 7:this.message="You were a bit slow.";break;case 8:this.message="React faster next time!";break;case 9:this.message="You need to be faster!";break;case 10:this.message="Good try, but too slow.";break;case 11:this.message="Not quite fast enough.";break;case 12:this.message="Think quick(er)."}var s=Synth.createInstrument("organ");setTimeout(function(){s.play("F",4,3)},0)},this.resetTimeouts=function(){this.timeouts=4}}
function TrafficLight(i,t,h,a){this.x=i,this.y=t,this.rad=h,this.col=a,this.updateCol=function(i){this.col=i},this.draw=function(){convergame.drawFilledCircle(parseInt(this.x,10),parseInt(this.y,10),this.rad,this.col,this.col)}}var TrafficLight=TrafficLight||{};convergame=convergame;
function TrafficLightBackground(t,i,h,a,r){this.x=t,this.y=i,this.width=h,this.height=a,this.col=r,this.draw=function(){convergame.drawFilledRect(parseInt(this.x,10),parseInt(this.y,10),parseInt(this.width,10),parseInt(this.height,10),this.col,this.col)}}var TrafficLightBackground=TrafficLightBackground||{};convergame=convergame;