var stage=document.getElementById("main-stage"),timer=document.getElementById("timer"),message=document.getElementById("message"),chances=document.getElementById("clicks"),score=document.getElementById("score"),info_window=document.getElementById("side-bar"),home_window=document.getElementById("home"),replay_window=document.getElementById("instr"),replay_button=document.getElementById("refresh"),svgns="http://www.w3.org/2000/svg",color_pallete=["#d4145a","#fcee21","#9e35cd","#26dd67","#0dd8f1","#f76ebd","#4c3cdd","#eb423d"];stage.setAttribute("height",500),stage.setAttribute("width",500);var draw_circle=function(e,t){for(var n=0;n<t.length;n++){var i=e[n],r=document.createElementNS(svgns,"circle"),l="fill:"+color_pallete[n];r.setAttributeNS(null,"cx",i[0]),r.setAttributeNS(null,"cy",i[1]),r.setAttributeNS(null,"r",30),r.setAttributeNS(null,"class","circles"),r.setAttributeNS(null,"id",n),r.setAttributeNS(null,"style",l),stage.appendChild(r)}},draw_line=function(e,t,n,i){for(var r=0,l=0;l<t.length;l++){var s=t[l],o=e[l],c=o[0],a=o[1];n[l]=new Array,i[l]=0;for(var d=0;d<s.length;d++){var u=document.createElementNS(svgns,"line"),m=e[s[d]][0],y=e[s[d]][1];u.setAttribute("x1",c),u.setAttribute("y1",a),u.setAttribute("x2",m),u.setAttribute("y2",y),u.setAttribute("stroke",color_pallete[l]),u.setAttributeNS(null,"class",s[d]),stage.appendChild(u),n[l].push(r),r++,i[l]++}}},set_timer=function(){timenow--,timer.innerHTML=timenow,0==timenow&&(clearInterval(countdown),message.innerHTML="Time Up! Give another try.",replay_window.style.visibility="visible")},score_set=0,curr_stage=0;update=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){stage.innerHTML="";var t=levels[e],n=positions[e],i=[],r=[],l=[],s=0;timenow=10,timer.innerHTML=timenow,score.innerHTML=score_set,chances.innerHTML=num_clicks[e],draw_line(n,t,r,i),draw_circle(n,t),countdown=setInterval(set_timer,1e3);var o=document.querySelectorAll(".circles"),c=num_clicks[e],a=document.querySelectorAll("line");replay_button.innerHTML="Try Again",replay_window.style.backgroundColor="#546efa";for(var d=0;d<o.length;d++)l[d]=!1;for(var u=function(t){o[t].addEventListener("click",function(n){!l[t]&&s<=num_clicks[e]&&(s++,c--,l[t]=!0),c>=0&&(chances.innerHTML=c);var d=this.getAttribute("id"),u=document.getElementsByClassName(d);i[d]=0;for(var m=0;m<r[d].length;m++){var y=a[r[d][m]];if("black"!=y.getAttribute("stroke")){y.setAttribute("stroke","black"),u[m].setAttribute("stroke","black");var g=y.getAttribute("class");i[g]--}}count=0;for(var w=0;w<o.length;w++)0==i[w]&&(o[w].setAttributeNS(null,"style","fill: #666666; stroke: blue; stroke-width: 1px;"),count++);count==o.length&&timenow>0&&s<=num_clicks[e]?(clearInterval(countdown),score_set+=100,score.innerHTML=score_set,++e>=7?(message.innerHTML="Congratulations! You completed all the levels.",replay_window.style.visibility="visible",replay_window.style.backgroundColor="#c7062b",clearInterval(countdown),replay_button.innerHTML="Play Again",e=0,curr_stage=0,score_set=0):update(e)):s>=num_clicks[e]&&(clearInterval(countdown),message.innerHTML="Out of Moves.Try Again",replay_window.style.visibility="visible"),curr_stage=e})},m=0;m<o.length;m++)u(m)}),replay_button.addEventListener("click",function(){replay_window.style.visibility="hidden",update(curr_stage)}),document.getElementById("start").addEventListener("click",function(){replay_window.style.visibility="hidden",home_window.style.visibility="hidden",info_window.style.display="block",score_set=0,update(0)}),document.getElementById("home-button").addEventListener("click",function(){stage.innerHTML="",home_window.style.visibility="visible",info_window.style.display="none",replay_window.style.visibility="hidden"});