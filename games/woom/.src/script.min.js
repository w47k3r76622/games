function circleObj(t){this.x=0,this.y=0,this.r=20,this.text=t,this.a=0,this.b=0,this.c=0,this.d=0,this.f=.001,this.bg=ctx.getImageData(this.x,this.y,1,1).data,this.color=red,this.rev=!1,this.instr=""}function restart(){circ1.f=circ2.f=.001,lvl=0,newlevel(),restartBtn.style.visibility="hidden"}function shape(t,c,e){this.n=t,this.v=c;var r=Math.random()*Math.PI*2;this.coord=[r,r+Math.random()/Math.PI*2+r+3*Math.PI/4,r+Math.random()*Math.PI*2,r+0],this.dir=[Math.random()-.5,Math.random()-.5,Math.random()-.5,Math.random()-.5],this.color=e,this.move=function(){var t=this,c=[];for(i=0;i<t.n;i++)c.push(t.coord[i]+t.v*t.dir[i]);t.coord=c}}function newlevel(){startBtn.style.visibility="hidden",setTimeout(init,waitlength),lvl+=1,diff+=.5,1==lvl&&(shapes.length=0,circ1.instr="move me using your arrow keys"),2==lvl&&(canvasBG=red,circ1.instr="watch out for the red sections - they'll reverse your controls"),3==lvl&&(shapes.length=0,shapes.push(new shape(n=3,v=.005,color=red)),shapes.push(new shape(n=4,v=.005,color=red)),canvasBG="white",circ1.instr="got it? go!"),10==lvl&&(circ2.instr="move me using WASD",circ1.f+=2e-4),lvl>10&&(circ2.instr=null,circ1.f+=2e-4,circ2.f+=2e-4),lvl>=4&&(shapes.length=0,shapes.push(new shape(n=3,v=lvl/500,color=red)),shapes.push(new shape(n=4,v=lvl/500,color=red)),circ1.instr=null,circ1.f+=2e-4),ctx.clearRect(0,0,cw,ch),ctx.fillStyle=oppRed,ctx.fillRect(0,0,cw,ch),ctx.fillStyle="white",ctx.textAlign="center",ctx.font="100 40px sans-serif",ctx.fillText("level "+lvl,cw/2,ch/2)}function start(){ctx.clearRect(0,0,cw,ch),ctx.fillStyle=red,ctx.fillRect(0,0,cw,ch),ctx.fillStyle="white",ctx.textAlign="center",ctx.font="100 100px sans-serif",ctx.fillText("<WooM>",cw/2,ch/2),startBtn.style.left=cw/2-75+"px",startBtn.style.top=ch/2+75+"px",startBtn.style.visibility="visible"}function endslate(){ctx.clearRect(0,0,cw,ch),ctx.fillStyle="black",ctx.fillRect(0,0,cw,ch),ctx.fillStyle="white",ctx.textAlign="center",ctx.font="100 40px sans-serif",ctx.fillText("game over",cw/2,ch/2-20),ctx.font="100 24px sans-serif",ctx.fillText("you reached level "+lvl,cw/2,ch/2+20),restartBtn.style.left=cw/2-75+"px",restartBtn.style.top=ch/2+75+"px",restartBtn.style.visibility="visible"}function init(){circ1.x=circ1.c=cw/2,circ1.y=circ1.d=ch/2,circ2.x=circ2.c=cw/2,circ2.y=circ2.d=ch/2,s1=2*Math.random()*Math.PI,s2=2*Math.random()*Math.PI,t0=new Date,countdown=lvllength,countdownCont=lvllength,win=!1,game(),setInterval("pull()",1e3)}function game(){0>=countdown?newlevel():circ1.x<0||circ1.y<0||circ1.x>cw||circ1.y>ch||circ2.x<0||circ2.y<0||circ2.x>cw||circ2.y>ch?endslate():(draw(),updateEach(circleArray),requestAnimFrame(game))}function draw(){ctx.clearRect(0,0,cw,ch),ctx.fillStyle=canvasBG,ctx.fillRect(0,0,cw,ch),drawShapes(),checkcol(circleArray),drawCircle(circ1.x,circ1.y,circ1.r,circ1.color,circ1.text,circ1.instr),lvl>=10&&drawCircle(circ2.x,circ2.y,circ2.r,circ2.color,circ2.text,circ2.instr),drawBar()}function drawBar(){ctx.fillStyle="rgba(0,0,0,0.4)",ctx.fillRect(0,ch-20,cw/lvllength*countdownCont,20)}function checkcol(t){for(var c=0;c<t.length;c++){var e=ctx.getImageData(t[c].x,t[c].y,1,1).data;250==e[0]?(t[c].color=oppRed,t[c].rev=!0):(t[c].color=grey,t[c].rev=!1)}}function pull(){circ1.a=cw/2+(Math.random()-.5)*diff*cw,circ1.b=ch/2+(Math.random()-.5)*diff*ch,circ2.a=Math.random()*(cw+1200)-600,circ2.b=Math.random()*(ch+1200)-600}function updateEach(t){for(var c=0;c<shapes.length;c++)shapes[c].move();for(var c=0;c<t.length;c++)t[c].c+=(t[c].a-t[c].c)/10,t[c].d+=(t[c].b-t[c].d)/10,t[c].x+=(t[c].c-t[c].x)*t[c].f,t[c].y+=(t[c].d-t[c].y)*t[c].f,countdown=Math.ceil(lvllength-(Date.now()-t0.getTime())/1e3),countdownCont=lvllength-(Date.now()-t0.getTime())/1e3;downp&&(circ1.y+=mv),upp&&(circ1.y-=mv),leftp&&(circ1.x-=mv),rightp&&(circ1.x+=mv),down2p&&(circ2.y+=mv),up2p&&(circ2.y-=mv),left2p&&(circ2.x-=mv),right2p&&(circ2.x+=mv)}function drawShapes(){for(var t=0;t<shapes.length;t++){ctx.beginPath(),ctx.moveTo(cr*Math.cos(shapes[t].coord[0])+cw/2,cr*Math.sin(shapes[t].coord[0])+ch/2);for(var c=1;c<shapes[t].n;c++)ctx.lineTo(cr*Math.cos(shapes[t].coord[c])+cw/2,cr*Math.sin(shapes[t].coord[c])+ch/2);ctx.fillStyle=shapes[t].color,ctx.fill(),ctx.lineWidth="30",ctx.strokeStyle=shapes[t].color,ctx.stroke()}}function drawCircle(t,c,e,r,i,n){ctx.beginPath(),ctx.arc(t,c,e,0,2*Math.PI),ctx.fillStyle=r,ctx.fill(),ctx.fillStyle="white",ctx.font="20px sans-serif",ctx.fillText(i,t,c+6),n&&(ctx.fillStyle="black",ctx.font="12px sans-serif",ctx.fillText(n,t,c+40))}var requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d");canvas.width=window.innerWidth,canvas.height=window.innerHeight;var cw=canvas.width,ch=canvas.height,cr=Math.hypot(cw,ch)/2,red="rgb(250,102,105)",oppRed="rgb(5,153,150)",grey="rgb(215,215,215)",canvasBG="white",circ1=new circleObj(">"),circ2=new circleObj("w"),s1,s2,t=0,m=1e3,speed=.002,colshape,shapes=new Array,x,y,r=20,col=grey,a=Math.random()*cw,b=Math.random()*ch,c=cw/2,d=ch/2,f=.001,upp=!1,downp=!1,rightp=!1,leftp=!1,up2p=!1,down2p=!1,right2p=!1,left2p=!1,mv=6,diff=1,lvl=0,lvllength=4,countdown=lvllength,win=!1,t0,waitlength=1e3,restartBtn=document.getElementById("restart"),startBtn=document.getElementById("start"),circleArray=[circ1,circ2];document.onkeydown=function(t){switch(t=t||window.event,t.keyCode||t.which){case 40:0==circ1.rev?(downp=!0,upp=!1):(upp=!0,downp=!1),t.preventDefault();break;case 38:0==circ1.rev?(upp=!0,downp=!1):(downp=!0,upp=!1),t.preventDefault();break;case 37:0==circ1.rev?(leftp=!0,rightp=!1):(rightp=!0,leftp=!1),t.preventDefault();break;case 39:0==circ1.rev?(rightp=!0,leftp=!1):(leftp=!0,rightp=!1),t.preventDefault();break;case 83:0==circ2.rev?(down2p=!0,up2p=!1):(up2p=!0,down2p=!1),t.preventDefault();break;case 87:0==circ2.rev?(up2p=!0,down2p=!1):(down2p=!0,up2p=!1),t.preventDefault();break;case 65:0==circ2.rev?(left2p=!0,right2p=!1):(right2p=!0,left2p=!1),t.preventDefault();break;case 68:0==circ2.rev?(right2p=!0,left2p=!1):(left2p=!0,right2p=!1),t.preventDefault()}},document.onkeyup=function(t){downp=upp=rightp=leftp=down2p=up2p=right2p=left2p=!1,t.preventDefault()},start();