this.kontra={init(t){var e=this.canvas=document.getElementById(t)||t||document.querySelector("canvas");this.context=e.getContext("2d")},_noop:new Function,_tick:new Function},function(){class t{constructor(t,e){this._x=t||0,this._y=e||0}add(t,e){this.x+=(t.x||0)*(e||1),this.y+=(t.y||0)*(e||1)}clamp(t,e,i,s){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=s}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t}set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}}kontra.vector=((e,i)=>new t(e,i)),kontra.vector.prototype=t.prototype;class e{init(t,e,i,s){for(e in t=t||{},this.position=kontra.vector(t.x,t.y),this.velocity=kontra.vector(t.dx,t.dy),this.acceleration=kontra.vector(t.ddx,t.ddy),this.width=this.height=0,this.context=kontra.context,t)this[e]=t[e];if(i=t.image)this.image=i,this.width=i.width,this.height=i.height;else if(i=t.animations){for(e in i)this.animations[e]=i[e].clone(),s=s||i[e];this._ca=s,this.width=s.width,this.height=s.height}return this}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}collidesWith(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}update(t){this.advance(t)}render(){this.draw()}playAnimation(t){this._ca=this.animations[t],this._ca.loop||this._ca.reset()}advance(t){this.velocity.add(this.acceleration,t),this.position.add(this.velocity,t),this.ttl--,this._ca&&this._ca.update(t)}draw(){this.image?this.context.drawImage(this.image,this.x,this.y):this._ca?this._ca.render(this):(this.context.fillStyle=this.color,this.context.fillRect(this.x,this.y,this.width,this.height))}}kontra.sprite=(t=>(new e).init(t)),kontra.sprite.prototype=e.prototype}(),kontra.gameLoop=function(t){let e,i,s,r,n=(t=t||{}).fps||60,h=0,a=1e3/n,p=1/n,f=!1===t.clearCanvas?kontra._noop:function(){kontra.context.clearRect(0,0,kontra.canvas.width,kontra.canvas.height)};function o(){if(i=requestAnimationFrame(o),s=performance.now(),r=s-e,e=s,!(r>1e3)){for(kontra._tick(),h+=r;h>=a;)d.update(p),h-=a;f(),d.render()}}let d={update:t.update,render:t.render,isStopped:!0,start(){e=performance.now(),this.isStopped=!1,requestAnimationFrame(o)},stop(){this.isStopped=!0,cancelAnimationFrame(i)}};return d},function(){let t,e=[],i=[],s={},r=[],n={},h={0:"left",1:"middle",2:"right"};function a(e){let i=t.x-Math.max(e.x,Math.min(t.x,e.x+e.width)),s=t.y-Math.max(e.y,Math.min(t.y,e.y+e.height));return i*i+s*s<t.radius*t.radius}function p(){let s,r,n=i.length?i:e;for(let e=n.length-1;e>=0;e--)if(r=(s=n[e]).collidesWithPointer?s.collidesWithPointer(t):a(s))return s}function f(t){n[h[t.button]]=!0,d(t,"onDown")}function o(t){n[h[t.button]]=!1,d(t,"onUp")}function d(e,i){if(!kontra.canvas)return;let r,n,h;-1!==e.type.indexOf("mouse")?(r=e.clientX,n=e.clientY):(r=(e.touches[0]||e.changedTouches[0]).clientX,n=(e.touches[0]||e.changedTouches[0]).clientY),t.x=r-kontra.canvas.offsetLeft,t.y=n-kontra.canvas.offsetTop,e.target===kontra.canvas&&(h=p())&&h[i]&&h[i](),s[i]&&s[i](e,h)}addEventListener("mousedown",f),addEventListener("touchstart",f),addEventListener("mouseup",o),addEventListener("touchend",o),addEventListener("blur",function(t){n={}}),addEventListener("mousemove",function(t){d(t,"onOver")}),t=kontra.pointer={x:0,y:0,radius:5,track(t){[].concat(t).map(function(t){t._r||(t._r=t.render,t.render=function(){e.push(this),this._r()},r.push(t))})},untrack(t,e){[].concat(t).map(function(t){t.render=t._r,t._r=e;let i=r.indexOf(t);-1!==i&&r.splice(i,1)})},over:t=>-1!==r.indexOf(t)&&p()===t,onDown(t){s.onDown=t},onUp(t){s.onUp=t},pressed:t=>!!n[t]},kontra._tick=function(){i.length=0,e.map(function(t){i.push(t)}),e.length=0}}(),function(){let t={},e={},s={13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};for(let t=0;t<26;t++)s[65+t]=(10+t).toString(36);for(i=0;i<10;i++)s[48+i]=""+i;addEventListener("keydown",function(i){let r=s[i.which];e[r]=!0,t[r]&&t[r](i)}),addEventListener("keyup",function(t){e[s[t.which]]=!1}),addEventListener("blur",function(t){e={}}),kontra.keys={bind(e,i){[].concat(e).map(function(e){t[e]=i})},unbind(e,i){[].concat(e).map(function(e){t[e]=i})},pressed:t=>!!e[t]}}();let chrs={A:[[,1],[1,,1],[1,,1],[1,1,1],[1,,1]],B:[[1,1],[1,,1],[1,1,1],[1,,1],[1,1]],C:[[1,1,1],[1],[1],[1],[1,1,1]],D:[[1,1],[1,,1],[1,,1],[1,,1],[1,1]],E:[[1,1,1],[1],[1,1,1],[1],[1,1,1]],F:[[1,1,1],[1],[1,1],[1],[1]],G:[[,1,1],[1],[1,,1,1],[1,,,1],[,1,1]],H:[[1,,1],[1,,1],[1,1,1],[1,,1],[1,,1]],I:[[1,1,1],[,1],[,1],[,1],[1,1,1]],J:[[1,1,1],[,,1],[,,1],[1,,1],[1,1,1]],K:[[1,,,1],[1,,1],[1,1],[1,,1],[1,,,1]],L:[[1],[1],[1],[1],[1,1,1]],M:[[1,1,1,1,1],[1,,1,,1],[1,,1,,1],[1,,,,1],[1,,,,1]],N:[[1,,,1],[1,1,,1],[1,,1,1],[1,,,1],[1,,,1]],O:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],P:[[1,1,1],[1,,1],[1,1,1],[1],[1]],Q:[[0,1,1],[1,,,1],[1,,,1],[1,,1,1],[1,1,1,1]],R:[[1,1],[1,,1],[1,,1],[1,1],[1,,1]],S:[[1,1,1],[1],[1,1,1],[,,1],[1,1,1]],T:[[1,1,1],[,1],[,1],[,1],[,1]],U:[[1,,1],[1,,1],[1,,1],[1,,1],[1,1,1]],V:[[1,,,,1],[1,,,,1],[,1,,1],[,1,,1],[,,1]],W:[[1,,,,1],[1,,,,1],[1,,,,1],[1,,1,,1],[1,1,1,1,1]],X:[[1,,,,1],[,1,,1],[,,1],[,1,,1],[1,,,,1]],Y:[[1,,1],[1,,1],[,1],[,1],[,1]],Z:[[1,1,1,1,1],[,,,1],[,,1],[,1],[1,1,1,1,1]],0:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],1:[[,1],[,1],[,1],[,1],[,1]],2:[[1,1,1],[0,0,1],[1,1,1],[1,0,0],[1,1,1]],3:[[1,1,1],[0,0,1],[1,1,1],[0,0,1],[1,1,1]],4:[[1,0,1],[1,0,1],[1,1,1],[0,0,1],[0,0,1]],5:[[1,1,1],[1,0,0],[1,1,1],[0,0,1],[1,1,1]],6:[[1,1,1],[1,0,0],[1,1,1],[1,0,1],[1,1,1]],7:[[1,1,1],[0,0,1],[0,0,1],[0,0,1],[0,0,1]],8:[[1,1,1],[1,0,1],[1,1,1],[1,0,1],[1,1,1]],9:[[1,1,1],[1,0,1],[1,1,1],[0,0,1],[1,1,1]]," ":[[,,],[,,],[,,],[,,],[,,]],"-":[[,,],[,,],[,1],[,,],[,,]],"/":[[,,1],[,,1],[,1],[1,,],[1,,]],"?":[[1,1,1],[,,1],[1,1,1],[1,,],[1,,]],".":[[,],[,],[,],[,],[1]]};var FastBase64={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encLookup:[],Init:function(){for(var t=0;t<4096;t++)this.encLookup[t]=this.chars[t>>6]+this.chars[63&t]},Encode:function(t){for(var e=t.length,i="",s=0;e>2;)n=t[s]<<16|t[s+1]<<8|t[s+2],i+=this.encLookup[n>>12]+this.encLookup[4095&n],e-=3,s+=3;if(e>0){var r=(252&t[s])>>2,h=(3&t[s])<<4;if(e>1&&(h|=(240&t[++s])>>4),i+=this.chars[r],i+=this.chars[h],2==e){var a=(15&t[s++])<<2;a|=(192&t[s])>>6,i+=this.chars[a]}1==e&&(i+="="),i+="="}return i}};FastBase64.Init();var RIFFWAVE=function(t){function e(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function i(t){return[255&t,t>>8&255]}this.data=[],this.wav=[],this.dataURI="",this.header={chunkId:[82,73,70,70],chunkSize:0,format:[87,65,86,69],subChunk1Id:[102,109,116,32],subChunk1Size:16,audioFormat:1,numChannels:1,sampleRate:8e3,byteRate:0,blockAlign:0,bitsPerSample:8,subChunk2Id:[100,97,116,97],subChunk2Size:0},this.Make=function(t){t instanceof Array&&(this.data=t),this.header.byteRate=this.header.sampleRate*this.header.numChannels*this.header.bitsPerSample>>3,this.header.blockAlign=this.header.numChannels*this.header.bitsPerSample>>3,this.header.subChunk2Size=this.data.length,this.header.chunkSize=36+this.header.subChunk2Size,this.wav=this.header.chunkId.concat(e(this.header.chunkSize),this.header.format,this.header.subChunk1Id,e(this.header.subChunk1Size),i(this.header.audioFormat),i(this.header.numChannels),e(this.header.sampleRate),e(this.header.byteRate),i(this.header.blockAlign),i(this.header.bitsPerSample),this.header.subChunk2Id,e(this.header.subChunk2Size),this.data),this.dataURI="data:audio/wav;base64,"+FastBase64.Encode(this.wav)},t instanceof Array&&this.Make(t)};!function(t,e){"function"==typeof define&&define.amd?define([],function(){return t.RIFFWAVE=e()}):"object"==typeof module&&module.exports?module.exports=t.RIFFWAVE=e():t.RIFFWAVE=e()}(this,function(){return RIFFWAVE});var SQUARE=0,SAWTOOTH=1,SINE=2,NOISE=3,masterVolume=1,OVERSAMPLING=8;function Params(){this.oldParams=!0,this.wave_type=SQUARE,this.p_env_attack=0,this.p_env_sustain=.3,this.p_env_punch=0,this.p_env_decay=.4,this.p_base_freq=.3,this.p_freq_limit=0,this.p_freq_ramp=0,this.p_freq_dramp=0,this.p_vib_strength=0,this.p_vib_speed=0,this.p_arp_mod=0,this.p_arp_speed=0,this.p_duty=0,this.p_duty_ramp=0,this.p_repeat_speed=0,this.p_pha_offset=0,this.p_pha_ramp=0,this.p_lpf_freq=1,this.p_lpf_ramp=0,this.p_lpf_resonance=0,this.p_hpf_freq=0,this.p_hpf_ramp=0,this.sound_vol=.5,this.sample_rate=44100,this.sample_size=8}function sqr(t){return t*t}function cube(t){return t*t*t}function sign(t){return t<0?-1:1}function log(t,e){return Math.log(t)/Math.log(e)}var pow=Math.pow;function frnd(t){return Math.random()*t}function rndr(t,e){return Math.random()*(e-t)+t}function rnd(t){return Math.floor(Math.random()*(t+1))}function assembleFloat(t,e,i){return t<<31|e<<23|i}function floatToNumber(t){if(isNaN(t))return assembleFloat(0,255,4919);var e=t<0?1:0;if(0==(t=Math.abs(t)))return assembleFloat(e,0,0);var i=Math.floor(Math.log(t)/Math.LN2);return i>127||i<-126?assembleFloat(e,255,0):assembleFloat(e,i+127,t/Math.pow(2,i)*Math.pow(2,23)&8388607)}function numberToFloat(t){var e=2147483648&t?-1:1,i=(t>>23&255)-127,s=8388607&t;if(128==i)return e*(s?Number.NaN:Number.POSITIVE_INFINITY);if(-127==i){if(0==s)return 0*e;i=-126,s/=1<<22}else s=(s|1<<23)/(1<<23);return e*s*Math.pow(2,i)}var b58alphabet="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",params_order=["wave_type","p_env_attack","p_env_sustain","p_env_punch","p_env_decay","p_base_freq","p_freq_limit","p_freq_ramp","p_freq_dramp","p_vib_strength","p_vib_speed","p_arp_mod","p_arp_speed","p_duty","p_duty_ramp","p_repeat_speed","p_pha_offset","p_pha_ramp","p_lpf_freq","p_lpf_ramp","p_lpf_resonance","p_hpf_freq","p_hpf_ramp"];function SoundEffect(t){if("string"==typeof t){var e=new Params;0==t.indexOf("#")&&(t=t.slice(1)),t=e.fromB58(t)}this.init(t)}Params.prototype.toB58=function(){var t=[];for(var e in params_order){var i=params_order[e];if("wave_type"==i)t.push(this[i]);else if(0==i.indexOf("p_")){var s=this[i];s=floatToNumber(s),t.push(255&s),t.push(255&s>>8),t.push(255&s>>16),t.push(255&s>>24)}}return function(t,e){var i,s,r,n,h=[],a="";for(i in t)for(s=0,a+=(r=t[i])||a.length^i?"":1;s in h||r;)r=(n=(n=h[s])?256*n+r:r)/58|0,h[s]=n%58,s++;for(;s--;)a+=e[h[s]];return a}(t,b58alphabet)},Params.prototype.fromB58=function(t){return this.fromJSON(sfxr.b58decode(t)),this},Params.prototype.fromJSON=function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);return this},Params.prototype.pickupCoin=function(){return this.wave_type=SAWTOOTH,this.p_base_freq=.4+frnd(.5),this.p_env_attack=0,this.p_env_sustain=frnd(.1),this.p_env_decay=.1+frnd(.4),this.p_env_punch=.3+frnd(.3),rnd(1)&&(this.p_arp_speed=.5+frnd(.2),this.p_arp_mod=.2+frnd(.4)),this},Params.prototype.laserShoot=function(){return this.wave_type=rnd(2),this.wave_type===SINE&&rnd(1)&&(this.wave_type=rnd(1)),0===rnd(2)?(this.p_base_freq=.3+frnd(.6),this.p_freq_limit=frnd(.1),this.p_freq_ramp=-.35-frnd(.3)):(this.p_base_freq=.5+frnd(.5),this.p_freq_limit=this.p_base_freq-.2-frnd(.6),this.p_freq_limit<.2&&(this.p_freq_limit=.2),this.p_freq_ramp=-.15-frnd(.2)),this.wave_type===SAWTOOTH&&(this.p_duty=1),rnd(1)?(this.p_duty=frnd(.5),this.p_duty_ramp=frnd(.2)):(this.p_duty=.4+frnd(.5),this.p_duty_ramp=-frnd(.7)),this.p_env_attack=0,this.p_env_sustain=.1+frnd(.2),this.p_env_decay=frnd(.4),rnd(1)&&(this.p_env_punch=frnd(.3)),0===rnd(2)&&(this.p_pha_offset=frnd(.2),this.p_pha_ramp=-frnd(.2)),this.p_hpf_freq=frnd(.3),this},Params.prototype.explosion=function(){return this.wave_type=NOISE,rnd(1)?(this.p_base_freq=sqr(.1+frnd(.4)),this.p_freq_ramp=-.1+frnd(.4)):(this.p_base_freq=sqr(.2+frnd(.7)),this.p_freq_ramp=-.2-frnd(.2)),0===rnd(4)&&(this.p_freq_ramp=0),0===rnd(2)&&(this.p_repeat_speed=.3+frnd(.5)),this.p_env_attack=0,this.p_env_sustain=.1+frnd(.3),this.p_env_decay=frnd(.5),rnd(1)&&(this.p_pha_offset=-.3+frnd(.9),this.p_pha_ramp=-frnd(.3)),this.p_env_punch=.2+frnd(.6),rnd(1)&&(this.p_vib_strength=frnd(.7),this.p_vib_speed=frnd(.6)),0===rnd(2)&&(this.p_arp_speed=.6+frnd(.3),this.p_arp_mod=.8-frnd(1.6)),this},Params.prototype.powerUp=function(){return rnd(1)?(this.wave_type=SAWTOOTH,this.p_duty=1):this.p_duty=frnd(.6),this.p_base_freq=.2+frnd(.3),rnd(1)?(this.p_freq_ramp=.1+frnd(.4),this.p_repeat_speed=.4+frnd(.4)):(this.p_freq_ramp=.05+frnd(.2),rnd(1)&&(this.p_vib_strength=frnd(.7),this.p_vib_speed=frnd(.6))),this.p_env_attack=0,this.p_env_sustain=frnd(.4),this.p_env_decay=.1+frnd(.4),this},Params.prototype.hitHurt=function(){return this.wave_type=rnd(2),this.wave_type===SINE&&(this.wave_type=NOISE),this.wave_type===SQUARE&&(this.p_duty=frnd(.6)),this.wave_type===SAWTOOTH&&(this.p_duty=1),this.p_base_freq=.2+frnd(.6),this.p_freq_ramp=-.3-frnd(.4),this.p_env_attack=0,this.p_env_sustain=frnd(.1),this.p_env_decay=.1+frnd(.2),rnd(1)&&(this.p_hpf_freq=frnd(.3)),this},Params.prototype.jump=function(){return this.wave_type=SQUARE,this.p_duty=frnd(.6),this.p_base_freq=.3+frnd(.3),this.p_freq_ramp=.1+frnd(.2),this.p_env_attack=0,this.p_env_sustain=.1+frnd(.3),this.p_env_decay=.1+frnd(.2),rnd(1)&&(this.p_hpf_freq=frnd(.3)),rnd(1)&&(this.p_lpf_freq=1-frnd(.6)),this},Params.prototype.blipSelect=function(){return this.wave_type=rnd(1),this.wave_type===SQUARE?this.p_duty=frnd(.6):this.p_duty=1,this.p_base_freq=.2+frnd(.4),this.p_env_attack=0,this.p_env_sustain=.1+frnd(.1),this.p_env_decay=frnd(.2),this.p_hpf_freq=.1,this},Params.prototype.mutate=function(){rnd(1)&&(this.p_base_freq+=frnd(.1)-.05),rnd(1)&&(this.p_freq_ramp+=frnd(.1)-.05),rnd(1)&&(this.p_freq_dramp+=frnd(.1)-.05),rnd(1)&&(this.p_duty+=frnd(.1)-.05),rnd(1)&&(this.p_duty_ramp+=frnd(.1)-.05),rnd(1)&&(this.p_vib_strength+=frnd(.1)-.05),rnd(1)&&(this.p_vib_speed+=frnd(.1)-.05),rnd(1)&&(this.p_vib_delay+=frnd(.1)-.05),rnd(1)&&(this.p_env_attack+=frnd(.1)-.05),rnd(1)&&(this.p_env_sustain+=frnd(.1)-.05),rnd(1)&&(this.p_env_decay+=frnd(.1)-.05),rnd(1)&&(this.p_env_punch+=frnd(.1)-.05),rnd(1)&&(this.p_lpf_resonance+=frnd(.1)-.05),rnd(1)&&(this.p_lpf_freq+=frnd(.1)-.05),rnd(1)&&(this.p_lpf_ramp+=frnd(.1)-.05),rnd(1)&&(this.p_hpf_freq+=frnd(.1)-.05),rnd(1)&&(this.p_hpf_ramp+=frnd(.1)-.05),rnd(1)&&(this.p_pha_offset+=frnd(.1)-.05),rnd(1)&&(this.p_pha_ramp+=frnd(.1)-.05),rnd(1)&&(this.p_repeat_speed+=frnd(.1)-.05),rnd(1)&&(this.p_arp_speed+=frnd(.1)-.05),rnd(1)&&(this.p_arp_mod+=frnd(.1)-.05)},Params.prototype.random=function(){return this.wave_type=rnd(3),rnd(1)?this.p_base_freq=cube(frnd(2)-1)+.5:this.p_base_freq=sqr(frnd(1)),this.p_freq_limit=0,this.p_freq_ramp=Math.pow(frnd(2)-1,5),this.p_base_freq>.7&&this.p_freq_ramp>.2&&(this.p_freq_ramp=-this.p_freq_ramp),this.p_base_freq<.2&&this.p_freq_ramp<-.05&&(this.p_freq_ramp=-this.p_freq_ramp),this.p_freq_dramp=Math.pow(frnd(2)-1,3),this.p_duty=frnd(2)-1,this.p_duty_ramp=Math.pow(frnd(2)-1,3),this.p_vib_strength=Math.pow(frnd(2)-1,3),this.p_vib_speed=rndr(-1,1),this.p_env_attack=cube(rndr(-1,1)),this.p_env_sustain=sqr(rndr(-1,1)),this.p_env_decay=rndr(-1,1),this.p_env_punch=Math.pow(frnd(.8),2),this.p_env_attack+this.p_env_sustain+this.p_env_decay<.2&&(this.p_env_sustain+=.2+frnd(.3),this.p_env_decay+=.2+frnd(.3)),this.p_lpf_resonance=rndr(-1,1),this.p_lpf_freq=1-Math.pow(frnd(1),3),this.p_lpf_ramp=Math.pow(frnd(2)-1,3),this.p_lpf_freq<.1&&this.p_lpf_ramp<-.05&&(this.p_lpf_ramp=-this.p_lpf_ramp),this.p_hpf_freq=Math.pow(frnd(1),5),this.p_hpf_ramp=Math.pow(frnd(2)-1,5),this.p_pha_offset=Math.pow(frnd(2)-1,3),this.p_pha_ramp=Math.pow(frnd(2)-1,3),this.p_repeat_speed=frnd(2)-1,this.p_arp_speed=frnd(2)-1,this.p_arp_mod=frnd(2)-1,this},Params.prototype.synth=function(){this.wave_type=rnd(1),this.p_base_freq=rnd(1)?.2477:.1737,this.p_env_attack=rnd(4)>3?frnd(.5):0,this.p_env_sustain=frnd(1),this.p_env_punch=frnd(1),this.p_env_decay=frnd(.9)+.1,this.p_arp_mod=[0,0,0,0,-.3162,.7454,.7454][rnd(6)],this.p_arp_speed=frnd(.5)+.4,this.p_duty=frnd(1),this.p_duty_ramp=2==rnd(2)?frnd(1):0,this.p_lpf_freq=[1,frnd(1)*frnd(1)][rnd(1)],this.p_lpf_ramp=rndr(-1,1),this.p_lpf_resonance=frnd(1),this.p_hpf_freq=3==rnd(3)?frnd(1):0,this.p_hpf_ramp=3==rnd(3)?frnd(1):0},Params.prototype.tone=function(){return this.wave_type=SINE,this.p_base_freq=.35173364,this.p_env_attack=0,this.p_env_sustain=.6641,this.p_env_decay=0,this.p_env_punch=0,this},sfxr={},sfxr.toBuffer=function(t){return new SoundEffect(t).getRawBuffer().buffer},sfxr.toWebAudio=function(t,e){var i=new SoundEffect(t),s=_sfxr_getNormalized(i.getRawBuffer().buffer,i.bitsPerChannel);if(e){for(var r=e.createBuffer(1,s.length,i.sampleRate),n=r.getChannelData(0),h=0;h<s.length;h++)n[h]=s[h];var a=e.createBufferSource();return a.buffer=r,a}},sfxr.toWave=function(t){return new SoundEffect(t).generate()},sfxr.toAudio=function(t){return new SoundEffect(t).generate().getAudio()},sfxr.b58decode=function(t){var e=function(t,e){var i,s,r,n,h=[],a=[];for(i in t){if(s=0,(r=e.indexOf(t[i]))<0)return;for(r||a.length^i||a.push(0);s in h||r;)r=(n=(n=h[s])?58*n+r:r)>>8,h[s]=n%256,s++}for(;s--;)a.push(h[s]);return new Uint8Array(a)}(t,b58alphabet),i={};for(var s in params_order){var r=params_order[s],n=4*(s-1)+1;if("wave_type"==r)i[r]=e[0];else{var h=e[n]|e[n+1]<<8|e[n+2]<<16|e[n+3]<<24;i[r]=numberToFloat(h)}}return i},SoundEffect.prototype.init=function(t){this.parameters=t,this.initForRepeat(),this.waveShape=parseInt(t.wave_type),this.fltw=.1*Math.pow(t.p_lpf_freq,3),this.enableLowPassFilter=1!=t.p_lpf_freq,this.fltw_d=1+1e-4*t.p_lpf_ramp,this.fltdmp=5/(1+20*Math.pow(t.p_lpf_resonance,2))*(.01+this.fltw),this.fltdmp>.8&&(this.fltdmp=.8),this.flthp=.1*Math.pow(t.p_hpf_freq,2),this.flthp_d=1+3e-4*t.p_hpf_ramp,this.vibratoSpeed=.01*Math.pow(t.p_vib_speed,2),this.vibratoAmplitude=.5*t.p_vib_strength,this.envelopeLength=[Math.floor(t.p_env_attack*t.p_env_attack*1e5),Math.floor(t.p_env_sustain*t.p_env_sustain*1e5),Math.floor(t.p_env_decay*t.p_env_decay*1e5)],this.envelopePunch=t.p_env_punch,this.flangerOffset=1020*Math.pow(t.p_pha_offset,2),t.p_pha_offset<0&&(this.flangerOffset=-this.flangerOffset),this.flangerOffsetSlide=1*Math.pow(t.p_pha_ramp,2),t.p_pha_ramp<0&&(this.flangerOffsetSlide=-this.flangerOffsetSlide),this.repeatTime=Math.floor(2e4*Math.pow(1-t.p_repeat_speed,2)+32),0===t.p_repeat_speed&&(this.repeatTime=0),this.gain=Math.exp(t.sound_vol)-1,this.sampleRate=t.sample_rate,this.bitsPerChannel=t.sample_size},SoundEffect.prototype.initForRepeat=function(){var t=this.parameters;this.elapsedSinceRepeat=0,this.period=100/(t.p_base_freq*t.p_base_freq+.001),this.periodMax=100/(t.p_freq_limit*t.p_freq_limit+.001),this.enableFrequencyCutoff=t.p_freq_limit>0,this.periodMult=1-.01*Math.pow(t.p_freq_ramp,3),this.periodMultSlide=1e-6*-Math.pow(t.p_freq_dramp,3),this.dutyCycle=.5-.5*t.p_duty,this.dutyCycleSlide=5e-5*-t.p_duty_ramp,t.p_arp_mod>=0?this.arpeggioMultiplier=1-.9*Math.pow(t.p_arp_mod,2):this.arpeggioMultiplier=1+10*Math.pow(t.p_arp_mod,2),this.arpeggioTime=Math.floor(2e4*Math.pow(1-t.p_arp_speed,2)+32),1===t.p_arp_speed&&(this.arpeggioTime=0)},SoundEffect.prototype.getRawBuffer=function(){for(var t=0,e=0,i=0,s=Array(32),r=0;r<32;++r)s[r]=2*Math.random()-1;var n=0,h=0,a=0,p=0,f=0,o=Array(1024);for(r=0;r<1024;++r)o[r]=0;for(var d=0,_=[],l=0,u=0,c=Math.floor(44100/this.sampleRate),m=0;0!=this.repeatTime&&++this.elapsedSinceRepeat>=this.repeatTime&&this.initForRepeat(),0!=this.arpeggioTime&&m>=this.arpeggioTime&&(this.arpeggioTime=0,this.period*=this.arpeggioMultiplier),this.periodMult+=this.periodMultSlide,this.period*=this.periodMult,!(this.period>this.periodMax&&(this.period=this.periodMax,this.enableFrequencyCutoff));++m){var v=this.period;this.vibratoAmplitude>0&&(a+=this.vibratoSpeed,v=this.period*(1+Math.sin(a)*this.vibratoAmplitude));var y,g=Math.floor(v);if(g<OVERSAMPLING&&(g=OVERSAMPLING),this.dutyCycle+=this.dutyCycleSlide,this.dutyCycle<0&&(this.dutyCycle=0),this.dutyCycle>.5&&(this.dutyCycle=.5),++h>this.envelopeLength[n]&&(h=0,++n>2))break;var b=h/this.envelopeLength[n];y=0===n?b:1===n?1+2*(1-b)*this.envelopePunch:1-b,this.flangerOffset+=this.flangerOffsetSlide;var w=Math.abs(Math.floor(this.flangerOffset));w>1023&&(w=1023),0!=this.flthp_d&&(this.flthp*=this.flthp_d,this.flthp<1e-5&&(this.flthp=1e-5),this.flthp>.1&&(this.flthp=.1));for(var x=0,S=0;S<OVERSAMPLING;++S){var M=0;if(++p>=g&&(p%=g,this.waveShape===NOISE))for(r=0;r<32;++r)s[r]=2*Math.random()-1;var k=p/g;if(this.waveShape===SQUARE)M=k<this.dutyCycle?.5:-.5;else if(this.waveShape===SAWTOOTH)M=k<this.dutyCycle?2*k/this.dutyCycle-1:1-2*(k-this.dutyCycle)/(1-this.dutyCycle);else if(this.waveShape===SINE)M=Math.sin(2*k*Math.PI);else{if(this.waveShape!==NOISE)throw"ERROR: Bad wave type: "+this.waveShape;M=s[Math.floor(32*p/g)]}var q=t;this.fltw*=this.fltw_d,this.fltw<0&&(this.fltw=0),this.fltw>.1&&(this.fltw=.1),this.enableLowPassFilter?(e+=(M-t)*this.fltw,e-=e*this.fltdmp):(t=M,e=0),i+=(t+=e)-q,M=i-=i*this.flthp,o[1023&f]=M,M+=o[f-w+1024&1023],f=f+1&1023,x+=M*y}l+=x,++u>=c&&(u=0,x=l/c,l=0,x=x/OVERSAMPLING*masterVolume,x*=this.gain,8===this.bitsPerChannel?((x=Math.floor(128*(x+1)))>255?(x=255,++d):x<0&&(x=0,++d),_.push(x)):((x=Math.floor(32768*x))>=32768?(x=32767,++d):x<-32768&&(x=-32768,++d),_.push(255&x),_.push(x>>8&255)))}return{buffer:_,clipped:d}},SoundEffect.prototype.generate=function(){var t=this.getRawBuffer(),e=new RIFFWAVE,i=_sfxr_getNormalized(t.buffer,this.bitsPerChannel);return e.header.sampleRate=this.sampleRate,e.header.bitsPerSample=this.bitsPerChannel,e.Make(i),e.clipping=t.clipped,e.buffer=i,e.getAudio=_sfxr_getAudioFn(e),e};var _sfxr_getNormalized=function(t,e){for(var i=new Float32Array(t.length),s=0;s<t.length;s++)i[s]=2*t[s]/pow(2,e)-1;return i},_sfxr_getAudioFn=function(t){return function(){var e=null;if("AudioContext"in window?e=new AudioContext:"webkitAudioContext"in window&&(e=new webkitAudioContext),e){for(var i=e.createBuffer(1,t.buffer.length,t.header.sampleRate),s=i.getChannelData(0),r=0;r<t.buffer.length;r++)s[r]=t.buffer[r];return{channels:[],play:function(){var t=e.createBufferSource();t.buffer=i,t.connect(e.destination),"AudioContext"in window?t.start():"webkitAudioContext"in window&&t.noteOn(0),this.channels.push(t)}}}var n=new Audio;return n.src=t.dataURI,n}};!function(t,e){"function"==typeof define&&define.amd?define(["riffwave"],function(i){return t.jsfxr=e(i)}):"object"==typeof module&&module.exports?(RIFFWAVE=require("./riffwave.js"),module.exports=t.jsfxr=e(RIFFWAVE)):t.jsfxr=e(t.RIFFWAVE)}(this,function(t){return{Params:Params,SoundEffect:SoundEffect,sfxr:sfxr,waveforms:{SQUARE:SQUARE,SAWTOOTH:SAWTOOTH,SINE:SINE,NOISE:NOISE}}}),function(){const t={sl:"111114YA69VjV2TF883n6f74g6pdmvw94esjz2Fg9dVLMafmEXKsLhDNrqyMiHgYJLUFEU4BBbMM2fbPNNkEPnFr2gKqHzZest5dM9rcxKvMBfZaNVG7wsFV",rs:"34T6PkuM9azcqQRP2uhqSKehYPVttMZPtXpjTTUjUwxb7py2H6TKgBffhrzZ7nPmKhP9JD3gEhifVkUezyWGSUnQyk8ogjYL61H2E9d5KhKMhhHhaxT3G4jR1",sh:"111112tu2RTz4ZLfm6nwnmzVVYDerCJ1GUa66TYpw6EgKckrbkxXbT14CJiEqBnf3cjD3aFriqdKZs6A8QJB2AYqbmYX8qYaJRnwaipyeGThYFXGoKQKWwgB",lu:"111119SowJUqZyfe4jLRUfMiWf8c8WYnkjRBJUL3ZZaCqfAeNPhf9rVc62kRS3jD3J63z77A6QF6Mhazdo7kb9hjbyQ3JUTCLeAmStvwTzmPMhnSREk4jzYP",pw:"34T6PksDM6sxLWXsKMV54x6nBYTVK2X82XguTcaNo2PNHaSYwAgcpjW5ZD5MLL4xexbsTeVEWu6cDStLHKr2ey2kqMcTGr9p7MYBp157yy7xG3Mhu9rpQWJqd",php:"7BMHBGQKT6faneej8J2UfgXkv259Mh1u9B4bysSRxEYy7VtvWt4cdFK5MwuM5pAWp8rdGDfJai6329LzskzZkh9ipbXn4rDdD1YQjJYCzXxoV1JgQzadPpXfu",bhp:"7BMHBGLmaZAt72j4pAcPAVnSrSTf2sb9NC6LKmg8cmfTtK5cFcHvPcUGnfH99T7EAeTwdLUYEMKEHKYm4VTVLuJywmfAAR3XthQc3v361s6Lq6UJQLBuW6a6b",bhc:"7BMHBGGGKzwmnk2LXPSFk2ZR1UCBQV7GsbQ51LNWWc2ZJkkZBaLs1QbPoCe86BcCp69QnKH67dcF48hGfrriBi5Xdf4a8jnYma3QvDjHm5QQcR5cezjbEECBR"};function e(t){return new SoundEffect(t).generate()}let i={};for(const s in t)i[s]=e(t[s]).getAudio();const s=cv.getContext("2d"),r=Math.PI/180,n=360*r;let h=kontra;h.init();let a=s.translate.bind(s),p=s.beginPath.bind(s),f=s.closePath.bind(s),o=s.lineTo.bind(s),d=s.rotate.bind(s),_=s.resetTransform.bind(s),l=s.fill.bind(s),u=s.fillRect.bind(s),c=s.arc.bind(s),m=h.canvas.width,v=h.canvas.height,y=h.keys.pressed.bind(h),g=h.sprite.bind(h);function b(t,e,i,s){return e?setInterval(s,i):clearInterval(t)}function w(t,e=0,i=1){return Math.floor(Math.random()*t+e)*i}function x(t,e=0,i=0,r=3,n="#fff"){let h,o,d,l,c=[];for(t=t.toUpperCase(),h=0;h<t.length;h++)(l=chrs[t.charAt(h)])&&c.push(l);a(e,i),p(),s.fillStyle=n;let m=0;for(h=0;h<c.length;h++){l=c[h];let t=0,e=0;for(d=0;d<l.length;d++){let i=l[d];for(o=0;o<i.length;o++)i[o]&&u(m+o*r,t,r,r);e=Math.max(e,i.length*r),t+=r}m+=r+e}f(),_()}let S=[];const M=["#F3C099","#AEA2D1","#DBD272","#DBC098","#798495"];let k=[],q=100,E=[],A=[],R=50,F=1,P=localStorage;for(let t=0;t<R;t++)A.push({ti:250*Math.ceil((R-t)/5),fa:t%5+2,ta:5*(t+1),ma:20*Math.ceil((t+1)/5),fs:t%5+1,ms:t+5});let C=g({x:m-100,y:15,w:50,h:30,p:100,ccs:["#05A84E","#F7C808","#FE251D"],gcc(){return this.ccs[this.p<=25?2:this.p<=75?1:0]},update(){this.p>=100&&(this.p=100),this.p<=0&&(this.p=0)},render(){a(this.x,this.y),p(),s.strokeStyle="#fff",s.fillStyle="#fff",s.lineWidth=4,s.strokeRect(0,0,this.w,this.h),u(this.w+4,this.h/2-10,4,20),f(),p(),s.fillStyle=this.gcc(),u(2,2,this.p/100*(this.w-4),this.h-4),f(),_()}});let T=g({x:-m,y:80,width:240,height:80,a:0,dx:5,dy:2,dt:0,bdt:0,la:0,s:0,hs:P.getItem("hiScore")||0,update(){N.m.v||(this.a?(this.bdt+=1/60,y("left")&&this.x>=0&&(this.x-=this.dx),y("right")&&this.x+this.width<=2*m/2&&(this.x+=this.dx),y("up")&&this.y>=50&&(this.y-=this.dy),y("down")&&this.y+this.height<=v&&(this.y+=this.dy),y("space")&&this.bdt>.25&&(i.sh.play(),this.bdt=0,function(t,e,i,r){let h=g({x:t+i,y:e+r/2,dx:10,s:10,get width(){return this.s},get height(){return this.s},update(){this.x+=this.dx},render(){a(this.x,this.y),p(),s.fillStyle="#fff",c(this.s/2,this.s/2,this.s/2,0,n),l(),f(),_()}});E.push(h)}(this.x,this.y,this.width,this.height))):(this.bdt=0,this.y+=10)),N.s.v&&(this.x+=this.dx)},render(){a(this.x+35,this.y+70),a(this.width/2,this.height/2),d(80*r),a(-this.width/2,-this.height/2),p(),s.fillStyle="#1B7851",s.moveTo(35,-5),o(65,-5),o(67,5),o(33,5),l(),u(35,5,30,15),u(15,20,70,40),u(-5,10,20,60),u(20,70,60,20),u(35,120,30,60),u(30,160,50,20),f(),this.a&&(p(),s.fillStyle="#FEDA94",u(-5,70,20,m),u(40,180,25,m),f(),p(),s.fillStyle="#FECE5F",u(0,70,10,m),u(45,180,15,m),f(),p()),s.fillStyle="#DDDEE2",u(25,60,50,10),u(40,90,20,30),f(),p(),s.fillStyle="#f7912e",c(50,13,5,0,n),l(),f(),p(),s.fillStyle="rgba(0,0,0,0.15)",c(50,13,3,0,n),l(),f(),p(),a(50,40),d(-170*r),a(-50,-40),s.fillStyle="rgba(0,0,0,0.25)",c(50,40,18,0,n),l(),f(),p(),s.fillStyle="#DDDEE2",u(40,40,20,35),f(),p(),s.fillStyle="#1B7851",c(50,40,13,0,n),l(),u(35,75,30,35),u(39,120,22,15),f(),p(),s.fillStyle="#f7912e",u(35,110,30,10),f(),_()}});function I(t,e=0){if(0===t||k.length===A[F-1].ms+q)return;let i=g({x:m+w(55,0,20),y:w(25,3,25),s:12,a:0,da:2,p:e,dx:10,update(){this.p&&(this.a+=this.da,(this.a>=150||this.a<=0)&&(this.da*=-1)),this.x-=this.p?3*this.dx/2:this.dx,this.x<=-this.s&&(this.x=m)},render(){let t=this.p?this.s:this.s/2;a(this.x,this.y),p(),s.fillStyle=this.p?"#ffcf40":"#fff",s.ellipse(t,t,1,t,0,0,n),s.ellipse(t,t,1,t,90*r,0,n),l(),f(),this.p&&(p(),s.fillStyle=`rgba(255,207,64,${this.a/255})`,c(t,t,4*t/5,0,n),l(),f()),_()}});k.push(i),I(t-1)}function L(){b(V,0)}function O(){V=b(V,1,A[F-1].ti,()=>{I(A[F-1].fs,1),function t(e){if(0===e||S.length===A[F-1].ma)return;let i=g({x:2*m,y:w(440,100),dg:0,sa:w(5,1),s:w(3,1,30),crs:6,dx:w(5,2,2),cc:w(M.length),get p(){return this.s/30},get width(){return this.s},get height(){return this.s},update(){this.x-=this.dx,this.x<=-this.s&&(this.x=m),this.dg-=this.sa},render(){a(this.x,this.y),a(this.s/2,this.s/2),d(this.dg*r);let t=30*this.p/this.s;s.scale(t,t),a(-this.s/2,-this.s/2),p(),s.fillStyle=M[this.cc],c(this.s/2,this.s/2,this.s/2,0,n),l(),f();for(let t=1;t<=this.crs;t++)a(this.s/2,this.s/2),d(360/this.crs*r),a(-this.s/2,-this.s/2),p(),s.fillStyle=M[this.cc],c(this.s/8,this.s/8,this.s/10,0,n),l(),f(),t%2==0&&(p(),s.fillStyle="rgba(0,0,0,0.35)",c(this.s/4,this.s/2,this.s/8,0,n),l(),f());_()}});S.push(i),t(e-1)}(A[F-1].fa)})}function B(t){return Math.ceil(t)}let N={h:{v:1,m:["Robo","Galactic","Shooter"]},m:{v:1,dt:0,l:[{m:"Play Game",s:1},{m:"Instructions",s:0}]},i:{v:0},s:{v:0,t:3,m:"start game"},c:{v:0,t:9,m:"continue"},o:{v:0,t:3,m:"game over"}};let W=h.gameLoop({fps:60,update(){let t,e;for([].concat(...[T],...k,...S,...E,...[C]).map(t=>{t.update()}),t=0;t<S.length;t++){for(e=0;e<E.length;e++)if(s=E[e],r=S[t],s.x<r.x+r.width&&s.x+s.width>r.x&&s.y<r.y+r.height&&s.y+s.height>r.y){--S[t].p?i.bhp.play():(T.la+=1,i.bhc.play());break}if(e!==E.length){E.splice(e,1),T.s+=50;break}if(T.collidesWith(S[t])&&!N.s.v){C.p-=10*S[t].p,T.x-=20*S[t].p,S[t].p=0,i.php.play(),i.bhc.play();break}}var s,r;for(t!==S.length&&0===S[t].p&&S.splice(t,1),t=0;t<E.length&&!(E[t].x>=m);t++);for(E.splice(t,1),t=0;t<k.length;t++)if(T.collidesWith(k[t])&&k[t].p&&C.p>0){i.pw.play(),C.p+=k[t].s;break}k.splice(t,1),T.s>T.hs&&(T.hs=T.s),T.s>=9999999999&&(T.s=0,T.hs=9999999999),T.la>=A[F-1].ta&&(F<R?(F+=1,T.la=0,i.lu.play(),L(),O()):99999===T.la&&(T.la=0)),C.p<=0&&(T.a=0,N.c.v=1,L(),h.keys.unbind("p")),N.s.v&&(B(N.s.t)>=0?N.s.t-=1/60:N.s.v=0),N.c.v&&(P.setItem("hiScore",T.hs),B(N.c.t)>=0?N.c.t-=1/60:(N.c.v=0,N.o.v=1),y("enter")&&(i.rs.play(),N.s.t=3,N.c.t=9,N.c.v=0,T.s=0,C.p=100,U())),N.o.v&&(B(N.o.t)>=0?N.o.t-=1/60:(S.length=0,k.length=q,N.o.v=0,N.m.v=1,N.h.v=1,T.la=0,T.s=0,F=1,C.p=100,N.c.t=9,N.o.t=3,N.s.t=3)),N.m.v&&(N.m.dt+=1/60,(y("up")||y("down"))&&N.m.dt>.25&&(i.sl.play(),N.m.l[0].s=!N.m.l[0].s,N.m.l[1].s=!N.m.l[1].s,N.m.dt=0),y("enter")&&N.m.dt>.25&&(N.m.dt=0,N.m.v=0,N.m.l[0].s?(N.h.v=0,U()):N.i.v=1)),N.i.v&&(N.m.dt+=1/60,y("enter")&&N.m.dt>.25&&(N.i.v=0,N.m.v=1,N.m.dt=0))},render(){!function(){let t=s.createLinearGradient(m/2,0,m/2,v),e=t.addColorStop.bind(t);e(.3,"#101014"),e(.7,"#141852"),e(1,"#35274E"),s.fillStyle=t,u(0,0,m,v)}(),[].concat(...k,...[T],...S,...E,...[C]).map(t=>{t.render()}),x("Level",250,10),x(`${F}/${R}`,350,10),x("Target",250,35),x(`${T.la}/${A[F-1].ta}`,350,35),x("Score",550,10),x(`${T.s}`,680,10),x("Hi-Score",550,35),x(`${T.hs}`,680,35),N.h.v&&(x(`${N.h.m[0]}`,(m-55*`${N.h.m[0]}`.length)/2,125,15),x(`${N.h.m[1]}`,(m-60*`${N.h.m[1]}`.length)/2,225,15),x(`${N.h.m[2]}`,(m-56*`${N.h.m[2]}`.length)/2,325,15)),N.m.v&&(x(`${N.m.l[0].m}`,(m-40*`${N.m.l[0].m}`.length)/2,475,10,N.m.l[0].s?"#FEDA94":void 0),x(`${N.m.l[1].m}`,(m-40*`${N.m.l[1].m}`.length)/2,575,10,N.m.l[1].s?"#FEDA94":void 0)),N.i.v&&(x("your planet is under threat as the asteroids",20,455),x("are approaching with uncertain speed. your",20,485),x("mission is to destroy them all before",20,515),x("your battery is drained out completely and",20,545),x("making you offline permanently.",20,575),x("survival tip",20,615,4),x("look for golden stars to recharge battery.",20,645),x("controls",675,455,4),x("arrow keys",675,495),x("move",835,495),x("space",675,525),x("shoot",835,525),x("p",675,555),x("pause/resume",835,555),x("enter",675,585),x("confirm",835,585)),N.c.v&&(x(`${N.c.m}`,(m-40*`${N.c.m}`.length)/2,235,10),x(`${B(N.c.t)}`,(m-50*`${B(N.c.t)}`.length)/2,305,20)),N.s.v&&(x(`${N.s.m}`,(m-20*`${N.s.m}`.length)/2,255,5),x(`${B(N.s.t)}`,(m-50*`${B(N.s.t)}`.length)/2,305,10)),N.o.v&&x(`${N.o.m}`,(m-64*`${N.o.m}`.length)/2,275,15)}}),V=null;function U(){N.s.v=1,T.x=-m,T.y=80,T.a=1,O(),h.keys.bind("p",()=>{W.isStopped?(W.start(),O()):(W.stop(),L())})}I(q),W.start()}();