var game=game||{};game.canvas={};game.player=new player();game.wind=new wind();game.island=new island();game.points=Array();game.level=new level();game.obstacle=new obstacle();game.obstacles=Array();game.currentLevel=0;game.cellWidth=undefined;game.cellHeight=undefined;game.init=function(){this.loadLevel(this.currentLevel);this.initializeCanvas();this.drawLevelObstacles();this.initPlayer();this.initWind();this.initIsland()};game.initializeCanvas=function(){this.canvas.background=document.getElementById("canvasBackground");this.canvas.obstacles=document.getElementById("canvasObstacles");this.canvas.player=document.getElementById("canvasPlayer");this.canvas.island=document.getElementById("canvasIsland");this.canvas.wind=document.getElementById("canvasWind");this.canvas.backgroundContext=this.canvas.background.getContext("2d");this.canvas.obstaclesContext=this.canvas.obstacles.getContext("2d");this.canvas.playerContext=this.canvas.player.getContext("2d");this.canvas.islandContext=this.canvas.island.getContext("2d");this.canvas.windContext=this.canvas.wind.getContext("2d");this.cellWidth=this.canvas.background.width/this.level.getColCount();this.cellHeight=this.canvas.background.height/this.level.getRowCount();game.marginLeft=(window.innerWidth-game.canvas.background.width)/2;this.canvas.background.style.marginLeft=game.marginLeft+"px";this.canvas.obstacles.style.marginLeft=game.marginLeft+"px";this.canvas.player.style.marginLeft=game.marginLeft+"px";this.canvas.island.style.marginLeft=game.marginLeft+"px";this.canvas.wind.style.marginLeft=game.marginLeft+"px";this.canvas.background.style.display="block";this.canvas.obstacles.style.display="block";this.canvas.player.style.display="block";this.canvas.island.style.display="block";this.canvas.wind.style.display="block";document.getElementsByClassName("header")[0].style.display="block"};game.loadLevel=function(a){this.level=levels[a];document.getElementById("levelNum").innerHTML="Level: "+this.level.num;document.getElementById("levelWindDirection").innerHTML="Wind: "+this.level.direction};game.drawLevelObstacles=function(){var b=this.level.matrix;this.obstacle.init();var a=0;for(i=0;i<this.level.getColCount();i++){for(j=0;j<this.level.getRowCount();j++){if(b[j][i]=="s"){this.obstacle.CartesianCoordinates[a]=new Array();this.obstacle.CartesianCoordinates[a][0]=i;this.obstacle.CartesianCoordinates[a][1]=j;a++}}}this.obstacle.draw();this.obstacle.animate()};game.initPlayer=function(){this.player.init();if(this.level.direction=="east"){this.player.col=0;this.player.row=this.getNumberRandom(0,this.level.getColCount()-1);var b=this.player.col*this.cellWidth;var a=this.player.row*this.cellHeight;this.player.setLocation(b,a);this.player.draw()}this.player.animable=true;this.player.animate()};game.initWind=function(){this.wind.CartesianCoordinates=[[1,1],[5,1],[8,1],[2,3],[7,3],[1,5],[5,5],[8,5],[2,7],[7,7],[1,8],[5,8],[8,8]];this.wind.init();this.wind.setLocation(0,0);var a=0;for(var b in this.wind.CartesianCoordinates){this.wind.AbsoluteCoordinates[b][0]=this.wind.CartesianCoordinates[b][0]*this.cellWidth;this.wind.AbsoluteCoordinates[b][1]=this.wind.CartesianCoordinates[b][1]*this.cellHeight}this.wind.draw();this.wind.animate()};game.getNumberRandom=function(b,a){return Math.floor((Math.random()*a)+b)};game.initIsland=function(){this.island.init();if(this.level.direction=="east"){this.island.col=10;this.island.row=this.getNumberRandom(0,this.level.getColCount()-1);var b=(this.island.col-1)*this.cellWidth;var a=(this.island.row-1)*this.cellHeight;this.island.setLocation(b,a);this.island.draw()}this.player.animable=true;this.player.animate()};game.getNumber=function(a){return Number(String(a).replace(/\..*/,""))};game.getDecimal=function(a){return Number(String(a).replace(/\.*./,""))};game.initPresentation=function(){game.presentation=document.getElementById("presentation");game.presentation.style.display="block";var b=(window.innerWidth-game.presentation.clientWidth)/2;game.presentation.style.marginLeft=b+"px";var a=document.getElementById("startButton");a.onclick=function(){game.hidePresentation();game.init()}};game.hidePresentation=function(){game.presentation.style.display="none"};game.showInformation=function(b,e,h,g){var c=document.getElementById("information");c.style.display="block";c.style.marginLeft=this.marginLeft+"px";var f=document.getElementById("information_title");f.innerText=b;f.innerHTML=b;var d=document.getElementById("information_explanation");d.innerText=e;d.innerHTML=e;var a=document.getElementById("information_action");a.value=h;a.onclick=g};game.hideInformation=function(){var a=document.getElementById("information");a.style.display="none"};window.onload=function(){game.initPresentation()};window.requestAnimFrame=(function(a){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){window.setTimeout(b,1000/60)}})();