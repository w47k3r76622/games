<!doctype html><html lang="en"><head><meta charset="utf-8"><title>Lost Compass</title><style>
  body{background:#333;font-family:Arial;height:100vh;margin:0;overflow:hidden;padding:10vmin 0 0 0;position:relative;transform:translate3d(0,0,0);width:100vw}.circle{background:linear-gradient(to bottom,#cacaca 0%,#565146 50%);border:1px dotted #000;border-radius:50%;content:'';display:block;left:-50%;height:100vh;position:absolute;top:calc(-100vh + 15vmin);width:200%}.circle--bottom{top:35vmin}.navs{display:flex;height:50vmin;left:0;position:absolute;overflow:hidden;top:0;transition:all 1s ease-in-out;width:360vmax}.navs__elm{color:#aaa;font-size:80%;line-height:50vmin;position:relative;text-align:center;width:5vmax}.navs__elm:after,.navs__elm:before{background:#555;bottom:55%;display:block;content:'';height:25vmin;left:50%;position:absolute;width:1px}.navs__elm:before{bottom:initial;top:55%}.navs__elm--side{font-size:280%;font-weight:700}.game-area{perspective:400px}.timer{left:50%;height:calc(30vmin + 4px);position:absolute;transform:translate(-50%,-2px);width:calc(30vmin + 4px)}.timer__container{height:100%;overflow:hidden;position:relative;width:100%}.timer__elm{background:#900;opacity:1;position:absolute;transition:all 1s linear}.timer__elm--top{height:2px;left:0;top:0}.timer__elm--right{bottom:0;right:0;width:2px}.timer__elm--bottom{bottom:0;height:2px;right:0}.timer__elm--left{left:0;top:0;width:2px}.animation .timer__elm{display:none}.board{background:#a7a7a7;background-size:30vmin auto;height:30vmin;margin:0 auto;position:relative;transition:all .4s;width:30vmin;transform:rotateX(0)}.board--target{box-shadow:0 0 15px #332d24;margin-bottom:10vmin;transform:rotateX(0deg)}.animation .board--target{transform:rotateX(-45deg)}.board--puzzle{background:none;height:45vmin;position:relative;width:45vmin}.animation .board--puzzle{transform:rotateX(45deg)}.board__cell{box-sizing:border-box;float:left}.board__cell--puzzle{border:none;position:relative;transition:top .8s,left .8s,transform .2s}.board__cell--target .board__cell--puzzle{left:0!important;margin:0;top:0!important}.board--puzzle .board__cell--puzzle{left:0;position:absolute;top:0}.board--puzzle .board__cell--puzzle:hover{transform:translateY(-5%)}.lvl-1 .board__cell{width:15vmin;height:15vmin}.lvl-2 .board__cell{width:10vmin;height:10vmin}.lvl-3 .board__cell{width:7.5vmin;height:7.5vmin}.lvl-4 .board__cell{width:6vmin;height:6vmin}.lvl-5 .board__cell{width:5vmin;height:5vmin}.board__decor{background:url("data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJ\a bWFnZVJlYWR5ccllPAAAAAxQTFRFAAAA////////AAAAOH4dugAAAAR0Uk5T////AEAqqfQAABOI\aSURBVHja7J2Lku0qq4VH6fu/83/W7p4zXhiASox9KrPW3rUuncR8ExARAfmkD/779L8/ZXj5WFr5\aMFTHwWpk64XlgIUX1gsrfDwXrReWPZ4vrReWYzwfWi8sz3h+ab2wXON5YY3CwgvLN54X1sh4Xlgj\a 43lhjYznhfXCil0blrReWOYyWgD3wvrDNuL9vLBeWC+sF9YL64X1+Cd1nxeWzehYajgQE05FhgPF\a CafKGM7TO+BUpcR5FsqE9RgwHEbKC+sRXjiM1ACs/bxwGCnDvj/LC6ehGoW1ExcOIzUBax8vnIbq\aH6xTceE0VP/sO2au++OwUtoJawMuHIZqyHPYjQuHoVqDdTMuHIKqGBHKPx2FC0+j6kf0f7AQe8uD\aYa29FERYATc+Edbq+yiwIm5/FKzlNzFgPRqIxm5U5oBsWDEPehrW9Aug+vznP8BKwn2AFh5GBeFT\aw+LItuPCLlY+ThQWIbaXFh5CRWn8wlJ+YuTBR8IaGrJGAF9Y/Ocfw4X7WWmkRIlL0nSoXbeLFiIu\amENF58XEfIc5XHEigvUr3AN1+AM6LO0mI7iwTw39Xyp5S8Mn1WHxO/nFe6fNgm+I8gvaDjwclkbk\a 5aSFvQYeo6zgPhPnhDWMK2RKw9pVQ6g8D/vAgmMIQ7gipv+1ecHDyiVU+P76woI+OJB7G0NacpWm\aJwYUA4MXFQxSGS0sGAMfwLXuVs7PDMhsE5lLFfqHw4QlgoYiuZzWogu+MDV49h661YxG6nNFDwvi\a 1fQxdOPoseUO0UENVXGqt1PA4hoRFtoL8wAuxCx9sMzqJ7TpY/WVp4pU+9a/980KLxBHQqYFxNDC\aIqtP7KkdDF8oy6RQOAO9ynS86EJbHGCxcfsErEq+0XuSDNXPe0qYVFgtYHGaZLRQ7XLvh1XL9+c/\aU6x+5jtusSo17BG1wH3Chd+UgABNxJoOFqKQLLG6YEmYiislyWqtFrJPuNCyWqGFeB1UxOpjb6Bq\a ElHDQlkpL4FWn8W0E1Y3IwMOVqhES10dqz7RD6wxw/VxR/AkLEm2RVS1kcIKLNPQ17iKLKZ1BwIr\arHqrKYkV/KIlmkDB+4DfcJX24jveXbAqy96KgeqHKrZqDFYrWLBl61LFFVqYZFXRqsteKaSsZ3ph\aZd2jrwMdX1ZlTuFOWGLsQ5Mr9AtDAxY8Q2ahn6si5ceDQFqfERHD6hte0UiZogUPLBhyW9FC6UEs\a byciiBUveCW8TCQsZIfhCqKF+1gh01fBAizR3DPDVfnyWKW1BAu2z0Bm93lYUHlptNZFC2uCpcdE\aqZ+dYcNK3gGzSbFVxHVaCFHCb76Qbqv0x9au20/4z0tZgIVatiJoIUKwikLbprnSRKqFpcSlTeuI\aVhO3wjKUUNYJh7PUdWJAtb3g3cnOoi8XSwtRBssxm0vhGqDf1Or3YlrJzV75yqFGHpFKOEarVzEK\a 6/vWcLGCKLf7YLlZKeGA9uWZ5WK7fJ4kgC4GFElrHhZn5aBFUyQ1WBYufCU2u2ndActl3FtaWkSK\a B6I0WNmsXor+Bwpai6KFYCWETQvG0pDv8cHE9WEFIo9rtBCshBct01ZhEpYVmFZXiffDGpgIDVqV\ap8C80mqfjflmJivEK+I6LMHEclcb0qLuOlvRwGq+Dpi6fAX8BhQxFtaIEiKX+4O6sULj/Euw+BxI\a EykgvFcMrRVYoppwWjAcJwqLRBaVv+hX9ZoiRsJyK2H7nbb+juEEaLCYF0tYZdHIL4vWDCz+bXNa\aJiobVtaFS2IlLS9vheUVLIi2gpkryFa4gpUkC6dqXmM7oxURS4KlylXlR8pSBfhhMd2l8+yAjY+C\a 5bTuoPFPiZXPwCcx0CJ/RWArxUjRQpRg0b5x4HZYDmf1sLof7PYroHgRcaI1C4sngBj+UEend+It\aWFSrLb+Oi1YMLJ9gAeqWDRn/NKx2GlQ2RYBA0UKQYNE1TtVNDnSFK60N09VCU50GQY0ldbZugeUS\aLC08XpkyyU8Sztk3GatQ104A9IfLfY+maCFCsHgLVZQhKGi7hZIaJvX0a7m05M/uFH8fLLrQ0U3s\av+QoZWOV2axELFYxzyaj57R70bMOyyVYXAtLw5JgJDSKkpVVXBcrKrbCBDwvWtOwrIVO5xImMTb+\aHTpEWNpCtGKl+KVxeogQHwuw7t1Xerru8klW72GVvHrvobmjI9yo0boRVm/C1XGireVXoEJrzNtk\a 6F9enb+fakMIKttReoh18+7wn9FKQoeKqmGLq5UrDA1EWyGuwVrTQsG1+Ja3+NwhQfASIB1KQKpC\aOwV56C/Tfq8PwGrVT41iFv7jzxnVHhWBVRuv78NLVp0Ecz0EFvUQU1poWCv2hV+FxPrbm7AKoaxL\asGjxWMGBWBCtcVh9bAnwsfoWmkErVj5YP8KFrlyNrohoQqz3wPLNhaZRbdf9PzLSpVp7YP2jBaG0\ajyZaEIY8q4dYESxlU4/uwNSn2QZhXccbWcDGkXozL1rLsMhGjbI4g9h7QYYFxgqu74YNNxzWgEea\aycY8iWCBSYwJ62LNaZmbPztgyWJUB+FcgvU9dzcMq2SF7KDCbcEULURoYedQcVbVAfsxWCjKiWRT\atJR21M/AErMXuGDh12eQaMF2Sgu50iWcj+wuWNxkGSsdKEr4419JRExYXZ4buJm0pqAi3nEPLO4o\a cCkXBOuKxjRLZR1WmwWRuGjJ50ND9BChWtjsQQtKiLZ8DTywunkBTLR4snyAHi5KlhZDkn5U0Cmo\asCCy+ihie38es8UzkmVrIdkGQxe9KivrKLAkVoUiAk0W84AexsBa08IiPFptVhF7DQ0WUU5Urog2\ar4z4pbfBIuto1HpxZdfWNxVPywmw6r+sD9BfsOqdVug5BNN6iOXJkGthLt6ksO7y/GbAEnzUK/LZ\apsa56uxuheXRwo+SoBMsjZaL1Ve0IJyv8+jhDlhWeKYLDF5aCCctpoOy1ZLKoJoHyuYs/BAsz5lS\akF1DYU3AaPlY/RsUO4Lh18M7YPm1cABWIpJEWEEWLTtQI4dIJqZDLNh3VnpGgpWlKrBE72SthFzT\a FuY3JQ11zsKTI0nzk+GAYDFablbdCtFRSGkRFuYmwwhYMi2e+ODWQzMBaRqWo5uNJFlQ1dDSwoZK\a+Q8SKxkdh6Vk7KzCMnvZ6Btftn1vS5tq3gE9eij8A83vvWU6RIZkjaZhsd1CI6hHaFFWtMfRzbBE\av83hZnm00DY7Eq1BViUyfTpEGKxKchYnQw8km00aguXpaTACC1ZCDuSkDTesEUac1hIrX3sfh1eq\a BfLrxzgc+C7ROM1+WhsVwwrCEEdcePFWaP/BL1mLkBitWFaypM3Cku6ow4qCRGhxTyIOWgAsex0d\ayojQupdV+7ZzsBQ/6zZIIq1NrOiiwAFLYnU/JClQupVVvybodm2L2bCo1+HzuW+n9eyny3IpfyOd\aWH7gBaTdr41fl9RcoomENQcbmVu7lxW8EZogedac0qYPcb/eBZki9sAaiWetKn2EB2/4WXezQrqP\aVikmtuvQu7HIQhtdd6LyDayQ4mnBnbJMYM178E3QI5iVckpsXtsgFJFwOKX1HyD3Gp6KOgSxgnfb\a 0GWSpqMOUq61y4Mfi2fNwhreZNUk6aawsjsGDyg1LIRI6SQr7/a9ZJLGNw7v2t2BIwdKi8E7WSG5\a aY3G4LEOayXvb3B3x8PKplX2m3lgdydq+x7OfUONlRh1oP72wL5hXt83vCk9CyT3tj0TJ2RnuTVx\a dEcaeAhWTK4DjZSC7/A/meuwllK6lkWjxOBdtOhpNHiT2SJgORwtYMzC58HdHSQ9z2E8Pws35WdN\a e6VUD5GZYNkOF6PFtfDRzL+krMR1T6tIUoePlTeHBtXNzZzSJ2BBy4En2cqQTDw8aTQqrZxJooOp\ahbuylWfy4LmJT1o+t06rXlB5UkqfPjRg5XbzExaKF6W0LErshMWkFm6DZethmdLfiFYd4ePnpZEI\arfrsDjCqhZGwpleH7SnJ6sxWgsxKg8VotafC4NfC6FNhyyedulOS1XlD1dtkG8ZtQz+WrW2ec5q0\a 74snWZkeSs2qOvfBOrfKjrtqJ1nNOpwrWnjTGWnRNyzOSKuspNkQ7X5GZqXzcc4Z6ZXT999NNoOV\a dl76asasnr5XExwVkzULK6SuA8S6DpInYBfEQLfxR9w7WBUIn6wYkgcrhohek7t6iHDKV3zkcRVD\a 2KDUWjSyh+mAVdHiVQD08WyCZVU58sRKqjMoaRRW/c+OMBrhNV1tLKh+Fm+x09LqIqFjBl7ci1cK\a 2W2qnzWwPIS65qn+XpYrngWYGC3XdxMYJZ2CJaQIGh6gxCqnSVhZomWHb7fX/ONGSxWtXKdQfJOa\aMA7rt5pkS8uoJtlb10dKb/KS+KRAWmmdOS3QmtTVHKE+qh/LI3VK6+r+QxVwfyVCroBrwSor4Fa0\a 3BVwvxG2SS2cLhdsl6Lu3gFf7bkOvcANC2Up6pLWSG3lDNwFK7hqd2lpLuGCCxa6qt0fWoNVu28r\aRB1cDz6Jc5KjZCnELJ4fWnr1fDxYD36p00Di7o5aZrlE1bghQrsyI95wI6w1PaxFK0Ht78xPlFOH\a DnUhXM8oFtujBDT84JXOS6cBRncUWbL6n6txGVk9/RSwvzvKcN8dxdMXAnHiIVT54gQMGPfVlk7z\aHZ2o1ydaWNCZ/buTJcJSzjtXYa0TOzqN9wrLuetN0G1iGIeijaKVxsMzZCsZD8spWlpD++zpQsdh\aMeteh5FzHtPCKVZB/Q1pr8880N+Q2SxHf0NX66sH+hvydmGrnTMHYNmVZcke3VpT1tierLITzYP2\a 8iF2GZamXNRWBk6FU7C0br9kwQG6CSueF9JhSdaSz4XZZd2jYN3TR1p6eg9LBmz4nXQkuL+PtFe0\aNFbSEk3YzFBgsXWCjJ0167u/Q7kqWk30oQuaZGWncwxWhtrNPXdt3OhCZ1qwpmDxRY8SjIOdjmfA\aMlIY9MlZYxUJyylaOqusbqPbsBztfjRaiBCsOVhJeYPrnlYuS26beFFY4tKSChpUF2tBsFyw/LSg\asWJ7/N9FjQiLJPRBW7ZLP71s3UNgQdJDZF9gvnobeSEtb4FQpx2SPYgRLB8sNy2Llbbitgx83SeR\avw/GXKwBVtOwqCJ+VjgKLRbSaQ+J6VEZFuLoaams4mGNiNY1Yh3XJCw9uVx6dpQSLsCitEB0IWcr\aqmLD0o/DQKSFMMHywhqhZbMiuCxYdj3ND617WLlhKQLc+6Yg3o7uVBqwAEO5ZVrljRZZrcBK8jfu\aYwXpSgoLfFYwaEUKlh+WVxHRDtx4LnhBOHp3nVTr8IaxWoMl0Gp8aLaZoDTU7HZ37PGC0TJY3QfL\aUkRpGY2Bx0rFoLzjRf84tEK5zmoEloMWTHurvzPP3bZ8K4lWNKtVWCmzDRjVcCFPw4JlrmSvLO2G\aZdOyLMktsMhD4lmNwRqkJRsT5aEuNYStgZ2ox7AahGVOiaAuNW6Cxb4PNXt0jlUErFTsJ8hHxtr3\aMQ45GgYeJqlrKKjuuhmWXMgi1xUvLLfaOlzlggVNCavCGP1JqklWw7CaDL3vIRGuio0UwAvL4S14\azBVSlBJOwCoO0Fd1A7yGC1pVHXhgAd0tOaucyvF21aa3wPo9buTzt5q3WoVVa6BsrhpWaM5kb4NV\aVNavNDHrmlgp4gIstKLlYYXvV4sFVjOwcmmyqnb0hnBV1TEwDOuyefwOYhYTAibCaVhZYmXS6tVH\aMDcUVvXj4DttEquibvoSqzlYl90CaA1nMisWsRwBGS3VWs1//HyAzOpLa43VJKxcmK3//o9GvhVN\a 6t68/FXBaknqhj2Tdjj4NHpY1MF5WIUmSh6EIlySoSewJHOV2YSqFh5HgA4uwGo9CDhpQfdQUXnw\a ELWVr2+UnoPrOrgM63JO4RQuyB49OlgKKRqXNtawq6zmYeXS2ZIHpHW2JFaewxKC1vw5wrHrZ2Fl\a adnTjKh7Dc17+m+ulGFlJSYmfCVMroDHYKH52jy4oC5fZFjqwAGvCqacV2lh5UrCSqSlN0sYh8VQ\a aaxWaWHtwpRsU1qe7nLptm9vB0OoUoAqTV8L7+AqXH5YjhE4GpWI0852WLCHN4cLPlgYQ5XCLM/i\aVWkUF5ZhjaJKoaZn6SL/IB28TFj0Ju5hrNuelWvSDC7MwMIMqnSD8Vm4JA0M1eiLzWFpF46h2miz\aXK1ndC1QcopEWEbr8bSJVUbQfdLYiHk31BKWq0l72sYqDJYx5mQYoLaPtLebfUobWcXBmhu4SMsJ\a ajeqUFjm2JPDHRBghT/uCFiO8VuVngtY9z7pAFiOdzB5pRRA6hZW0bB8L6K9igVr9f5HwXK+DX0f\a DVZavPd5sAbeSXwrAmvtpufCGnqz7u1aWGnlZn8B1vAbSlsxc5/892At4MIKrJz/JKxpXAuwcv6z\asCZxTcPK+U/DmsWFI1HdDmsK1wSsnP9fwJrghSNJbYI1igtnotoFa4wXjiS1E5afl9tk5d0f7H1c\aHKz8wAfbnxgBKz/zwSNPXYGVn/vgsSdPGPj88AcPPz+dasxPhGUyywd9kN/PC+uF9cJ6YS2NCQBO\aHBuORGWW93thfVg1v3lh2bDyC8unhC+sUVivgXfNhHhhjdA60/07FdaRuM70sw6ldeKQjqV1pHE4\aldahC+kX1tCAXlgumcrv2vCFdW/U4Z0NnavD13UYmgtfD/5vf/4nwAAFoF9fxSlUkQAAAABJRU5E\arkJggg==") no-repeat;background-color:#fff;background-repeat:no-repeat;background-size:30vmin}.board__decor--clue{background-color:transparent;height:100%;opacity:0;pointer-events:none;position:absolute;transition:all 1s;width:100%}@keyframes rotateCompass{0%{transform:rotate(0deg);opacity:0}25%{transform:rotate(160deg);opacity:1}50%{transform:rotate(60deg)}75%{transform:rotate(220deg);opacity:1}85%{transform:rotate(200deg)}100%{transform:rotate(360deg);opacity:0}}.board__decor--bg{background-size:30vmin auto;height:50%;width:70%}.l0 .board__decor--left{background-size:30vmin auto;position:absolute;clip-path:polygon(70% 35%,100% 25%,100% 70%,75% 65%);width:calc(100% + 1px);height:calc(100% + 1px);left:-100%;top:0;height:100%}.l1 .board__decor--left{background-size:30vmin auto;position:absolute;clip-path:polygon(80% 25%,100% 30%,100% 70%,85% 75%);width:calc(100% + 1px);height:calc(100% + 1px);left:-100%;top:0;height:100%}.l2 .board__decor--left{background-size:30vmin auto;position:absolute;clip-path:polygon(100% 25%,70% 35%,100% 75%);width:calc(100% + 1px);height:calc(100% + 1px);left:-100%;top:0;height:100%}.l3 .board__decor--left{background-size:30vmin auto;position:absolute;clip-path:polygon(100% 0,75% 85%,100% 100%);width:calc(100% + 1px);height:calc(100% + 1px);left:-100%;top:0;height:100%}.r0 .board__decor--right{background-size:30vmin auto;position:absolute;clip-path:polygon(70% 0%,100% 0%,100% 25%,70% 35%,75% 65%,100% 70%,100% 100%,70% 100%);width:calc(100% + 1px);height:calc(100% + 1px);right:0;top:0;height:100%}.r1 .board__decor--right{background-size:30vmin auto;position:absolute;clip-path:polygon(70% 0%,100% 0%,100% 30%,80% 25%,85% 75%,100% 70%,100% 100%,70% 100%);width:calc(100% + 1px);height:calc(100% + 1px);right:0;top:0;height:100%}.r2 .board__decor--right{background-size:30vmin auto;position:absolute;clip-path:polygon(70% 0%,100% 0%,100% 25%,70% 35%,100% 75%,100% 100%,70% 100%);width:calc(100% + 1px);height:calc(100% + 1px);right:0;top:0;height:100%}.r3 .board__decor--right{background-size:30vmin auto;position:absolute;clip-path:polygon(70% 0%,100% 0%,75% 85%,100% 100%,70% 100%);width:calc(100% + 1px);height:calc(100% + 1px);right:0;top:0;height:100%}.rEnd .board__decor--right{background-size:30vmin auto;position:absolute;clip-path:polygon(70% 0%,100% 0%,100% 100%,70% 100%);width:calc(100% + 1px);height:calc(100% + 1px);right:0;top:0;height:100%}.t0 .board__decor--top{background-size:30vmin auto;position:absolute;clip-path:polygon(35% 100%,40% 70%,70% 80%,70% 100%);width:calc(100% + 1px);height:calc(100% + 1px);left:0;top:-100%}.t1 .board__decor--top{background-size:30vmin auto;position:absolute;clip-path:polygon(0% 100%,40% 70%,70% 70%,70% 100%);width:calc(100% + 1px);height:calc(100% + 1px);left:0;top:-100%}.t2 .board__decor--top{background-size:30vmin auto;position:absolute;clip-path:polygon(0% 100%,20% 80%,70% 100%);width:calc(100% + 1px);height:calc(100% + 1px);left:0;top:-100%}.t3 .board__decor--top{background-size:30vmin auto;position:absolute;clip-path:polygon(20% 100%,20% 80%,50% 80%,70% 100%);width:calc(100% + 1px);height:calc(100% + 1px);left:0;top:-100%}.b0 .board__decor--bottom{background-size:30vmin auto;position:absolute;clip-path:polygon(0% 50%,70% 50%,70% 100%,70% 80%,40% 70%,35% 100%,0% 100%);width:calc(100% + 1px);height:calc(100% + 1px);left:0;bottom:0}.b1 .board__decor--bottom{background-size:30vmin auto;position:absolute;clip-path:polygon(0% 50%,70% 50%,70% 100%,70% 70%,40% 70%,0% 100%);width:calc(100% + 1px);height:calc(100% + 1px);left:0;bottom:0}.b2 .board__decor--bottom{background-size:30vmin auto;position:absolute;clip-path:polygon(0% 50%,70% 50%,70% 100%,20% 80%,0% 100%);width:calc(100% + 1px);height:calc(100% + 1px);left:0;bottom:0}.b3 .board__decor--bottom{background-size:30vmin auto;position:absolute;clip-path:polygon(0% 50%,70% 50%,70% 100%,50% 80%,20% 80%,20% 100%,0% 100%);width:calc(100% + 1px);height:calc(100% + 1px);left:0;bottom:0}.bEnd .board__decor--bottom{background-size:30vmin auto;position:absolute;clip-path:polygon(0% 50%,70% 50%,70% 100%,0% 100%);width:calc(100% + 1px);height:calc(100% + 1px);left:0;bottom:0}.ui{left:0;height:5vmin;pointer-events:none;position:absolute;bottom:23vmin}.ui__btn{color:#fff;cursor:pointer;display:inline-block;padding:5px 15px;pointer-events:all;transition:all .4s}.ui__btn:hover{color:#777}.ui__level{color:#fff;padding:5px 15px;font-family:Arial Black;font-size:50px;font-weight:900;pointer-events:none;text-align:left;transition:all 1s}.ui__message{color:#fff;font-family:Arial Black;font-weight:900;opacity:0;position:fixed;text-align:center;top:25vmin;width:100vw}.animation .ui__message{animation:message 1s ease-in-out}@keyframes message{0%{transform:translateY(-50%) scale(.1);opacity:0}50%{opacity:1}100%{transform:translateY(-50%) scale(6);opacity:0}}.models{display:none}</style></head>
<body><div class='navigation'><div class='navs'></div><div class='circle'></div><div class='circle circle--bottom'></div></div><div class='game-area'><div class='timer'><div class='timer__container'><div class='timer__elm timer__elm--x timer__elm--top'></div><div class='timer__elm timer__elm--y timer__elm--right'></div><div class='timer__elm timer__elm--x timer__elm--bottom'></div><div class='timer__elm timer__elm--y timer__elm--left'></div></div></div><div class='board board--target'></div><div class='board board--puzzle'></div></div><div class='ui'><div class='ui__level'></div><div class='ui__btn ui__level_up'>&#9650;</div><div class='ui__btn ui__level_down'>&#9660;</div><div class='ui__btn ui__reset'>RESET</div><div class='ui__message'></div></div><div class='models'><div class='navs__elm'></div><div class='board__decor board__decor--clue'></div><div class='board__row board__row--target' data-index='0'></div><div class='board__row board__row--puzzle' data-index='0'></div><div class='board__row board__row--board' data-index='0'><div class='board__cell board__cell--target' data-index='0' data-target='0-0'></div></div><div class='board__row board__row--puzzle' data-index='0'><div class='board__cell board__cell--puzzle' data-index='0' data-puzzle='0-0' draggable='true'><div class='board__decor board__decor--top'></div><div class='board__decor board__decor--right'></div><div class='board__decor board__decor--bottom'></div><div class='board__decor board__decor--left'></div><div class='board__decor board__decor--bg'></div></div></div></div></body>
<script>var selectors={gameArea:"game-area",cell:"board__cell",target:"board__cell--target",puzzle:"board__cell--puzzle",board:"board",boardTarget:"board--target",boardPuzzle:"board--puzzle",boardRow:"board__row--target",puzzleRow:"board__row--puzzle",clue:"board__decor--clue",navs:"navs",navsElment:"navs__elm",circle:"circle",ui:{reset:"ui__reset",level:"ui__level",timer:"timer__elm",timerX:"timer__elm--x",message:"ui__message",lvlUp:"ui__level_up",lvlDown:"ui__level_down"}},dimensions={size:30,unit:'vmin'},board=document.getElementsByClassName(selectors.boardTarget)[0],boardPuzzle=document.getElementsByClassName(selectors.boardPuzzle)[0],clue=document.getElementsByClassName(selectors.clue)[0],circles=Array.from(document.getElementsByClassName(selectors.circle)),containerNavs=document.getElementsByClassName(selectors.navs)[0],combinations=3.99,dificulty=99,filters=['invert','sepia','saturate'],gameArea=document.getElementsByClassName(selectors.gameArea)[0],matrix=[],messageBox=document.getElementsByClassName(selectors.ui.message)[0],modelRowTarget=document.getElementsByClassName(selectors.boardRow)[0],modelRowPuzzle=document.getElementsByClassName(selectors.puzzleRow)[0],puzzles=[],targets=[],timers=Array.from(document.getElementsByClassName(selectors.ui.timer)),state={level:window.localStorage.getItem('lvl')?Number(window.localStorage.getItem('lvl')):1,prevLevel:null,topLevel:window.localStorage.getItem('topLvl')?Number(window.localStorage.getItem('topLvl')):1,filter:0,timer:dificulty};init();setupUI();addNavs();onDrop(boardPuzzle);timerStart();function init(){setDifficultyLevel(state.level);targets=Array.from(gameArea.getElementsByClassName(selectors.target));puzzles=Array.from(gameArea.getElementsByClassName(selectors.puzzle));updateDataAttributes(targets);updateDataAttributes(puzzles);randomMatrix();stylePuzzles();showClue();addEventListeners();displayLevel();reset();state.prevLevel=state.level}
function setupUI(){document.getElementsByClassName(selectors.ui.reset)[0].onclick=_=>{updateMessage(`RESET`);reset()}
document.getElementsByClassName(selectors.ui.lvlUp)[0].onclick=_=>{btnsOnclick(1)}
document.getElementsByClassName(selectors.ui.lvlDown)[0].onclick=_=>{btnsOnclick(-1)}
displayLevel()}
function btnsOnclick(modifier){let level=state.level+modifier;if(level<1||level>5||level>state.topLevel)return;setLevel(level);reset()}
function reset(){randomFilter();updateGlobalModifier('animation');state.timer=dificulty+3;puzzles.forEach(puzzle=>{boardPuzzle.appendChild(puzzle);boardPuzzle.style.opacity=1});composeAnimation(0,1);composeAnimation(1000,1);composeAnimation(2000,1);composeAnimation(3000);setTimeout(_=>{state.timer=dificulty+1;updateGlobalModifier('animation','remove')},3000)}
function displayLevel(){document.getElementsByClassName(selectors.ui.level)[0].textContent=`LVL ${state.level}`}
function timerStart(){setInterval(_=>{timers.forEach(timer=>{let size=(100+1/dificulty*100)*(1-state.timer/dificulty);if(size>=100||state.timer>dificulty)size=0;if(timer.classList.contains(selectors.ui.timerX)){timer.style.width=`${size}%`}else{timer.style.height=`${size}%`}});if(state.timer>0){state.timer--}else{updateMessage(`TIMEOUT`);reset()}},1000)}
function setDifficultyLevel(level){updateGlobalModifier(`lvl-${level}`);cloneElement(selectors.boardRow,selectors.target,level);cloneElement(selectors.puzzleRow,selectors.puzzle,level);cloneElement(selectors.boardTarget,selectors.boardRow,level);cloneElement(selectors.boardPuzzle,selectors.puzzleRow,level);dificulty=Math.pow(state.level,2)*15}
function showClue(){let newClue=clue.cloneNode(!0);board.appendChild(newClue)}
function updateGlobalModifier(modifier,action='add'){if(action==='add')document.body.classList.add(modifier);if(action==='remove')document.body.classList.remove(modifier)}
function cloneElement(container,element,level){let targetContainer=document.getElementsByClassName(container)[0],targetElement=document.getElementsByClassName(element)[0];for(let i=0;i<=level;i++){let newElement=targetElement.cloneNode(!0);newElement.dataset.index=i;targetContainer.appendChild(newElement)}}
function updateDataAttributes(elements){elements.forEach((element,i)=>{let data=`${element.parentNode.dataset.index}-${i%(state.level + 1)}`;if(element.dataset.target)element.dataset.target=data;else element.dataset.puzzle=data})}
function randomizePuzzlesPosition(){let positions=[],rowLength=Math.sqrt(puzzles.length);for(let i=0,iMax=puzzles.length;i<iMax;i++)positions.push(i);positions=positions.sort(_=>.5-Math.random()).reverse();puzzles.forEach((puzzle,index)=>{puzzle.style.left=`${(100/rowLength)*(positions[index]%rowLength) + 5}%`;puzzle.style.top=`${(100/rowLength)*(Math.floor(positions[index]/rowLength))}%`})}
function clearInnerHtml(elm){while(elm.hasChildNodes()){elm.removeChild(elm.firstChild)}}
function setLevel(level){updateMessage(`LEVEL ${level}`);updateGlobalModifier(`lvl-${state.prevLevel}`,'remove');clearInnerHtml(board);clearInnerHtml(boardPuzzle);clearInnerHtml(modelRowTarget);clearInnerHtml(modelRowPuzzle);window.localStorage.setItem('lvl',level);if(level>state.topLevel){state.topLevel=level;window.localStorage.setItem('topLvl',level)}
state.prevLevel=level;state.level=level;targets=[];puzzles=[];matrix=[];init()}
function updateMessage(msg){messageBox.textContent=msg}
function addNavs(){let element=document.getElementsByClassName(selectors.navsElment)[0],modifier=`${selectors.navsElment}--side`;for(let i=0;i<360;i+=5){let newElement=element.cloneNode(!0),content=i==0?`E`:i==90?`N`:i==180?`W`:i==270?`S`:i;if(i==0||i==90||i==180||i==270)newElement.classList.add(modifier);newElement.textContent=content;containerNavs.appendChild(newElement)}}
function randomMatrix(){let length=Math.sqrt(targets.length);for(let y=0;y<length-1;y++){matrix.push(createMatrixRow(length))}
matrix.push(createMatrixRow(length,!0))}
function createMatrixRow(length,last){let row=[];for(let x=0;x<length-1;x++){row.push([Math.floor(Math.random()*combinations),last?'End':Math.floor(Math.random()*combinations)])}
row.push(['End',last?'End':Math.floor(Math.random()*combinations)]);return row}
function checkMatchOnDrop(target,puzzleData){let checkFailed=puzzles.some(puzzle=>{return puzzle.parentNode.dataset.target!==puzzle.dataset.puzzle});if(checkFailed)return;else setLevel(state.level+1)}
function stylePuzzles(){puzzles.forEach(elm=>{let data=elm.dataset.puzzle.split('-'),row=data[0],cell=data[1],decors=elm.children;elm.classList.add(`r${matrix[row][cell][0]}`);elm.classList.add(`b${matrix[row][cell][1]}`);if(cell>0)elm.classList.add(`l${matrix[row][cell - 1][0]}`);if(row>0)elm.classList.add(`t${matrix[row - 1][cell][1]}`);let bgHorizontal=(-cell*dimensions.size/(state.level+1))+dimensions.unit,bgHorizontalPrev=(-(cell-1)*dimensions.size/(state.level+1))+dimensions.unit,bgVertical=(-row*dimensions.size/(state.level+1))+dimensions.unit,bgVerticalPrev=(-(row-1)*dimensions.size/(state.level+1))+dimensions.unit;decors[0].style.backgroundPosition=`${bgHorizontal} ${bgVerticalPrev}`;decors[1].style.backgroundPosition=`${bgHorizontal} ${bgVertical}`;decors[2].style.backgroundPosition=`${bgHorizontal} ${bgVertical}`;decors[3].style.backgroundPosition=`${bgHorizontalPrev} ${bgVertical}`;decors[4].style.backgroundPosition=`${bgHorizontal} ${bgVertical}`})}
function randomFilter(){let cyrrentClue=document.getElementsByClassName(selectors.clue)[0],firstFilter=`${filters[state.filter]}(${Math.floor(Math.random()*30) + 70}%)`,secondFilterIndex=(state.filter===1||state.filter>1)?0:state.filter+1,secondFilter=`${filters[secondFilterIndex]}(${Math.floor(Math.random()*30) + 70}%)`,composedFilter=firstFilter+secondFilter,elements=puzzles.concat(circles);elements.push(cyrrentClue);elements.forEach(puzzle=>{puzzle.style.filter=composedFilter;puzzle.style.WebkitFilter=composedFilter});state.filter++;if(state.filter>2)state.filter=0}
function animateNavigation(horizontal,opacity=0,rotate=0){let currentClue=document.getElementsByClassName(selectors.clue)[0];containerNavs.style.transform=`translateX(${horizontal}%)`;currentClue.style.opacity=opacity;currentClue.style.transform=`rotate(${rotate}deg)`}
function composeAnimation(timeout,opacity=0){setTimeout(_=>{let randomDeg=Math.floor(Math.random()*100);randomizePuzzlesPosition();animateNavigation(-randomDeg*.7,opacity,randomDeg*3.6)},timeout)}
function onDrag(elm){elm.addEventListener("dragstart",e=>{elm.style.cssText+="transform: scale(.95)";setTimeout(_=>{elm.style.cssText+="transform: scale(1)"},0);e.dataTransfer.setData("text",e.target.id);e.dataTransfer.setData("puzzle",e.target.dataset.puzzle)})}
function onDrop(elm){elm.addEventListener("dragover",e=>{e.preventDefault()});elm.addEventListener("drop",e=>{let data=e.dataTransfer.getData("puzzle"),puzzle=document.querySelector(`[data-puzzle="${data}"]`);e.preventDefault();if(!checkDropAreas(e.target))return;e.target.appendChild(puzzle);animateNavigation(-Math.floor(Math.random()*70));checkMatchOnDrop()})}
function addEventListeners(){puzzles.forEach(puzzle=>{onDrag(puzzle)});targets.forEach(target=>{onDrop(target)})}
function checkDropAreas(elm){if((elm.classList.contains(selectors.target)&&!elm.hasChildNodes())||elm.classList.contains(selectors.boardPuzzle)||elm.classList.contains(selectors.puzzleRow))return!0;else return!1}</script></html>