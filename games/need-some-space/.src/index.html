<!doctype html><html><head><meta charset="utf-8"></head><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" /><body><script>(function(){"use strict";const now=()=>performance.now();const loop=(func,time)=>{let prev=now();const next=time?fn=>setTimeout(fn,time):requestAnimationFrame;const frame=()=>{const current=now();const delta=(current-prev)/1e3;func(delta);next(frame);prev=current};frame()};const $=function $(selector,scope){if(!(this instanceof $)){return new $(selector,scope)}switch(typeof selector){case Array.isArray(selector)&&"object":case selector instanceof NodeList&&"object":return this.push(...selector);case"object":return this.push(selector);case"string":return this.find(selector,scope)}};$.prototype={push:function(...args){[].push.apply(this,args);return this},find:function(selector,scope){scope=scope||this[0]||document||documentElement;return this.push(...scope.querySelectorAll(selector))},each:function(iterator){[].forEach.call(this,iterator);return this},on:function(type,listener){return this.each((elem=>elem.addEventListener(type,listener.bind(elem))))},attr:function(...args){const[name,value]=args;if(this.length>0&&args.length===1){return this[0][name]}else if(args.length===2){this.each((elem=>elem[name]=value))}return this},html:function(...args){return this.attr(...["innerHTML",...args])},css:function(name,value){if(typeof name==="object"){Object.keys(name).forEach((key=>this.css(key,name[key])));return this}return this.each((elem=>elem.style[name]=value))},appendTo:function(parent){return this.each((node=>parent.appendChild(node)))}};class Vector{constructor(x=0,y=0){this.set(x,y)}set(x,y){this.x=assertNumber(x);this.y=assertNumber(y);return this}min(value){return this.length(Math.max(value,this.length()))}max(value){return this.length(Math.min(value,this.length()))}add(vector){return this.set(this.x+vector.x,this.y+vector.y)}subtract(vector){return this.set(this.x-vector.x,this.y-vector.y)}multiply(factor){return this.set(this.x*factor,this.y*factor)}divide(divisor){return this.set(this.x/divisor,this.y/divisor)}angle(value){if(value!=null){const length=this.length();return this.set(Math.sin(value),Math.cos(value)).multiply(length)}return Math.atan2(this.x,this.y)}length(value){if(value!=null){const angle=this.angle();return this.set(Math.sin(angle),Math.cos(angle)).multiply(value)}return Math.sqrt(this.x**2+this.y**2)}normalize(){const len=this.length();return len?this.divide(len):this}rotate(){return this.set(-this.y,this.x)}dot(vector){vector=vector||this;return this.x*vector.x+this.y*vector.y}clone(){return new Vector(this.x,this.y)}}function assertNumber(n){if(isNaN(n)===true){throw new Error("NaN in Vect")}if(isFinite(n)===false){throw new Error("Infinity in Vect")}return Math.round(n*1e6)/1e6}const COMMANDS=/\s*([MLHVCSQTAEZ][\s,-\d\.]*)/gi;const ABSOLUTE=/[A-Z]/;const VALUES=/(-?\d+(\.\d+(e-?\d)?)?)/g;const COMMAS=/,/g;const parse=cmd=>(cmd.match(VALUES)||[]).map(parseFloat);const canvasPath=(ctx,pathString)=>{let x=0;let y=0;let cp1={x:x,y:y};let cp2={x:x,y:y};if(Array.isArray(pathString)){return canvasPath(ctx,pathString.join())}if(typeof pathString=="string"){ctx.beginPath();pathString.replace(COMMAS," ").split(COMMANDS).forEach((cmd=>{const[a,b,c,d,e,f,g,h]=parse(cmd||"");const isAbsolute=ABSOLUTE.test(cmd);switch((cmd[0]||"").toUpperCase()){case"M":x=isAbsolute?a:x+a;y=isAbsolute?b:y+b;ctx.moveTo(x,y);break;case"L":x=isAbsolute?a:x+a;y=isAbsolute?b:y+b;ctx.lineTo(x,y);break;case"H":x=isAbsolute?a:x+a;ctx.lineTo(x,y);break;case"V":y=isAbsolute?a:y+a;ctx.lineTo(x,y);break;case"C":cp1.type="C";cp1.x=isAbsolute?a:x+a;cp1.y=isAbsolute?b:y+b;cp2.type="C";cp2.x=isAbsolute?c:x+c;cp2.y=isAbsolute?d:y+d;x=isAbsolute?e:x+e;y=isAbsolute?f:y+f;ctx.bezierCurveTo(cp1.x,cp1.y,cp2.x,cp2.y,x,y);break;case"S":cp1.type="C";cp1.x=cp2.type==="C"?cp2.x:x;cp1.y=cp2.type==="C"?cp2.y:y;cp2.type="C";cp2.x=isAbsolute?a:x+a;cp2.y=isAbsolute?b:y+b;x=isAbsolute?c:x+c;y=isAbsolute?d:y+d;ctx.bezierCurveTo(cp1.x,cp1.y,cp2.x,cp2.y,x,y);break;case"Q":cp1.type="Q";cp1.x=isAbsolute?a:x+a;cp1.y=isAbsolute?b:y+b;x=isAbsolute?c:x+c;y=isAbsolute?d:y+d;ctx.quadraticCurveTo(cp1.x,cp1.y,x,y);break;case"T":cp1.type="Q";cp1.x=cp1.type==="Q"?cp1.x:x;cp1.y=cp1.type==="Q"?cp1.y:y;x=isAbsolute?a:x+a;y=isAbsolute?b:y+b;ctx.quadraticCurveTo(cp1.x,cp1.y,x,y);break;case"A":break;case"E":x=isAbsolute?a:x+a;y=isAbsolute?b:y+b;ctx.ellipse(x,y,c,d,e,f,g,h);break;case"Z":ctx.closePath();break}}))}};const Attr=game=>{const width=window.innerWidth;const height=window.innerHeight;const position=new Vector(0,0);const velocity=new Vector;const friction=new Vector;const acceleration=new Vector;const viewport=new Vector(-width/2,-height/2);game.attr={width:width,height:height,position:position,velocity:velocity,friction:friction,acceleration:acceleration,direction:-Math.PI/2,thrust:0,hitpoints:5,viewport:viewport,destroyed:true};game.on("collision",(pos=>{game.attr.hitpoints-=1;if(game.attr.hitpoints<=0){game.emit("destroyed")}}));game.on("destroyed",(pos=>{game.attr.destroyed=true;game.attr.thrust=0}));game.on("reset",(()=>{game.attr.destroyed=false;game.attr.thrust=0;game.attr.hitpoints=5;game.attr.direction=-Math.PI/2;game.attr.position.set(0,0);game.attr.viewport.set(-width/2,-height/2)}));return{engine:game=>{const time=game.timing.engine;const mouse=game.attr.mouse.clone().subtract(position).add(viewport);game.attr.direction=mouse.angle();if(game.attr.destroyed){acceleration.set(0,0)}else{acceleration.length(game.attr.thrust).angle(game.attr.direction).multiply(-1)}if(game.attr.thrust){velocity.add(acceleration.clone().multiply(time)).max(1e3)}else{friction.set(-velocity.x,-velocity.y).divide(100);velocity.add(friction)}const distance=velocity.clone().multiply(time);position.add(distance);viewport.add(distance)},render:game=>{if(!game.debug){return}const ctx=game.stage.ctx;game.attr.direction;const pos=game.attr.position.clone().subtract(game.attr.viewport);const vel=game.attr.velocity;const acc=game.attr.acceleration;ctx.save();ctx.lineWidth=8;ctx.lineCap="round";canvasPath(ctx,["M",pos.x,pos.y,"l",vel.x,vel.y,"Z"]);ctx.strokeStyle="rgba(0,255,0,.5)";ctx.stroke();canvasPath(ctx,["M",pos.x,pos.y,"l",acc.x,acc.y,"Z"]);ctx.strokeStyle="rgba(255,0,0,.5)";ctx.stroke();ctx.restore()}}};const Canvas=(width,height,parent)=>{const canvas=document.createElement("canvas");const ctx=canvas.getContext("2d");canvas.width=width;canvas.height=height;if(parent){parent.appendChild(canvas)}return{canvas:canvas,ctx:ctx}};const Stage=game=>{$("body").css({background:"#0a0b3d",margin:0,padding:0});const width=window.innerWidth;const height=window.innerHeight;const{canvas:canvas,ctx:ctx}=Canvas(width,height,document.body);$(canvas).css("cursor","crosshair");game.stage={canvas:canvas,ctx:ctx,width:width,height:height};return{engine:()=>{},render:()=>{ctx.clearRect(0,0,width,height)}}};const Mouse=game=>{game.attr.thrust=0;game.attr.mouse=new Vector;const move=ev=>{game.attr.mouse.set(ev.pageX,ev.pageY)};const accel=ev=>{move(ev);if(!game.attr.destroyed){game.attr.thrust=500}};const decel=ev=>{move(ev);game.attr.thrust=0};$(game.stage.canvas).on("mousedown",accel).on("mousemove",move).on("mouseup",decel);return{}};const Emitter=game=>{const listeners=new Map;game.on=(type,handler)=>{if(!listeners.has(type)){listeners.set(type,[])}listeners.get(type).push(handler);return()=>game.off(type,handler)};game.off=(type,handler)=>{if(!listeners.has(type)){return}const filtered=listeners.get(type).filter((listener=>listener!==handler));listeners.set(type,filtered)};game.emit=(type,data)=>{if(!listeners.has(type)){return}listeners.get(type).forEach((listener=>listener&&listener(data)))};return{}};const Title=game=>{const{width:width,height:height}=game.attr;const{canvas:canvas,ctx:ctx}=Canvas(width,height);const x=width/2;const y=height/2;const title="Need some space.";ctx.font="48px monospace";ctx.textAlign="center";ctx.textBaseline="middle";ctx.lineWidth=2;ctx.strokeStyle="#000000";ctx.strokeText(title,x,y);ctx.fillStyle="#bbb5f1";ctx.fillText(title,x,y);let started=null;let progress=null;let duration=3;const start=time=>{started=time;progress=0};const stop=()=>{started=null;game.emit("reset")};return{engine:game=>{game.timing.engine;const clock=game.timing.clock;if(started){progress=(clock-started)/duration;if(progress>=1){stop()}}else if(game.attr.destroyed&&!started){start(clock)}},render:game=>{const ctx=game.stage.ctx;if(game.attr.destroyed){ctx.save();ctx.rect(0,0,width,height);ctx.fillStyle=`rgba(10,11,61,${progress})`;ctx.fill();ctx.globalAlpha=progress;ctx.drawImage(canvas,0,0,width,height);ctx.restore()}}}};var Prando=function(){function Prando(seed){this._value=NaN;if(typeof seed==="string"){this._seed=this.hashCode(seed)}else if(typeof seed==="number"){this._seed=this.getSafeSeed(seed)}else{this._seed=this.getSafeSeed(Prando.MIN+Math.floor((Prando.MAX-Prando.MIN)*Math.random()))}this.reset()}Prando.prototype.next=function(min,pseudoMax){if(min===void 0){min=0}if(pseudoMax===void 0){pseudoMax=1}this.recalculate();return this.map(this._value,Prando.MIN,Prando.MAX,min,pseudoMax)};Prando.prototype.nextInt=function(min,max){if(min===void 0){min=10}if(max===void 0){max=100}this.recalculate();return Math.floor(this.map(this._value,Prando.MIN,Prando.MAX,min,max+1))};Prando.prototype.nextString=function(length,chars){if(length===void 0){length=16}if(chars===void 0){chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"}var str="";while(str.length<length){str+=this.nextChar(chars)}return str};Prando.prototype.nextChar=function(chars){if(chars===void 0){chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"}return chars.substr(this.nextInt(0,chars.length-1),1)};Prando.prototype.nextArrayItem=function(array){return array[this.nextInt(0,array.length-1)]};Prando.prototype.nextBoolean=function(){this.recalculate();return this._value>.5};Prando.prototype.skip=function(iterations){if(iterations===void 0){iterations=1}while(iterations-- >0){this.recalculate()}};Prando.prototype.reset=function(){this._value=this._seed};Prando.prototype.recalculate=function(){this._value=this.xorshift(this._value)};Prando.prototype.xorshift=function(value){value^=value<<13;value^=value>>17;value^=value<<5;return value};Prando.prototype.map=function(val,minFrom,maxFrom,minTo,maxTo){return(val-minFrom)/(maxFrom-minFrom)*(maxTo-minTo)+minTo};Prando.prototype.hashCode=function(str){var hash=0;if(str){var l=str.length;for(var i=0;i<l;i++){hash=(hash<<5)-hash+str.charCodeAt(i);hash|=0;hash=this.xorshift(hash)}}return this.getSafeSeed(hash)};Prando.prototype.getSafeSeed=function(seed){if(seed===0)return 1;return seed};Prando.MIN=-2147483648;Prando.MAX=2147483647;return Prando}();const rng=new Prando("4TNwT:kzWc76yLgW");const random=(num1=100,num2=0)=>{const min=Math.min(num1,num2);const max=Math.max(num1,num2);return Math.round(rng.next()*(max-min))+min};const Starfield=(width,height,distance=0)=>{const count=Math.sqrt(width*height)/4;let x=0;let y=0;const{canvas:canvas,ctx:ctx}=Canvas(width,height);for(let i=0;i<count;i++){ctx.beginPath();const radius=Math.random()*1.2;ctx.arc(random(width),random(height),radius,0,2*Math.PI,false);ctx.fillStyle=`hsl(${[0,60,240][i%3]},${random(50,100)}%,85%)`;ctx.fill()}return{engine:game=>{const pos=game.attr.position.clone().multiply(distance);x=pos.x%width;y=pos.y%height},render:game=>{const ctx=game.stage.ctx;[-x,(x<0?-width:+width)-x].forEach((x=>{[-y,(y<0?-height:+height)-y].forEach((y=>{ctx.drawImage(canvas,x,y,width,height)}))}))}}};const Spaceship=()=>{const w=30;const h=40;const r=4;const{canvas:canvas,ctx:ctx}=Canvas(w,h);canvasPath(ctx,["M",w/2,0,"L",w,h,"L",w/2,h*3/4,"L",0,h,"L",w/2,0,"Z","M",w/2,h/2-r].join());ctx.fillStyle="rgba(255,255,255,.85)";ctx.fill("evenodd");ctx.strokeStyle="#FFF";ctx.stroke();return{engine:game=>{},render:game=>{if(game.attr.destroyed){return}const ctx=game.stage.ctx;const pos=game.attr.position.clone().subtract(game.attr.viewport);ctx.save();ctx.translate(pos.x,pos.y);ctx.rotate(-game.attr.direction);ctx.drawImage(canvas,-w/2,-h/2,w,h);ctx.restore()}}};const Thruster=()=>{let w=12;let h=24;let wu=w/4;let hu=h/3;const{canvas:canvas,ctx:ctx}=Canvas(w,h);canvasPath(ctx,["M",1*wu,0*hu,"L",0*wu,2*hu,"L",1*wu,1*hu,"L",2*wu,3*hu,"L",3*wu,1*hu,"L",4*wu,2*hu,"L",3*wu,0*hu,"Z"].join());ctx.fillStyle="rgba(255,127,127,1)";ctx.fill();let angle=Math.PI;return{engine:game=>{angle=game.attr.direction},render:game=>{if(game.attr.thrust&&!game.attr.destroyed){const ctx=game.stage.ctx;const pos=game.attr.position.clone().subtract(game.attr.viewport);ctx.save();ctx.translate(pos.x,pos.y);ctx.rotate(-angle);ctx.drawImage(canvas,-w/2,+h,w,h);ctx.restore()}}}};const COORDS=[[5,5],[0,9],[0,8],[1,9],[0,7],[1,8],[2,9],[3,9],[2,8],[1,7],[0,6],[0,5],[1,6],[2,7],[3,8],[4,9],[5,9],[4,8],[3,7],[2,6],[1,5],[0,4],[0,3],[1,4],[2,5],[3,6],[4,7],[5,8],[6,9]];const COLOR_FILL="rgba(100,100,132,.95)";const COLOR_STROKE="rgba(100,100,132,.5)";const COLOR_ACTIVE="rgba(255,255,127,.5)";const COLOR_ALERT="rgba(255,127,127,.75)";const Terrain=(w,h)=>{const wu=250;const hu=100;const offset_x=-w/2;const offset_y=-h/2;const values=[0,1,2,3,4,5];const count=500;let v=0;for(let i=0;i<=count;i++){v=random(COORDS.length);v=Math.max(v,1);v=Math.min(v,COORDS.length-1);values.push(v)}const upper=[];const lower=[];values.forEach(((val,i)=>{const[a,b]=COORDS[val];upper.push({x:i*wu+offset_x,y:a*hu+offset_y});lower.push({x:i*wu+offset_x,y:b*hu+offset_y})}));const radius=16;const top={};const bot={};return{engine:game=>{const pos=game.attr.position;const index_min=Math.floor((pos.x-offset_x)/wu);const index_max=Math.ceil((pos.x-offset_x)/wu);const top_left=upper[index_min]||{};const top_right=upper[index_max]||{};const bot_left=lower[index_min]||{};const bot_right=lower[index_max]||{};let dy1=top_right.y-top_left.y;let dx1=top_right.x-top_left.x;let m1=dy1/dx1;let i1=top_right.y-m1*top_right.x;top.x=pos.x;top.y=m1*pos.x+i1;top.collision=pos.y-radius<top.y;let dy2=bot_right.y-bot_left.y;let dx2=bot_right.x-bot_left.x;let m2=dy2/dx2;let i2=bot_right.y-m2*bot_right.x;bot.x=pos.x;bot.y=m2*pos.x+i2;bot.collision=pos.y+radius>bot.y;if(game.attr.hitpoints>0){if(top.collision||bot.collision){game.emit("collision",pos.clone())}}},render:game=>{const ctx=game.stage.ctx;ctx.save();const view=game.attr.viewport;ctx.translate(-view.x,-view.y);ctx.lineWidth=24;ctx.lineJoin="round";ctx.lineCap="round";canvasPath(ctx,["M",upper[0].x,-h,...upper.map((pos=>["L",pos.x,pos.y])),"L",upper[upper.length-1].x,-h,"Z"]);ctx.strokeStyle=COLOR_STROKE;ctx.stroke();ctx.fillStyle=COLOR_FILL;ctx.fill();canvasPath(ctx,["M",lower[0].x,+h,...lower.map((pos=>["L",pos.x,pos.y])),"L",lower[lower.length-1].x,+h,"Z"]);ctx.strokeStyle=COLOR_STROKE;ctx.stroke();ctx.fillStyle=COLOR_FILL;ctx.fill();if(game.debug){ctx.lineWidth=8;game.attr.position;canvasPath(ctx,["M",top.x,top.y,"E",top.x,top.y,10,10,0,0,2*Math.PI,false]);ctx.fillStyle=top.collision?COLOR_ALERT:COLOR_ACTIVE;ctx.fill();canvasPath(ctx,["M",bot.x,bot.y,"E",bot.x,bot.y,10,10,0,0,2*Math.PI,false]);ctx.fillStyle=bot.collision?COLOR_ALERT:COLOR_ACTIVE;ctx.fill()}ctx.restore()}}};const Explosion=()=>{const count=48;const radius=2;const duration=3;const colors=["#A10100","#DA1F05","#F33C04","#FE650D","#FFC11F","#FFF75D"];let particles=[];let started=null;const start=(time,position)=>{started=time;for(let i=0;i<count;i++){let pos=position.clone();let vel=pos.clone();vel.length(random(50,100));vel.angle(Math.random()*2*Math.PI);particles.push({pos:position.clone(),vel:position.clone().length(random(200,400)).angle(Math.random()*2*Math.PI),clr:colors[random(colors.length-1)],r:radius});particles.push({pos:position.clone(),vel:position.clone().length(random(800,1600)).angle(Math.random()*2*Math.PI),clr:"#FFFFFF",r:radius})}};const stop=()=>{particles=[];started=null};return{engine:game=>{const time=game.timing.engine;const clock=game.timing.clock;if(started){const progress=(clock-started)/duration;particles.forEach((particle=>{particle.pos.add(particle.vel.clone().multiply(time));particle.r=(1-progress)*radius}));if(progress>=1){stop()}}else if(game.attr.destroyed&&!started){start(game.timing.clock,game.attr.position)}},render:game=>{const ctx=game.stage.ctx;if(started){particles.forEach((({pos:pos,r:r,clr:clr})=>{ctx.beginPath();const{x:x,y:y}=pos.clone().subtract(game.attr.viewport);ctx.arc(x,y,r,0,2*Math.PI,false);ctx.fillStyle=clr;ctx.fill()}))}}}};const Intro=game=>{const width=game.stage.width;const height=game.stage.height;const sprites=[Starfield(width,height,.25),Starfield(width,height,.375),Starfield(width,height,.5),Terrain(width,height),Spaceship(),Thruster(),Explosion()];return{engine:({doGameEngine:doGameEngine})=>{sprites.forEach(doGameEngine)},render:({doGameRender:doGameRender})=>{sprites.forEach(doGameRender)}}};const Game=()=>{const timing={clock:0,engine:0,render:0};let paused=false;const doGameEngine=item=>item?.engine&&item?.engine(game);const doGameRender=item=>item?.render&&item?.render(game);const game={timing:timing,pause:bool=>bool==null?paused:paused=!!bool,doGameEngine:doGameEngine,engine:tick=>{if(paused){return}timing.clock+=tick;timing.engine=tick;controls.forEach(doGameEngine);doGameEngine(game.scene);overlays.forEach(doGameEngine)},doGameRender:doGameRender,render:tick=>{if(paused){return}timing.render=tick;controls.forEach(doGameRender);doGameRender(game.scene);overlays.forEach(doGameRender)}};const controls=[Emitter(game),Stage(game),Attr(game),Mouse(game)];const overlays=[Title(game)];game.scene=Intro(game);return game};function main(){const game=Game();loop(game.engine,1e3/200);loop(game.render)}main()})();
</script></body></html>