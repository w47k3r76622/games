var Tetris=function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){const n=i(2);t.exports=n.app},function(t,e,i){"use strict";function n(t){const e=document.createElement("canvas");let i=this.ctx=e.getContext("2d");e.width=this.width=320,e.height=this.height=180,t.appendChild(e),s(t,e,i),window.addEventListener("resize",()=>{s(t,e,i)})}function s(t,e,i){const n=t.getBoundingClientRect();let s=n.width,r=s/(16/9);n.height<r&&(r=n.height,s=r*(16/9)),e.style.width=s+"px",e.style.height=r+"px",i.imageSmoothingEnabled=!1}function r(t,e){let i=t.ctx,n=0,s=0;this.fill=t=>{i.fillStyle=t},this.clear=()=>{i.clearRect(0,0,320,180)},this.fr=(t,e,n,s)=>{i.fillRect(t,e,n,s)},this.camera=(t=0,e=0)=>{n=t,s=e},this.sspr=(t,r,a,o,l,h,f=a,c=o,d=!1)=>{l=Math.floor(l-n),h=Math.floor(h-s),d&&(i.scale(-1,1),l*=-1,l-=f),i.drawImage(e,t,r,a,o,l,h,f,c),i.setTransform(1,0,0,1,0,0)}}function a(t){this.start=e=>{let i=new Image;i.onload=()=>{e(i)},i.src=t}}i.r(e),i.d(e,"app",(function(){return B}));var o=function(){var t,e,i,n,s,r=function(t){return Math.sin(6.283184*t)},a=function(t){return.003959503758*Math.pow(2,(t-128)/12)},o=function(t,e,i){var n,s,r,o,h,f,c,d=l[t.i[0]],u=t.i[1],p=t.i[3],w=l[t.i[4]],x=t.i[5],y=t.i[8],M=t.i[9],g=t.i[10]*t.i[10]*4,b=t.i[11]*t.i[11]*4,m=t.i[12]*t.i[12]*4,v=1/m,k=t.i[13],j=i*Math.pow(2,2-t.i[14]),L=new Int32Array(g+b+m),O=0,P=0;for(n=0,s=0;n<g+b+m;n++,s++)s>=0&&(s-=j,f=a(e+(15&(k=k>>8|(255&k)<<4))+t.i[2]-128),c=a(e+(15&k)+t.i[6]-128)*(1+8e-4*t.i[7])),r=1,n<g?r=n/g:n>=g+b&&(r-=(n-g-b)*v),o=f,p&&(o*=r*r),h=d(O+=o)*u,o=c,y&&(o*=r*r),h+=w(P+=o)*x,M&&(h+=(2*Math.random()-1)*M),L[n]=80*h*r|0;return L},l=[r,function(t){return t%1<.5?1:-1},function(t){return t%1*2-1},function(t){var e=t%1*4;return e<2?e-1:3-e}];this.init=function(r){t=r,e=r.endPattern,i=0,n=r.rowLen*r.patternLen*(e+1)*2,s=new Int32Array(n)},this.generate=function(){var a,h,f,c,d,u,p,w,x,y,M,g,b,m,v=new Int32Array(n),k=t.songData[i],j=t.rowLen,L=t.patternLen,O=0,P=0,A=!1,S=[];for(f=0;f<=e;++f)for(p=k.p[f],c=0;c<L;++c){var C=p?k.c[p-1].f[c]:0;C&&(k.i[C-1]=k.c[p-1].f[c+L]||0,C<16&&(S=[]));var I=l[k.i[15]],E=k.i[16]/512,D=Math.pow(2,k.i[17]-9)/j,_=k.i[18],T=k.i[19],R=43.23529*k.i[20]*3.141592/44100,G=1-k.i[21]/255,q=1e-5*k.i[22],B=k.i[23]/32,F=k.i[24]/512,K=6.283184*Math.pow(2,k.i[25]-9)/j,U=k.i[26]/255,W=k.i[27]*j&-2;for(M=(f*L+c)*j,d=0;d<4;++d)if(u=p?k.c[p-1].n[c+d*L]:0){S[u]||(S[u]=o(k,u,j));var $=S[u];for(h=0,a=2*M;h<$.length;h++,a+=2)v[a]+=$[h]}for(h=0;h<j;h++)(y=v[w=2*(M+h)])||A?(g=R,_&&(g*=I(D*w)*E+.5),P+=(g=1.5*Math.sin(g))*(b=G*(y-P)-(O+=g*P)),y=3==T?P:1==T?b:O,q&&(y=(y*=q)<1?y>-1?r(.25*y):-1:1,y/=q),A=(y*=B)*y>1e-5,m=y*(1-(x=Math.sin(K*w)*F+.5)),y*=x):m=0,w>=W&&(m+=v[w-W+1]*U,y+=v[w-W]*U),v[w]=0|m,v[w+1]=0|y,s[w]+=0|m,s[w+1]+=0|y}return++i/t.numChannels},this.createWave=function(){var t=44+2*n-8,e=t-36,i=new Uint8Array(44+2*n);i.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var r=0,a=44;r<n;++r){var o=s[r];o=o<-32767?-32767:o>32767?32767:o,i[a++]=255&o,i[a++]=o>>8&255}return i},this.getData=function(t,e){for(var i=2*Math.floor(44100*t),n=new Array(e),r=0;r<2*e;r+=1){var a=i+r;n[r]=t>0&&a<s.length?s[a]/32768:0}return n}};function l(){let t=new AudioContext,e=t.createGain();e.connect(t.destination);const i={};this.generate=e=>(e.forEach((e,n)=>{let s=new o;s.init(e),function e(){if(1===s.generate()){let e=s.createWave().buffer;t.decodeAudioData(e,t=>{i[n]=t})}else setTimeout(e,0)}()}),new Promise(t=>{!function n(){Object.keys(i).length!==e.length?setTimeout(n,100):t()}()})),this.sfx=(n,s=.5,r=1,a=0,o=!1)=>{const l=i[n];if(!l)return null;let h=t.createBufferSource(),f=t.createGain(),c=t.createStereoPanner();return h.buffer=l,h.connect(c),c.connect(f),f.connect(e),h.playbackRate.value=r,h.loop=o,f.gain.value=s,c.pan.value=a,h.start(),{volume:f,sound:h}}}let h=t=>({songData:[{i:[3,255,138,0,0,255,115,0,0,15,2,0,29,0,0,0,96,3,1,3,64,44,3,29,0,12,28,3],p:[1],c:[{n:[t],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,77]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1});var f=[{songData:[{i:[0,79,127,0,1,8,137,1,0,0,49,23,77,87,3,0,29,2,0,2,107,49,14,100,0,0,0,3],p:[1],c:[{n:[152],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,77]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1},...[h(139),h(152),h(156)],{songData:[{i:[1,151,126,1,1,49,141,67,1,12,4,27,105,98,3,3,0,0,0,3,212,174,4,127,0,5,35,4],p:[1],c:[{n:[139],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,77]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1},{songData:[{i:[0,246,107,1,0,113,110,5,0,0,27,8,56,165,1,3,0,0,0,3,124,29,21,254,0,5,0,0],p:[1],c:[{n:[147],f:[20,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,3]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1}];function c(t){function e(){t(),requestAnimationFrame(e)}this.start=()=>{e()}}const d=(t,e,i=.1)=>t+(e-t)*i,u=(t,e,i)=>t<e?Math.min(t+i,e):t>e?Math.max(t-i,e):e,p=(t,e,i)=>t<e?e:t>i?i:t,w=(t,e)=>t[0]+t[2]>e[0]&&t[1]+t[3]>e[1]&&t[0]<e[0]+e[2]&&t[1]<e[1]+e[3];var x=[[1,1,1,1,97,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,108,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,206,1,1,1,1,1,1,32,33,1,20,20,1,1,1,1,1,1,1,1,1,1,1,1,32,33,33,33,33,33,33,33,33,33,33,33,34,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,49,49,49,1,97,1,1,1,1,1,1,50,1,1,48,1,1,1,1,1,32,34,1,1,1,1,1,24,1,1,1,48,49,49,1,1,1,1,1,1,1,1,1,50,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,33,1,1,1,48,49,1,1,1,1,1,1,20,20,1,1,50,1,1,48,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,1,50,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,20,206,1,1,1,1,1,50,1,1,1,1,1,1,1,1,1,1,1,1,1,206,48,206,1,1,1,1,1,1,1,206,32,33,34,1,1,1,1,50,1,1,32,33,33,33,33,33,33,33,33,33,33,33,33,33,1,1,1,1,1,20,32,33,49,49,49,1,1,1,1,50,1,1,48,49,49,49,49,49,49,49,49,49,49,49,49,49,1,1,20,20,1,1,1,1,1,1,1,1,1,1,1,50,1,1,48,49,49,49,49,49,49,49,49,49,49,49,49,49,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,50,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,1,1,1,1,1,1,1,1,50,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,1,1,1,1,1,1,1,33,33,34,1,1,1,1,1,1,1,1,1,1,1,97,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,1,24,1,1,206,1,1,1,1,1,32,33,34,1,1,1,1,1,1,1,20,20,20,20,20,20,20,32,33,33,33,33,33,33,33,33,33,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,49,49,49,49,49,49,49,49,49,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,49,49,49,49,49,49,49,49,49,1,1,32,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,33,1,1,1,1,1,1,0,1,1,1,1,117,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,1,32,34,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,33,1,206,1,1,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,33,1,1,33,1,1,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,233,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,34,1,1,32,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,206,1,206,1,1,1,1,1,1,1,1,1,1,1,1,206,206,206,206,1,1,1,1,1,1,1,1,32,33,33,33,33,33,33,33,34,1,1,1,1,1,1,1,1,1,1,1,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,49,49,49,49,49,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,40,40,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,206,1,1,1,1,1,1,1,1,1,40,40,40,1,1,1,1,1,1,1,1,1,1,1,206,206,1,206,206,1,35,36,36,37,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,33,33,33,33,33,33,34,1,1,1,1,1,1,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,51,1,1,1,1,1,1,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,51,1,1,1,1,1,1,1,1,32,33,33,34,1,1,1,1,1,1,1,1,1,40,40,1,1,1,1,1,1,1,1,51,1,1,1,206,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,40,40,40,1,1,1,1,1,1,1,1,1,1,1,32,33,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,40,1,1,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,1,1,1,1,20,32,34,1,1,1,1,1,1,1,1,24,206,1,1,1,1,1,1,1,206,206,1,1,1,1,1,40,1,1,1,1,1,1,1,1,1,40,1,1,1,1,32,33,33,33,33,33,33,33,33,33,33,34,1,1,1,1,1,40,1,1,1,1,1,1,1,1,40,40,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,1,1,1,1,1,1,1,40,40,40,40,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,40,32,20,1,1,1,1,1,1,1,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,40,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,206,1,206,1,1,1,24,1,40,40,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,33,33,33,33,33,33,33,33,33,33,33,33,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,1,1,1,1,1,20,32,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,97,1,1,1,1,1,1,1,20,1,1,1,1,1,1,1,1,1,1,1,1,24,206,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,32,33,33,33,33,33,33,33,33,33,33,33,33,34,1,1,1,1,1,1,1,1,1,1,1,1,1,40,1,1,1,40,40,40,40,1,40,40,40,40,40,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,1,1,40,40,40,1,1,1,40,40,1,1,1,40,40,40,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,40,40,40,40,40,1,1,1,1,1,1,1,1,40,1,1,1,1,1,1,1,1,24,1,1,1,1,20,1,1,1,1,1,1,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,20,1,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,40,1,1,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,24,1,1,1,1,1,40,1,1,1,1,1,1,32,33,34,1,1,1,1,1,1,1,1,206,25,1,1,1,1,32,33,34,1,1,1,1,1,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,34,233,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,97,1,1,1,1,1,1,1,1,206,24,1,1,1,1,1,1,1,1,1,20,20,1,1,1,1,1,1,1,1,1,1,1,1,1,206,206,24,1,1,32,33,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,33,33,33,33,33,34],[229,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,36,36,36,37,1,1,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,20,1,1,20,1,1,1,1,1,1,1,1,1,1,35,36,37,1,1,1,1,1,1,1,1,1,1,20,20,20,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,51,1,1,1,1,1,1,20,20,20,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,36,1,1,1,51,40,1,1,20,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,51,40,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,51,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,1,1,1,206,1,1,51,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,36,1,1,1,36,1,1,51,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,51,1,1,1,1,1,1,1,1,1,1,1,206,35,36,37,206,1,1,1,1,1,1,1,206,1,1,1,1,1,35,36,37,1,1,1,1,24,1,1,1,1,35,36,36,36,36,36,36,36,37,40,1,1,1,1,35,1,1,1,1,1,1,1,1,1,1,1,1,51,1,1,1,1,1,1,1,1,1,1,1,40,40,40,40,1,1,1,51,1,1,206,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,40,40,1,1,1,1,51,1,1,36,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,51,1,1,1,1,1,1,1,1,1,1,1,1,48,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,51,206,1,1,1,1,1,1,1,1,1,1,1,48,40,40,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,1,51,36,1,1,1,1,1,1,32,34,1,1,1,48,40,40,40,1,1,1,1,1,1,206,1,32,33,33,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,33,34,1,1,1,1,32,33,33,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,50,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,1,1,1,1,1,1,1,1,1,1,1,1,50,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,53,1,1,1,1,1,1,1,1,1,1,1,206,50,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,206,53,1,1,1,1,1,1,1,206,206,206,206,32,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,33,33,33,33,33,33,33,33,33,33,33,33,49,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,1,206,1,24,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,33,33,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,33,34,206,206,1,206,1,1,1,1,1,1,24,1,206,1,32,34,1,1,1,1,24,1,206,1,1,1,1,1,1,1,1,1,32,33,33,33,33,34,1,1,1,1,32,33,33,33,33,34,1,1,1,1,32,33,33,33,34,1,1,1,1,1,1,1],[113,1,1,1,1,1,1,1,53,40,40,1,1,40,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,108,1,206,1,1,1,1,1,1,1,53,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,206,1,35,37,1,1,1,206,1,1,53,1,1,1,1,1,1,1,1,1,1,1,1,40,1,1,206,1,40,35,36,36,36,36,1,1,1,1,1,35,37,20,53,1,1,1,1,1,1,206,1,1,1,1,35,36,36,36,36,36,36,36,36,36,36,36,1,1,1,1,1,1,1,1,53,1,1,1,35,36,36,36,36,36,36,37,52,52,52,52,52,52,52,52,52,52,52,52,1,1,1,1,1,1,1,1,53,40,1,1,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,1,1,1,1,1,1,1,20,53,1,1,1,51,52,52,52,1,1,1,1,1,1,40,40,40,1,1,1,1,1,1,1,1,1,1,1,24,206,1,1,53,1,1,1,51,52,52,1,1,1,117,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,37,1,1,53,1,1,1,51,52,1,1,1,1,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,53,1,1,1,1,1,1,1,206,1,36,1,1,1,36,1,1,20,1,1,1,20,1,1,1,1,1,1,1,1,1,20,53,1,1,206,1,1,1,1,36,1,1,40,40,40,1,1,1,1,40,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,37,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,206,1,1,1,1,206,24,1,1,1,1,1,1,1,1,1,1,1,1,1,1,229,1,1,1,1,1,1,1,20,20,1,53,1,1,20,35,36,36,37,1,20,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,53,1,1,1,1,1,1,97,1,1,1,1,97,1,1,1,1,1,1,1,1,1,1,1,1,1,1,24,1,1,1,1,53,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,37,1,1,1,1,53,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,40,1,1,1,53,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,1,1,1,1,53,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,37,1,1,1,1,1,1,53,1,1,1,1,1,1,24,1,1,1,1,24,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,53,1,24,1,1,1,1,36,1,1,1,1,36,1,1,1,20,1,1,20,1,1,1,1,1,206,1,24,1,1,1,1,53,35,37,1,1,1,1,52,1,1,1,1,52,1,1,1,1,1,1,1,1,1,20,1,1,35,36,37,40,37,1,1,52,52,52,1,1,1,1,52,1,1,1,1,52,1,1,1,1,1,1,1,1,1,1,1,1,52,52,52,53,1,1,206,52,52,52,1,1,1,1,52,1,1,1,1,52,1,1,1,1,1,1,1,1,1,1,1,1,52,52,52,53,1,1,35,52,52,52,1,1,1,1,52,1,1,1,1,52,1,1,229,1,1,1,1,1,1,1,1,1,52,52,52,53,1,1,51,52,52,52,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,1,53,1,1,51,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,1,1,1,1,1,1,1,51,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,37,1,1,1,1,1,1,1,1,1,51,1,1,1,1,1,1,1,1,1,1,40,40,40,1,1,1,1,1,40,1,51,53,1,1,1,1,1,1,1,1,1,51,206,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,35,37,40,1,51,53,40,40,1,1,1,206,1,1,40,40,37,1,0,1,1,1,1,1,1,1,1,206,1,1,1,1,51,53,1,1,51,53,40,40,1,35,36,36,36,37,40,40,36,36,36,37,40,40,40,35,36,36,36,36,36,37,40,40,51,53,1,1,51,53,1,1,1,51,52,52,52,52,52,52],[40,40,40,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,108,1,40,40,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,206,40,1,1,1,1,1,1,1,1,1,1,1,1,1,1,129,1,1,1,1,1,1,1,1,1,1,1,1,35,36,36,36,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,206,1,1,1,1,206,1,35,36,52,52,52,52,1,1,1,38,1,20,20,1,1,1,1,1,1,1,1,1,1,54,36,36,1,1,1,35,36,37,52,52,52,52,52,52,38,1,1,54,1,1,1,1,54,1,1,1,38,38,1,1,1,1,1,1,1,1,1,51,52,52,52,52,52,52,52,52,38,1,1,54,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,64,1,1,1,1,1,1,1,38,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,38,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,54,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,54,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,54,54,1,1,38,38,1,1,1,1,1,1,1,1,1,206,1,1,1,1,1,206,1,1,1,1,1,206,1,1,206,1,1,1,1,1,1,1,1,1,1,206,206,1,1,1,1,35,36,37,1,1,35,36,36,37,1,1,35,36,37,1,36,1,1,1,1,1,1,1,1,1,35,36,37,37,1,1,1,1,1,1,1,1,64,1,1,1,1,1,1,64,1,1,1,1,1,1,224,1,1,1,1,1,1,1,40,53,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,53,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,53,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,40,53,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,1,1,40,1,1,1,1,0,1,1,1,1,206,1,1,1,1,1,1,1,1,206,1,1,36,1,1,35,36,1,1,1,1,1,1,1,1,1,35,36,37,1,1,35,36,36,37,1,1,35,36,37,1,36,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,206,1,64,1,40,40,64,1,1,1,40,40,1,64,1,1,1,40,40,40,1,1,1,1,1,1,1,1,1,1,1,1,32,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,1,1,101,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,20,20,20,1,1,1,24,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,48,1,1,1,1,1,1,1,1,1,1,1,1,35,37,40,1,20,20,20,1,1,1,1,1,1,1,1,1,206,1,206,48,1,1,24,1,1,1,1,1,1,1,1,1,1,1,97,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,33,33,1,1,36,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,206,1,1,1,206,1,1,1,1,1,1,1,1,1,1,1,20,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,33,1,1,1,32,34,1,1,1,1,1,1,206,206,1,1,206,1,1,1,206,1,1,1,20,1,1,1,20,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,32,33,33,33,33,33,33,33,33,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],y={"-1":[72,16],0:[0,0],13:[0,40],14:[24,40],20:[32,8],24:[64,8],32:[0,16,3],33:[8,16,3],34:[16,16,3],35:[24,16,1],36:[32,16,1],37:[40,16,1],38:[48,16],40:[64,16],48:[0,24,3],49:[8,24,3],50:[16,24,3],51:[24,24,1],52:[32,24,1],53:[40,24,1],54:[48,24],64:[0,32],97:[8,48],101:[40,48],113:[8,56],117:[40,56],129:[8,64],206:[112,96]};const M={224:[0,96],229:[64,64],233:[96,64]};function g(t){let e=0;this.level=t=>((t||0===t)&&(e=t),e),this.solidAt=(t,e,i,n,s=1)=>{for(let r=Math.max(0,Math.floor(t/16));r<=Math.min(31,(t+i-1)/16);r++)for(let t=Math.max(0,Math.floor(e/16));t<=Math.min(31,(e+n-1)/16);t++)if(this.fget(r,t,s))return!0;return!1},this.fget=(t,e,i)=>{let n=y[this.mget(t,e)];return n&&(n[2]&i)===i},this.mget=(t,i)=>x[e][32*i+t],this.draw=(e,i,n,s,r=1)=>{for(let a=0;a<n;a++)for(let n=0;n<s;n++){let s=this.mget(e+a,i+n);s&&(s=y[s],s&&this.fget(e+a,i+n,r)&&t.sspr(s[0],s[1],8,8,16*(e+a),16*(i+n),16,16))}}}function b(t,e,i){let{g:n}=i,s=e.map,r=this.p={s:0,si:0,sj:0,flipx:!1,solid:!0,x:0,y:0,dx:0,dy:0,ay:0,w:16,h:16,collideable:!0,cbox:[0,0,16,16]},a=0,o=0;this.init=(t,e)=>{r.x=t,r.y=e};const l=this.absCbox=()=>{let t=r.cbox;return[r.x+t[0],r.y+t[1],t[2],t[3]]};this.isFlag=(t,e,i)=>{let n=l();return s.solidAt(n[0]+t,n[1]+e,n[2],n[3],i)};const h=this.isSolid=(i,n)=>{let r=l();return s.solidAt(r[0]+i,r[1]+n,r[2],r[3])||e.checkObject(t,O,i,n)||e.checkObject(t,v,i,n)};this.update=()=>{a+=r.dx;let t=Math.floor(a);a-=t,(t=>{if(!r.solid)return void(r.x+=t);let e=Math.sign(t);for(let i=0;i<Math.abs(t);i++){if(h(e,0)){r.dx=0;break}r.x+=e}})(t),o+=r.dy,t=Math.floor(o),o-=t,(t=>{if(!r.solid)return void(r.y+=t);let e=Math.sign(t);for(let i=0;i<Math.abs(t);i++){if(h(0,e)){r.dy=0;break}r.y+=e}})(t)},this.draw=()=>{let t=y[r.s];n.sspr(t[0]+8*r.si,t[1]+8*r.sj,8,8,r.x,r.y,r.w,r.h,r.flipx)}}function m(t,e){let i,n,s,r,a,o,l,h,{e:f,g:c,a:d}=e,w=t.cam,x=this.base=new b(this,t,e),y=this.p=x.p,M=0,g=0;let m,v;this.init=(t,e)=>{x.init(t,e),a=!1,m=1,v=1,h=0,s=0,y.cbox=[2,6,10,10]},this.canCollect=()=>!a&&r,this.wasGrounded=()=>{r=!0};const k=()=>{a=!0,t.killPlayer(this)};this.update=()=>{if(x.update(),y.y<=16&&y.x>496)return void t.nextLevel(this);if(y.y>=448&&y.x<0)return void t.prevLevel(this);if(y.x=p(y.x,0,496),t.checkObject(this,j,0,0)&&k(),y.y>=512)return void k();let e=0,a=0,c=0;f.up?e=-1:f.down&&(e=1),f.left?a=-1:f.right&&(a=1),f.x&&(c=!i),i=f.x,c?n=8:n>0&&n--;let b=a*(5/15*3.3);y.dx+=b,y.dx+=-y.dx*(5/15);let L=0;x.isSolid(-3,0)?L=-1:x.isSolid(3,0)&&(L=1);let O=x.isSolid(0,1),P=x.isFlag(0,1,2);!r&&P&&Math.abs(l)>9.799999999999999&&k(),O||(y.ay=-3.3*-96*3.3/2304),O?s=12:s>0&&s--,n>0&&(s>0?(y.ay=-3.3*-96*3.3/2304,y.dy=-96*3.3/48,s=0,n=0,m=.6,v=1.4,d.sfx(5)):O||0===L||(y.dy=-96*3.3/48*.9,y.dx=5/15*3.3*-L*8,n=0,d.sfx(5))),m=u(m,1,.03),v=u(v,1,.03),y.w=16*m,y.h=16*v;let A=0;0!==a&&x.isSolid(a,0)&&Math.sign(y.dy)>0&&(A=1),y.dy+=y.ay,y.dy+=-y.dy*(5/15)*1.6*A,h>0?h--:O&&!r&&(h=10),Math.sign(o)==Math.sign(y.dx)&&r===O||t.smoke(y.x,y.y+8),l=y.dy,o=y.dx,r=O,w.x=w.x+.1*(y.x-w.x),w.y=w.y+.1*(y.y-w.y),y.flipx=y.dx<-1||!(y.dx>1)&&y.flipx,h>0?(M=12,g=Math.floor(2*(1-h/10))):O?Math.abs(y.dx)>.1?(M=3,g=(g+1/4)%3):(M=0,g=(g+1/30)%3):0!==L&&y.dy>0?(M=9,g=(g+.1)%3):(M=6,g=(g+.2)%3),y.si=Math.floor(M+g)},this.draw=()=>{x.draw()}}function v(t,e){let{e:i,g:n}=e,s=this.base=new b(this,t,e),r=this.p=s.p;r.s=20;let a=0,o=0;this.init=(t,e)=>{s.init(t,e)},this.update=()=>{s.update(),0===a?(t.checkObject(this,m,0,-1)||t.checkObject(this,m,-1,0)||t.checkObject(this,m,1,0))&&(a=1,o=30):1===a?(o--,o<=0&&(a=2,o=120,r.collideable=!1)):2===a&&(o--,o<=0&&!t.checkObject(this,m,0,0)&&(a=0,r.collideable=!0)),0===a?r.si=0:1===a&&(r.si=Math.floor(3*(1-o/30)))},this.draw=()=>{2!==a&&s.draw()}}function k(t,e){let{e:i,g:n,a:s}=e,r=this.base=new b(this,t,e),a=this.p=r.p;a.s=24;let o=0;this.init=(t,e)=>{r.init(t,e)},this.update=()=>{if(r.update(),o>0)o--,a.si=1+Math.floor(2*(1-o/10)),o<=0&&(a.si=0);else{let e=t.collideObject(this,m,0,0);null!==e&&(e.p.y=a.y-4,e.p.dx*=.2,e.p.dy=-96*3.3/48*1.2,e.wasGrounded(),o=10,s.sfx(5))}},this.draw=()=>{r.draw()}}function j(t,e){let{e:i,g:n}=e,s=this.base=new b(this,t,e),r=this.p=s.p;r.s=40,r.sj=Math.random()<.3?1:0;this.init=(t,e)=>{r.cbox=[2,2,10,10],s.init(t,e)},this.update=()=>{s.update()},this.draw=()=>{s.draw()}}function L(t,e){let{e:i,g:n}=e,s=this.base=new b(this,t,e),r=this.p=s.p;r.solid=!1,r.s=13;let a=0;this.init=(t,e,i)=>{s.init(t,e),a=30,r.dx=.5-Math.random(),r.dy=.5-Math.random(),r.s=i?14:13},this.update=()=>{a>0&&(a--,a<=0&&t.destroyObject(this)),s.update(),r.si=Math.floor(3*(1-a/31))},this.draw=()=>{s.draw()}}function O(t,e,i){let n,s,r,{e:a,g:o}=e,l=this.base=new b(this,t,e),h=this.p=l.p;h.s=i,this.init=(t,e)=>{s=0,r=38===i?0:60,l.init(t,e)},this.update=()=>{l.update(),r++,s=r%120/120<.5?0:1,s!==n&&(0===s?(h.collideable=!1,h.si=1):t.checkObject(this,m,0,0)||(h.si=0,h.collideable=!0)),n=s},this.draw=()=>{l.draw()}}function P(t,e,i,n){let s,r,a,o,l,h,{e:f,g:c,a:u}=e,p=this.base=new b(this,t,e),w=this.p=p.p;w.s=i,this.collected=()=>{h=!0},this.init=(t,e)=>{p.init(t,e),h=!1,l=0,o=null,a=0,s=t,r=e,this.info=[n,s,r]},this.update=()=>{if(p.update(),a++,w.y=r+4*Math.sin(a%60/60*Math.PI*2),o)w.x=d(w.x,o.p.x,.2),r=d(r,o.p.y-16,.2),o.canCollect()&&(o=null,l=30,u.sfx(0));else{let e=t.collideObject(this,m,0,0);null!==e&&(o=e)}l>0&&(l--,l<=0&&t.collect404(this)),w.si=h?-1:0===l&&a%60<30?Math.floor(a%30/30*3):0},this.draw=()=>{(0===l||l%10<5)&&p.draw()}}function A(t,e){let{e:i,g:n}=e,s=this.base=new b(this,t,e),r=this.p=s.p;r.s=64;let a,o=0;this.init=(t,e)=>{s.init(t,e),a=-1,r.dx=-1},this.update=()=>{s.update(),o++,r.dx<0&&!s.isSolid(-16,-1)?r.dx*=-1:s.isSolid(16,-1)||(r.dx*=-1),r.si=Math.floor(o%20/21*3)},this.draw=()=>{s.draw()}}function S(t,e){let i,n,s,r,a,o,l,h,f,{g:c,a:d}=e,u=t.map;this.base={absCbox:()=>[i,n+a,16,16]},this.init=(t,e)=>{i=t,n=e,s=120*Math.random(),o=0,a=0,r=0,l=0,h=0,f=1+Math.floor(2.9*Math.random())},this.update=()=>{s>0&&(s--,s<=0&&(r=60)),r>0&&(h++,r--,r<=0&&(a=1,l=Math.random())),a>0&&o<=0&&(l+=.2*Math.random(),a+=l,(a>512||t.checkObject(this,m,0,0)||u.solidAt(i,n+a,16,16))&&(o=20,t.psfx(f,i,n+a))),o>0&&(o--,o<=0&&(a=0,s=120*Math.random()))},this.draw=()=>{if(c.sspr(64+8*Math.floor(1+Math.sin(h%60/60*Math.PI*2)/2),56,8,8,i,n,16,16),r>0){let t=Math.floor(3*(1-r%60/61));c.sspr(64+8*t,48,8,8,i,n-2,16,16)}let t=Math.floor(3*(.99-o%20/20));a>0&&c.sspr(80,48,8,8,i,n+a,16+8*(t-2),16+8*(t-2)),o>0&&(c.sspr(88+8*t,48,8,8,i-8,n+a,16,16),c.sspr(88+8*t,48,8,8,i+8,n+a,16,16,!0))}}function C(t,e){let i,n,{g:s}=e,r=40*Math.random(),a=60+60*Math.random(),o=Math.random()<.5?0:8;this.init=(t,e)=>{i=t,n=e},this.update=()=>{r++},this.draw=()=>{let t=Math.floor(r%a/a*4);s.sspr(112+o,96+8*t,8,8,i,n,16,16)}}function I(t,e){let i=[],n=[];this.acquire=(e=(()=>{}))=>{let s;return s=n.length>0?n.pop():t(),e(s),i.push(s),s},this.release=t=>{s(i.indexOf(t))};const s=t=>{t>-1&&n.push(i.splice(t,1)[0])};this.releaseAll=()=>{n=[...n,...i],i=[]}}function E(t,e){let{g:i}=e,n=[],s=0,r=0,a=0;for(let t=0;t<16;t++)for(let e=0;e<16;e++)Math.random()<.4&&n.push({i:t,j:e,s:Math.floor(2*Math.random()%2)});this.init=()=>{},this.off=()=>{s=30},this.update=()=>{s>0?(s--,s%1==0&&(r=a),a+=512-s%30/30*4):(Math.random()<.8&&(r=a),a+=511.7)};let o={0:[0,72],1:[16,72]};this.draw=()=>{n.forEach(({s:t,i:e,j:n})=>{s>0&&i.sspr(o[t][0]+32,o[t][1],16,16,32*e,(a+(a-r)+32*n)%512-32,32,32),i.sspr(o[t][0],o[t][1],16,16,32*e,(a+32*n)%512-32,32,32)})}}function D(t,e){let{g:i,e:n,a:s}=e,r=[],a=new I(()=>new m(this,e)),o=new I(()=>new v(this,e)),l=new I(()=>new k(this,e)),h=new I(()=>new j(this,e)),f=this.pSplash=new I(()=>new L(this,e)),c=new I(()=>new O(this,e,38)),d=new I(()=>new O(this,e,54)),x=new I(()=>new P(this,e,129,2)),y=new I(()=>new P(this,e,113,3)),b=new I(()=>new P(this,e,117,4)),D=new I(()=>new P(this,e,101,5)),_=new I(()=>new P(this,e,97,0)),T=new I(()=>new A(this,e)),R=new I(()=>new S(this,e));const G={0:a,20:o,24:l,40:h,38:c,54:d,97:_,101:D,113:y,117:b,129:x,64:T,206:new I(()=>new C(this,e))};let q=0,B=this.cam={x:0,y:0,shake:0,shakex:0,shakey:0,viewoffy:0},F=0,K=new E(this,e),U=[];function W(t,e,i,n){let s=t.acquire(t=>t.init(e,i,n));return s._pool=t,r.push(s),s}function $(t){t._pool.release(t),r.splice(r.indexOf(t),1)}function z(t,e,i,n){let s=t.base.absCbox();s[0]+=i,s[1]+=n;for(let i of r)if(null!==i&&i instanceof e&&i!==t&&i.p.collideable){let t=i.base.absCbox();if(w(s,t))return i}return null}function X(){B.shake=10}let H=0;this.psfx=function(t,e,i){if(H>0)return;let n=p(B.x-160,0,192),r=p(B.y+B.viewoffy-90,0,332);e>=n&&e<=n+320&&i>=r&&i<=r+180&&(s.sfx(t,.1),H=20)},this.collect404=function(e){$(e),t.collect(e.info)},this.prevLevel=function(e){$(e),t.prevLevel()},this.nextLevel=function(e){$(e),t.nextLevel()},this.shake=X,this.smoke=function(t,e){W(f,t,e,1)},this.checkObject=function(t,e,i,n){return null!==z(t,e,i,n)},this.collideObject=z,this.initObject=W,this.destroyObject=$;let J=this.map=new g(i),N=0;this.init=(e=J.level())=>{J.level(e),N=0,K.init(),B.shake=0,B.shakex=0,B.shakey=0;for(let t of r)t._pool.release(t);r=[],U=[];for(let e=0;e<32;e++)for(let r=0;r<32;r++){let a=J.mget(e,r);if(G[a]){let i=W(G[a],16*e,16*r);i.info&&!t.scollect(i.info)&&i.collected()}else M[a]&&(i=M[a],n=16*e,s=16*r,U.push({decal:i,x:n,y:s}));if(r<30&&Math.random()<.3){let t=J.mget(e,r+1,1);33!==a&&36!==a&&49!==a&&52!==a||1!==t||W(R,16*e,16*(r+1))}}var i,n,s},this.killPlayer=e=>{for(let t=0;t<4;t++)W(f,e.p.x,e.p.y);s.sfx(4),K.off(),$(e),N=30,X(),t.die()},this.update=()=>{n.p.enter&&t.beginEndgame(),t.time(),F<20?n.down&&F++:n.down?B.viewoffy=u(B.viewoffy,80,4):(B.viewoffy=u(B.viewoffy,0,4),0===B.viewoffy&&(F=0)),q++,N>0&&(--N,N<=0&&this.init()),H>0&&H--,B.shake>0&&(B.shake--,B.shakex=u(B.shakex,4-8*Math.random(),1+4*Math.random()),B.shakey=u(B.shakey,4-8*Math.random(),1+4*Math.random()));for(let t of r)t.update();K.update()},this.draw=()=>{let t=p(B.x-160,0,192),e=p(B.y+B.viewoffy-90,0,332);i.camera(.4*t+B.shakex,.4*e+B.shakey),K.draw(),i.camera(t+B.shakex,e+B.shakey),U.forEach(({decal:t,x:e,y:n})=>{i.sspr(t[0],t[1],32,32,e,n,64,64)}),J.draw(Math.floor(t/16),Math.floor(e/16),21,12.25),i.sspr(120,0,8,8,4*Math.sin(q%60/60*Math.PI*2)+512-24,12,16,16),i.sspr(120,0,8,8,4*Math.sin(q%60/60*Math.PI*2)+8,464,16,16,!0);for(let t of r)t.draw()}}function _(t,e){let i,{g:n}=e;let s=0,r=0,a=0;this.off=()=>0===s,this.init=t=>{i=t,s=20,r=0,a=0},this.update=()=>{s>0&&(s--,10===s&&i()),s>10?a+=32:s<20&&(r+=32)},this.draw=()=>{n.fill("#fff1e8"),n.fr(r,0,a,180)}}function T(t,e){let i,n,s,r,a,o,l,h,{g:f,e:c}=e,d={2:[0,64],3:[0,56],4:[32,56],5:[32,48],0:[0,48]},p=[2,0,0,3,0,0,5,0,0,4,0,4],w=[0,0,0,0,0,0,0,0,0,0,0,0],x=0,y=0,M=0;function g(t){function e(t,e){return t<=e?0:.3<=t-e?1:(t-e)/.3}return[e(t,0),e(t,.33),e(t,.66)]}this.init=t=>{M=0,s=0,r=0,i=t.time,n=t.die,a=12===t.colls.length?60:0,o=0,l=0,h=0,y=10,console.log(`Time: ${Math.floor(i)}, Die: ${n}`)},this.collect=t=>{for(let e=0;e<p.length;e++){let i=p[e];if(!w[e]&&i===t){w[e]=1;break}}},this.update=()=>{M++,s=u(s,i,i/90),r=u(r,n,n/90),a>0&&(a--,a<=0&&(o=60)),o>0&&(o--,o<=0&&(l=20)),l>0&&(l--,l<=0&&(h=800)),h>0&&h--,o>0||l>0?(x+=y,y=u(y,1,.1)):h>0&&(x+=y,y=u(y,0,.1),x=u(x,0,1)),(c.p.enter||c.p.any&&M>60)&&t.beginLevels()},this.draw=()=>{f.camera();for(let t=0;t<4;t++)for(let e=0;e<3;e++){let i=d[p[3*t+e]];if(w[3*t+e]){let n=0;M%120<30&&(n=Math.floor(M%30/30*3)),f.sspr(i[0]+8+8*n,i[1],8,8,112+32*e+2*e,16+32*t+4*t,32,32)}else f.sspr(i[0],i[1],8,8,112+32*e+2*e,16+32*t+4*t,32,32)}f.sspr(0,88,8,8,40,128,32,32);let t=g(r/120);t=t.map(t=>8*Math.floor(3*t)),f.sspr(t[0],8,8,8,40,88,32,32),f.sspr(t[1],8,8,8,40,56,32,32),f.sspr(t[2],8,8,8,40,24,32,32);let e=r/120>.9?24:0;if(f.sspr(e+16,88,8,8,40,24,32,32),f.sspr(e+24,88,8,8,40,56,32,32),f.sspr(e+32,88,8,8,40,88,32,32),f.sspr(8,88,8,8,240,128,32,32),t=g(s/1038),t=t.map(t=>8*Math.floor(3*t)),e=s/1038>.9?24:0,f.sspr(t[0],8,8,8,240,88,32,32),f.sspr(t[1],8,8,8,240,56,32,32),f.sspr(t[2],8,8,8,240,24,32,32),f.sspr(e+16,88,8,8,240,24,32,32),f.sspr(e+24,88,8,8,240,56,32,32),f.sspr(e+32,88,8,8,240,88,32,32),l>0||h>0)for(let t=0;t<40;t++)for(let e=0;e<22.5;e++){let i=8*Math.floor(2*(1-l/60));f.sspr(48+i,40,8,8,8*t,8*e)}h>0&&f.sspr(80,24,48,8,64,128,192,32),(o>0||l>0||h>0)&&f.sspr(32+16*Math.floor(x%30/30*5),96,16,16,128,58+4*Math.sin(M%48/48*Math.PI*2),64,64)}}function R(t,e){let{e:i,g:n}=e,s=0;this.update=()=>{s++,(i.p.x||i.p.c)&&t.beginLevels()},this.draw=()=>{n.camera(),n.fill("black"),n.fr(0,0,320,180),n.sspr(72,32,16,9,0,0,320,180);let t=8*Math.sin(s%120/120*Math.PI*2);n.sspr(104,40,8,8,t+104+0,100,16,16),n.sspr(112,40,16,8,t+104+24,100,32,16),n.sspr(88,8,32,8,t+104+64,100,64,16),n.sspr(88,32,40,8,80,32,160,32)}}function G(t){let e,{g:i,e:n,a:s}=t,r=new D(this,t),a=new _(this,t),o=new T(this,t),l=new R(this,t);i.fill("#1d2b53");let h={current:1,colls:[],die:0,time:0};this.init=()=>{o.init(h),e=o,e=l},this.beginEndgame=()=>{a.init(()=>{o.init(h),e=o})},this.beginIntro=()=>{a.init(()=>{e=l})},this.beginLevels=()=>{a.init(()=>{r.init(h.current),e=r})},this.nextLevel=()=>{4===h.current?a.init(()=>{h.current=0,o.init(h),e=o}):(h.current++,a.init(()=>{r.init(h.current)}))},this.prevLevel=()=>{h.current>0&&h.current--,a.init(()=>{r.init(h.current)})},this.scollect=t=>{for(let e of h.colls)if(e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2])return!1;return!0},this.collect=t=>{this.scollect(t)&&(h.colls.push(t),o.collect(t[0]),12===h.colls.length&&(o.init(h),e=o))},this.die=()=>{h.die++},this.time=()=>{h.time+=1/60},this.update=()=>{a.update(),e.update()},this.draw=()=>{i.clear(),e.draw(),a.draw()}}function q(){let t=["ArrowUp","ArrowLeft","ArrowRight","ArrowDown","KeyX","KeyC","Enter"],e=["up","left","right","down","x","c","enter"];this.p={};let i={};this.update=()=>{this.p.any=!1;for(let t of e)this[t]&&!i[t]?(this.p[t]=!0,this.p.any=!0):this.p[t]=!1,i[t]=this[t]};const n=i=>n=>{let s=t.indexOf(n.code);s>=0&&i(e[s])},s=n(t=>{this[t]=!0}),r=n(t=>{this[t]=!1});this.bind=()=>{document.addEventListener("keydown",s),document.addEventListener("keyup",r)}}function B(t,e){let i=new n(t),s=new q;s.bind();let o=e.assetsBase||"assets",h=new l;h.generate(f),new a(o+"/sprites.png").start(t=>{let e=new G({g:new r(i,t),e:s,a:h});e.init(),new c(()=>{s.update(),e.update(),e.draw()}).start()})}}]);