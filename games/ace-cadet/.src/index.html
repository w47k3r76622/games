<!DOCTYPE html><html><head><meta charset="UTF-8"/><style id="webmakerstyle">*{margin: 0; background: #121212;}</style></head><body><canvas width="600" height="600"></canvas><script src="kontra.min.js"></script><script>
let{initKeys:initKeys,keyPressed:keyPressed,init:init,Sprite:Sprite,GameLoop:GameLoop,Text:Text}=kontra,{canvas:canvas}=init(),sprites=[];const maxVelocity=5,shipVelocity=[0,0],shipSpeed=.5,stoppingPower=.15;let shipSize=15,bulletCount=1;var killCount=0;let enemySpeed=1,enemyCount=0,enemyMax=10,smallEnemyRate=15,bigEnemyRate=20,waveCount=1,colors=["aqua","teal","white","lime","gold","yellow","pink","green","orange","white"];
var gameSeed=[];const getGameSeed=function(){var e=new XMLHttpRequest;e.open("GET","https://api.drand.sh/public/latest",!0),e.send(null),e.onreadystatechange=function(){4===e.readyState&&200===e.status&&(1!==e.getResponseHeader("Content-Type").indexOf("text")&&(gameSeed=(gameSeed=(gameSeed=JSON.parse(e.responseText).randomness).replace(/\D/g,"")).split("")))}};getGameSeed(),initKeys(),kontra.initPointer();let sprite=Sprite({type:"player",x:canvas.width/2,y:canvas.height/2,radius:2,render(){this.context.lineWidth=5,this.context.strokeStyle=colors[gameSeed[0]],this.context.beginPath(),this.context.arc(0,0,this.radius,0,Math.PI),this.context.stroke(),this.context.strokeStyle=colors[gameSeed[1]],this.context.beginPath(),this.context.arc(0,0,4*this.radius,0,2*Math.PI),this.context.stroke()}});sprites.push(sprite);
kontra.onPointerDown(function(t,e){let i=t.clientX,o=t.clientY,l=sprite.x,r=sprite.y;Math.cos(this.rotation),Math.sin(this.rotation);let s=1,n=1;i<l&&(s=-1),o<r&&(n=-1),Math.abs(i-l)<75&&(s=0),Math.abs(o-r)<75&&0!=s&&(n=0);for(let t=-bulletCount/2;t<bulletCount;t++){let e=kontra.Sprite({type:"bullet",color:colors[gameSeed[2]],x:sprite.x,y:sprite.y,dx:10*s-4*t,dy:10*n-4*t,ttl:50,radius:2,width:5,height:5});sprites.push(e)}});
let text=Text({x:335,y:540,text:"Cadet! Our EMPIRE is in trouble!\nUse WASD to MOVE,\nand MOUSE to Aim",font:"24px Courier New",color:"white",anchor:{x:.5,y:.5},textAlign:"left"});sprites.push(text);let killCountText=Text({x:canvas.width/2,y:50,text:"Kill Count: "+killCount+" - Wave: "+waveCount,font:"24px Courier New",color:"white",anchor:{x:.5,y:.5},textAlign:"center"});sprites.push(killCountText);let enemyCountText=Text({x:canvas.width/2,y:canvas.height-150,text:"Enemy Count: "+enemyCount+" / 100",font:"24px Courier New",color:"white",anchor:{x:.5,y:.5},textAlign:"center"});sprites.push(enemyCountText);
const random=function(e,t=0){return Math.floor(Math.random()*e)},createEnemy=function(){enemyCount++,gameSeed[4]<2&&(gameSeed[5]+=3);let e=Sprite({type:"enemy",x:canvas.width/2+(random(400)-200),y:canvas.height/2+(random(400)-200),radius:3,dx:random(2*enemySpeed)-enemySpeed/2,dy:random(2*enemySpeed)-enemySpeed/2,render(){this.context.strokeStyle=colors[gameSeed[random(gameSeed[4])]],this.context.beginPath(),this.context.arc(0,0,this.radius,0,Math.PI*gameSeed[random(gameSeed[6]+1)]),this.context.stroke(),this.context.strokeStyle=colors[gameSeed[random(gameSeed[4])]],this.context.beginPath(),this.context.arc(0,0,4*this.radius,0,Math.PI/2),this.context.stroke()}});sprites.push(e)},bigEnemy=function(){enemyCount++;let e=Sprite({type:"enemyBig",x:canvas.width/2+(random(400)-200),y:canvas.height/2+(random(400)-200),radius:6+gameSeed[7]/2,health:5+gameSeed[7]/2,dx:random(2*enemySpeed)-enemySpeed/2,dy:random(2*enemySpeed)-enemySpeed/2,render(){this.context.strokeStyle=colors[gameSeed[random(gameSeed[4])]],this.context.beginPath(),this.context.arc(0,0,this.radius,0,Math.PI*gameSeed[random(gameSeed[6])]),this.context.stroke(),this.context.strokeStyle=colors[gameSeed[random(gameSeed[4])]],this.context.beginPath(),this.context.arc(0,0,4*this.radius,0,2*Math.PI),this.context.stroke()}});sprites.push(e)};
let currentFrame=0,multiShot=!1;
let loop = GameLoop({ // create the main game loop
  update: function() { // update the game state
    if(enemyCountText.text="Enemy Count: "+enemyCount+" / 100",enemyCount>50?enemyCountText.color="red":enemyCountText.color="white",enemyCount<enemyMax&&currentFrame>800&&(currentFrame%smallEnemyRate==0&&createEnemy(),currentFrame%bigEnemyRate==0&&waveCount>=5&&bigEnemy()),enemyCount>100){sprites.map(e=>{e.ttl=0}),sprites=[];let e=Sprite({x:0,y:0,radius:3,color:"black",height:1e3,width:1e3,ttl:5});sprites.push(e);let t=Text({x:canvas.width/2,y:canvas.height-400,text:"We've been Overwhelmed!\nThere were too many intruders\nfor our forces to stop them.",font:"24px Courier New",color:"red",anchor:{x:.5,y:.5},textAlign:"center"});sprites.push(t);let n=Text({x:canvas.width/2,y:canvas.height-200,text:"Press [K] to Keep Going",font:"24px Courier New",color:"teal",anchor:{x:.5,y:.5},textAlign:"center"});sprites.push(n)}5===waveCount&&(multiShot=!0,text.text="Powerup: Multishot!",text.color="red",bulletCount=gameSeed[6]+3),killCount%30==0&&(enemyMax<200&&(enemyMax+=15),killCount++,waveCount++,smallEnemyRate/=2,bigEnemyRate/=2),killCountText.color="white",currentFrame++,400===currentFrame?text.text="Press [LEFT MOUSE] to\nShoot your Lasers!":600===currentFrame?text.text="Hold off waves of Intruders\nfor as long as you can!":900===currentFrame?(text.color="red",text.text="Do NOT let more than 100\nintruders attack at once!"):1200==currentFrame&&(text.color="white");sprites.map(e=>{e.update(),"bullet"!=e.type&&(e.x>canvas.width&&(e.x=-e.width),e.x<0&&(e.x=canvas.width),e.y>canvas.height&&(e.y=-e.height),e.y<0&&(e.y=canvas.height))});if(bulletCount>4)bulletCount=4;let pressedThisFrame=!1;kontra.keyPressed("d")&&shipVelocity[0]<maxVelocity&&(shipVelocity[0]+=shipSpeed),kontra.keyPressed("a")&&(pressedThisFrame=!0,shipVelocity[0]>-maxVelocity&&(shipVelocity[0]-=shipSpeed)),kontra.keyPressed("s")&&(pressedThisFrame=!0,shipVelocity[1]<maxVelocity&&(shipVelocity[1]+=shipSpeed)),kontra.keyPressed("w")&&(pressedThisFrame=!0,shipVelocity[1]>-maxVelocity&&(shipVelocity[1]-=shipSpeed));sprite.y+=shipVelocity[1],sprite.x+=shipVelocity[0],pressedThisFrame||(shipVelocity[0]>0&&(shipVelocity[0]-=stoppingPower),shipVelocity[0]<0&&(shipVelocity[0]+=stoppingPower),shipVelocity[1]<0&&(shipVelocity[1]+=stoppingPower),shipVelocity[1]>0&&(shipVelocity[1]-=stoppingPower)),sprites=sprites.filter(i=>i.isAlive());
    for (let i = 0; i < sprites.length; i++) {
      if (sprites[i].type === 'enemy' || sprites[i].type === 'enemyBig') {for(let e=0;e<sprites.length;e++)if("bullet"===sprites[e].type){let t=sprites[i],s=sprites[e],l=t.x-s.x,r=t.y-s.y,p=6*t.radius;if("enemyBig"===sprites[i].type&&(p*=4),Math.hypot(l,r)<p+s.radius){if("enemyBig"===sprites[i].type){sprites[i].health-=1,sprites[i].radius-=1,sprites[i].health<=2&&(sprites[i].type="enemy");break}t.ttl=0,s.ttl=0,killCount++,killCountText.text="Kill Count: "+killCount+" - Wave: "+waveCount,killCountText.color="red",explode(t.x,t.y),enemyCount--;break}}
      }
    }
  },
  render: function() { // render the game state
    sprites.map(sprite => sprite.render());
  }
});
kontra.bindKeys("r",function(e){getGameSeed()},"keyup"),kontra.bindKeys("k",function(e){window.location.reload()},"keyup"),kontra.bindKeys("e",function(e){bigEnemy()},"keyup");const explode=function(e,t){let n=gameSeed[8];n<10&&(n*=2);let o=Sprite({x:e,y:t,radius:3,color:"yellow",height:n,width:n,ttl:5});sprites.push(o)};let cmdr = Sprite({x:55,y:canvas.height-60,anchor:{x:.5,y:.5},color:'teal',width:40,height:40});sprites.push(cmdr);loop.start();

</script></body></html>