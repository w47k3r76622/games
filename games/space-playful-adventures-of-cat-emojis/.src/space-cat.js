!function(){"use strict";let t,n,e={};function i(t,...n){(e[t]||[]).map((t=>t(...n)))}function s(){return n}function o(t,n){return Math.floor(Math.random()*(n-t+1))+t}function r(t,n){return t.rotation||n.rotation?null:([t,n]=[t,n].map((t=>function(t){let{x:n=0,y:e=0,width:i,height:s}=t.t||t;t.i&&(i=t.i,s=t.o);t.anchor&&(n-=i*t.anchor.x,e-=s*t.anchor.y);i<0&&(n+=i,i*=-1);s<0&&(e+=s,s*=-1);return{x:n,y:e,width:i,height:s}}(t))),t.x<n.x+n.width&&t.x+t.width>n.x&&t.y<n.y+n.height&&t.y+t.height>n.y)}class c{constructor(t=0,n=0,e={}){this.x=t,this.y=n}add(t){return new c(this.x+t.x,this.y+t.y,this)}}function a(){return new c(...arguments)}a.prototype=c.prototype,a.h=c;const h=()=>{};class u extends class{constructor(t){return this.init(t)}init(t={}){this.position=a(),this.u=a(),Object.assign(this,t)}update(t){this.advance(t)}advance(t){let n=this.u;this.position=this.position.add(n),this.l()}get dx(){return this.u.x}get dy(){return this.u.y}set dx(t){this.u.x=t}set dy(t){this.u.y=t}l(){}}{init({width:t=0,height:n=0,context:e=s(),p:i=this.g,update:o=this.advance,children:r=[],anchor:c={x:0,y:0},opacity:a=1,rotation:h=0,m:u=1,k:l=1,...d}={}){this.children=[],super.init({width:t,height:n,context:e,anchor:c,opacity:a,rotation:h,m:u,k:l,...d}),this.v=1,this.C(),r.map((t=>this.j(t))),this.K=i,this.S=o}update(t){this.S(t),this.children.map((n=>n.update&&n.update(t)))}p(t){let n=this.context;n.save(),(this.x||this.y)&&n.translate(this.x,this.y),this.rotation&&n.rotate(this.rotation),1==this.m&&1==this.k||n.scale(this.m,this.k);let e=-this.width*this.anchor.x,i=-this.height*this.anchor.y;(e||i)&&n.translate(e,i),this.context.globalAlpha=this.opacity,this.K(),(e||i)&&n.translate(-e,-i);let s=this.children;t&&(s=s.filter(t)),s.map((t=>t.p&&t.p())),n.restore()}g(){}l(t,n){this.C(),this.children.map((t=>t.l()))}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this.l()}set y(t){this.position.y=t,this.l()}get width(){return this.T}set width(t){this.T=t,this.l()}get height(){return this._}set height(t){this._=t,this.l()}C(){if(!this.v)return;let{A:t=0,F:n=0,M:e=1,O:i=0,$:s=1,L:o=1}=this.parent||{};this.A=this.x,this.F=this.y,this.H=this.width,this.P=this.height,this.M=e*this.opacity,this.O=i+this.rotation;let{x:r,y:c}=function(t,n){let e=Math.sin(n),i=Math.cos(n);return{x:t.x*i-t.y*e,y:t.x*e+t.y*i}}({x:this.x,y:this.y},i);this.A=r,this.F=c,this.$=s*this.m,this.L=o*this.k,this.A=this.x*s,this.F=this.y*o,this.H=this.width*this.$,this.P=this.height*this.L,this.A+=t,this.F+=n}get t(){return{x:this.A,y:this.F,width:this.H,height:this.P,opacity:this.M,rotation:this.O,m:this.$,k:this.L}}j(t,{absolute:n=0}={}){this.children.push(t),t.parent=this,t.l=t.l||h,t.l()}removeChild(t){let n=this.children.indexOf(t);-1!==n&&(this.children.splice(n,1),t.parent=null,t.l())}get opacity(){return this.R}set opacity(t){this.R=t,this.l()}get rotation(){return this.V}set rotation(t){this.V=t,this.l()}setScale(t,n=t){this.m=t,this.k=n}get m(){return this.U}set m(t){this.U=t,this.l()}get k(){return this.Y}set k(t){this.Y=t,this.l()}}function l(){return new u(...arguments)}l.prototype=u.prototype,l.h=u;class d extends l.h{init({...t}={}){super.init({...t})}g(){this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}function f(){return new d(...arguments)}f.prototype=d.prototype,f.h=d;let p=/(\d+)(\w+)/;class g extends l.h{init({text:t="",textAlign:n="",lineHeight:e=1,font:i=s().font,...o}={}){t=""+t,super.init({text:t,textAlign:n,lineHeight:e,font:i,...o}),this.D()}get width(){return this.T}set width(t){this.N=1,this.T=t,this.X=t}get text(){return this.G}set text(t){this.N=1,this.G=t}get font(){return this.B}set font(t){this.N=1,this.B=t,this.W=function(t){let n=t.match(p),e=+n[1];return{size:e,unit:n[2],q:e}}(t).q}get lineHeight(){return this.I}set lineHeight(t){this.N=1,this.I=t}p(){this.N&&this.D(),super.p()}D(){this.J=[],this.N=0;let t=this.context;t.font=this.font,this.J.length||(this.J.push(this.text),this.T=this.X||t.measureText(this.text).width),this.height=this.W+(this.J.length-1)*this.W*this.lineHeight,this.C()}g(){let t=this.textAlign,n=this.context;this.J.map(((e,i)=>{n.textBaseline="top",n.textAlign=t,n.fillStyle=this.color,n.font=this.font,n.fillText(e,0,this.W*this.lineHeight*i)}))}}function y(){return new g(...arguments)}function w(t){let n=t.canvas;t.clearRect(0,0,n.width,n.height)}y.prototype=g.prototype,y.h=g;let m={},x={},b={},k={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"left",ArrowUp:"up",ArrowRight:"right",ArrowDown:"down"};function v(t){let n=k[t.code];b[n]=1,m[n]&&m[n](t)}function C(t){let n=k[t.code];b[n]=0,x[n]&&x[n](t)}function z(){b={}}function j(t,n,e="keydown"){const i="keydown"==e?m:x;[].concat(t).map((t=>i[t]=n))}var K=[],S=[];function T(t,n){if(t&&"undefined"!=typeof document){var e,i=1==n.prepend?"prepend":"append",s=1==n.Z,o="string"==typeof n.tt?document.querySelector(n.tt):document.getElementsByTagName("head")[0];if(s){var r=K.indexOf(o);-1===r&&(r=K.push(o)-1,S[r]={}),e=S[r]&&S[r][i]?S[r][i]:S[r][i]=c()}else e=c();65279===t.charCodeAt(0)&&(t=t.substring(1)),e.styleSheet?e.styleSheet.cssText+=t:e.appendChild(document.createTextNode(t))}function c(){var t=document.createElement("style");if(t.setAttribute("type","text/css"),n.attributes)for(var e=Object.keys(n.attributes),s=0;s<e.length;s++)t.setAttribute(e[s],n.attributes[e[s]]);var r="prepend"===i?"afterbegin":"beforeend";return o.insertAdjacentElement(r,t),t}}T("html,\nbody {\n  height: 100%;\n  width: 100%;\n  padding: 0;\n  margin: 0;\n  overflow: hidden;\n  user-select: none;\n}\n\nbody {\n  color: white;\n  transition: background-color 0.5s ease-out;\n}\nbody::after {\n  opacity: 0;\n  /* fade out loading banner */\n}\n\ncanvas {\n  position: absolute;\n}\n\nbutton.btn {\n  font-size: 26px;\n  font-family: monospace;\n  cursor: pointer;\n  color: gold;\n  border: 1px solid gold;\n  background-color: rgba(255, 255, 255, 0.2);\n  padding: 13px 26px;\n}",{});function E({tag:t,nt:n,text:e,et:i}){const s=document.createElement(t||"div");if(n&&s.classList.add(...n.split(" ")),e){const t=document.createTextNode(e);s.appendChild(t)}return i&&s.addEventListener("click",i),s}function _(...t){document.body.classList.add(...t)}function A(...t){document.body.classList.remove(...t)}let F;T('.sky {\n  position: absolute;\n  color: darkslateblue;\n  z-index: -1;\n}\n\n.sky[data-color="0"] {\n  color: darkslateblue;\n}\n.sky[data-color="1"] {\n  color: indigo;\n}\n.sky[data-color="2"] {\n  color: purple;\n}\n.sky[data-color="3"] {\n  color: saddlebrown;\n}\n.sky[data-color="4"] {\n  color: darkslategray;\n}\n\n.ended .sky[data-color] {\n  color: rgba(255, 215, 0, 0.1);\n}',{});let M=4;const O=[" ★ ° . .　 　 .　☾ °☆ 　.  * ¸ 　 . 　 .　 . ● 　 　 ★ 　° : .　 . 　 •  ○ ° ★　 .  　 * 　. . 　 ° ",". .　  　 :.　 . • ° ★　 . 　 * .  ★ ° 　 　.　 ☾ ° ☆ 　. *  ¸ .　 　 　 　. 　 ° 　. ● ★ ° ","　 ○ ° ★ 　 .　  *　. 　 　 . 　 　 . 　🛸 　 　. ★ ° . .　  .　 ☾ °☆ 　. * 　  ¸ .　  　 ★ 　 ° : . 　 . • 　 ° 　 . ● "];function $(){M=(M+1)%5,F.setAttribute("data-color",M)}T('@charset "UTF-8";\n.ended::after {\n  opacity: 0.15;\n  /* slightly fade in logo */\n}\n.ended.won {\n  background: darkslategray;\n}\n.ended.lost {\n  background: darkred;\n}\n\n.won::after {\n  content: "🏆️🐱🏆️\\ameow";\n}\n\n.lost::after {\n  content: "☠️🙀🔫\\a#!$§#";\n}\n\n.prepare[data-level]::after {\n  content: "🐱🚀🎹\\aLevel " attr(data-level);\n}\n\n.prepare[data-level="13"]::after {\n  content: "🐱🚀🎹\\a Custom";\n}\n\n.prepare:not(.started)::after {\n  opacity: 0.2;\n  /* fade in logo */\n}',{});class L{it;timing={};constructor(t){this.it=t}st(){if(this.timing.ot){const{value:t,rt:n}=this.ct(this.timing.ot);return 1===n&&(this.timing.ot.resolve(),delete this.timing.ot),t}return null}at(){if(this.timing.scale){const{value:t,rt:n}=this.ct(this.timing.scale);return 1===n&&(this.timing.scale.resolve(),delete this.timing.scale),t}return null}ht(t,n,e){const i=n*e*2*Math.PI;return this.timing.ot&&this.timing.ot.reject(),new Promise(((n,e)=>{this.timing.ot={startTime:new Date,duration:t,ut:0,lt:i,resolve:n,reject:e}}))}dt(t){return this.ft(t,1,0)}gt(t){return this.ft(t,0,1)}ft(t,n,e){return this.timing.scale&&this.timing.scale.reject(),new Promise(((i,s)=>{this.timing.scale={startTime:new Date,duration:t,ut:n,lt:e,resolve:i,reject:s}}))}ct({startTime:t,duration:n,ut:e,lt:i}){const s=new Date,o=Math.min((s-t)/n,1);return{rt:o,value:(i-e)*o+e}}}let H=1;let P=0;class R extends f.h{id;yt;wt=1;hidden;constructor(t){super({height:t.size,width:t.size,m:H,k:H}),this.id=P++,this.yt=t.size}update(t){super.update(),this.x>window.innerWidth&&(this.x=-this.width),this.x<-this.width&&(this.x=window.innerWidth),this.y>window.innerHeight&&(this.y=-this.height),this.y<-this.height&&(this.y=window.innerHeight)}xt(){this.x=o(0,window.innerWidth-this.width),this.y=o(0,window.innerHeight-this.height)}hide(){this.hidden=1}show(){this.hidden=0}bt(t){this.hide(),setTimeout((()=>{this.show(),this.kt()}),t)}vt(){this.setScale(H,H)}}class V extends R{it;type;Ct;zt;jt;constructor(t){super(t);const{type:n,Ct:e,size:i}=t;this.type=n,this.Ct=e||n,this.it=y({text:this.Ct,anchor:{x:.5,y:.5},font:`${i}px sans-serif`,x:i/2,y:i/2}),this.children.push(this.it),this.zt=new L(this.it,i),this.xt()}update(){const t=this.zt.st();null!==t&&(this.it.rotation=t);const n=this.zt.at()??1;this.it.setScale(n,n),this.Kt&&null===t&&n>.5&&super.update()}kt(){return this.wt=0,this.zt.dt(this.Kt?500:250).then((()=>(this.it.setScale(0,0),this.xt(),this.St(500).then((()=>this.wt=1))))).catch((()=>{}))}St(t){return this.it.setScale(0,0),this.zt.gt(t).catch((()=>{}))}}let U;T('@charset "UTF-8";\n@keyframes danger {\n  0% {\n    color: white;\n  }\n  50% {\n    color: orange;\n  }\n  100% {\n    color: white;\n  }\n}\n@keyframes pulse {\n  0% {\n    opacity: 1;\n  }\n  60% {\n    opacity: 0.5;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n.score {\n  font-size: 37px;\n  position: absolute;\n  right: 0;\n  padding: 7px 21px;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  z-index: -1;\n}\n.score span {\n  vertical-align: top;\n}\n\n.goal {\n  font-weight: bold;\n}\n\n.result.bot {\n  color: #bbb;\n}\n.result.human .player {\n  position: relative;\n}\n.result.human .player::after {\n  content: "🧑‍🚀";\n  font-size: 14px;\n  position: absolute;\n  bottom: 0;\n  left: -7px;\n}\n.result.human .swapped {\n  animation: danger 0.5s infinite;\n}\n\n.started .score span:not(.swapped) {\n  opacity: 0.5;\n}\n\nbody:not(.started) .score {\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 1;\n}',{});let Y=0,D=[];function N(t,n){U||(U=E({nt:"score"}),document.body.appendChild(U)),Y=t,D=n,G()}function X(){return Y}function G(){const t=D.map((t=>`${t.Tt()}`)).join("");U.innerHTML=`${t}<div class="goal">Goal:&nbsp;${Y}</div>`}const B=["😻","😸","🙀","😼","😹","😽","😿","😺","😾"],W=[{Et:"left",_t:"right"},{Et:"a",_t:"d"},{Et:"v",_t:"b"},{Et:"k",_t:"l"},{Et:"r",_t:"t"},{Et:"u",_t:"i"},{Et:"n",_t:"m"},{Et:"x",_t:"c"},{Et:"g",_t:"h"}];function q(){return B}const I=[{id:"1️⃣",At:1,Ft:"😻🎹"},{id:"2️⃣",At:2,Ft:"😻😸🎹🚀🚀"},{id:"3️⃣",At:3,Ft:"😻😸🙀🎹🚀🚀💥💥"},{id:"4️⃣",At:4,Ft:"😻😸🙀😼🎹🚀🚀💥💥🎹💩"},{id:"5️⃣",At:5,Ft:"😻😸🙀😼😹🎹🚀🚀💥💥🎹💩🔫🚀"},{id:"6️⃣",At:6,Ft:"😻😸🙀😼😹😽🎹🚀🚀💥💥🎹💩🔫🚀🎲🚀️"},{id:"7️⃣",At:7,Ft:"😻😸🙀😼😹😽😿🎹🚀🚀💥💥🎹💩🔫🚀🎲🚀☠️💩️"},{id:"8️⃣",At:8,Ft:"😻😸🙀😼😹😽😿😺🎹🚀🚀💥💥🎹💩🔫🚀🎲🚀☠️💩💥🎹️"},{id:"9️⃣",At:9,Ft:"😻😸🙀😼😹😽😿😺😾🎹🚀🚀💥💥🎹💩🔫🚀🎲🚀☠️💩💥🎹🚀☠️"}],J=[{id:"👽",At:13,Ft:"😻😸🙀😼😹😽😿😺😾🎹🚀🚀💥💥🎹💩🔫🚀🎲🚀☠️💩💥🎹🚀☠️🎹🚀🚀💥💥🎹💩🔫🚀🎲🚀☠️💩💥🎹🚀☠️👽👽👽👽👾🪐🪐🪐🪐"},{id:"🌈",At:13,Ft:"😻😸😹😽😺🎹🎹🎹🎹🚀🚀🚀🚀💥💥💥💥🎲🌈🌈🌈🦄🦄🦄🍭🍭🍭"},{id:"🐶",At:13,Ft:"😻😸🙀😼😹😽😿😺😾🎹🎹🎹🎹🚀🚀🚀🚀💥💥💥💥🔫☠️🐶🐶🐶🐶🐶🐶🐶🐶🐶"},{id:"🎸",At:30,Ft:"😸🙀😼😽😿😾🎹🎹🎹🎹🚀🚀🚀🚀🚀🚀💥💥💥💥🔫☠️🎹🎹🎹🎹🎸🎸🎺🎺🥁🥁👨‍🎤💃🕺🏽"},{id:"🍕",At:42,Ft:"😻😸🙀😼😹😽😿😺😾🎹🎹🎹🎹🚀🚀🚀🚀🚀🚀🚀🚀🚀💥💥💥🎲☠️🔫💩🍟🍟🍟😋🤤🌭🌭🌭🍕🍕🍕🧑‍🍳🧑‍🍳🍔🍔"},{id:"🏎️",At:37,Ft:"😻😸🙀😼😹😽😿😺😾🎹🎹🎹🎹🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🚀🏎️"},{id:"🐣",At:11,Ft:"😻😸😽😺🎹🎹🎹🎹🚀🚀🚀🚀🚀🚀💥💥💥🎲☠️💩🐣🐥🐰🐸🌷🌷🌼🍓"},{id:"🏖️",At:7,Ft:"😻😸🙀😼😹😽😿😺😾🎹🎹🎹🎹🚀🚀🚀🚀🚀🚀🚀🚀🚀💥💥💥💥💥🎲☠️🔫🔫🌴🌴🌴🐬🐬🐬🦩🦩🦩☀️☀️☀️☀️🏖️🏖️🏖️🍉🍉🍉🍉🍍🍍🍍"},{id:"🎃",At:13,Ft:"🙀😼😹😿😾🎹🎹🚀🚀🚀🚀💥💥💥💥🎲☠️🔫💩💩🧟🧟👻👻🎃🎃🕯️☠️🧙️🧙️🧹"},{id:"🎄",At:25,Ft:"😻😸🙀😼😹😽😺🎹🎹🎹🎹🚀🚀🚀🚀🚀🚀💥💥💥🎲☠️🔫💩🎄🎄🎄🎄🎅🎅🤶🤶🎁🎁🎁⛄⛄❄️❄️"}];class Q{it;parent;constructor(t,n,e){const i=n.yt/2.5,s=`${i}px sans-serif`,o=i/3;let r;r=e?{x:-(n.yt/2+o),y:n.yt/2-i+o}:{x:n.yt/2-i+o,y:-(n.yt/2+o)},this.it=new y({text:t,font:s,...r}),this.parent=n}hide(){this.parent.it.removeChild(this.it)}show(){this.parent.it.children.includes(this.it)||this.parent.it.j(this.it)}}T("@keyframes danger {\n  0% {\n    color: white;\n  }\n  50% {\n    color: orange;\n  }\n  100% {\n    color: white;\n  }\n}\n@keyframes pulse {\n  0% {\n    opacity: 1;\n  }\n  60% {\n    opacity: 0.5;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n.controls {\n  display: none;\n}\n\n.click-mode .controls {\n  position: fixed;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n.click-mode .controls .space, .click-mode .controls .enter {\n  padding: 7px 37px;\n  font-size: 37px;\n  margin: 37px;\n}\n.click-mode .controls .enter {\n  color: white;\n  border-color: white;\n  font-size: 26px;\n}\n.click-mode .controls .arrow {\n  display: none;\n  justify-content: center;\n  align-items: center;\n  font-size: 91px;\n  margin: 13px;\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.3);\n  width: 50%;\n  height: 100%;\n  cursor: pointer;\n}\n.click-mode .controls .arrow:first-child {\n  cursor: w-resize;\n}\n.click-mode .controls .arrow:nth-child(2) {\n  cursor: e-resize;\n}\n.click-mode.started .controls {\n  flex-direction: row;\n}\n.click-mode.started .arrow {\n  display: flex;\n}\n.click-mode.started .space, .click-mode.started .enter {\n  display: none;\n}\n.click-mode.started.screen-controls-swapped .controls {\n  flex-direction: row-reverse;\n}\n.click-mode.started.screen-controls-swapped .controls .arrow {\n  animation: danger 0.5s infinite;\n}\n.click-mode .keys {\n  display: none;\n}\n.click-mode:not(.expert) .enter, .click-mode:not(.prepare) .enter {\n  display: none;\n}",{});T('@charset "UTF-8";\n.config {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: rgba(0, 0, 0, 0.9);\n  color: white;\n  font-size: 37px;\n  z-index: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n}\n\n.config-desc {\n  text-align: center;\n}\n\ntextarea {\n  background: black;\n  color: white;\n  width: 40vw;\n  height: 30vh;\n  font-size: 37px;\n  letter-spacing: 10px;\n  padding: 13px;\n  margin: 13px;\n}\n\n.button-container {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  margin-top: 13px;\n}\n.button-container .emoji-btn, .button-container .adventure-btn {\n  cursor: pointer;\n  padding: 13px;\n  margin: 3px 7px;\n  background: #202;\n  border-radius: 13px;\n  font-size: 26px;\n}\n.button-container + .button-container .emoji-btn {\n  background: #002;\n}\n.button-container .adventure-btn {\n  background: #022;\n}\n\n.goal-input input {\n  display: inline-block;\n  background: black;\n  color: white;\n  font-size: 37px;\n  padding: 7px;\n  margin-top: 37px;\n  margin-bottom: 37px;\n  margin-left: 13px;\n  text-align: right;\n}\n.goal-input::after {\n  content: "x 🎹";\n  margin-left: 21px;\n}',{});const Z={Mt:"🐱🚀🎹.level",Ot:"🐱🚀🎹.expert",$t:"🐱🚀🎹.customLevel",Lt:"🐱🚀🎹.customGoal"};function tt(t){const n=Number(localStorage.getItem(t));return isNaN(n)?0:n}function nt(t,n){localStorage.setItem(t,`${n}`)}const et=5e3;let it=0,st=0,ot=0,rt=0;const ct=()=>st,at=()=>ot,ht=()=>rt,ut=t=>st=t,lt=t=>ot=t,dt=t=>rt=t;let ft;const pt=()=>ft;let gt=0;const yt=()=>gt;let wt=()=>{};function mt(...t){return wt(...t)}let xt=()=>{};const bt="click-mode";function kt(){_(bt)}function vt(){A(bt)}let Ct=()=>{};function zt(...t){return Ct(...t)}function jt(){return localStorage.getItem(Z.$t)||J[0].Ft}function Kt(){return tt(Z.Lt)||13}const St={Ht:"🐱",Pt:"🎹",Rt:"🚀",Vt:"💥",Ut:"🎲",Yt:"🔫",Dt:"💩",Nt:"☠️"},Tt=St.Ht;function Et(){return Object.values(St).filter((t=>t!==Tt))}const _t=13312;let At,Ft,Mt,Ot,$t;function Lt(){At||function(){At=E({nt:"config",et:t=>t.stopPropagation()});const t=E({nt:"config-desc",text:"Choose your next adventure or build your own"});At.appendChild(t),At.appendChild(Rt(I)),At.appendChild(Rt(J)),Mt=E({tag:"textarea"}),Mt.addEventListener("input",Yt),At.appendChild(Mt),At.appendChild(Pt(q(),1)),At.appendChild(Pt([...Et(),"👽","🪐"]));const n=E({nt:"goal-input",text:"Goal:"});Ot=E({tag:"input"}),Ot.type="number",Ot.min=1,Ot.max=_t,Ot.addEventListener("blur",Dt),n.appendChild(Ot),At.appendChild(n);const e=E({tag:"button",nt:"btn",text:"Load game",et:Ht});At.appendChild(e)}(),Ut(jt()),Ot.value=Kt(),document.body.appendChild(At),Mt.focus(),Ft=1}function Ht(t){if(t){const t=Vt(),e=Number(Ot.value),i=I.some((n=>n.At===e&&n.Ft===t));n=t,localStorage.setItem(Z.$t,n),function(t){nt(Z.Lt,t)}(e),mt(i?e:13)}var n;document.body.removeChild(At),Ft=0}function Pt(t,n){const e=E({nt:"button-container"});return t.forEach((t=>{const i=E({tag:"button",nt:"emoji-btn",text:t,et:()=>{n&&Vt().includes(t)?Ut(Vt().replace(t,"")):Ut(Vt()+t)}});e.appendChild(i)})),e}function Rt(t){const n=E({nt:"button-container"});return t.forEach((({id:t,At:e,Ft:i})=>{const s=E({tag:"button",nt:"adventure-btn",text:t,et:()=>{Ut(i),Ot.value=e}});n.appendChild(s)})),n}function Vt(){return Mt.value}function Ut(t){Mt.value=zt(t).join(""),Mt.focus()}function Yt(){Ut(Vt())}function Dt(){const t=Ot.value;t<1?Ot.value=1:t>_t&&(Ot.value=_t)}function Nt(){$t?.Xt(),$t?.Gt(1)}function Xt(){$t?.Xt(),$t?.Bt(1)}function Gt(){!function(...t){xt(...t)}()}function Bt(){Lt()}const Wt="screen-controls-swapped",qt=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}];class It{Wt;qt;It;Jt=0;Qt=0;Zt=0;tn;nn=0;constructor(t){this.Wt=t,this.en()}en(){this.Qt=3,this.Jt=o(0,3),this.sn()}reset(){clearTimeout(this.tn),this.on()}Gt(t){this.Zt&&!t?this.Bt(1):(this.Jt=(this.Jt+3)%4,this.sn())}Bt(t){this.Zt&&!t?this.Gt(1):(this.Jt=(this.Jt+1)%4,this.sn())}sn(){const{x:t,y:n}=qt[this.Jt];this.Wt.dx=t*this.Qt,this.Wt.dy=n*this.Qt}rn(){this.Qt=Math.max(this.Qt+1,3),this.sn()}cn(){this.Zt=1,this.Wt.hn.an?.show(),G(),this.nn&&_(Wt),clearTimeout(this.tn),this.tn=setTimeout((()=>{this.on()}),5e3)}un(t){if(this.qt&&this.It)return!this.Zt||t?`<span class="keys">[${this.qt}]&nbsp;[${this.It}]</span>`:`<span class="keys swapped">[${this.It}]&nbsp;[${this.qt}]</span>`}on(){this.Wt.hn.an?.hide(),this.Zt=0,this.tn=void 0,G(),this.nn&&A(Wt)}ln(t,n){var e;t&&n&&(j(t,(()=>{ct()&&(vt(),this.Wt.Xt(),this.Gt())})),j(n,(()=>{ct()&&(vt(),this.Wt.Xt(),this.Bt())})),this.qt="left"===t?"&larr;":t.toUpperCase(),this.It="right"===n?"&rarr;":n.toUpperCase(),"left"===t&&(this.nn=1,e=this.Wt,$t=e))}}class Jt extends V{Kt=1;dn=0;fn=1;hn={};controls;constructor(t){super({type:St.Ht,...t,size:1.5*t.size}),this.pn(),this.controls=new It(this),this.controls.en()}update(){super.update(),this.fn&&Math.random()<.02&&(Math.random()<.5?this.controls.Bt():this.controls.Gt())}reset(){this.controls.reset(),this.it.opacity=1}rn(){this.controls.rn()}Gt(t){this.controls.Gt(t)}Bt(t){this.controls.Bt(t)}gn(t){this.yn(2e3),this.zt.ht(1e3,t,2).then((()=>{this.controls.en()})).catch((()=>{}))}wn(t){t.kt(),this.kt()}mn(){this.controls.cn()}yn(t){this.dn=1,this.it.opacity=.6,setTimeout((()=>{this.dn=0,this.it.opacity=1}),t)}pn(){this.hn={xn:new Q("🧑‍🚀",this,1),bn:new Q("🏆️",this),an:new Q("💩️",this)}}}function Qt(t){return q().includes(t)}function Zt(t){return!Qt(t)}function tn(t){return/\p{Emoji}/u.test(t)}Ct=function(t){let n=function(t){const n=[];for(;t.length;){const[e]=t.match(/^[\u{1F1E6}-\u{1F1FF}]{2}|.[\ufe0e\ufe0f]?[\u{1F3FB}-\u{1F3FF}]?(\u200d\p{Emoji}[\ufe0e\ufe0f]?|[\u{E0020}-\u{E007F}])*[\ufe0e\ufe0f]?/u);tn(e)&&n.push(e),t=t.slice(e.length)}return n}(t),e=q().filter((t=>n.includes(t)));return e.push(...n.filter(Zt)),e.some(Qt)||e.unshift(q()[0]),e.includes(St.Pt)||e.push(St.Pt),e};class nn extends Jt{kn=0;vn=1;constructor(t){super(t);const{Et:n,_t:e}=t;this.controls.ln(n,e)}Xt(){this.fn&&(this.fn=0,this.hn.xn?.show(),this.Cn())}zn(){this.kn++,G()}Cn(){this.kn=0,this.hn.bn?.hide(),G()}Tt(){const t=X()<=9||this.kn>9?this.kn:"0"+this.kn,n=this.controls.un(this.fn);return`<div class="result ${this.fn?"bot":"human"}">\n                ${n}\n                <span class="player">${this.Ct}</span>\n                <span>Score:&nbsp;${t}</span>\n            </div>`}jn(){const t=this.kn>=X();return t&&this.hn.bn?.show(),t}get Kn(){return!this.fn}}const en=30,sn=50,on=60,rn=70,cn=100;function an(t){return t>=I.length}function hn(t){const n=Number(t);let e,i;13===n?(e=jt(),i=Kt()):(e=I[n-1].Ft,i=I[n-1].At);const s=zt(e),o=(r=s.length)<5?cn:r<5?rn:r<18?on:r<30?sn:en;var r;return{Sn:function(t,n){return(e=q().filter((n=>t.includes(n))),e.map(((t,n)=>({Ct:t,...W[n]})))).map((t=>new nn({...t,size:n})));var e}(s,o),Tn:function(t,n){return t.filter(Zt).map((t=>Et().includes(t)?new V({type:t,size:n}):function(t){return/([\u{1F3CE}\u{02603}\u{026c4}\u{026f4}-\u{026f9}\u{02708}\u{1f385}\u{1f3c2}-\u{1f3c4}\u{1f3c7}\u{1f400}-\u{1f43d}\u{1f43f}\u{1f466}-\u{1f47f}\u{1f481}-\u{1f483}\u{1f486}-\u{1f487}\u{1f574}-\u{1f575}\u{1f577}\u{1f57a}\u{1f600}-\u{1f64c}\u{1f64d}-\u{1f64e}\u{1f680}-\u{1f68e}\u{1f690}-\u{1f6a4}\u{1f6b2}\u{1f6b4}-\u{1f6b5}\u{1f6e5}\u{1f6e9}\u{1f691}-\u{1f697}\u{1f920}-\u{1f931}\u{1f934}-\u{1f93e}\u{1f970}-\u{1f97a}\u{1f980}-\u{1f9ae}\u{1f9cd}\u{1f9cf}-\u{1f9df}\u{1fab0}-\u{1fab3}])/giu.test(t)}(t)?new Jt({Ct:t,size:n}):new V({type:t,size:n})))}(s,o),At:i}}let un,ln,dn,fn,pn,gn,yn,wn,mn;function xn(t){un.innerHTML="",ht()?(yt()&&(13===pt()&&un.appendChild(yn),un.appendChild(pn),un.appendChild(gn)),un.appendChild(ln)):at()?(un.appendChild(t?wn:mn),un.appendChild(dn)):un.appendChild(fn)}function bn(){tt(Z.Ot)&&!yt()&&(_("expert"),j("enter",(t=>{vt(),Ft?Ht(1):Lt(),t.preventDefault()})),j("esc",(()=>{vt(),Ft&&Ht(0)})),gt=1)}T("@keyframes danger {\n  0% {\n    color: white;\n  }\n  50% {\n    color: orange;\n  }\n  100% {\n    color: white;\n  }\n}\n@keyframes pulse {\n  0% {\n    opacity: 1;\n  }\n  60% {\n    opacity: 0.5;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n.hints {\n  font-size: 37px;\n  display: block;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  padding: 11px;\n  z-index: -1;\n}\n\n.started .hints {\n  opacity: 0.5;\n}\n\nbody:not(.started) .hints {\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 1;\n}\n\n.expert-hint, .expert-state {\n  color: gold;\n}\n\n.bonus-level-hint {\n  color: purple;\n  opacity: 1;\n  animation: pulse 1s infinite;\n}\n\n.click-mode .expert-hint {\n  display: none;\n}",{});const kn="won",vn="lost",Cn="started",zn="ended",jn="prepare";let Kn,Sn=[],Tn=[],En=[];function _n(t,n,e,o){var c;Sn=t,Tn=n,(t=>{ft=t})(c=o),document.body.setAttribute("data-level",c),$(),N(e,Sn),Kn||(Kn=function({En:t=60,_n:n=1,update:e=h,p:o,context:r=s()}={}){let c,a,u,l,d,f=0,p=1e3/t,g=1/t,y=n?w:h;function m(){if(a=requestAnimationFrame(m),u=performance.now(),l=u-c,c=u,!(l>1e3)){for(i("tick"),f+=l;f>=p;)d.update(g),f-=p;y(r),d.p()}}return d={update:e,p:o,An:1,start(){c=performance.now(),this.An=0,requestAnimationFrame(m)},stop(){this.An=1,cancelAnimationFrame(a)}},d}({En:60,update:function(){if(!ct())return;if(Sn.forEach((t=>t.update())),Tn.forEach((t=>t.update())),En.forEach((t=>t.update())),at())return;const t=function(t){const n=[];for(let e=0;e<t.length-1;e++)for(let i=e+1;i<t.length;i++){let s,o,c=t[e],a=t[i];if(c.wt&&a.wt&&!c.hidden&&!a.hidden){if(c.Kt)s=c,o=a;else{if(!a.Kt)continue;s=a,o=c}r(s,o)&&n.push({Fn:s,it:o})}}return n}(Fn()),n=[];t.forEach((({Fn:t,it:e})=>{switch(e.type){case St.Ht:t.dn||e.dn||(t.gn(1),e.gn(-1));break;case St.Pt:t.vn&&t.zn(),n.push(e),$();break;case St.Rt:t.rn(),e.kt();break;case St.Vt:t.wn(e);break;case St.Ut:$(),Tn.forEach(((t,n)=>{t.zt.ht(1e3,n%2==0?-1:1,2).catch((()=>{})),t.kt()}));break;case St.Yt:i=t,s=e,Sn.filter((t=>t.id!==i.id)).forEach((t=>{const n=new V({type:St.Dt,size:t.yt/1.5});n.x=t.x+45*t.dx,n.y=t.y+45*t.dy,function(t){t.jt=1,t.St(300),t.zt.ht(300,1,1).catch((()=>{})),En.push(t)}(n)})),s.bt(et);break;case St.Dt:t.mn(),e.jt?function(t){const n=En.findIndex((n=>n.id===t.id));n>=0&&En.splice(n,1)}(e):e.kt();break;case St.Nt:t.vn&&t.Cn(),e.kt();break;default:t.dn||t.gn(1)}var i,s})),Sn.some((t=>t.jn()))?function(){lt(1);let t=0;Sn.some((t=>t.Kn&&t.jn()))?(_(kn),t=1,an(pt())&&(nt(Z.Ot,1),bn())):_(vn),_(zn),A(Cn),xn(t),async function(t){const n=Fn(),e=[];for(let i=0;i<n.length;i++)e.push(n[i].zt.ht(1e3,i%2==0?-1:1,t).catch((()=>{})));return Promise.all(e)}(t?2:1).then((()=>{ut(0),Sn.forEach((t=>t.reset()))}))}():n.forEach((t=>t.kt()))},p:function(){Fn().forEach((t=>!t.hidden&&t.p())),it=1}}),Kn.start())}function An(){var t;dt(1),lt(0),document.body.classList.contains(kn)?mt(an(t=pt())?13:t+1):mt(),A(zn,kn,vn),_(jn)}function Fn(){return[...Tn,...En,...Sn]}document.body.appendChild(E({tag:"canvas"})),function(){F=E({nt:"sky"});for(let t=0;t<1e3;t++){const t=document.createTextNode(O[o(0,2)]);F.appendChild(t)}document.body.appendChild(F)}(),un=E({nt:"hints"}),document.body.appendChild(un),ln=E({text:"Hit SPACE to start the adventure."}),dn=E({text:"Hit SPACE to continue."}),fn=E({text:"Bring your cat to a synthesizer."}),wn=E({text:"You won!"}),mn=E({text:"You lost!"}),pn=E({text:"Wow! You are a master of the chaos.",nt:"expert-state"}),gn=E({text:"Hit ENTER to build your own adventure.",nt:"expert-hint"}),yn=E({text:"Bonus adventure!",nt:"bonus-level-hint"}),function(){const t=E({nt:"controls"}),n=E({nt:"arrow",text:"←",et:Nt}),e=E({nt:"arrow",text:"→",et:Xt}),i=E({tag:"button",nt:"space btn",text:"SPACE",et:Gt}),s=E({tag:"button",nt:"enter btn",text:"Configure",et:Bt});t.appendChild(n),t.appendChild(e),t.appendChild(i),t.appendChild(s),document.body.appendChild(t),document.addEventListener("click",(()=>{kt()}))}();let{canvas:Mn}=function(e){return t=document.getElementById(e)||e||document.querySelector("canvas"),n=t.getContext("2d"),n.imageSmoothingEnabled=0,i("init"),{canvas:t,context:n}}();function On(){ct()||Ft||(ht()?(dt(0),ut(1),_(Cn),setTimeout((()=>{A(jn)}),2e3),xn()):An())}function $n(){const{width:t,height:n,scale:e}=function(){const t=window.innerWidth,n=window.innerHeight,e=t*n;return{width:t,height:n,scale:Math.sqrt(e)/Math.sqrt(15e5)}}();Mn.width=t,Mn.height=n,function(t){H=t}(e),window.outerWidth<600&&kt(),it&&Fn().forEach((t=>{t.vt(),t.xt()}))}$n(),window.addEventListener("resize",$n,0),function(){let t;for(t=0;t<26;t++)k[t+65]=k["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)k[48+t]=k["Digit"+t]=""+t;window.addEventListener("keydown",v),window.addEventListener("keyup",C),window.addEventListener("blur",z)}(),j("space",(()=>{vt(),On()})),bn(),(t=>{xt=t})(On),(t=>{wt=t})((function(t){t&&function(t){nt(Z.Mt,t)}(t);const n=tt(Z.Mt)||1,{Sn:e,Tn:i,At:s}=hn(n);_n(e,i,s,n),xn()})),An()}();
