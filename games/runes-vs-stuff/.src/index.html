<!DOCTYPE html><html><head><meta charset="utf-8"><title>Runes vs Stuff</title><meta name="author" content="xenohunter"><style>body{font:normal 20px monospace;overflow:hidden;cursor:default;margin:0;padding:50px 0}a,a:hover,a:active,a:visited{color:#000}#t,#f{width:1000px;box-shadow:0 1px 20px -3px #444;margin:auto}#t{height:45px;background:#555;text-align:center;color:#dfd}#f{height:400px;background:#999}#o{display:none;position:absolute;width:800px;height:300px;text-shadow:0 2px 20px #eee;text-align:center;transition:display ease .5s;margin:auto;padding:100px 100px 0}#s{color:#b0f}#ru.active,.R.rU{color:#feff66;text-shadow:0 2px 20px #feff66}#rt.active,.R.rT{color:#65d2f1;text-shadow:0 2px 20px #65d2f1}#rg.active,.R.rG{color:#abf5c2;text-shadow:0 2px 20px #abf5c2}#rh.active,.R.rH{color:#ae55fd;text-shadow:0 2px 20px #ae55fd}#h.h3{color:#3e5}#h.h2{color:#fe4}#h.h1{color:#e53}.T{float:left;width:20px;height:20px;line-height:1;text-align:center;font-weight:700}.M{color:#5f0;text-shadow:0 2px 20px #2d0}.C,.H{color:#fff}.R{font-size:140%;line-height:0.8}#ru,#rt,#rg,#rh,#h.h0{color:#aaa}</style></head><body><table id="t"><tr><td width="33">SCORE: <b id="s">0</b></td><td width="34">RUNES: <b id="ru">ᚢ</b> <b id="rt">ᛏ</b> <b id="rg">ᚷ</b> <b id="rh">ᚻ</b></td><td width="33">HEALTH: <b id="h">0</b></td></tr></table><div id="f"><div id="o"></div></div></body><script>"use strict";function $(a){return document.getElementById(a)}function rand(a,b){return a&&!b?Math.floor(Math.random()*a):a&&b?rand(a)+b:Math.random()}function randomY(a){return rand(H-a)}function randomRune(a){return rand()<a?runes[rand(4)]:void 0}function extend(a,b){for(key in b)a[key]||(a[key]=b[key]);a._=b.constructor.prototype}function scorecounter(a){score+=a,scoreboard.innerHTML=score}function healthcounter(a){healthboard.innerHTML=a,healthboard.className="h"+a}function Field(){var b,a=this.f=[];for(i=0;H>i;i++)for(a[i]=[],j=0;W+2*xgap>j;j++)b=xgap>j||j>=W+xgap,a[i][j]=new Tile(j,i,b)}function Tile(a,b,c){var d=this.e=document.createElement("div");this._c(),c&&(d.style.display="none"),container.appendChild(d)}function Unit(a,b,c,d,e,f){var g=this;g.wrd=a,g.cls=b,g.crd=c,g.cX=d||0,g.cY=e||0,g.hp=f||1,g.spd=1,g.pow=1,g._p=0,g.mv()}function Mage(){var a=this;extend(a,new Unit("\u21d2","M",[[1,0],[0,1],[1,1],[2,1],[1,2]],2,8,3)),healthcounter(a.hp),a.type="mage",a.pow=100,a.runes={Uruz:{a:0,e:null},Teiwaz:{a:0,e:null},Gebo:{a:0,e:null},Hagalaz:{a:0,e:null}}}function Cube(){extend(this,new Unit("CUBE","C",[[0,0],[1,0],[0,1],[1,1]],W+2,randomY(1),1)),this.type="enemy",this.rune=randomRune(.25),this.rune?this.points=10:this.points=1,this.tick()}function Hypercube(){extend(this,new Unit("HYPERCUBE","H",[[0,0],[1,0],[2,0],[0,1],[1,1],[2,1],[0,2],[1,2],[2,2]],W+3,randomY(2),rand(2,3))),this.type="enemy",this.rune=randomRune(.5),this.rune?this.points=25:this.points=5,this.tick()}function Bullet(a,b,c,d,e,f,g){extend(this,new Unit("\u2022","B",[[0,0]],a,b,0)),this.type="bullet",this.pow=c,this.spd=d,this.dirX=e,this.dirY=f||0,this.cb=g,this.tick()}function Rune(a,b){var c=[b[rand(b.length)]];extend(this,new Unit(a.symbol,"R "+a.cls,c,0,0,0)),this.type="rune",this.name=a.name,this.board=a.board,this.pow=0,this.tick()}function start(){"running"!==gameState&&(score=0,scorecounter(0),mage=new Mage,gameState="running",tick())}function tick(){rand()<.78?new Cube:new Hypercube,gameTimer=setTimeout(tick,rand(1200,600-Math.floor(score/10)))}function gameOver(){gameState="idle";for(key in controls)controls[key]=!1;clearTimeout(gameTimer),field.print("Game over! Your score is "+score+" points. Good job!",3e3)}var gameState="idle",gameTimer=null,score=0,overlay=$("o"),container=$("f"),scoreboard=$("s"),healthboard=$("h"),runes={0:{name:"Uruz",symbol:"\u16a2",board:$("ru"),cls:"rU"},1:{name:"Teiwaz",symbol:"\u16cf",board:$("rt"),cls:"rT"},2:{name:"Gebo",symbol:"\u16b7",board:$("rg"),cls:"rG"},3:{name:"Hagalaz",symbol:"\u16bb",board:$("rh"),cls:"rH"}},W=Math.floor(container.offsetWidth/20),H=Math.floor(container.offsetHeight/20),xgap=10,ticktime=120,controls={},field,mage,key,i,j;Field.prototype.is=function(a,b){return this.f[b]&&this.f[b][a+xgap]?this.f[b][a+xgap].u?-1:1:0},Field.prototype.get=function(a,b){return this.f[b][a+xgap]},Field.prototype.print=function(a,b,c){clearTimeout(this._t),overlay.innerHTML=a,overlay.style.display="block",this._t=setTimeout(function(){overlay.style.display="none",c&&setTimeout(c,400)},b||2e3)},Field.prototype.interrupt=function(a){clearTimeout(this._t),setTimeout(function(){overlay.style.display="none"},500),a()},Tile.prototype._c=function(a){this.e.className=a?"T "+a:"T"},Tile.prototype.set=function(a){a=a||null,this.u=a,this.e.innerHTML=a?a.gl():"",this._c(a?a.cls:0)},Unit.prototype.gc=function(a,b){return this.crd.map(function(c){return[c[0]+(0|a),c[1]+(0|b)]})},Unit.prototype.gl=function(){return this._p>=this.wrd.length&&(this._p=0),this.wrd.charAt(this._p++)},Unit.prototype.mv=function(a,b){var d,e,h,c=this,f=c.cX+(0|a),g=c.cY+(0|b);c._nc=c.gc(f,g),h=c._lc?c._nc.filter(function(a){for(i=0;i<c._lc.length;i++)if(a[0]===c._lc[i][0]&&a[1]===c._lc[i][1])return!1;return!0}):c._nc,h.forEach(function(a){var b=field.is(a[0],a[1]);1>b&&(d=!0),0===b?"mage"!==c.type&&c.hit(1e4):-1===b&&(e=field.get(a[0],a[1]).u,e.type!==c.type&&(c.hit(e.pow,e),e.hit(c.pow,c)))}),d||(c.cX=f,c.cY=g,c.undraw(),c.draw(),c._lc=c._nc)},Unit.prototype.draw=function(){var a=this;a._nc.forEach(function(b){field.get(b[0],b[1]).set(a)})},Unit.prototype.undraw=function(){this._lc&&this._lc.forEach(function(a){field.get(a[0],a[1]).set(null)})},Unit.prototype.hit=function(a,b){var c=this;c.hp-=a,c.hp<=0&&(!b||"bullet"!==b.type&&"mage"!==b.type||scorecounter(0|c.points),c.timer&&clearTimeout(c.timer),c.undraw(),c.cb&&c.cb.call(c,c),c.rune&&new Rune(c.rune,c.gc(c.cX,c.cY)))},Unit.prototype._t=function(){var a=this;return a.hp<=0?a.undraw():void(a.timer=setTimeout(function(){a.tick()},ticktime/(a.spd||1)))},Mage.prototype.attack=function(){var a=this,b=a.runes.Uruz.a,c=a.runes.Teiwaz.a,d=a.runes.Gebo.a,e=a.runes.Hagalaz.a,f=b&&c?3:b?2:1,g=d&&e?3:d?2:1,h=function(a){var c=a.cX,e=a.cY;b&&d&&(new Bullet(c,e,1,1,0,1),new Bullet(c,e,1,1,0,-1))};e&&c?(new Bullet(a.cX+3,a.cY+1,f,g,1,1,h),new Bullet(a.cX+3,a.cY+1,f,g,1,0,h),new Bullet(a.cX+3,a.cY+1,f,g,1,-1,h)):new Bullet(a.cX+3,a.cY+1,f,g,1,0,h)},Mage.prototype.hit=function(a,b){var c=this;return"rune"===b.type?void c.gain(b):(c._.hit.call(c,a,b),c.hp<0&&(c.hp=0),healthcounter(c.hp),void(0===c.hp&&gameOver()))},Mage.prototype.heal=function(a){var b=this;b.hp+=a,b.hp>3&&(b.hp=3),healthcounter(b.hp)},Mage.prototype.gain=function(a){var b=this.runes[a.name];clearTimeout(b.e),b.a=1,a.board.className="active",b.e=setTimeout(function(){b.a=0,a.board.className=""},2e4),i=0;for(key in this.runes)i+=this.runes[key].a;4===i&&this.heal(3)},Cube.prototype.tick=Hypercube.prototype.tick=function(){var a=this;a.mv(-1,0),a._._t.call(a)},Bullet.prototype.tick=function(){var a=this;return a._pX==a.cX&&a._pY==a.cY?a.undraw():(a._pX=a.cX,a._pY=a.cY,a.mv(a.dirX,a.dirY),void a._._t.call(a))},Rune.prototype.tick=function(){var a=this;a.mv(-1,0),a._._t.call(a)},field=new Field,function a(){var b=0,a=[['Welcome! This is \'Runes vs Stuff\' game.<br>It was made in two days for <a href="https://twitter.com/js13kGames" target="_blank">@js13kGames</a> competition.<br>I am <a href="https://twitter.com/xenohuntero" target="_blank">@xenohuntero</a>.',8e3],["By the way, you can skip that text with pressing on any key.",4e3],["Controls are \u2191 &amp; \u2193 and spacebar.<br>Your goal is to get as much points as possible.",6e3],["Runes will increase speed and damage of bullets.<br>Also, some set of active Runes will affect a way you attack.",7e3],["If you have all 4 Runes simultaneously, it restores your health.",4e3],["When game is over, you can start a new one by pressing spacebar.",4e3],["Enjoy!",2e3]],c=function(d){b==a.length&&d();var e=a[b++];field.print(e[0],e[1],function(){c(d)})};c(function(){window.onkeypress=function(){},start()}),window.onkeypress=function(){field.interrupt(start)}}(),function b(){controls.up?mage.mv(0,-1):controls.down&&mage.mv(0,1),controls.attack&&mage.attack(),setTimeout(b,ticktime)}(),window.onkeydown=function(a){if("running"===gameState){var b=a.keyCode;38==b?(controls.up=!0,controls.down=!1):40==b?(controls.down=!0,controls.up=!1):32==b&&(controls.attack=!0)}},window.onkeyup=function(a){if("running"===gameState){var b=a.keyCode;38==b?controls.up=!1:40==b?controls.down=!1:32==b&&(controls.attack=!1)}};</script></html>