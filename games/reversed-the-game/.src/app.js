'use strict';var d=!1;navigator.userAgent.match(/Android/i)&&(document.body.className+=" and",d=!0);navigator.userAgent.match(/iPhone|iPad/i)&&(d=!0);var aa=!!navigator.userAgent.match(/Firefox/i),f=document.createElement("p");f.style.cssText="pointer-events:auto";"auto"!=f.style.pointerEvents&&(document.body.className+=" nop");f=void 0;function ba(){this.j={}}function k(a,b,c){var e=m,h;e.j[a]=[];c.forEach(function(c,e){this.j[a].push({l:0,count:b,m:[]});for(h=0;h<b;++h){var l=new Audio;l.src=window.jsfxr(c);this.j[a][e].m.push(l)}},e)}ba.prototype.play=function(a){if(a=this.j[a])a=1<a.length?a[0|Math.random()*a.length]:a[0],a.m[a.l].play(),a.l<a.count-1?a.l++:a.l=0};var m=new ba;k("bip",1,[[1,,.1241,,.1855,.5336,,,,,,,,,,,,,1,,,.1,,.64]]);k("jmp",10,[[1,,.2228,,.2862,.4227,,.2045,,.422,.0985,,,,,,,,1,,,,,.64]]);
d||(aa||k("lnd",10,[[1,,.2548,,.1007,.7539,.0996,-.5302,,,,,,.7769,-.4436,,,,1,,,,,.5]]),k("lvl",2,[[0,,.0109,.5872,.456,.4171,,,,,,.5438,.5084,,,,,,1,,,,,.64]]),k("die",4,[[1,.0013,.3576,.0681,.8007,.5117,,-.3453,.0049,.148,-.2563,-.2717,.2608,,-.3543,-.1884,-.0106,-.0281,.9971,-.6629,-.7531,.0097,-.0086,.5]]),k("win",1,[[1,.0309,.5597,.0464,.7472,.369,,-.1366,,-.3111,,-.1581,-.8665,,-.0414,.2802,.0258,-.1198,.9955,.1759,,,-5E-4,.64]]));function ca(a,b){a=a<<13^a;var c=b;a*(a*a*15731+789221)+1376312589&536870912&&(c=-b);return c}function da(a){var b=Math.floor(a);a=a-b;var c=ca(b+0,a+0);return c+(ca(b+1,a-1)-c)*a*a*a*(a*(6*a-15)+10)};var n=[],p=0,ea=[0,1,5,2,0,5,2,4];function q(a){var b=a%12;if(1==b||3==b||6==b||8==b||10==b)a=0;return a}function t(a){if(a){var b=a-36;u=++u%8;if(!(b>n.length||0>b)){a=fa[u].getChannelData(0);for(var b=n[b],c=44100;c--;)a[c]=b[c];a=v.createBufferSource();a.buffer=fa[u];a.connect(w);a.start(0)}}}var v,fa=[],w,u=0;"undefined"==typeof requestAnimationFrame&&(["moz","webkit","ms"].some(function(a){a=this[a+"RequestAnimationFrame"];if("function"==typeof a)return requestAnimationFrame=a})||(requestAnimationFrame=function(a){return setTimeout(a,16)}));var x=document.getElementById.bind(document),ga=16/9,y,ha=1,ia=1,ja=0,z=0,A=!1,B=x("a"),ka=x("b"),la=x("c"),ma=x("i"),C=x("p"),D=x("s"),na=x("t"),oa=x("m"),pa=x("mm");ka.width=la.width=960;ka.height=la.height=540;if(d||!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext))pa.style.display="none";
function E(){var a=window.innerWidth,b=window.innerHeight,c;a/b>ga?a=b*ga:b=a/ga;B.style.width=a+"px";B.style.height=b+"px";var e=c=.5*(window.innerWidth-a);B.style.left=e+"px";e=b=.5*(window.innerHeight-b);B.style.top=e+"px";C.style.left=c+"px";C.style.top=b+"px";y=a/960;qa();D.style[F]="scale("+y+")translate(600px,240px)";na.style[F]="scale("+y+")translate(40px,160px)";pa.style[F]="scale("+y+")"}var F="transform";F in B.style||(F="webkitTransform");
function qa(){C.style[F]="scale("+y+")translate("+ja+"px,"+(A?z+90:z)+"px)scale("+ha+","+(A?-ia:ia)+")"}E();window.addEventListener("resize",E);window.addEventListener("orientationchange",E);var G=[";     xxx;     x;;;   xx  xx   x;   xx   xx xxx".split(";"),";;;;      xxxx;      xxxx;      xxxx".split(";"),"           vv;;;;;;     ^^".split(";"),"   vvvvvv;;;     xxxxxx;;;       ^^^^^^".split(";"),"   vvvv    vvvv;;;;;         xx;         xx".split(";"),"      vvvv;;;;;       xx;       xx".split(";"),"        vv   vvx;     xxx       x;     x         x;               x;;   xx  xx   x;   xx^^ xx xxx".split(";"),"     vvxxvv;       xx;;;;;       ^^".split(";"),"    vvvvvv;;;;      xxxx;;      ^^^^^^".split(";"),
"    <x    <x;          <x;;;;           <x;     <x    <x".split(";"),"    vvvvxxvvv;;    ^       ^;   <x       x>;    v       v;        ^^;        xx".split(";")," (  (( ( ((  (;   (   (   ( (; (  (  (  (  ( (; (   ( (   ( ((; ( ((  ( ((  ( (;(;".split(";"),";xxxxx;    x;    x;    x;xxxxx;".split(";")],ra=";One small step for a man;Walk softly;Overpass;Easy mode;Jumpy behavior;Tetris all the way down;Timing attack;Reason to fly;A door into summer;Cowards die in shame;Written for js13kGames–2015;This was a triumph".split(";"),
sa=";Click or tap anywhere on the screen to invert gravity;Avoid spikes: they kill you to death!;;;Click or tap in rapid succession while running;;;;;;;Reload the page to start a new game".split(";");var ta={"▄":"n","▀":"*","█":"Ш","░":"/"};function ua(a){var b=document.createElement("span");b.appendChild(document.createTextNode(a));b.className="t";C.appendChild(b);a=b.offsetWidth;C.removeChild(b);return a}for(var va=ua("x"),wa=!1,xa=4;xa--;)if(ua("▄▀█░"[xa])!=va){wa=!0;break}
var ya="  █▀▀▀▀▀█   ; ▄█▀▀▀▀▀▀▀▀ ; ▀▀▀▀▀▀▀▀▀▄ ;   ▀▀▀▀▀▀█  ;  ▀▀█▀▀▀█▀  ;  ▀█▀▀▀█▀   ".split(";").map(function(a){return(" ▄▄▄▄▀▀▀▀▀▄ \n█░         █\n█░░  >   < █\n█░░░`  ^  `█\n ▀█░░    █▀ \n o█░░░   █o \n"+a).replace(/./g,function(a){return wa&&ta[a]?ta[a]:a})}),H=document.createElement("p"),za="";ya.forEach(function(a,b){var c=document.createElement("span");c.className="b b"+b;c.appendChild(document.createTextNode(ya[b]));H.appendChild(c);za+="p.a"+b+" .b"+b+"{display:block}"});var Aa=document.createElement("style");
Aa.appendChild(document.createTextNode(za));document.head.appendChild(Aa);H.className="a5";C.appendChild(H);ha=92/H.clientWidth;ia=90/H.clientHeight;ja=434;z=274;E();function Ba(a){for(var b=4;b--;)a(),I.translate(21,0),I.rotate(.5*Math.PI)}
function Ca(){var a=I;a.scale(8,8);a.fillStyle="#fff";Ba(function(){a.fillRect(.5,.5,7,7);a.fillRect(8.5,.5,4,3)});a.fillRect(1.5,1.5,18,18);a.fillStyle="#7C7B7C";a.fillRect(2,2,17,17);a.fillStyle="#F9B6C3";a.fillRect(10,2,1,17);a.fillRect(2,10,17,1);a.fillStyle="#E5DDDC";a.beginPath();Ba(function(){a.rect(1,1,6,3);a.rect(1,4,5,1);a.rect(1,5,4,1);a.rect(1,6,3,1);a.rect(9,1,3,2);a.rect(8,5,5,4);a.rect(13,6,1,2);a.rect(14,7,1,1)});a.fill();a.fillStyle="#F478A0";a.beginPath();a.rect(7,9,7,2);a.rect(8,
8,2,4);a.rect(11,8,2,4);a.rect(9,10,3,3);a.rect(10,13,1,1);a.fill()};var Da=["xxxxxxxxxxxxxxxx"],G=G.map(function(a){return Ea(Da.concat(a).concat(Da))});
function Ea(a){function b(a){if(a.a){var b=a.pop();a.push([h,g,b[2]+1])}else a.push([h,g,1]),a.a=!0}var c=[],e=[],h,g;for(g=9;g--;)for(c.a=!1,e.a=!1,h=16;h--;)"x"==a[g][h]?(8!=g&&"x"!=a[g+1][h]?b(c):c.a=!1,0!=g&&"x"!=a[g-1][h]?b(e):e.a=!1):(c.a=!1,e.a=!1);var r=[];for(h=c.length;h--;)r.push(Fa(c[h],1));for(h=e.length;h--;)r.push(Fa(e[h]));r.sort(function(a,b){return b[0].y-a[0].y});c=[];e=[];for(h=16;h--;)for(c.a=!1,e.a=!1,g=9;g--;)"x"==a[g][h]?(15!=h&&"x"!=a[g][h+1]?b(c):c.a=!1,0!=h&&"x"!=a[g][h-
1]?b(e):e.a=!1):(c.a=!1,e.a=!1);var l=[];for(h=c.length;h--;)l.push(Ga(c[h],1));for(h=e.length;h--;)l.push(Ga(e[h]));l.sort(function(a,b){return b[0].x-a[0].x});c=[];for(g=9;g--;)for(c.a=!1,h=16;h--;)a[g][h]in{"^":1,v:1,"<":1,">":1}?b(c):c.a=!1;c=c.map(function(a){return{x:60*a[0],y:60*a[1],width:60*a[2],height:60}});return{c:a,p:r,o:l,s:c}}function Fa(a,b){var c=60*(a[1]+(0|b));return[{x:60*a[0],y:c},{x:60*(a[0]+a[2]),y:c}]}
function Ga(a,b){var c=60*(a[0]+(0|b));return[{x:c,y:60*a[1]},{x:c,y:60*(a[1]+a[2])}]};var Ha=[{x:"#FFF691",i:"#F7CA77",p:"#F602FD"},{x:"#04FEFE",i:"#04C0FB",p:"#E1FF5F"},{x:"#FF96F2",i:"#FD2AA1",p:"#F6FE48"},{x:"#27DE78",i:"#60FD93",p:"#FE035D"}],J=0,K=Ha[J];function Ia(){++J==Ha.length&&(J=0);K=Ha[J]};var L=ka.getContext("2d"),Ka=Ja(3),La=Ja(6),Na=Ja(9);function M(a,b){return~~(Math.random()*(b-a+1))+a}function Ja(a){for(var b=[],c=10*(12-a);c--;)b.push({x:M(0,960-a),y:M(60,480-a)});return b}function Oa(a){L.clearRect(0,0,960,540);Pa(Ka,3,"#5B8094",a);Pa(La,6,"#719CB9",2*a);Pa(Na,9,"#85B3C5",3*a)}function Pa(a,b,c,e){L.beginPath();for(var h=10*(12-b);h--;){var g=a[h];g.y-=e;60>g.y?(g.x=M(0,960-b),g.y+=540):480<g.y&&(g.x=M(0,960-b),g.y-=540);L.rect(g.x,g.y,b,b)}L.fillStyle=c;L.fill()};var I=la.getContext("2d");function Qa(a){I.font=a+"px 'Segoe UI','Helvetica Neue',sans-serif"}I.textAlign="center";
function Ra(a){var b,c,e=G[a];I.clearRect(0,0,960,540);I.beginPath();for(b=16;b--;)for(c=9;c--;)"x"==e.c[c][b]&&I.rect(60*b,60*c,60,60);I.fillStyle=K.x;I.fill();I.fillStyle=I.strokeStyle=K.i;a%2?Sa():Ta();I.beginPath();for(b=16;b--;)for(c=9;c--;)"^"==e.c[c][b]?Ua(b,c,0):"v"==e.c[c][b]?Ua(b,c,1):"<"==e.c[c][b]?Va(b,c,0):">"==e.c[c][b]?Va(b,c,1):"("==e.c[c][b]&&(I.fillStyle="#FFEB3B",I.fillRect(54*b+48,54*(c+.5)+27,54,54));I.fillStyle="#FEFDFB";I.fill();I.save();I.beginPath();for(b=16;b--;)for(c=9;c--;)"^"==
e.c[c][b]?I.rect(60*b,60*c,60,30):"v"==e.c[c][b]?I.rect(60*b,60*(c+.5),60,30):"<"==e.c[c][b]?I.rect(60*b,60*c,30,60):">"==e.c[c][b]&&I.rect(60*(b+.5),60*c,30,60);I.globalCompositeOperation="source-atop";I.fillStyle="#FE0302";I.fill();I.restore();I.beginPath();e.p.concat(e.o).forEach(function(a){I.moveTo(a[0].x,a[0].y);I.lineTo(a[1].x,a[1].y)});I.lineCap="square";I.lineWidth=2;I.strokeStyle=K.p;I.stroke();Qa(25);ra[a]&&Wa('"'+ra[a]+'"',521);sa[a]&&Wa("PROTIP: "+sa[a],40)}
function Wa(a,b){var c=b-25,e=c+16,h=e+16,g=.5*(960-I.measureText(a).width);I.beginPath();I.moveTo(g,c);I.lineTo(960-g,c);I.quadraticCurveTo(960-g+16,c,960-g+16,e);I.quadraticCurveTo(960-g+16,h,960-g,h);I.lineTo(g,h);I.quadraticCurveTo(g-16,h,g-16,e);I.quadraticCurveTo(g-16,c,g,c);I.fillStyle="rgba(0,0,0,0.5)";I.fill();I.fillStyle="#fff";I.fillText(a,480,b,900)}
function Ua(a,b,c){I.moveTo(60*a,60*(b+(c^=1)));I.lineTo(60*(a+.25),60*(b+(c^=1)));I.lineTo(60*(a+.5),60*(b+(c^=1)));I.lineTo(60*(a+.75),60*(b+(c^=1)));I.lineTo(60*(a+1),60*(b+(c^1)))}function Va(a,b,c){I.moveTo(60*(a+(c^=1)),60*b);I.lineTo(60*(a+(c^=1)),60*(b+.25));I.lineTo(60*(a+(c^=1)),60*(b+.5));I.lineTo(60*(a+(c^=1)),60*(b+.75));I.lineTo(60*(a+(c^1)),60*(b+1))}
function Sa(){var a=2,b=6.26E-4,c=.5>Math.random()?-.1:.1,e;.5>Math.random()&&(a=4,b=-b);I.save();I.translate(480,270);I.rotate(.5>Math.random()?.5*c:c);I.translate(-480,-270);I.globalCompositeOperation="source-atop";for(c=-10;58>c;++c){I.beginPath();for(e=-10;37>e;++e)I.arc(20*(c+.5),20*(e+.5),a+=b,0,2*Math.PI);I.fill()}I.restore()}
function Ta(){var a=10*Math.sqrt(2),b;I.save();I.translate(480,270);I.rotate(.25*(.5>Math.random()?-1:1)*Math.PI);I.translate(-479.5,-269.5);I.globalCompositeOperation="source-atop";I.beginPath();for(b=-960;1920>b;b+=a)I.moveTo(b,-540),I.lineTo(b,1080);I.lineWidth=2;I.stroke();I.restore()}Ra(0);function Xa(a,b,c,e){return((b.x-a.x)*(c.y-a.y)-(c.x-a.x)*(b.y-a.y))*((b.x-a.x)*(e.y-a.y)-(e.x-a.x)*(b.y-a.y))}function Ya(a,b,c){var e;if(!(e=c[0].y<a[0].y==c[0].y<b[0].y)&&(e=0<Xa(a[0],b[0],c[0],c[1])&&0<Xa(a[1],b[1],c[0],c[1]))){var h=c[0];e=h.x-a[0].x;var h=h.y-a[0].y,g=a[1].x-a[0].x,r=b[0].x-a[0].x,l=b[0].y-a[0].y,Ma=g*l-0*r,g=-(0*e-g*h)/Ma;e=(e*l-r*h)/Ma;e=!(0<=g&&1>=g&&0<=e&&1>=e)}e||(b[0].y=b[1].y=c[0].y+(a[0].y>b[0].y?1:-1),b.b=0,b.g=!0)};function N(){A=!1;return{x:10,y:225,width:92,height:90,h:.1,g:!1,f:4,b:0}}
function Za(a){a>=G.length&&(a=G.length-1);Ra($a=a);ab=G[a].p;bb=G[a].o;cb=G[a].s;if(a==G.length-1){I.save();I.translate(706,314);Ca();I.restore();a=Math.min(Math.max(420,690),680);var b=Math.min(Math.max(440,710),700);I.beginPath();I.moveTo(420,100);I.lineTo(700,100);I.quadraticCurveTo(740,100,740,140);I.lineTo(740,260);I.quadraticCurveTo(740,300,700,300);I.lineTo(b,300);I.lineTo(700,330);I.lineTo(a,300);I.lineTo(420,300);I.quadraticCurveTo(380,300,380,260);I.lineTo(380,140);I.quadraticCurveTo(380,
100,420,100);I.fillStyle="rgba(229,221,220,0.6)";I.fill();I.lineWidth=2;I.strokeStyle="#fff";I.stroke();Qa(40);I.fillStyle="#101010";I.fillText("You've beat the game,",560,150,320);I.fillText("ASCII person.",560,192,320);I.fillText("But your princess is",560,234,320);I.fillText("in another castle.",560,276,320);m.play("win")}else a&&m.play(1==a?"bip":"lvl")}var O=N(),$a,ab,bb,cb;Za(0);var P;
function db(){var a=Date.now(),b=a-P;P=a;O.g&&(O.f+=.1*b,4<O.f&&(O.f=4));O.b+=b*O.h;var c;c=0>O.b?[{x:O.x,y:O.y}]:[{x:O.x,y:O.y+O.height}];c.push({x:c[0].x+O.width,y:c[0].y});var e=[{x:c[0].x+O.f,y:c[0].y+O.b}];e.push({x:e[0].x+O.width,y:e[0].y});e.b=O.b;e.g=!1;ab.forEach(function(a){Ya(c,e,a)});0>O.b?O.y=e[0].y:O.y=e[0].y-O.height;O.b=e.b;!O.g&&e.g&&m.play("lnd");O.g=e.g;c=[{x:O.y,y:O.x+O.width}];c.push({x:c[0].x+O.height,y:c[0].y});e=[{x:c[0].x+O.b,y:c[0].y+O.f}];e.push({x:e[0].x+O.height,y:e[0].y});
e.b=O.f;bb.forEach(function(a){a=[{x:a[0].y,y:a[0].x},{x:a[1].y,y:a[1].x}];Ya(c,e,a)});O.x=e[0].y-O.width;O.f=e.b;H.className="a"+(a>>>6)%6;return b}var eb=!1,fb=!0;function gb(){var a=Date.now(),b=a-P;P=a;eb||(requestAnimationFrame(gb),Oa(b*O.h),fb&&!d&&hb(b))}P=Date.now();requestAnimationFrame(gb);
function ib(){requestAnimationFrame(ib);940<O.x+O.width&&(O=N(),Ia(),Za($a+1));for(var a=cb.length;a--;){var b=cb[a],c=O;if(c.x<b.x+b.width&&c.x+c.width>b.x&&c.y<b.y+b.height&&c.height+c.y>b.y){m.play("die");O=N();break}}a=db();Oa(a*O.h);ja=O.x;z=O.y;qa();fb&&!d&&hb(a)}function jb(a){a.preventDefault();eb||(eb=!0,D.style.display=na.style.display="none",ma.style.pointerEvents="auto",O=N(),Ia(),Za(1),P=Date.now(),requestAnimationFrame(ib))}D.addEventListener("click",jb);
D.addEventListener("touchstart",jb);
if(!d){var kb=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(kb){for(var lb,Q=0;60>Q;++Q){for(var mb=lb=new Float32Array(44100),R=880*Math.PI*Math.pow(2,(36+Q-69)/12),S=0;44100>S;++S){var T=S/44100,U=T+=1.5E-4*da(12*T),V=T*R*.2,V=V%1,W=.15+.6*U,X=.65-.5*U,Y=50*V*(V-1)*(V-.2)*(V-W)*(V-X),V=T*R*.401,V=V%1,W=.12+.65*U,X=.67-.55*U,nb=50*V*(V-1)*(V-.4)*(V-W)*(V-X),V=T*R*.399,V=V%1,W=.14+.55*U,X=.66-.65*U,ob=50*V*(V-1)*(V-.8)*(V-W)*(V-X),Y=Y+.02*da(1E3*T),Y=Y/(T*R*.0015+.1),nb=
nb/(T*R*.002+.1),ob=ob/(T*R*.0025+.1);mb[S]=(Y+nb+ob)/3}n[Q]=lb}v=new kb;for(var pb=0;8>pb;++pb)fa[pb]=v.createBuffer(1,44100,44100);w=v.createGain();w.connect(v.destination);w.gain.value=.3}}var Z=0;function hb(a){Z+=a;if(300<=Z&&(Z=Z%300,!d)){a=36;var b,c;b=16;for(c=0;3>c;++c)a+=ea[~~(p/b)%8],b*=.5;b=a+12+ea[~~(p/b)%8];c=b+12+ea[p%8];c=q(c);t(c);0==p%2&&(c=b,b=q(b),t(b),b=q(c+3),0==b&&(b=q(c+4)),t(b));0==p%4&&(a=q(a),t(a));++p}};function qb(a){a.preventDefault();m.play("jmp");O.h=-O.h;A=!A}document.body.addEventListener("keyup",function(a){32!=a.which&&32!=a.keyCode||qb(a)});ma.addEventListener("click",qb);ma.addEventListener("touchstart",qb);oa.addEventListener("change",function(){fb=oa.checked});
