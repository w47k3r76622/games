<!doctypehtml><html lang=en><meta charset=UTF-8><meta content="width=device-width,height=device-height,initial-scale=1,user-scalable=no"name=viewport><title>The Monk's Window</title><link href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üë¥üèº</text></svg>"rel=icon><div id=container><div id=viewport><div id=middle class=slide data-x=500 data-y=1800 data-z=-200><button onclick='nextSlide("gmatch")'id=war>To Battle!</button><div id=monk><svg viewBox="0 0 170 323"xmlns=http://www.w3.org/2000/svg><defs><radialGradient cx=.6 cy=.3 id=svg_10 spreadMethod=pad r=.5><stop offset=0 stop-color=#704f31 /><stop offset=1 stop-color=#3f2e1f /></radialGradient><radialGradient cx=.7 cy=.3 id=svg_17 spreadMethod=pad><stop offset=0 stop-color=#513720 /><stop offset=1 stop-color=#261f1a /></radialGradient><filter id=displacementFilter><feTurbulence baseFrequency=0.03 numOctaves=3 result=noise type=fractalNoise /><feDisplacementMap in=SourceGraphic in2=noise scale=100 xChannelSelector=R yChannelSelector=G /></filter><mask id=circleMask><circle class=displacement cx=200 cy=200 fill=#fff r=0 /></mask><filter id=light><feSpecularLighting lighting-color=#998 result=spec4 specularExponent=20><fePointLight x=120 y=40 z=100><animate attributeName=x dur=14s repeatCount=999 values=40;200;40 /><fePointLight/></feSpecularLighting><feComposite in=SourceGraphic in2=spec4 k1=0 k2=1 k3=1 k4=0 operator=arithmetic /></filter></defs><path d="M79 130c-65 83-56 148-56 148s-65 44 45 38 79-55 79-55-3-214-68-131z"fill=url(#svg_17) id=svg_1 /><g transform="rotate(3 67 211)"><path d="M59 280V142"class=thread /><path d="M63 272V150"class=thread /></g><path d="M90 73c-65 3-69 61-62 80s97 25 121 6 11-90-18-87 24-2-41 1z"fill=url(#svg_10) id=svg_2 /><text font-size=90 x=58 y=81 id=svg_3 text-anchor=start>üë¥üèº</text><text font-size=49 x=50 y=159 id=svg_4 text-anchor=start>‚úãüèº</text></svg></div></div><div id=window class=slide data-x=800 data-y=1600 data-z=-500></div><div id=gmatch class=slide data-x=300 data-y=-500 data-z=-800></div><div id=gboard class=slide data-x=300 data-y=4070 data-z=-2200><h1 style=font-size:30px>Place your Vassal. Jump 3 to win. Other pieces cannot jump you.</h1><div id=b-base></div><h1 id=capt></h1></div></div></div><div id=options><button onclick=toggleSFX(event)>SFX</button> <button onclick=toggleMusic(event)>Music</button><div id=winners style=display:none><button onclick='nextSlide("window"),document.getElementById("winners").classList.toggle("window")'id=winner>Appreciate the window</button> <button onclick='nextSlide("middle"),document.getElementById("winners").classList.toggle("window")'id=party>Back to the Party</button></div></div><div id=start-help class=help><svg viewbox="0 0 400 400"class=deco id=crown><text font-size=340 x=10 y=300 lengthAdjust=spacingAndGlyphs mask=url(#circleMask) textLength=350>üëë</text></svg><br><h1>The Monk's Window</h1><p>Guide your vassals to victory!<br>Complete 9 stained glass window panes for the monastery.</p><br><div><button id=go style=opacity:0>Let's Go!</button></div><svg viewbox="0 0 400 400"class=deco id=diamond textLength=400><text font-size=340 x=10 y=300 lengthAdjust=spacingAndGlyphs mask=url(#circleMask) textLength=350>üíé</text></svg></div><script>eval(Function("[M='MvFoHl_izcolt_uwxSLLBeHW|gTZH[c`BzYLxNJ|?pj]ubH}pJnfXiLxde|FQuqzXuBpgjCf]`HGomr|CHPA{zdSup`jKPvVhGiMPWRRHGpppBxyG]baz|yuN{}~nIBbN^OyRd[c_iiUjJVDV{ZH@NDr`qrDF|FW[JsuEsN_jTxrM?x~tSArk^tAii^nO~WmrlK@LCK@exutfMUIjq|QVIV?AfQRKbj}|AAyteACNeV`@AKhhbvzuMxuT[ArSQ`snceI]Yy{bmNTURm@WQLCSdQj[{hTL`OXC`Ggn[bOjwhltHvAv{dzuTbPeqGraskTQ]u?{vinEJZoJjePufJYeKLAnr`[BK]xqEXrCDfKvf?@EImTNYGyqsmdXl?jlzSVlq`A?JY]H|tSEZXUiwpZLoVXlNsWJoXlFA?`gd@wzJ{lp_WcEuEWVcSW{iOB`gA[pOnTRs}s?X_lGLz~DoAAQO@ASlhXRVy~VbVRHc_WxhgwTwrCQNd^zPYX{Zy?DK_UWXMNQsjKe^P}Bg]yzqZaWuBO@EsotDzuS?^BkSjT[nwBVw@JZtF@UwbzLSJ`@HhNeGt@Ja^N]eZuHD~b`i{a^AmZ_Xu[IVlBWFuKfoIpv`Kv@VVevFqRlQQ}W]NY|pTa|CiOCANeH@na_zR[u{t|SARoC~FjtNc?fHYOpXdzH~xcbSx@qZ[HWlYye^BXATVxikPsEbz]b{d?aY|WbcpU]rlmaZoglBT?AdYPrZa?kLQX|ntZTTm^Y]{HinYqIEQeNppmN~e^OCFBNZYD}VAXKVoH?loE|k[jqUjGgpkiYnvlwftD{z@uBxxsKAKSWcTLsfudd}VzZ^qf[tJ|Qoc{JiUgVuGav@pJfHOuMz{}YU@gQEBIkJy^^vAlHtVS|FIO_^jyJ@PrmcoyvdUB_XglgGg@pj[{eSuDgXqfn`WoimBqXXVzPZKe}~lFqcB}{ttTq[r]vEsCWqef]cEnDwXJBUD^yeJWGuWXO~HPLuEeF|EJcBWs}]ZxK`w]}[xYpmpivdsuOnGHEV@GE[nBi^FukwPNWBW^yLxyByHi?Qm`mdyTj{SlLPEuSagaMEZGsJdZKbq~uYhq[ukT^tIrrGEGdZlJoC_O_EN@He`Clr}e~YrK`AbmiNbvElZmZRhK_^u^XMMnBCge~dCDs[p?p{n_V}OKWiAgbZiol@?GMnzELmfQgVCAMiseK^q_q|O`dB{N|aWd@gagPJ@Cs^Bawv}MmDZLF[nbRwqKQU~lSi@_Vv^GjijqXvcW^WjyDdFya~fi]}UrTmJ}zLiRaGiuydSng}YXRBEyUmywmAUMO`TKRqHIxSd|@]MocBwsCD`wY]PfW{cNOqx~skeqd~rYz?CxGUcicVAEUsW~XSRVhZ|Z_JNqMCh[ZWUPBNVQ{MUnGZk_^]qcK^@KntcyQyVM]nY}LiPteJVChA~LiAb|cfolyaFoWkixL|BrEt_VGyoOdROHItct_kRB@DllWwKQZ{EHA@^XHJB[mh~lXwCsJi]BNAMbhUtPSMpPMMp]@?}nwuksncHIIjr_wut~YbGeMYIeZQb}JssvKBUaW^BTKJGsaEPLOQ?NyvPQixM?]vQe}YfmLSjDs^IHpY]kdob~YGT]^DVpRkdBK~fPO_I}W|sEeuVetTCWGrYntrWvjZHguLbErAgujktX@T~CfT?Oh_teWQIhSRtsmaZcF}UKDtUQQ^MOikT^S?ABMfW~^fC_kHSQ|f||^[qONQqn]mN_vBYyi^jBAcX^WTANo]StmeShXTvQuVASVjielm~q@_eZpzTSxarcEaLovSR?pW`zCI^z{MgxRS{^FpQSaCAIrqPWXP|bId_zXHf`Li^rYUDf][okIa|ovB|NBmq~oEkargdhuNCpR^P|@w^MQadvM`GnHx|^LrwNbxBVmyTXcazwIz^p_c`coiOaDoblEaJR`ECHnYodALJ@gxsGehwhw`qc^sNph?H@a]uwvlv@DP^DSPBb|ZdO_bGzcBKtdJGQGpy{ZC]knQuAI~lw{VnYP`F{atlDpk?nHCc[petyQ_PfM{p|[aLiLg[hC?IEy}]rKTAQ?iQh@BK~wlJGVZ|XL}Nzm^FW{bRDP^jZdEoI_upAv@CT@m^FPkgPInSoR}Ee|A{WaOkCkQIpSKm{uz{zp?EwUos]saFyKRBZkBdb[lvH[Qw`LPBlX}`bdHa@azOD_zohGal^VmoA[dFRJmdxJvfZjLYKxBrYSHmQE?LI}JU^EDa^c{wU`?cUqHJjq{UA@rHuTRrHW{_@XO^]KJH[_AF]@`B|a_COf@LsB`_tVYukFjb@eY?RFPi]r^NxpMdalzn[dZPby]]YUJIGdO_t[TW`JGjFWMc|jISOqMnJKFsFkVTzpqBGLUH`^q{gK[gUI[cr{NcBsmDZmh`Aga_dyet]RfFls@jqtnbQqk^?vD^JOIxYqOI~cVy`@]tcFoTXbkOZmKp`k^swHrxQHiL{{dZlpI_WsA~bkV[V^oHch|ogZad~cD_eBgS_kFnR_QgkUft^OQuoD^j}MU]EoVEFwfuTBkzV?lw@DxM|QR|N{_@v|_aznck|F_XSTNiDg{n]gXpQlZb`RHVzCONUetGwkNv`c[TrdUburLd{MiMIOXmZAA?FYWFlw@ho|IK[kPIhH`vUMtMhYQq@zjmvBhjKReYsSy}tsd@qaUB}e]wcX`bGJvTqPuvm}OCqZDPLAtrU|mlgdUT^MdnHScmFNEjjdTcuM|sq?]flL]TcofB^Fab[YQcTk?MN_XmNugMlj`?OjtqIAdmesGMYUXZqJwDIlou@[cYsDXeGlelhMYFwB{YKeOxXkaPm[vZz[v^ABvIpxpoELyhphYVaeb@IDH~KtQD~OlW`vLSrNVjX_[fDvuBKa{R]Kg?E{lE`sLUCfepVlrgzEDLlZSPafZGKxesjjKyJrxUOJ^dHcPpz?COsTpiXlcfHnTC]xg~uAK_yhTswEEB@y|Y[qYW@HpehhhhG}_jDpegIZ|KNjlp?_scVybfavVwlq^N?vMr`Lb^OczJenElq}AupazEYRkkg_}_BYJoeZ]LJ`^tzPtqffxqEST^ooC?_BFA[@K[wwYi_^CrS_SBg}|dRMbOYYQmsP{d}hd|JLfECfjah}}el@wpluD`YCNqDpX|mevoRA^a|xgJohStNeZvmuk?vcL[Igf?MuzZjqE{a?psGHaAocE{FxM~`cD|eX|W`hFw@Z[~XzZCW{@?UjhEURLnShfcB^GmEleeLsHtl{`oErLxp{v}WCtrbEzE~nAnFk`TqHN@HI}yOsteXQ^UYgj]|Fv{zYG|EMegp`XyaETODQiQwDwB|N?~`e{ltzERZvfY{VqXiAMDBr@dMewlQSnE^SO`iRLR}Y~gj`bAfZuj?|GgJ?~@FAsy_~SIKabERtXWtuFO{]GXQxQ]UhZ[}WrasHEVAy{A]qjycC~Qew]``TR[N@qPVvxOjsuTyqpGrwBpWDs[`m@Lg{AtgAgZMX|Lh`JSe~{[x?@fKLpdXqeD}gqxAsWDS{ImC`NMBuoNATIrvwP|Aal~{{{irMmca?GaMloZiVjrKlle^_SV~@PYCtUASYKsVEsVMX|y|NaPPjPPFBSsJXDM^CcPvSLLQuG|tAjcDHEQGYB]H{|CaB]HDbwWEe|TU_{adjw`UP?LCuyOYCZ_TmhCR~sXa`lL`ATe_u~aOwAHeV}d`[{nVO[YtUYn`Ll@DW_paJn|UKn{uPJarFSL}PI]_tWSs{'"
,...']charCodeAtUinyxpf',"for(;e<9052;c[e++]=p-=128,A=A?p-A&&A:(p==39|p==96)&&p)for(p=1;p<128;y=f.map((n,x)=>(U=r[n]*2+1,U=Math.log(U/(h-U)),t-=a[x]*U,U/500)),t=~-h/(1+Math.exp(t))|1,i=o%h<t,o=o%h+(i?t:h-t)*(o>>17)-!i*t,f.map((n,x)=>(U=r[n]+=(i*h/2-r[n]<<13)/((C[n]+=C[n]<5)+1/20)>>13,a[x]+=y[x]*(i-t/h))),p=p*2+i)for(f='010202103203210431053105410642065206541'.split(t=0).map((n,x)=>(U=0,[...n].map((n,x)=>(U=U*997+(c[e-n]|0)|0)),h*32-1&U*997+p+!!A*129)*12+x);o<h*32;o=o*64|M.charCodeAt(d++)&63);for(C=String.fromCharCode(...c);r=/[\0-]/.exec(C);)with(C.split(r))C=join(shift());return C")([],[],1<<17,[0,0,0,0,0,0,0,0,0,0,0,0],new Uint16Array(51e6).fill(1<<15),new Uint8Array(51e6),0,0,0,0))

const viewport=document.getElementById("viewport"),container=document.getElementById("container"),slides=[...document.getElementsByClassName("slide")],captured=[];let vassals=[],contexts=[],interval;const config={width:1200,height:910,base:[0,2e3,0,0,0,0],volmul:2};let music=!1,sfx=!0,winning=!1;const m=Math,randBetween=(e,t)=>~~(m.random()*(t-e+1)+e),drum=[1,.5,121,,.12,,,4,,,,,,,,,,0,.05],low=[.7,0,200,.1,3,.2,,3.5,,,,,.02,,,,,.72,.12,.5],dink=[.7,0,206,.01,.1,.1,1,1.77,,,50,.07,,.1,,,.2,.51,.3,.07],trumpet=[.5,0,100,.03,.53,.45,2,2.2,,,50,.25,.2,.1,,,.13,.35,.1,.1],bell=[.5,0,166,.002,.7,.9,,2,.3,,,,.01,,,,,.6,.07,.86],emojis=["üêï","üêà","üêÅ","üêá","ü¶ä","üêª","üê¥","ü¶Å","üè∞","üå∑","‚öîÔ∏è","üìú","üëë","ü¶Ñ","üçÑ","ü¶î","üåπ","üåª","üåº","üå±","‚òòÔ∏è","üçÄ","üå∞","üå≤","‚öúÔ∏è","üêç","üïäÔ∏è","ü¶â","ü¶¢","üçì","üç∑","üçá","üçû","üóùÔ∏è","ü¶ó","üî±","üê∏","ü¶ö","üêî","üíÄ","ü¶á","üåà","üêñ","üéÄ","ü§ùüèª","ü•Ä","üñ§","‚ù§Ô∏è","üêå","ü¶®","üê¢","üíé","üí™üèΩ","üî•","‚òÑÔ∏è","‚òÄÔ∏è","üïØÔ∏è","ü•™","üçñ","üßÖ","ü•Ñ","ü¶ã","üåÆ","üê≥","üßÅ","ü¶∑","‚ùÑÔ∏è","üêê","üêë","ü••","‚òÅÔ∏è","üçÜ","ü™ø"];function weightedRandomNumber(e,t){const n=-.3*m.random();return e+~~((m.pow(m.E,n)-1)/(m.pow(m.E,-.3)-1)*(t-e+1))}zzfxV=.3,zzfx=(e=1,t=.05,n=220,a=0,s=0,o=.1,r=0,l=1,i=0,d=0,c=0,m=0,h=0,g=0,u=0,f=0,p=0,w=1,y=0,v=0,x=Math,b=44100,T=2*x.PI,E=(i*=500*T/b/b),z=(n*=(1-t+2*t*x.random(t=[]))*T/b),$=0,M=0,I=0,k=1,L=0,B=0,C=0,S,j)=>{if(sfx){for(e*=config.volmul,d*=500*T/b**3,u*=T/b,c*=T/b,m*=b,h=b*h|0,j=(a=b*a+9)+(y*=b)+(s*=b)+(o*=b)+(p*=b)|0;I<j;t[I++]=C)++B%(100*f|0)||(C=r?1<r?2<r?3<r?x.sin(($%T)**3):x.max(x.min(x.tan($),1),-1):1-(2*$/T%2+2)%2:1-4*x.abs(x.round($/T)-$/T):x.sin($),C=(h?1-v+v*x.sin(T*I/h):1)*(0<C?1:-1)*x.abs(C)**l*zzfxV*e*(I<a?I/a:I<a+y?1-(I-a)/y*(1-w):I<a+y+s?w:I<j-p?(j-I-p)/o*w:0),C=p?C/2+(p>I?0:(I<j-p?1:(j-I)/p)*t[I-p|0]/2):C),$+=(S=(n+=i+=d)*x.cos(u*M++))-S*g*(1-1e9*(x.sin(I)+1)%2),k&&++k>m&&(n+=c,z+=c,k=0),!h||++L%h||(n=z,i=E,k||=1);return(e=zzfxX.createBuffer(1,j,b)).getChannelData(0).set(t),(n=zzfxX.createBufferSource()).buffer=e,n.connect(zzfxX.destination),n.start(),n}},zzfxX=new AudioContext;{let e,t,n,a,s,o,r,l,i,d,c,m,h,g,u,f,p,w,y,v,x,b;o=(s=Object).getPrototypeOf,r=document,l=(e,t,n,a)=>(e??(setTimeout(n,a),new Set)).add(t),i=(e,t,a)=>{let s=n;n=t;try{return e(a)}catch(e){return console.error(e),a}finally{n=s}},d=e=>e.t=e.t.filter((e=>e.l?.isConnected)),m=o(c={get val(){return n?.add(this),this.o},get oldVal(){return n?.add(this),this.i},set val(e){let n=this;if(e!==n.o){n.o=e;let a=new Set;for(let e of[...n.u])p(e.f,e.s),e.g=1,e.h.forEach(a.add,a);for(let e of a)e.u=e.u.filter((e=>!e.g));n.t.length?t=l(t,n,x):n.i=e}}}),h=o(i),g=e=>({__proto__:c,o:e,i:e,t:[],u:[]}),u=e=>o(e??0)===c,f=(t,n)=>{let s=new Set,o={f:t},c=i(t,s,n);for(let t of s)a=l(a,t,(()=>(a.forEach(d),a=e)),1e3),t.t.push(o);return o.l=(c??r).nodeType?c:new Text(c)},p=(e,t=g())=>{let n=new Set,a={f:e,h:n,s:t};t.val=i(e,n);for(let e of n)e.u.push(a);return t},y={},v=t=>new Proxy(((n,...a)=>{let[l,...i]=o(a[0]??0)===m?a:[{},...a],d=t?r.createElementNS(t,n):r.createElement(n);for(let[t,a]of s.entries(l)){let r=n=>n?s.getOwnPropertyDescriptor(n,t)??r(o(n)):e,l=n+","+t,i=y[l]??(y[l]=r(o(d))?.set??0),m=i?i.bind(d):d.setAttribute.bind(d,t),g=o(a??0);g===c?f((()=>(m(a.val),d))):g!==h||t.startsWith("on")&&!a.v?m(a):f((()=>(m(a()),d)))}return w(d,...i)}),{get:(t,n)=>t.bind(e,n)}),x=()=>{let n=[...t].filter((e=>e.o!==e.i));t=e;for(let t of new Set(n.flatMap(d))){let n=t.l,a=f(t.f,n);t.l=e,a!==n&&(a!=e?n.replaceWith(a):n.remove())}for(let e of n)e.i=e.o},b={add:w=(t,...n)=>{for(let a of n.flat(1/0)){let n=o(a??0),s=n===c?f((()=>a.val)):n===h?f(a):a;s!=e&&t.append(s)}return t},_:e=>(e.v=1,e),tags:v(),tagsNS:v,state:g,val:e=>u(e)?e.val:e,oldVal:e=>u(e)?e.oldVal:e,derive:p},window.van=b}const{div:div,button:button,span:span,h1:h1,h2:h2}=van.tags,synth=window.speechSynthesis;let voice,utterance;const speak=(e,t=.4)=>{sfx&&(synth.cancel&&synth.cancel(),utterance=new SpeechSynthesisUtterance(e),utterance.voice=voice,utterance.volume=t*config.volmul,utterance.rate=.8,synth.speak(utterance))},win=()=>{[...document.getElementsByClassName("circle")].forEach(((e,t)=>{e.innerText=vassals[t%vassals.length]})),winning=!0,music=!1,contexts.forEach((e=>{e&&"running"==e.state&&e.close()})),contexts=[],interval&&clearInterval(interval),war.style.display="none",chooser.style.display="none",holder.style.opacity="1",zzfx(...low),zzfx(...[.7,0,200,.1,3,.2,,3.5,,,100,,.25,,,,,.42,.12,.5]),zzfx(...[.7,0,400,.1,3,.2,,3.5,,,,,,,,,,.72,.12,.5]);let e=[...document.getElementsByClassName("circle")].concat([...document.getElementsByClassName("light")]).concat([document.getElementById("central")]);setTimeout((()=>{nextSlide("middle"),document.body.classList.add("winning"),document.getElementById("winners").style.display="block",speak("We bless you, and your wonderful efforts."),setTimeout((()=>{const t=["svg_1","svg_2","svg_3","svg_4"];let n=-1;const a=document.getElementById("monk"),s=.3;setInterval((()=>{n+=1;document.getElementById(t[n%t.length]).style.transform=`translate3d(${10*Math.random()-5}px,0px, 0)`,o%2==0?zzfx(...[.03,0,1501,,.12,,,2,,,,,,,,,,0,.05]):zzfx(...[.06,0,501,,.12,,,2,,,,,,,,,,0,.05])}),200),setInterval((()=>{zzfx(...[1,0,121,,.12,,,4,,,,,,,,,,0,.05]),[...new Array(4)].forEach((()=>e[~~(Math.random()*e.length)].style.filter=`hue-rotate(${360*Math.random()}deg)`)),a.style.filter=`hue-rotate(${20*Math.random()-10}deg)`}),400),setInterval((()=>{a.style.transform=`scale(1.5) translate3d(${180*Math.random()}%,350px, 0) rotate(${Math.random()>.5?-3:3}deg`}),5e3);let o=0;setInterval((()=>{o+=1;const e=randomName(emojis[~~(Math.random()*emojis.length)]);o%3==0&&(document.getElementById("winners").classList.remove("window"),nextSlide("middle")),o%4==0?Math.random()>.5?Math.random()>.5?speak("My lady? My lady lady? wha?",s):speak("My lord? What's up.",s):speak(`My goodness, ${e.split(",")[0]}, a trip to ${e.split(", of")[1].trim()}? ${Math.random()>.5?"Never been there!":"Sounds Lovely!"}`,s):speak(["Hello, ","Hi there, ","My dear, ","Welcome, ","We bless your efforts, "][~~(5*Math.random())]+e.split(",")[0],s)}),1e4),setInterval((()=>{[...new Array(4)].forEach(((t,n)=>{setTimeout((()=>{zzfx(...bell),e.forEach((e=>e.style.filter=`hue-rotate(${90*(n+1)}deg)`))}),1e3*n)}))}),25e3)}),5e3)}),5e3)},len=.5,musicVolume=.02*config.volmul,P=(D,index)=>{contexts[index]=new AudioContext;const ac=contexts[index];with(I=+len,ac)with(G=createGain())for(i=0;i<D.length;i++)with(createOscillator())D[i=+i]&&"0"!=D[i]&&(connect(G),G.connect(destination),start(i*I+.3),frequency.setValueAtTime(440*1.06**(-105+D.charCodeAt(i)-14),i*I+.2),frequency.setTargetAtTime(440*1.06**(-105+D.charCodeAt(i)-10),i*I+.25,.02),type="triangle",gain.setTargetAtTime(.01,i*I+.2,.01),gain.setValueAtTime(musicVolume+.008,i*I+.3),gain.setTargetAtTime((m.random()+.004)*musicVolume,i*I+.3+.1,.05),gain.setTargetAtTime(.001,i*I+.3+I,.05),stop(i*I+.3+I-.01));setTimeout((()=>{"running"==ac.state&&ac.close()}),1e3*(D.length*I+.3+I-.01))},songs=["xzxzxzl0lnlnlng0dddgggd0nlodnlodnlodq0nlonlq","bhh0bhh0bhhjjji0bhh0bhh0bhhiilln0ppn0ppn0pqb","aaae0aaae0cccaaaeeea00hhhm00jjjr00lllmmmlqlm","lm0fedc0op0ihgf0lm0fedc0lm0fefi0lmnolmnolmno","lp0phijk00lp0phijkk0lpkj0ijki0lp0lp0lp0phijk"],playMusic=e=>{const t=songs[~~(m.random()*songs.length)];contexts=[null,null],P(t,0),setTimeout((()=>{P(t,1)}),e||0)},toggleSFX=e=>{e&&e.target.classList.toggle("strike"),sfx=!sfx,sfx||synth.cancel&&synth.cancel()},toggleMusic=e=>{e&&e.target.classList.toggle("strike"),music=!music,contexts.forEach((e=>{"running"==e.state&&e.close()})),contexts=[],interval&&clearInterval(interval),music&&(playMusic(),interval=setInterval((()=>{music&&playMusic(250*~~(8*m.random()))}),3e4))},windowScale=()=>{const e=window.innerHeight/config.height,t=window.innerWidth/config.width;config.size=e>t?t:e,container.style=`transform: scale(${config.size})`};window.onresize=windowScale;const viewportTransform=e=>`transform: rotateZ(${(e=e.map((e=>-e)))[5]}deg) rotateY(${e[4]}deg) rotateX(${e[3]}deg) translate3d(${e[0]}px, ${e[1]}px, ${e[2]}px)`,contentTransform=e=>`transform: translate(-50%, -50%) translate3d(${e[0]}px, ${e[1]}px, ${e[2]}px) rotateX(${e[3]}deg) rotateY(${e[4]}deg) rotateZ(${e[5]}deg);`;let ns,points,degs,vals;ns=null,points=[0,0,0],degs=[0,0,0],viewport.style=viewportTransform(config.base);const warbtn=document.getElementById("war"),nextSlide=e=>{warbtn.classList.remove("shown"),"middle"!=e||winning||(speak("we bless you, and your efforts",.7),setTimeout((()=>{warbtn.classList.add("shown"),setTimeout((()=>{zzfx(...bell)}),800)}),2900)),e=document.getElementById(e),slides.forEach((e=>e.classList.remove("active"))),e.classList.add("active"),points=[e.dataset.x||0,e.dataset.y||0,e.dataset.z||0],degs=[0,-10*currentIndex,0],vals=points.concat(degs),e.style=contentTransform(vals),viewport.append(e),container.style=`transform: scale(${config.size})`,windowScale(),e.style=contentTransform(vals),viewport.style=viewportTransform(vals),currentIndex=(currentIndex+1)%slideValues.length};slides.forEach(((e,t)=>{points=Object.values(e.dataset).map((e=>Number(e))),degs=[0,-30*t,0],vals=points.concat(degs),e.style=contentTransform(vals)}));const slideValues=["middle","gmatch","gboard","window"];let currentIndex=0,c,ctx;const size=200,complexity=50,colors=["#0288db","#00b3c7","#086dbd","#01c0cc","#4783d8","#45d2ef","#49c0ff","#0091bb","#76a3ff","#019ce5"];function main(e){const t=div(),n=div({class:"light"}),a=div({class:"crest"}),o=div({class:"cover"});o.style.backgroundImage=`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='filter'%3E%3CfeTurbulence seed='${~~(1e3*Math.random())}' baseFrequency='.006 .2' numOctaves='2'/%3E%3CfeDiffuseLighting surfaceScale='3' lighting-color='%234e3c2f'%3E%3CfeDistantLight elevation='110' /%3E%3C/feDiffuseLighting%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23filter)'/%3E%3C/svg%3E")`,t.onclick=()=>{if(a.innerText=captured.shift(),t.classList.toggle("open"),document.getElementById("panes").innerHTML=captured.join(" "),zzfx(...[,0,100,.14,.5,.41,,15,,,20,.25,.19,,,,,.52,.23,.4]),0==captured.length){if(9==document.getElementsByClassName("open").length)return void setTimeout(win,1e3);nextSlide("middle")}},t.classList.add("bord"),c=document.createElement("canvas"),c.classList.add("glass"),c.width=size,c.height=size,ctx=c.getContext("2d");let i=[];for(x=f=0,w=[];f<(s=size);f++)w[f]=[];for(let e=0;e<(l=complexity);e++)i.push([~~((r=m.random)()*s),~~(r()*s),~~(r()*size)]);for(let e=0;e<s;e++)for(let t=0;t<s;t++)for(let n=1/(j=0);j<l;j++){let a=i[j];(d=m.hypot(a[0]-e,a[1]-t))<n&&(n=d,w[e][t]=a[2])}draw(),n.appendChild(c),n.appendChild(a),t.appendChild(n),t.appendChild(o),e.appendChild(t)}function draw(){for(var e=0;e<size;e++)for(var t=0;t<size;t++)ctx.fillStyle="black",w[e-1]&&w[e+1]?w[e][t]==w[e-1][t]&&w[e][t]==w[e][t-1]&&w[e][t]==w[e+1][t]&&w[e][t]==w[e][t+1]&&(ctx.fillStyle=colors[w[e][t]%colors.length],ctx.fillRect(e,t,1,1)):ctx.fillRect(e-2,t-2,5,5)}function cloneCanvas(e){var t=document.createElement("canvas"),n=t.getContext("2d");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0),t}const holder=div({id:"holder"}),central=div({id:"central"});van.add(document.getElementById("window"),div({id:"chooser",class:"help"},h2("Select the panes to glorify your victory!"),h1({id:"panes"})),div({id:"high"},van.add(holder,central),div({id:"wall"},div({id:"holder1",class:"b-hold"}),div({id:"holder2",class:"b-hold"}),div({id:"holder3",class:"b-hold"}))));for(let i=1;i<4;i++){const holdme=document.getElementById(`holder${i}`);main(holdme),main(holdme),main(holdme)}const panes=document.getElementsByClassName("glass");central.style.backgroundImage=`url(${panes[6].toDataURL()})`,[...new Array(10)].forEach(((e,t)=>{if(1==t)return;const n=div(),a="188px";n.classList.add("circle"),n.style.transform=`translate(\n    calc(cos(${55+36*t}deg) * ${a}), \n    calc(sin(${55+36*t}deg) * ${a})\n  )`,n.style.filter="contrast(0.8) brightness(1.2)",n.style.backgroundImage=`url(${panes[t%panes.length].toDataURL()})`;const s=div();n.appendChild(s),holder.appendChild(n)}));let round=0;const gameLoop=e=>{round+=1,vassals.push(e);const t=130;let n=[];const a=document.getElementById("b-base"),s=document.getElementById("capt");a.classList.remove("winner"),a.innerHTML="",s.innerHTML="";let o=[e];for(;-1!==o.indexOf(e);)o=emojis.sort((()=>Math.random()-.5)).slice(0,5);const r=div({id:"player",class:"hidden player",emoji:e},...[...new Array(10)].map(((t,n)=>div({class:"zer",style:`transform: translateZ(${.02*n}em) rotateZ(45deg)`},e))));van.add(a,[...new Array(5)].map((e=>[...new Array(5)])).map(((e,t)=>div({class:"row"},e.map(((e,n)=>div({id:`cell-${t}-${n}`,class:"cell"})))))),[...new Array(10)].map(((e,a)=>()=>{const e=round%2==0?a%2+3:a%2,s=a%5,r={bad:o[a%o.length],row:e,col:s,id:"baddie"+n.length};return n.push(r),div({id:r.id,class:"baddy",style:`transform: translate3d(${s*t}px,${e*t}px,0)`,emoji:r.bad},...[...new Array(10)].map(((e,t)=>div({class:"zer",style:`transform: translateZ(${.02*t}em) rotateZ(45deg)`},r.bad))))})),r);const l=(e,t)=>{arr=[];for(var n=-1;n<=1;n+=2)arr.push([e+n,t]);for(var a=-1;a<=1;a+=2)arr.push([e,t+a]);return arr.filter((e=>e[0]>-1&&e[0]<5&&e[1]>-1&&e[1]<5))},i=()=>{const e=r.dataset.loc.split(",").map((e=>Number(e))),o=l(e[0],e[1]),d=n.map((t=>(t.dist=Math.sqrt(Math.pow(e[0]-t.row,2)+Math.pow(e[1]-t.col,2)),t))).sort(((e,t)=>e.dist-t.dist+.3*Math.random())).filter((t=>(t.moves=l(t.row,t.col).filter((t=>-1===o.concat([e]).concat(n.map((e=>[e.row,e.col]))).map((e=>e.toString())).indexOf(t.toString()))),t.moves.length>0)))[0],c=d.moves.sort((e=>Math.random()-.5))[0];d.row=c[0],d.col=c[1],document.getElementById(d.id).style.transform=`translate3d(${d.col*t}px,${d.row*t}px,0)`;let m=l(e[0],e[1]);m=m.map((t=>{const a=n.map((e=>[e.row,e.col])),s=a.filter((e=>e[0]==t[0]&&e[1]==t[1]))[0];if(s){const t=[s[0]-e[0]+s[0],s[1]-e[1]+s[1]];return!a.filter((e=>e[0]===t[0]&&e[1]==t[1]))[0]&&t[1]>-1&&t[1]<5&&t[0]>-1&&t[0]<5?{col:t[0],row:t[1],cap:!0,bad:s}:null}return{col:t[0],row:t[1]}})).filter((e=>e)),m.map((e=>document.getElementById(`cell-${e.col}-${e.row}`))).forEach(((e,o)=>{e.classList.add("highlight"),e.onclick=l=>{l.preventDefault(),l.stopPropagation();const d=m[o],c=e.id.split("-").slice(1).map((e=>Number(e)));if(r.style.transform=`translate3d(${c[1]*t}px,${c[0]*t}px,0)`,r.dataset.loc=c,[...document.getElementsByClassName("highlight")].forEach((e=>{e.classList.remove("highlight"),e.onclick=null})),d.cap){const e=n.findIndex((e=>e.row==d.bad[0]&&e.col===d.bad[1])),t=document.getElementById(n[e].id);t.classList.add("dead"),[...t.children].forEach((e=>{e.style.transform=`translate3d(${800*Math.random()-400}px, ${800*Math.random()-400}px, ${200*Math.random()}px) rotateX(${2e3*Math.random()-1e3}deg) rotateY(${2e3*Math.random()-1e3}deg) scale(0.5)`,e.style.filter="contrast(0) brightness(10)",e.style.opacity="0"})),setTimeout((()=>{t.classList.add("hidden"),t.parentElement.removeChild(t),n.splice(e,1)}),500),zzfx(...trumpet),captured.push(t.getAttribute("emoji")),s.innerText+=t.getAttribute("emoji")}else zzfx(...drum);captured.length<3?setTimeout(i,600):(document.getElementById("panes").innerHTML=captured.join(" "),zzfx(...drum),setTimeout((()=>{a.classList.add("winner"),zzfx(...drum),zzfx(...[.7,0,662,.17,1.2,.2,,,.25,,420,.5,.25,,,,.03,.86,.1,1]),[...document.getElementsByClassName("baddy")].concat([...document.getElementsByClassName("cell")]).forEach((e=>e.style.transform="rotate(45deg) scale(0)")),setTimeout((()=>{zzfx(...drum)}),500)}),500),setTimeout((()=>{setTimeout((()=>{a.classList.remove("winner")}),5e3),nextSlide("window")}),2100))}}))},d=[...document.getElementsByClassName("cell")].filter((e=>round%2==0?Number(e.id.split("-")[1])<3:Number(e.id.split("-")[1])>1));d.forEach((e=>{const n=e.id.split("-").slice(1).map((e=>Number(e)));e.classList.add("highlight"),e.onclick=e=>{e.preventDefault(),e.stopPropagation(),r.classList.remove("hidden"),r.style.transform=`translate3d(${n[1]*t}px,${n[0]*t}px,0)`,r.dataset.loc=n,d.forEach((e=>{e.classList.remove("highlight"),e.onclick=null})),setTimeout(i,300)}}))},start=button({id:"s-match",role:"button"},"Click for New Vassals"),gmatch=document.getElementById("gmatch"),randOne=span({id:"rand-one",class:"rand"}),randTwo=span({id:"rand-two",class:"rand"});function randomName(e){const t=["Rose","Lily","Black","Fern","Violet","Ivy","Holly","Basil","Thyme","Sage"],n=["Hill","Valley","River","Lake","Meadow","Forest","Stone","Cave","Brook","Glen","Field"],a=["ham","shire","cott","worth","bury","stead","well","bridge","church","ville","thorn"],s=t[Math.floor(Math.random()*t.length)],o=n[Math.floor(Math.random()*n.length)],r=Math.random()>.5?a[Math.floor(Math.random()*a.length)]:a.sort((()=>.5-Math.random())).slice(0,~~(3*Math.random())).join("");return`${Math.random()>.5?"sir":"lady"} ${Math.random()<.9?"":"mick"}${e} ${r}, of ${s}${o}`}van.add(gmatch,start,div({id:"s-dialog"},div({id:"match-hold"},div({class:"backing"},randOne),div({class:"tiny"},"or"),div({class:"backing"},randTwo))));const clearMatch=()=>{setTimeout((()=>{randOne.innerText="",randTwo.innerText="",randOne.parentElement.classList.remove("spark"),randTwo.parentElement.classList.remove("spark")}),1e3)};let booping=!1,timer;const beepBoop=()=>{if(!booping||timer>900)return setTimeout((()=>{zzfx(...trumpet),randOne.parentElement.classList.add("spark"),randTwo.parentElement.classList.add("spark");const e=randomName(randOne.innerText);randOne.onclick=()=>{""!=randOne.innerText&&(speak(e),nextSlide("gboard"),clearMatch(),gameLoop(randOne.innerText),zzfx(...drum))};const t=randomName(randTwo.innerText);randTwo.onclick=()=>{""!=randTwo.innerText&&(speak(t),nextSlide("gboard"),clearMatch(),gameLoop(randTwo.innerText),zzfx(...drum))},speak(`Choose Your Vassal, , , , ${e}, , or ${t}`)}),250),zzfx(...dink),booping=!1,gmatch.style.pointerEvents="auto",void(start.disabled=!1);zzfx(...[.4,.5,400,.05,.2,.02,,4,,,,,,,,,.25,.13,.1,.6]),timer*=m.max(1.06,timer/(600*weightedRandomNumber(.3,1))),setTimeout((()=>{const e=randOne.innerText+randTwo.innerText;for(;randOne.innerText+randTwo.innerText===e||randOne.innerText===randTwo.innerText||""==randOne.innerText||""==randTwo.innerText;)m.random()>.5?randOne.innerText=emojis[~~(m.random()*emojis.length)]:randTwo.innerText=emojis[~~(m.random()*emojis.length)];beepBoop()}),m.min(700,timer))};start.onclick=()=>{timer=100,booping=!0,gmatch.style.pointerEvents="none",start.disabled=!0,randOne.parentElement.classList.remove("spark"),randTwo.parentElement.classList.remove("spark"),beepBoop()},setTimeout((()=>{voice=speechSynthesis.getVoices().filter((e=>"en-GB"===e.lang))[0];const e=document.getElementById("go");e.addEventListener("click",(()=>{document.getElementById("start-help").style.display="none",container.classList.add("playing"),toggleMusic(),nextSlide("middle")})),e.style.opacity="1",document.querySelector(".displacement").animate([{r:"0"},{r:"300"}],{duration:4e3,iterations:1,fill:"forwards"}),[...document.getElementsByTagName("button")].forEach((e=>e.addEventListener("click",(e=>{e.stopPropagation(),e.preventDefault(),zzfx(...drum)}))))}),10);</script>