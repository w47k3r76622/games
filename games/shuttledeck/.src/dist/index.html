<html><meta name=viewport content=width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0><style>canvas{width:100%;height:100%;}body{margin:0;background:#000;}</style><canvas><script>const canvas=document.getElementsByTagName("canvas")[0],ctx=canvas.getContext("2d");var w,h;function width(){return w}function height(){return h}function resize(){canvas.width=+window.innerWidth,canvas.height=+window.innerHeight,w=canvas.width,h=canvas.height}ctx.imageSmoothingEnabled=!0,resize(),window.addEventListener("resize",resize);var g=[];function get(){return g}function remove(t){g=g.filter(e=>e!=t)}function clear(e){g=[]}function pulse(t,l,i,n){var o=0;return e=>{o+=e,t((Math.sin(o/n*6.3)+1)/2*(i-l)+l)}}function e(){var l={};return{clear:()=>l={},on:(e,t)=>(l[e]||(l[e]=[])).push(t),off:(e,t)=>l[e]=(l[e]||[]).filter(e=>e!=t),emit:(e,t)=>(l[e]||[]).forEach(e=>e(t))}}b=new e;var bus=b;function Text(e,t,l,i="#fff",n="2",o="left"){this.str=e,this.x=t,this.y=l,this.color=i,this.size=n,this.render=e=>{e.textAlign=o,e.textBaseline="middle",e.fillStyle=this.color,e.font=`${this.size}em monospace`,e.fillText(this.str,this.x(),this.y())}}function drawStars(t,l,i,n,o){var a=width(),r=height(),s=Math.sqrt(a*r)/10;t.beginPath(),t.strokeStyle="#aaa",t.fillStyle="#ddd",t.lineWidth=.5;for(let e=0;e<s;e++){var f=1+5*(.5*Math.sin(e*e*1217+e*e*e*983)+.5),c=(1234918*e*e+e*e*e*e*2291722+l*f)%a,h=(3000182*e*e*e*e+e*e*e*e*e*500291+i*f)%r;t.moveTo(c,h),t.lineTo(c+n*f,h+o*f),t.fillRect(c-1,h-1,2,2)}t.stroke()}function drawCard(t,e,l,i,n,o){t.save(),o&&(i*=1.04);var a=i/2,r=1.5*a;t.translate(e,l),t.fillStyle=o?"rgb(80,80,80,0.7)":"rgb(50,50,50,0.7)",t.fillRect(-a,-r,2*a,2*r),t.save(),t.beginPath(),t.rect(-a,-r,2*a,2*r),t.clip(),t.fillStyle="rgba(220,230,250,0.3)",t.rotate(-.3),t.translate(i/2,Date.now()%2e3/1e3*(5*i)-1.2*i),t.fillRect(2*-i,0,4*i,.2*i),t.fillRect(2*-i,.2*-i,4*i,.05*i),t.restore(),t.beginPath(),t.lineWidth=i/20,t.lineJoin="round",t.strokeStyle=n.color,t.moveTo(-a,-r),t.lineTo(a,-r),t.lineTo(a,r),t.lineTo(-a,r),t.closePath(),t.stroke(),t.save(),t.translate(0,.15*-i),n.glyph(t,i),t.translate(0,.52*-i),t.fillStyle="#ff3";var s=.12*i;for(let e=0;e<n.cost;e++)t.fillRect((e-(n.cost-1)/2)*s-.45*s,0,.9*s,.9*s);t.restore(),t.fillStyle=n.color,t.textBaseline="middle",t.font=`${i/6}px monospace`,t.textAlign="center";var f=n.title;for(let e=0;e<f.length;e++)t.fillText(f[e],0,.65*r+(e-(f.length-1)/2)*r*.2);t.restore()}const cards=[{color:"#f33",title:["Rho","Channel"],cost:1,glyph:function(e,t){e.save(),e.lineWidth=.05*t,e.beginPath(),e.arc(0,0,t/4,0,6.29),e.stroke(),e.restore()},use:()=>{bus.emit("lane",0)}},{color:"#3f3",title:["Gamma","Sector"],cost:1,glyph:function(e,t){e.save(),e.lineWidth=.05*t,e.beginPath(),e.arc(0,0,t/4,0,6.29),e.stroke(),e.restore()},use:()=>{bus.emit("lane",1)}},{color:"#33f",title:["Beta","Stream"],cost:1,glyph:function(e,t){e.save(),e.lineWidth=.05*t,e.beginPath(),e.arc(0,0,t/4,0,6.29),e.stroke(),e.restore()},use:()=>{bus.emit("lane",2)}}];function Engine(){var m=[cards[0],cards[1],cards[2]],b=-1,t=1,p=1,x=0,S=0,w=0,T=0;const l=e=>{var t=width(),l=height(),i=e.x,n=e.y,o=-1,a=m.length,r=Math.min(t*(.95/(1+a)),.185*l);for(let e=0;e<a;e++){var s=.5*t+(e-(a-1)/2)*r*1.17,f=.735*l;s-r/2<i&&i<s+r/2&&f-3*r/4<n&&n<f+3*r/4&&(o=e)}return o};bus.on("tap",e=>{e=l(e);0<=e&&m[e].use()}),bus.on("move",e=>{b=l(e)}),bus.on("lane",e=>{t=e}),this.update=e=>{T+=e,1<(w+=2*e)&&(w--,S++),x+=7*(.5*(t-p)-x)*e,p+=5*(t-p)*e},this.render=t=>{var l=width(),i=height(),n=l/40,e=.16*i,o=.1*i,a=o+e,r=a+e,s=.3*Math.min(e,l/8);drawStars(t,20*-T,0,3,0);var f=o/2*.7;t.fillStyle="#446",t.fillRect(15+n,o/2,l-30-2*n,1),t.fillStyle="#446",t.beginPath(),t.arc(15+f,o/2,f,0,6.28),t.fill(),t.fillStyle="#446",t.beginPath(),t.arc(l-15-f,o/2,f,0,6.28),t.fill(),t.fillStyle="#fff";f=15+n+(S+w)/100*(l-30-2*n);t.beginPath(),t.moveTo(f+n/3,o/2),t.lineTo(f-n/3,o/2-n/3),t.lineTo(f-n/3,o/2+n/3),t.closePath(),t.fill(),t.fillStyle="#f33",t.fillRect(15,o,n,e),t.fillStyle="#3f3",t.fillRect(15,a,n,e),t.fillStyle="#33f",t.fillRect(15,r,n,e),t.fillStyle="#311",t.fillRect(l-15,o,-n,e),t.fillStyle="#131",t.fillRect(l-15,a,-n,e),t.fillStyle="#113",t.fillRect(l-15,r,-n,e),t.fillStyle="#222",t.fillRect(15,o,l-30,1),t.fillRect(15,a,l-30,1),t.fillRect(15,r,l-30,1),t.fillRect(15,r+e,l-30,1),t.save(),t.translate(50+n+s,o+e/2+p*e),t.rotate(x);for(let e=5;0<=e;e--){e<1?t.fillStyle="#fd6":e<3?t.fillStyle="#fa1":t.fillStyle="#a41",t.beginPath();var c=.2*Math.sin(T*(e+1)*20)+.5;t.arc(-s-s*e*.1,Math.sin(40*-T+e)*e*s/30,s*c/(1.5+.3*e),0,6.29),t.fill()}t.translate(Math.sin(30*T)*s/60,Math.sin(35*T)*s/40),t.fillStyle="#fff",t.beginPath(),t.moveTo(s,0),t.lineTo(.65*-s,.8*-s),t.lineTo(.65*-s,.3*-s),t.lineTo(-s,.5*-s),t.lineTo(-s,.5*s),t.lineTo(.65*-s,.3*s),t.lineTo(.65*-s,.8*s),t.closePath(),t.fill(),t.fillRect(.4*-s,.4*s,s,.15*s),t.fillRect(.4*-s,.4*-s,s,.15*-s),t.restore();var e=Math.max(.025*i,20),h=i-20;t.textBaseline="bottom",t.font=`${e}px monospace`,t.textAlign="right",t.fillStyle="#ff3",t.fillText("Energy",l-n,h),t.textAlign="right",t.fillText(3,l-(n+6*e),h),t.textAlign="left",t.fillStyle="#888",t.font=`${.8*e}px monospace`,t.fillText("/ 6",l-(n+5.7*e),h);var d=1.2*e;for(let e=0;e<6;e++)t.fillStyle="#333",t.fillRect(l-(n+e*(4+d)+d),h-2.4*d,d,d),e<3&&(t.fillStyle="#ff3",t.fillRect(l-(n+e*(4+d)+d)+4,h-2.4*d+4,d-8,d-8));var u=.6*e,g=i-20;t.textBaseline="bottom",t.font=`${e}px monospace`,t.textAlign="left",t.fillStyle="#3ff",t.fillText("Shield",n,g),t.textAlign="right",t.fillText(2,n+5.3*e,g),t.textAlign="left",t.fillStyle="#888",t.font=`${.8*e}px monospace`,t.fillText("/ 3",n+5.6*e,g);for(let e=0;e<3;e++)t.fillStyle="#333",t.beginPath(),t.ellipse(n+e*(2.5*u+4)+u,g-4*u,u,u,0,0,6.28),t.fill(),e<2&&(t.fillStyle="#3ff",t.beginPath(),t.ellipse(n+e*(2.5*u+4)+u,g-4*u,u-5,u-5,0,0,6.28),t.fill());var v=m.length;for(let e=0;e<v;e++){var y=Math.min(l*(.95/(1+v)),.185*i);drawCard(t,.5*l+(e-(v-1)/2)*y*1.17,.735*i,y,m[e],b==e)}}}function init(){bus.emit("scene",2)}function goto(e){bus.emit("scene",e)}(()=>{var l,i=e=>{l=e,bus.clear(),bus.on("scene",i),clear();var t,e=get();0==l?(e.push(new Text("SHUTTLEDECK",()=>width()/2,()=>.4*height(),"#fff",6,"center")),(t=new Text("[ Press to start ]",()=>width()/2,()=>.6*height(),"#777",3,"center")).ecs=[pulse(e=>{t.size=e},2.8,3.2,1)],e.push(t),bus.on("tap",()=>goto(2))):2==l&&e.push(new Engine)};bus.on("scene",i)})(),bus.on("tap",console.log),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?(document.body.addEventListener("touchstart",e=>{e.preventDefault(),e.stopPropagation(),bus.emit("tap",{x:e.touches[0].clientX,y:e.touches[0].clientY})}),document.body.addEventListener("touchend",e=>{e.preventDefault(),e.stopPropagation(),bus.emit("move",{x:-1,y:-1})})):document.body.addEventListener("mousedown",e=>{e.preventDefault(),e.stopPropagation(),bus.emit("tap",{x:e.x,y:e.y})}),document.body.addEventListener("mousemove",e=>{e.preventDefault(),e.stopPropagation(),bus.emit("move",{x:e.x,y:e.y})}),init(),(()=>{var l=Date.now(),i=[],n=()=>{},o=()=>{var e=Date.now(),t=.001*(e-l);ctx.fillStyle="#000",ctx.fillRect(0,0,width(),height()),i.length=0,get().forEach(e=>{(e.ecs||[]).forEach(e=>e(t)),(e.update||n)(t),(e.render||n)(ctx),e.destroyed&&i.push(e)}),i.forEach(e=>remove(e)),l=e,requestAnimationFrame(o)};o()})();</script></html>
