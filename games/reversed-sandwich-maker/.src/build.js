function SfxrParams(){this.setSettings=function(t){for(var e=0;24>e;e++)this[String.fromCharCode(97+e)]=t[e]||0;this.c<.01&&(this.c=.01);var i=this.b+this.c+this.e;if(.18>i){var s=.18/i;this.b*=s,this.c*=s,this.e*=s}}}function SfxrSynth(){this._params=new SfxrParams;var t,e,i,s,a,n,h,r,o,c,d,l;this.reset=function(){var t=this._params;s=100/(t.f*t.f+.001),a=100/(t.g*t.g+.001),n=1-t.h*t.h*t.h*.01,h=-t.i*t.i*t.i*1e-6,t.a||(d=.5-t.n/2,l=5e-5*-t.o),r=1+t.l*t.l*(t.l>0?-.9:10),o=0,c=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.totalReset=function(){this.reset();var s=this._params;return t=s.b*s.b*1e5,e=s.c*s.c*1e5,i=s.e*s.e*1e5+12,3*((t+e+i)/3|0)},this.synthWave=function(m,v){var u=this._params,g=1!=u.s||u.v,f=u.v*u.v*.1,p=1+3e-4*u.w,w=u.s*u.s*u.s*.1,x=1+1e-4*u.t,b=1!=u.s,y=u.x*u.x,T=u.g,S=u.q||u.r,I=u.r*u.r*u.r*.2,z=u.q*u.q*(u.q<0?-1020:1020),F=u.p?((1-u.p)*(1-u.p)*2e4|0)+32:0,M=u.d,B=u.j/2,k=u.k*u.k*.01,C=u.a,P=t,D=1/t,E=1/e,L=1/i,_=5/(1+u.u*u.u*20)*(.01+w);_>.8&&(_=.8),_=1-_;for(var A,j,q,R,U,X,Y=!1,G=0,W=0,O=0,H=0,J=0,K=0,N=0,Q=0,V=0,Z=0,$=new Array(1024),te=new Array(32),ee=$.length;ee--;)$[ee]=0;for(var ee=te.length;ee--;)te[ee]=2*Math.random()-1;for(var ee=0;v>ee;ee++){if(Y)return ee;if(F&&++V>=F&&(V=0,this.reset()),c&&++o>=c&&(c=0,s*=r),n+=h,s*=n,s>a&&(s=a,T>0&&(Y=!0)),j=s,B>0&&(Z+=k,j*=1+Math.sin(Z)*B),j|=0,8>j&&(j=8),C||(d+=l,0>d?d=0:d>.5&&(d=.5)),++W>P)switch(W=0,++G){case 1:P=e;break;case 2:P=i}switch(G){case 0:O=W*D;break;case 1:O=1+2*(1-W*E)*M;break;case 2:O=1-W*L;break;case 3:O=0,Y=!0}S&&(z+=I,q=0|z,0>q?q=-q:q>1023&&(q=1023)),g&&p&&(f*=p,1e-5>f?f=1e-5:f>.1&&(f=.1)),X=0;for(var ie=8;ie--;){if(N++,N>=j&&(N%=j,3==C))for(var se=te.length;se--;)te[se]=2*Math.random()-1;switch(C){case 0:U=d>N/j?.5:-.5;break;case 1:U=1-N/j*2;break;case 2:R=N/j,R=6.28318531*(R>.5?R-1:R),U=1.27323954*R+.405284735*R*R*(0>R?1:-1),U=.225*((0>U?-1:1)*U*U-U)+U;break;case 3:U=te[Math.abs(32*N/j|0)]}g&&(A=K,w*=x,0>w?w=0:w>.1&&(w=.1),b?(J+=(U-K)*w,J*=_):(K=U,J=0),K+=J,H+=K-A,H*=1-f,U=H),S&&($[Q%1024]=U,U+=$[(Q-q+1024)%1024],Q++),X+=U}X*=.125*O*y,m[ee]=X>=1?32767:-1>=X?-32768:32767*X|0}return v}}var synth=new SfxrSynth;window.jsfxr=function(t){synth._params.setSettings(t);var e=synth.totalReset(),i=new Uint8Array(4*((e+1)/2|0)+44),s=2*synth.synthWave(new Uint16Array(i.buffer,44),e),a=new Uint32Array(i.buffer,0,44);a[0]=1179011410,a[1]=s+36,a[2]=1163280727,a[3]=544501094,a[4]=16,a[5]=65537,a[6]=44100,a[7]=88200,a[8]=1048578,a[9]=1635017060,a[10]=s,s+=44;for(var n=0,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="data:audio/wav;base64,";s>n;n+=3){var o=i[n]<<16|i[n+1]<<8|i[n+2];r+=h[o>>18]+h[o>>12&63]+h[o>>6&63]+h[63&o]}return r};var initializing=!1,fnTest=/xyz/.test(function(){})?/\b_super\b/:/.*/,Class=function(){};Class.extend=function(t){function e(){!initializing&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;initializing=!0;var s=new this;initializing=!1;for(var a in t)s[a]="function"==typeof t[a]&&"function"==typeof i[a]&&fnTest.test(t[a])?function(t,e){return function(){var s=this._super;this._super=i[t];var a=e.apply(this,arguments);return this._super=s,a}}(a,t[a]):t[a];return e.prototype=s,e.prototype.constructor=e,e.extend=arguments.callee,e};var Assets={list:[],count:0,loaded:0,loadImg:function(t,e){var i=void 0===e?t:e,s=new Image;return s.src="./assets/img/"+t,this.count++,s.onload=function(){this.list[i]=s,this.loaded++}.bind(this),this},get:function(t){return this.list[t]},set:function(t,e){return this.list[t]=e,this}},Font=Class.extend({x:0,y:0,text:"",needed:[],size:24,color:{r:0,g:0,b:0,a:1},letters:{A:[[,1],[1,,1],[1,,1],[1,1,1],[1,,1]],B:[[1,1],[1,,1],[1,1,1],[1,,1],[1,1]],C:[[1,1,1],[1],[1],[1],[1,1,1]],D:[[1,1],[1,,1],[1,,1],[1,,1],[1,1]],E:[[1,1,1],[1],[1,1,1],[1],[1,1,1]],F:[[1,1,1],[1],[1,1],[1],[1]],G:[[,1,1],[1],[1,,1,1],[1,,,1],[,1,1]],H:[[1,,1],[1,,1],[1,1,1],[1,,1],[1,,1]],I:[[1,1,1],[,1],[,1],[,1],[1,1,1]],J:[[1,1,1],[,,1],[,,1],[1,,1],[1,1,1]],K:[[1,,,1],[1,,1],[1,1],[1,,1],[1,,,1]],L:[[1],[1],[1],[1],[1,1,1]],M:[[1,1,1,1,1],[1,,1,,1],[1,,1,,1],[1,,,,1],[1,,,,1]],N:[[1,,,1],[1,1,,1],[1,,1,1],[1,,,1],[1,,,1]],O:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],P:[[1,1,1],[1,,1],[1,1,1],[1],[1]],Q:[[0,1,1],[1,,,1],[1,,,1],[1,,1,1],[1,1,1,1]],R:[[1,1],[1,,1],[1,,1],[1,1],[1,,1]],S:[[1,1,1],[1],[1,1,1],[,,1],[1,1,1]],T:[[1,1,1],[,1],[,1],[,1],[,1]],U:[[1,,1],[1,,1],[1,,1],[1,,1],[1,1,1]],V:[[1,,,,1],[1,,,,1],[,1,,1],[,1,,1],[,,1]],W:[[1,,,,1],[1,,,,1],[1,,1,,1],[1,,1,,1],[1,1,1,1,1]],X:[[1,,,,1],[,1,,1],[,,1],[,1,,1],[1,,,,1]],Y:[[1,,1],[1,,1],[,1],[,1],[,1]],Z:[[1,1,1,1,1],[,,,1],[,,1],[,1],[1,1,1,1,1]],0:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],1:[[,,1],[,1,1],[1,,1],[,,1],[,,1]],2:[[1,1,1],[,,1],[1,1,1],[1],[1,1,1]],3:[[1,1,1],[,,1],[1,1,1],[,,1],[1,1,1]],4:[[1,,1],[1,,1],[1,1,1],[,,1],[,,1]],5:[[1,1,1],[1],[1,1,1],[,,1],[1,1,1]],6:[[1,1,1],[1],[1,1,1],[1,,1],[1,1,1]],7:[[1,1,1],[,,1],[,1],[1],[1]],8:[[1,1,1],[1,,1],[1,1,1],[1,,1],[1,1,1]],9:[[1,1,1],[1,,1],[1,1,1],[,,1],[1,1,1]],0:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],":":[[],[,1],[],[,1]],"+":[[],[,1],[1,1,1],[,1]],"#":[[,1,1,,1,1],[1,,,1,,,1],[1,,,,,,1],[,1,,,,1],[,,1,,1],[,,,1]],"@":[[,1,1,,1,1],[1,1,1,1,1,1,1],[1,1,1,1,1,1,1],[,1,1,1,1,1],[,,1,1,1],[,,,1]],".":[[],[],[],[],[1]],"/":[[,,,,1],[,,,1],[,,1],[,1],[1]],"-":[[],[],[1,1,1]]," ":[[,,],[,,],[,,],[,,],[,,]]},init:function(t,e,i,s){this.text=i,this.x=t,this.y=e,this.size=s,this.setText(this.text)},setText:function(t){if(this.text=t,this.needed=[],""!==t){this.text=this.text.toUpperCase();for(var e=0;e<this.text.length;e++){var i=this.letters[this.text.charAt(e)];i&&this.needed.push(i)}}return this},setColor:function(t,e,i,s){this.color.r=t,this.color.g=e,this.color.b=i,this.color.a=s},getColor:function(){return this.color},setPos:function(t,e){this.x=t,this.y=e},getPos:function(){return[this.x,this.y]},render:function(){ctx.fillStyle="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")";var t=this.x;for(i=0;i<this.needed.length;i++){letter=this.needed[i];for(var e=this.y,s=0,a=0;a<letter.length;a++){for(var n=letter[a],h=0;h<n.length;h++)n[h]&&ctx.fillRect(t+h*this.size,e,this.size,this.size);s=Math.max(s,n.length*this.size),e+=this.size}t+=this.size+s}}}),dropData=jsfxr([1,,.0345,,.2756,.2771,,-.319,,,,,,,,,,,1,,,.2002,,.5]),dropSound=new Audio;dropSound.src=dropData;var pointData=jsfxr([0,,.057,.4307,.2151,.7968,,,,,,.3035,.6925,,,,,,1,,,,,.5]),pointSound=new Audio;pointSound.src=pointData;var timeData=jsfxr([0,,.0861,.3619,.4461,.8783,,,,,,.4563,.6351,,,,,,1,,,,,.5]),timeSound=new Audio;timeSound.src=timeData;var Sprite=Class.extend({x:0,y:0,width:16,height:16,size:1,data:[],palette:{},init:function(t,e,i){this.x=t,this.y=e,this.size=i},setPos:function(t,e){this.x=t,this.y=e},getPos:function(){return[this.x,this.y]},setScale:function(t){this.size=t},update:function(){},render:function(){for(var t=this.x-this.width*this.size/2,e=this.y-this.height*this.size/2,i=0,s=0;s<this.data.length;s++){for(var a=this.data[s],n=0;n<a.length;n++)a[n]&&(ctx.fillStyle=this.palette[a[n]],ctx.fillRect(t+n*this.size,e,this.size,this.size));i=Math.max(i,a.length*this.size),e+=this.size}},center:function(){return[this.width*this.size/2,this.height*this.size/2]},centerX:function(){return this.width*this.size/2},centerY:function(){return this.height*this.size/2},overlaps:function(t,e){return t>this.x-this.width*this.size/2&&this.x+this.width*this.size/2>t&&e>this.y-this.height*this.size/2&&this.y+this.height*this.size/2>e?!0:!1}}),Bread=Sprite.extend({palette:{1:"#CC7F1D",2:"#F6CD73",3:"#F3D68D"},data:[[,,1,1,1,1,,,,,1,1,1,1],[,1,3,3,3,3,1,,,1,3,2,2,2,1],[1,3,3,3,3,3,3,1,1,3,3,3,3,2,2,1],[1,3,3,3,3,3,3,3,3,3,3,3,3,2,2,1],[1,3,3,3,3,3,3,3,3,3,3,3,3,2,2,1],[,1,3,3,2,3,3,3,3,3,3,3,2,2,1],[,,1,3,3,2,3,3,2,3,3,3,2,1],[,,1,3,3,3,3,3,3,2,3,3,2,1],[,,1,3,3,3,3,3,3,3,3,3,2,1],[,,1,3,3,3,3,3,3,3,3,3,2,1],[,,1,3,3,3,3,3,3,3,3,3,2,1],[,,1,3,3,3,3,3,3,3,3,2,2,1],[,,1,2,3,3,3,3,3,3,3,2,2,1],[,,1,2,2,3,3,3,3,3,2,2,2,1],[,1,2,2,2,2,2,2,2,2,2,2,2,2,1],[,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],init:function(t,e){this.type="bread",this._super(t,e,5)}}),Cheese=Sprite.extend({palette:{1:"#cabc0c",2:"#ffec33",3:"#fff271"},data:[[,,2,2,2,2,2,2,2,2,2,2,2,2],[,2,2,2,2,2,2,2,2,2,2,2,2,2,2],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],[2,2,2,1,3,2,2,2,2,2,2,2,2,2,2,1],[2,2,1,,3,2,2,2,2,2,1,1,1,2,2,1],[2,2,3,3,2,2,2,2,2,1,,,,3,2,1],[2,2,2,2,2,2,2,2,2,1,,,,3,2,1],[2,2,2,2,2,2,2,2,2,1,,,3,2,2,1],[2,2,2,2,2,2,2,2,2,2,3,3,2,2,2,1],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],[2,2,2,2,2,1,1,3,2,2,2,2,2,2,2,1],[2,2,2,2,1,,,1,3,2,2,2,2,2,2,1],[2,2,2,2,1,,,3,2,2,2,2,2,2,2,1],[2,2,2,2,3,3,2,2,2,2,2,2,2,2,2,1],[,1,2,2,2,2,2,2,2,2,2,2,2,2,1],[,,1,1,1,1,1,1,1,1,1,1,1,1]],init:function(t,e){this.type="cheese",this._super(t,e,4)}}),Egg=Sprite.extend({palette:{1:"#632727",2:"#ffffff",3:"#e1e1e1",4:"#eab735",5:"#fdd349"},data:[[],[,,,,,1,1,1,1,1,1],[,,,1,1,2,2,2,2,2,2,1,1],[,,1,2,2,2,2,2,2,2,2,2,2,1],[,1,2,2,2,4,4,4,4,2,2,2,2,2,1],[,1,2,2,4,5,5,5,5,4,2,2,2,2,1],[1,2,2,4,5,5,5,5,5,5,4,2,2,2,3,1],[1,2,2,4,5,5,5,4,4,5,4,2,2,2,3,1],[1,2,2,4,5,5,5,5,5,5,4,2,2,2,3,1],[1,2,2,4,5,5,4,4,5,5,4,2,2,3,3,1],[,1,2,2,4,5,5,5,5,4,2,2,2,3,1],[,1,2,2,2,4,4,4,4,2,2,2,3,3,1],[,,1,2,2,2,2,2,2,2,3,3,3,1],[,,,1,1,3,3,3,3,3,3,1,1],[,,,,,1,1,1,1,1,1]],init:function(t,e){this.type="egg",this._super(t,e,5)}}),Lettuce=Sprite.extend({palette:{1:"#0d8b00",2:"#3d7a15",3:"#59ae1d",4:"#66c821",5:"#bed385",6:"#d0dfa5",7:"#a0bf4d"},data:[[,,,,,,,1,1,1,1,,,1],[,,,,1,,1,1,1,1,3,1,1,1],[,,,,1,1,1,3,1,3,3,1,3,1,1,1],[,,1,1,1,1,1,3,3,2,1,3,3,3,3,1],[1,,1,1,3,3,3,1,3,3,3,3,3,2,1],[,1,1,1,3,1,3,1,3,3,3,2,3,3,1,1],[,1,1,3,3,3,1,3,4,1,3,4,3,3,3,3],[1,1,3,3,3,2,3,3,3,3,3,3,1,4,3,3],[1,1,1,2,3,3,3,2,6,3,3,4,3,3,3],[,1,3,3,2,4,2,3,3,3,7,2,4,4,3],[,1,3,4,4,3,3,6,3,3,5,3,4,3],[1,1,3,3,4,4,3,2,3,5,3,4,4,4],[,,,,3,2,3,3,3,4,3,2,5,7],[,,,3,3,2,3,3,3,4,3,3,5,6],[,,,,,,3,3,,3,3,5,6,6],[,,,,,,,,,,,7,5,6,6]],init:function(t,e){this.type="lettuce",this._super(t,e,5)}}),Plate=Sprite.extend({palette:{1:"#f4d2fc",2:"#f9f9f9",3:"#ffffff",4:"#f4f4f4",5:"#fbfbfb",6:"#cc7f1d",7:"#f3d68d"},data:[[,,,,,1,1,1,1,1,1],[,,,1,1,2,2,2,2,2,2,1,1],[,,1,2,2,2,3,3,3,3,6,3,3,1],[,1,2,2,3,3,3,3,3,3,3,3,3,3,1],[,1,2,3,6,3,1,1,1,1,3,7,3,3,1],[1,2,2,3,3,1,4,4,4,4,1,3,7,3,3,1],[1,2,3,3,1,4,4,5,7,5,5,1,3,3,3,1],[1,2,3,3,1,4,5,5,5,5,5,1,3,3,3,1],[1,2,3,3,1,4,5,7,5,5,5,1,3,3,3,1],[1,2,3,3,1,4,5,5,5,5,5,1,3,3,3,1],[1,2,3,3,3,1,5,5,5,5,1,3,3,3,3,1],[,1,3,3,3,3,1,1,1,1,3,3,3,3,1],[,1,3,7,3,3,3,3,3,3,3,3,6,3,1],[,,1,3,3,3,3,6,3,3,3,3,3,1],[,,,1,1,3,3,3,3,3,3,1,1],[,,,,,1,1,1,1,1,1]],init:function(t,e){this.type="plate",this._super(t,e,7)}}),Salami=Sprite.extend({palette:{1:"#872d22",2:"#ac3523",3:"#cca097"},data:[[,,,,,1,1,1,1,1,1],[,,,1,1,1,1,1,1,1,1,1,1],[,,1,1,1,2,2,2,2,2,2,1,1,1],[,1,1,1,2,2,2,3,2,2,2,2,1,1,1],[,1,1,2,2,3,2,2,2,3,2,2,2,1,1],[1,1,2,2,2,2,2,3,3,2,3,2,2,2,1,1],[1,1,2,3,2,3,2,2,2,2,2,3,2,2,1,1],[1,1,2,2,3,2,2,2,2,2,2,2,2,2,1,1],[1,1,2,2,2,2,2,2,3,2,2,2,2,2,1,1],[1,1,2,3,2,2,2,2,2,2,2,3,2,2,1,1],[1,1,2,2,2,2,3,2,2,2,2,2,2,2,1,1],[,1,1,2,2,3,2,2,3,2,2,3,2,1,1],[,1,1,1,2,2,2,3,2,2,2,2,1,1,1],[,,1,1,1,2,2,2,2,2,2,1,1,1],[,,,1,1,1,1,1,1,1,1,1,1],[,,,,,1,1,1,1,1,1]],init:function(t,e){this.type="salami",this._super(t,e,4)}}),Table=Sprite.extend({palette:{1:"#E4E4E4",2:"#41B3D3",3:"#93CCDC"},data:[[1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1],[3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3],[1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1],[3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3],[1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1],[3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3],[1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1],[3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3],[1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1],[3,2,3,2,3,2,3,2,3,2,3,2,3,2,3,2,3],[1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1]],init:function(t,e){this.width=17,this.height=11,this._super(t,e,50)}}),Tomato=Sprite.extend({palette:{1:"#B50B0B",2:"#F38A60",3:"#FCB936"},data:[[,,,,1,1,1,1,1,1,1,1],[,,1,1,1,1,1,1,1,1,1,1,1,1],[,1,1,1,2,2,2,1,1,2,2,2,1,1,1],[,1,1,2,2,3,2,1,1,2,3,2,2,1,1],[1,1,2,2,2,2,2,1,1,2,2,2,2,2,1,1],[1,1,2,3,2,2,2,1,1,2,2,2,3,2,1,1],[1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1],[1,1,2,3,2,2,2,1,1,2,2,2,3,2,1,1],[1,1,2,2,2,2,2,1,1,2,2,2,2,2,1,1],[,1,1,2,2,3,2,1,1,2,3,2,2,1,1],[,1,1,1,2,2,2,1,1,2,2,2,1,1,1],[,,1,1,1,1,1,1,1,1,1,1,1,1],[,,,,1,1,1,1,1,1,1,1]],init:function(t,e){this.type="tomato",this._super(t,e,4)}}),Menu={init:function(){this.table=new Table(canvas.width/2,canvas.height/2),this.title1=new Font(canvas.width/2-132,-40,"reversed",8),this.title1.color={r:255,g:65,b:35,a:1},this.title2=new Font(canvas.width/2-300,480,"sandwich maker",10),this.title2.color={r:255,g:65,b:35,a:1},this.title1bg=new Font(canvas.width/2-128,-36,"reversed",8),this.title1bg.color={r:0,g:0,b:0,a:.5},this.title2bg=new Font(canvas.width/2-296,486,"sandwich maker",10),this.title2bg.color={r:0,g:0,b:0,a:.5},this.start=new Font(canvas.width/2-110,canvas.height-50,"click to start",4),this.start.color={r:255,g:65,b:35,a:0},this.startBg=new Font(canvas.width/2-108,canvas.height-48,"click to start",4),this.startBg.color={r:0,g:0,b:0,a:0},this.items=[],this.timer=1.5;for(var t=0;20>t;t++)this.createItem();canvas.onmouseup=this.click},update:function(t){this.title1.y<70?this.title1.y+=100*t:this.title1.y=70,this.title2.y>140?this.title2.y-=300*t:this.title2.y=140,this.title1bg.y<74?this.title1bg.y+=100*t:this.title1bg.y=74,this.title2bg.y>144?this.title2bg.y-=300*t:this.title2bg.y=144;for(var e in this.items)this.items[e].axis?(this.items[e].direction?this.items[e].x+=this.items[e].speed*t:this.items[e].x-=this.items[e].speed*t,(this.items[e].x<-61||this.items[e].x>861)&&(this.createItem(),delete this.items[e])):(this.items[e].direction?this.items[e].y-=this.items[e].speed*t:this.items[e].y+=this.items[e].speed*t,(this.items[e].y<-61||this.items[e].y>541)&&(this.createItem(),delete this.items[e]));this.timer>0&&(this.timer-=t),this.timer<=0&&(this.start.color.a<1&&(this.start.color.a+=1*t),this.startBg.color.a<.5&&(this.startBg.color.a+=1*t))},render:function(t){this.table.render(t);for(var e in this.items)this.items[e].render(t);this.title1bg.render(t),this.title2bg.render(t),this.title1.render(t),this.title2.render(t),this.startBg.render(t),this.start.render(t)},createItem:function(){var t=Math.random()<.5?0:1,e=Math.random()<.5?0:1,i=Math.floor(6*Math.random()),s=Math.random().toString();if(t)var a=e?-60:860,n=Math.floor(500*Math.random());else var n=.5>e?-60:540,a=Math.floor(800*Math.random());switch(i){case 0:this.items[s]=new Cheese(a,n);break;case 1:this.items[s]=new Lettuce(a,n);break;case 2:this.items[s]=new Salami(a,n);break;case 3:this.items[s]=new Tomato(a,n);break;case 4:this.items[s]=new Egg(a,n);break;case 5:this.items[s]=new Plate(a,n)}this.items[s].speed=Math.floor(301*Math.random())+100,this.items[s].axis=t,this.items[s].direction=e},click:function(){State.set(Play)},destroy:function(){canvas.onmouseup=""}},Play={init:function(){this.mouse=!1,this.plate=[],this.sceneItems=[],this.currentPlate=0,this.dragItem=!1,this.score=0,this.best=parseInt(localStorage.getItem("best-score"),10)||0,this.lives=3,this.multiplier=.25,this.ingredients=3,this.scoreTxt=new Font(canvas.width/2-72,40,"score: 0",4),this.scoreTxt.color={r:255,g:65,b:35,a:1},this.scoreTxtBg=new Font(canvas.width/2-70,42,"score: 0",4),this.scoreTxtBg.color={r:0,g:0,b:0,a:.5},this.animatedTxt=[],this.endgame=!1,this.showgameover=!1,this.timer=30,this.timerTxt=new Font(canvas.width/2-72,70,"time : "+this.timer.toString(),4),this.timerTxt.color={r:255,g:65,b:35,a:1},this.timerTxtBg=new Font(canvas.width/2-70,72,"time : "+this.timer.toString(),4),this.timerTxtBg.color={r:0,g:0,b:0,a:.5},this.gameoverTxt=[];var t={r:255,g:255,b:255,a:1};this.gameoverTxt[0]=new Font(canvas.width/2-200,100,"game over",10),this.gameoverTxt[0].color=t,this.gameoverTxt[1]=new Font(canvas.width/2-94,canvas.height-110,"click to restart",3),this.gameoverTxt[1].color=t,this.gameoverTxt[2]=new Font(canvas.width/2-200,230,"score: "+this.score.toString(),6),this.gameoverTxt[2].color=t,this.gameoverTxt[3]=new Font(canvas.width/2-200,270,"best: "+this.best.toString(),4),this.gameoverTxt[3].color=t,this.livesTxt=new Font(canvas.width/2-72,canvas.height-55,"@ @ @",5),this.livesTxt.color={r:200,g:0,b:0,a:1},this.livesTxtBg=new Font(canvas.width/2-70,canvas.height-53,"@ @ @",5),this.livesTxtBg.color={r:0,g:0,b:0,a:.5},this.table=new Table(canvas.width/2,canvas.height/2),this.sceneItems[0]=new Plate(canvas.width/2-200,canvas.height/2-130),this.sceneItems[1]=new Plate(canvas.width/2-250,canvas.height/2),this.sceneItems[2]=new Plate(canvas.width/2-200,canvas.height/2+130),this.sceneItems[3]=new Plate(canvas.width/2+200,canvas.height/2-130),this.sceneItems[4]=new Plate(canvas.width/2+250,canvas.height/2),this.sceneItems[5]=new Plate(canvas.width/2+200,canvas.height/2+130),this.sceneItems[6]=new Tomato(canvas.width/2-190,canvas.height/2-130),this.sceneItems[7]=new Tomato(canvas.width/2-210,canvas.height/2-145),this.sceneItems[8]=new Tomato(canvas.width/2-215,canvas.height/2-120),this.sceneItems[9]=new Lettuce(canvas.width/2-250,canvas.height/2),this.sceneItems[10]=new Cheese(canvas.width/2-210,canvas.height/2+120),this.sceneItems[11]=new Cheese(canvas.width/2-190,canvas.height/2+140),this.sceneItems[12]=new Bread(canvas.width/2+195,canvas.height/2-130),this.sceneItems[13]=new Bread(canvas.width/2+205,canvas.height/2-120),this.sceneItems[14]=new Salami(canvas.width/2+230,canvas.height/2),this.sceneItems[15]=new Salami(canvas.width/2+270,canvas.height/2-10),this.sceneItems[16]=new Egg(canvas.width/2+200,canvas.height/2+130),this.sceneItems[17]=new Plate(canvas.width/2,canvas.height/2),this.createPlate(),canvas.addEventListener("mousedown",this.onmousedown.bind(this),!1),canvas.addEventListener("mouseup",this.onmouseup.bind(this),!1),canvas.addEventListener("mousemove",this.onmousemove.bind(this),!1),canvas.addEventListener("mouseup",this.restart.bind(this),!1)},onmousedown:function(t){t.preventDefault(),this.mouse=!0;var e=t.offsetX,i=t.offsetY;!this.endgame&&void 0!==this.plate[this.plate.length-1]&&this.plate[this.plate.length-1].overlaps(e,i)&&(this.dragItem=!0)},onmouseup:function(t){if(t.preventDefault(),this.mouse=!1,!this.endgame){var e=t.offsetX,i=t.offsetY,s=this.plate[this.plate.length-1];if(this.dragItem){if((this.sceneItems[0].overlaps(e,i)&&"tomato"===s.type||this.sceneItems[1].overlaps(e,i)&&"lettuce"===s.type||this.sceneItems[2].overlaps(e,i)&&"cheese"===s.type||this.sceneItems[3].overlaps(e,i)&&"bread"===s.type||this.sceneItems[4].overlaps(e,i)&&"salami"===s.type||this.sceneItems[5].overlaps(e,i)&&"egg"===s.type)&&!this.endgame){this.score+=1,this.score>this.best&&(this.best=this.score),this.updateScore(),this.plate.length>1&&pointSound.play();var a=Math.random().toString();this.animatedTxt[a]=new Font(e-16,i-20,"+1",4),this.animatedTxt[a].color={r:0,g:200,b:0,a:1},this.animatedTxt[a].direction=0,delete a}else{this.lives--,this.updateLives(),dropSound.play();var a=Math.random().toString();this.animatedTxt[a]=new Font(e-16,i-20,"-@",4),this.animatedTxt[a].color={r:200,g:0,b:0,a:1},this.animatedTxt[a].direction=1,delete a,0===this.lives&&(this.endgame=!0)}if(this.dragItem=!1,this.plate.pop(),0===this.plate.length&&this.lives>0){if(this.sceneItems[3].overlaps(e,i)&&"bread"===s.type){this.timer+=5,timeSound.play();var a=Math.random().toString();this.animatedTxt[a]=new Font(canvas.width/2-46,canvas.height/2-55,"time +5",3),this.animatedTxt[a].color={r:0,g:200,b:0,a:1},delete a}this.ingredients+=this.multiplier,this.createPlate()}}}},onmousemove:function(t){if(t.preventDefault(),this.dragItem){var e=t.offsetX,i=t.offsetY,s=this.plate[this.plate.length-1];s.setPos(e,i)}},update:function(t){for(s in this.animatedTxt)this.animatedTxt[s].color.a<=0?delete this.animatedTxt[s]:(this.animatedTxt[s].direction?this.animatedTxt[s].y+=70*t:this.animatedTxt[s].y-=70*t,this.animatedTxt[s].color.a-=.25*t);this.timer>1&&!this.endgame?(this.timer-=t,this.timerTxt.setText("time: "+parseInt(this.timer,10).toString()),this.timerTxtBg.setText("time: "+parseInt(this.timer,10).toString())):this.endgame=!0},render:function(t){this.table.render(t),this.scoreTxtBg.render(t),this.scoreTxt.render(t),this.livesTxtBg.render(t),this.livesTxt.render(t),this.timerTxtBg.render(t),this.timerTxt.render(t);for(var e=0;e<this.sceneItems.length;e++)this.sceneItems[e].render(t);for(s in this.animatedTxt)this.animatedTxt[s].render(t);for(var i=0;i<this.plate.length;i++)this.plate[i].render(t);this.endgame&&(this.gameoverTxt[2].setText("score: "+this.score.toString()),this.gameoverTxt[3].setText("best: "+this.best.toString()),this.gameover())},updateScore:function(){this.scoreTxt.setText("score: "+this.score.toString()),this.scoreTxtBg.setText("score: "+this.score.toString())},updateLives:function(){for(var t="# # #".split(" "),e=this.lives-1;e>=0;e--)t[e]="@";this.livesTxt.setText(t.join(" ")),this.livesTxtBg.setText(t.join(" "))},createPlate:function(){this.plate=[],this.plate.push(new Bread(canvas.width/2,canvas.height/2));for(var t=0;t<Math.floor(this.ingredients)-1;t++){var e=Math.floor(5*Math.random());switch(e){case 0:this.plate.push(new Cheese(canvas.width/2,canvas.height/2));break;case 1:this.plate.push(new Lettuce(canvas.width/2,canvas.height/2));break;case 2:this.plate.push(new Salami(canvas.width/2,canvas.height/2));break;case 3:this.plate.push(new Tomato(canvas.width/2,canvas.height/2));break;case 4:this.plate.push(new Egg(canvas.width/2,canvas.height/2))}}},gameover:function(){ctx.fillStyle="rgba(0,0,0,0.875)",ctx.fillRect(0,0,canvas.width,canvas.height),this.showgameover=!0;for(var t=0;t<this.gameoverTxt.length;t++)this.gameoverTxt[t].render()},restart:function(){this.showgameover&&(localStorage.setItem("best-score",this.best),this.destroy(),this.init())},destroy:function(){canvas.removeEventListener("mousedown",this.onmousedown.bind(this),!1),canvas.removeEventListener("mouseup",this.onmouseup.bind(this),!1),canvas.removeEventListener("mousemove",this.onmousemove.bind(this),!1),canvas.removeEventListener("mouseup",this.restart.bind(this),!1)}},State={current:void 0,set:function(t){void 0!==this.current&&this.current.destroy(),this.current=t,this.current.init()}},Game={dt:0,step:1/60,timestamp:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},run:function(){this.last=this.timestamp(),this.loop=requestAnimationFrame(this.frame.bind(this))},frame:function(){for(this.now=this.timestamp(),this.dt=this.dt+Math.min(1,(this.now-this.last)/1e3);this.dt>this.step;)this.dt=this.dt-this.step,this.update(this.step);this.render(this.dt),this.last=this.now,this.loop=requestAnimationFrame(this.frame.bind(this))},update:function(t){State.current.update(t)},render:function(t){this.clear(),State.current.render(t)},clear:function(){ctx.clearRect(0,0,canvas.width,canvas.height)}},canvas=document.querySelector("#game");canvas.width=800,canvas.height=480;var ctx=canvas.getContext("2d");document.addEventListener("DOMContentLoaded",function(){State.set(Menu),Game.run()},!1);