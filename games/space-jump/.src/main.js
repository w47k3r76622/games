(()=>{"use strict";var t={784:(t,e,i)=>{i.d(e,{U:()=>a});const a={volume:.3,sampleRate:44100,x:new(window.AudioContext||webkitAudioContext),play:function(...t){return this.playSamples(this.buildSamples(...t))},playSamples:function(...t){const e=this.x.createBuffer(t.length,t[0].length,this.sampleRate),i=this.x.createBufferSource();return t.map(((t,i)=>e.getChannelData(i).set(t))),i.buffer=e,i.connect(this.x.destination),i.start(),i},buildSamples:function(t=1,e=.05,i=220,a=0,o=0,r=.1,s=0,n=1,l=0,h=0,c=0,d=0,m=0,p=0,g=0,u=0,f=0,y=1,b=0,x=0){const w=2*Math.PI;let S,v,P=this.sampleRate,k=l*=500*w/P/P,A=i*=(1+2*e*Math.random()-e)*w/P,C=[],M=0,L=0,T=0,I=1,R=0,E=0,O=0;for(h*=500*w/P**3,g*=w/P,c*=w/P,d*=P,m=m*P|0,v=(a=a*P+9)+(b*=P)+(o*=P)+(r*=P)+(f*=P)|0;T<v;C[T++]=O)++E%(100*u|0)||(O=s?s>1?s>2?s>3?Math.sin((M%w)**3):Math.max(Math.min(Math.tan(M),1),-1):1-(2*M/w%2+2)%2:1-4*Math.abs(Math.round(M/w)-M/w):Math.sin(M),O=(m?1-x+x*Math.sin(w*T/m):1)*(O>0?1:-1)*Math.abs(O)**n*t*this.volume*(T<a?T/a:T<a+b?1-(T-a)/b*(1-y):T<a+b+o?y:T<v-f?(v-T-f)/r*y:0),O=f?O/2+(f>T?0:(T<v-f?1:(v-T)/f)*C[T-f|0]/2):O),S=(i+=l+=h)*Math.cos(g*L++),M+=S-S*p*(1-1e9*(Math.sin(T)+1)%2),I&&++I>d&&(i+=c,A+=c,I=0),!m||++R%m||(i=A,l=k,I=I||1);return C},getNote:function(t=0,e=440){return e*2**(t/12)}}}},e={};function i(a){var o=e[a];if(void 0!==o)return o.exports;var r=e[a]={exports:{}};return t[a](r,r.exports,i),r.exports}i.d=(t,e)=>{for(var a in e)i.o(e,a)&&!i.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var a={};(()=>{i.d(a,{Q9:()=>gt,hf:()=>kt,eo:()=>At,oO:()=>St});let t=!1,e=!1;const o={rocket:[.09,,1705,.5,,1,4,2,36.2,26.2,100,5,.16,3.4,,.3,.1,.32,1],jump:[.1,,70,.11,.05,.06,,.33,,10,50,,,,,,,.7,.1],ice:[.3,0,17897,.19,.5,.4,1,1.9,,,100,,.0424,,,,,,.49],mouseOver:[.5,0,194,.04,,.05,,2.69,,,100,.04,,,,,.07,.13,.05],gameStart:[.2,0,2079,.07,.18,2.48,1,.82,1,9.1,2050,.09,.09,,2,,.16,.45,.09],gameOver:[.2,,2079,.07,.18,2.48,1,.82,1,9.1,-81,.09,.09,.1,,,,.45,.09,.24],click:[1,0,800,,,0,,,,,,,,,,,,0,.01],alert:[.1,0,1280,,.08,.16,2,.7,,,696,,,,30,,.1,.7,.07]},r={},s=()=>i(784).U,n=t=>r[t]=r[t]||s().buildSamples(...o[t]),l=(i,a)=>{let o=null;const r=()=>o=null;return()=>{e&&t&&!o&&(o=setTimeout(r,i),s().playSamples(n(a)))}},h={get enabled(){return e},set enabled(t){e=t},buildSamples:()=>{for(const t in o)n(t)},playRocket:l(1e3,"rocket"),playJump:l(500,"jump"),playIce:l(700,"ice"),playMouseOver:l(50,"mouseOver"),playGameStart:l(1e3,"gameStart"),playGameOver:l(1e3,"gameOver"),playClick:l(100,"click"),playAlert:l(1e3,"alert")},c=()=>{t=!0,document.removeEventListener("click",c),document.removeEventListener("keydown",c),document.removeEventListener("keyup",c)};document.addEventListener("click",c),document.addEventListener("keydown",c),document.addEventListener("keyup",c);const d=document.querySelector("#game-canvas"),m=1e3,p=2*Math.PI,g=Math.random,u={scale:1},f={arrowUp:!1,arrowLeft:!1,arrowDown:!1,arrowRight:!1,enter:!1},y=new Map([["ArrowUp","arrowUp"],["ArrowLeft","arrowLeft"],["ArrowDown","arrowDown"],["ArrowRight","arrowRight"],["KeyW","arrowUp"],["KeyA","arrowLeft"],["KeyS","arrowDown"],["KeyD","arrowRight"],["Enter","enter"]]),b=(t,e)=>t+Math.floor((e-t)*g());class x{constructor(t){this.opacity=g()/5,this.smokeSize=5,this.points=[];let e=g()*p,i=0,a=0,o=0,r=0,s=0,n=0;const l=5*t.width/1e3,h=40*t.width/1e3;for(let c=0;c<t.steps;c++){const t=l+g()*h,c=Math.cos(e)*t,d=-Math.sin(e)*t,m=t*this.smokeSize,p=m/2,u=Math.sqrt(2*p*p);i=Math.min(i,s-u),a=Math.min(a,n-u),o=Math.max(o,s+u),r=Math.max(r,n+u),e+=5*Math.PI*g(),this.points.push({x:s,y:n,size:m}),s+=c,n+=d}this.scale=Math.min(Math.min(1,t.width/2/Math.max(-i,o)),Math.min(1,t.height/2/Math.max(-a,r))),this.texture=t.texture}render(t){t.save();const{x:e,y:i,size:a}=this.points.pop();t.globalAlpha=15*this.opacity/a,t.scale(this.scale,this.scale),t.translate(e,i),t.rotate(g()*p),t.drawImage(this.texture,0-a/2,0-a/2,a,a),t.globalAlpha=1,t.fillStyle=`rgba(${b(155,255)}, ${b(155,255)}, ${b(155,255)}, ${g()})`,t.translate(2*g()*a,2*g()*a),t.beginPath(),t.arc(0,0,g(),0,p),t.fill(),t.restore()}}const w=({color:{red:t,green:e,blue:i,opacity:a}})=>{const o=document.createElement("canvas");o.width=80,o.height=80;const r=o.getContext("2d"),s=10*g()-5,n=10*g()-5,l=10+20*g(),h=10+20*g();r.fillStyle=`rgba(${t}, ${e}, ${i}, ${a})`;for(let t=0;t<200;t++){const e=g(),i=Math.cos(p/s/200*t)*e*l+40,a=Math.sin(p/n/200*t)*e*h+40;r.moveTo(i,a),r.beginPath(),r.arc(i,a,4*e,0,p),r.fill()}return o},S=({steps:t,x:e,y:i,width:a,height:o,context:r})=>{Math.round(Math.max(a,o)/5);const s=[b(0,255),b(0,255)];s.push(Math.max(0,Math.max(255,512-s[0]-s[1])));const n=s.splice(Math.floor(g()*s.length),1).pop(),l=s.splice(Math.floor(g()*s.length),1).pop(),h=s[0],c=[...new Array(10)].map(((e,i)=>new x({width:a,height:o,steps:t,texture:w({color:{red:n,green:l,blue:h,opacity:.15}})})));r.save(),r.translate(e+a/2,i+o/2);for(let e=0;e<t;e++)for(const t of c)t.render(r);r.restore()},v=(()=>{let t=null;return()=>(t||(t=(()=>{const t=1e3,e=Math.max(screen.width,screen.height)/t,i=document.createElement("canvas");i.width=t*e,i.height=1e4*e;let a=0;const o=()=>a*t*e;return{increment:()=>{if(a>=10)return;const o=document.createElement("canvas");o.width=t*e,o.height=t*e;const r=o.getContext("2d");r.save(),r.scale(e,e),r.fillStyle="#000",r.fillRect(0,0,t,t);const s=b(2,4);for(let e=0;e<s;e++){const e=Math.round((.5+1*g())*t),i=Math.round((.2+.8*g())*t),a=Math.round(g()*t-e/2),o=Math.round(g()*(t-i));S({steps:100,x:a,y:o,width:e,height:i,context:r})}for(let e=0;e<50;e++)r.beginPath(),r.fillStyle=`rgba(${b(155,255)}, ${b(155,255)}, ${b(155,255)}, ${g()})`,r.arc(t*g(),t*g(),1.5*g(),0,p),r.fill();r.restore(),i.getContext("2d").drawImage(o,0,a*t*e),a++},getHeight:o,canvas:i,draw:(t,e,a,r)=>{const s=o()*a/i.width;for(let n=(-1e4*s+e)%s;n<r;n+=s)t.drawImage(i,0,0,i.width,o(),0,n,a,s)}}})()),t)})(),P="thiagorb_space_jump",k={get(){let t;try{const e=localStorage&&localStorage.getItem(P);t=JSON.parse(e)}catch(t){}return(t=>t&&Array.isArray(t.ranking)&&!t.ranking.some((t=>!t||"string"!=typeof t.player||"number"!=typeof t.score))&&"boolean"==typeof t.audio&&"number"==typeof t.graphicsQuality)(t)?t:{audio:!1,graphicsQuality:1,ranking:[]}},update(t){const e=k.get();t(e);try{localStorage&&localStorage.setItem(P,JSON.stringify(e))}catch(t){}}},A="space-jump.testnet";let C,M;const L=(async()=>{const t=await nearApi.connect({nodeUrl:"https://rpc.testnet.near.org",walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org",networkId:"testnet",keyStore:new nearApi.keyStores.BrowserLocalStorageKeyStore(localStorage,P)});C=new nearApi.WalletConnection(t,P),C.isSignedIn()&&(M=await new nearApi.Contract(C.account(),A,{viewMethods:["get_ranking"],changeMethods:["add_ranking_entry"],sender:C.getAccountId()}))})(),T=()=>null==C?void 0:C.getAccountId(),I=()=>null==C?void 0:C.isSignedIn();let R=[];const E=t=>{const e=new Map;for(const i of R.concat(t))e.set(i.uuid,i);return[...e.values()].sort(((t,e)=>e.score-t.score)).slice(0,10)},O=async()=>{try{R=await(async()=>{var t;return null===(t=await(null==M?void 0:M.get_ranking()))||void 0===t?void 0:t.map((t=>Object.assign(Object.assign({},t),{uuid:`0x${BigInt(t.uuid).toString(16)}`})))})()||[]}catch(t){}},$=()=>E(k.get().ranking),j=t=>{const e=(()=>{let t=BigInt(0);for(let e=0;e<16;e++)t<<=BigInt(8),t|=BigInt(256*Math.random()|0);return`0x${t.toString(16)}`})(),i={uuid:e,player:T()||"guest",score:t};if(k.update((t=>{t.ranking=E([...t.ranking,i])})),I())try{((t,e)=>{null==M||M.add_ranking_entry({uuid:t.toString(),score:e})})(e,t)}catch(t){}},q=1/60,G=.5555555555555556,{cos:z,sin:B,max:U,min:D,abs:F,PI:W}=Math,H=t=>t>0?1:t<0?-1:0,_=(t,e,i)=>U(t,D(e,i));class J{constructor(){this.position={x:0,y:0}}get bottom(){return this.position.y+this.height}get right(){return this.position.x+this.width}get left(){return this.position.x}get top(){return this.position.y}boundBoxCollision(t){return this.right>t.left&&this.left<t.right&&this.bottom>t.top&&this.top<t.bottom}}class N extends J{constructor(){super(...arguments),this.width=1e3,this.height=1e3,this.speed=-50*q,this.speedBoost=0}}class K{constructor(t,e,i,a,o){this.light="#fff",this.shadow="#999",this.width=o,this.begin={x:t,y:e},this.end={x:i,y:a}}}const Q=(t,e)=>{const i=Math.log(4.4*e.width)/1.8,a=-.07*i;e.begin.x===e.end.x&&e.begin.y===e.end.y?(t.fillStyle=e.light,t.beginPath(),t.arc(e.begin.x+a,e.begin.y+a,i/2,0,p),t.fill()):(t.strokeStyle=e.light,t.lineWidth=i,t.beginPath(),t.moveTo(e.begin.x+a,e.begin.y+a),t.lineTo(e.end.x+a,e.end.y+a),t.stroke())},Y=(t,e)=>{e.begin.x===e.end.x&&e.begin.y===e.end.y?(t.fillStyle=e.shadow,t.beginPath(),t.arc(e.begin.x,e.begin.y,e.width/2,0,p),t.fill()):(t.strokeStyle=e.shadow,t.lineWidth=e.width,t.beginPath(),t.moveTo(e.begin.x,e.begin.y),t.lineTo(e.end.x,e.end.y),t.stroke())},X=({lifeTime:t,maxParticles:e,maxRadius:i,speed:a,direction:o,scale:r,mainAxisShift:s,colorOverTime:n})=>{const l=z(o),h=B(o),c=2*i,d=r*c,m=(()=>{const e=document.createElement("canvas");e.width=c,e.height=c*t;const a=e.getContext("2d");for(let e=t;e--;){const o=e/t,r=n(o);a.fillStyle=`rgba(${r.r}, ${r.g}, ${r.b}, ${r.a})`,a.beginPath();const s=i*(1-F(.3-o));a.arc(i,i+c*e,s,0,p),a.closePath(),a.fill()}return e})();return{make:()=>{const i=[...new Array(e)].map((()=>({speed:{x:0,y:0},x:0,y:0,time:0})));let o=0;return{add:(t,e,r,n)=>{for(let c=0;c<r;c++){o=D(o+1,i.length-1);const r=i[o-1],m=a+c,p=3*(.5-g());r.speed.x=m*l+p*h,r.speed.y=-m*h+p*l;const u=(.5-g())*n;r.x=t-d/2+s*c*l+u*h,r.y=e-d/2-s*c*h+u*l,r.time=0}},render:e=>{if(0===o)return;const a=e.getTransform();e.save(),e.resetTransform(),e.translate(0|a.m41,0|a.m42);const r=a.m11,s=a.m22;for(let a=o;a--;){const n=i[a];n.time>=t?(o--,a!==o&&(i[a].x=i[o].x,i[a].y=i[o].y,i[a].time=i[o].time,i[a].speed.x=i[o].speed.x,i[a].speed.y=i[o].speed.y)):(e.drawImage(m,0,n.time*c,c,c,n.x*r|0,n.y*s|0,d*r|0,d*s|0),n.time++,n.x+=n.speed.x,n.y+=n.speed.y)}e.restore()}}}}},V=new Map([[0,[{0:-W/2-.1,1:-W/2-.1}]],[1,[{0:-W/2-.6,1:-W/2+.6},{0:-W/2+.6,1:-W/2-.6}]],[2,[{0:-W/2-.8,1:-W/2+1.2},{goTo:3}]],[3,[{0:-W/2-.2,1:-W/2-2.2},{0:-W/2-.3,1:-W/2-2.5}]],[4,[{0:-W/2-.1,1:-W/2-.1},{0:-W/2-.3,1:-W/2-.3}]]]);class Z extends J{constructor(){super(...arguments),this.speed={x:0,y:0},this.width=70,this.height=150,this.direction=1,this.rocket=!1,this.jumpGrace=0,this.high=1/0,this.dead=!1,this.legGap=.25,this.armGap=.5,this.body=new K(0,.1,0,.1,1),this.leftLeg=new K(.9*-this.legGap,.3,-this.legGap,.8,.4),this.rightLeg=new K(.9*this.legGap,.3,this.legGap,.8,.4),this.head=new K(0,-.5,0,-.5,1),this.leftArm=new K(.8*-this.armGap,-.1,-this.armGap,.3,.4),this.rightArm=new K(.8*this.armGap,-.1,this.armGap,.3,.4),this.rocketParticles=X({lifeTime:20,maxParticles:250,maxRadius:25,speed:10,direction:-W/2,scale:1,mainAxisShift:3,colorOverTime:t=>{const e=255*D(1,1-2*t),i=_(0,1,1-t);return{r:255*i,g:e*i,b:0,a:.3*i}}}).make(),this.animationState={0:-W/2,1:-W/2},this.animationSpeed=.12,this.deadAnimationSpeed=.04,this.animation=0,this.currentFrame=0}updateAnimation(){const t=V.get(this.animation);this.currentFrame>=t.length&&(this.currentFrame=0);const e=t[this.currentFrame];"goTo"in e&&(this.animation=e.goTo,this.currentFrame=0);let i=!0;const a=this.dead?this.deadAnimationSpeed:this.animationSpeed;for(const t in this.animationState){const o=e[t]-this.animationState[t];F(o)<a?this.animationState[t]=e[t]:(i=!1,this.animationState[t]+=a*H(o))}i&&this.currentFrame++}render(t){t.save(),this.rocket&&(this.rocketParticles.add(this.position.x+this.width/2,this.position.y+this.height/2,10,10),this.speed.y>=0&&(this.rocket=!1)),this.rocketParticles.render(t),this.updateAnimation(),this.leftLeg.end.x=this.leftLeg.begin.x+.5*z(this.animationState[0]),this.leftLeg.end.y=this.leftLeg.begin.y-.5*B(this.animationState[0]),this.rightLeg.end.x=this.rightLeg.begin.x-.5*z(this.animationState[0]),this.rightLeg.end.y=this.rightLeg.begin.y-.5*B(this.animationState[0]),this.leftArm.end.x=this.leftArm.begin.x+.4*z(this.animationState[1]),this.leftArm.end.y=this.leftArm.begin.y-.4*B(this.animationState[1]),this.rightArm.end.x=this.rightArm.begin.x-.4*z(this.animationState[1]),this.rightArm.end.y=this.rightArm.begin.y-.4*B(this.animationState[1]),t.translate(this.left+this.width/2,this.top+this.height/2),t.scale(this.height/2,this.height/2),t.lineCap="round",Y(t,this.leftArm),Y(t,this.rightArm),Q(t,this.rightArm),Q(t,this.leftArm),Y(t,this.leftLeg),Y(t,this.rightLeg),Q(t,this.leftLeg),Q(t,this.rightLeg),Y(t,this.head),Y(t,this.body),Q(t,this.head),Q(t,this.body),1===this.direction?(Q(t,this.leftLeg),Y(t,this.leftArm),Q(t,this.leftArm)):(Q(t,this.rightLeg),Y(t,this.rightArm),Q(t,this.rightArm)),this.drawGlass(t),t.fillStyle="#000",t.fill(),t.fillStyle=t.strokeStyle="#fff",t.lineWidth=.05,t.beginPath(),t.bezierCurveTo(.35*this.direction,-.7,.34*this.direction,-.75,.26*this.direction,-.82),t.stroke(),t.beginPath(),t.arc(.4*this.direction,-.6,.025,0,p),t.fill(),t.restore()}drawGlass(t){t.beginPath();const e=.3*this.direction;t.moveTo(e,-.9),t.bezierCurveTo(e+0*this.direction,-.9,-.5*this.direction,-1,-0*this.direction,-.4),t.bezierCurveTo(.4*this.direction,-.3,.73*this.direction,-.5,e,-.9),t.closePath()}tick(t){const e=.5555555555555556,i=this.speed.y;!this.dead&&f.arrowLeft?(this.speed.x=U(-8.333333333333334,this.speed.x-e),this.direction=-1,this.animation=1):!this.dead&&f.arrowRight?(this.speed.x=D(8.333333333333334,this.speed.x+e),this.direction=1,this.animation=1):(this.speed.x=F(this.speed.x)>e?this.speed.x-H(this.speed.x)*e:0,t.onPlatform&&(this.animation=0)),t.onPlatform?this.speed.y>0&&(this.speed.y=0):this.speed.y=D(16.666666666666668,this.speed.y+G),(t.onPlatform||this.jumpGrace>0)&&!this.dead&&f.arrowUp&&(this.jumpGrace=0,this.speed.y=-20,this.animation=2,this.currentFrame=0,h.playJump()),t.onPlatform?this.jumpGrace=5.1:(this.jumpGrace=U(0,this.jumpGrace-1),this.speed.y>0?this.animation=3:2!==this.animation&&(this.rocket?this.animation=4:this.animation=0)),this.position.x+=this.speed.x,this.position.y+=this.speed.y,i<=0&&this.speed.y>=0&&(this.high=this.bottom),this.top>t.screenArea.bottom&&this.speed.y>=t.screenArea.speed&&this.die()}die(){this.dead=!0}}class tt extends J{tick(t){}preTick(t){}}class et extends tt{constructor(){super(...arguments),this.width=0,this.height=0,this.visualAlert=0,this.alpha=0}render(t){const e=t.createLinearGradient(0,0,0,.2*d.height);t.globalAlpha=this.alpha,e.addColorStop(0,"rgba(255, 0, 0, 1.0)"),e.addColorStop(.3,"rgba(255, 0, 0, 0.4)"),e.addColorStop(1,"rgba(255, 0, 0, 0)"),t.fillStyle=e,t.fillRect(0,0,d.width,.2*d.height),this.visualAlert++,t.globalAlpha=1}tick(t){this.alpha=Math.abs(this.visualAlert%it.period/it.period-.5),this.bottom>t.screenArea.top&&this.alpha<.1&&t.removeObject(this)}}class it extends tt{constructor(){super(...arguments),this.width=2*it.radius,this.height=2*it.radius,this.particles=it.particlesMaker.make()}render(t){this.particles.add(this.position.x+this.width/2,this.position.y+this.height/2,2,10),this.particles.render(t),t.drawImage(it.sprite,this.position.x,this.position.y+this.height-it.sprite.height/2,it.sprite.width/2,it.sprite.height/2)}tick(t){this.boundBoxCollision(t.player)&&t.player.die(),(this.position.x<-1e3||this.position.y>t.screenArea.bottom+500)&&t.removeObject(this),!t.paused&&this.top<t.player.bottom&&h.playAlert(),this.position.x-=50*q}}it.radius=25,it.period=60,it.tailDirection=W/8,it.particlesMaker=X({lifeTime:20,maxParticles:250,maxRadius:it.radius/3|0,direction:it.tailDirection,speed:30,scale:6,mainAxisShift:10,colorOverTime:t=>{const e=255*D(1,1-2*t),i=_(0,1,1-t);return{r:255*i,g:e*i,b:255,a:.1*i}}}),it.sprite=(()=>{const t=8*it.radius,e=document.createElement("canvas"),i=it.radius+t*z(it.tailDirection)+2*it.radius,a=it.radius+t*B(it.tailDirection)+2*it.radius;e.width=2*i,e.height=2*a;const o=e.getContext("2d");o.scale(2,2);const r=it.radius,s=it.radius,n=a-it.radius;o.beginPath(),o.fillStyle="rgba(255, 255, 255, 0.8)",o.arc(s,n,.8*it.radius,0,p),o.fill();for(let e=0;e<500;e++){const e=g()*p,i=.8*g(),a=o.createLinearGradient(0,0,1.5*t*g(),0);a.addColorStop(0,"rgba(255, 255, 255, 0.2)"),a.addColorStop(.2,"rgba(255, 255, 255, 0.01)"),a.addColorStop(1,"rgba(255, 255, 255, 0.0)"),o.fillStyle=a,o.save(),o.translate(s+i*z(e)*r,n-i*B(e)*r),o.moveTo(0,0),o.rotate(-it.tailDirection+(.5-g())*W/6),o.fillRect(0,-5,2*t,10),o.restore()}return e})();class at extends tt{constructor(){super(),this.width=20,this.height=20,this.rotation=0,this.leftTube=new K(-.1,-.4,-.1,0,.5),this.rightTube=new K(.1,-.4,.1,0,.5),this.leftTube.light=this.rightTube.light="#ddd",this.leftTube.shadow=this.rightTube.shadow="#999"}render(t){t.save(),t.translate(this.position.x+this.width/2,this.position.y+this.width/2),this.rotation++,t.scale(.5,.5),t.translate(this.width/2,this.height/2),t.rotate(.1*z(.1*this.rotation)),t.translate(-at.sprite.width/2,4*-at.sprite.height/5),t.drawImage(at.sprite,0,0,at.sprite.width,at.sprite.height),t.restore()}tick(t){if(this.position.y>t.screenArea.bottom+m&&t.removeObject(this),!t.player.dead&&this.boundBoxCollision(t.player)){h.playRocket(),t.player.speed.y=-30,t.player.rocket=!0,t.player.jumpGrace=0;const e=1-(t.player.top-t.screenArea.top)/m;t.screenArea.speedBoost=D(0,-1.6*e*20)}}}at.sprite=(()=>{const t=document.createElement("canvas");t.width=108,t.height=140;const e=t.getContext("2d");e.save(),e.scale(2,2),e.translate(27,63);const i=()=>{e.beginPath(),e.moveTo(0,-1),e.bezierCurveTo(.3,-.8,.3,-.4,.15,-.1),e.lineTo(-.15,-.1),e.bezierCurveTo(-.3,-.4,-.3,-.8,0,-1)},a=()=>{e.beginPath(),e.moveTo(.25,-.5),e.bezierCurveTo(.45,-.35,.4,0,.4,0),e.bezierCurveTo(.3,-.2,.2,-.2,.2,-.2),e.moveTo(-.25,-.5),e.bezierCurveTo(-.45,-.35,-.4,0,-.4,0),e.bezierCurveTo(-.3,-.2,-.2,-.2,-.2,-.2)};return e.scale(60,60),e.lineWidth=.07,e.lineCap="round",e.strokeStyle="#fff",i(),e.stroke(),a(),e.stroke(),e.fillStyle="#bbb",i(),e.fill(),e.fillStyle="#69f",a(),e.fill(),e.restore(),t})();class ot extends tt{get width(){return ot.width}get height(){return ot.height}tick(t){this.position.y>t.screenArea.bottom+m&&t.removeObject(this)}preTick(t){this!==t.ignorePlatform&&this.isPlayerOn(t.player)&&!t.player.dead&&(t.onPlatform=this,t.player.position.y=this.top-t.player.height)}isPlayerOn(t){return t.speed.y>=0&&t.right>this.left&&t.left<this.right&&t.high<this.top+1&&F(t.bottom-this.top)<10}}ot.width=100,ot.height=20;class rt extends ot{render(t){t.drawImage(rt.sprite,this.position.x,this.position.y-10,ot.width,ot.height+20)}}rt.sprite=(()=>{const t=document.createElement("canvas");t.width=2*ot.width,t.height=2*(ot.height+20);const e=t.getContext("2d"),i=e.createLinearGradient(-1,0,1,0);i.addColorStop(.1,"#bbb"),i.addColorStop(.2,"#fff"),i.addColorStop(.3,"#bbb"),i.addColorStop(1,"#555");const a=e.createLinearGradient(-1,0,0,.2);a.addColorStop(.1,"rgba(255, 255, 255, 0.0)"),a.addColorStop(.2,"rgba(255, 255, 255, 0.3)"),a.addColorStop(.3,"rgba(255, 255, 255, 0.0)"),a.addColorStop(.5,"rgba(255, 255, 255, 0.0)"),a.addColorStop(.6,"rgba(255, 255, 255, 0.3)"),a.addColorStop(.9,"rgba(255, 255, 255, 0.0)");const o=e.createRadialGradient(0,-1,0,0,0,1);return o.addColorStop(.5,"rgba(120, 120, 120, 1.0)"),o.addColorStop(1,"rgba(160, 160, 160, 1.0)"),e.save(),e.scale(2,2),e.translate(0,10),e.save(),e.translate(ot.width/2,ot.height/2+20),e.scale(ot.width/2,ot.height/2),e.beginPath(),e.rect(-1,-3,2,2),e.ellipse(0,-1,1,1,0,0,p),e.clip(),e.fillStyle=i,e.fillRect(-1,-3,2,10),e.fillStyle=a,e.fillRect(-1,-2,2,10),e.restore(),e.save(),e.translate(ot.width/2,ot.height/2-10),e.scale(ot.width/2,ot.height/2),e.fillStyle=o,e.beginPath(),e.ellipse(0,0,1,1,0,0,p),e.closePath(),e.fill(),e.restore(),e.restore(),t})();class st extends ot{constructor(){super(...arguments),this.time=st.maxTime,this.disappearing=!1}render(t){t.globalAlpha=this.time/st.maxTime,t.drawImage(st.sprite,this.position.x,this.position.y-10,ot.width,ot.height+40),t.globalAlpha=1}tick(t){super.tick(t),this.disappearing&&(this.time<=0?t.removeObject(this):this.time-=1),t.onPlatform===this&&(this.disappearing=!0,h.playIce())}isPlayerOn(t){return this.time>.7*st.maxTime&&super.isPlayerOn(t)}static get maxTime(){return 24}}st.sprite=(()=>{const t=document.createElement("canvas");t.width=2*ot.width,t.height=2*(ot.height+40);const e=t.getContext("2d"),i=e.createRadialGradient(0,0,0,0,0,1);i.addColorStop(.5,"rgba(255, 255, 255, 0.0)"),i.addColorStop(1,"rgba(255, 255, 255, 0.2)");const a=e.createLinearGradient(-1,0,1,0);a.addColorStop(0,"rgba(255, 255, 255, 0.2)"),a.addColorStop(.2,"rgba(255, 255, 255, 0.0)"),a.addColorStop(.7,"rgba(255, 255, 255, 0.0)"),a.addColorStop(1,"rgba(255, 255, 255, 0.5)");const o=e.createLinearGradient(-1,0,0,.2);o.addColorStop(.1,"rgba(255, 255, 255, 0.0)"),o.addColorStop(.2,"rgba(255, 255, 255, 0.3)"),o.addColorStop(.3,"rgba(255, 255, 255, 0.0)"),o.addColorStop(.5,"rgba(255, 255, 255, 0.0)"),o.addColorStop(.6,"rgba(255, 255, 255, 0.3)"),o.addColorStop(.9,"rgba(255, 255, 255, 0.0)");const r=e.createRadialGradient(0,0,0,0,0,1);return r.addColorStop(.5,"rgba(255, 255, 255, 0.0)"),r.addColorStop(1,"rgba(255, 255, 255, 0.7)"),e.save(),e.scale(2,2),e.translate(0,10),e.save(),e.translate(ot.width/2,ot.height/2+20),e.scale(ot.width/2,ot.height/2),e.fillStyle=i,e.beginPath(),e.ellipse(0,0,1,1,0,0,p),e.fill(),e.beginPath(),e.rect(-1,-3,2,3),e.ellipse(0,0,1,1,0,0,p),e.clip(),e.fillStyle=a,e.fillRect(-1,-3,2,10),e.fillStyle=o,e.fillRect(-1,-3,2,10),e.restore(),e.save(),e.translate(ot.width/2,ot.height/2-10),e.scale(ot.width/2,ot.height/2),e.fillStyle=r,e.beginPath(),e.ellipse(0,0,1,1,0,0,p),e.fill(),e.restore(),e.restore(),t})();class nt extends ot{constructor(){super(...arguments),this.direction=1,this.render=(()=>{let t=0;const e=(e,i,a)=>{const o=a+t;e.save(),e.translate(this.width/2+this.width*z(o)/2,this.height/2-4+this.height*B(o)/2),e.drawImage(i,0,0,i.width,i.height,-20,-20,40,40),e.restore()};return i=>{i.save(),i.translate(this.position.x,this.position.y);for(let a=nt.lightSprites.length;a--;){const o=nt.lightsAngle*a;(o+t)%p>=W&&e(i,nt.lightSprites[a],o)}i.drawImage(nt.sprite,0,-10,ot.width,ot.height+20);for(let a=nt.lightSprites.length;a--;){const o=nt.lightsAngle*a;(o+t)%p<W&&e(i,nt.lightSprites[a],o)}t=(p+t+.1*this.direction)%p,i.restore()}})()}tick(t){super.tick(t),this.position.x+=nt.horizontalSpeed*this.direction,t.onPlatform===this&&(t.player.position.x+=nt.horizontalSpeed*this.direction),(this.left<=0&&this.direction<0||this.right>=m&&this.direction>0)&&(this.direction*=-1)}static get horizontalSpeed(){return 100*q}}nt.lightSprites=[{red:255,green:0,blue:0},{red:255,green:255,blue:0},{red:0,green:0,blue:255}].map((({red:t,green:e,blue:i})=>{const a=document.createElement("canvas");a.width=50,a.height=50;const o=a.getContext("2d"),r=o.createRadialGradient(0,0,0,0,0,1);return r.addColorStop(0,`rgba(${t}, ${e}, ${i}, 0.9)`),r.addColorStop(.1,`rgba(${t}, ${e}, ${i}, 0.7)`),r.addColorStop(.2,`rgba(${t}, ${e}, ${i}, 0.2)`),r.addColorStop(1,`rgba(${t}, ${e}, ${i}, 0)`),o.save(),o.translate(25,25),o.scale(25,25),o.fillStyle=r,o.beginPath(),o.arc(0,0,1,0,p),o.fill(),o.restore(),a})),nt.lightsAngle=p/nt.lightSprites.length,nt.sprite=(()=>{const t=document.createElement("canvas");t.width=2*ot.width,t.height=2*(ot.height+20);const e=t.getContext("2d");return e.save(),e.scale(2,2),e.fillStyle="#aaa",e.beginPath(),e.ellipse(ot.width/2,ot.height/2+20,ot.width/2,ot.height/2,0,0,p),e.fill(),e.fillStyle="#000",e.beginPath(),e.ellipse(ot.width/2,ot.height/2+10,ot.width/2,ot.height/2,0,0,p),e.fill(),e.fillStyle="#aaa",e.beginPath(),e.ellipse(ot.width/2,ot.height/2,ot.width/2,ot.height/2,0,0,p),e.fill(),e.restore(),t})();class lt{constructor(){var t;this.paused=!1,this.ending=!1,this.over=!1,this.previousTime=0,this.player=new Z,this.objectLayers=[[],[],[]],this.screenArea=new N,this.nextPlatformTop=0,this.previousPlatformX=0,this.backgroundY=0,this.onPlatform=null,this.ignorePlatform=null,this.highScore=(null===(t=$()[0])||void 0===t?void 0:t.score)||0,this.score=0,this.rockets=!1,this.nextComet=-1e4,this.levelConfig=lt.normalMode()}tick(){f.arrowDown&&!this.ignorePlatform&&(this.ignorePlatform=this.onPlatform),this.onPlatform=null;for(let t=this.objectLayers.length;t--;){const e=this.objectLayers[t];for(let t=e.length;t--;)e[t].preTick(this)}if(this.ignorePlatform&&(this.onPlatform&&this.onPlatform!==this.ignorePlatform||this.player.speed.y<0)&&(this.ignorePlatform=null),this.screenArea.top-m<this.nextPlatformTop){let t;const e=g(),i=this.levelConfig();if(e>=i.minIcePlatform&&e<i.maxIcePlatform&&(t=new st),e>=i.minMovingPlatform&&e<i.maxMovingPlatform&&(t=new nt),e>=i.minStaticPlatform&&e<i.maxStaticPlatform&&(t=new rt),this.addObject(t),t.position.x=_(0,m-t.width,this.previousPlatformX+500*(.5-g())),t.position.y=this.nextPlatformTop,this.previousPlatformX=t.position.x,this.nextPlatformTop=this.nextPlatformTop-100-50*g(),e>=i.minRocket&&e<i.maxRocket){const e=new at;e.position.x=t.left+(t.width-e.width)*g(),e.position.y=t.top-e.height,this.addObject(e,0)}}if(this.screenArea.top-2*it.radius<this.nextComet){const t=new it,e=new et;t.position.x=e.position.x=(.3+.7*g())*m,t.position.y=e.position.y=this.nextComet-m,this.addObject(t,0),this.addObject(e,2),this.nextComet=this.nextComet-(9+3*g())*m}this.player.tick(this);for(let t=this.objectLayers.length;t--;){const e=this.objectLayers[t];for(let t=e.length;t--;)e[t].tick(this)}this.screenArea.speedBoost<0&&(this.screenArea.speedBoost+=G),this.screenArea.top>this.player.top&&(this.screenArea.position.y=this.player.top+this.player.speed.y,this.screenArea.speedBoost=D(this.screenArea.speedBoost,-26-this.screenArea.speed)),this.screenArea.position.y+=this.screenArea.speed+this.screenArea.speedBoost,this.backgroundY-=(this.screenArea.speed+this.screenArea.speedBoost)/10,this.screenArea.speed=U(-200*q,this.screenArea.speed-.02*q)}updateScore(){this.ending||(this.score=-(this.screenArea.top/100|0))}addObject(t,e=1){const i=this.objectLayers[e];i.push(t),t.id=i.length,t.layer=e}removeObject(t){const e=this.objectLayers[t.layer],i=e.pop();t!==i&&(i.id=t.id,e[t.id-1]=i)}}lt.normalMode=()=>{let t=0,e=0;const i=[{platformCount:9,minStaticPlatform:0,maxStaticPlatform:1,minRocket:0,maxRocket:0,minMovingPlatform:0,maxMovingPlatform:0,minIcePlatform:0,maxIcePlatform:0},{platformCount:1,minStaticPlatform:0,maxStaticPlatform:1,minRocket:0,maxRocket:1,minMovingPlatform:0,maxMovingPlatform:0,minIcePlatform:0,maxIcePlatform:0},{platformCount:10,minStaticPlatform:0,maxStaticPlatform:1,minRocket:0,maxRocket:0,minMovingPlatform:0,maxMovingPlatform:0,minIcePlatform:0,maxIcePlatform:0},{platformCount:20,minStaticPlatform:0,maxStaticPlatform:.5,minRocket:0,maxRocket:0,minMovingPlatform:0,maxMovingPlatform:0,minIcePlatform:.5,maxIcePlatform:1},{platformCount:20,minStaticPlatform:0,maxStaticPlatform:.5,minRocket:0,maxRocket:0,minMovingPlatform:.5,maxMovingPlatform:1,minIcePlatform:0,maxIcePlatform:0}],a=[{platformCount:30,minStaticPlatform:0,maxStaticPlatform:.6,minRocket:0,maxRocket:.1,minMovingPlatform:.6,maxMovingPlatform:.9,minIcePlatform:.9,maxIcePlatform:1},{platformCount:10,minStaticPlatform:0,maxStaticPlatform:0,minRocket:0,maxRocket:0,minMovingPlatform:0,maxMovingPlatform:1,minIcePlatform:0,maxIcePlatform:0},{platformCount:30,minStaticPlatform:0,maxStaticPlatform:0,minRocket:0,maxRocket:0,minMovingPlatform:0,maxMovingPlatform:0,minIcePlatform:0,maxIcePlatform:1},{platformCount:30,minStaticPlatform:0,maxStaticPlatform:0,minRocket:0,maxRocket:0,minMovingPlatform:0,maxMovingPlatform:.5,minIcePlatform:.5,maxIcePlatform:1},{platformCount:50,minStaticPlatform:0,maxStaticPlatform:.7,minRocket:0,maxRocket:.7,minMovingPlatform:.6,maxMovingPlatform:.9,minIcePlatform:.9,maxIcePlatform:1}];return()=>{let o;return t<i.length?(o=i[t],e++,o.platformCount===e&&(t++,e=0)):(o=a[t-i.length],e++,o.platformCount===e&&(t=i.length+(g()*a.length|0),e=0)),o}},lt.rocketsMode=()=>()=>({minStaticPlatform:0,maxStaticPlatform:.6,minRocket:0,maxRocket:.6,minMovingPlatform:.6,maxMovingPlatform:.9,minIcePlatform:.9,maxIcePlatform:1});onerror=t=>{alert(t.toString())};const ht=()=>{const t=document.querySelector("#game-canvas");t.width=document.body.clientWidth*devicePixelRatio/yt,t.height=document.body.clientHeight*devicePixelRatio/yt;const e=Math.min(document.body.clientWidth,document.body.clientHeight)/100;document.documentElement.style.fontSize=`${e}px`,u.scale=Math.min(t.width/m,t.height/m)};addEventListener("resize",ht),(()=>{try{const t=document.monetization;if(!t)return;t.addEventListener("monetizationstart",(()=>{"started"===t.state&&document.querySelectorAll(".subscriber-only").forEach((t=>t.classList.remove("subscriber-only")))}))}catch(t){}})();const ct=t=>{if(!Et)return;const e=Array.from(Et.querySelectorAll(".button")).filter((t=>t.offsetWidth>0));let i;for(i=0;i<e.length;i++)if(e[i].classList.contains("active"))return e[(e.length+i+t)%e.length]},dt=()=>Et&&Et.querySelector(".active"),mt=t=>{if(!Et)return;const e=dt();e&&e.classList.remove("active"),t.classList.add("active"),h.playMouseOver()};document.addEventListener("keydown",(t=>{const e=y.get(t.code);if(Et)if("arrowDown"===e||"arrowRight"===e){const t=ct(1);t&&mt(t)}else if("arrowLeft"===e||"arrowUp"===e){const t=ct(-1);t&&mt(t)}if("enter"===e){const t=dt();t?t.click():jt()}e&&(f[e]=!0)})),document.addEventListener("keyup",(t=>{const e=y.get(t.code);e&&(f[e]=!1)}));let pt=!1;const gt=()=>{const t=v();t.increment();const e=new Z;e.position.x=250,e.position.y=400;let i=t.getHeight()*g(),a=null;const o=r=>{const s=d.getContext("2d");t.draw(s,i,d.width,d.height),s.save(),s.translate(d.width/2,d.height/2),s.scale(u.scale,u.scale),s.translate(-500,-500),e.render(s),s.restore(),a&&(i+=.01*(r-a)),a=r,pt&&requestAnimationFrame(o)};Rt(),Tt(),pt=!0;const r=document.querySelector("#menu");r.style.display=null,Et=r,mt(document.querySelector("#start")),requestAnimationFrame(o)},ut=()=>{document.querySelector("#audio .setting").setAttribute("data-text",h.enabled?"YES":"NO")},ft=new Map([[1,"HIGH"],[2,"MEDIUM"],[3,"LOW"]]);let yt=1;const bt=async()=>{const t=await(async()=>(await L,null==C?void 0:C.isSignedIn()))();document.querySelector("#sign").setAttribute("data-text",t?"SIGN OUT":"SIGN IN"),document.querySelector("#sign .setting").setAttribute("data-text",It(T()||""))},xt=t=>{k.update((e=>e.audio=h.enabled=t)),ut()},wt=t=>{k.update((e=>e.graphicsQuality=yt=t)),document.querySelector("#graphics .setting").setAttribute("data-text",ft.get(yt)),ht()},St=()=>new Promise(requestAnimationFrame),vt=t=>new Promise((e=>setTimeout(e,t)));let Pt=null;const kt=async(t=500)=>{for(;Pt;)await Pt;return Pt=new Promise((async e=>{const i=document.querySelector("#fade-transition");await(async()=>{let t,e=30,i=0;do{t=-await St()+await St(),t>1e3/60?i=0:i++}while(--e>0&&i<5)})(),i.style.transition=`opacity ${t}ms`,await(document.body.getClientRects()&&St()),i.classList.remove("visible"),await vt(t),i.style.zIndex="-1",Pt=null,e()}))},At=async(t=500)=>{for(;Pt;)await Pt;return Pt=new Promise((async e=>{const i=document.querySelector("#fade-transition");i.style.transition=`opacity ${t}ms`,i.classList.add("visible"),i.style.zIndex="1",await vt(t),Pt=null,e()}))};let Ct;const Mt=(t,e,i,a,o)=>{i=i;const r=Math.ceil(p*i),s=p/r;for(let n=0;n<r;n++){const r=n*s;t.drawImage(e,a+i*Math.cos(r),o-i*Math.sin(r))}};let Lt;const Tt=()=>{document.body.classList.add("cursor")},It=t=>t.replace(/\.testnet$/,""),Rt=async()=>{await O();const t=$();if(0===t.length)return;const e=document.querySelector("#ranking div");let i=1;e.innerHTML="";for(const a of t){const t=document.createElement("div");t.innerText=i+++".";const o=document.createElement("div");o.innerText=It(a.player);const r=document.createElement("div");r.innerText=a.score.toString(),e.append(t,o,r)}document.querySelector("#ranking").style.display="block"};let Et=null,Ot=null;document.addEventListener("DOMContentLoaded",(()=>{const t=document.body;ht(),document.querySelector("#audio").addEventListener("click",(()=>{xt(!h.enabled)})),document.querySelector("#graphics").addEventListener("click",(()=>{wt(1+yt%3)})),document.querySelector("#fullscreen").addEventListener("click",(async()=>{document.fullscreenElement?document.exitFullscreen():(async()=>{t.webkitEnterFullScreen?await t.webkitEnterFullScreen():await t.requestFullscreen()})()})),document.querySelector("#sign").addEventListener("click",(async()=>{I()?((async()=>{await L,C.signOut()})(),bt()):(async()=>{await L,C.requestSignIn(A,"SPACE JUMP")})()}));const e=async(t={})=>{pt=!1,Et=null,await At(),document.querySelector("#menu").style.display="none",h.buildSamples(),Ot=(({rockets:t=!1})=>{const e=v();let i=0,a=0;const o=new lt;o.backgroundY=e.getHeight()*g(),o.player.position.x=(m-o.player.width)/2,o.player.position.y=50,o.levelConfig=t?lt.rocketsMode():lt.normalMode();{const t=new rt;o.addObject(t),t.position.x=(m-t.width)/2,t.position.y=200,o.previousPlatformX=t.position.x}const r={start:()=>{document.body.classList.add("playing"),h.playGameStart(),r.startLoop()},animate:t=>{o.updateScore();const s=d.getContext("2d");d.width=d.width,e.draw(s,o.backgroundY,d.width,d.height),((t,e)=>{e.save();{const i=t.objectLayers[t.objectLayers.length-1];for(let t=i.length;t--;)i[t].render(e)}e.translate(0,d.height/2),e.translate(0,-1e3*u.scale/2),e.beginPath(),e.rect(0,0,d.width,m*u.scale),e.closePath(),e.clip(),e.translate(d.width/2,0),e.scale(u.scale,u.scale),e.translate(-500,0),e.translate(-t.screenArea.left,-t.screenArea.top);for(let i=t.objectLayers.length-1;i--;){const a=t.objectLayers[i];for(let t=a.length;t--;)a[t].render(e)}t.player.render(e),e.restore(),e.save(),e.scale(u.scale,u.scale);const i=`HI-SCORE ${t.highScore.toString().padStart(6,"0")}`,a=`SCORE    ${t.score.toString().padStart(6,"0")}`;e.textBaseline="top",e.font="1000 40px monospace",e.lineWidth=5,e.strokeStyle="#333",e.strokeText(i,20,20),e.strokeText(a,20,60),e.fillStyle="#fff",e.fillText(i,20,20),e.fillText(a,20,60),e.restore()})(o,s);const n=D(500,t-o.previousTime+i),l=.06*n|0;if(i=n-l/.06,o.previousTime=t,!o.paused){const t=a+l;for(;a<t;a++)o.tick()}!o.ending&&o.player.dead&&r.end()},state:o,loop:t=>{r.animate(t),r.state.over||requestAnimationFrame(r.loop)},startLoop:()=>{document.body.classList.add("playing"),requestAnimationFrame((t=>{o.previousTime=t,r.loop(t)}))},pause:()=>{document.body.classList.remove("playing"),o.paused=!0},unpause:()=>{document.body.classList.add("playing"),o.paused=!1},end:()=>{document.body.classList.remove("playing"),o.ending=!0,o.player.die(),h.playGameOver(),j(o.score),At(3e3).then((async()=>{o.over=!0,await St(),gt(),kt(300)}))}};return r})(t),Ot.start(),await kt(3e3)};document.querySelector("#start").addEventListener("click",(()=>e())),document.querySelector("#rockets").addEventListener("click",(()=>e({rockets:!0}))),document.body.addEventListener("mouseover",(t=>{const e=t.target;e.matches(".button")&&mt(e)})),document.body.addEventListener("click",(t=>{t.target.matches(".button")&&h.playClick()})),document.querySelector("#pause--continue").addEventListener("click",(()=>{$t()})),document.querySelector("#pause--abort").addEventListener("click",(async()=>{await $t(),Ot.end(),Ot=null})),document.fullscreenEnabled||document.querySelector("#fullscreen").remove(),xt(k.get().audio),(()=>{Ct=document.createElement("canvas"),Ct.width=.02*screen.width,Ct.height=.02*screen.width;const t=Ct.getContext("2d");t.scale(Ct.width/100,Ct.width/100),t.fillStyle="#303",t.strokeStyle="#fff",t.lineWidth=5,t.beginPath(),t.moveTo(0,0),t.lineTo(100,30),t.lineTo(45,45),t.lineTo(30,100),t.closePath(),t.fill(),t.stroke();const e=document.createElement("style");e.textContent=`.cursor{cursor:url('${Ct.toDataURL()}'),auto}`,document.body.append(e)})(),Tt(),wt(k.get().graphicsQuality),bt(),(()=>{const t=v();t.increment(),t.increment(),gt(),ut(),(()=>{Lt=document.querySelector("#logo"),Lt.width=.8*Math.min(screen.width*devicePixelRatio,screen.height*devicePixelRatio),Lt.height=.4*Lt.width;const t=Lt.getContext("2d"),e=Lt.width,i=document.createElement("canvas");i.width=Lt.width,i.height=Lt.height;const a=i.getContext("2d");a.font=`100 ${.27*e}px Arial`,a.textBaseline="top",a.textAlign="center";const o=document.createElement("canvas");o.width=Lt.width,o.height=Lt.height;const r=o.getContext("2d"),s=.008*e,n=Math.ceil(5*s);for(let l=0;l<=n;l+=s){const s=l/n;a.clearRect(0,0,i.width,i.height),r.clearRect(0,0,o.width,o.height),a.fillStyle=`hsla(220, 100%, ${50+s*s*50}%, 1)`,a.fillText("SPACE",.5*e,.01*e),Mt(r,i,.015*e+n-l,0,.4*(n-l)),t.globalAlpha=1,t.globalCompositeOperation="destination-out",t.drawImage(o,0,0),t.globalCompositeOperation="source-over",t.globalAlpha=s,t.drawImage(o,0,0)}a.font=`bolder ${.2*e}px Arial`,a.clearRect(0,0,i.width,i.height),r.clearRect(0,0,o.width,o.height),t.rotate(-.08),a.fillStyle="#000",a.fillText("JUMP",.6*e,.2*e),Mt(t,i,.02*e,0,.03*e),a.fillStyle="#fff",a.clearRect(0,0,i.width,i.height),a.fillText("JUMP",.6*e,.2*e),Mt(t,i,.01*e,0,.03*e)})(),kt(500)})()}));const $t=async()=>{const t=document.querySelector("#pause");Ot&&Ot.state.paused&&Et===t&&(Et=null,t.classList.remove("visible"),await vt(300),t.style.zIndex=null,Ot.unpause())},jt=()=>{Ot&&(Ot.state.paused?$t():(()=>{if(!Ot||Ot.state.paused||Ot.state.ending)return;Ot.pause();const t=document.querySelector("#pause");Et=t,mt(document.querySelector("#pause--continue")),t.classList.add("visible"),t.style.zIndex="2",Tt()})())};if((()=>{try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}})()){document.body.classList.add("touch");const t=t=>e=>{e.target.classList.add("is-active"),t(e)},e=t=>e=>{e.target.classList.remove("is-active"),t(e)},i=t=>e=>{const i=e.target.getAttribute("data-touch-key");i in f&&(e.preventDefault(),t(i))},a=t=>{f[t]=!0,"enter"===t&&jt()},o=t=>f[t]=!1;document.addEventListener("touchstart",t(i(a))),document.addEventListener("touchend",e(i(o)))}})()})();